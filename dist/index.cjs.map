{"version":3,"sources":["../src/connectors/oauth/utils/encryption.ts","../src/connectors/oauth/infrastructure/storage/MemoryStorage.ts","../src/connectors/oauth/domain/TokenStore.ts","../src/connectors/oauth/utils/pkce.ts","../src/connectors/oauth/flows/AuthCodePKCE.ts","../src/connectors/oauth/flows/ClientCredentials.ts","../src/connectors/oauth/flows/JWTBearer.ts","../src/connectors/oauth/flows/StaticToken.ts","../src/connectors/oauth/OAuthManager.ts","../src/core/StorageRegistry.ts","../src/infrastructure/resilience/CircuitBreaker.ts","../src/infrastructure/resilience/BackoffStrategy.ts","../src/infrastructure/observability/Logger.ts","../src/infrastructure/observability/Metrics.ts","../src/core/ScopedConnectorRegistry.ts","../src/core/Connector.ts","../src/core/constants.ts","../src/utils/sanitize.ts","../src/domain/entities/Services.ts","../src/tools/connector/ConnectorTools.ts","../node_modules/ajv/lib/compile/codegen/code.ts","../node_modules/ajv/lib/compile/codegen/scope.ts","../node_modules/ajv/lib/compile/codegen/index.ts","../node_modules/ajv/lib/compile/util.ts","../node_modules/ajv/lib/compile/names.ts","../node_modules/ajv/lib/compile/errors.ts","../node_modules/ajv/lib/compile/validate/boolSchema.ts","../node_modules/ajv/lib/compile/rules.ts","../node_modules/ajv/lib/compile/validate/applicability.ts","../node_modules/ajv/lib/compile/validate/dataType.ts","../node_modules/ajv/lib/compile/validate/defaults.ts","../node_modules/ajv/lib/vocabularies/code.ts","../node_modules/ajv/lib/compile/validate/keyword.ts","../node_modules/ajv/lib/compile/validate/subschema.ts","../node_modules/fast-deep-equal/index.js","../node_modules/json-schema-traverse/index.js","../node_modules/ajv/lib/compile/resolve.ts","../node_modules/ajv/lib/compile/validate/index.ts","../node_modules/ajv/lib/runtime/validation_error.ts","../node_modules/ajv/lib/compile/ref_error.ts","../node_modules/ajv/lib/compile/index.ts","../node_modules/ajv/dist/refs/data.json","../node_modules/fast-uri/lib/utils.js","../node_modules/fast-uri/lib/schemes.js","../node_modules/fast-uri/index.js","../node_modules/ajv/lib/runtime/uri.ts","../node_modules/ajv/lib/core.ts","../node_modules/ajv/lib/vocabularies/core/id.ts","../node_modules/ajv/lib/vocabularies/core/ref.ts","../node_modules/ajv/lib/vocabularies/core/index.ts","../node_modules/ajv/lib/vocabularies/validation/limitNumber.ts","../node_modules/ajv/lib/vocabularies/validation/multipleOf.ts","../node_modules/ajv/lib/runtime/ucs2length.ts","../node_modules/ajv/lib/vocabularies/validation/limitLength.ts","../node_modules/ajv/lib/vocabularies/validation/pattern.ts","../node_modules/ajv/lib/vocabularies/validation/limitProperties.ts","../node_modules/ajv/lib/vocabularies/validation/required.ts","../node_modules/ajv/lib/vocabularies/validation/limitItems.ts","../node_modules/ajv/lib/runtime/equal.ts","../node_modules/ajv/lib/vocabularies/validation/uniqueItems.ts","../node_modules/ajv/lib/vocabularies/validation/const.ts","../node_modules/ajv/lib/vocabularies/validation/enum.ts","../node_modules/ajv/lib/vocabularies/validation/index.ts","../node_modules/ajv/lib/vocabularies/applicator/additionalItems.ts","../node_modules/ajv/lib/vocabularies/applicator/items.ts","../node_modules/ajv/lib/vocabularies/applicator/prefixItems.ts","../node_modules/ajv/lib/vocabularies/applicator/items2020.ts","../node_modules/ajv/lib/vocabularies/applicator/contains.ts","../node_modules/ajv/lib/vocabularies/applicator/dependencies.ts","../node_modules/ajv/lib/vocabularies/applicator/propertyNames.ts","../node_modules/ajv/lib/vocabularies/applicator/additionalProperties.ts","../node_modules/ajv/lib/vocabularies/applicator/properties.ts","../node_modules/ajv/lib/vocabularies/applicator/patternProperties.ts","../node_modules/ajv/lib/vocabularies/applicator/not.ts","../node_modules/ajv/lib/vocabularies/applicator/anyOf.ts","../node_modules/ajv/lib/vocabularies/applicator/oneOf.ts","../node_modules/ajv/lib/vocabularies/applicator/allOf.ts","../node_modules/ajv/lib/vocabularies/applicator/if.ts","../node_modules/ajv/lib/vocabularies/applicator/thenElse.ts","../node_modules/ajv/lib/vocabularies/applicator/index.ts","../node_modules/ajv/lib/vocabularies/format/format.ts","../node_modules/ajv/lib/vocabularies/format/index.ts","../node_modules/ajv/lib/vocabularies/metadata.ts","../node_modules/ajv/lib/vocabularies/draft7.ts","../node_modules/ajv/lib/vocabularies/discriminator/types.ts","../node_modules/ajv/lib/vocabularies/discriminator/index.ts","../node_modules/ajv/dist/refs/json-schema-draft-07.json","../node_modules/ajv/lib/ajv.ts","../node_modules/ajv-formats/src/formats.ts","../node_modules/ajv-formats/src/limit.ts","../node_modules/ajv-formats/src/index.ts","../src/capabilities/documents/handlers/TextHandler.ts","../src/capabilities/documents/handlers/ImageHandler.ts","../src/tools/web/htmlToMarkdown.ts","../src/capabilities/documents/handlers/HTMLHandler.ts","../src/capabilities/documents/handlers/OfficeHandler.ts","../src/capabilities/documents/handlers/ExcelHandler.ts","../src/capabilities/documents/handlers/PDFHandler.ts","../src/capabilities/documents/handlers/index.ts","../src/capabilities/documents/transformers/DefaultTransformers.ts","../src/capabilities/documents/transformers/index.ts","../src/core/index.ts","../src/core/ToolCatalogRegistry.ts","../src/core/BaseAgent.ts","../src/core/permissions/types.ts","../src/core/permissions/ToolPermissionManager.ts","../src/core/ToolManager.ts","../src/domain/errors/AIErrors.ts","../src/core/tool-execution/ToolExecutionPipeline.ts","../src/core/tool-execution/plugins/ResultNormalizerPlugin.ts","../src/core/context-nextgen/AgentContextNextGen.ts","../src/core/Vendor.ts","../src/domain/entities/Model.ts","../src/domain/entities/Message.ts","../src/domain/entities/Content.ts","../src/core/context-nextgen/BasePluginNextGen.ts","../src/core/context-nextgen/snapshot.ts","../src/domain/entities/Memory.ts","../src/infrastructure/storage/InMemoryStorage.ts","../src/core/context-nextgen/plugins/WorkingMemoryPluginNextGen.ts","../src/core/context-nextgen/plugins/InContextMemoryPluginNextGen.ts","../src/infrastructure/storage/FilePersistentInstructionsStorage.ts","../src/core/context-nextgen/plugins/PersistentInstructionsPluginNextGen.ts","../src/infrastructure/storage/FileUserInfoStorage.ts","../src/core/context-nextgen/plugins/UserInfoPluginNextGen.ts","../src/core/context-nextgen/plugins/ToolCatalogPluginNextGen.ts","../src/core/context-nextgen/strategies/DefaultCompactionStrategy.ts","../src/core/context-nextgen/strategies/AlgorithmicCompactionStrategy.ts","../src/core/context-nextgen/strategies/StrategyRegistry.ts","../src/core/context-nextgen/types.ts","../src/infrastructure/providers/base/BaseProvider.ts","../src/infrastructure/providers/base/BaseTextProvider.ts","../src/infrastructure/providers/openai/OpenAIResponsesConverter.ts","../src/domain/entities/StreamEvent.ts","../src/infrastructure/providers/openai/OpenAIResponsesStreamConverter.ts","../src/infrastructure/providers/base/ModelCapabilityResolver.ts","../src/infrastructure/providers/shared/validateThinkingConfig.ts","../src/infrastructure/providers/openai/OpenAITextProvider.ts","../src/infrastructure/providers/shared/ResponseBuilder.ts","../src/infrastructure/providers/shared/ToolConversionUtils.ts","../src/infrastructure/providers/base/BaseConverter.ts","../src/infrastructure/providers/anthropic/AnthropicConverter.ts","../src/infrastructure/providers/base/BaseStreamConverter.ts","../src/infrastructure/providers/anthropic/AnthropicStreamConverter.ts","../src/infrastructure/providers/anthropic/AnthropicTextProvider.ts","../src/utils/imageUtils.ts","../src/infrastructure/providers/google/GoogleConverter.ts","../src/infrastructure/providers/google/GoogleStreamConverter.ts","../src/infrastructure/providers/google/GoogleTextProvider.ts","../src/infrastructure/providers/vertex/VertexAITextProvider.ts","../src/infrastructure/providers/generic/GenericOpenAIProvider.ts","../src/core/createProvider.ts","../src/domain/entities/Tool.ts","../src/capabilities/agents/ExecutionContext.ts","../src/capabilities/agents/HookManager.ts","../src/domain/entities/StreamState.ts","../src/domain/interfaces/IDisposable.ts","../src/core/Agent.ts","../src/domain/entities/Task.ts","../src/domain/entities/Routine.ts","../src/utils/jsonExtractor.ts","../src/core/routineRunner.ts","../src/core/routineControlFlow.ts","../src/core/createExecutionRecorder.ts","../src/infrastructure/config/ConfigLoader.ts","../node_modules/@modelcontextprotocol/sdk/src/server/zod-compat.ts","../node_modules/@modelcontextprotocol/sdk/src/types.ts","../node_modules/@modelcontextprotocol/sdk/src/experimental/tasks/interfaces.ts","../node_modules/zod-to-json-schema/dist/esm/parsers/string.js","../node_modules/@modelcontextprotocol/sdk/src/server/zod-json-schema-compat.ts","../node_modules/@modelcontextprotocol/sdk/src/shared/protocol.ts","../node_modules/@modelcontextprotocol/sdk/src/validation/ajv-provider.ts","../node_modules/@modelcontextprotocol/sdk/src/experimental/tasks/client.ts","../node_modules/@modelcontextprotocol/sdk/src/experimental/tasks/helpers.ts","../node_modules/@modelcontextprotocol/sdk/src/client/index.ts","../node_modules/@modelcontextprotocol/sdk/src/shared/stdio.ts","../node_modules/@modelcontextprotocol/sdk/src/client/stdio.ts","../node_modules/@modelcontextprotocol/sdk/src/shared/transport.ts","../node_modules/pkce-challenge/dist/index.node.js","../node_modules/@modelcontextprotocol/sdk/src/shared/auth.ts","../node_modules/@modelcontextprotocol/sdk/src/shared/auth-utils.ts","../node_modules/@modelcontextprotocol/sdk/src/server/auth/errors.ts","../node_modules/@modelcontextprotocol/sdk/src/client/auth.ts","../node_modules/eventsource-parser/src/errors.ts","../node_modules/eventsource-parser/src/parse.ts","../node_modules/eventsource-parser/src/stream.ts","../node_modules/@modelcontextprotocol/sdk/src/client/streamableHttp.ts","../src/domain/errors/MCPError.ts","../src/domain/entities/MCPConfig.ts","../src/infrastructure/mcp/adapters/MCPToolAdapter.ts","../src/core/mcp/MCPClient.ts","../src/core/mcp/MCPRegistry.ts","../src/core/TextToSpeech.ts","../src/infrastructure/providers/base/BaseMediaProvider.ts","../src/domain/entities/SharedVoices.ts","../src/infrastructure/providers/openai/OpenAITTSProvider.ts","../src/infrastructure/providers/openai/OpenAISTTProvider.ts","../src/infrastructure/providers/google/GoogleTTSProvider.ts","../src/core/createAudioProvider.ts","../src/domain/entities/RegistryUtils.ts","../src/domain/entities/TTSModel.ts","../src/core/SpeechToText.ts","../src/domain/entities/STTModel.ts","../src/infrastructure/providers/openai/OpenAIImageProvider.ts","../src/infrastructure/providers/google/GoogleImageProvider.ts","../src/infrastructure/providers/grok/GrokImageProvider.ts","../src/core/createImageProvider.ts","../src/core/tool-execution/plugins/LoggingPlugin.ts","../src/core/ErrorHandler.ts","../src/capabilities/images/ImageGeneration.ts","../src/domain/entities/ImageModel.ts","../src/capabilities/video/VideoGeneration.ts","../src/infrastructure/providers/openai/OpenAISoraProvider.ts","../src/infrastructure/providers/google/GoogleVeoProvider.ts","../src/infrastructure/providers/grok/GrokImagineProvider.ts","../src/core/createVideoProvider.ts","../src/domain/entities/VideoModel.ts","../src/capabilities/search/SearchProvider.ts","../src/capabilities/shared/types.ts","../src/capabilities/search/providers/SerperProvider.ts","../src/capabilities/search/providers/BraveProvider.ts","../src/capabilities/search/providers/TavilyProvider.ts","../src/capabilities/search/providers/RapidAPIProvider.ts","../src/capabilities/scrape/ScrapeProvider.ts","../src/capabilities/scrape/providers/ZenRowsProvider.ts","../src/capabilities/documents/DocumentReader.ts","../src/capabilities/documents/FormatDetector.ts","../src/capabilities/documents/index.ts","../src/utils/documentContentBridge.ts","../src/domain/interfaces/IContextStorage.ts","../src/domain/interfaces/IAgentDefinitionStorage.ts","../src/capabilities/taskAgent/WorkingMemory.ts","../src/capabilities/taskAgent/ExternalDependencyHandler.ts","../src/capabilities/taskAgent/CheckpointManager.ts","../src/capabilities/taskAgent/PlanningAgent.ts","../src/core/context/types.ts","../src/infrastructure/context/compactors/TruncateCompactor.ts","../src/infrastructure/context/compactors/SummarizeCompactor.ts","../src/infrastructure/context/compactors/MemoryEvictionCompactor.ts","../src/infrastructure/context/estimators/ApproximateEstimator.ts","../src/infrastructure/context/estimators/index.ts","../src/domain/interfaces/IHistoryManager.ts","../src/infrastructure/storage/InMemoryHistoryStorage.ts","../src/domain/entities/RoutineExecutionRecord.ts","../src/infrastructure/storage/FileContextStorage.ts","../src/infrastructure/storage/FileAgentDefinitionStorage.ts","../src/infrastructure/storage/FileMediaStorage.ts","../src/infrastructure/storage/FileCustomToolStorage.ts","../src/infrastructure/storage/FileRoutineDefinitionStorage.ts","../src/domain/entities/CustomToolDefinition.ts","../src/capabilities/agents/StreamHelpers.ts","../src/infrastructure/providers/base/ProviderErrorMapper.ts","../src/index.ts","../src/tools/connector/index.ts","../src/connectors/oauth/index.ts","../src/connectors/index.ts","../src/connectors/oauth/infrastructure/storage/FileStorage.ts","../src/connectors/authenticatedFetch.ts","../src/connectors/toolGenerator.ts","../src/domain/interfaces/IConnectorConfigStorage.ts","../src/connectors/storage/ConnectorConfigStore.ts","../src/connectors/storage/MemoryConnectorStorage.ts","../src/connectors/storage/FileConnectorStorage.ts","../src/connectors/vendors/helpers.ts","../src/connectors/vendors/templates/microsoft.ts","../src/connectors/vendors/templates/google.ts","../src/connectors/vendors/templates/slack.ts","../src/connectors/vendors/templates/discord.ts","../src/connectors/vendors/templates/telegram.ts","../src/connectors/vendors/templates/twitter.ts","../src/connectors/vendors/templates/github.ts","../src/connectors/vendors/templates/gitlab.ts","../src/connectors/vendors/templates/atlassian.ts","../src/connectors/vendors/templates/linear.ts","../src/connectors/vendors/templates/asana.ts","../src/connectors/vendors/templates/notion.ts","../src/connectors/vendors/templates/airtable.ts","../src/connectors/vendors/templates/salesforce.ts","../src/connectors/vendors/templates/hubspot.ts","../src/connectors/vendors/templates/pipedrive.ts","../src/connectors/vendors/templates/stripe.ts","../src/connectors/vendors/templates/paypal.ts","../src/connectors/vendors/templates/quickbooks.ts","../src/connectors/vendors/templates/ramp.ts","../src/connectors/vendors/templates/aws.ts","../src/connectors/vendors/templates/dropbox.ts","../src/connectors/vendors/templates/box.ts","../src/connectors/vendors/templates/email.ts","../src/connectors/vendors/templates/monitoring.ts","../src/connectors/vendors/templates/search.ts","../src/connectors/vendors/templates/scrape.ts","../src/connectors/vendors/templates/other.ts","../src/connectors/vendors/templates/index.ts","../src/connectors/vendors/logos.ts","../src/connectors/vendors/index.ts","../src/infrastructure/resilience/index.ts","../src/infrastructure/resilience/RateLimiter.ts","../src/infrastructure/observability/index.ts","../src/utils/messageBuilder.ts","../src/utils/clipboardImage.ts","../src/tools/index.ts","../src/tools/filesystem/types.ts","../src/tools/filesystem/readFile.ts","../src/tools/filesystem/writeFile.ts","../src/tools/filesystem/editFile.ts","../src/tools/filesystem/glob.ts","../src/tools/filesystem/grep.ts","../src/tools/filesystem/listDirectory.ts","../src/tools/shell/types.ts","../src/tools/shell/bash.ts","../src/tools/json/pathUtils.ts","../src/tools/json/jsonManipulator.ts","../src/tools/web/register.ts","../src/tools/web/createWebSearchTool.ts","../src/tools/web/contentDetector.ts","../src/tools/web/webFetch.ts","../src/tools/web/createWebScrapeTool.ts","../src/tools/web/index.ts","../src/tools/code/executeJavaScript.ts","../src/tools/multimedia/register.ts","../src/tools/multimedia/config.ts","../src/tools/multimedia/imageGeneration.ts","../src/tools/multimedia/videoGeneration.ts","../src/tools/multimedia/textToSpeech.ts","../src/tools/multimedia/speechToText.ts","../src/tools/multimedia/index.ts","../src/tools/github/register.ts","../src/tools/github/types.ts","../src/tools/github/searchFiles.ts","../src/tools/github/searchCode.ts","../src/tools/github/readFile.ts","../src/tools/github/getPR.ts","../src/tools/github/prFiles.ts","../src/tools/github/prComments.ts","../src/tools/github/createPR.ts","../src/tools/github/index.ts","../src/tools/microsoft/register.ts","../src/tools/microsoft/types.ts","../src/tools/microsoft/createDraftEmail.ts","../src/tools/microsoft/sendEmail.ts","../src/tools/microsoft/createMeeting.ts","../src/tools/microsoft/editMeeting.ts","../src/tools/microsoft/getMeetingTranscript.ts","../src/tools/microsoft/findMeetingSlots.ts","../src/tools/microsoft/readFile.ts","../src/tools/microsoft/listFiles.ts","../src/tools/microsoft/searchFiles.ts","../src/tools/microsoft/index.ts","../src/tools/desktop/types.ts","../src/tools/desktop/driver/NutTreeDriver.ts","../src/tools/desktop/getDriver.ts","../src/tools/desktop/screenshot.ts","../src/tools/desktop/mouseMove.ts","../src/tools/desktop/mouseClick.ts","../src/tools/desktop/mouseDrag.ts","../src/tools/desktop/mouseScroll.ts","../src/tools/desktop/getCursor.ts","../src/tools/desktop/keyboardType.ts","../src/tools/desktop/keyboardKey.ts","../src/tools/desktop/getScreenSize.ts","../src/tools/desktop/windowList.ts","../src/tools/desktop/windowFocus.ts","../src/tools/desktop/index.ts","../src/tools/custom-tools/resolveStorage.ts","../src/tools/custom-tools/customToolDelete.ts","../src/tools/custom-tools/sandboxDescription.ts","../src/tools/custom-tools/customToolDraft.ts","../src/tools/custom-tools/customToolList.ts","../src/tools/custom-tools/customToolLoad.ts","../src/tools/custom-tools/customToolSave.ts","../src/tools/custom-tools/customToolTest.ts","../src/tools/routines/resolveStorage.ts","../src/tools/routines/generateRoutine.ts","../src/tools/registry.generated.ts","../src/tools/custom-tools/factories.ts","../src/tools/custom-tools/hydrate.ts","../src/tools/ToolRegistry.ts","../src/agents/ProviderConfigAgent.ts","../src/infrastructure/scheduling/SimpleScheduler.ts","../src/infrastructure/triggers/EventEmitterTrigger.ts"],"names":["crypto2","MemoryStorage","crypto3","auth","fs","importPKCS8","SignJWT","OAuthManager","url","StorageRegistry","DEFAULT_CIRCUIT_BREAKER_CONFIG","CircuitOpenError","CircuitBreaker","EventEmitter","DEFAULT_BACKOFF_CONFIG","resolve","FrameworkLogger","logger","path","fs2","ConsoleMetrics","InMemoryMetrics","NoOpMetrics","metrics","ScopedConnectorRegistry","Connector","DEFAULT_BASE_DELAY_MS","DEFAULT_CONNECTOR_TIMEOUT","DEFAULT_MAX_DELAY_MS","DEFAULT_MAX_RETRIES","DEFAULT_RETRYABLE_STATUSES","SERVICE_DEFINITIONS","SERVICE_INFO","Services","SERVICE_URL_PATTERNS","ConnectorTools","safeStringify","exports","UsedValueState","Type","DataType","_a","normalize","relative","Ajv","DiscrError","Readability","TurndownService","MessageRole","ContentType","platform","join","homedir","getDefaultBaseDirectory","DEFAULT_MAX_ENTRIES","KEY_MAX_LENGTH","KEY_PATTERN","validateKey","global","toolNames","DEFAULT_THRESHOLD","DEFAULT_CONFIG","c","StreamEventType","OpenAI","randomUUID","Anthropic","GoogleGenAI","ToolCallState","record","value","array","safeParse","result","z4mini","def","z","ErrorCode","task","error","jsonrpcNotification","_addFormats","process","PassThrough","spawn","crypto","randomBytes","z2","tokens","fs7","fs8","helpers","fs9","fs10","fs11","extractOpenAIConfig","extractGoogleConfig","os","GROK_API_BASE_URL","base64","extractGrokConfig","fsReadFile","getDefaultHandlers","getDefaultTransformers","sanitizeAgentId","MIME_TYPES","path2","fs14","stat","random","crypto5","DEFAULT_USER_ID","sanitizeUserId","sanitizeId","fs17","crypto6","path3","path4","fs18","crypto7","simpleIcons","promisify","exec","fs19","os2","path5","readFile","writeFile","sep","isAbsolute","existsSync","extname","content","dirname","mkdir","fsWriteFile","readdir","load","vm","matchGlobPattern","DEFAULT_LIMIT","MAX_LIMIT","buildStorageContext","formatConnectorEntry","DEFAULT_TIMEOUT"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\n * Encryption utilities for OAuth tokens\n * Uses AES-256-GCM for secure token storage\n */\n\nimport * as crypto from 'crypto';\n\nconst ALGORITHM = 'aes-256-gcm';\nconst IV_LENGTH = 16;\nconst SALT_LENGTH = 64;\nconst TAG_LENGTH = 16;\nconst KEY_LENGTH = 32;\n\n/**\n * Encrypt data using AES-256-GCM with PBKDF2 key derivation\n *\n * @param text - Plaintext to encrypt\n * @param password - Encryption key/password\n * @returns Base64-encoded encrypted data\n */\nexport function encrypt(text: string, password: string): string {\n  // Generate random salt\n  const salt = crypto.randomBytes(SALT_LENGTH);\n\n  // Derive key from password using PBKDF2\n  const key = crypto.pbkdf2Sync(password, salt, 100000, KEY_LENGTH, 'sha512');\n\n  // Generate random IV\n  const iv = crypto.randomBytes(IV_LENGTH);\n\n  // Create cipher\n  const cipher = crypto.createCipheriv(ALGORITHM, key, iv);\n\n  // Encrypt\n  let encrypted = cipher.update(text, 'utf8', 'hex');\n  encrypted += cipher.final('hex');\n\n  // Get authentication tag\n  const tag = cipher.getAuthTag();\n\n  // Combine: salt + iv + tag + encrypted\n  const result = Buffer.concat([salt, iv, tag, Buffer.from(encrypted, 'hex')]);\n\n  // Return as base64\n  return result.toString('base64');\n}\n\n/**\n * Decrypt data using AES-256-GCM\n *\n * @param encryptedData - Base64-encoded encrypted data\n * @param password - Encryption key/password\n * @returns Decrypted plaintext\n */\nexport function decrypt(encryptedData: string, password: string): string {\n  const buffer = Buffer.from(encryptedData, 'base64');\n\n  // Extract components\n  const salt = buffer.subarray(0, SALT_LENGTH);\n  const iv = buffer.subarray(SALT_LENGTH, SALT_LENGTH + IV_LENGTH);\n  const tag = buffer.subarray(SALT_LENGTH + IV_LENGTH, SALT_LENGTH + IV_LENGTH + TAG_LENGTH);\n  const encrypted = buffer.subarray(SALT_LENGTH + IV_LENGTH + TAG_LENGTH);\n\n  // Derive key from password\n  const key = crypto.pbkdf2Sync(password, salt, 100000, KEY_LENGTH, 'sha512');\n\n  // Create decipher\n  const decipher = crypto.createDecipheriv(ALGORITHM, key, iv);\n  decipher.setAuthTag(tag);\n\n  // Decrypt\n  let decrypted = decipher.update(encrypted);\n  decrypted = Buffer.concat([decrypted, decipher.final()]);\n\n  return decrypted.toString('utf8');\n}\n\n/**\n * Get encryption key from environment or generate temporary one\n *\n * For production, always set OAUTH_ENCRYPTION_KEY environment variable!\n */\nexport function getEncryptionKey(): string {\n  // Use environment variable if available (RECOMMENDED)\n  if (process.env.OAUTH_ENCRYPTION_KEY) {\n    return process.env.OAUTH_ENCRYPTION_KEY;\n  }\n\n  // For in-memory storage: use process-specific key (not persistent across restarts)\n  // This is acceptable for MemoryStorage but NOT for FileStorage or DatabaseStorage!\n  if (!(global as any).__oauthEncryptionKey) {\n    (global as any).__oauthEncryptionKey = crypto.randomBytes(32).toString('hex');\n\n    console.warn(\n      'WARNING: Using auto-generated encryption key. Tokens will not persist across restarts. ' +\n        'Set OAUTH_ENCRYPTION_KEY environment variable for production!'\n    );\n  }\n\n  return (global as any).__oauthEncryptionKey;\n}\n\n/**\n * Generate a secure random encryption key\n * Use this to generate OAUTH_ENCRYPTION_KEY for your .env file\n */\nexport function generateEncryptionKey(): string {\n  return crypto.randomBytes(32).toString('hex');\n}\n","/**\n * In-memory token storage (default)\n * Tokens are encrypted in memory using AES-256-GCM\n */\n\nimport { ITokenStorage, StoredToken } from '../../domain/ITokenStorage.js';\nimport { encrypt, decrypt, getEncryptionKey } from '../../utils/encryption.js';\n\nexport class MemoryStorage implements ITokenStorage {\n  private tokens: Map<string, string> = new Map(); // Stores encrypted tokens\n\n  async storeToken(key: string, token: StoredToken): Promise<void> {\n    const encryptionKey = getEncryptionKey();\n    const plaintext = JSON.stringify(token);\n    const encrypted = encrypt(plaintext, encryptionKey);\n\n    this.tokens.set(key, encrypted);\n  }\n\n  async getToken(key: string): Promise<StoredToken | null> {\n    const encrypted = this.tokens.get(key);\n    if (!encrypted) {\n      return null;\n    }\n\n    try {\n      const encryptionKey = getEncryptionKey();\n      const decrypted = decrypt(encrypted, encryptionKey);\n      return JSON.parse(decrypted) as StoredToken;\n    } catch (error) {\n      console.error('Failed to decrypt token from memory:', error);\n      // Remove corrupted token\n      this.tokens.delete(key);\n      return null;\n    }\n  }\n\n  async deleteToken(key: string): Promise<void> {\n    this.tokens.delete(key);\n  }\n\n  async hasToken(key: string): Promise<boolean> {\n    return this.tokens.has(key);\n  }\n\n  /**\n   * Clear all tokens (useful for testing)\n   */\n  clearAll(): void {\n    this.tokens.clear();\n  }\n\n  /**\n   * Get number of stored tokens\n   */\n  size(): number {\n    return this.tokens.size;\n  }\n\n  /**\n   * List all storage keys (for account enumeration)\n   */\n  async listKeys(): Promise<string[]> {\n    return Array.from(this.tokens.keys());\n  }\n}\n","/**\n * Token Store (Domain Layer)\n * Manages token lifecycle using pluggable storage backend\n */\n\nimport { ITokenStorage, StoredToken } from './ITokenStorage.js';\nimport { MemoryStorage } from '../infrastructure/storage/MemoryStorage.js';\n\nexport class TokenStore {\n  private storage: ITokenStorage;\n  private baseStorageKey: string;\n\n  constructor(storageKey: string = 'default', storage?: ITokenStorage) {\n    this.baseStorageKey = storageKey;\n    // Default to in-memory storage (encrypted)\n    this.storage = storage || new MemoryStorage();\n  }\n\n  /**\n   * Get user-scoped (and optionally account-scoped) storage key\n   *\n   * Key format (backward compatible):\n   * - No userId, no accountId   baseKey\n   * - userId only               baseKey:userId\n   * - userId + accountId        baseKey:userId:accountId\n   * - accountId only            baseKey:default:accountId\n   *\n   * @param userId - User identifier (optional, defaults to single-user mode)\n   * @param accountId - Account alias for multi-account support (optional)\n   * @returns Storage key scoped to user and account\n   */\n  private getScopedKey(userId?: string, accountId?: string): string {\n    if (accountId) {\n      // Multi-account mode: always include userId dimension\n      const userPart = userId && userId !== 'default' ? userId : 'default';\n      return `${this.baseStorageKey}:${userPart}:${accountId}`;\n    }\n    if (!userId || userId === 'default') {\n      // Single-user mode (backward compatible)\n      return this.baseStorageKey;\n    }\n    // Multi-user mode, no account (backward compatible)\n    return `${this.baseStorageKey}:${userId}`;\n  }\n\n  /**\n   * Store token (encrypted by storage layer)\n   * @param tokenResponse - Token response from OAuth provider\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async storeToken(tokenResponse: any, userId?: string, accountId?: string): Promise<void> {\n    // Validate required fields\n    if (!tokenResponse.access_token) {\n      throw new Error('OAuth response missing required access_token field');\n    }\n\n    if (typeof tokenResponse.access_token !== 'string') {\n      throw new Error('access_token must be a string');\n    }\n\n    if (tokenResponse.expires_in !== undefined && tokenResponse.expires_in < 0) {\n      throw new Error('expires_in must be positive');\n    }\n\n    const token: StoredToken = {\n      access_token: tokenResponse.access_token,\n      refresh_token: tokenResponse.refresh_token,\n      expires_in: tokenResponse.expires_in || 3600,\n      token_type: tokenResponse.token_type || 'Bearer',\n      scope: tokenResponse.scope,\n      obtained_at: Date.now(),\n    };\n\n    const key = this.getScopedKey(userId, accountId);\n    await this.storage.storeToken(key, token);\n  }\n\n  /**\n   * Get access token\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async getAccessToken(userId?: string, accountId?: string): Promise<string> {\n    const key = this.getScopedKey(userId, accountId);\n    const token = await this.storage.getToken(key);\n    if (!token) {\n      const userLabel = userId ? `user: ${userId}` : 'default user';\n      const accountLabel = accountId ? `, account: ${accountId}` : '';\n      throw new Error(`No token stored for ${userLabel}${accountLabel}`);\n    }\n    return token.access_token;\n  }\n\n  /**\n   * Get refresh token\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async getRefreshToken(userId?: string, accountId?: string): Promise<string> {\n    const key = this.getScopedKey(userId, accountId);\n    const token = await this.storage.getToken(key);\n    if (!token?.refresh_token) {\n      const userLabel = userId ? `user: ${userId}` : 'default user';\n      const accountLabel = accountId ? `, account: ${accountId}` : '';\n      throw new Error(`No refresh token available for ${userLabel}${accountLabel}`);\n    }\n    return token.refresh_token;\n  }\n\n  /**\n   * Check if has refresh token\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async hasRefreshToken(userId?: string, accountId?: string): Promise<boolean> {\n    const key = this.getScopedKey(userId, accountId);\n    const token = await this.storage.getToken(key);\n    return !!token?.refresh_token;\n  }\n\n  /**\n   * Check if token is valid (not expired)\n   *\n   * @param bufferSeconds - Refresh this many seconds before expiry (default: 300 = 5 min)\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async isValid(bufferSeconds: number = 300, userId?: string, accountId?: string): Promise<boolean> {\n    const key = this.getScopedKey(userId, accountId);\n    const token = await this.storage.getToken(key);\n    if (!token) {\n      return false;\n    }\n\n    const expiresAt = token.obtained_at + token.expires_in * 1000;\n    const bufferMs = bufferSeconds * 1000;\n\n    return Date.now() < expiresAt - bufferMs;\n  }\n\n  /**\n   * Clear stored token\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async clear(userId?: string, accountId?: string): Promise<void> {\n    const key = this.getScopedKey(userId, accountId);\n    await this.storage.deleteToken(key);\n  }\n\n  /**\n   * Get full token info\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async getTokenInfo(userId?: string, accountId?: string): Promise<StoredToken | null> {\n    const key = this.getScopedKey(userId, accountId);\n    return this.storage.getToken(key);\n  }\n\n  /**\n   * List account aliases for a user on this connector.\n   * Returns account IDs that have stored tokens.\n   *\n   * @param userId - Optional user identifier\n   * @returns Array of account aliases (e.g., ['work', 'personal'])\n   */\n  async listAccounts(userId?: string): Promise<string[]> {\n    if (!this.storage.listKeys) {\n      return [];\n    }\n\n    const allKeys = await this.storage.listKeys();\n    const userPart = userId && userId !== 'default' ? userId : 'default';\n    const prefix = `${this.baseStorageKey}:${userPart}:`;\n\n    const accounts: string[] = [];\n    for (const key of allKeys) {\n      if (key.startsWith(prefix)) {\n        const accountId = key.slice(prefix.length);\n        // Only include if it's a direct account (no further colons)\n        if (accountId && !accountId.includes(':')) {\n          accounts.push(accountId);\n        }\n      }\n    }\n\n    return accounts;\n  }\n}\n","/**\n * PKCE (Proof Key for Code Exchange) utilities\n * RFC 7636 - https://tools.ietf.org/html/rfc7636\n */\n\nimport * as crypto from 'crypto';\n\nexport interface PKCEPair {\n  codeVerifier: string;\n  codeChallenge: string;\n}\n\n/**\n * Generate PKCE code verifier and challenge pair\n *\n * code_challenge = BASE64URL(SHA256(code_verifier))\n */\nexport function generatePKCE(): PKCEPair {\n  // Generate random code verifier (43-128 characters as per RFC)\n  const codeVerifier = base64URLEncode(crypto.randomBytes(32));\n\n  // Create code challenge = BASE64URL(SHA256(code_verifier))\n  const hash = crypto.createHash('sha256').update(codeVerifier).digest();\n  const codeChallenge = base64URLEncode(hash);\n\n  return {\n    codeVerifier,\n    codeChallenge,\n  };\n}\n\n/**\n * Base64 URL encode (RFC 4648 Section 5)\n * Used for PKCE code_verifier and code_challenge\n */\nfunction base64URLEncode(buffer: Buffer): string {\n  return buffer\n    .toString('base64')\n    .replace(/\\+/g, '-') // Replace + with -\n    .replace(/\\//g, '_') // Replace / with _\n    .replace(/=/g, ''); // Remove padding\n}\n\n/**\n * Generate random state for CSRF protection\n */\nexport function generateState(): string {\n  return crypto.randomBytes(16).toString('hex');\n}\n","/**\n * OAuth 2.0 Authorization Code Flow with PKCE (RFC 7636)\n * User authentication for web and mobile apps\n */\n\nimport { TokenStore } from '../domain/TokenStore.js';\nimport { generatePKCE, generateState } from '../utils/pkce.js';\nimport type { OAuthConfig } from '../types.js';\n\nexport class AuthCodePKCEFlow {\n  private tokenStore: TokenStore;\n  // Store PKCE data per user+account with timestamps for cleanup\n  private codeVerifiers: Map<string, { verifier: string; timestamp: number }> = new Map();\n  private states: Map<string, { state: string; timestamp: number }> = new Map();\n  // Store refresh locks per user+account to prevent concurrent refresh\n  private refreshLocks: Map<string, Promise<string>> = new Map();\n  // PKCE data TTL: 15 minutes (auth flows should complete within this time)\n  private readonly PKCE_TTL = 15 * 60 * 1000;\n\n  constructor(private config: OAuthConfig) {\n    const storageKey = config.storageKey || `auth_code:${config.clientId}`;\n    this.tokenStore = new TokenStore(storageKey, config.storage);\n  }\n\n  /**\n   * Build a map key from userId and accountId for internal PKCE/state/lock maps.\n   */\n  private getMapKey(userId?: string, accountId?: string): string {\n    const userPart = userId || 'default';\n    return accountId ? `${userPart}:${accountId}` : userPart;\n  }\n\n  /**\n   * Generate authorization URL for user to visit\n   * Opens browser or redirects user to this URL\n   *\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async getAuthorizationUrl(userId?: string, accountId?: string): Promise<string> {\n    if (!this.config.authorizationUrl) {\n      throw new Error('authorizationUrl is required for authorization_code flow');\n    }\n\n    if (!this.config.redirectUri) {\n      throw new Error('redirectUri is required for authorization_code flow');\n    }\n\n    // Clean up expired PKCE data before creating new flow\n    this.cleanupExpiredPKCE();\n\n    const mapKey = this.getMapKey(userId, accountId);\n\n    // Generate PKCE pair\n    const { codeVerifier, codeChallenge } = generatePKCE();\n    this.codeVerifiers.set(mapKey, { verifier: codeVerifier, timestamp: Date.now() });\n\n    // Generate state for CSRF protection\n    const state = generateState();\n    this.states.set(mapKey, { state, timestamp: Date.now() });\n\n    // Build authorization URL\n    const params = new URLSearchParams({\n      response_type: 'code',\n      client_id: this.config.clientId,\n      redirect_uri: this.config.redirectUri,\n      state,\n    });\n\n    // Add scope if provided\n    if (this.config.scope) {\n      params.append('scope', this.config.scope);\n    }\n\n    // Add PKCE parameters (if enabled, default true)\n    if (this.config.usePKCE !== false) {\n      params.append('code_challenge', codeChallenge);\n      params.append('code_challenge_method', 'S256');\n    }\n\n    // Encode userId and accountId in state for retrieval in callback\n    // Format: `{random_state}[::userId[::accountId]]`\n    let stateWithMetadata = state;\n    if (userId || accountId) {\n      stateWithMetadata = `${state}::${userId || ''}`;\n      if (accountId) {\n        stateWithMetadata += `::${accountId}`;\n      }\n    }\n    params.set('state', stateWithMetadata);\n\n    return `${this.config.authorizationUrl}?${params.toString()}`;\n  }\n\n  /**\n   * Exchange authorization code for access token\n   *\n   * @param code - Authorization code from callback\n   * @param state - State parameter from callback (for CSRF verification, may include userId/accountId)\n   * @param userId - User identifier (optional, can be extracted from state)\n   * @param accountId - Account alias (optional, can be extracted from state)\n   */\n  async exchangeCode(code: string, state: string, userId?: string, accountId?: string): Promise<void> {\n    // Extract userId and accountId from state if embedded\n    let actualState = state;\n    let actualUserId = userId;\n    let actualAccountId = accountId;\n\n    if (state.includes('::')) {\n      const parts = state.split('::');\n      actualState = parts[0]!;\n      if (!actualUserId && parts[1]) {\n        actualUserId = parts[1];\n      }\n      if (!actualAccountId && parts[2]) {\n        actualAccountId = parts[2];\n      }\n    }\n\n    const mapKey = this.getMapKey(actualUserId, actualAccountId);\n\n    // Verify state to prevent CSRF attacks\n    const stateData = this.states.get(mapKey);\n    if (!stateData) {\n      const label = actualAccountId\n        ? `user ${actualUserId}, account ${actualAccountId}`\n        : `user ${actualUserId}`;\n      throw new Error(`No PKCE state found for ${label}. Authorization flow may have expired (15 min TTL).`);\n    }\n\n    const expectedState = stateData.state;\n    if (actualState !== expectedState) {\n      const label = actualAccountId\n        ? `user ${actualUserId}, account ${actualAccountId}`\n        : `user ${actualUserId}`;\n      throw new Error(`State mismatch for ${label} - possible CSRF attack. Expected: ${expectedState}, Got: ${actualState}`);\n    }\n\n    if (!this.config.redirectUri) {\n      throw new Error('redirectUri is required');\n    }\n\n    // Build token request\n    const params = new URLSearchParams({\n      grant_type: 'authorization_code',\n      code,\n      redirect_uri: this.config.redirectUri,\n      client_id: this.config.clientId,\n    });\n\n    // Add client secret if provided (confidential clients)\n    if (this.config.clientSecret) {\n      params.append('client_secret', this.config.clientSecret);\n    }\n\n    // Add code_verifier if PKCE was used\n    const verifierData = this.codeVerifiers.get(mapKey);\n    if (this.config.usePKCE !== false && verifierData) {\n      params.append('code_verifier', verifierData.verifier);\n    }\n\n    let response = await fetch(this.config.tokenUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: params,\n    });\n\n    // If the provider rejects client_secret (public client), retry without it\n    if (!response.ok && this.config.clientSecret) {\n      const errorText = await response.text();\n      if (isPublicClientError(errorText)) {\n        params.delete('client_secret');\n        response = await fetch(this.config.tokenUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n          },\n          body: params,\n        });\n        if (!response.ok) {\n          const retryError = await response.text();\n          throw new Error(`Token exchange failed: ${response.status} ${response.statusText} - ${retryError}`);\n        }\n      } else {\n        throw new Error(`Token exchange failed: ${response.status} ${response.statusText} - ${errorText}`);\n      }\n    } else if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Token exchange failed: ${response.status} ${response.statusText} - ${error}`);\n    }\n\n    const data: any = await response.json();\n\n    // Store token (encrypted) with user and account scoping\n    await this.tokenStore.storeToken(data, actualUserId, actualAccountId);\n\n    // Clear PKCE data (one-time use)\n    this.codeVerifiers.delete(mapKey);\n    this.states.delete(mapKey);\n  }\n\n  /**\n   * Get valid token (auto-refreshes if needed)\n   * @param userId - User identifier for multi-user support\n   * @param accountId - Account alias for multi-account support\n   */\n  async getToken(userId?: string, accountId?: string): Promise<string> {\n    const mapKey = this.getMapKey(userId, accountId);\n\n    // If already refreshing for this user+account, wait for the existing refresh\n    if (this.refreshLocks.has(mapKey)) {\n      return this.refreshLocks.get(mapKey)!;\n    }\n\n    // Return cached token if valid\n    if (await this.tokenStore.isValid(this.config.refreshBeforeExpiry, userId, accountId)) {\n      return this.tokenStore.getAccessToken(userId, accountId);\n    }\n\n    // Try to refresh if we have a refresh token\n    if (await this.tokenStore.hasRefreshToken(userId, accountId)) {\n      // Start refresh and lock it\n      const refreshPromise = this.refreshToken(userId, accountId);\n      this.refreshLocks.set(mapKey, refreshPromise);\n\n      try {\n        return await refreshPromise;\n      } finally {\n        // Always clean up lock, even on error\n        this.refreshLocks.delete(mapKey);\n      }\n    }\n\n    // No valid token and can't refresh\n    const userLabel = userId ? `user: ${userId}` : 'default user';\n    const accountLabel = accountId ? `, account: ${accountId}` : '';\n    throw new Error(`No valid token available for ${userLabel}${accountLabel}. User needs to authorize (call startAuthFlow).`);\n  }\n\n  /**\n   * Refresh access token using refresh token\n   * @param userId - User identifier for multi-user support\n   * @param accountId - Account alias for multi-account support\n   */\n  async refreshToken(userId?: string, accountId?: string): Promise<string> {\n    const refreshToken = await this.tokenStore.getRefreshToken(userId, accountId);\n\n    const params = new URLSearchParams({\n      grant_type: 'refresh_token',\n      refresh_token: refreshToken,\n      client_id: this.config.clientId,\n    });\n\n    // Add client secret if provided\n    if (this.config.clientSecret) {\n      params.append('client_secret', this.config.clientSecret);\n    }\n\n    let response = await fetch(this.config.tokenUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: params,\n    });\n\n    // If the provider rejects client_secret (public client), retry without it\n    if (!response.ok && this.config.clientSecret) {\n      const errorText = await response.text();\n      if (isPublicClientError(errorText)) {\n        params.delete('client_secret');\n        response = await fetch(this.config.tokenUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n          },\n          body: params,\n        });\n        if (!response.ok) {\n          const retryError = await response.text();\n          throw new Error(`Token refresh failed: ${response.status} ${response.statusText} - ${retryError}`);\n        }\n      } else {\n        throw new Error(`Token refresh failed: ${response.status} ${response.statusText} - ${errorText}`);\n      }\n    } else if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Token refresh failed: ${response.status} ${response.statusText} - ${error}`);\n    }\n\n    const data: any = await response.json();\n\n    // Store new token with user and account scoping\n    await this.tokenStore.storeToken(data, userId, accountId);\n\n    return data.access_token;\n  }\n\n  /**\n   * Check if token is valid\n   * @param userId - User identifier for multi-user support\n   * @param accountId - Account alias for multi-account support\n   */\n  async isTokenValid(userId?: string, accountId?: string): Promise<boolean> {\n    return this.tokenStore.isValid(this.config.refreshBeforeExpiry, userId, accountId);\n  }\n\n  /**\n   * Revoke token (if supported by provider)\n   * @param revocationUrl - Optional revocation endpoint\n   * @param userId - User identifier for multi-user support\n   * @param accountId - Account alias for multi-account support\n   */\n  async revokeToken(revocationUrl?: string, userId?: string, accountId?: string): Promise<void> {\n    if (!revocationUrl) {\n      // Just clear from storage\n      await this.tokenStore.clear(userId, accountId);\n      return;\n    }\n\n    try {\n      const token = await this.tokenStore.getAccessToken(userId, accountId);\n\n      await fetch(revocationUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        body: new URLSearchParams({\n          token,\n          client_id: this.config.clientId,\n        }),\n      });\n    } finally {\n      // Always clear from storage\n      await this.tokenStore.clear(userId, accountId);\n    }\n  }\n\n  /**\n   * List account aliases for a user.\n   * @param userId - User identifier (optional)\n   */\n  async listAccounts(userId?: string): Promise<string[]> {\n    return this.tokenStore.listAccounts(userId);\n  }\n\n  /**\n   * Clean up expired PKCE data to prevent memory leaks\n   * Removes verifiers and states older than PKCE_TTL (15 minutes)\n   */\n  private cleanupExpiredPKCE(): void {\n    const now = Date.now();\n\n    // Clean up expired code verifiers\n    for (const [key, data] of this.codeVerifiers) {\n      if (now - data.timestamp > this.PKCE_TTL) {\n        this.codeVerifiers.delete(key);\n        this.states.delete(key);\n      }\n    }\n  }\n}\n\n/**\n * Detect OAuth errors indicating the app is a public client that must not\n * present a client_secret. Covers:\n * - Microsoft/Entra ID: AADSTS700025\n * - Generic OAuth servers that return \"invalid_client\" with a hint about public clients\n */\nfunction isPublicClientError(responseBody: string): boolean {\n  const lower = responseBody.toLowerCase();\n  return (\n    lower.includes('aadsts700025') ||\n    (lower.includes('invalid_client') && lower.includes('public'))\n  );\n}\n","/**\n * OAuth 2.0 Client Credentials Flow\n * Machine-to-machine authentication\n */\n\nimport { TokenStore } from '../domain/TokenStore.js';\nimport type { OAuthConfig } from '../types.js';\n\nexport class ClientCredentialsFlow {\n  private tokenStore: TokenStore;\n\n  constructor(private config: OAuthConfig) {\n    const storageKey = config.storageKey || `client_credentials:${config.clientId}`;\n    this.tokenStore = new TokenStore(storageKey, config.storage);\n  }\n\n  /**\n   * Get token using client credentials\n   * @param userId - User identifier for multi-user support (optional, rarely used for client_credentials)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async getToken(userId?: string, accountId?: string): Promise<string> {\n    // Return cached token if valid\n    if (await this.tokenStore.isValid(this.config.refreshBeforeExpiry, userId, accountId)) {\n      return this.tokenStore.getAccessToken(userId, accountId);\n    }\n\n    // Request new token\n    return this.requestToken(userId, accountId);\n  }\n\n  /**\n   * Request a new token from the authorization server\n   */\n  private async requestToken(userId?: string, accountId?: string): Promise<string> {\n    // Create Basic Auth header\n    const auth = Buffer.from(`${this.config.clientId}:${this.config.clientSecret}`).toString(\n      'base64'\n    );\n\n    const params = new URLSearchParams({\n      grant_type: 'client_credentials',\n    });\n\n    // Add scope if provided\n    if (this.config.scope) {\n      params.append('scope', this.config.scope);\n    }\n\n    const response = await fetch(this.config.tokenUrl, {\n      method: 'POST',\n      headers: {\n        Authorization: `Basic ${auth}`,\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: params,\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`Token request failed: ${response.status} ${response.statusText} - ${error}`);\n    }\n\n    const data: any = await response.json();\n\n    // Store token (encrypted)\n    await this.tokenStore.storeToken(data, userId, accountId);\n\n    return data.access_token;\n  }\n\n  /**\n   * Refresh token (client credentials don't use refresh tokens)\n   * Just requests a new token\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async refreshToken(userId?: string, accountId?: string): Promise<string> {\n    await this.tokenStore.clear(userId, accountId);\n    return this.requestToken(userId, accountId);\n  }\n\n  /**\n   * Check if token is valid\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async isTokenValid(userId?: string, accountId?: string): Promise<boolean> {\n    return this.tokenStore.isValid(this.config.refreshBeforeExpiry, userId, accountId);\n  }\n}\n","/**\n * OAuth 2.0 JWT Bearer Flow (RFC 7523)\n * Service account authentication using private key signing\n */\n\nimport { SignJWT, importPKCS8 } from 'jose';\nimport * as fs from 'fs';\nimport { TokenStore } from '../domain/TokenStore.js';\nimport type { OAuthConfig } from '../types.js';\n\nexport class JWTBearerFlow {\n  private tokenStore: TokenStore;\n  private privateKey: string;\n\n  constructor(private config: OAuthConfig) {\n    const storageKey = config.storageKey || `jwt_bearer:${config.clientId}`;\n    this.tokenStore = new TokenStore(storageKey, config.storage);\n\n    // Load private key\n    if (config.privateKey) {\n      this.privateKey = config.privateKey;\n    } else if (config.privateKeyPath) {\n      try {\n        this.privateKey = fs.readFileSync(config.privateKeyPath, 'utf8');\n      } catch (error) {\n        throw new Error(`Failed to read private key from ${config.privateKeyPath}: ${(error as Error).message}`);\n      }\n    } else {\n      throw new Error('JWT Bearer flow requires privateKey or privateKeyPath');\n    }\n  }\n\n  /**\n   * Generate signed JWT assertion\n   */\n  private async generateJWT(): Promise<string> {\n    const now = Math.floor(Date.now() / 1000);\n    const alg = this.config.tokenSigningAlg || 'RS256';\n\n    // Parse private key\n    const key = await importPKCS8(this.privateKey, alg);\n\n    // Create JWT\n    const jwt = await new SignJWT({\n      scope: this.config.scope || '',\n    })\n      .setProtectedHeader({ alg })\n      .setIssuer(this.config.clientId)\n      .setSubject(this.config.clientId)\n      .setAudience(this.config.audience || this.config.tokenUrl)\n      .setIssuedAt(now)\n      .setExpirationTime(now + 3600) // 1 hour\n      .sign(key);\n\n    return jwt;\n  }\n\n  /**\n   * Get token using JWT Bearer assertion\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async getToken(userId?: string, accountId?: string): Promise<string> {\n    // Return cached token if valid\n    if (await this.tokenStore.isValid(this.config.refreshBeforeExpiry, userId, accountId)) {\n      return this.tokenStore.getAccessToken(userId, accountId);\n    }\n\n    // Request new token\n    return this.requestToken(userId, accountId);\n  }\n\n  /**\n   * Request token using JWT assertion\n   */\n  private async requestToken(userId?: string, accountId?: string): Promise<string> {\n    // Generate JWT assertion\n    const assertion = await this.generateJWT();\n\n    // Exchange JWT for access token\n    const params = new URLSearchParams({\n      grant_type: 'urn:ietf:params:oauth:grant-type:jwt-bearer',\n      assertion,\n    });\n\n    const response = await fetch(this.config.tokenUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: params,\n    });\n\n    if (!response.ok) {\n      const error = await response.text();\n      throw new Error(`JWT Bearer token request failed: ${response.status} ${response.statusText} - ${error}`);\n    }\n\n    const data: any = await response.json();\n\n    // Store token (encrypted)\n    await this.tokenStore.storeToken(data, userId, accountId);\n\n    return data.access_token;\n  }\n\n  /**\n   * Refresh token (generate new JWT and request new token)\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async refreshToken(userId?: string, accountId?: string): Promise<string> {\n    await this.tokenStore.clear(userId, accountId);\n    return this.requestToken(userId, accountId);\n  }\n\n  /**\n   * Check if token is valid\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async isTokenValid(userId?: string, accountId?: string): Promise<boolean> {\n    return this.tokenStore.isValid(this.config.refreshBeforeExpiry, userId, accountId);\n  }\n}\n","/**\n * Static Token Flow - For APIs that use static API keys\n * Examples: OpenAI, Anthropic, many SaaS APIs\n */\n\nimport type { OAuthConfig } from '../types.js';\n\nexport class StaticTokenFlow {\n  private token: string;\n\n  constructor(config: OAuthConfig) {\n    if (!config.staticToken) {\n      throw new Error('Static token flow requires staticToken in config');\n    }\n\n    this.token = config.staticToken;\n  }\n\n  /**\n   * Get token (always returns the static token)\n   */\n  async getToken(): Promise<string> {\n    return this.token;\n  }\n\n  /**\n   * Refresh token (no-op for static tokens)\n   */\n  async refreshToken(): Promise<string> {\n    return this.token;\n  }\n\n  /**\n   * Token is always valid for static tokens\n   */\n  async isTokenValid(): Promise<boolean> {\n    return true;\n  }\n\n  /**\n   * Update the static token\n   */\n  updateToken(newToken: string): void {\n    this.token = newToken;\n  }\n}\n","/**\n * OAuth Manager - Main entry point for OAuth 2.0 authentication\n * Supports multiple flows: Authorization Code (with PKCE), Client Credentials, JWT Bearer, Static Token\n */\n\nimport { AuthCodePKCEFlow } from './flows/AuthCodePKCE.js';\nimport { ClientCredentialsFlow } from './flows/ClientCredentials.js';\nimport { JWTBearerFlow } from './flows/JWTBearer.js';\nimport { StaticTokenFlow } from './flows/StaticToken.js';\nimport type { OAuthConfig } from './types.js';\n\nexport class OAuthManager {\n  private flow: AuthCodePKCEFlow | ClientCredentialsFlow | JWTBearerFlow | StaticTokenFlow;\n\n  constructor(config: OAuthConfig) {\n    // Validate configuration\n    this.validateConfig(config);\n\n    // Create appropriate flow implementation\n    switch (config.flow) {\n      case 'authorization_code':\n        this.flow = new AuthCodePKCEFlow(config);\n        break;\n\n      case 'client_credentials':\n        this.flow = new ClientCredentialsFlow(config);\n        break;\n\n      case 'jwt_bearer':\n        this.flow = new JWTBearerFlow(config);\n        break;\n\n      case 'static_token':\n        this.flow = new StaticTokenFlow(config);\n        break;\n\n      default:\n        throw new Error(`Unknown OAuth flow: ${(config as any).flow}`);\n    }\n  }\n\n  /**\n   * Get valid access token\n   * Automatically refreshes if expired\n   *\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async getToken(userId?: string, accountId?: string): Promise<string> {\n    return this.flow.getToken(userId, accountId);\n  }\n\n  /**\n   * Force refresh the token\n   *\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async refreshToken(userId?: string, accountId?: string): Promise<string> {\n    return this.flow.refreshToken(userId, accountId);\n  }\n\n  /**\n   * Check if current token is valid\n   *\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async isTokenValid(userId?: string, accountId?: string): Promise<boolean> {\n    return this.flow.isTokenValid(userId, accountId);\n  }\n\n  // ==================== Authorization Code Flow Methods ====================\n\n  /**\n   * Start authorization flow (Authorization Code only)\n   * Returns URL for user to visit\n   *\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   * @returns Authorization URL for the user to visit\n   */\n  async startAuthFlow(userId?: string, accountId?: string): Promise<string> {\n    if (!(this.flow instanceof AuthCodePKCEFlow)) {\n      throw new Error('startAuthFlow() is only available for authorization_code flow');\n    }\n\n    return this.flow.getAuthorizationUrl(userId, accountId);\n  }\n\n  /**\n   * Handle OAuth callback (Authorization Code only)\n   * Call this with the callback URL after user authorizes\n   *\n   * @param callbackUrl - Full callback URL with code and state parameters\n   * @param userId - Optional user identifier (can be extracted from state if embedded)\n   * @param accountId - Optional account alias (can be extracted from state if embedded)\n   */\n  async handleCallback(callbackUrl: string, userId?: string, accountId?: string): Promise<void> {\n    if (!(this.flow instanceof AuthCodePKCEFlow)) {\n      throw new Error('handleCallback() is only available for authorization_code flow');\n    }\n\n    const url = new URL(callbackUrl);\n    const code = url.searchParams.get('code');\n    const state = url.searchParams.get('state');\n\n    if (!code) {\n      throw new Error('Missing authorization code in callback URL');\n    }\n\n    if (!state) {\n      throw new Error('Missing state parameter in callback URL');\n    }\n\n    await this.flow.exchangeCode(code, state, userId, accountId);\n  }\n\n  /**\n   * Revoke token (if supported by provider)\n   *\n   * @param revocationUrl - Optional revocation endpoint URL\n   * @param userId - User identifier for multi-user support (optional)\n   * @param accountId - Account alias for multi-account support (optional)\n   */\n  async revokeToken(revocationUrl?: string, userId?: string, accountId?: string): Promise<void> {\n    if (this.flow instanceof AuthCodePKCEFlow) {\n      await this.flow.revokeToken(revocationUrl, userId, accountId);\n    } else {\n      throw new Error('Token revocation not implemented for this flow');\n    }\n  }\n\n  /**\n   * List account aliases for a user (Authorization Code only)\n   *\n   * @param userId - User identifier (optional)\n   * @returns Array of account aliases (e.g., ['work', 'personal'])\n   */\n  async listAccounts(userId?: string): Promise<string[]> {\n    if (this.flow instanceof AuthCodePKCEFlow) {\n      return this.flow.listAccounts(userId);\n    }\n    return [];\n  }\n\n  // ==================== Validation ====================\n\n  private validateConfig(config: OAuthConfig): void {\n    // Required fields\n    if (!config.flow) {\n      throw new Error('OAuth flow is required (authorization_code, client_credentials, jwt_bearer, or static_token)');\n    }\n\n    // tokenUrl and clientId not required for static_token\n    if (config.flow !== 'static_token') {\n      if (!config.tokenUrl) {\n        throw new Error('tokenUrl is required');\n      }\n\n      if (!config.clientId) {\n        throw new Error('clientId is required');\n      }\n    }\n\n    // Flow-specific validation\n    switch (config.flow) {\n      case 'authorization_code':\n        if (!config.authorizationUrl) {\n          throw new Error('authorizationUrl is required for authorization_code flow');\n        }\n        if (!config.redirectUri) {\n          throw new Error('redirectUri is required for authorization_code flow');\n        }\n        break;\n\n      case 'client_credentials':\n        if (!config.clientSecret) {\n          throw new Error('clientSecret is required for client_credentials flow');\n        }\n        break;\n\n      case 'jwt_bearer':\n        if (!config.privateKey && !config.privateKeyPath) {\n          throw new Error(\n            'privateKey or privateKeyPath is required for jwt_bearer flow'\n          );\n        }\n        break;\n\n      case 'static_token':\n        if (!config.staticToken) {\n          throw new Error('staticToken is required for static_token flow');\n        }\n        break;\n    }\n\n    // Warn if using FileStorage without encryption key\n    if (config.storage && !process.env.OAUTH_ENCRYPTION_KEY) {\n      console.warn(\n        'WARNING: Using persistent storage without OAUTH_ENCRYPTION_KEY environment variable. ' +\n          'Tokens will be encrypted with auto-generated key that changes on restart!'\n      );\n    }\n  }\n}\n","/**\n * StorageRegistry - Centralized storage backend registry\n *\n * Provides a single point of configuration for all storage backends\n * used across the library. Subsystems resolve their storage at execution\n * time (not construction time) via `resolve()`, which lazily creates\n * and caches a default when nothing has been configured.\n *\n * Storage types are split into two categories:\n * - **Global singletons**: customTools, media, agentDefinitions, connectorConfig, oauthTokens\n * - **Per-agent factories** (need agentId): sessions, persistentInstructions, workingMemory\n *\n * For multi-user / multi-tenant environments, factories receive an optional\n * `StorageContext` (opaque, like `ConnectorAccessContext`) so backends can\n * partition data by userId, tenantId, or any custom field.\n *\n * @example\n * ```typescript\n * import { StorageRegistry } from '@everworker/oneringai';\n *\n * // Single-tenant (simple)\n * StorageRegistry.configure({\n *   customTools: new MongoCustomToolStorage(),\n *   media: new S3MediaStorage(),\n *   sessions: (agentId) => new RedisContextStorage(agentId),\n * });\n *\n * // Multi-tenant\n * StorageRegistry.configure({\n *   sessions: (agentId, ctx) => new RedisContextStorage(agentId, ctx?.userId),\n *   customTools: new MongoCustomToolStorage(),  // global singletons are unaffected\n * });\n * ```\n */\n\nimport type { ICustomToolStorage } from '../domain/interfaces/ICustomToolStorage.js';\nimport type { IMediaStorage } from '../domain/interfaces/IMediaStorage.js';\nimport type { IAgentDefinitionStorage } from '../domain/interfaces/IAgentDefinitionStorage.js';\nimport type { IConnectorConfigStorage } from '../domain/interfaces/IConnectorConfigStorage.js';\nimport type { ITokenStorage } from '../connectors/oauth/domain/ITokenStorage.js';\nimport type { IContextStorage } from '../domain/interfaces/IContextStorage.js';\nimport type { IPersistentInstructionsStorage } from '../domain/interfaces/IPersistentInstructionsStorage.js';\nimport type { IMemoryStorage } from '../domain/interfaces/IMemoryStorage.js';\nimport type { IUserInfoStorage } from '../domain/interfaces/IUserInfoStorage.js';\nimport type { IRoutineDefinitionStorage } from '../domain/interfaces/IRoutineDefinitionStorage.js';\nimport type { IRoutineExecutionStorage } from '../domain/interfaces/IRoutineExecutionStorage.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/**\n * Opaque context passed to per-agent storage factories.\n *\n * The library imposes no structure  consumers define their own shape\n * (e.g., `{ userId: 'alice', tenantId: 'acme' }`).\n *\n * Mirrors the `ConnectorAccessContext` pattern used by `Connector.scoped()`.\n */\nexport type StorageContext = Record<string, unknown>;\n\n/**\n * Storage configuration map.\n *\n * Global singletons are stored directly.\n * Per-agent factories are functions that accept an agentId (and optional\n * StorageContext for multi-tenant scenarios) and return a storage instance.\n */\nexport interface StorageConfig {\n  // Global singletons\n  media: IMediaStorage;\n  agentDefinitions: IAgentDefinitionStorage;\n  connectorConfig: IConnectorConfigStorage;\n  oauthTokens: ITokenStorage;\n\n  // Context-aware factories (optional StorageContext for multi-tenant)\n  customTools: (context?: StorageContext) => ICustomToolStorage;\n  sessions: (agentId: string, context?: StorageContext) => IContextStorage;\n  persistentInstructions: (agentId: string, context?: StorageContext) => IPersistentInstructionsStorage;\n  workingMemory: (context?: StorageContext) => IMemoryStorage;\n  userInfo: (context?: StorageContext) => IUserInfoStorage;\n  routineDefinitions: (context?: StorageContext) => IRoutineDefinitionStorage;\n  routineExecutions: (context?: StorageContext) => IRoutineExecutionStorage;\n}\n\n// ============================================================================\n// StorageRegistry\n// ============================================================================\n\nexport class StorageRegistry {\n  /** Internal storage map */\n  private static entries = new Map<string, unknown>();\n\n  /** Default context passed to all factory calls (set via setContext) */\n  private static _context: StorageContext | undefined;\n\n  /**\n   * Configure multiple storage backends at once.\n   *\n   * @example\n   * ```typescript\n   * // Single-tenant\n   * StorageRegistry.configure({\n   *   customTools: new MongoCustomToolStorage(),\n   *   sessions: (agentId) => new RedisContextStorage(agentId),\n   * });\n   *\n   * // Multi-tenant\n   * StorageRegistry.configure({\n   *   sessions: (agentId, ctx) => new TenantContextStorage(agentId, ctx?.tenantId),\n   *   persistentInstructions: (agentId, ctx) => new TenantInstructionsStorage(agentId, ctx?.userId),\n   * });\n   * ```\n   */\n  static configure(config: Partial<StorageConfig>): void {\n    for (const [key, value] of Object.entries(config)) {\n      if (value !== undefined) {\n        StorageRegistry.entries.set(key, value);\n      }\n    }\n  }\n\n  /**\n   * Set the default StorageContext.\n   *\n   * This context is automatically passed to all per-agent factory calls\n   * (sessions, persistentInstructions, workingMemory) when no explicit\n   * context is provided. Typically set once at app startup with global\n   * tenant/environment info, or per-request in multi-tenant servers.\n   *\n   * @example\n   * ```typescript\n   * // Single-tenant app  set once at init\n   * StorageRegistry.setContext({ tenantId: 'acme', environment: 'production' });\n   *\n   * // Multi-tenant server  set per-request\n   * app.use((req, res, next) => {\n   *   StorageRegistry.setContext({ userId: req.user.id, tenantId: req.tenant.id });\n   *   next();\n   * });\n   * ```\n   */\n  static setContext(context: StorageContext | undefined): void {\n    StorageRegistry._context = context;\n  }\n\n  /**\n   * Get the current default StorageContext.\n   */\n  static getContext(): StorageContext | undefined {\n    return StorageRegistry._context;\n  }\n\n  /**\n   * Set a single storage backend.\n   */\n  static set<K extends keyof StorageConfig>(key: K, value: StorageConfig[K]): void {\n    StorageRegistry.entries.set(key, value);\n  }\n\n  /**\n   * Get a storage backend (or undefined if not configured).\n   */\n  static get<K extends keyof StorageConfig>(key: K): StorageConfig[K] | undefined {\n    return StorageRegistry.entries.get(key) as StorageConfig[K] | undefined;\n  }\n\n  /**\n   * Resolve a storage backend, lazily creating and caching a default if needed.\n   *\n   * If a value has been configured via `set()` or `configure()`, returns that.\n   * Otherwise, calls `defaultFactory()`, caches the result, and returns it.\n   */\n  static resolve<K extends keyof StorageConfig>(key: K, defaultFactory: () => StorageConfig[K]): StorageConfig[K] {\n    const existing = StorageRegistry.entries.get(key) as StorageConfig[K] | undefined;\n    if (existing !== undefined) {\n      return existing;\n    }\n\n    const value = defaultFactory();\n    StorageRegistry.entries.set(key, value);\n    return value;\n  }\n\n  /**\n   * Check if a storage backend has been configured.\n   */\n  static has(key: keyof StorageConfig): boolean {\n    return StorageRegistry.entries.has(key);\n  }\n\n  /**\n   * Clear all configured storage backends and context.\n   * Useful for testing.\n   */\n  static reset(): void {\n    StorageRegistry.entries.clear();\n    StorageRegistry._context = undefined;\n  }\n}\n","/**\n * Generic Circuit Breaker implementation\n *\n * Prevents cascading failures by failing fast when a system is down.\n * Works for any async operation (LLM calls, tool execution, etc.)\n */\n\nimport { EventEmitter } from 'eventemitter3';\n\n/**\n * Circuit breaker states\n */\nexport type CircuitState = 'closed' | 'open' | 'half-open';\n\n/**\n * Failure record for window tracking\n */\ninterface FailureRecord {\n  timestamp: number;\n  error: string;\n}\n\n/**\n * Circuit breaker configuration\n */\nexport interface CircuitBreakerConfig {\n  /** Number of failures before opening circuit */\n  failureThreshold: number;\n\n  /** Number of successes to close from half-open */\n  successThreshold: number;\n\n  /** Time to wait in open state before trying half-open (ms) */\n  resetTimeoutMs: number;\n\n  /** Time window for counting failures (ms) */\n  windowMs: number;\n\n  /** Classify errors - return true if error should count as failure */\n  isRetryable?: (error: Error) => boolean;\n}\n\n/**\n * Circuit breaker metrics\n */\nexport interface CircuitBreakerMetrics {\n  name: string;\n  state: CircuitState;\n\n  // Counters\n  totalRequests: number;\n  successCount: number;\n  failureCount: number;\n  rejectedCount: number; // Rejected by open circuit\n\n  // Current window\n  recentFailures: number;\n  consecutiveSuccesses: number;\n\n  // Timestamps\n  lastFailureTime?: number;\n  lastSuccessTime?: number;\n  lastStateChange: number;\n  nextRetryTime?: number;\n\n  // Rates\n  failureRate: number;\n  successRate: number;\n}\n\n/**\n * Circuit breaker events\n */\nexport interface CircuitBreakerEvents {\n  opened: { name: string; failureCount: number; lastError: string; nextRetryTime: number };\n  'half-open': { name: string; timestamp: number };\n  closed: { name: string; successCount: number; timestamp: number };\n}\n\n/**\n * Default configuration\n */\nexport const DEFAULT_CIRCUIT_BREAKER_CONFIG: CircuitBreakerConfig = {\n  failureThreshold: 5,\n  successThreshold: 2,\n  resetTimeoutMs: 30000, // 30 seconds\n  windowMs: 60000, // 1 minute\n  isRetryable: () => true, // All errors count by default\n};\n\n/**\n * Circuit breaker error - thrown when circuit is open\n */\nexport class CircuitOpenError extends Error {\n  constructor(\n    public readonly breakerName: string,\n    public readonly nextRetryTime: number,\n    public readonly failureCount: number,\n    public readonly lastError: string\n  ) {\n    const retryInSeconds = Math.ceil((nextRetryTime - Date.now()) / 1000);\n    super(\n      `Circuit breaker '${breakerName}' is OPEN. ` +\n      `Retry in ${retryInSeconds}s. ` +\n      `(${failureCount} recent failures, last: ${lastError})`\n    );\n    this.name = 'CircuitOpenError';\n  }\n}\n\n/**\n * Generic circuit breaker for any async operation\n */\nexport class CircuitBreaker<T = any> extends EventEmitter<CircuitBreakerEvents> {\n  private state: CircuitState = 'closed';\n  private config: CircuitBreakerConfig;\n\n  // Failure tracking\n  private failures: FailureRecord[] = [];\n  private lastError: string = '';\n\n  // Success tracking\n  private consecutiveSuccesses = 0;\n\n  // Timing\n  private openedAt?: number;\n  private lastStateChange: number;\n\n  // Metrics\n  private totalRequests = 0;\n  private successCount = 0;\n  private failureCount = 0;\n  private rejectedCount = 0;\n  private lastFailureTime?: number;\n  private lastSuccessTime?: number;\n\n  constructor(\n    public readonly name: string,\n    config: Partial<CircuitBreakerConfig> = {}\n  ) {\n    super();\n    this.config = { ...DEFAULT_CIRCUIT_BREAKER_CONFIG, ...config };\n    this.lastStateChange = Date.now();\n  }\n\n  /**\n   * Execute function with circuit breaker protection\n   */\n  async execute(fn: () => Promise<T>): Promise<T> {\n    this.totalRequests++;\n\n    // Check circuit state\n    const now = Date.now();\n\n    switch (this.state) {\n      case 'open':\n        // Check if timeout has expired\n        if (this.openedAt && now - this.openedAt >= this.config.resetTimeoutMs) {\n          // Transition to half-open\n          this.transitionTo('half-open');\n        } else {\n          // Still open, reject immediately\n          this.rejectedCount++;\n          const nextRetry = (this.openedAt || now) + this.config.resetTimeoutMs;\n          throw new CircuitOpenError(this.name, nextRetry, this.failures.length, this.lastError);\n        }\n        break;\n\n      case 'half-open':\n        // Allow one request through\n        break;\n\n      case 'closed':\n        // Normal operation\n        break;\n    }\n\n    // Execute the function\n    try {\n      const result = await fn();\n\n      // Success - record it\n      this.recordSuccess();\n\n      return result;\n    } catch (error) {\n      // Failure - record it\n      this.recordFailure(error as Error);\n\n      throw error;\n    }\n  }\n\n  /**\n   * Record successful execution\n   */\n  private recordSuccess(): void {\n    this.successCount++;\n    this.lastSuccessTime = Date.now();\n    this.consecutiveSuccesses++;\n\n    if (this.state === 'half-open') {\n      // Check if enough successes to close\n      if (this.consecutiveSuccesses >= this.config.successThreshold) {\n        this.transitionTo('closed');\n      }\n    } else if (this.state === 'closed') {\n      // Clean up old failures on success\n      this.pruneOldFailures();\n    }\n  }\n\n  /**\n   * Record failed execution\n   */\n  private recordFailure(error: Error): void {\n    // Check if error should count as failure\n    if (this.config.isRetryable && !this.config.isRetryable(error)) {\n      // Non-retryable error, don't count toward circuit breaker\n      return;\n    }\n\n    this.failureCount++;\n    this.lastFailureTime = Date.now();\n    this.lastError = error.message;\n\n    // Reset consecutive successes\n    this.consecutiveSuccesses = 0;\n\n    // Record failure\n    this.failures.push({\n      timestamp: Date.now(),\n      error: error.message,\n    });\n\n    // Prune old failures outside window\n    this.pruneOldFailures();\n\n    // Check if we should open the circuit\n    if (this.state === 'half-open') {\n      // Failure during half-open  back to open\n      this.transitionTo('open');\n    } else if (this.state === 'closed') {\n      // Check failure threshold\n      if (this.failures.length >= this.config.failureThreshold) {\n        this.transitionTo('open');\n      }\n    }\n  }\n\n  /**\n   * Transition to new state\n   */\n  private transitionTo(newState: CircuitState): void {\n    this.state = newState;\n    this.lastStateChange = Date.now();\n\n    switch (newState) {\n      case 'open':\n        this.openedAt = Date.now();\n        this.emit('opened', {\n          name: this.name,\n          failureCount: this.failures.length,\n          lastError: this.lastError,\n          nextRetryTime: this.openedAt + this.config.resetTimeoutMs,\n        });\n        break;\n\n      case 'half-open':\n        this.emit('half-open', {\n          name: this.name,\n          timestamp: Date.now(),\n        });\n        break;\n\n      case 'closed':\n        // Reset state\n        this.failures = [];\n        this.consecutiveSuccesses = 0;\n        this.openedAt = undefined;\n\n        this.emit('closed', {\n          name: this.name,\n          successCount: this.consecutiveSuccesses,\n          timestamp: Date.now(),\n        });\n        break;\n    }\n  }\n\n  /**\n   * Remove failures outside the time window\n   */\n  private pruneOldFailures(): void {\n    const now = Date.now();\n    const cutoff = now - this.config.windowMs;\n    this.failures = this.failures.filter((f) => f.timestamp > cutoff);\n  }\n\n  /**\n   * Get current state\n   */\n  getState(): CircuitState {\n    return this.state;\n  }\n\n  /**\n   * Get current metrics\n   */\n  getMetrics(): CircuitBreakerMetrics {\n    this.pruneOldFailures();\n\n    const total = this.successCount + this.failureCount;\n    const failureRate = total > 0 ? this.failureCount / total : 0;\n    const successRate = total > 0 ? this.successCount / total : 0;\n\n    return {\n      name: this.name,\n      state: this.state,\n      totalRequests: this.totalRequests,\n      successCount: this.successCount,\n      failureCount: this.failureCount,\n      rejectedCount: this.rejectedCount,\n      recentFailures: this.failures.length,\n      consecutiveSuccesses: this.consecutiveSuccesses,\n      lastFailureTime: this.lastFailureTime,\n      lastSuccessTime: this.lastSuccessTime,\n      lastStateChange: this.lastStateChange,\n      nextRetryTime: this.openedAt ? this.openedAt + this.config.resetTimeoutMs : undefined,\n      failureRate,\n      successRate,\n    };\n  }\n\n  /**\n   * Manually reset circuit breaker (force close)\n   */\n  reset(): void {\n    this.transitionTo('closed');\n    this.totalRequests = 0;\n    this.successCount = 0;\n    this.failureCount = 0;\n    this.rejectedCount = 0;\n    this.lastFailureTime = undefined;\n    this.lastSuccessTime = undefined;\n  }\n\n  /**\n   * Check if circuit is allowing requests\n   */\n  isOpen(): boolean {\n    if (this.state === 'open' && this.openedAt) {\n      const now = Date.now();\n      if (now - this.openedAt >= this.config.resetTimeoutMs) {\n        // Should transition to half-open\n        this.transitionTo('half-open');\n        return false;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Get configuration\n   */\n  getConfig(): CircuitBreakerConfig {\n    return { ...this.config };\n  }\n}\n","/**\n * Backoff strategies for retry logic\n */\n\n/**\n * Backoff strategy type\n */\nexport type BackoffStrategyType = 'exponential' | 'linear' | 'constant';\n\n/**\n * Backoff configuration\n */\nexport interface BackoffConfig {\n  /** Strategy type */\n  strategy: BackoffStrategyType;\n\n  /** Initial delay in ms */\n  initialDelayMs: number;\n\n  /** Maximum delay in ms */\n  maxDelayMs: number;\n\n  /** Multiplier for exponential (default: 2) */\n  multiplier?: number;\n\n  /** Increment for linear (default: 1000ms) */\n  incrementMs?: number;\n\n  /** Add random jitter to prevent thundering herd */\n  jitter?: boolean;\n\n  /** Jitter factor (0-1, default: 0.1 = 10%) */\n  jitterFactor?: number;\n\n  /** Classify errors - return true if error should be retried */\n  isRetryable?: (error: Error) => boolean;\n}\n\n/**\n * Default backoff configuration\n */\nexport const DEFAULT_BACKOFF_CONFIG: BackoffConfig = {\n  strategy: 'exponential',\n  initialDelayMs: 1000, // 1 second\n  maxDelayMs: 30000, // 30 seconds\n  multiplier: 2,\n  jitter: true,\n  jitterFactor: 0.1,\n};\n\n/**\n * Calculate backoff delay for given attempt\n */\nexport function calculateBackoff(attempt: number, config: BackoffConfig = DEFAULT_BACKOFF_CONFIG): number {\n  let delay: number;\n\n  switch (config.strategy) {\n    case 'exponential':\n      delay = config.initialDelayMs * Math.pow(config.multiplier || 2, attempt - 1);\n      break;\n\n    case 'linear':\n      delay = config.initialDelayMs + (config.incrementMs || 1000) * (attempt - 1);\n      break;\n\n    case 'constant':\n      delay = config.initialDelayMs;\n      break;\n\n    default:\n      delay = config.initialDelayMs;\n  }\n\n  // Cap at max delay\n  delay = Math.min(delay, config.maxDelayMs);\n\n  // Add jitter if enabled\n  if (config.jitter) {\n    delay = addJitter(delay, config.jitterFactor || 0.1);\n  }\n\n  return Math.floor(delay);\n}\n\n/**\n * Add random jitter to a delay\n *\n * @param delay - Base delay in ms\n * @param factor - Jitter factor (0-1), default 0.1 = 10%\n * @returns delay with jitter applied\n */\nexport function addJitter(delay: number, factor: number = 0.1): number {\n  // Calculate jitter range\n  const jitterRange = delay * factor;\n\n  // Add random value in range [-jitterRange, +jitterRange]\n  const jitter = (Math.random() * 2 - 1) * jitterRange;\n\n  return delay + jitter;\n}\n\n/**\n * Wait for backoff delay\n */\nexport async function backoffWait(attempt: number, config: BackoffConfig = DEFAULT_BACKOFF_CONFIG): Promise<number> {\n  const delay = calculateBackoff(attempt, config);\n\n  await new Promise((resolve) => setTimeout(resolve, delay));\n\n  return delay;\n}\n\n/**\n * Backoff iterator - generates delays for each attempt\n */\nexport function* backoffSequence(\n  config: BackoffConfig = DEFAULT_BACKOFF_CONFIG,\n  maxAttempts?: number\n): Generator<number, void, unknown> {\n  let attempt = 1;\n\n  while (true) {\n    if (maxAttempts && attempt > maxAttempts) {\n      return;\n    }\n\n    yield calculateBackoff(attempt, config);\n    attempt++;\n  }\n}\n\n/**\n * Retry with backoff\n *\n * @param fn - Function to execute\n * @param config - Backoff configuration\n * @param maxAttempts - Max retry attempts (default: unlimited)\n * @returns Result of fn()\n */\nexport async function retryWithBackoff<T>(\n  fn: () => Promise<T>,\n  config: BackoffConfig = DEFAULT_BACKOFF_CONFIG,\n  maxAttempts?: number\n): Promise<T> {\n  let attempt = 0;\n  let lastError: Error;\n\n  while (true) {\n    attempt++;\n\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error as Error;\n\n      // Check if we should retry\n      if (config.isRetryable && !config.isRetryable(lastError)) {\n        // Non-retryable error, throw immediately\n        throw lastError;\n      }\n\n      // Check max attempts\n      if (maxAttempts && attempt >= maxAttempts) {\n        throw lastError;\n      }\n\n      // Wait before retrying\n      await backoffWait(attempt, config);\n    }\n  }\n}\n","/**\n * Structured logging infrastructure\n *\n * Provides framework-wide structured logging with context propagation.\n * Supports console output (default) with optional file output.\n *\n * Environment variables:\n * - LOG_LEVEL: trace|debug|info|warn|error|silent (default: info)\n * - LOG_FILE: Path to log file (optional, default: console output)\n * - LOG_PRETTY: true|false (default: true in development)\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\n\n/**\n * Log level\n */\nexport type LogLevel = 'trace' | 'debug' | 'info' | 'warn' | 'error' | 'silent';\n\n/**\n * Log levels as numbers (for comparison)\n */\nconst LOG_LEVEL_VALUES: Record<LogLevel, number> = {\n  trace: 10,\n  debug: 20,\n  info: 30,\n  warn: 40,\n  error: 50,\n  silent: 100,\n};\n\n/**\n * Safe JSON stringify that handles circular references and problematic objects\n */\nfunction safeStringify(obj: unknown, indent?: number): string {\n  const seen = new WeakSet();\n\n  const replacer = (_key: string, value: unknown): unknown => {\n    // Handle null/undefined\n    if (value === null || value === undefined) {\n      return value;\n    }\n\n    // Handle primitive types\n    if (typeof value !== 'object') {\n      // Handle functions\n      if (typeof value === 'function') {\n        return '[Function]';\n      }\n      // Handle BigInt\n      if (typeof value === 'bigint') {\n        return value.toString();\n      }\n      return value;\n    }\n\n    // Handle special objects that shouldn't be serialized\n    const objValue = value as object;\n    const constructor = objValue.constructor?.name || '';\n\n    // Skip Node.js internal objects that cause circular reference issues\n    if (\n      constructor === 'Timeout' ||\n      constructor === 'TimersList' ||\n      constructor === 'Socket' ||\n      constructor === 'Server' ||\n      constructor === 'IncomingMessage' ||\n      constructor === 'ServerResponse' ||\n      constructor === 'WriteStream' ||\n      constructor === 'ReadStream' ||\n      constructor === 'EventEmitter'\n    ) {\n      return `[${constructor}]`;\n    }\n\n    // Handle circular references\n    if (seen.has(objValue)) {\n      return '[Circular]';\n    }\n\n    // Handle Error objects specially\n    if (objValue instanceof Error) {\n      return {\n        name: objValue.name,\n        message: objValue.message,\n        stack: objValue.stack,\n      };\n    }\n\n    // Handle Date\n    if (objValue instanceof Date) {\n      return objValue.toISOString();\n    }\n\n    // Handle Map\n    if (objValue instanceof Map) {\n      return Object.fromEntries(objValue);\n    }\n\n    // Handle Set\n    if (objValue instanceof Set) {\n      return Array.from(objValue);\n    }\n\n    // Handle Buffer\n    if (Buffer.isBuffer(objValue)) {\n      return `[Buffer(${objValue.length})]`;\n    }\n\n    // Add to seen set for circular reference detection\n    seen.add(objValue);\n\n    return value;\n  };\n\n  try {\n    return JSON.stringify(obj, replacer, indent);\n  } catch {\n    // Fallback if stringify still fails\n    return '[Unserializable]';\n  }\n}\n\n/**\n * Logger configuration\n */\nexport interface LoggerConfig {\n  /** Log level */\n  level?: LogLevel;\n\n  /** Pretty print for development */\n  pretty?: boolean;\n\n  /** Base context added to all logs */\n  context?: Record<string, any>;\n\n  /** Custom destination (default: console) */\n  destination?: 'console' | 'stdout' | 'stderr';\n\n  /** File path for file logging */\n  filePath?: string;\n}\n\n/**\n * Log entry\n */\nexport interface LogEntry {\n  level: LogLevel;\n  time: number;\n  msg: string;\n  [key: string]: any;\n}\n\n/**\n * Framework logger\n */\nexport class FrameworkLogger {\n  private config: LoggerConfig;\n  private context: Record<string, any>;\n  private levelValue: number;\n  private fileStream?: fs.WriteStream;\n\n  constructor(config: LoggerConfig = {}) {\n    this.config = {\n      level: (config.level || process.env.LOG_LEVEL || 'info') as LogLevel,\n      pretty: config.pretty ?? (process.env.LOG_PRETTY === 'true' || process.env.NODE_ENV === 'development'),\n      destination: config.destination || 'console',\n      context: config.context || {},\n      filePath: config.filePath || process.env.LOG_FILE,\n    };\n\n    this.context = this.config.context || {};\n    this.levelValue = LOG_LEVEL_VALUES[this.config.level || 'info'];\n\n    // Initialize file stream if file path is provided\n    if (this.config.filePath) {\n      this.initFileStream(this.config.filePath);\n    }\n  }\n\n  /**\n   * Initialize file stream for logging\n   */\n  private initFileStream(filePath: string): void {\n    try {\n      // Ensure directory exists\n      const dir = path.dirname(filePath);\n      if (!fs.existsSync(dir)) {\n        fs.mkdirSync(dir, { recursive: true });\n      }\n\n      // Create write stream with append mode\n      this.fileStream = fs.createWriteStream(filePath, {\n        flags: 'a', // append mode\n        encoding: 'utf8',\n      });\n\n      // Handle stream errors\n      this.fileStream.on('error', (err) => {\n        console.error(`[Logger] File stream error: ${err.message}`);\n        this.fileStream = undefined;\n      });\n    } catch (err) {\n      console.error(`[Logger] Failed to initialize log file: ${err instanceof Error ? err.message : err}`);\n    }\n  }\n\n  /**\n   * Create child logger with additional context\n   */\n  child(context: Record<string, any>): FrameworkLogger {\n    return new FrameworkLogger({\n      ...this.config,\n      context: { ...this.context, ...context },\n    });\n  }\n\n  /**\n   * Trace log\n   */\n  trace(obj: Record<string, any> | string, msg?: string): void {\n    this.log('trace', obj, msg);\n  }\n\n  /**\n   * Debug log\n   */\n  debug(obj: Record<string, any> | string, msg?: string): void {\n    this.log('debug', obj, msg);\n  }\n\n  /**\n   * Info log\n   */\n  info(obj: Record<string, any> | string, msg?: string): void {\n    this.log('info', obj, msg);\n  }\n\n  /**\n   * Warn log\n   */\n  warn(obj: Record<string, any> | string, msg?: string): void {\n    this.log('warn', obj, msg);\n  }\n\n  /**\n   * Error log\n   */\n  error(obj: Record<string, any> | string, msg?: string): void {\n    this.log('error', obj, msg);\n  }\n\n  /**\n   * Internal log method\n   */\n  private log(level: LogLevel, obj: Record<string, any> | string, msg?: string): void {\n    // Check if this level should be logged\n    if (LOG_LEVEL_VALUES[level] < this.levelValue) {\n      return;\n    }\n\n    // Parse arguments\n    let data: Record<string, any>;\n    let message: string;\n\n    if (typeof obj === 'string') {\n      message = obj;\n      data = {};\n    } else {\n      message = msg || '';\n      data = obj;\n    }\n\n    // Create log entry\n    const entry: LogEntry = {\n      level,\n      time: Date.now(),\n      ...this.context,\n      ...data,\n      msg: message,\n    };\n\n    // Output\n    this.output(entry);\n  }\n\n  /**\n   * Output log entry\n   */\n  private output(entry: LogEntry): void {\n    if (this.config.pretty) {\n      this.prettyPrint(entry);\n    } else {\n      this.jsonPrint(entry);\n    }\n  }\n\n  /**\n   * Pretty print for development\n   */\n  private prettyPrint(entry: LogEntry): void {\n    const levelColors: Record<LogLevel, string> = {\n      trace: '\\x1b[90m', // Gray\n      debug: '\\x1b[36m', // Cyan\n      info: '\\x1b[32m', // Green\n      warn: '\\x1b[33m', // Yellow\n      error: '\\x1b[31m', // Red\n      silent: '',\n    };\n\n    const reset = '\\x1b[0m';\n    const color = this.fileStream ? '' : levelColors[entry.level] || ''; // No colors in file\n\n    // Format time\n    const time = new Date(entry.time).toISOString().substring(11, 23);\n\n    // Format level\n    const levelStr = entry.level.toUpperCase().padEnd(5);\n\n    // Format context\n    const contextParts: string[] = [];\n    for (const [key, value] of Object.entries(entry)) {\n      if (key !== 'level' && key !== 'time' && key !== 'msg') {\n        contextParts.push(`${key}=${safeStringify(value)}`);\n      }\n    }\n    const context = contextParts.length > 0 ? ` ${contextParts.join(' ')}` : '';\n\n    // Output\n    const output = `${color}[${time}] ${levelStr}${reset} ${entry.msg}${context}`;\n\n    // Write to file if available\n    if (this.fileStream) {\n      // Strip ANSI color codes for file output\n      const cleanOutput = output.replace(/\\x1b\\[[0-9;]*m/g, '');\n      this.fileStream.write(cleanOutput + '\\n');\n      return;\n    }\n\n    // Console output\n    switch (entry.level) {\n      case 'error':\n      case 'warn':\n        console.error(output);\n        break;\n      default:\n        console.log(output);\n    }\n  }\n\n  /**\n   * JSON print for production\n   */\n  private jsonPrint(entry: LogEntry): void {\n    const json = safeStringify(entry);\n\n    // Write to file if available\n    if (this.fileStream) {\n      this.fileStream.write(json + '\\n');\n      return;\n    }\n\n    // Console output\n    switch (this.config.destination) {\n      case 'stderr':\n        console.error(json);\n        break;\n      default:\n        console.log(json);\n    }\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(config: Partial<LoggerConfig>): void {\n    this.config = { ...this.config, ...config };\n\n    if (config.level) {\n      this.levelValue = LOG_LEVEL_VALUES[config.level];\n    }\n\n    if (config.context) {\n      this.context = { ...this.context, ...config.context };\n    }\n\n    // Reinitialize file stream if file path changed\n    if (config.filePath !== undefined) {\n      this.closeFileStream();\n      if (config.filePath) {\n        this.initFileStream(config.filePath);\n      }\n    }\n  }\n\n  /**\n   * Close file stream\n   */\n  private closeFileStream(): void {\n    if (this.fileStream) {\n      this.fileStream.end();\n      this.fileStream = undefined;\n    }\n  }\n\n  /**\n   * Cleanup resources (call before process exit)\n   */\n  close(): void {\n    this.closeFileStream();\n  }\n\n  /**\n   * Get current log level\n   */\n  getLevel(): LogLevel {\n    return this.config.level || 'info';\n  }\n\n  /**\n   * Check if level is enabled\n   */\n  isLevelEnabled(level: LogLevel): boolean {\n    return LOG_LEVEL_VALUES[level] >= this.levelValue;\n  }\n}\n\n/**\n * Global logger singleton\n */\nexport const logger = new FrameworkLogger({\n  level: (process.env.LOG_LEVEL as LogLevel) || 'info',\n  pretty: process.env.LOG_PRETTY === 'true' || process.env.NODE_ENV === 'development',\n  filePath: process.env.LOG_FILE,\n});\n\n/**\n * Cleanup logger on process exit\n */\nprocess.on('exit', () => {\n  logger.close();\n});\n\nprocess.on('SIGINT', () => {\n  logger.close();\n  process.exit(0);\n});\n\nprocess.on('SIGTERM', () => {\n  logger.close();\n  process.exit(0);\n});\n","/**\n * Metrics collection infrastructure\n *\n * Pluggable metrics system with support for various backends.\n */\n\n/**\n * Metric tags\n */\nexport type MetricTags = Record<string, string | number | boolean>;\n\n/**\n * Metrics collector interface\n */\nexport interface MetricsCollector {\n  /**\n   * Increment a counter\n   */\n  increment(metric: string, value?: number, tags?: MetricTags): void;\n\n  /**\n   * Set a gauge value\n   */\n  gauge(metric: string, value: number, tags?: MetricTags): void;\n\n  /**\n   * Record a timing/duration\n   */\n  timing(metric: string, duration: number, tags?: MetricTags): void;\n\n  /**\n   * Record a histogram value\n   */\n  histogram(metric: string, value: number, tags?: MetricTags): void;\n}\n\n/**\n * No-op metrics collector (default - zero overhead)\n */\nexport class NoOpMetrics implements MetricsCollector {\n  increment(): void {}\n  gauge(): void {}\n  timing(): void {}\n  histogram(): void {}\n}\n\n/**\n * Console metrics collector (development/debugging)\n */\nexport class ConsoleMetrics implements MetricsCollector {\n  private prefix: string;\n\n  constructor(prefix: string = 'oneringai') {\n    this.prefix = prefix;\n  }\n\n  increment(metric: string, value: number = 1, tags?: MetricTags): void {\n    this.log('COUNTER', metric, value, tags);\n  }\n\n  gauge(metric: string, value: number, tags?: MetricTags): void {\n    this.log('GAUGE', metric, value, tags);\n  }\n\n  timing(metric: string, duration: number, tags?: MetricTags): void {\n    this.log('TIMING', metric, `${duration}ms`, tags);\n  }\n\n  histogram(metric: string, value: number, tags?: MetricTags): void {\n    this.log('HISTOGRAM', metric, value, tags);\n  }\n\n  private log(type: string, metric: string, value: any, tags?: MetricTags): void {\n    const fullMetric = `${this.prefix}.${metric}`;\n    const tagsStr = tags ? ` ${JSON.stringify(tags)}` : '';\n    console.log(`[METRIC:${type}] ${fullMetric}=${value}${tagsStr}`);\n  }\n}\n\n/**\n * In-memory metrics aggregator (testing/development)\n */\nexport class InMemoryMetrics implements MetricsCollector {\n  private counters = new Map<string, number>();\n  private gauges = new Map<string, number>();\n  private timings = new Map<string, number[]>();\n  private histograms = new Map<string, number[]>();\n\n  increment(metric: string, value: number = 1, tags?: MetricTags): void {\n    const key = this.makeKey(metric, tags);\n    this.counters.set(key, (this.counters.get(key) || 0) + value);\n  }\n\n  gauge(metric: string, value: number, tags?: MetricTags): void {\n    const key = this.makeKey(metric, tags);\n    this.gauges.set(key, value);\n  }\n\n  timing(metric: string, duration: number, tags?: MetricTags): void {\n    const key = this.makeKey(metric, tags);\n    const timings = this.timings.get(key) || [];\n    timings.push(duration);\n    this.timings.set(key, timings);\n  }\n\n  histogram(metric: string, value: number, tags?: MetricTags): void {\n    const key = this.makeKey(metric, tags);\n    const values = this.histograms.get(key) || [];\n    values.push(value);\n    this.histograms.set(key, values);\n  }\n\n  private makeKey(metric: string, tags?: MetricTags): string {\n    if (!tags) return metric;\n    const tagStr = Object.entries(tags)\n      .map(([k, v]) => `${k}:${v}`)\n      .sort()\n      .join(',');\n    return `${metric}{${tagStr}}`;\n  }\n\n  /**\n   * Get all metrics (for testing)\n   */\n  getMetrics(): {\n    counters: Map<string, number>;\n    gauges: Map<string, number>;\n    timings: Map<string, number[]>;\n    histograms: Map<string, number[]>;\n  } {\n    return {\n      counters: new Map(this.counters),\n      gauges: new Map(this.gauges),\n      timings: new Map(this.timings),\n      histograms: new Map(this.histograms),\n    };\n  }\n\n  /**\n   * Clear all metrics\n   */\n  clear(): void {\n    this.counters.clear();\n    this.gauges.clear();\n    this.timings.clear();\n    this.histograms.clear();\n  }\n\n  /**\n   * Get summary statistics for timings\n   */\n  getTimingStats(metric: string, tags?: MetricTags): {\n    count: number;\n    min: number;\n    max: number;\n    mean: number;\n    p50: number;\n    p95: number;\n    p99: number;\n  } | null {\n    const key = this.makeKey(metric, tags);\n    const timings = this.timings.get(key);\n\n    if (!timings || timings.length === 0) {\n      return null;\n    }\n\n    const sorted = [...timings].sort((a, b) => a - b);\n    const count = sorted.length;\n    const sum = sorted.reduce((a, b) => a + b, 0);\n\n    return {\n      count,\n      min: sorted[0] ?? 0,\n      max: sorted[count - 1] ?? 0,\n      mean: sum / count,\n      p50: sorted[Math.floor(count * 0.5)] ?? 0,\n      p95: sorted[Math.floor(count * 0.95)] ?? 0,\n      p99: sorted[Math.floor(count * 0.99)] ?? 0,\n    };\n  }\n}\n\n/**\n * Metrics collector type\n */\nexport type MetricsCollectorType = 'noop' | 'console' | 'inmemory';\n\n/**\n * Create metrics collector from type\n */\nexport function createMetricsCollector(type?: MetricsCollectorType, prefix?: string): MetricsCollector {\n  const collectorType = type || (process.env.METRICS_COLLECTOR as MetricsCollectorType) || 'noop';\n\n  switch (collectorType) {\n    case 'console':\n      return new ConsoleMetrics(prefix);\n    case 'inmemory':\n      return new InMemoryMetrics();\n    default:\n      return new NoOpMetrics();\n  }\n}\n\n/**\n * Global metrics singleton\n */\nexport const metrics: MetricsCollector = createMetricsCollector(\n  undefined,\n  process.env.METRICS_PREFIX || 'oneringai'\n);\n\n/**\n * Update global metrics collector\n */\nexport function setMetricsCollector(collector: MetricsCollector): void {\n  Object.assign(metrics, collector);\n}\n","/**\n * ScopedConnectorRegistry - Filtered view over the Connector registry\n *\n * Provides access-controlled connector lookup by delegating to\n * Connector static methods and filtering through an IConnectorAccessPolicy.\n *\n * Security: get() on a denied connector throws the same \"not found\" error\n * listing only visible connectors  no information leakage.\n */\n\nimport { Connector } from './Connector.js';\nimport type { IConnectorRegistry } from '../domain/interfaces/IConnectorRegistry.js';\nimport type { IConnectorAccessPolicy, ConnectorAccessContext } from '../domain/interfaces/IConnectorAccessPolicy.js';\n\nexport class ScopedConnectorRegistry implements IConnectorRegistry {\n  constructor(\n    private readonly policy: IConnectorAccessPolicy,\n    private readonly context: ConnectorAccessContext\n  ) {}\n\n  get(name: string): Connector {\n    if (!Connector.has(name)) {\n      const available = this.list().join(', ') || 'none';\n      throw new Error(`Connector '${name}' not found. Available: ${available}`);\n    }\n    const connector = Connector.get(name);\n    if (!this.policy.canAccess(connector, this.context)) {\n      // Same error message shape  no information leakage about existence\n      const available = this.list().join(', ') || 'none';\n      throw new Error(`Connector '${name}' not found. Available: ${available}`);\n    }\n    return connector;\n  }\n\n  has(name: string): boolean {\n    if (!Connector.has(name)) return false;\n    const connector = Connector.get(name);\n    return this.policy.canAccess(connector, this.context);\n  }\n\n  list(): string[] {\n    return this.listAll().map((c) => c.name);\n  }\n\n  listAll(): Connector[] {\n    return Connector.listAll().filter((c) => this.policy.canAccess(c, this.context));\n  }\n\n  size(): number {\n    return this.listAll().length;\n  }\n\n  getDescriptionsForTools(): string {\n    const connectors = this.listAll();\n    if (connectors.length === 0) {\n      return 'No connectors registered yet.';\n    }\n    return connectors\n      .map((c) => `  - \"${c.name}\": ${c.displayName} - ${c.config.description || 'No description'}`)\n      .join('\\n');\n  }\n\n  getInfo(): Record<string, { displayName: string; description: string; baseURL: string }> {\n    const info: Record<string, { displayName: string; description: string; baseURL: string }> = {};\n    for (const connector of this.listAll()) {\n      info[connector.name] = {\n        displayName: connector.displayName,\n        description: connector.config.description || '',\n        baseURL: connector.baseURL,\n      };\n    }\n    return info;\n  }\n}\n","/**\n * Connector - The single source of truth for authentication\n *\n * Manages authenticated connections to:\n * - AI providers (OpenAI, Anthropic, Google, etc.)\n * - External APIs (GitHub, Salesforce, etc.)\n *\n * Enterprise features:\n * - Request timeout with AbortController\n * - Circuit breaker for failing services\n * - Retry with exponential backoff\n * - Request/response logging\n */\n\nimport { ConnectorConfig, ConnectorAuth } from '../domain/entities/Connector.js';\nimport { Vendor } from './Vendor.js';\nimport { OAuthManager } from '../connectors/oauth/OAuthManager.js';\nimport { MemoryStorage } from '../connectors/oauth/infrastructure/storage/MemoryStorage.js';\nimport type { ITokenStorage } from '../connectors/oauth/domain/ITokenStorage.js';\nimport { StorageRegistry } from './StorageRegistry.js';\nimport { CircuitBreaker } from '../infrastructure/resilience/CircuitBreaker.js';\nimport { calculateBackoff, BackoffConfig } from '../infrastructure/resilience/BackoffStrategy.js';\nimport { logger } from '../infrastructure/observability/Logger.js';\nimport { metrics } from '../infrastructure/observability/Metrics.js';\nimport type { IConnectorRegistry } from '../domain/interfaces/IConnectorRegistry.js';\nimport type { IConnectorAccessPolicy, ConnectorAccessContext } from '../domain/interfaces/IConnectorAccessPolicy.js';\nimport { ScopedConnectorRegistry } from './ScopedConnectorRegistry.js';\n\n/**\n * Default configuration values for resilience features\n */\nexport const DEFAULT_CONNECTOR_TIMEOUT = 30000; // 30 seconds\nexport const DEFAULT_MAX_RETRIES = 3;\nexport const DEFAULT_RETRYABLE_STATUSES = [429, 500, 502, 503, 504];\nexport const DEFAULT_BASE_DELAY_MS = 1000;\nexport const DEFAULT_MAX_DELAY_MS = 30000;\n\n/**\n * Fetch options with additional connector-specific settings\n */\nexport interface ConnectorFetchOptions extends RequestInit {\n  /** Override timeout for this request */\n  timeout?: number;\n  /** Skip retry for this request */\n  skipRetry?: boolean;\n  /** Skip circuit breaker for this request */\n  skipCircuitBreaker?: boolean;\n}\n\n/**\n * Connector class - represents a single authenticated connection\n */\nexport class Connector {\n  // ============ Static Registry ============\n\n  private static registry: Map<string, Connector> = new Map();\n\n  /**\n   * Create and register a new connector\n   * @param config - Must include `name` field\n   */\n  static create(config: ConnectorConfig & { name: string }): Connector {\n    if (!config.name || config.name.trim().length === 0) {\n      throw new Error('Connector name is required');\n    }\n    if (Connector.registry.has(config.name)) {\n      throw new Error(`Connector '${config.name}' already exists. Use Connector.get() or choose a different name.`);\n    }\n    const connector = new Connector(config);\n    Connector.registry.set(config.name, connector);\n    return connector;\n  }\n\n  /**\n   * Get a connector by name\n   */\n  static get(name: string): Connector {\n    const connector = Connector.registry.get(name);\n    if (!connector) {\n      const available = Connector.list().join(', ') || 'none';\n      throw new Error(`Connector '${name}' not found. Available: ${available}`);\n    }\n    return connector;\n  }\n\n  /**\n   * Check if a connector exists\n   */\n  static has(name: string): boolean {\n    return Connector.registry.has(name);\n  }\n\n  /**\n   * List all registered connector names\n   */\n  static list(): string[] {\n    return Array.from(Connector.registry.keys());\n  }\n\n  /**\n   * Remove a connector\n   */\n  static remove(name: string): boolean {\n    const connector = Connector.registry.get(name);\n    if (connector) {\n      connector.dispose();\n    }\n    return Connector.registry.delete(name);\n  }\n\n  /**\n   * Clear all connectors (useful for testing)\n   */\n  static clear(): void {\n    for (const connector of Connector.registry.values()) {\n      connector.dispose();\n    }\n    Connector.registry.clear();\n  }\n\n  /**\n   * Get the default token storage for OAuth connectors.\n   * Resolves from StorageRegistry, falling back to MemoryStorage.\n   */\n  private static get defaultStorage(): ITokenStorage {\n    return StorageRegistry.resolve('oauthTokens', () => new MemoryStorage());\n  }\n\n  /**\n   * Set default token storage for OAuth connectors\n   */\n  static setDefaultStorage(storage: ITokenStorage): void {\n    StorageRegistry.set('oauthTokens', storage);\n  }\n\n  /**\n   * Get all registered connectors\n   */\n  static listAll(): Connector[] {\n    return Array.from(Connector.registry.values());\n  }\n\n  /**\n   * Get number of registered connectors\n   */\n  static size(): number {\n    return Connector.registry.size;\n  }\n\n  // ============ Access Control ============\n\n  private static _accessPolicy: IConnectorAccessPolicy | null = null;\n\n  /**\n   * Set a global access policy for connector scoping.\n   * Pass null to clear the policy.\n   */\n  static setAccessPolicy(policy: IConnectorAccessPolicy | null): void {\n    Connector._accessPolicy = policy;\n  }\n\n  /**\n   * Get the current global access policy (or null if none set).\n   */\n  static getAccessPolicy(): IConnectorAccessPolicy | null {\n    return Connector._accessPolicy;\n  }\n\n  /**\n   * Create a scoped (filtered) view of the connector registry.\n   * Requires a global access policy to be set via setAccessPolicy().\n   *\n   * @param context - Opaque context passed to the policy (e.g., { userId, tenantId })\n   * @returns IConnectorRegistry that only exposes accessible connectors\n   * @throws Error if no access policy is set\n   */\n  static scoped(context: ConnectorAccessContext): IConnectorRegistry {\n    if (!Connector._accessPolicy) {\n      throw new Error('No access policy set. Call Connector.setAccessPolicy() first.');\n    }\n    return new ScopedConnectorRegistry(Connector._accessPolicy, context);\n  }\n\n  /**\n   * Return the static Connector methods as an IConnectorRegistry object (unfiltered).\n   * Useful when code accepts the interface but you want the full admin view.\n   */\n  static asRegistry(): IConnectorRegistry {\n    return {\n      get: (name: string) => Connector.get(name),\n      has: (name: string) => Connector.has(name),\n      list: () => Connector.list(),\n      listAll: () => Connector.listAll(),\n      size: () => Connector.size(),\n      getDescriptionsForTools: () => Connector.getDescriptionsForTools(),\n      getInfo: () => Connector.getInfo(),\n    };\n  }\n\n  /**\n   * Get connector descriptions formatted for tool parameters\n   * Useful for generating dynamic tool descriptions\n   */\n  static getDescriptionsForTools(): string {\n    const connectors = Connector.listAll();\n\n    if (connectors.length === 0) {\n      return 'No connectors registered yet.';\n    }\n\n    return connectors\n      .map((c) => `  - \"${c.name}\": ${c.displayName} - ${c.config.description || 'No description'}`)\n      .join('\\n');\n  }\n\n  /**\n   * Get connector info (for tools and documentation)\n   */\n  static getInfo(): Record<string, { displayName: string; description: string; baseURL: string }> {\n    const info: Record<string, { displayName: string; description: string; baseURL: string }> = {};\n\n    for (const connector of Connector.registry.values()) {\n      info[connector.name] = {\n        displayName: connector.displayName,\n        description: connector.config.description || '',\n        baseURL: connector.baseURL,\n      };\n    }\n\n    return info;\n  }\n\n  // ============ Instance ============\n\n  readonly name: string;\n  readonly vendor?: Vendor;\n  readonly config: ConnectorConfig;\n\n  private oauthManager?: OAuthManager;\n  private circuitBreaker?: CircuitBreaker;\n  private disposed = false;\n\n  // Metrics\n  private requestCount = 0;\n  private successCount = 0;\n  private failureCount = 0;\n  private totalLatencyMs = 0;\n\n  private constructor(config: ConnectorConfig & { name: string }) {\n    this.name = config.name;\n    this.vendor = config.vendor;\n    this.config = config;\n\n    // Initialize OAuth manager for OAuth and JWT auth types\n    if (config.auth.type === 'oauth') {\n      this.initOAuthManager(config.auth);\n    } else if (config.auth.type === 'jwt') {\n      this.initJWTManager(config.auth);\n    }\n\n    // Initialize circuit breaker if enabled (default: true)\n    this.initCircuitBreaker();\n  }\n\n  /**\n   * Initialize circuit breaker with config or defaults\n   */\n  private initCircuitBreaker(): void {\n    const cbConfig = this.config.circuitBreaker;\n    const enabled = cbConfig?.enabled ?? true;\n\n    if (enabled) {\n      this.circuitBreaker = new CircuitBreaker(`connector:${this.name}`, {\n        failureThreshold: cbConfig?.failureThreshold ?? 5,\n        successThreshold: cbConfig?.successThreshold ?? 2,\n        resetTimeoutMs: cbConfig?.resetTimeoutMs ?? 30000,\n        windowMs: 60000, // 1 minute window\n        isRetryable: (error) => {\n          // Don't count client errors (4xx except 429) as circuit breaker failures\n          if (error.message.includes('HTTP 4') && !error.message.includes('HTTP 429')) {\n            return false;\n          }\n          return true;\n        },\n      });\n\n      // Log circuit breaker state changes\n      this.circuitBreaker.on('opened', ({ name, failureCount, lastError }) => {\n        logger.warn(`Circuit breaker opened for ${name}: ${failureCount} failures, last error: ${lastError}`);\n        metrics.increment('connector.circuit_breaker.opened', 1, { connector: this.name });\n      });\n\n      this.circuitBreaker.on('closed', ({ name }) => {\n        logger.info(`Circuit breaker closed for ${name}`);\n        metrics.increment('connector.circuit_breaker.closed', 1, { connector: this.name });\n      });\n    }\n  }\n\n  /**\n   * Human-readable display name\n   */\n  get displayName(): string {\n    return this.config.displayName || this.name;\n  }\n\n  /**\n   * API base URL for this connector\n   */\n  get baseURL(): string {\n    return this.config.baseURL || '';\n  }\n\n  /**\n   * Get the API key (for api_key auth type)\n   */\n  getApiKey(): string {\n    if (this.config.auth.type !== 'api_key') {\n      throw new Error(`Connector '${this.name}' does not use API key auth. Type: ${this.config.auth.type}`);\n    }\n    return this.config.auth.apiKey;\n  }\n\n  /**\n   * Get the current access token (for OAuth, JWT, or API key)\n   * Handles automatic refresh if needed\n   *\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support (e.g., 'work', 'personal')\n   */\n  async getToken(userId?: string, accountId?: string): Promise<string> {\n    if (this.config.auth.type === 'api_key') {\n      return this.config.auth.apiKey;\n    }\n\n    // OAuth and JWT both use OAuthManager\n    if (!this.oauthManager) {\n      throw new Error(`OAuth manager not initialized for connector '${this.name}'`);\n    }\n\n    return this.oauthManager.getToken(userId, accountId);\n  }\n\n  /**\n   * Start OAuth authorization flow\n   * Returns the URL to redirect the user to\n   *\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support (e.g., 'work', 'personal')\n   */\n  async startAuth(userId?: string, accountId?: string): Promise<string> {\n    if (!this.oauthManager) {\n      throw new Error(`Connector '${this.name}' is not an OAuth connector`);\n    }\n    return this.oauthManager.startAuthFlow(userId, accountId);\n  }\n\n  /**\n   * Handle OAuth callback\n   * Call this after user is redirected back from OAuth provider\n   *\n   * @param callbackUrl - Full callback URL with code and state parameters\n   * @param userId - Optional user identifier (can be extracted from state if embedded)\n   * @param accountId - Optional account alias (can be extracted from state if embedded)\n   */\n  async handleCallback(callbackUrl: string, userId?: string, accountId?: string): Promise<void> {\n    if (!this.oauthManager) {\n      throw new Error(`Connector '${this.name}' is not an OAuth connector`);\n    }\n    await this.oauthManager.handleCallback(callbackUrl, userId, accountId);\n  }\n\n  /**\n   * Check if the connector has a valid token\n   *\n   * @param userId - Optional user identifier for multi-user support\n   * @param accountId - Optional account alias for multi-account support\n   */\n  async hasValidToken(userId?: string, accountId?: string): Promise<boolean> {\n    try {\n      if (this.config.auth.type === 'api_key') {\n        return true; // API keys are always \"valid\" (we don't validate them)\n      }\n      if (this.oauthManager) {\n        const token = await this.oauthManager.getToken(userId, accountId);\n        return !!token;\n      }\n      return false;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * List account aliases for a user on this connector.\n   * Only applicable for OAuth connectors with multi-account support.\n   *\n   * @param userId - Optional user identifier\n   * @returns Array of account aliases (e.g., ['work', 'personal'])\n   */\n  async listAccounts(userId?: string): Promise<string[]> {\n    if (!this.oauthManager) {\n      return [];\n    }\n    return this.oauthManager.listAccounts(userId);\n  }\n\n  /**\n   * Get vendor-specific options from config\n   */\n  getOptions(): Record<string, unknown> {\n    return this.config.options ?? {};\n  }\n\n  /**\n   * Get the service type (explicit or undefined)\n   */\n  get serviceType(): string | undefined {\n    return this.config.serviceType;\n  }\n\n  /**\n   * Get connector metrics\n   */\n  getMetrics(): {\n    requestCount: number;\n    successCount: number;\n    failureCount: number;\n    avgLatencyMs: number;\n    circuitBreakerState?: string;\n  } {\n    return {\n      requestCount: this.requestCount,\n      successCount: this.successCount,\n      failureCount: this.failureCount,\n      avgLatencyMs: this.requestCount > 0 ? this.totalLatencyMs / this.requestCount : 0,\n      circuitBreakerState: this.circuitBreaker?.getState(),\n    };\n  }\n\n  /**\n   * Reset circuit breaker (force close)\n   */\n  resetCircuitBreaker(): void {\n    this.circuitBreaker?.reset();\n  }\n\n  /**\n   * Make an authenticated fetch request using this connector\n   * This is the foundation for all vendor-dependent tools\n   *\n   * Features:\n   * - Timeout with AbortController\n   * - Circuit breaker protection\n   * - Retry with exponential backoff\n   * - Request/response logging\n   *\n   * @param endpoint - API endpoint (relative to baseURL) or full URL\n   * @param options - Fetch options with connector-specific settings\n   * @param userId - Optional user ID for multi-user OAuth\n   * @param accountId - Optional account alias for multi-account OAuth\n   * @returns Fetch Response\n   */\n  async fetch(\n    endpoint: string,\n    options?: ConnectorFetchOptions,\n    userId?: string,\n    accountId?: string\n  ): Promise<Response> {\n    // Check if disposed\n    if (this.disposed) {\n      throw new Error(`Connector '${this.name}' has been disposed`);\n    }\n\n    const startTime = Date.now();\n    this.requestCount++;\n\n    // Resolve URL (ensure proper slash between baseURL and relative endpoint)\n    let url: string;\n    if (endpoint.startsWith('http')) {\n      url = endpoint;\n    } else {\n      const base = (this.baseURL ?? '').replace(/\\/+$/, '');\n      const path = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n      url = `${base}${path}`;\n    }\n\n    // Get timeout\n    const timeout = options?.timeout ?? this.config.timeout ?? DEFAULT_CONNECTOR_TIMEOUT;\n\n    // Log request if enabled\n    if (this.config.logging?.enabled) {\n      this.logRequest(url, options);\n    }\n\n    // Build the actual fetch function\n    const doFetch = async (): Promise<Response> => {\n      // Get token (may involve refresh)\n      const token = await this.getToken(userId, accountId);\n      const auth = this.config.auth;\n\n      // Build auth header\n      let headerName = 'Authorization';\n      let headerValue = `Bearer ${token}`;\n\n      if (auth.type === 'api_key') {\n        headerName = auth.headerName || 'Authorization';\n        const prefix = auth.headerPrefix ?? 'Bearer';\n        headerValue = prefix ? `${prefix} ${token}` : token;\n      }\n\n      // Create abort controller for timeout\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n      try {\n        const response = await fetch(url, {\n          ...options,\n          signal: controller.signal,\n          headers: {\n            ...options?.headers,\n            [headerName]: headerValue,\n          },\n        });\n\n        return response;\n      } finally {\n        clearTimeout(timeoutId);\n      }\n    };\n\n    // Build retry wrapper\n    const doFetchWithRetry = async (): Promise<Response> => {\n      const retryConfig = this.config.retry;\n      const maxRetries = retryConfig?.maxRetries ?? DEFAULT_MAX_RETRIES;\n      const retryableStatuses = retryConfig?.retryableStatuses ?? DEFAULT_RETRYABLE_STATUSES;\n      const baseDelayMs = retryConfig?.baseDelayMs ?? DEFAULT_BASE_DELAY_MS;\n      const maxDelayMs = retryConfig?.maxDelayMs ?? DEFAULT_MAX_DELAY_MS;\n\n      const backoffConfig: BackoffConfig = {\n        strategy: 'exponential',\n        initialDelayMs: baseDelayMs,\n        maxDelayMs: maxDelayMs,\n        multiplier: 2,\n        jitter: true,\n        jitterFactor: 0.1,\n      };\n\n      let lastError: Error | undefined;\n      let lastResponse: Response | undefined;\n\n      for (let attempt = 1; attempt <= maxRetries + 1; attempt++) {\n        try {\n          const response = await doFetch();\n\n          // Check if we should retry based on status code\n          if (!response.ok && retryableStatuses.includes(response.status) && attempt <= maxRetries) {\n            lastResponse = response;\n            const delay = calculateBackoff(attempt, backoffConfig);\n\n            if (this.config.logging?.enabled) {\n              logger.debug(`Connector ${this.name}: Retry ${attempt}/${maxRetries} after ${delay}ms (status ${response.status})`);\n            }\n\n            await this.sleep(delay);\n            continue;\n          }\n\n          return response;\n        } catch (error) {\n          lastError = error as Error;\n\n          // Don't retry on abort (timeout)\n          if (lastError.name === 'AbortError') {\n            throw new Error(`Request timeout after ${timeout}ms: ${url}`);\n          }\n\n          // Retry on network errors\n          if (attempt <= maxRetries && !options?.skipRetry) {\n            const delay = calculateBackoff(attempt, backoffConfig);\n\n            if (this.config.logging?.enabled) {\n              logger.debug(`Connector ${this.name}: Retry ${attempt}/${maxRetries} after ${delay}ms (error: ${lastError.message})`);\n            }\n\n            await this.sleep(delay);\n            continue;\n          }\n\n          throw lastError;\n        }\n      }\n\n      // If we exhausted retries with a response, return it\n      if (lastResponse) {\n        return lastResponse;\n      }\n\n      // Otherwise throw the last error\n      throw lastError ?? new Error('Unknown error during fetch');\n    };\n\n    try {\n      let response: Response;\n\n      // Wrap with circuit breaker if enabled and not skipped\n      if (this.circuitBreaker && !options?.skipCircuitBreaker) {\n        response = await this.circuitBreaker.execute(doFetchWithRetry);\n      } else {\n        response = await doFetchWithRetry();\n      }\n\n      // Record success\n      const latency = Date.now() - startTime;\n      this.successCount++;\n      this.totalLatencyMs += latency;\n      metrics.timing('connector.latency', latency, { connector: this.name });\n      metrics.increment('connector.success', 1, { connector: this.name });\n\n      // Log response if enabled\n      if (this.config.logging?.enabled) {\n        this.logResponse(url, response, latency);\n      }\n\n      return response;\n    } catch (error) {\n      // Record failure\n      const latency = Date.now() - startTime;\n      this.failureCount++;\n      this.totalLatencyMs += latency;\n      metrics.increment('connector.failure', 1, { connector: this.name, error: (error as Error).name });\n\n      // Log error\n      if (this.config.logging?.enabled) {\n        logger.error(\n          { connector: this.name, url, latency, error: (error as Error).message },\n          `Connector ${this.name} fetch failed: ${(error as Error).message}`\n        );\n      }\n\n      throw error;\n    }\n  }\n\n  /**\n   * Make an authenticated fetch request and parse JSON response\n   * Throws on non-OK responses\n   *\n   * @param endpoint - API endpoint (relative to baseURL) or full URL\n   * @param options - Fetch options with connector-specific settings\n   * @param userId - Optional user ID for multi-user OAuth\n   * @param accountId - Optional account alias for multi-account OAuth\n   * @returns Parsed JSON response\n   */\n  async fetchJSON<T = unknown>(\n    endpoint: string,\n    options?: ConnectorFetchOptions,\n    userId?: string,\n    accountId?: string\n  ): Promise<T> {\n    const response = await this.fetch(endpoint, options, userId, accountId);\n\n    // Try to parse response body\n    const text = await response.text();\n    let data: T;\n\n    try {\n      data = JSON.parse(text) as T;\n    } catch {\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${text}`);\n      }\n      throw new Error(`Invalid JSON response: ${text.slice(0, 100)}`);\n    }\n\n    if (!response.ok) {\n      // Include parsed error in message if available\n      const errorMsg = typeof data === 'object' && data !== null ? JSON.stringify(data) : text;\n      throw new Error(`HTTP ${response.status}: ${errorMsg}`);\n    }\n\n    return data;\n  }\n\n  // ============ Private Helpers ============\n\n  private sleep(ms: number): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n\n  private logRequest(url: string, options?: RequestInit): void {\n    const logData: Record<string, unknown> = {\n      connector: this.name,\n      method: options?.method ?? 'GET',\n      url,\n    };\n\n    if (this.config.logging?.logHeaders && options?.headers) {\n      // Redact sensitive headers\n      const headers = { ...options.headers } as Record<string, string>;\n      if (headers['Authorization']) {\n        headers['Authorization'] = '[REDACTED]';\n      }\n      if (headers['authorization']) {\n        headers['authorization'] = '[REDACTED]';\n      }\n      logData.headers = headers;\n    }\n\n    if (this.config.logging?.logBody && options?.body) {\n      logData.body = typeof options.body === 'string' ? options.body.slice(0, 1000) : '[non-string body]';\n    }\n\n    logger.debug(logData, `Connector ${this.name} request`);\n  }\n\n  private logResponse(url: string, response: Response, latency: number): void {\n    logger.debug(\n      { connector: this.name, url, status: response.status, latency },\n      `Connector ${this.name} response`\n    );\n  }\n\n  /**\n   * Dispose of resources\n   */\n  dispose(): void {\n    if (this.disposed) return;\n    this.disposed = true;\n    // Clean up resources\n    this.oauthManager = undefined;\n    this.circuitBreaker = undefined;\n  }\n\n  /**\n   * Check if connector is disposed\n   */\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  // ============ Private ============\n\n  private initOAuthManager(auth: ConnectorAuth & { type: 'oauth' }): void {\n    // Convert ConnectorAuth to OAuthConfig\n    const oauthConfig = {\n      flow: auth.flow as 'authorization_code' | 'client_credentials' | 'jwt_bearer',\n      clientId: auth.clientId,\n      clientSecret: auth.clientSecret,\n      tokenUrl: auth.tokenUrl,\n      authorizationUrl: auth.authorizationUrl,\n      redirectUri: auth.redirectUri,\n      scope: auth.scope,\n      usePKCE: auth.usePKCE,\n      privateKey: auth.privateKey,\n      privateKeyPath: auth.privateKeyPath,\n      audience: auth.audience,\n      refreshBeforeExpiry: auth.refreshBeforeExpiry,\n      storage: Connector.defaultStorage,\n      storageKey: auth.storageKey ?? this.name,\n    };\n\n    this.oauthManager = new OAuthManager(oauthConfig);\n  }\n\n  private initJWTManager(auth: ConnectorAuth & { type: 'jwt' }): void {\n    // JWT uses jwt_bearer flow via OAuthManager\n    this.oauthManager = new OAuthManager({\n      flow: 'jwt_bearer',\n      clientId: auth.clientId,\n      tokenUrl: auth.tokenUrl,\n      privateKey: auth.privateKey,\n      privateKeyPath: auth.privateKeyPath,\n      scope: auth.scope,\n      audience: auth.audience,\n      storage: Connector.defaultStorage,\n      storageKey: this.name,\n    });\n  }\n}\n","/**\n * Core Constants - Centralized configuration defaults\n *\n * This file provides a single source of truth for all default values\n * used throughout the framework. Import from here instead of hardcoding.\n */\n\n// ============ Task Execution Defaults ============\n\n/**\n * Default task execution settings\n */\nexport const TASK_DEFAULTS = {\n  /** Default timeout for task execution in milliseconds (5 minutes) */\n  TIMEOUT_MS: 300_000,\n\n  /** Maximum retry attempts for failed tasks */\n  MAX_RETRIES: 3,\n\n  /** Default delay between retries in milliseconds */\n  RETRY_DELAY_MS: 1_000,\n\n  /** Maximum consecutive errors before stopping */\n  MAX_CONSECUTIVE_ERRORS: 3,\n} as const;\n\n// ============ Context Management Defaults ============\n\n/**\n * Default context management settings\n */\nexport const CONTEXT_DEFAULTS = {\n  /** Default maximum context tokens (128K) */\n  MAX_TOKENS: 128_000,\n\n  /** Reserve percentage for response generation (15%) */\n  RESPONSE_RESERVE: 0.15,\n\n  /** Threshold to trigger compaction warning (75%) */\n  COMPACTION_THRESHOLD: 0.75,\n\n  /** Hard limit before forced compaction (90%) */\n  HARD_LIMIT: 0.90,\n} as const;\n\n// ============ Memory Defaults ============\n\n/**\n * Working memory configuration\n */\nexport const MEMORY_DEFAULTS = {\n  /** Default maximum memory size in bytes (25MB) */\n  MAX_SIZE_BYTES: 25 * 1024 * 1024,\n\n  /** Soft limit percentage to trigger warnings */\n  SOFT_LIMIT_PERCENT: 80,\n\n  /** Default eviction count when memory is full */\n  DEFAULT_EVICTION_COUNT: 5,\n} as const;\n\n// ============ Session Defaults ============\n\n/**\n * Session management configuration\n */\nexport const SESSION_DEFAULTS = {\n  /** Default auto-save interval in milliseconds (30 seconds) */\n  AUTO_SAVE_INTERVAL_MS: 30_000,\n\n  /** Maximum session age before cleanup (24 hours) */\n  MAX_SESSION_AGE_MS: 86_400_000,\n} as const;\n\n// ============ Agent Defaults ============\n\n/**\n * Agent execution configuration\n */\nexport const AGENT_DEFAULTS = {\n  /** Default maximum iterations for agentic loop */\n  MAX_ITERATIONS: 50,\n\n  /** Default temperature for LLM calls */\n  DEFAULT_TEMPERATURE: 0.7,\n\n  /** Message injected when max iterations is reached */\n  MAX_ITERATIONS_MESSAGE: `You have reached the maximum iteration limit for this execution. Please:\n1. Summarize what you have accomplished so far\n2. Explain what remains to be done (if anything)\n3. Ask the user if they would like you to continue\n\nDo NOT use any tools in this response - just provide a clear summary and ask for confirmation to proceed.`,\n} as const;\n\n// ============ Circuit Breaker Defaults ============\n\n/**\n * Circuit breaker configuration\n */\nexport const CIRCUIT_BREAKER_DEFAULTS = {\n  /** Failures before opening circuit */\n  FAILURE_THRESHOLD: 5,\n\n  /** Successes in half-open before closing */\n  SUCCESS_THRESHOLD: 2,\n\n  /** Time before trying half-open (1 minute) */\n  RESET_TIMEOUT_MS: 60_000,\n\n  /** Window for tracking failures (5 minutes) */\n  WINDOW_MS: 300_000,\n} as const;\n\n// ============ History Defaults ============\n\n/**\n * Conversation history configuration\n */\nexport const HISTORY_DEFAULTS = {\n  /** Maximum messages to keep in history */\n  MAX_MESSAGES: 50,\n\n  /** Preserve this many recent messages during compaction */\n  PRESERVE_RECENT_COUNT: 10,\n\n  /** Default compaction strategy */\n  COMPACTION_STRATEGY: 'sliding-window' as const,\n} as const;\n\n// ============ Token Estimation ============\n\n/**\n * Token estimation ratios (characters per token)\n */\nexport const TOKEN_ESTIMATION = {\n  /** Characters per token for code */\n  CODE_CHARS_PER_TOKEN: 3,\n\n  /** Characters per token for prose */\n  PROSE_CHARS_PER_TOKEN: 4,\n\n  /** Characters per token for mixed content */\n  MIXED_CHARS_PER_TOKEN: 3.5,\n\n  /** Default characters per token */\n  DEFAULT_CHARS_PER_TOKEN: 4,\n} as const;\n\n// ============ Strategy-Dependent Thresholds ============\n\n/**\n * Strategy-specific thresholds (percentages of maxContextTokens).\n * These adapt context management behavior to the chosen compaction strategy.\n */\nexport const STRATEGY_THRESHOLDS = {\n  proactive: {\n    // Most balanced - good for general use\n    compactionTrigger: 0.75,        // Start compaction at 75%\n    compactionTarget: 0.65,         // Reduce to 65%\n    smartCompactionTrigger: 0.70,   // Trigger smart compaction at 70%\n    maxToolResultsPercent: 0.30,    // Tool results can use up to 30% of context\n    protectedContextPercent: 0.10,  // Protect at least 10% of context (recent messages)\n  },\n  aggressive: {\n    // Memory-constrained - compact early and often\n    compactionTrigger: 0.60,\n    compactionTarget: 0.50,\n    smartCompactionTrigger: 0.55,\n    maxToolResultsPercent: 0.25,\n    protectedContextPercent: 0.08,\n  },\n  lazy: {\n    // Preserve context - only compact when critical\n    compactionTrigger: 0.90,\n    compactionTarget: 0.85,\n    smartCompactionTrigger: 0.85,\n    maxToolResultsPercent: 0.40,    // Allow more tool results\n    protectedContextPercent: 0.15,  // Protect more recent context\n  },\n  adaptive: {\n    // Starts with proactive, adjusts based on performance\n    compactionTrigger: 0.75,\n    compactionTarget: 0.65,\n    smartCompactionTrigger: 0.70,\n    maxToolResultsPercent: 0.30,\n    protectedContextPercent: 0.10,\n  },\n  'rolling-window': {\n    // Fixed window, similar to lazy but with message count focus\n    compactionTrigger: 0.85,\n    compactionTarget: 0.75,\n    smartCompactionTrigger: 0.80,\n    maxToolResultsPercent: 0.35,\n    protectedContextPercent: 0.12,\n  },\n} as const;\n\nexport type StrategyName = keyof typeof STRATEGY_THRESHOLDS;\n\n/**\n * High count caps as safety limits (not primary triggers).\n * These act as last-resort limits when percentage-based thresholds aren't enough.\n */\nexport const SAFETY_CAPS = {\n  /** Safety cap for max tool results (only triggers if percentage doesn't) */\n  MAX_FULL_RESULTS: 100,\n  /** Safety cap for max age iterations */\n  MAX_AGE_ITERATIONS: 50,\n  /** Always keep at least this many messages */\n  MIN_PROTECTED_MESSAGES: 10,\n} as const;\n\n/**\n * Tool retention multipliers by strategy (base iterations  multiplier).\n * Allows strategy to influence how long tool results are kept.\n */\nexport const TOOL_RETENTION_MULTIPLIERS: Record<StrategyName, number> = {\n  proactive: 1.0,\n  aggressive: 0.7,\n  lazy: 1.5,\n  adaptive: 1.0,\n  'rolling-window': 1.2,\n};\n\n// ============ Document Reader Defaults ============\n\n/**\n * Document reader configuration\n */\nexport const DOCUMENT_DEFAULTS = {\n  /** Maximum estimated tokens in output */\n  MAX_OUTPUT_TOKENS: 100_000,\n\n  /** Maximum output size in bytes (5MB) */\n  MAX_OUTPUT_BYTES: 5 * 1024 * 1024,\n\n  /** Maximum download size for URL sources (50MB) */\n  MAX_DOWNLOAD_SIZE_BYTES: 50 * 1024 * 1024,\n\n  /** Download timeout for URL sources */\n  DOWNLOAD_TIMEOUT_MS: 60_000,\n\n  /** Maximum extracted images from a single document */\n  MAX_EXTRACTED_IMAGES: 50,\n\n  /** Maximum Excel rows per sheet */\n  MAX_EXCEL_ROWS: 1_000,\n\n  /** Maximum Excel columns per sheet */\n  MAX_EXCEL_COLUMNS: 50,\n\n  /** Maximum HTML content length */\n  MAX_HTML_LENGTH: 50_000,\n\n  /** Characters per token estimate */\n  CHARS_PER_TOKEN: 4,\n\n  /** Estimated tokens for an image with auto detail */\n  IMAGE_TOKENS_AUTO: 765,\n\n  /** Estimated tokens for an image with low detail */\n  IMAGE_TOKENS_LOW: 85,\n\n  /** Image filter defaults */\n  IMAGE_FILTER: {\n    MIN_WIDTH: 50,\n    MIN_HEIGHT: 50,\n    MIN_SIZE_BYTES: 1024,\n  },\n} as const;\n\n// ============ Tool Result Eviction Defaults ============\n\n/**\n * Tool result eviction configuration.\n * Controls when and how old tool results are moved from context to memory.\n *\n * NOTE: These are LEGACY defaults. The newer STRATEGY_THRESHOLDS provide\n * percentage-based limits that adapt to different context sizes and strategies.\n * ToolResultEvictionPlugin should prefer percentage-based limits when available.\n */\nexport const TOOL_RESULT_EVICTION_DEFAULTS = {\n  /** Keep last N tool result pairs in conversation (LEGACY - use SAFETY_CAPS instead) */\n  MAX_FULL_RESULTS: 10,\n\n  /** Evict results after N iterations (LEGACY - use percentage-based) */\n  MAX_AGE_ITERATIONS: 5,\n\n  /** Only evict results larger than this (bytes, default: 1KB) */\n  MIN_SIZE_TO_EVICT: 1024,\n\n  /** Trigger size-based eviction when total exceeds this (bytes, default: 100KB) */\n  MAX_TOTAL_SIZE_BYTES: 100 * 1024,\n} as const;\n\n/**\n * Base per-tool iteration retention (before strategy multiplier).\n * Tools not listed use TOOL_RESULT_EVICTION_DEFAULTS.MAX_AGE_ITERATIONS.\n *\n * Higher values = keep results longer in conversation.\n * Final retention = base  TOOL_RETENTION_MULTIPLIERS[strategy]\n *\n * Common patterns:\n * - File/code tools: Keep longer (often referenced later)\n * - Web tools: Keep shorter (can re-fetch if needed)\n */\nexport const DEFAULT_TOOL_RETENTION: Record<string, number> = {\n  // Long retention - outputs often referenced later\n  read_file: 20,\n  bash: 15,\n  grep: 15,\n  glob: 12,\n  edit_file: 12,\n\n  // Medium retention\n  memory_retrieve: 10,\n  list_directory: 10,\n  autospill_process: 8,\n\n  // Short retention - web content can be re-fetched\n  web_fetch: 6,\n};\n\n","/**\n * Sanitize a string to be a valid tool name.\n * Matches the common denominator pattern across all LLM providers: ^[a-zA-Z0-9_-]+$\n *\n * - Replaces invalid characters (spaces, special chars, unicode) with underscores\n * - Collapses consecutive underscores into one\n * - Strips leading/trailing underscores and hyphens\n * - Prepends 'n_' if the result starts with a digit\n * - Returns 'unnamed' if the result would be empty\n */\nexport function sanitizeToolName(name: string): string {\n  let result = name\n    .replace(/[^a-zA-Z0-9_-]/g, '_') // Replace invalid chars\n    .replace(/_+/g, '_') // Collapse consecutive underscores\n    .replace(/^[_-]+|[_-]+$/g, ''); // Trim leading/trailing _ and -\n\n  if (/^[0-9]/.test(result)) {\n    result = `n_${result}`;\n  }\n\n  return result || 'unnamed';\n}\n","/**\n * Services - Single source of truth for external service definitions\n *\n * All service metadata is defined in one place (SERVICE_DEFINITIONS).\n * Other exports are derived from this to maintain DRY principles.\n */\n\n/**\n * Service category type\n */\nexport type ServiceCategory =\n  | 'major-vendors'\n  | 'communication'\n  | 'development'\n  | 'productivity'\n  | 'crm'\n  | 'payments'\n  | 'cloud'\n  | 'storage'\n  | 'email'\n  | 'monitoring'\n  | 'search'\n  | 'scrape'\n  | 'other';\n\n/**\n * Complete service definition - single source of truth\n */\nexport interface ServiceDefinition {\n  /** Unique identifier (e.g., 'slack', 'github') */\n  id: string;\n  /** Human-readable name (e.g., 'Slack', 'GitHub') */\n  name: string;\n  /** Service category */\n  category: ServiceCategory;\n  /** URL pattern for auto-detection from baseURL */\n  urlPattern: RegExp;\n  /** Default base URL for API calls */\n  baseURL: string;\n  /** Documentation URL */\n  docsURL?: string;\n  /** Common OAuth scopes */\n  commonScopes?: string[];\n}\n\n/**\n * Master list of all service definitions\n * This is the SINGLE SOURCE OF TRUTH - all other exports derive from this\n */\nexport const SERVICE_DEFINITIONS: readonly ServiceDefinition[] = [\n  // ============ Major Vendors ============\n  {\n    id: 'microsoft',\n    name: 'Microsoft',\n    category: 'major-vendors',\n    urlPattern: /graph\\.microsoft\\.com|login\\.microsoftonline\\.com/i,\n    baseURL: 'https://graph.microsoft.com/v1.0',\n    docsURL: 'https://learn.microsoft.com/en-us/graph/',\n    commonScopes: ['User.Read', 'Files.ReadWrite', 'Mail.Read', 'Calendars.ReadWrite'],\n  },\n  {\n    id: 'google',\n    name: 'Google',\n    category: 'major-vendors',\n    urlPattern: /googleapis\\.com|accounts\\.google\\.com/i,\n    baseURL: 'https://www.googleapis.com',\n    docsURL: 'https://developers.google.com/',\n    commonScopes: [\n      'https://www.googleapis.com/auth/drive',\n      'https://www.googleapis.com/auth/calendar',\n      'https://www.googleapis.com/auth/gmail.readonly',\n    ],\n  },\n\n  // ============ Communication ============\n  {\n    id: 'slack',\n    name: 'Slack',\n    category: 'communication',\n    urlPattern: /slack\\.com/i,\n    baseURL: 'https://slack.com/api',\n    docsURL: 'https://api.slack.com/methods',\n    commonScopes: ['chat:write', 'channels:read', 'users:read'],\n  },\n  {\n    id: 'discord',\n    name: 'Discord',\n    category: 'communication',\n    urlPattern: /discord\\.com|discordapp\\.com/i,\n    baseURL: 'https://discord.com/api/v10',\n    docsURL: 'https://discord.com/developers/docs',\n    commonScopes: ['bot', 'messages.read'],\n  },\n  {\n    id: 'telegram',\n    name: 'Telegram',\n    category: 'communication',\n    urlPattern: /api\\.telegram\\.org/i,\n    baseURL: 'https://api.telegram.org',\n    docsURL: 'https://core.telegram.org/bots/api',\n  },\n  {\n    id: 'twitter',\n    name: 'X (Twitter)',\n    category: 'communication',\n    urlPattern: /api\\.x\\.com|api\\.twitter\\.com/i,\n    baseURL: 'https://api.x.com/2',\n    docsURL: 'https://developer.x.com/en/docs/x-api',\n    commonScopes: ['tweet.read', 'tweet.write', 'users.read', 'offline.access'],\n  },\n\n  // ============ Development & Project Management ============\n  {\n    id: 'github',\n    name: 'GitHub',\n    category: 'development',\n    urlPattern: /api\\.github\\.com/i,\n    baseURL: 'https://api.github.com',\n    docsURL: 'https://docs.github.com/en/rest',\n    commonScopes: ['repo', 'read:user', 'read:org'],\n  },\n  {\n    id: 'gitlab',\n    name: 'GitLab',\n    category: 'development',\n    urlPattern: /gitlab\\.com|gitlab\\./i,\n    baseURL: 'https://gitlab.com/api/v4',\n    docsURL: 'https://docs.gitlab.com/ee/api/',\n    commonScopes: ['api', 'read_user', 'read_repository'],\n  },\n  {\n    id: 'bitbucket',\n    name: 'Bitbucket',\n    category: 'development',\n    urlPattern: /api\\.bitbucket\\.org|bitbucket\\.org/i,\n    baseURL: 'https://api.bitbucket.org/2.0',\n    docsURL: 'https://developer.atlassian.com/cloud/bitbucket/rest/',\n    commonScopes: ['repository', 'pullrequest'],\n  },\n  {\n    id: 'jira',\n    name: 'Jira',\n    category: 'development',\n    urlPattern: /atlassian\\.net.*jira|jira\\./i,\n    baseURL: 'https://your-domain.atlassian.net/rest/api/3',\n    docsURL: 'https://developer.atlassian.com/cloud/jira/platform/rest/v3/',\n    commonScopes: ['read:jira-work', 'write:jira-work'],\n  },\n  {\n    id: 'linear',\n    name: 'Linear',\n    category: 'development',\n    urlPattern: /api\\.linear\\.app/i,\n    baseURL: 'https://api.linear.app/graphql',\n    docsURL: 'https://developers.linear.app/docs',\n    commonScopes: ['read', 'write'],\n  },\n  {\n    id: 'asana',\n    name: 'Asana',\n    category: 'development',\n    urlPattern: /api\\.asana\\.com/i,\n    baseURL: 'https://app.asana.com/api/1.0',\n    docsURL: 'https://developers.asana.com/docs',\n  },\n  {\n    id: 'trello',\n    name: 'Trello',\n    category: 'development',\n    urlPattern: /api\\.trello\\.com/i,\n    baseURL: 'https://api.trello.com/1',\n    docsURL: 'https://developer.atlassian.com/cloud/trello/rest/',\n    commonScopes: ['read', 'write'],\n  },\n\n  // ============ Productivity & Collaboration ============\n  {\n    id: 'notion',\n    name: 'Notion',\n    category: 'productivity',\n    urlPattern: /api\\.notion\\.com/i,\n    baseURL: 'https://api.notion.com/v1',\n    docsURL: 'https://developers.notion.com/reference',\n  },\n  {\n    id: 'airtable',\n    name: 'Airtable',\n    category: 'productivity',\n    urlPattern: /api\\.airtable\\.com/i,\n    baseURL: 'https://api.airtable.com/v0',\n    docsURL: 'https://airtable.com/developers/web/api',\n    commonScopes: ['data.records:read', 'data.records:write'],\n  },\n  {\n    id: 'confluence',\n    name: 'Confluence',\n    category: 'productivity',\n    urlPattern: /atlassian\\.net.*wiki|confluence\\./i,\n    baseURL: 'https://your-domain.atlassian.net/wiki/rest/api',\n    docsURL: 'https://developer.atlassian.com/cloud/confluence/rest/',\n    commonScopes: ['read:confluence-content.all', 'write:confluence-content'],\n  },\n\n  // ============ CRM & Sales ============\n  {\n    id: 'salesforce',\n    name: 'Salesforce',\n    category: 'crm',\n    urlPattern: /salesforce\\.com|force\\.com/i,\n    baseURL: 'https://your-instance.salesforce.com/services/data/v58.0',\n    docsURL: 'https://developer.salesforce.com/docs/apis',\n    commonScopes: ['api', 'refresh_token'],\n  },\n  {\n    id: 'hubspot',\n    name: 'HubSpot',\n    category: 'crm',\n    urlPattern: /api\\.hubapi\\.com|api\\.hubspot\\.com/i,\n    baseURL: 'https://api.hubapi.com',\n    docsURL: 'https://developers.hubspot.com/docs/api',\n    commonScopes: ['crm.objects.contacts.read', 'crm.objects.contacts.write'],\n  },\n  {\n    id: 'pipedrive',\n    name: 'Pipedrive',\n    category: 'crm',\n    urlPattern: /api\\.pipedrive\\.com/i,\n    baseURL: 'https://api.pipedrive.com/v1',\n    docsURL: 'https://developers.pipedrive.com/docs/api/v1',\n  },\n\n  // ============ Payments & Finance ============\n  {\n    id: 'stripe',\n    name: 'Stripe',\n    category: 'payments',\n    urlPattern: /api\\.stripe\\.com/i,\n    baseURL: 'https://api.stripe.com/v1',\n    docsURL: 'https://stripe.com/docs/api',\n  },\n  {\n    id: 'paypal',\n    name: 'PayPal',\n    category: 'payments',\n    urlPattern: /api\\.paypal\\.com|api-m\\.paypal\\.com/i,\n    baseURL: 'https://api-m.paypal.com/v2',\n    docsURL: 'https://developer.paypal.com/docs/api/',\n  },\n  {\n    id: 'quickbooks',\n    name: 'QuickBooks',\n    category: 'payments',\n    urlPattern: /quickbooks\\.api\\.intuit\\.com|intuit\\.com.*quickbooks/i,\n    baseURL: 'https://quickbooks.api.intuit.com/v3',\n    docsURL: 'https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/account',\n    commonScopes: ['com.intuit.quickbooks.accounting'],\n  },\n  {\n    id: 'ramp',\n    name: 'Ramp',\n    category: 'payments',\n    urlPattern: /api\\.ramp\\.com/i,\n    baseURL: 'https://api.ramp.com/developer/v1',\n    docsURL: 'https://docs.ramp.com/reference',\n  },\n\n  // ============ Cloud Providers ============\n  {\n    id: 'aws',\n    name: 'Amazon Web Services',\n    category: 'cloud',\n    urlPattern: /amazonaws\\.com/i,\n    baseURL: 'https://aws.amazon.com',\n    docsURL: 'https://docs.aws.amazon.com/',\n  },\n\n  // ============ Storage ============\n  {\n    id: 'dropbox',\n    name: 'Dropbox',\n    category: 'storage',\n    urlPattern: /api\\.dropboxapi\\.com|dropbox\\.com/i,\n    baseURL: 'https://api.dropboxapi.com/2',\n    docsURL: 'https://www.dropbox.com/developers/documentation',\n    commonScopes: ['files.content.read', 'files.content.write'],\n  },\n  {\n    id: 'box',\n    name: 'Box',\n    category: 'storage',\n    urlPattern: /api\\.box\\.com/i,\n    baseURL: 'https://api.box.com/2.0',\n    docsURL: 'https://developer.box.com/reference/',\n  },\n\n  // ============ Email ============\n  {\n    id: 'sendgrid',\n    name: 'SendGrid',\n    category: 'email',\n    urlPattern: /api\\.sendgrid\\.com/i,\n    baseURL: 'https://api.sendgrid.com/v3',\n    docsURL: 'https://docs.sendgrid.com/api-reference',\n  },\n  {\n    id: 'mailchimp',\n    name: 'Mailchimp',\n    category: 'email',\n    urlPattern: /api\\.mailchimp\\.com|mandrillapp\\.com/i,\n    baseURL: 'https://server.api.mailchimp.com/3.0',\n    docsURL: 'https://mailchimp.com/developer/marketing/api/',\n  },\n  {\n    id: 'postmark',\n    name: 'Postmark',\n    category: 'email',\n    urlPattern: /api\\.postmarkapp\\.com/i,\n    baseURL: 'https://api.postmarkapp.com',\n    docsURL: 'https://postmarkapp.com/developer',\n  },\n\n  // ============ Monitoring & Observability ============\n  {\n    id: 'datadog',\n    name: 'Datadog',\n    category: 'monitoring',\n    urlPattern: /api\\.datadoghq\\.com/i,\n    baseURL: 'https://api.datadoghq.com/api/v2',\n    docsURL: 'https://docs.datadoghq.com/api/',\n  },\n  {\n    id: 'pagerduty',\n    name: 'PagerDuty',\n    category: 'monitoring',\n    urlPattern: /api\\.pagerduty\\.com/i,\n    baseURL: 'https://api.pagerduty.com',\n    docsURL: 'https://developer.pagerduty.com/api-reference/',\n  },\n  {\n    id: 'sentry',\n    name: 'Sentry',\n    category: 'monitoring',\n    urlPattern: /sentry\\.io/i,\n    baseURL: 'https://sentry.io/api/0',\n    docsURL: 'https://docs.sentry.io/api/',\n  },\n\n  // ============ Search ============\n  {\n    id: 'serper',\n    name: 'Serper',\n    category: 'search',\n    urlPattern: /serper\\.dev/i,\n    baseURL: 'https://google.serper.dev',\n    docsURL: 'https://serper.dev/docs',\n  },\n  {\n    id: 'brave-search',\n    name: 'Brave Search',\n    category: 'search',\n    urlPattern: /api\\.search\\.brave\\.com/i,\n    baseURL: 'https://api.search.brave.com/res/v1',\n    docsURL: 'https://brave.com/search/api/',\n  },\n  {\n    id: 'tavily',\n    name: 'Tavily',\n    category: 'search',\n    urlPattern: /api\\.tavily\\.com/i,\n    baseURL: 'https://api.tavily.com',\n    docsURL: 'https://tavily.com/docs',\n  },\n  {\n    id: 'rapidapi-search',\n    name: 'RapidAPI Search',\n    category: 'search',\n    urlPattern: /real-time-web-search\\.p\\.rapidapi\\.com/i,\n    baseURL: 'https://real-time-web-search.p.rapidapi.com',\n    docsURL: 'https://rapidapi.com/letscrape-6bRBa3QguO5/api/real-time-web-search',\n  },\n\n  // ============ Scraping ============\n  {\n    id: 'zenrows',\n    name: 'ZenRows',\n    category: 'scrape',\n    urlPattern: /api\\.zenrows\\.com/i,\n    baseURL: 'https://api.zenrows.com/v1',\n    docsURL: 'https://docs.zenrows.com/universal-scraper-api/api-reference',\n  },\n\n  // ============ Other ============\n  {\n    id: 'twilio',\n    name: 'Twilio',\n    category: 'other',\n    urlPattern: /api\\.twilio\\.com/i,\n    baseURL: 'https://api.twilio.com/2010-04-01',\n    docsURL: 'https://www.twilio.com/docs/usage/api',\n  },\n  {\n    id: 'zendesk',\n    name: 'Zendesk',\n    category: 'other',\n    urlPattern: /zendesk\\.com/i,\n    baseURL: 'https://your-subdomain.zendesk.com/api/v2',\n    docsURL: 'https://developer.zendesk.com/api-reference/',\n    commonScopes: ['read', 'write'],\n  },\n  {\n    id: 'intercom',\n    name: 'Intercom',\n    category: 'other',\n    urlPattern: /api\\.intercom\\.io/i,\n    baseURL: 'https://api.intercom.io',\n    docsURL: 'https://developers.intercom.com/docs/',\n  },\n  {\n    id: 'shopify',\n    name: 'Shopify',\n    category: 'other',\n    urlPattern: /shopify\\.com.*admin/i,\n    baseURL: 'https://your-store.myshopify.com/admin/api/2024-01',\n    docsURL: 'https://shopify.dev/docs/api',\n    commonScopes: ['read_products', 'write_products', 'read_orders'],\n  },\n] as const;\n\n// ============ Derived Exports (all from SERVICE_DEFINITIONS) ============\n\n/**\n * Service type - union of all service IDs\n */\nexport type ServiceType = (typeof SERVICE_DEFINITIONS)[number]['id'];\n\n/**\n * Services constant object for easy access\n * Usage: Services.Slack, Services.GitHub, etc.\n */\nexport const Services = Object.fromEntries(\n  SERVICE_DEFINITIONS.map((def) => [\n    // Convert kebab-case to PascalCase for object key\n    def.id\n      .split('-')\n      .map((part) => part.charAt(0).toUpperCase() + part.slice(1))\n      .join(''),\n    def.id,\n  ])\n) as { [K in string]: ServiceType };\n\n/**\n * URL patterns for auto-detection (derived from SERVICE_DEFINITIONS)\n */\nexport const SERVICE_URL_PATTERNS: ReadonlyArray<{ service: string; pattern: RegExp }> =\n  SERVICE_DEFINITIONS.map((def) => ({\n    service: def.id,\n    pattern: def.urlPattern,\n  }));\n\n/**\n * Service info lookup (derived from SERVICE_DEFINITIONS)\n */\nexport interface ServiceInfo {\n  id: string;\n  name: string;\n  category: ServiceCategory;\n  baseURL: string;\n  docsURL?: string;\n  commonScopes?: string[];\n}\n\n/**\n * Service info map (derived from SERVICE_DEFINITIONS)\n */\nexport const SERVICE_INFO: Record<string, ServiceInfo> = Object.fromEntries(\n  SERVICE_DEFINITIONS.map((def) => [\n    def.id,\n    {\n      id: def.id,\n      name: def.name,\n      category: def.category,\n      baseURL: def.baseURL,\n      docsURL: def.docsURL,\n      commonScopes: def.commonScopes,\n    },\n  ])\n);\n\n// ============ Utility Functions ============\n\n// Pre-compiled pattern cache for faster detection\nlet compiledPatterns: Array<{ service: string; pattern: RegExp }> | null = null;\n\n/**\n * Get compiled patterns (lazy initialization)\n */\nfunction getCompiledPatterns(): Array<{ service: string; pattern: RegExp }> {\n  if (!compiledPatterns) {\n    compiledPatterns = SERVICE_DEFINITIONS.map((def) => ({\n      service: def.id,\n      pattern: def.urlPattern,\n    }));\n  }\n  return compiledPatterns;\n}\n\n/**\n * Detect service type from a URL\n * @param url - Base URL or full URL to check\n * @returns Service type string or undefined if not recognized\n */\nexport function detectServiceFromURL(url: string): string | undefined {\n  const patterns = getCompiledPatterns();\n\n  for (const { service, pattern } of patterns) {\n    if (pattern.test(url)) {\n      return service;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Get service info by service type\n */\nexport function getServiceInfo(serviceType: string): ServiceInfo | undefined {\n  return SERVICE_INFO[serviceType];\n}\n\n/**\n * Get service definition by service type\n */\nexport function getServiceDefinition(serviceType: string): ServiceDefinition | undefined {\n  return SERVICE_DEFINITIONS.find((def) => def.id === serviceType);\n}\n\n/**\n * Get all services in a category\n */\nexport function getServicesByCategory(category: ServiceCategory): ServiceDefinition[] {\n  return SERVICE_DEFINITIONS.filter((def) => def.category === category);\n}\n\n/**\n * Get all service IDs\n */\nexport function getAllServiceIds(): string[] {\n  return SERVICE_DEFINITIONS.map((def) => def.id);\n}\n\n/**\n * Check if a service ID is known\n */\nexport function isKnownService(serviceId: string): boolean {\n  return SERVICE_DEFINITIONS.some((def) => def.id === serviceId);\n}\n","/**\n * ConnectorTools - Generate tools from Connectors\n *\n * This is the main API for vendor-dependent tools.\n * Tools are thin wrappers around Connector.fetch() for specific operations.\n *\n * Enterprise features:\n * - Service detection caching\n * - Tool instance caching\n * - Security: prevents auth header override\n * - Safe JSON serialization\n */\n\nimport { Connector } from '../../core/Connector.js';\nimport { logger } from '../../infrastructure/observability/Logger.js';\nimport { sanitizeToolName } from '../../utils/sanitize.js';\nimport { ToolFunction, ToolPermissionConfig, ToolContext } from '../../domain/entities/Tool.js';\nimport { detectServiceFromURL } from '../../domain/entities/Services.js';\nimport type { IConnectorRegistry } from '../../domain/interfaces/IConnectorRegistry.js';\nimport type { AuthIdentity } from '../../core/context-nextgen/types.js';\n\n/**\n * Headers that are protected and cannot be overridden by tool arguments\n */\nconst PROTECTED_HEADERS = ['authorization', 'x-api-key', 'api-key', 'bearer'];\n\n/**\n * Safely stringify an object, handling circular references\n */\nfunction safeStringify(obj: unknown): string {\n  const seen = new WeakSet();\n  return JSON.stringify(obj, (_key, value) => {\n    if (typeof value === 'object' && value !== null) {\n      if (seen.has(value)) {\n        return '[Circular]';\n      }\n      seen.add(value);\n    }\n    return value;\n  });\n}\n\n/**\n * Filter out protected headers from user-provided headers\n */\nfunction filterProtectedHeaders(headers?: Record<string, string>): Record<string, string> {\n  if (!headers) return {};\n\n  const filtered: Record<string, string> = {};\n  for (const [key, value] of Object.entries(headers)) {\n    if (!PROTECTED_HEADERS.includes(key.toLowerCase())) {\n      filtered[key] = value;\n    }\n  }\n  return filtered;\n}\n\n/**\n * Normalize a body value that may be a string (from LLM) into a proper object.\n * LLMs sometimes send `body` as a stringified JSON string instead of a JSON object,\n * which would cause double-serialization when passed through safeStringify().\n */\nfunction normalizeBody(body: unknown): unknown {\n  if (typeof body === 'string') {\n    try {\n      return JSON.parse(body);\n    } catch {\n      // Not valid JSON  return as-is (will be sent as a raw string)\n      return body;\n    }\n  }\n  return body;\n}\n\n/**\n * Detect API-level errors from response data.\n * Many APIs (Slack, Twilio, etc.) return HTTP 200 with error info in the body.\n */\nfunction detectAPIError(data: unknown): string | null {\n  if (!data || typeof data !== 'object') return null;\n  const obj = data as Record<string, unknown>;\n\n  // Pattern 1: { ok: false, error: \"...\" } (Slack, some others)\n  if (obj.ok === false && typeof obj.error === 'string') {\n    return obj.error;\n  }\n\n  // Pattern 2: { success: false, error/message: \"...\" }\n  if (obj.success === false) {\n    if (typeof obj.error === 'string') return obj.error;\n    if (typeof obj.message === 'string') return obj.message;\n  }\n\n  // Pattern 3: { error: { message: \"...\" } } (common REST pattern)\n  if (obj.error && typeof obj.error === 'object') {\n    const err = obj.error as Record<string, unknown>;\n    if (typeof err.message === 'string') return err.message;\n  }\n\n  return null;\n}\n\n/**\n * Factory function type for creating service-specific tools.\n * Takes a Connector and returns an array of tools that use it.\n *\n * The `userId` parameter is a legacy fallback  tools should prefer reading\n * userId from ToolContext at execution time (auto-populated by Agent).\n * Factory userId is used as fallback when ToolContext is not available.\n */\nexport type ServiceToolFactory = (connector: Connector, userId?: string) => ToolFunction[];\n\n/**\n * Options for generating the generic API tool\n */\nexport interface GenericAPIToolOptions {\n  /** Override the tool name (default: `${connectorName}_api`) */\n  toolName?: string;\n  /** Override the description */\n  description?: string;\n  /** User ID for multi-user OAuth */\n  userId?: string;\n  /** Account alias for multi-account OAuth (baked into tool name and context) */\n  accountId?: string;\n  /** Permission config for the tool */\n  permission?: ToolPermissionConfig;\n}\n\n/**\n * Arguments for the generic API call tool\n */\nexport interface GenericAPICallArgs {\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n  endpoint: string;\n  body?: Record<string, unknown>;\n  queryParams?: Record<string, string | number | boolean>;\n  headers?: Record<string, string>;\n}\n\n/**\n * Result from the generic API call tool\n */\nexport interface GenericAPICallResult {\n  success: boolean;\n  status?: number;\n  data?: unknown;\n  error?: string;\n}\n\n/**\n * Options for ConnectorTools methods that accept a scoped registry\n */\nexport interface ConnectorToolsOptions {\n  /** Optional scoped registry for access-controlled connector lookup */\n  registry?: IConnectorRegistry;\n  /** Account alias for multi-account OAuth. When set, tools are prefixed with accountId and context is bound. */\n  accountId?: string;\n}\n\n/**\n * ConnectorTools - Main API for vendor-dependent tools\n *\n * Usage:\n * ```typescript\n * // Get all tools for a connector\n * const tools = ConnectorTools.for('slack');\n *\n * // Get just the generic API tool\n * const apiTool = ConnectorTools.genericAPI('github');\n *\n * // Discover all available connector tools\n * const allTools = ConnectorTools.discoverAll();\n *\n * // With scoped registry (access control)\n * const registry = Connector.scoped({ tenantId: 'acme' });\n * const tools = ConnectorTools.for('slack', undefined, { registry });\n * ```\n */\nexport class ConnectorTools {\n  /** Registry of service-specific tool factories */\n  private static factories = new Map<string, ServiceToolFactory>();\n\n  /** Cache for detected service types (connector name -> service type) */\n  private static serviceTypeCache = new Map<string, string | undefined>();\n\n  /** Cache for generated tools (cacheKey -> tools) */\n  private static toolCache = new Map<string, ToolFunction[]>();\n\n  /** Maximum cache size to prevent memory issues */\n  private static readonly MAX_CACHE_SIZE = 100;\n\n  /**\n   * Clear all caches (useful for testing or when connectors change)\n   */\n  static clearCache(): void {\n    this.serviceTypeCache.clear();\n    this.toolCache.clear();\n  }\n\n  /**\n   * Invalidate cache for a specific connector\n   */\n  static invalidateCache(connectorName: string): void {\n    this.serviceTypeCache.delete(connectorName);\n    // Remove all tool cache entries for this connector\n    for (const key of this.toolCache.keys()) {\n      if (key.startsWith(`${connectorName}:`)) {\n        this.toolCache.delete(key);\n      }\n    }\n  }\n\n  /**\n   * Register a tool factory for a service type\n   *\n   * @param serviceType - Service identifier (e.g., 'slack', 'github')\n   * @param factory - Function that creates tools from a Connector\n   *\n   * @example\n   * ```typescript\n   * ConnectorTools.registerService('slack', (connector) => [\n   *   createSlackSendMessageTool(connector),\n   *   createSlackListChannelsTool(connector),\n   * ]);\n   * ```\n   */\n  static registerService(serviceType: string, factory: ServiceToolFactory): void {\n    this.factories.set(serviceType, factory);\n    logger.debug(`[ConnectorTools.registerService] Registered factory for: ${serviceType} (total factories: ${this.factories.size})`);\n  }\n\n  /**\n   * Unregister a service tool factory\n   */\n  static unregisterService(serviceType: string): boolean {\n    return this.factories.delete(serviceType);\n  }\n\n  /**\n   * Get ALL tools for a connector (generic API + service-specific)\n   * This is the main entry point\n   *\n   * @param connectorOrName - Connector instance or name\n   * @param userId - Optional user ID for multi-user OAuth\n   * @returns Array of tools\n   *\n   * @example\n   * ```typescript\n   * const tools = ConnectorTools.for('slack');\n   * // Returns: [slack_api, slack_send_message, slack_list_channels, ...]\n   * ```\n   */\n  static for(connectorOrName: Connector | string, userId?: string, options?: ConnectorToolsOptions): ToolFunction[] {\n    const connector = this.resolveConnector(connectorOrName, options?.registry);\n    const accountId = options?.accountId;\n    const tools: ToolFunction[] = [];\n\n    // Name prefix: connectorName_accountId or just connectorName\n    const namePrefix = accountId\n      ? `${sanitizeToolName(connector.name)}_${sanitizeToolName(accountId)}`\n      : sanitizeToolName(connector.name);\n\n    // 1. Always include generic API tool if baseURL exists\n    if (connector.baseURL) {\n      const accountLabel = accountId ? ` (account: ${accountId})` : '';\n      tools.push(this.createGenericAPITool(connector, {\n        userId,\n        accountId,\n        toolName: `${namePrefix}_api`,\n        description:\n          `Make an authenticated API call to ${connector.displayName}${accountLabel}.` +\n          (connector.baseURL ? ` Base URL: ${connector.baseURL}.` : ' Provide full URL in endpoint.') +\n          ' IMPORTANT: For POST/PUT/PATCH requests, pass data in the \"body\" parameter as a JSON object, NOT as query string parameters in the endpoint URL. The body is sent as application/json.',\n      }));\n    }\n\n    // 2. Add service-specific tools if factory exists\n    const serviceType = this.detectService(connector);\n    if (serviceType && this.factories.has(serviceType)) {\n      const factory = this.factories.get(serviceType)!;\n      const serviceTools = factory(connector, userId);\n      for (const tool of serviceTools) {\n        tool.definition.function.name = `${namePrefix}_${tool.definition.function.name}`;\n      }\n      tools.push(...serviceTools);\n    }\n\n    // 3. If accountId is set, wrap all tools to inject accountId into ToolContext at execute time\n    if (accountId) {\n      return tools.map(tool => this.bindAccountId(tool, accountId));\n    }\n\n    return tools;\n  }\n\n  /**\n   * Get just the generic API tool for a connector\n   *\n   * @param connectorOrName - Connector instance or name\n   * @param options - Optional configuration\n   * @returns Generic API tool\n   *\n   * @example\n   * ```typescript\n   * const apiTool = ConnectorTools.genericAPI('github');\n   * ```\n   */\n  static genericAPI(\n    connectorOrName: Connector | string,\n    options?: GenericAPIToolOptions\n  ): ToolFunction<GenericAPICallArgs, GenericAPICallResult> {\n    const connector = this.resolveConnector(connectorOrName);\n    return this.createGenericAPITool(connector, options);\n  }\n\n  /**\n   * Get only service-specific tools (no generic API tool)\n   *\n   * @param connectorOrName - Connector instance or name\n   * @param userId - Optional user ID for multi-user OAuth\n   * @returns Service-specific tools only\n   */\n  static serviceTools(connectorOrName: Connector | string, userId?: string): ToolFunction[] {\n    const connector = this.resolveConnector(connectorOrName);\n    const serviceType = this.detectService(connector);\n\n    if (!serviceType || !this.factories.has(serviceType)) {\n      return [];\n    }\n\n    return this.factories.get(serviceType)!(connector, userId);\n  }\n\n  /**\n   * Discover tools for ALL registered connectors with external services\n   * Skips AI provider connectors (those with vendor but no serviceType)\n   *\n   * @param userId - Optional user ID for multi-user OAuth\n   * @returns Map of connector name to tools\n   *\n   * @example\n   * ```typescript\n   * const allTools = ConnectorTools.discoverAll();\n   * for (const [name, tools] of allTools) {\n   *   agent.tools.registerMany(tools, { namespace: name });\n   * }\n   * ```\n   */\n  static discoverAll(userId?: string, options?: ConnectorToolsOptions): Map<string, ToolFunction[]> {\n    const result = new Map<string, ToolFunction[]>();\n    const allConnectors = options?.registry ? options.registry.listAll() : Connector.listAll();\n    const factoryKeys = Array.from(this.factories.keys());\n    logger.debug(`[ConnectorTools.discoverAll] ${allConnectors.length} connectors in library, ${factoryKeys.length} factories registered: [${factoryKeys.join(', ')}]`);\n\n    for (const connector of allConnectors) {\n      // Include connectors that:\n      // 1. Have explicit serviceType, OR\n      // 2. Have baseURL but no vendor (external API, not AI provider), OR\n      // 3. Have a vendor with registered tool factories (e.g., multimedia tools)\n      const hasServiceType = !!connector.config.serviceType;\n      const isExternalAPI = connector.baseURL && !connector.vendor;\n      const hasVendorFactory = !!connector.vendor && this.factories.has(connector.vendor);\n\n      logger.debug(`[ConnectorTools.discoverAll] connector=${connector.name}: vendor=${connector.vendor}, serviceType=${connector.config.serviceType}, baseURL=${connector.baseURL ? 'yes' : 'no'}  hasServiceType=${hasServiceType}, isExternalAPI=${isExternalAPI}, hasVendorFactory=${hasVendorFactory}`);\n\n      if (hasServiceType || isExternalAPI || hasVendorFactory) {\n        try {\n          const tools = this.for(connector, userId);\n          logger.debug(`[ConnectorTools.discoverAll]    ${tools.length} tools: [${tools.map(t => t.definition.function.name).join(', ')}]`);\n          if (tools.length > 0) {\n            result.set(connector.name, tools);\n          }\n        } catch (err) {\n          logger.error(`[ConnectorTools.discoverAll]    ERROR generating tools for ${connector.name}: ${err instanceof Error ? err.message : String(err)}`);\n        }\n      }\n    }\n\n    logger.debug(`[ConnectorTools.discoverAll] Result: ${result.size} connectors with tools`);\n    return result;\n  }\n\n  /**\n   * Find a connector by service type\n   * Returns the first connector matching the service type\n   *\n   * @param serviceType - Service identifier\n   * @returns Connector or undefined\n   */\n  static findConnector(serviceType: string, options?: ConnectorToolsOptions): Connector | undefined {\n    const connectors = options?.registry ? options.registry.listAll() : Connector.listAll();\n    return connectors.find((c) => this.detectService(c) === serviceType);\n  }\n\n  /**\n   * Find all connectors for a service type\n   * Useful when you have multiple connectors for the same service\n   *\n   * @param serviceType - Service identifier\n   * @returns Array of matching connectors\n   */\n  static findConnectors(serviceType: string, options?: ConnectorToolsOptions): Connector[] {\n    const connectors = options?.registry ? options.registry.listAll() : Connector.listAll();\n    return connectors.filter((c) => this.detectService(c) === serviceType);\n  }\n\n  /**\n   * List services that have registered tool factories\n   */\n  static listSupportedServices(): string[] {\n    return Array.from(this.factories.keys());\n  }\n\n  /**\n   * Check if a service has dedicated tool factory\n   */\n  static hasServiceTools(serviceType: string): boolean {\n    return this.factories.has(serviceType);\n  }\n\n  /**\n   * Detect the service type for a connector\n   * Uses explicit serviceType if set, otherwise infers from baseURL\n   * Results are cached for performance\n   */\n  static detectService(connector: Connector): string | undefined {\n    // Check cache first\n    const cacheKey = connector.name;\n    if (this.serviceTypeCache.has(cacheKey)) {\n      return this.serviceTypeCache.get(cacheKey);\n    }\n\n    let result: string | undefined;\n\n    // 1. Explicit serviceType takes precedence\n    if (connector.config.serviceType) {\n      result = connector.config.serviceType;\n    }\n    // 2. Infer from baseURL patterns\n    else if (connector.baseURL) {\n      result = detectServiceFromURL(connector.baseURL);\n    }\n\n    // 3. Fall back to vendor as service identifier (for AI vendor connectors)\n    if (!result && connector.vendor) {\n      result = connector.vendor;\n    }\n\n    // Cache the result (even if undefined)\n    this.maintainCacheSize(this.serviceTypeCache);\n    this.serviceTypeCache.set(cacheKey, result);\n\n    return result;\n  }\n\n  /**\n   * Maintain cache size to prevent memory leaks\n   */\n  private static maintainCacheSize<K, V>(cache: Map<K, V>): void {\n    if (cache.size >= this.MAX_CACHE_SIZE) {\n      // Remove oldest entries (first 10%)\n      const toRemove = Math.ceil(this.MAX_CACHE_SIZE * 0.1);\n      const keys = Array.from(cache.keys()).slice(0, toRemove);\n      for (const key of keys) {\n        cache.delete(key);\n      }\n    }\n  }\n\n  // ============ Private Methods ============\n\n  private static resolveConnector(connectorOrName: Connector | string, registry?: IConnectorRegistry): Connector {\n    if (typeof connectorOrName === 'string') {\n      return registry ? registry.get(connectorOrName) : Connector.get(connectorOrName);\n    }\n    return connectorOrName;\n  }\n\n  /**\n   * Generate tools for a set of auth identities.\n   * Each identity gets its own tool set with unique name prefixes.\n   *\n   * @param identities - Array of auth identities\n   * @param userId - Optional user ID for multi-user OAuth\n   * @param options - Optional registry for scoped connector lookup\n   * @returns Map of identity key to tool array\n   *\n   * @example\n   * ```typescript\n   * const toolsByIdentity = ConnectorTools.forIdentities([\n   *   { connector: 'microsoft', accountId: 'work' },\n   *   { connector: 'microsoft', accountId: 'personal' },\n   *   { connector: 'github' },\n   * ]);\n   * // Keys: 'microsoft:work', 'microsoft:personal', 'github'\n   * ```\n   */\n  static forIdentities(\n    identities: AuthIdentity[],\n    userId?: string,\n    options?: { registry?: IConnectorRegistry }\n  ): Map<string, ToolFunction[]> {\n    const result = new Map<string, ToolFunction[]>();\n\n    for (const identity of identities) {\n      const key = identity.accountId\n        ? `${identity.connector}:${identity.accountId}`\n        : identity.connector;\n\n      try {\n        const tools = this.for(identity.connector, userId, {\n          registry: options?.registry,\n          accountId: identity.accountId,\n        });\n        if (tools.length > 0) {\n          result.set(key, tools);\n        }\n      } catch (err) {\n        logger.error(`[ConnectorTools.forIdentities] Error generating tools for identity ${key}: ${err instanceof Error ? err.message : String(err)}`);\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Wrap a tool to inject accountId into ToolContext at execute time.\n   * This allows identity-bound tools to use the correct account without\n   * modifying every service tool factory.\n   */\n  private static bindAccountId(tool: ToolFunction, accountId: string): ToolFunction {\n    return {\n      ...tool,\n      execute: async (args: any, context?: ToolContext) => {\n        return tool.execute(args, { ...context, accountId });\n      },\n    };\n  }\n\n  private static createGenericAPITool(\n    connector: Connector,\n    options?: GenericAPIToolOptions\n  ): ToolFunction<GenericAPICallArgs, GenericAPICallResult> {\n    const toolName = options?.toolName ?? `${sanitizeToolName(connector.name)}_api`;\n    const userId = options?.userId;\n\n    const description =\n      options?.description ??\n      `Make an authenticated API call to ${connector.displayName}.` +\n        (connector.baseURL ? ` Base URL: ${connector.baseURL}.` : ' Provide full URL in endpoint.') +\n        ' IMPORTANT: For POST/PUT/PATCH requests, pass data in the \"body\" parameter as a JSON object, NOT as query string parameters in the endpoint URL. The body is sent as application/json.';\n\n    return {\n      definition: {\n        type: 'function',\n        function: {\n          name: toolName,\n          description,\n          parameters: {\n            type: 'object',\n            properties: {\n              method: {\n                type: 'string',\n                enum: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n                description: 'HTTP method',\n              },\n              endpoint: {\n                type: 'string',\n                description: 'API endpoint path (relative to base URL) or full URL. Do NOT put request data as query parameters here for POST/PUT/PATCH  use the \"body\" parameter instead.',\n              },\n              body: {\n                type: 'object',\n                description: 'JSON request body for POST/PUT/PATCH requests. MUST be a JSON object (NOT a string). Example: {\"channel\": \"C123\", \"text\": \"hello\"}. Do NOT stringify this  pass it as a raw JSON object. Do NOT use query string parameters for POST data.',\n              },\n              queryParams: {\n                type: 'object',\n                description: 'URL query parameters (for filtering/pagination on GET requests). Do NOT use for POST/PUT/PATCH data  use \"body\" instead.',\n              },\n              headers: {\n                type: 'object',\n                description: 'Additional request headers',\n              },\n            },\n            required: ['method', 'endpoint'],\n          },\n        },\n      },\n\n      execute: async (args: GenericAPICallArgs, context?: ToolContext): Promise<GenericAPICallResult> => {\n        const effectiveUserId = context?.userId ?? userId;\n        const effectiveAccountId = context?.accountId;\n        let url = args.endpoint;\n\n        // Add query params if provided\n        if (args.queryParams && Object.keys(args.queryParams).length > 0) {\n          const params = new URLSearchParams();\n          for (const [key, value] of Object.entries(args.queryParams)) {\n            params.append(key, String(value));\n          }\n          url += (url.includes('?') ? '&' : '?') + params.toString();\n        }\n\n        // Filter out protected headers (security: prevent auth header override)\n        const safeHeaders = filterProtectedHeaders(args.headers);\n\n        // Normalize and stringify body (handles LLM sending stringified JSON)\n        let bodyStr: string | undefined;\n        if (args.body) {\n          try {\n            const normalized = normalizeBody(args.body);\n            bodyStr = safeStringify(normalized);\n          } catch (e) {\n            return {\n              success: false,\n              error: `Failed to serialize request body: ${e instanceof Error ? e.message : String(e)}`,\n            };\n          }\n        }\n\n        try {\n          const response = await connector.fetch(\n            url,\n            {\n              method: args.method,\n              headers: {\n                'Content-Type': 'application/json',\n                ...safeHeaders,\n              },\n              body: bodyStr,\n            },\n            effectiveUserId,\n            effectiveAccountId\n          );\n\n          // Try to parse as JSON\n          const text = await response.text();\n          let data: unknown;\n\n          try {\n            data = JSON.parse(text);\n          } catch {\n            data = text;\n          }\n\n          // Check for API-level errors (many APIs return 200 with error in body)\n          const apiError = detectAPIError(data);\n\n          return {\n            success: response.ok && !apiError,\n            status: response.status,\n            data: (response.ok && !apiError) ? data : undefined,\n            error: apiError\n              ? apiError\n              : response.ok\n                ? undefined\n                : typeof data === 'string' ? data : safeStringify(data),\n          };\n        } catch (error) {\n          return {\n            success: false,\n            error: error instanceof Error ? error.message : String(error),\n          };\n        }\n      },\n\n      describeCall: (args: GenericAPICallArgs) => {\n        const bodyInfo = args.body ? ` body=${JSON.stringify(args.body).slice(0, 100)}` : '';\n        return `${args.method} ${args.endpoint}${bodyInfo}`;\n      },\n\n      permission: options?.permission ?? {\n        scope: 'session',\n        riskLevel: 'medium',\n        approvalMessage: `This will make an API call to ${connector.displayName}`,\n      },\n    };\n  }\n}\n","// eslint-disable-next-line @typescript-eslint/no-extraneous-class\nexport abstract class _CodeOrName {\n  abstract readonly str: string\n  abstract readonly names: UsedNames\n  abstract toString(): string\n  abstract emptyStr(): boolean\n}\n\nexport const IDENTIFIER = /^[a-z$_][a-z$_0-9]*$/i\n\nexport class Name extends _CodeOrName {\n  readonly str: string\n  constructor(s: string) {\n    super()\n    if (!IDENTIFIER.test(s)) throw new Error(\"CodeGen: name must be a valid identifier\")\n    this.str = s\n  }\n\n  toString(): string {\n    return this.str\n  }\n\n  emptyStr(): boolean {\n    return false\n  }\n\n  get names(): UsedNames {\n    return {[this.str]: 1}\n  }\n}\n\nexport class _Code extends _CodeOrName {\n  readonly _items: readonly CodeItem[]\n  private _str?: string\n  private _names?: UsedNames\n\n  constructor(code: string | readonly CodeItem[]) {\n    super()\n    this._items = typeof code === \"string\" ? [code] : code\n  }\n\n  toString(): string {\n    return this.str\n  }\n\n  emptyStr(): boolean {\n    if (this._items.length > 1) return false\n    const item = this._items[0]\n    return item === \"\" || item === '\"\"'\n  }\n\n  get str(): string {\n    return (this._str ??= this._items.reduce((s: string, c: CodeItem) => `${s}${c}`, \"\"))\n  }\n\n  get names(): UsedNames {\n    return (this._names ??= this._items.reduce((names: UsedNames, c) => {\n      if (c instanceof Name) names[c.str] = (names[c.str] || 0) + 1\n      return names\n    }, {}))\n  }\n}\n\nexport type CodeItem = Name | string | number | boolean | null\n\nexport type UsedNames = Record<string, number | undefined>\n\nexport type Code = _Code | Name\n\nexport type SafeExpr = Code | number | boolean | null\n\nexport const nil = new _Code(\"\")\n\ntype CodeArg = SafeExpr | string | undefined\n\nexport function _(strs: TemplateStringsArray, ...args: CodeArg[]): _Code {\n  const code: CodeItem[] = [strs[0]]\n  let i = 0\n  while (i < args.length) {\n    addCodeArg(code, args[i])\n    code.push(strs[++i])\n  }\n  return new _Code(code)\n}\n\nconst plus = new _Code(\"+\")\n\nexport function str(strs: TemplateStringsArray, ...args: (CodeArg | string[])[]): _Code {\n  const expr: CodeItem[] = [safeStringify(strs[0])]\n  let i = 0\n  while (i < args.length) {\n    expr.push(plus)\n    addCodeArg(expr, args[i])\n    expr.push(plus, safeStringify(strs[++i]))\n  }\n  optimize(expr)\n  return new _Code(expr)\n}\n\nexport function addCodeArg(code: CodeItem[], arg: CodeArg | string[]): void {\n  if (arg instanceof _Code) code.push(...arg._items)\n  else if (arg instanceof Name) code.push(arg)\n  else code.push(interpolate(arg))\n}\n\nfunction optimize(expr: CodeItem[]): void {\n  let i = 1\n  while (i < expr.length - 1) {\n    if (expr[i] === plus) {\n      const res = mergeExprItems(expr[i - 1], expr[i + 1])\n      if (res !== undefined) {\n        expr.splice(i - 1, 3, res)\n        continue\n      }\n      expr[i++] = \"+\"\n    }\n    i++\n  }\n}\n\nfunction mergeExprItems(a: CodeItem, b: CodeItem): CodeItem | undefined {\n  if (b === '\"\"') return a\n  if (a === '\"\"') return b\n  if (typeof a == \"string\") {\n    if (b instanceof Name || a[a.length - 1] !== '\"') return\n    if (typeof b != \"string\") return `${a.slice(0, -1)}${b}\"`\n    if (b[0] === '\"') return a.slice(0, -1) + b.slice(1)\n    return\n  }\n  if (typeof b == \"string\" && b[0] === '\"' && !(a instanceof Name)) return `\"${a}${b.slice(1)}`\n  return\n}\n\nexport function strConcat(c1: Code, c2: Code): Code {\n  return c2.emptyStr() ? c1 : c1.emptyStr() ? c2 : str`${c1}${c2}`\n}\n\n// TODO do not allow arrays here\nfunction interpolate(x?: string | string[] | number | boolean | null): SafeExpr | string {\n  return typeof x == \"number\" || typeof x == \"boolean\" || x === null\n    ? x\n    : safeStringify(Array.isArray(x) ? x.join(\",\") : x)\n}\n\nexport function stringify(x: unknown): Code {\n  return new _Code(safeStringify(x))\n}\n\nexport function safeStringify(x: unknown): string {\n  return JSON.stringify(x)\n    .replace(/\\u2028/g, \"\\\\u2028\")\n    .replace(/\\u2029/g, \"\\\\u2029\")\n}\n\nexport function getProperty(key: Code | string | number): Code {\n  return typeof key == \"string\" && IDENTIFIER.test(key) ? new _Code(`.${key}`) : _`[${key}]`\n}\n\n//Does best effort to format the name properly\nexport function getEsmExportName(key: Code | string | number): Code {\n  if (typeof key == \"string\" && IDENTIFIER.test(key)) {\n    return new _Code(`${key}`)\n  }\n  throw new Error(`CodeGen: invalid export name: ${key}, use explicit $id name mapping`)\n}\n\nexport function regexpCode(rx: RegExp): Code {\n  return new _Code(rx.toString())\n}\n","import {_, nil, Code, Name} from \"./code\"\n\ninterface NameGroup {\n  prefix: string\n  index: number\n}\n\nexport interface NameValue {\n  ref: ValueReference // this is the reference to any value that can be referred to from generated code via `globals` var in the closure\n  key?: unknown // any key to identify a global to avoid duplicates, if not passed ref is used\n  code?: Code // this is the code creating the value needed for standalone code wit_out closure - can be a primitive value, function or import (`require`)\n}\n\nexport type ValueReference = unknown // possibly make CodeGen parameterized type on this type\n\nclass ValueError extends Error {\n  readonly value?: NameValue\n  constructor(name: ValueScopeName) {\n    super(`CodeGen: \"code\" for ${name} not defined`)\n    this.value = name.value\n  }\n}\n\ninterface ScopeOptions {\n  prefixes?: Set<string>\n  parent?: Scope\n}\n\ninterface ValueScopeOptions extends ScopeOptions {\n  scope: ScopeStore\n  es5?: boolean\n  lines?: boolean\n}\n\nexport type ScopeStore = Record<string, ValueReference[] | undefined>\n\ntype ScopeValues = {\n  [Prefix in string]?: Map<unknown, ValueScopeName>\n}\n\nexport type ScopeValueSets = {\n  [Prefix in string]?: Set<ValueScopeName>\n}\n\nexport enum UsedValueState {\n  Started,\n  Completed,\n}\n\nexport type UsedScopeValues = {\n  [Prefix in string]?: Map<ValueScopeName, UsedValueState | undefined>\n}\n\nexport const varKinds = {\n  const: new Name(\"const\"),\n  let: new Name(\"let\"),\n  var: new Name(\"var\"),\n}\n\nexport class Scope {\n  protected readonly _names: {[Prefix in string]?: NameGroup} = {}\n  protected readonly _prefixes?: Set<string>\n  protected readonly _parent?: Scope\n\n  constructor({prefixes, parent}: ScopeOptions = {}) {\n    this._prefixes = prefixes\n    this._parent = parent\n  }\n\n  toName(nameOrPrefix: Name | string): Name {\n    return nameOrPrefix instanceof Name ? nameOrPrefix : this.name(nameOrPrefix)\n  }\n\n  name(prefix: string): Name {\n    return new Name(this._newName(prefix))\n  }\n\n  protected _newName(prefix: string): string {\n    const ng = this._names[prefix] || this._nameGroup(prefix)\n    return `${prefix}${ng.index++}`\n  }\n\n  private _nameGroup(prefix: string): NameGroup {\n    if (this._parent?._prefixes?.has(prefix) || (this._prefixes && !this._prefixes.has(prefix))) {\n      throw new Error(`CodeGen: prefix \"${prefix}\" is not allowed in this scope`)\n    }\n    return (this._names[prefix] = {prefix, index: 0})\n  }\n}\n\ninterface ScopePath {\n  property: string\n  itemIndex: number\n}\n\nexport class ValueScopeName extends Name {\n  readonly prefix: string\n  value?: NameValue\n  scopePath?: Code\n\n  constructor(prefix: string, nameStr: string) {\n    super(nameStr)\n    this.prefix = prefix\n  }\n\n  setValue(value: NameValue, {property, itemIndex}: ScopePath): void {\n    this.value = value\n    this.scopePath = _`.${new Name(property)}[${itemIndex}]`\n  }\n}\n\ninterface VSOptions extends ValueScopeOptions {\n  _n: Code\n}\n\nconst line = _`\\n`\n\nexport class ValueScope extends Scope {\n  protected readonly _values: ScopeValues = {}\n  protected readonly _scope: ScopeStore\n  readonly opts: VSOptions\n\n  constructor(opts: ValueScopeOptions) {\n    super(opts)\n    this._scope = opts.scope\n    this.opts = {...opts, _n: opts.lines ? line : nil}\n  }\n\n  get(): ScopeStore {\n    return this._scope\n  }\n\n  name(prefix: string): ValueScopeName {\n    return new ValueScopeName(prefix, this._newName(prefix))\n  }\n\n  value(nameOrPrefix: ValueScopeName | string, value: NameValue): ValueScopeName {\n    if (value.ref === undefined) throw new Error(\"CodeGen: ref must be passed in value\")\n    const name = this.toName(nameOrPrefix) as ValueScopeName\n    const {prefix} = name\n    const valueKey = value.key ?? value.ref\n    let vs = this._values[prefix]\n    if (vs) {\n      const _name = vs.get(valueKey)\n      if (_name) return _name\n    } else {\n      vs = this._values[prefix] = new Map()\n    }\n    vs.set(valueKey, name)\n\n    const s = this._scope[prefix] || (this._scope[prefix] = [])\n    const itemIndex = s.length\n    s[itemIndex] = value.ref\n    name.setValue(value, {property: prefix, itemIndex})\n    return name\n  }\n\n  getValue(prefix: string, keyOrRef: unknown): ValueScopeName | undefined {\n    const vs = this._values[prefix]\n    if (!vs) return\n    return vs.get(keyOrRef)\n  }\n\n  scopeRefs(scopeName: Name, values: ScopeValues | ScopeValueSets = this._values): Code {\n    return this._reduceValues(values, (name: ValueScopeName) => {\n      if (name.scopePath === undefined) throw new Error(`CodeGen: name \"${name}\" has no value`)\n      return _`${scopeName}${name.scopePath}`\n    })\n  }\n\n  scopeCode(\n    values: ScopeValues | ScopeValueSets = this._values,\n    usedValues?: UsedScopeValues,\n    getCode?: (n: ValueScopeName) => Code | undefined\n  ): Code {\n    return this._reduceValues(\n      values,\n      (name: ValueScopeName) => {\n        if (name.value === undefined) throw new Error(`CodeGen: name \"${name}\" has no value`)\n        return name.value.code\n      },\n      usedValues,\n      getCode\n    )\n  }\n\n  private _reduceValues(\n    values: ScopeValues | ScopeValueSets,\n    valueCode: (n: ValueScopeName) => Code | undefined,\n    usedValues: UsedScopeValues = {},\n    getCode?: (n: ValueScopeName) => Code | undefined\n  ): Code {\n    let code: Code = nil\n    for (const prefix in values) {\n      const vs = values[prefix]\n      if (!vs) continue\n      const nameSet = (usedValues[prefix] = usedValues[prefix] || new Map())\n      vs.forEach((name: ValueScopeName) => {\n        if (nameSet.has(name)) return\n        nameSet.set(name, UsedValueState.Started)\n        let c = valueCode(name)\n        if (c) {\n          const def = this.opts.es5 ? varKinds.var : varKinds.const\n          code = _`${code}${def} ${name} = ${c};${this.opts._n}`\n        } else if ((c = getCode?.(name))) {\n          code = _`${code}${c}${this.opts._n}`\n        } else {\n          throw new ValueError(name)\n        }\n        nameSet.set(name, UsedValueState.Completed)\n      })\n    }\n    return code\n  }\n}\n","import type {ScopeValueSets, NameValue, ValueScope, ValueScopeName} from \"./scope\"\nimport {_, nil, _Code, Code, Name, UsedNames, CodeItem, addCodeArg, _CodeOrName} from \"./code\"\nimport {Scope, varKinds} from \"./scope\"\n\nexport {_, str, strConcat, nil, getProperty, stringify, regexpCode, Name, Code} from \"./code\"\nexport {Scope, ScopeStore, ValueScope, ValueScopeName, ScopeValueSets, varKinds} from \"./scope\"\n\n// type for expressions that can be safely inserted in code without quotes\nexport type SafeExpr = Code | number | boolean | null\n\n// type that is either Code of function that adds code to CodeGen instance using its methods\nexport type Block = Code | (() => void)\n\nexport const operators = {\n  GT: new _Code(\">\"),\n  GTE: new _Code(\">=\"),\n  LT: new _Code(\"<\"),\n  LTE: new _Code(\"<=\"),\n  EQ: new _Code(\"===\"),\n  NEQ: new _Code(\"!==\"),\n  NOT: new _Code(\"!\"),\n  OR: new _Code(\"||\"),\n  AND: new _Code(\"&&\"),\n  ADD: new _Code(\"+\"),\n}\n\nabstract class Node {\n  abstract readonly names: UsedNames\n\n  optimizeNodes(): this | ChildNode | ChildNode[] | undefined {\n    return this\n  }\n\n  optimizeNames(_names: UsedNames, _constants: Constants): this | undefined {\n    return this\n  }\n\n  // get count(): number {\n  //   return 1\n  // }\n}\n\nclass Def extends Node {\n  constructor(\n    private readonly varKind: Name,\n    private readonly name: Name,\n    private rhs?: SafeExpr\n  ) {\n    super()\n  }\n\n  render({es5, _n}: CGOptions): string {\n    const varKind = es5 ? varKinds.var : this.varKind\n    const rhs = this.rhs === undefined ? \"\" : ` = ${this.rhs}`\n    return `${varKind} ${this.name}${rhs};` + _n\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this | undefined {\n    if (!names[this.name.str]) return\n    if (this.rhs) this.rhs = optimizeExpr(this.rhs, names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    return this.rhs instanceof _CodeOrName ? this.rhs.names : {}\n  }\n}\n\nclass Assign extends Node {\n  constructor(\n    readonly lhs: Code,\n    public rhs: SafeExpr,\n    private readonly sideEffects?: boolean\n  ) {\n    super()\n  }\n\n  render({_n}: CGOptions): string {\n    return `${this.lhs} = ${this.rhs};` + _n\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this | undefined {\n    if (this.lhs instanceof Name && !names[this.lhs.str] && !this.sideEffects) return\n    this.rhs = optimizeExpr(this.rhs, names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    const names = this.lhs instanceof Name ? {} : {...this.lhs.names}\n    return addExprNames(names, this.rhs)\n  }\n}\n\nclass AssignOp extends Assign {\n  constructor(\n    lhs: Code,\n    private readonly op: Code,\n    rhs: SafeExpr,\n    sideEffects?: boolean\n  ) {\n    super(lhs, rhs, sideEffects)\n  }\n\n  render({_n}: CGOptions): string {\n    return `${this.lhs} ${this.op}= ${this.rhs};` + _n\n  }\n}\n\nclass Label extends Node {\n  readonly names: UsedNames = {}\n  constructor(readonly label: Name) {\n    super()\n  }\n\n  render({_n}: CGOptions): string {\n    return `${this.label}:` + _n\n  }\n}\n\nclass Break extends Node {\n  readonly names: UsedNames = {}\n  constructor(readonly label?: Code) {\n    super()\n  }\n\n  render({_n}: CGOptions): string {\n    const label = this.label ? ` ${this.label}` : \"\"\n    return `break${label};` + _n\n  }\n}\n\nclass Throw extends Node {\n  constructor(readonly error: Code) {\n    super()\n  }\n\n  render({_n}: CGOptions): string {\n    return `throw ${this.error};` + _n\n  }\n\n  get names(): UsedNames {\n    return this.error.names\n  }\n}\n\nclass AnyCode extends Node {\n  constructor(private code: SafeExpr) {\n    super()\n  }\n\n  render({_n}: CGOptions): string {\n    return `${this.code};` + _n\n  }\n\n  optimizeNodes(): this | undefined {\n    return `${this.code}` ? this : undefined\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this {\n    this.code = optimizeExpr(this.code, names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    return this.code instanceof _CodeOrName ? this.code.names : {}\n  }\n}\n\nabstract class ParentNode extends Node {\n  constructor(readonly nodes: ChildNode[] = []) {\n    super()\n  }\n\n  render(opts: CGOptions): string {\n    return this.nodes.reduce((code, n) => code + n.render(opts), \"\")\n  }\n\n  optimizeNodes(): this | ChildNode | ChildNode[] | undefined {\n    const {nodes} = this\n    let i = nodes.length\n    while (i--) {\n      const n = nodes[i].optimizeNodes()\n      if (Array.isArray(n)) nodes.splice(i, 1, ...n)\n      else if (n) nodes[i] = n\n      else nodes.splice(i, 1)\n    }\n    return nodes.length > 0 ? this : undefined\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this | undefined {\n    const {nodes} = this\n    let i = nodes.length\n    while (i--) {\n      // iterating backwards improves 1-pass optimization\n      const n = nodes[i]\n      if (n.optimizeNames(names, constants)) continue\n      subtractNames(names, n.names)\n      nodes.splice(i, 1)\n    }\n    return nodes.length > 0 ? this : undefined\n  }\n\n  get names(): UsedNames {\n    return this.nodes.reduce((names: UsedNames, n) => addNames(names, n.names), {})\n  }\n\n  // get count(): number {\n  //   return this.nodes.reduce((c, n) => c + n.count, 1)\n  // }\n}\n\nabstract class BlockNode extends ParentNode {\n  render(opts: CGOptions): string {\n    return \"{\" + opts._n + super.render(opts) + \"}\" + opts._n\n  }\n}\n\nclass Root extends ParentNode {}\n\nclass Else extends BlockNode {\n  static readonly kind = \"else\"\n}\n\nclass If extends BlockNode {\n  static readonly kind = \"if\"\n  else?: If | Else\n  constructor(\n    private condition: Code | boolean,\n    nodes?: ChildNode[]\n  ) {\n    super(nodes)\n  }\n\n  render(opts: CGOptions): string {\n    let code = `if(${this.condition})` + super.render(opts)\n    if (this.else) code += \"else \" + this.else.render(opts)\n    return code\n  }\n\n  optimizeNodes(): If | ChildNode[] | undefined {\n    super.optimizeNodes()\n    const cond = this.condition\n    if (cond === true) return this.nodes // else is ignored here\n    let e = this.else\n    if (e) {\n      const ns = e.optimizeNodes()\n      e = this.else = Array.isArray(ns) ? new Else(ns) : (ns as Else | undefined)\n    }\n    if (e) {\n      if (cond === false) return e instanceof If ? e : e.nodes\n      if (this.nodes.length) return this\n      return new If(not(cond), e instanceof If ? [e] : e.nodes)\n    }\n    if (cond === false || !this.nodes.length) return undefined\n    return this\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this | undefined {\n    this.else = this.else?.optimizeNames(names, constants)\n    if (!(super.optimizeNames(names, constants) || this.else)) return\n    this.condition = optimizeExpr(this.condition, names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    const names = super.names\n    addExprNames(names, this.condition)\n    if (this.else) addNames(names, this.else.names)\n    return names\n  }\n\n  // get count(): number {\n  //   return super.count + (this.else?.count || 0)\n  // }\n}\n\nabstract class For extends BlockNode {\n  static readonly kind = \"for\"\n}\n\nclass ForLoop extends For {\n  constructor(private iteration: Code) {\n    super()\n  }\n\n  render(opts: CGOptions): string {\n    return `for(${this.iteration})` + super.render(opts)\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this | undefined {\n    if (!super.optimizeNames(names, constants)) return\n    this.iteration = optimizeExpr(this.iteration, names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    return addNames(super.names, this.iteration.names)\n  }\n}\n\nclass ForRange extends For {\n  constructor(\n    private readonly varKind: Name,\n    private readonly name: Name,\n    private readonly from: SafeExpr,\n    private readonly to: SafeExpr\n  ) {\n    super()\n  }\n\n  render(opts: CGOptions): string {\n    const varKind = opts.es5 ? varKinds.var : this.varKind\n    const {name, from, to} = this\n    return `for(${varKind} ${name}=${from}; ${name}<${to}; ${name}++)` + super.render(opts)\n  }\n\n  get names(): UsedNames {\n    const names = addExprNames(super.names, this.from)\n    return addExprNames(names, this.to)\n  }\n}\n\nclass ForIter extends For {\n  constructor(\n    private readonly loop: \"of\" | \"in\",\n    private readonly varKind: Name,\n    private readonly name: Name,\n    private iterable: Code\n  ) {\n    super()\n  }\n\n  render(opts: CGOptions): string {\n    return `for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})` + super.render(opts)\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this | undefined {\n    if (!super.optimizeNames(names, constants)) return\n    this.iterable = optimizeExpr(this.iterable, names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    return addNames(super.names, this.iterable.names)\n  }\n}\n\nclass Func extends BlockNode {\n  static readonly kind = \"func\"\n  constructor(\n    public name: Name,\n    public args: Code,\n    public async?: boolean\n  ) {\n    super()\n  }\n\n  render(opts: CGOptions): string {\n    const _async = this.async ? \"async \" : \"\"\n    return `${_async}function ${this.name}(${this.args})` + super.render(opts)\n  }\n}\n\nclass Return extends ParentNode {\n  static readonly kind = \"return\"\n\n  render(opts: CGOptions): string {\n    return \"return \" + super.render(opts)\n  }\n}\n\nclass Try extends BlockNode {\n  catch?: Catch\n  finally?: Finally\n\n  render(opts: CGOptions): string {\n    let code = \"try\" + super.render(opts)\n    if (this.catch) code += this.catch.render(opts)\n    if (this.finally) code += this.finally.render(opts)\n    return code\n  }\n\n  optimizeNodes(): this {\n    super.optimizeNodes()\n    this.catch?.optimizeNodes() as Catch | undefined\n    this.finally?.optimizeNodes() as Finally | undefined\n    return this\n  }\n\n  optimizeNames(names: UsedNames, constants: Constants): this {\n    super.optimizeNames(names, constants)\n    this.catch?.optimizeNames(names, constants)\n    this.finally?.optimizeNames(names, constants)\n    return this\n  }\n\n  get names(): UsedNames {\n    const names = super.names\n    if (this.catch) addNames(names, this.catch.names)\n    if (this.finally) addNames(names, this.finally.names)\n    return names\n  }\n\n  // get count(): number {\n  //   return super.count + (this.catch?.count || 0) + (this.finally?.count || 0)\n  // }\n}\n\nclass Catch extends BlockNode {\n  static readonly kind = \"catch\"\n  constructor(readonly error: Name) {\n    super()\n  }\n\n  render(opts: CGOptions): string {\n    return `catch(${this.error})` + super.render(opts)\n  }\n}\n\nclass Finally extends BlockNode {\n  static readonly kind = \"finally\"\n  render(opts: CGOptions): string {\n    return \"finally\" + super.render(opts)\n  }\n}\n\ntype StartBlockNode = If | For | Func | Return | Try\n\ntype LeafNode = Def | Assign | Label | Break | Throw | AnyCode\n\ntype ChildNode = StartBlockNode | LeafNode\n\ntype EndBlockNodeType =\n  | typeof If\n  | typeof Else\n  | typeof For\n  | typeof Func\n  | typeof Return\n  | typeof Catch\n  | typeof Finally\n\ntype Constants = Record<string, SafeExpr | undefined>\n\nexport interface CodeGenOptions {\n  es5?: boolean\n  lines?: boolean\n  ownProperties?: boolean\n}\n\ninterface CGOptions extends CodeGenOptions {\n  _n: \"\\n\" | \"\"\n}\n\nexport class CodeGen {\n  readonly _scope: Scope\n  readonly _extScope: ValueScope\n  readonly _values: ScopeValueSets = {}\n  private readonly _nodes: ParentNode[]\n  private readonly _blockStarts: number[] = []\n  private readonly _constants: Constants = {}\n  private readonly opts: CGOptions\n\n  constructor(extScope: ValueScope, opts: CodeGenOptions = {}) {\n    this.opts = {...opts, _n: opts.lines ? \"\\n\" : \"\"}\n    this._extScope = extScope\n    this._scope = new Scope({parent: extScope})\n    this._nodes = [new Root()]\n  }\n\n  toString(): string {\n    return this._root.render(this.opts)\n  }\n\n  // returns unique name in the internal scope\n  name(prefix: string): Name {\n    return this._scope.name(prefix)\n  }\n\n  // reserves unique name in the external scope\n  scopeName(prefix: string): ValueScopeName {\n    return this._extScope.name(prefix)\n  }\n\n  // reserves unique name in the external scope and assigns value to it\n  scopeValue(prefixOrName: ValueScopeName | string, value: NameValue): Name {\n    const name = this._extScope.value(prefixOrName, value)\n    const vs = this._values[name.prefix] || (this._values[name.prefix] = new Set())\n    vs.add(name)\n    return name\n  }\n\n  getScopeValue(prefix: string, keyOrRef: unknown): ValueScopeName | undefined {\n    return this._extScope.getValue(prefix, keyOrRef)\n  }\n\n  // return code that assigns values in the external scope to the names that are used internally\n  // (same names that were returned by gen.scopeName or gen.scopeValue)\n  scopeRefs(scopeName: Name): Code {\n    return this._extScope.scopeRefs(scopeName, this._values)\n  }\n\n  scopeCode(): Code {\n    return this._extScope.scopeCode(this._values)\n  }\n\n  private _def(\n    varKind: Name,\n    nameOrPrefix: Name | string,\n    rhs?: SafeExpr,\n    constant?: boolean\n  ): Name {\n    const name = this._scope.toName(nameOrPrefix)\n    if (rhs !== undefined && constant) this._constants[name.str] = rhs\n    this._leafNode(new Def(varKind, name, rhs))\n    return name\n  }\n\n  // `const` declaration (`var` in es5 mode)\n  const(nameOrPrefix: Name | string, rhs: SafeExpr, _constant?: boolean): Name {\n    return this._def(varKinds.const, nameOrPrefix, rhs, _constant)\n  }\n\n  // `let` declaration with optional assignment (`var` in es5 mode)\n  let(nameOrPrefix: Name | string, rhs?: SafeExpr, _constant?: boolean): Name {\n    return this._def(varKinds.let, nameOrPrefix, rhs, _constant)\n  }\n\n  // `var` declaration with optional assignment\n  var(nameOrPrefix: Name | string, rhs?: SafeExpr, _constant?: boolean): Name {\n    return this._def(varKinds.var, nameOrPrefix, rhs, _constant)\n  }\n\n  // assignment code\n  assign(lhs: Code, rhs: SafeExpr, sideEffects?: boolean): CodeGen {\n    return this._leafNode(new Assign(lhs, rhs, sideEffects))\n  }\n\n  // `+=` code\n  add(lhs: Code, rhs: SafeExpr): CodeGen {\n    return this._leafNode(new AssignOp(lhs, operators.ADD, rhs))\n  }\n\n  // appends passed SafeExpr to code or executes Block\n  code(c: Block | SafeExpr): CodeGen {\n    if (typeof c == \"function\") c()\n    else if (c !== nil) this._leafNode(new AnyCode(c))\n    return this\n  }\n\n  // returns code for object literal for the passed argument list of key-value pairs\n  object(...keyValues: [Name | string, SafeExpr | string][]): _Code {\n    const code: CodeItem[] = [\"{\"]\n    for (const [key, value] of keyValues) {\n      if (code.length > 1) code.push(\",\")\n      code.push(key)\n      if (key !== value || this.opts.es5) {\n        code.push(\":\")\n        addCodeArg(code, value)\n      }\n    }\n    code.push(\"}\")\n    return new _Code(code)\n  }\n\n  // `if` clause (or statement if `thenBody` and, optionally, `elseBody` are passed)\n  if(condition: Code | boolean, thenBody?: Block, elseBody?: Block): CodeGen {\n    this._blockNode(new If(condition))\n\n    if (thenBody && elseBody) {\n      this.code(thenBody).else().code(elseBody).endIf()\n    } else if (thenBody) {\n      this.code(thenBody).endIf()\n    } else if (elseBody) {\n      throw new Error('CodeGen: \"else\" body without \"then\" body')\n    }\n    return this\n  }\n\n  // `else if` clause - invalid without `if` or after `else` clauses\n  elseIf(condition: Code | boolean): CodeGen {\n    return this._elseNode(new If(condition))\n  }\n\n  // `else` clause - only valid after `if` or `else if` clauses\n  else(): CodeGen {\n    return this._elseNode(new Else())\n  }\n\n  // end `if` statement (needed if gen.if was used only with condition)\n  endIf(): CodeGen {\n    return this._endBlockNode(If, Else)\n  }\n\n  private _for(node: For, forBody?: Block): CodeGen {\n    this._blockNode(node)\n    if (forBody) this.code(forBody).endFor()\n    return this\n  }\n\n  // a generic `for` clause (or statement if `forBody` is passed)\n  for(iteration: Code, forBody?: Block): CodeGen {\n    return this._for(new ForLoop(iteration), forBody)\n  }\n\n  // `for` statement for a range of values\n  forRange(\n    nameOrPrefix: Name | string,\n    from: SafeExpr,\n    to: SafeExpr,\n    forBody: (index: Name) => void,\n    varKind: Code = this.opts.es5 ? varKinds.var : varKinds.let\n  ): CodeGen {\n    const name = this._scope.toName(nameOrPrefix)\n    return this._for(new ForRange(varKind, name, from, to), () => forBody(name))\n  }\n\n  // `for-of` statement (in es5 mode replace with a normal for loop)\n  forOf(\n    nameOrPrefix: Name | string,\n    iterable: Code,\n    forBody: (item: Name) => void,\n    varKind: Code = varKinds.const\n  ): CodeGen {\n    const name = this._scope.toName(nameOrPrefix)\n    if (this.opts.es5) {\n      const arr = iterable instanceof Name ? iterable : this.var(\"_arr\", iterable)\n      return this.forRange(\"_i\", 0, _`${arr}.length`, (i) => {\n        this.var(name, _`${arr}[${i}]`)\n        forBody(name)\n      })\n    }\n    return this._for(new ForIter(\"of\", varKind, name, iterable), () => forBody(name))\n  }\n\n  // `for-in` statement.\n  // With option `ownProperties` replaced with a `for-of` loop for object keys\n  forIn(\n    nameOrPrefix: Name | string,\n    obj: Code,\n    forBody: (item: Name) => void,\n    varKind: Code = this.opts.es5 ? varKinds.var : varKinds.const\n  ): CodeGen {\n    if (this.opts.ownProperties) {\n      return this.forOf(nameOrPrefix, _`Object.keys(${obj})`, forBody)\n    }\n    const name = this._scope.toName(nameOrPrefix)\n    return this._for(new ForIter(\"in\", varKind, name, obj), () => forBody(name))\n  }\n\n  // end `for` loop\n  endFor(): CodeGen {\n    return this._endBlockNode(For)\n  }\n\n  // `label` statement\n  label(label: Name): CodeGen {\n    return this._leafNode(new Label(label))\n  }\n\n  // `break` statement\n  break(label?: Code): CodeGen {\n    return this._leafNode(new Break(label))\n  }\n\n  // `return` statement\n  return(value: Block | SafeExpr): CodeGen {\n    const node = new Return()\n    this._blockNode(node)\n    this.code(value)\n    if (node.nodes.length !== 1) throw new Error('CodeGen: \"return\" should have one node')\n    return this._endBlockNode(Return)\n  }\n\n  // `try` statement\n  try(tryBody: Block, catchCode?: (e: Name) => void, finallyCode?: Block): CodeGen {\n    if (!catchCode && !finallyCode) throw new Error('CodeGen: \"try\" without \"catch\" and \"finally\"')\n    const node = new Try()\n    this._blockNode(node)\n    this.code(tryBody)\n    if (catchCode) {\n      const error = this.name(\"e\")\n      this._currNode = node.catch = new Catch(error)\n      catchCode(error)\n    }\n    if (finallyCode) {\n      this._currNode = node.finally = new Finally()\n      this.code(finallyCode)\n    }\n    return this._endBlockNode(Catch, Finally)\n  }\n\n  // `throw` statement\n  throw(error: Code): CodeGen {\n    return this._leafNode(new Throw(error))\n  }\n\n  // start self-balancing block\n  block(body?: Block, nodeCount?: number): CodeGen {\n    this._blockStarts.push(this._nodes.length)\n    if (body) this.code(body).endBlock(nodeCount)\n    return this\n  }\n\n  // end the current self-balancing block\n  endBlock(nodeCount?: number): CodeGen {\n    const len = this._blockStarts.pop()\n    if (len === undefined) throw new Error(\"CodeGen: not in self-balancing block\")\n    const toClose = this._nodes.length - len\n    if (toClose < 0 || (nodeCount !== undefined && toClose !== nodeCount)) {\n      throw new Error(`CodeGen: wrong number of nodes: ${toClose} vs ${nodeCount} expected`)\n    }\n    this._nodes.length = len\n    return this\n  }\n\n  // `function` heading (or definition if funcBody is passed)\n  func(name: Name, args: Code = nil, async?: boolean, funcBody?: Block): CodeGen {\n    this._blockNode(new Func(name, args, async))\n    if (funcBody) this.code(funcBody).endFunc()\n    return this\n  }\n\n  // end function definition\n  endFunc(): CodeGen {\n    return this._endBlockNode(Func)\n  }\n\n  optimize(n = 1): void {\n    while (n-- > 0) {\n      this._root.optimizeNodes()\n      this._root.optimizeNames(this._root.names, this._constants)\n    }\n  }\n\n  private _leafNode(node: LeafNode): CodeGen {\n    this._currNode.nodes.push(node)\n    return this\n  }\n\n  private _blockNode(node: StartBlockNode): void {\n    this._currNode.nodes.push(node)\n    this._nodes.push(node)\n  }\n\n  private _endBlockNode(N1: EndBlockNodeType, N2?: EndBlockNodeType): CodeGen {\n    const n = this._currNode\n    if (n instanceof N1 || (N2 && n instanceof N2)) {\n      this._nodes.pop()\n      return this\n    }\n    throw new Error(`CodeGen: not in block \"${N2 ? `${N1.kind}/${N2.kind}` : N1.kind}\"`)\n  }\n\n  private _elseNode(node: If | Else): CodeGen {\n    const n = this._currNode\n    if (!(n instanceof If)) {\n      throw new Error('CodeGen: \"else\" without \"if\"')\n    }\n    this._currNode = n.else = node\n    return this\n  }\n\n  private get _root(): Root {\n    return this._nodes[0] as Root\n  }\n\n  private get _currNode(): ParentNode {\n    const ns = this._nodes\n    return ns[ns.length - 1]\n  }\n\n  private set _currNode(node: ParentNode) {\n    const ns = this._nodes\n    ns[ns.length - 1] = node\n  }\n\n  // get nodeCount(): number {\n  //   return this._root.count\n  // }\n}\n\nfunction addNames(names: UsedNames, from: UsedNames): UsedNames {\n  for (const n in from) names[n] = (names[n] || 0) + (from[n] || 0)\n  return names\n}\n\nfunction addExprNames(names: UsedNames, from: SafeExpr): UsedNames {\n  return from instanceof _CodeOrName ? addNames(names, from.names) : names\n}\n\nfunction optimizeExpr<T extends SafeExpr | Code>(expr: T, names: UsedNames, constants: Constants): T\nfunction optimizeExpr(expr: SafeExpr, names: UsedNames, constants: Constants): SafeExpr {\n  if (expr instanceof Name) return replaceName(expr)\n  if (!canOptimize(expr)) return expr\n  return new _Code(\n    expr._items.reduce((items: CodeItem[], c: SafeExpr | string) => {\n      if (c instanceof Name) c = replaceName(c)\n      if (c instanceof _Code) items.push(...c._items)\n      else items.push(c)\n      return items\n    }, [])\n  )\n\n  function replaceName(n: Name): SafeExpr {\n    const c = constants[n.str]\n    if (c === undefined || names[n.str] !== 1) return n\n    delete names[n.str]\n    return c\n  }\n\n  function canOptimize(e: SafeExpr): e is _Code {\n    return (\n      e instanceof _Code &&\n      e._items.some(\n        (c) => c instanceof Name && names[c.str] === 1 && constants[c.str] !== undefined\n      )\n    )\n  }\n}\n\nfunction subtractNames(names: UsedNames, from: UsedNames): void {\n  for (const n in from) names[n] = (names[n] || 0) - (from[n] || 0)\n}\n\nexport function not<T extends Code | SafeExpr>(x: T): T\nexport function not(x: Code | SafeExpr): Code | SafeExpr {\n  return typeof x == \"boolean\" || typeof x == \"number\" || x === null ? !x : _`!${par(x)}`\n}\n\nconst andCode = mappend(operators.AND)\n\n// boolean AND (&&) expression with the passed arguments\nexport function and(...args: Code[]): Code {\n  return args.reduce(andCode)\n}\n\nconst orCode = mappend(operators.OR)\n\n// boolean OR (||) expression with the passed arguments\nexport function or(...args: Code[]): Code {\n  return args.reduce(orCode)\n}\n\ntype MAppend = (x: Code, y: Code) => Code\n\nfunction mappend(op: Code): MAppend {\n  return (x, y) => (x === nil ? y : y === nil ? x : _`${par(x)} ${op} ${par(y)}`)\n}\n\nfunction par(x: Code): Code {\n  return x instanceof Name ? x : _`(${x})`\n}\n","import type {AnySchema, EvaluatedProperties, EvaluatedItems} from \"../types\"\nimport type {SchemaCxt, SchemaObjCxt} from \".\"\nimport {_, getProperty, Code, Name, CodeGen} from \"./codegen\"\nimport {_Code} from \"./codegen/code\"\nimport type {Rule, ValidationRules} from \"./rules\"\n\n// TODO refactor to use Set\nexport function toHash<T extends string = string>(arr: T[]): {[K in T]?: true} {\n  const hash: {[K in T]?: true} = {}\n  for (const item of arr) hash[item] = true\n  return hash\n}\n\nexport function alwaysValidSchema(it: SchemaCxt, schema: AnySchema): boolean | void {\n  if (typeof schema == \"boolean\") return schema\n  if (Object.keys(schema).length === 0) return true\n  checkUnknownRules(it, schema)\n  return !schemaHasRules(schema, it.self.RULES.all)\n}\n\nexport function checkUnknownRules(it: SchemaCxt, schema: AnySchema = it.schema): void {\n  const {opts, self} = it\n  if (!opts.strictSchema) return\n  if (typeof schema === \"boolean\") return\n  const rules = self.RULES.keywords\n  for (const key in schema) {\n    if (!rules[key]) checkStrictMode(it, `unknown keyword: \"${key}\"`)\n  }\n}\n\nexport function schemaHasRules(\n  schema: AnySchema,\n  rules: {[Key in string]?: boolean | Rule}\n): boolean {\n  if (typeof schema == \"boolean\") return !schema\n  for (const key in schema) if (rules[key]) return true\n  return false\n}\n\nexport function schemaHasRulesButRef(schema: AnySchema, RULES: ValidationRules): boolean {\n  if (typeof schema == \"boolean\") return !schema\n  for (const key in schema) if (key !== \"$ref\" && RULES.all[key]) return true\n  return false\n}\n\nexport function schemaRefOrVal(\n  {topSchemaRef, schemaPath}: SchemaObjCxt,\n  schema: unknown,\n  keyword: string,\n  $data?: string | false\n): Code | number | boolean {\n  if (!$data) {\n    if (typeof schema == \"number\" || typeof schema == \"boolean\") return schema\n    if (typeof schema == \"string\") return _`${schema}`\n  }\n  return _`${topSchemaRef}${schemaPath}${getProperty(keyword)}`\n}\n\nexport function unescapeFragment(str: string): string {\n  return unescapeJsonPointer(decodeURIComponent(str))\n}\n\nexport function escapeFragment(str: string | number): string {\n  return encodeURIComponent(escapeJsonPointer(str))\n}\n\nexport function escapeJsonPointer(str: string | number): string {\n  if (typeof str == \"number\") return `${str}`\n  return str.replace(/~/g, \"~0\").replace(/\\//g, \"~1\")\n}\n\nexport function unescapeJsonPointer(str: string): string {\n  return str.replace(/~1/g, \"/\").replace(/~0/g, \"~\")\n}\n\nexport function eachItem<T>(xs: T | T[], f: (x: T) => void): void {\n  if (Array.isArray(xs)) {\n    for (const x of xs) f(x)\n  } else {\n    f(xs)\n  }\n}\n\ntype SomeEvaluated = EvaluatedProperties | EvaluatedItems\n\ntype MergeEvaluatedFunc<T extends SomeEvaluated> = (\n  gen: CodeGen,\n  from: Name | T,\n  to: Name | Exclude<T, true> | undefined,\n  toName?: typeof Name\n) => Name | T\n\ninterface MakeMergeFuncArgs<T extends SomeEvaluated> {\n  mergeNames: (gen: CodeGen, from: Name, to: Name) => void\n  mergeToName: (gen: CodeGen, from: T, to: Name) => void\n  mergeValues: (from: T, to: Exclude<T, true>) => T\n  resultToName: (gen: CodeGen, res?: T) => Name\n}\n\nfunction makeMergeEvaluated<T extends SomeEvaluated>({\n  mergeNames,\n  mergeToName,\n  mergeValues,\n  resultToName,\n}: MakeMergeFuncArgs<T>): MergeEvaluatedFunc<T> {\n  return (gen, from, to, toName) => {\n    const res =\n      to === undefined\n        ? from\n        : to instanceof Name\n        ? (from instanceof Name ? mergeNames(gen, from, to) : mergeToName(gen, from, to), to)\n        : from instanceof Name\n        ? (mergeToName(gen, to, from), from)\n        : mergeValues(from, to)\n    return toName === Name && !(res instanceof Name) ? resultToName(gen, res) : res\n  }\n}\n\ninterface MergeEvaluated {\n  props: MergeEvaluatedFunc<EvaluatedProperties>\n  items: MergeEvaluatedFunc<EvaluatedItems>\n}\n\nexport const mergeEvaluated: MergeEvaluated = {\n  props: makeMergeEvaluated({\n    mergeNames: (gen, from, to) =>\n      gen.if(_`${to} !== true && ${from} !== undefined`, () => {\n        gen.if(\n          _`${from} === true`,\n          () => gen.assign(to, true),\n          () => gen.assign(to, _`${to} || {}`).code(_`Object.assign(${to}, ${from})`)\n        )\n      }),\n    mergeToName: (gen, from, to) =>\n      gen.if(_`${to} !== true`, () => {\n        if (from === true) {\n          gen.assign(to, true)\n        } else {\n          gen.assign(to, _`${to} || {}`)\n          setEvaluated(gen, to, from)\n        }\n      }),\n    mergeValues: (from, to) => (from === true ? true : {...from, ...to}),\n    resultToName: evaluatedPropsToName,\n  }),\n  items: makeMergeEvaluated({\n    mergeNames: (gen, from, to) =>\n      gen.if(_`${to} !== true && ${from} !== undefined`, () =>\n        gen.assign(to, _`${from} === true ? true : ${to} > ${from} ? ${to} : ${from}`)\n      ),\n    mergeToName: (gen, from, to) =>\n      gen.if(_`${to} !== true`, () =>\n        gen.assign(to, from === true ? true : _`${to} > ${from} ? ${to} : ${from}`)\n      ),\n    mergeValues: (from, to) => (from === true ? true : Math.max(from, to)),\n    resultToName: (gen, items) => gen.var(\"items\", items),\n  }),\n}\n\nexport function evaluatedPropsToName(gen: CodeGen, ps?: EvaluatedProperties): Name {\n  if (ps === true) return gen.var(\"props\", true)\n  const props = gen.var(\"props\", _`{}`)\n  if (ps !== undefined) setEvaluated(gen, props, ps)\n  return props\n}\n\nexport function setEvaluated(gen: CodeGen, props: Name, ps: {[K in string]?: true}): void {\n  Object.keys(ps).forEach((p) => gen.assign(_`${props}${getProperty(p)}`, true))\n}\n\nconst snippets: {[S in string]?: _Code} = {}\n\nexport function useFunc(gen: CodeGen, f: {code: string}): Name {\n  return gen.scopeValue(\"func\", {\n    ref: f,\n    code: snippets[f.code] || (snippets[f.code] = new _Code(f.code)),\n  })\n}\n\nexport enum Type {\n  Num,\n  Str,\n}\n\nexport function getErrorPath(\n  dataProp: Name | string | number,\n  dataPropType?: Type,\n  jsPropertySyntax?: boolean\n): Code | string {\n  // let path\n  if (dataProp instanceof Name) {\n    const isNumber = dataPropType === Type.Num\n    return jsPropertySyntax\n      ? isNumber\n        ? _`\"[\" + ${dataProp} + \"]\"`\n        : _`\"['\" + ${dataProp} + \"']\"`\n      : isNumber\n      ? _`\"/\" + ${dataProp}`\n      : _`\"/\" + ${dataProp}.replace(/~/g, \"~0\").replace(/\\\\//g, \"~1\")` // TODO maybe use global escapePointer\n  }\n  return jsPropertySyntax ? getProperty(dataProp).toString() : \"/\" + escapeJsonPointer(dataProp)\n}\n\nexport function checkStrictMode(\n  it: SchemaCxt,\n  msg: string,\n  mode: boolean | \"log\" = it.opts.strictSchema\n): void {\n  if (!mode) return\n  msg = `strict mode: ${msg}`\n  if (mode === true) throw new Error(msg)\n  it.self.logger.warn(msg)\n}\n","import {Name} from \"./codegen\"\n\nconst names = {\n  // validation function arguments\n  data: new Name(\"data\"), // data passed to validation function\n  // args passed from referencing schema\n  valCxt: new Name(\"valCxt\"), // validation/data context - should not be used directly, it is destructured to the names below\n  instancePath: new Name(\"instancePath\"),\n  parentData: new Name(\"parentData\"),\n  parentDataProperty: new Name(\"parentDataProperty\"),\n  rootData: new Name(\"rootData\"), // root data - same as the data passed to the first/top validation function\n  dynamicAnchors: new Name(\"dynamicAnchors\"), // used to support recursiveRef and dynamicRef\n  // function scoped variables\n  vErrors: new Name(\"vErrors\"), // null or array of validation errors\n  errors: new Name(\"errors\"), // counter of validation errors\n  this: new Name(\"this\"),\n  // \"globals\"\n  self: new Name(\"self\"),\n  scope: new Name(\"scope\"),\n  // JTD serialize/parse name for JSON string and position\n  json: new Name(\"json\"),\n  jsonPos: new Name(\"jsonPos\"),\n  jsonLen: new Name(\"jsonLen\"),\n  jsonPart: new Name(\"jsonPart\"),\n}\n\nexport default names\n","import type {KeywordErrorCxt, KeywordErrorDefinition} from \"../types\"\nimport type {SchemaCxt} from \"./index\"\nimport {CodeGen, _, str, strConcat, Code, Name} from \"./codegen\"\nimport {SafeExpr} from \"./codegen/code\"\nimport {getErrorPath, Type} from \"./util\"\nimport N from \"./names\"\n\nexport const keywordError: KeywordErrorDefinition = {\n  message: ({keyword}) => str`must pass \"${keyword}\" keyword validation`,\n}\n\nexport const keyword$DataError: KeywordErrorDefinition = {\n  message: ({keyword, schemaType}) =>\n    schemaType\n      ? str`\"${keyword}\" keyword must be ${schemaType} ($data)`\n      : str`\"${keyword}\" keyword is invalid ($data)`,\n}\n\nexport interface ErrorPaths {\n  instancePath?: Code\n  schemaPath?: string\n  parentSchema?: boolean\n}\n\nexport function reportError(\n  cxt: KeywordErrorCxt,\n  error: KeywordErrorDefinition = keywordError,\n  errorPaths?: ErrorPaths,\n  overrideAllErrors?: boolean\n): void {\n  const {it} = cxt\n  const {gen, compositeRule, allErrors} = it\n  const errObj = errorObjectCode(cxt, error, errorPaths)\n  if (overrideAllErrors ?? (compositeRule || allErrors)) {\n    addError(gen, errObj)\n  } else {\n    returnErrors(it, _`[${errObj}]`)\n  }\n}\n\nexport function reportExtraError(\n  cxt: KeywordErrorCxt,\n  error: KeywordErrorDefinition = keywordError,\n  errorPaths?: ErrorPaths\n): void {\n  const {it} = cxt\n  const {gen, compositeRule, allErrors} = it\n  const errObj = errorObjectCode(cxt, error, errorPaths)\n  addError(gen, errObj)\n  if (!(compositeRule || allErrors)) {\n    returnErrors(it, N.vErrors)\n  }\n}\n\nexport function resetErrorsCount(gen: CodeGen, errsCount: Name): void {\n  gen.assign(N.errors, errsCount)\n  gen.if(_`${N.vErrors} !== null`, () =>\n    gen.if(\n      errsCount,\n      () => gen.assign(_`${N.vErrors}.length`, errsCount),\n      () => gen.assign(N.vErrors, null)\n    )\n  )\n}\n\nexport function extendErrors({\n  gen,\n  keyword,\n  schemaValue,\n  data,\n  errsCount,\n  it,\n}: KeywordErrorCxt): void {\n  /* istanbul ignore if */\n  if (errsCount === undefined) throw new Error(\"ajv implementation error\")\n  const err = gen.name(\"err\")\n  gen.forRange(\"i\", errsCount, N.errors, (i) => {\n    gen.const(err, _`${N.vErrors}[${i}]`)\n    gen.if(_`${err}.instancePath === undefined`, () =>\n      gen.assign(_`${err}.instancePath`, strConcat(N.instancePath, it.errorPath))\n    )\n    gen.assign(_`${err}.schemaPath`, str`${it.errSchemaPath}/${keyword}`)\n    if (it.opts.verbose) {\n      gen.assign(_`${err}.schema`, schemaValue)\n      gen.assign(_`${err}.data`, data)\n    }\n  })\n}\n\nfunction addError(gen: CodeGen, errObj: Code): void {\n  const err = gen.const(\"err\", errObj)\n  gen.if(\n    _`${N.vErrors} === null`,\n    () => gen.assign(N.vErrors, _`[${err}]`),\n    _`${N.vErrors}.push(${err})`\n  )\n  gen.code(_`${N.errors}++`)\n}\n\nfunction returnErrors(it: SchemaCxt, errs: Code): void {\n  const {gen, validateName, schemaEnv} = it\n  if (schemaEnv.$async) {\n    gen.throw(_`new ${it.ValidationError as Name}(${errs})`)\n  } else {\n    gen.assign(_`${validateName}.errors`, errs)\n    gen.return(false)\n  }\n}\n\nconst E = {\n  keyword: new Name(\"keyword\"),\n  schemaPath: new Name(\"schemaPath\"), // also used in JTD errors\n  params: new Name(\"params\"),\n  propertyName: new Name(\"propertyName\"),\n  message: new Name(\"message\"),\n  schema: new Name(\"schema\"),\n  parentSchema: new Name(\"parentSchema\"),\n}\n\nfunction errorObjectCode(\n  cxt: KeywordErrorCxt,\n  error: KeywordErrorDefinition,\n  errorPaths?: ErrorPaths\n): Code {\n  const {createErrors} = cxt.it\n  if (createErrors === false) return _`{}`\n  return errorObject(cxt, error, errorPaths)\n}\n\nfunction errorObject(\n  cxt: KeywordErrorCxt,\n  error: KeywordErrorDefinition,\n  errorPaths: ErrorPaths = {}\n): Code {\n  const {gen, it} = cxt\n  const keyValues: [Name, SafeExpr | string][] = [\n    errorInstancePath(it, errorPaths),\n    errorSchemaPath(cxt, errorPaths),\n  ]\n  extraErrorProps(cxt, error, keyValues)\n  return gen.object(...keyValues)\n}\n\nfunction errorInstancePath({errorPath}: SchemaCxt, {instancePath}: ErrorPaths): [Name, Code] {\n  const instPath = instancePath\n    ? str`${errorPath}${getErrorPath(instancePath, Type.Str)}`\n    : errorPath\n  return [N.instancePath, strConcat(N.instancePath, instPath)]\n}\n\nfunction errorSchemaPath(\n  {keyword, it: {errSchemaPath}}: KeywordErrorCxt,\n  {schemaPath, parentSchema}: ErrorPaths\n): [Name, string | Code] {\n  let schPath = parentSchema ? errSchemaPath : str`${errSchemaPath}/${keyword}`\n  if (schemaPath) {\n    schPath = str`${schPath}${getErrorPath(schemaPath, Type.Str)}`\n  }\n  return [E.schemaPath, schPath]\n}\n\nfunction extraErrorProps(\n  cxt: KeywordErrorCxt,\n  {params, message}: KeywordErrorDefinition,\n  keyValues: [Name, SafeExpr | string][]\n): void {\n  const {keyword, data, schemaValue, it} = cxt\n  const {opts, propertyName, topSchemaRef, schemaPath} = it\n  keyValues.push(\n    [E.keyword, keyword],\n    [E.params, typeof params == \"function\" ? params(cxt) : params || _`{}`]\n  )\n  if (opts.messages) {\n    keyValues.push([E.message, typeof message == \"function\" ? message(cxt) : message])\n  }\n  if (opts.verbose) {\n    keyValues.push(\n      [E.schema, schemaValue],\n      [E.parentSchema, _`${topSchemaRef}${schemaPath}`],\n      [N.data, data]\n    )\n  }\n  if (propertyName) keyValues.push([E.propertyName, propertyName])\n}\n","import type {KeywordErrorDefinition, KeywordErrorCxt} from \"../../types\"\nimport type {SchemaCxt} from \"..\"\nimport {reportError} from \"../errors\"\nimport {_, Name} from \"../codegen\"\nimport N from \"../names\"\n\nconst boolError: KeywordErrorDefinition = {\n  message: \"boolean schema is false\",\n}\n\nexport function topBoolOrEmptySchema(it: SchemaCxt): void {\n  const {gen, schema, validateName} = it\n  if (schema === false) {\n    falseSchemaError(it, false)\n  } else if (typeof schema == \"object\" && schema.$async === true) {\n    gen.return(N.data)\n  } else {\n    gen.assign(_`${validateName}.errors`, null)\n    gen.return(true)\n  }\n}\n\nexport function boolOrEmptySchema(it: SchemaCxt, valid: Name): void {\n  const {gen, schema} = it\n  if (schema === false) {\n    gen.var(valid, false) // TODO var\n    falseSchemaError(it)\n  } else {\n    gen.var(valid, true) // TODO var\n  }\n}\n\nfunction falseSchemaError(it: SchemaCxt, overrideAllErrors?: boolean): void {\n  const {gen, data} = it\n  // TODO maybe some other interface should be used for non-keyword validation errors...\n  const cxt: KeywordErrorCxt = {\n    gen,\n    keyword: \"false schema\",\n    data,\n    schema: false,\n    schemaCode: false,\n    schemaValue: false,\n    params: {},\n    it,\n  }\n  reportError(cxt, boolError, undefined, overrideAllErrors)\n}\n","import type {AddedKeywordDefinition} from \"../types\"\n\nconst _jsonTypes = [\"string\", \"number\", \"integer\", \"boolean\", \"null\", \"object\", \"array\"] as const\n\nexport type JSONType = (typeof _jsonTypes)[number]\n\nconst jsonTypes: Set<string> = new Set(_jsonTypes)\n\nexport function isJSONType(x: unknown): x is JSONType {\n  return typeof x == \"string\" && jsonTypes.has(x)\n}\n\ntype ValidationTypes = {\n  [K in JSONType]: boolean | RuleGroup | undefined\n}\n\nexport interface ValidationRules {\n  rules: RuleGroup[]\n  post: RuleGroup\n  all: {[Key in string]?: boolean | Rule} // rules that have to be validated\n  keywords: {[Key in string]?: boolean} // all known keywords (superset of \"all\")\n  types: ValidationTypes\n}\n\nexport interface RuleGroup {\n  type?: JSONType\n  rules: Rule[]\n}\n\n// This interface wraps KeywordDefinition because definition can have multiple keywords\nexport interface Rule {\n  keyword: string\n  definition: AddedKeywordDefinition\n}\n\nexport function getRules(): ValidationRules {\n  const groups: Record<\"number\" | \"string\" | \"array\" | \"object\", RuleGroup> = {\n    number: {type: \"number\", rules: []},\n    string: {type: \"string\", rules: []},\n    array: {type: \"array\", rules: []},\n    object: {type: \"object\", rules: []},\n  }\n  return {\n    types: {...groups, integer: true, boolean: true, null: true},\n    rules: [{rules: []}, groups.number, groups.string, groups.array, groups.object],\n    post: {rules: []},\n    all: {},\n    keywords: {},\n  }\n}\n","import type {AnySchemaObject} from \"../../types\"\nimport type {SchemaObjCxt} from \"..\"\nimport type {JSONType, RuleGroup, Rule} from \"../rules\"\n\nexport function schemaHasRulesForType(\n  {schema, self}: SchemaObjCxt,\n  type: JSONType\n): boolean | undefined {\n  const group = self.RULES.types[type]\n  return group && group !== true && shouldUseGroup(schema, group)\n}\n\nexport function shouldUseGroup(schema: AnySchemaObject, group: RuleGroup): boolean {\n  return group.rules.some((rule) => shouldUseRule(schema, rule))\n}\n\nexport function shouldUseRule(schema: AnySchemaObject, rule: Rule): boolean | undefined {\n  return (\n    schema[rule.keyword] !== undefined ||\n    rule.definition.implements?.some((kwd) => schema[kwd] !== undefined)\n  )\n}\n","import type {\n  KeywordErrorDefinition,\n  KeywordErrorCxt,\n  ErrorObject,\n  AnySchemaObject,\n} from \"../../types\"\nimport type {SchemaObjCxt} from \"..\"\nimport {isJSONType, JSONType} from \"../rules\"\nimport {schemaHasRulesForType} from \"./applicability\"\nimport {reportError} from \"../errors\"\nimport {_, nil, and, not, operators, Code, Name} from \"../codegen\"\nimport {toHash, schemaRefOrVal} from \"../util\"\n\nexport enum DataType {\n  Correct,\n  Wrong,\n}\n\nexport function getSchemaTypes(schema: AnySchemaObject): JSONType[] {\n  const types = getJSONTypes(schema.type)\n  const hasNull = types.includes(\"null\")\n  if (hasNull) {\n    if (schema.nullable === false) throw new Error(\"type: null contradicts nullable: false\")\n  } else {\n    if (!types.length && schema.nullable !== undefined) {\n      throw new Error('\"nullable\" cannot be used without \"type\"')\n    }\n    if (schema.nullable === true) types.push(\"null\")\n  }\n  return types\n}\n\n// eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents\nexport function getJSONTypes(ts: unknown | unknown[]): JSONType[] {\n  const types: unknown[] = Array.isArray(ts) ? ts : ts ? [ts] : []\n  if (types.every(isJSONType)) return types\n  throw new Error(\"type must be JSONType or JSONType[]: \" + types.join(\",\"))\n}\n\nexport function coerceAndCheckDataType(it: SchemaObjCxt, types: JSONType[]): boolean {\n  const {gen, data, opts} = it\n  const coerceTo = coerceToTypes(types, opts.coerceTypes)\n  const checkTypes =\n    types.length > 0 &&\n    !(coerceTo.length === 0 && types.length === 1 && schemaHasRulesForType(it, types[0]))\n  if (checkTypes) {\n    const wrongType = checkDataTypes(types, data, opts.strictNumbers, DataType.Wrong)\n    gen.if(wrongType, () => {\n      if (coerceTo.length) coerceData(it, types, coerceTo)\n      else reportTypeError(it)\n    })\n  }\n  return checkTypes\n}\n\nconst COERCIBLE: Set<JSONType> = new Set([\"string\", \"number\", \"integer\", \"boolean\", \"null\"])\nfunction coerceToTypes(types: JSONType[], coerceTypes?: boolean | \"array\"): JSONType[] {\n  return coerceTypes\n    ? types.filter((t) => COERCIBLE.has(t) || (coerceTypes === \"array\" && t === \"array\"))\n    : []\n}\n\nfunction coerceData(it: SchemaObjCxt, types: JSONType[], coerceTo: JSONType[]): void {\n  const {gen, data, opts} = it\n  const dataType = gen.let(\"dataType\", _`typeof ${data}`)\n  const coerced = gen.let(\"coerced\", _`undefined`)\n  if (opts.coerceTypes === \"array\") {\n    gen.if(_`${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`, () =>\n      gen\n        .assign(data, _`${data}[0]`)\n        .assign(dataType, _`typeof ${data}`)\n        .if(checkDataTypes(types, data, opts.strictNumbers), () => gen.assign(coerced, data))\n    )\n  }\n  gen.if(_`${coerced} !== undefined`)\n  for (const t of coerceTo) {\n    if (COERCIBLE.has(t) || (t === \"array\" && opts.coerceTypes === \"array\")) {\n      coerceSpecificType(t)\n    }\n  }\n  gen.else()\n  reportTypeError(it)\n  gen.endIf()\n\n  gen.if(_`${coerced} !== undefined`, () => {\n    gen.assign(data, coerced)\n    assignParentData(it, coerced)\n  })\n\n  function coerceSpecificType(t: string): void {\n    switch (t) {\n      case \"string\":\n        gen\n          .elseIf(_`${dataType} == \"number\" || ${dataType} == \"boolean\"`)\n          .assign(coerced, _`\"\" + ${data}`)\n          .elseIf(_`${data} === null`)\n          .assign(coerced, _`\"\"`)\n        return\n      case \"number\":\n        gen\n          .elseIf(\n            _`${dataType} == \"boolean\" || ${data} === null\n              || (${dataType} == \"string\" && ${data} && ${data} == +${data})`\n          )\n          .assign(coerced, _`+${data}`)\n        return\n      case \"integer\":\n        gen\n          .elseIf(\n            _`${dataType} === \"boolean\" || ${data} === null\n              || (${dataType} === \"string\" && ${data} && ${data} == +${data} && !(${data} % 1))`\n          )\n          .assign(coerced, _`+${data}`)\n        return\n      case \"boolean\":\n        gen\n          .elseIf(_`${data} === \"false\" || ${data} === 0 || ${data} === null`)\n          .assign(coerced, false)\n          .elseIf(_`${data} === \"true\" || ${data} === 1`)\n          .assign(coerced, true)\n        return\n      case \"null\":\n        gen.elseIf(_`${data} === \"\" || ${data} === 0 || ${data} === false`)\n        gen.assign(coerced, null)\n        return\n\n      case \"array\":\n        gen\n          .elseIf(\n            _`${dataType} === \"string\" || ${dataType} === \"number\"\n              || ${dataType} === \"boolean\" || ${data} === null`\n          )\n          .assign(coerced, _`[${data}]`)\n    }\n  }\n}\n\nfunction assignParentData({gen, parentData, parentDataProperty}: SchemaObjCxt, expr: Name): void {\n  // TODO use gen.property\n  gen.if(_`${parentData} !== undefined`, () =>\n    gen.assign(_`${parentData}[${parentDataProperty}]`, expr)\n  )\n}\n\nexport function checkDataType(\n  dataType: JSONType,\n  data: Name,\n  strictNums?: boolean | \"log\",\n  correct = DataType.Correct\n): Code {\n  const EQ = correct === DataType.Correct ? operators.EQ : operators.NEQ\n  let cond: Code\n  switch (dataType) {\n    case \"null\":\n      return _`${data} ${EQ} null`\n    case \"array\":\n      cond = _`Array.isArray(${data})`\n      break\n    case \"object\":\n      cond = _`${data} && typeof ${data} == \"object\" && !Array.isArray(${data})`\n      break\n    case \"integer\":\n      cond = numCond(_`!(${data} % 1) && !isNaN(${data})`)\n      break\n    case \"number\":\n      cond = numCond()\n      break\n    default:\n      return _`typeof ${data} ${EQ} ${dataType}`\n  }\n  return correct === DataType.Correct ? cond : not(cond)\n\n  function numCond(_cond: Code = nil): Code {\n    return and(_`typeof ${data} == \"number\"`, _cond, strictNums ? _`isFinite(${data})` : nil)\n  }\n}\n\nexport function checkDataTypes(\n  dataTypes: JSONType[],\n  data: Name,\n  strictNums?: boolean | \"log\",\n  correct?: DataType\n): Code {\n  if (dataTypes.length === 1) {\n    return checkDataType(dataTypes[0], data, strictNums, correct)\n  }\n  let cond: Code\n  const types = toHash(dataTypes)\n  if (types.array && types.object) {\n    const notObj = _`typeof ${data} != \"object\"`\n    cond = types.null ? notObj : _`!${data} || ${notObj}`\n    delete types.null\n    delete types.array\n    delete types.object\n  } else {\n    cond = nil\n  }\n  if (types.number) delete types.integer\n  for (const t in types) cond = and(cond, checkDataType(t as JSONType, data, strictNums, correct))\n  return cond\n}\n\nexport type TypeError = ErrorObject<\"type\", {type: string}>\n\nconst typeError: KeywordErrorDefinition = {\n  message: ({schema}) => `must be ${schema}`,\n  params: ({schema, schemaValue}) =>\n    typeof schema == \"string\" ? _`{type: ${schema}}` : _`{type: ${schemaValue}}`,\n}\n\nexport function reportTypeError(it: SchemaObjCxt): void {\n  const cxt = getTypeErrorContext(it)\n  reportError(cxt, typeError)\n}\n\nfunction getTypeErrorContext(it: SchemaObjCxt): KeywordErrorCxt {\n  const {gen, data, schema} = it\n  const schemaCode = schemaRefOrVal(it, schema, \"type\")\n  return {\n    gen,\n    keyword: \"type\",\n    data,\n    schema: schema.type,\n    schemaCode,\n    schemaValue: schemaCode,\n    parentSchema: schema,\n    params: {},\n    it,\n  }\n}\n","import type {SchemaObjCxt} from \"..\"\nimport {_, getProperty, stringify} from \"../codegen\"\nimport {checkStrictMode} from \"../util\"\n\nexport function assignDefaults(it: SchemaObjCxt, ty?: string): void {\n  const {properties, items} = it.schema\n  if (ty === \"object\" && properties) {\n    for (const key in properties) {\n      assignDefault(it, key, properties[key].default)\n    }\n  } else if (ty === \"array\" && Array.isArray(items)) {\n    items.forEach((sch, i: number) => assignDefault(it, i, sch.default))\n  }\n}\n\nfunction assignDefault(it: SchemaObjCxt, prop: string | number, defaultValue: unknown): void {\n  const {gen, compositeRule, data, opts} = it\n  if (defaultValue === undefined) return\n  const childData = _`${data}${getProperty(prop)}`\n  if (compositeRule) {\n    checkStrictMode(it, `default is ignored for: ${childData}`)\n    return\n  }\n\n  let condition = _`${childData} === undefined`\n  if (opts.useDefaults === \"empty\") {\n    condition = _`${condition} || ${childData} === null || ${childData} === \"\"`\n  }\n  // `${childData} === undefined` +\n  // (opts.useDefaults === \"empty\" ? ` || ${childData} === null || ${childData} === \"\"` : \"\")\n  gen.if(condition, _`${childData} = ${stringify(defaultValue)}`)\n}\n","import type {AnySchema, SchemaMap} from \"../types\"\nimport type {SchemaCxt} from \"../compile\"\nimport type {KeywordCxt} from \"../compile/validate\"\nimport {CodeGen, _, and, or, not, nil, strConcat, getProperty, Code, Name} from \"../compile/codegen\"\nimport {alwaysValidSchema, Type} from \"../compile/util\"\nimport N from \"../compile/names\"\nimport {useFunc} from \"../compile/util\"\nexport function checkReportMissingProp(cxt: KeywordCxt, prop: string): void {\n  const {gen, data, it} = cxt\n  gen.if(noPropertyInData(gen, data, prop, it.opts.ownProperties), () => {\n    cxt.setParams({missingProperty: _`${prop}`}, true)\n    cxt.error()\n  })\n}\n\nexport function checkMissingProp(\n  {gen, data, it: {opts}}: KeywordCxt,\n  properties: string[],\n  missing: Name\n): Code {\n  return or(\n    ...properties.map((prop) =>\n      and(noPropertyInData(gen, data, prop, opts.ownProperties), _`${missing} = ${prop}`)\n    )\n  )\n}\n\nexport function reportMissingProp(cxt: KeywordCxt, missing: Name): void {\n  cxt.setParams({missingProperty: missing}, true)\n  cxt.error()\n}\n\nexport function hasPropFunc(gen: CodeGen): Name {\n  return gen.scopeValue(\"func\", {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    ref: Object.prototype.hasOwnProperty,\n    code: _`Object.prototype.hasOwnProperty`,\n  })\n}\n\nexport function isOwnProperty(gen: CodeGen, data: Name, property: Name | string): Code {\n  return _`${hasPropFunc(gen)}.call(${data}, ${property})`\n}\n\nexport function propertyInData(\n  gen: CodeGen,\n  data: Name,\n  property: Name | string,\n  ownProperties?: boolean\n): Code {\n  const cond = _`${data}${getProperty(property)} !== undefined`\n  return ownProperties ? _`${cond} && ${isOwnProperty(gen, data, property)}` : cond\n}\n\nexport function noPropertyInData(\n  gen: CodeGen,\n  data: Name,\n  property: Name | string,\n  ownProperties?: boolean\n): Code {\n  const cond = _`${data}${getProperty(property)} === undefined`\n  return ownProperties ? or(cond, not(isOwnProperty(gen, data, property))) : cond\n}\n\nexport function allSchemaProperties(schemaMap?: SchemaMap): string[] {\n  return schemaMap ? Object.keys(schemaMap).filter((p) => p !== \"__proto__\") : []\n}\n\nexport function schemaProperties(it: SchemaCxt, schemaMap: SchemaMap): string[] {\n  return allSchemaProperties(schemaMap).filter(\n    (p) => !alwaysValidSchema(it, schemaMap[p] as AnySchema)\n  )\n}\n\nexport function callValidateCode(\n  {schemaCode, data, it: {gen, topSchemaRef, schemaPath, errorPath}, it}: KeywordCxt,\n  func: Code,\n  context: Code,\n  passSchema?: boolean\n): Code {\n  const dataAndSchema = passSchema ? _`${schemaCode}, ${data}, ${topSchemaRef}${schemaPath}` : data\n  const valCxt: [Name, Code | number][] = [\n    [N.instancePath, strConcat(N.instancePath, errorPath)],\n    [N.parentData, it.parentData],\n    [N.parentDataProperty, it.parentDataProperty],\n    [N.rootData, N.rootData],\n  ]\n  if (it.opts.dynamicRef) valCxt.push([N.dynamicAnchors, N.dynamicAnchors])\n  const args = _`${dataAndSchema}, ${gen.object(...valCxt)}`\n  return context !== nil ? _`${func}.call(${context}, ${args})` : _`${func}(${args})`\n}\n\nconst newRegExp = _`new RegExp`\n\nexport function usePattern({gen, it: {opts}}: KeywordCxt, pattern: string): Name {\n  const u = opts.unicodeRegExp ? \"u\" : \"\"\n  const {regExp} = opts.code\n  const rx = regExp(pattern, u)\n\n  return gen.scopeValue(\"pattern\", {\n    key: rx.toString(),\n    ref: rx,\n    code: _`${regExp.code === \"new RegExp\" ? newRegExp : useFunc(gen, regExp)}(${pattern}, ${u})`,\n  })\n}\n\nexport function validateArray(cxt: KeywordCxt): Name {\n  const {gen, data, keyword, it} = cxt\n  const valid = gen.name(\"valid\")\n  if (it.allErrors) {\n    const validArr = gen.let(\"valid\", true)\n    validateItems(() => gen.assign(validArr, false))\n    return validArr\n  }\n  gen.var(valid, true)\n  validateItems(() => gen.break())\n  return valid\n\n  function validateItems(notValid: () => void): void {\n    const len = gen.const(\"len\", _`${data}.length`)\n    gen.forRange(\"i\", 0, len, (i) => {\n      cxt.subschema(\n        {\n          keyword,\n          dataProp: i,\n          dataPropType: Type.Num,\n        },\n        valid\n      )\n      gen.if(not(valid), notValid)\n    })\n  }\n}\n\nexport function validateUnion(cxt: KeywordCxt): void {\n  const {gen, schema, keyword, it} = cxt\n  /* istanbul ignore if */\n  if (!Array.isArray(schema)) throw new Error(\"ajv implementation error\")\n  const alwaysValid = schema.some((sch: AnySchema) => alwaysValidSchema(it, sch))\n  if (alwaysValid && !it.opts.unevaluated) return\n\n  const valid = gen.let(\"valid\", false)\n  const schValid = gen.name(\"_valid\")\n\n  gen.block(() =>\n    schema.forEach((_sch: AnySchema, i: number) => {\n      const schCxt = cxt.subschema(\n        {\n          keyword,\n          schemaProp: i,\n          compositeRule: true,\n        },\n        schValid\n      )\n      gen.assign(valid, _`${valid} || ${schValid}`)\n      const merged = cxt.mergeValidEvaluated(schCxt, schValid)\n      // can short-circuit if `unevaluatedProperties/Items` not supported (opts.unevaluated !== true)\n      // or if all properties and items were evaluated (it.props === true && it.items === true)\n      if (!merged) gen.if(not(valid))\n    })\n  )\n\n  cxt.result(\n    valid,\n    () => cxt.reset(),\n    () => cxt.error(true)\n  )\n}\n","import type {KeywordCxt} from \".\"\nimport type {\n  AnySchema,\n  SchemaValidateFunction,\n  AnyValidateFunction,\n  AddedKeywordDefinition,\n  MacroKeywordDefinition,\n  FuncKeywordDefinition,\n} from \"../../types\"\nimport type {SchemaObjCxt} from \"..\"\nimport {_, nil, not, stringify, Code, Name, CodeGen} from \"../codegen\"\nimport N from \"../names\"\nimport type {JSONType} from \"../rules\"\nimport {callValidateCode} from \"../../vocabularies/code\"\nimport {extendErrors} from \"../errors\"\n\ntype KeywordCompilationResult = AnySchema | SchemaValidateFunction | AnyValidateFunction\n\nexport function macroKeywordCode(cxt: KeywordCxt, def: MacroKeywordDefinition): void {\n  const {gen, keyword, schema, parentSchema, it} = cxt\n  const macroSchema = def.macro.call(it.self, schema, parentSchema, it)\n  const schemaRef = useKeyword(gen, keyword, macroSchema)\n  if (it.opts.validateSchema !== false) it.self.validateSchema(macroSchema, true)\n\n  const valid = gen.name(\"valid\")\n  cxt.subschema(\n    {\n      schema: macroSchema,\n      schemaPath: nil,\n      errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n      topSchemaRef: schemaRef,\n      compositeRule: true,\n    },\n    valid\n  )\n  cxt.pass(valid, () => cxt.error(true))\n}\n\nexport function funcKeywordCode(cxt: KeywordCxt, def: FuncKeywordDefinition): void {\n  const {gen, keyword, schema, parentSchema, $data, it} = cxt\n  checkAsyncKeyword(it, def)\n  const validate =\n    !$data && def.compile ? def.compile.call(it.self, schema, parentSchema, it) : def.validate\n  const validateRef = useKeyword(gen, keyword, validate)\n  const valid = gen.let(\"valid\")\n  cxt.block$data(valid, validateKeyword)\n  cxt.ok(def.valid ?? valid)\n\n  function validateKeyword(): void {\n    if (def.errors === false) {\n      assignValid()\n      if (def.modifying) modifyData(cxt)\n      reportErrs(() => cxt.error())\n    } else {\n      const ruleErrs = def.async ? validateAsync() : validateSync()\n      if (def.modifying) modifyData(cxt)\n      reportErrs(() => addErrs(cxt, ruleErrs))\n    }\n  }\n\n  function validateAsync(): Name {\n    const ruleErrs = gen.let(\"ruleErrs\", null)\n    gen.try(\n      () => assignValid(_`await `),\n      (e) =>\n        gen.assign(valid, false).if(\n          _`${e} instanceof ${it.ValidationError as Name}`,\n          () => gen.assign(ruleErrs, _`${e}.errors`),\n          () => gen.throw(e)\n        )\n    )\n    return ruleErrs\n  }\n\n  function validateSync(): Code {\n    const validateErrs = _`${validateRef}.errors`\n    gen.assign(validateErrs, null)\n    assignValid(nil)\n    return validateErrs\n  }\n\n  function assignValid(_await: Code = def.async ? _`await ` : nil): void {\n    const passCxt = it.opts.passContext ? N.this : N.self\n    const passSchema = !((\"compile\" in def && !$data) || def.schema === false)\n    gen.assign(\n      valid,\n      _`${_await}${callValidateCode(cxt, validateRef, passCxt, passSchema)}`,\n      def.modifying\n    )\n  }\n\n  function reportErrs(errors: () => void): void {\n    gen.if(not(def.valid ?? valid), errors)\n  }\n}\n\nfunction modifyData(cxt: KeywordCxt): void {\n  const {gen, data, it} = cxt\n  gen.if(it.parentData, () => gen.assign(data, _`${it.parentData}[${it.parentDataProperty}]`))\n}\n\nfunction addErrs(cxt: KeywordCxt, errs: Code): void {\n  const {gen} = cxt\n  gen.if(\n    _`Array.isArray(${errs})`,\n    () => {\n      gen\n        .assign(N.vErrors, _`${N.vErrors} === null ? ${errs} : ${N.vErrors}.concat(${errs})`)\n        .assign(N.errors, _`${N.vErrors}.length`)\n      extendErrors(cxt)\n    },\n    () => cxt.error()\n  )\n}\n\nfunction checkAsyncKeyword({schemaEnv}: SchemaObjCxt, def: FuncKeywordDefinition): void {\n  if (def.async && !schemaEnv.$async) throw new Error(\"async keyword in sync schema\")\n}\n\nfunction useKeyword(gen: CodeGen, keyword: string, result?: KeywordCompilationResult): Name {\n  if (result === undefined) throw new Error(`keyword \"${keyword}\" failed to compile`)\n  return gen.scopeValue(\n    \"keyword\",\n    typeof result == \"function\" ? {ref: result} : {ref: result, code: stringify(result)}\n  )\n}\n\nexport function validSchemaType(\n  schema: unknown,\n  schemaType: JSONType[],\n  allowUndefined = false\n): boolean {\n  // TODO add tests\n  return (\n    !schemaType.length ||\n    schemaType.some((st) =>\n      st === \"array\"\n        ? Array.isArray(schema)\n        : st === \"object\"\n        ? schema && typeof schema == \"object\" && !Array.isArray(schema)\n        : typeof schema == st || (allowUndefined && typeof schema == \"undefined\")\n    )\n  )\n}\n\nexport function validateKeywordUsage(\n  {schema, opts, self, errSchemaPath}: SchemaObjCxt,\n  def: AddedKeywordDefinition,\n  keyword: string\n): void {\n  /* istanbul ignore if */\n  if (Array.isArray(def.keyword) ? !def.keyword.includes(keyword) : def.keyword !== keyword) {\n    throw new Error(\"ajv implementation error\")\n  }\n\n  const deps = def.dependencies\n  if (deps?.some((kwd) => !Object.prototype.hasOwnProperty.call(schema, kwd))) {\n    throw new Error(`parent schema must have dependencies of ${keyword}: ${deps.join(\",\")}`)\n  }\n\n  if (def.validateSchema) {\n    const valid = def.validateSchema(schema[keyword])\n    if (!valid) {\n      const msg =\n        `keyword \"${keyword}\" value is invalid at path \"${errSchemaPath}\": ` +\n        self.errorsText(def.validateSchema.errors)\n      if (opts.validateSchema === \"log\") self.logger.error(msg)\n      else throw new Error(msg)\n    }\n  }\n}\n","import type {AnySchema} from \"../../types\"\nimport type {SchemaObjCxt} from \"..\"\nimport {_, str, getProperty, Code, Name} from \"../codegen\"\nimport {escapeFragment, getErrorPath, Type} from \"../util\"\nimport type {JSONType} from \"../rules\"\n\nexport interface SubschemaContext {\n  // TODO use Optional? align with SchemCxt property types\n  schema: AnySchema\n  schemaPath: Code\n  errSchemaPath: string\n  topSchemaRef?: Code\n  errorPath?: Code\n  dataLevel?: number\n  dataTypes?: JSONType[]\n  data?: Name\n  parentData?: Name\n  parentDataProperty?: Code | number\n  dataNames?: Name[]\n  dataPathArr?: (Code | number)[]\n  propertyName?: Name\n  jtdDiscriminator?: string\n  jtdMetadata?: boolean\n  compositeRule?: true\n  createErrors?: boolean\n  allErrors?: boolean\n}\n\nexport type SubschemaArgs = Partial<{\n  keyword: string\n  schemaProp: string | number\n  schema: AnySchema\n  schemaPath: Code\n  errSchemaPath: string\n  topSchemaRef: Code\n  data: Name | Code\n  dataProp: Code | string | number\n  dataTypes: JSONType[]\n  definedProperties: Set<string>\n  propertyName: Name\n  dataPropType: Type\n  jtdDiscriminator: string\n  jtdMetadata: boolean\n  compositeRule: true\n  createErrors: boolean\n  allErrors: boolean\n}>\n\nexport function getSubschema(\n  it: SchemaObjCxt,\n  {keyword, schemaProp, schema, schemaPath, errSchemaPath, topSchemaRef}: SubschemaArgs\n): SubschemaContext {\n  if (keyword !== undefined && schema !== undefined) {\n    throw new Error('both \"keyword\" and \"schema\" passed, only one allowed')\n  }\n\n  if (keyword !== undefined) {\n    const sch = it.schema[keyword]\n    return schemaProp === undefined\n      ? {\n          schema: sch,\n          schemaPath: _`${it.schemaPath}${getProperty(keyword)}`,\n          errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n        }\n      : {\n          schema: sch[schemaProp],\n          schemaPath: _`${it.schemaPath}${getProperty(keyword)}${getProperty(schemaProp)}`,\n          errSchemaPath: `${it.errSchemaPath}/${keyword}/${escapeFragment(schemaProp)}`,\n        }\n  }\n\n  if (schema !== undefined) {\n    if (schemaPath === undefined || errSchemaPath === undefined || topSchemaRef === undefined) {\n      throw new Error('\"schemaPath\", \"errSchemaPath\" and \"topSchemaRef\" are required with \"schema\"')\n    }\n    return {\n      schema,\n      schemaPath,\n      topSchemaRef,\n      errSchemaPath,\n    }\n  }\n\n  throw new Error('either \"keyword\" or \"schema\" must be passed')\n}\n\nexport function extendSubschemaData(\n  subschema: SubschemaContext,\n  it: SchemaObjCxt,\n  {dataProp, dataPropType: dpType, data, dataTypes, propertyName}: SubschemaArgs\n): void {\n  if (data !== undefined && dataProp !== undefined) {\n    throw new Error('both \"data\" and \"dataProp\" passed, only one allowed')\n  }\n\n  const {gen} = it\n\n  if (dataProp !== undefined) {\n    const {errorPath, dataPathArr, opts} = it\n    const nextData = gen.let(\"data\", _`${it.data}${getProperty(dataProp)}`, true)\n    dataContextProps(nextData)\n    subschema.errorPath = str`${errorPath}${getErrorPath(dataProp, dpType, opts.jsPropertySyntax)}`\n    subschema.parentDataProperty = _`${dataProp}`\n    subschema.dataPathArr = [...dataPathArr, subschema.parentDataProperty]\n  }\n\n  if (data !== undefined) {\n    const nextData = data instanceof Name ? data : gen.let(\"data\", data, true) // replaceable if used once?\n    dataContextProps(nextData)\n    if (propertyName !== undefined) subschema.propertyName = propertyName\n    // TODO something is possibly wrong here with not changing parentDataProperty and not appending dataPathArr\n  }\n\n  if (dataTypes) subschema.dataTypes = dataTypes\n\n  function dataContextProps(_nextData: Name): void {\n    subschema.data = _nextData\n    subschema.dataLevel = it.dataLevel + 1\n    subschema.dataTypes = []\n    it.definedProperties = new Set<string>()\n    subschema.parentData = it.data\n    subschema.dataNames = [...it.dataNames, _nextData]\n  }\n}\n\nexport function extendSubschemaMode(\n  subschema: SubschemaContext,\n  {jtdDiscriminator, jtdMetadata, compositeRule, createErrors, allErrors}: SubschemaArgs\n): void {\n  if (compositeRule !== undefined) subschema.compositeRule = compositeRule\n  if (createErrors !== undefined) subschema.createErrors = createErrors\n  if (allErrors !== undefined) subschema.allErrors = allErrors\n  subschema.jtdDiscriminator = jtdDiscriminator // not inherited\n  subschema.jtdMetadata = jtdMetadata // not inherited\n}\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nvar traverse = module.exports = function (schema, opts, cb) {\n  // Legacy support for v0.3.1 and earlier.\n  if (typeof opts == 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n  cb = opts.cb || cb;\n  var pre = (typeof cb == 'function') ? cb : cb.pre || function() {};\n  var post = cb.post || function() {};\n\n  _traverse(opts, pre, post, schema, '', schema);\n};\n\n\ntraverse.keywords = {\n  additionalItems: true,\n  items: true,\n  contains: true,\n  additionalProperties: true,\n  propertyNames: true,\n  not: true,\n  if: true,\n  then: true,\n  else: true\n};\n\ntraverse.arrayKeywords = {\n  items: true,\n  allOf: true,\n  anyOf: true,\n  oneOf: true\n};\n\ntraverse.propsKeywords = {\n  $defs: true,\n  definitions: true,\n  properties: true,\n  patternProperties: true,\n  dependencies: true\n};\n\ntraverse.skipKeywords = {\n  default: true,\n  enum: true,\n  const: true,\n  required: true,\n  maximum: true,\n  minimum: true,\n  exclusiveMaximum: true,\n  exclusiveMinimum: true,\n  multipleOf: true,\n  maxLength: true,\n  minLength: true,\n  pattern: true,\n  format: true,\n  maxItems: true,\n  minItems: true,\n  uniqueItems: true,\n  maxProperties: true,\n  minProperties: true\n};\n\n\nfunction _traverse(opts, pre, post, schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n  if (schema && typeof schema == 'object' && !Array.isArray(schema)) {\n    pre(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n    for (var key in schema) {\n      var sch = schema[key];\n      if (Array.isArray(sch)) {\n        if (key in traverse.arrayKeywords) {\n          for (var i=0; i<sch.length; i++)\n            _traverse(opts, pre, post, sch[i], jsonPtr + '/' + key + '/' + i, rootSchema, jsonPtr, key, schema, i);\n        }\n      } else if (key in traverse.propsKeywords) {\n        if (sch && typeof sch == 'object') {\n          for (var prop in sch)\n            _traverse(opts, pre, post, sch[prop], jsonPtr + '/' + key + '/' + escapeJsonPtr(prop), rootSchema, jsonPtr, key, schema, prop);\n        }\n      } else if (key in traverse.keywords || (opts.allKeys && !(key in traverse.skipKeywords))) {\n        _traverse(opts, pre, post, sch, jsonPtr + '/' + key, rootSchema, jsonPtr, key, schema);\n      }\n    }\n    post(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n  }\n}\n\n\nfunction escapeJsonPtr(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n","import type {AnySchema, AnySchemaObject, UriResolver} from \"../types\"\nimport type Ajv from \"../ajv\"\nimport type {URIComponent} from \"fast-uri\"\nimport {eachItem} from \"./util\"\nimport * as equal from \"fast-deep-equal\"\nimport * as traverse from \"json-schema-traverse\"\n\n// the hash of local references inside the schema (created by getSchemaRefs), used for inline resolution\nexport type LocalRefs = {[Ref in string]?: AnySchemaObject}\n\n// TODO refactor to use keyword definitions\nconst SIMPLE_INLINED = new Set([\n  \"type\",\n  \"format\",\n  \"pattern\",\n  \"maxLength\",\n  \"minLength\",\n  \"maxProperties\",\n  \"minProperties\",\n  \"maxItems\",\n  \"minItems\",\n  \"maximum\",\n  \"minimum\",\n  \"uniqueItems\",\n  \"multipleOf\",\n  \"required\",\n  \"enum\",\n  \"const\",\n])\n\nexport function inlineRef(schema: AnySchema, limit: boolean | number = true): boolean {\n  if (typeof schema == \"boolean\") return true\n  if (limit === true) return !hasRef(schema)\n  if (!limit) return false\n  return countKeys(schema) <= limit\n}\n\nconst REF_KEYWORDS = new Set([\n  \"$ref\",\n  \"$recursiveRef\",\n  \"$recursiveAnchor\",\n  \"$dynamicRef\",\n  \"$dynamicAnchor\",\n])\n\nfunction hasRef(schema: AnySchemaObject): boolean {\n  for (const key in schema) {\n    if (REF_KEYWORDS.has(key)) return true\n    const sch = schema[key]\n    if (Array.isArray(sch) && sch.some(hasRef)) return true\n    if (typeof sch == \"object\" && hasRef(sch)) return true\n  }\n  return false\n}\n\nfunction countKeys(schema: AnySchemaObject): number {\n  let count = 0\n  for (const key in schema) {\n    if (key === \"$ref\") return Infinity\n    count++\n    if (SIMPLE_INLINED.has(key)) continue\n    if (typeof schema[key] == \"object\") {\n      eachItem(schema[key], (sch) => (count += countKeys(sch)))\n    }\n    if (count === Infinity) return Infinity\n  }\n  return count\n}\n\nexport function getFullPath(resolver: UriResolver, id = \"\", normalize?: boolean): string {\n  if (normalize !== false) id = normalizeId(id)\n  const p = resolver.parse(id)\n  return _getFullPath(resolver, p)\n}\n\nexport function _getFullPath(resolver: UriResolver, p: URIComponent): string {\n  const serialized = resolver.serialize(p)\n  return serialized.split(\"#\")[0] + \"#\"\n}\n\nconst TRAILING_SLASH_HASH = /#\\/?$/\nexport function normalizeId(id: string | undefined): string {\n  return id ? id.replace(TRAILING_SLASH_HASH, \"\") : \"\"\n}\n\nexport function resolveUrl(resolver: UriResolver, baseId: string, id: string): string {\n  id = normalizeId(id)\n  return resolver.resolve(baseId, id)\n}\n\nconst ANCHOR = /^[a-z_][-a-z0-9._]*$/i\n\nexport function getSchemaRefs(this: Ajv, schema: AnySchema, baseId: string): LocalRefs {\n  if (typeof schema == \"boolean\") return {}\n  const {schemaId, uriResolver} = this.opts\n  const schId = normalizeId(schema[schemaId] || baseId)\n  const baseIds: {[JsonPtr in string]?: string} = {\"\": schId}\n  const pathPrefix = getFullPath(uriResolver, schId, false)\n  const localRefs: LocalRefs = {}\n  const schemaRefs: Set<string> = new Set()\n\n  traverse(schema, {allKeys: true}, (sch, jsonPtr, _, parentJsonPtr) => {\n    if (parentJsonPtr === undefined) return\n    const fullPath = pathPrefix + jsonPtr\n    let innerBaseId = baseIds[parentJsonPtr]\n    if (typeof sch[schemaId] == \"string\") innerBaseId = addRef.call(this, sch[schemaId])\n    addAnchor.call(this, sch.$anchor)\n    addAnchor.call(this, sch.$dynamicAnchor)\n    baseIds[jsonPtr] = innerBaseId\n\n    function addRef(this: Ajv, ref: string): string {\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      const _resolve = this.opts.uriResolver.resolve\n      ref = normalizeId(innerBaseId ? _resolve(innerBaseId, ref) : ref)\n      if (schemaRefs.has(ref)) throw ambiguos(ref)\n      schemaRefs.add(ref)\n      let schOrRef = this.refs[ref]\n      if (typeof schOrRef == \"string\") schOrRef = this.refs[schOrRef]\n      if (typeof schOrRef == \"object\") {\n        checkAmbiguosRef(sch, schOrRef.schema, ref)\n      } else if (ref !== normalizeId(fullPath)) {\n        if (ref[0] === \"#\") {\n          checkAmbiguosRef(sch, localRefs[ref], ref)\n          localRefs[ref] = sch\n        } else {\n          this.refs[ref] = fullPath\n        }\n      }\n      return ref\n    }\n\n    function addAnchor(this: Ajv, anchor: unknown): void {\n      if (typeof anchor == \"string\") {\n        if (!ANCHOR.test(anchor)) throw new Error(`invalid anchor \"${anchor}\"`)\n        addRef.call(this, `#${anchor}`)\n      }\n    }\n  })\n\n  return localRefs\n\n  function checkAmbiguosRef(sch1: AnySchema, sch2: AnySchema | undefined, ref: string): void {\n    if (sch2 !== undefined && !equal(sch1, sch2)) throw ambiguos(ref)\n  }\n\n  function ambiguos(ref: string): Error {\n    return new Error(`reference \"${ref}\" resolves to more than one schema`)\n  }\n}\n","import type {\n  AddedKeywordDefinition,\n  AnySchema,\n  AnySchemaObject,\n  KeywordErrorCxt,\n  KeywordCxtParams,\n} from \"../../types\"\nimport type {SchemaCxt, SchemaObjCxt} from \"..\"\nimport type {InstanceOptions} from \"../../core\"\nimport {boolOrEmptySchema, topBoolOrEmptySchema} from \"./boolSchema\"\nimport {coerceAndCheckDataType, getSchemaTypes} from \"./dataType\"\nimport {shouldUseGroup, shouldUseRule} from \"./applicability\"\nimport {checkDataType, checkDataTypes, reportTypeError, DataType} from \"./dataType\"\nimport {assignDefaults} from \"./defaults\"\nimport {funcKeywordCode, macroKeywordCode, validateKeywordUsage, validSchemaType} from \"./keyword\"\nimport {getSubschema, extendSubschemaData, SubschemaArgs, extendSubschemaMode} from \"./subschema\"\nimport {_, nil, str, or, not, getProperty, Block, Code, Name, CodeGen} from \"../codegen\"\nimport N from \"../names\"\nimport {resolveUrl} from \"../resolve\"\nimport {\n  schemaRefOrVal,\n  schemaHasRulesButRef,\n  checkUnknownRules,\n  checkStrictMode,\n  unescapeJsonPointer,\n  mergeEvaluated,\n} from \"../util\"\nimport type {JSONType, Rule, RuleGroup} from \"../rules\"\nimport {\n  ErrorPaths,\n  reportError,\n  reportExtraError,\n  resetErrorsCount,\n  keyword$DataError,\n} from \"../errors\"\n\n// schema compilation - generates validation function, subschemaCode (below) is used for subschemas\nexport function validateFunctionCode(it: SchemaCxt): void {\n  if (isSchemaObj(it)) {\n    checkKeywords(it)\n    if (schemaCxtHasRules(it)) {\n      topSchemaObjCode(it)\n      return\n    }\n  }\n  validateFunction(it, () => topBoolOrEmptySchema(it))\n}\n\nfunction validateFunction(\n  {gen, validateName, schema, schemaEnv, opts}: SchemaCxt,\n  body: Block\n): void {\n  if (opts.code.es5) {\n    gen.func(validateName, _`${N.data}, ${N.valCxt}`, schemaEnv.$async, () => {\n      gen.code(_`\"use strict\"; ${funcSourceUrl(schema, opts)}`)\n      destructureValCxtES5(gen, opts)\n      gen.code(body)\n    })\n  } else {\n    gen.func(validateName, _`${N.data}, ${destructureValCxt(opts)}`, schemaEnv.$async, () =>\n      gen.code(funcSourceUrl(schema, opts)).code(body)\n    )\n  }\n}\n\nfunction destructureValCxt(opts: InstanceOptions): Code {\n  return _`{${N.instancePath}=\"\", ${N.parentData}, ${N.parentDataProperty}, ${N.rootData}=${\n    N.data\n  }${opts.dynamicRef ? _`, ${N.dynamicAnchors}={}` : nil}}={}`\n}\n\nfunction destructureValCxtES5(gen: CodeGen, opts: InstanceOptions): void {\n  gen.if(\n    N.valCxt,\n    () => {\n      gen.var(N.instancePath, _`${N.valCxt}.${N.instancePath}`)\n      gen.var(N.parentData, _`${N.valCxt}.${N.parentData}`)\n      gen.var(N.parentDataProperty, _`${N.valCxt}.${N.parentDataProperty}`)\n      gen.var(N.rootData, _`${N.valCxt}.${N.rootData}`)\n      if (opts.dynamicRef) gen.var(N.dynamicAnchors, _`${N.valCxt}.${N.dynamicAnchors}`)\n    },\n    () => {\n      gen.var(N.instancePath, _`\"\"`)\n      gen.var(N.parentData, _`undefined`)\n      gen.var(N.parentDataProperty, _`undefined`)\n      gen.var(N.rootData, N.data)\n      if (opts.dynamicRef) gen.var(N.dynamicAnchors, _`{}`)\n    }\n  )\n}\n\nfunction topSchemaObjCode(it: SchemaObjCxt): void {\n  const {schema, opts, gen} = it\n  validateFunction(it, () => {\n    if (opts.$comment && schema.$comment) commentKeyword(it)\n    checkNoDefault(it)\n    gen.let(N.vErrors, null)\n    gen.let(N.errors, 0)\n    if (opts.unevaluated) resetEvaluated(it)\n    typeAndKeywords(it)\n    returnResults(it)\n  })\n  return\n}\n\nfunction resetEvaluated(it: SchemaObjCxt): void {\n  // TODO maybe some hook to execute it in the end to check whether props/items are Name, as in assignEvaluated\n  const {gen, validateName} = it\n  it.evaluated = gen.const(\"evaluated\", _`${validateName}.evaluated`)\n  gen.if(_`${it.evaluated}.dynamicProps`, () => gen.assign(_`${it.evaluated}.props`, _`undefined`))\n  gen.if(_`${it.evaluated}.dynamicItems`, () => gen.assign(_`${it.evaluated}.items`, _`undefined`))\n}\n\nfunction funcSourceUrl(schema: AnySchema, opts: InstanceOptions): Code {\n  const schId = typeof schema == \"object\" && schema[opts.schemaId]\n  return schId && (opts.code.source || opts.code.process) ? _`/*# sourceURL=${schId} */` : nil\n}\n\n// schema compilation - this function is used recursively to generate code for sub-schemas\nfunction subschemaCode(it: SchemaCxt, valid: Name): void {\n  if (isSchemaObj(it)) {\n    checkKeywords(it)\n    if (schemaCxtHasRules(it)) {\n      subSchemaObjCode(it, valid)\n      return\n    }\n  }\n  boolOrEmptySchema(it, valid)\n}\n\nfunction schemaCxtHasRules({schema, self}: SchemaCxt): boolean {\n  if (typeof schema == \"boolean\") return !schema\n  for (const key in schema) if (self.RULES.all[key]) return true\n  return false\n}\n\nfunction isSchemaObj(it: SchemaCxt): it is SchemaObjCxt {\n  return typeof it.schema != \"boolean\"\n}\n\nfunction subSchemaObjCode(it: SchemaObjCxt, valid: Name): void {\n  const {schema, gen, opts} = it\n  if (opts.$comment && schema.$comment) commentKeyword(it)\n  updateContext(it)\n  checkAsyncSchema(it)\n  const errsCount = gen.const(\"_errs\", N.errors)\n  typeAndKeywords(it, errsCount)\n  // TODO var\n  gen.var(valid, _`${errsCount} === ${N.errors}`)\n}\n\nfunction checkKeywords(it: SchemaObjCxt): void {\n  checkUnknownRules(it)\n  checkRefsAndKeywords(it)\n}\n\nfunction typeAndKeywords(it: SchemaObjCxt, errsCount?: Name): void {\n  if (it.opts.jtd) return schemaKeywords(it, [], false, errsCount)\n  const types = getSchemaTypes(it.schema)\n  const checkedTypes = coerceAndCheckDataType(it, types)\n  schemaKeywords(it, types, !checkedTypes, errsCount)\n}\n\nfunction checkRefsAndKeywords(it: SchemaObjCxt): void {\n  const {schema, errSchemaPath, opts, self} = it\n  if (schema.$ref && opts.ignoreKeywordsWithRef && schemaHasRulesButRef(schema, self.RULES)) {\n    self.logger.warn(`$ref: keywords ignored in schema at path \"${errSchemaPath}\"`)\n  }\n}\n\nfunction checkNoDefault(it: SchemaObjCxt): void {\n  const {schema, opts} = it\n  if (schema.default !== undefined && opts.useDefaults && opts.strictSchema) {\n    checkStrictMode(it, \"default is ignored in the schema root\")\n  }\n}\n\nfunction updateContext(it: SchemaObjCxt): void {\n  const schId = it.schema[it.opts.schemaId]\n  if (schId) it.baseId = resolveUrl(it.opts.uriResolver, it.baseId, schId)\n}\n\nfunction checkAsyncSchema(it: SchemaObjCxt): void {\n  if (it.schema.$async && !it.schemaEnv.$async) throw new Error(\"async schema in sync schema\")\n}\n\nfunction commentKeyword({gen, schemaEnv, schema, errSchemaPath, opts}: SchemaObjCxt): void {\n  const msg = schema.$comment\n  if (opts.$comment === true) {\n    gen.code(_`${N.self}.logger.log(${msg})`)\n  } else if (typeof opts.$comment == \"function\") {\n    const schemaPath = str`${errSchemaPath}/$comment`\n    const rootName = gen.scopeValue(\"root\", {ref: schemaEnv.root})\n    gen.code(_`${N.self}.opts.$comment(${msg}, ${schemaPath}, ${rootName}.schema)`)\n  }\n}\n\nfunction returnResults(it: SchemaCxt): void {\n  const {gen, schemaEnv, validateName, ValidationError, opts} = it\n  if (schemaEnv.$async) {\n    // TODO assign unevaluated\n    gen.if(\n      _`${N.errors} === 0`,\n      () => gen.return(N.data),\n      () => gen.throw(_`new ${ValidationError as Name}(${N.vErrors})`)\n    )\n  } else {\n    gen.assign(_`${validateName}.errors`, N.vErrors)\n    if (opts.unevaluated) assignEvaluated(it)\n    gen.return(_`${N.errors} === 0`)\n  }\n}\n\nfunction assignEvaluated({gen, evaluated, props, items}: SchemaCxt): void {\n  if (props instanceof Name) gen.assign(_`${evaluated}.props`, props)\n  if (items instanceof Name) gen.assign(_`${evaluated}.items`, items)\n}\n\nfunction schemaKeywords(\n  it: SchemaObjCxt,\n  types: JSONType[],\n  typeErrors: boolean,\n  errsCount?: Name\n): void {\n  const {gen, schema, data, allErrors, opts, self} = it\n  const {RULES} = self\n  if (schema.$ref && (opts.ignoreKeywordsWithRef || !schemaHasRulesButRef(schema, RULES))) {\n    gen.block(() => keywordCode(it, \"$ref\", (RULES.all.$ref as Rule).definition)) // TODO typecast\n    return\n  }\n  if (!opts.jtd) checkStrictTypes(it, types)\n  gen.block(() => {\n    for (const group of RULES.rules) groupKeywords(group)\n    groupKeywords(RULES.post)\n  })\n\n  function groupKeywords(group: RuleGroup): void {\n    if (!shouldUseGroup(schema, group)) return\n    if (group.type) {\n      gen.if(checkDataType(group.type, data, opts.strictNumbers))\n      iterateKeywords(it, group)\n      if (types.length === 1 && types[0] === group.type && typeErrors) {\n        gen.else()\n        reportTypeError(it)\n      }\n      gen.endIf()\n    } else {\n      iterateKeywords(it, group)\n    }\n    // TODO make it \"ok\" call?\n    if (!allErrors) gen.if(_`${N.errors} === ${errsCount || 0}`)\n  }\n}\n\nfunction iterateKeywords(it: SchemaObjCxt, group: RuleGroup): void {\n  const {\n    gen,\n    schema,\n    opts: {useDefaults},\n  } = it\n  if (useDefaults) assignDefaults(it, group.type)\n  gen.block(() => {\n    for (const rule of group.rules) {\n      if (shouldUseRule(schema, rule)) {\n        keywordCode(it, rule.keyword, rule.definition, group.type)\n      }\n    }\n  })\n}\n\nfunction checkStrictTypes(it: SchemaObjCxt, types: JSONType[]): void {\n  if (it.schemaEnv.meta || !it.opts.strictTypes) return\n  checkContextTypes(it, types)\n  if (!it.opts.allowUnionTypes) checkMultipleTypes(it, types)\n  checkKeywordTypes(it, it.dataTypes)\n}\n\nfunction checkContextTypes(it: SchemaObjCxt, types: JSONType[]): void {\n  if (!types.length) return\n  if (!it.dataTypes.length) {\n    it.dataTypes = types\n    return\n  }\n  types.forEach((t) => {\n    if (!includesType(it.dataTypes, t)) {\n      strictTypesError(it, `type \"${t}\" not allowed by context \"${it.dataTypes.join(\",\")}\"`)\n    }\n  })\n  narrowSchemaTypes(it, types)\n}\n\nfunction checkMultipleTypes(it: SchemaObjCxt, ts: JSONType[]): void {\n  if (ts.length > 1 && !(ts.length === 2 && ts.includes(\"null\"))) {\n    strictTypesError(it, \"use allowUnionTypes to allow union type keyword\")\n  }\n}\n\nfunction checkKeywordTypes(it: SchemaObjCxt, ts: JSONType[]): void {\n  const rules = it.self.RULES.all\n  for (const keyword in rules) {\n    const rule = rules[keyword]\n    if (typeof rule == \"object\" && shouldUseRule(it.schema, rule)) {\n      const {type} = rule.definition\n      if (type.length && !type.some((t) => hasApplicableType(ts, t))) {\n        strictTypesError(it, `missing type \"${type.join(\",\")}\" for keyword \"${keyword}\"`)\n      }\n    }\n  }\n}\n\nfunction hasApplicableType(schTs: JSONType[], kwdT: JSONType): boolean {\n  return schTs.includes(kwdT) || (kwdT === \"number\" && schTs.includes(\"integer\"))\n}\n\nfunction includesType(ts: JSONType[], t: JSONType): boolean {\n  return ts.includes(t) || (t === \"integer\" && ts.includes(\"number\"))\n}\n\nfunction narrowSchemaTypes(it: SchemaObjCxt, withTypes: JSONType[]): void {\n  const ts: JSONType[] = []\n  for (const t of it.dataTypes) {\n    if (includesType(withTypes, t)) ts.push(t)\n    else if (withTypes.includes(\"integer\") && t === \"number\") ts.push(\"integer\")\n  }\n  it.dataTypes = ts\n}\n\nfunction strictTypesError(it: SchemaObjCxt, msg: string): void {\n  const schemaPath = it.schemaEnv.baseId + it.errSchemaPath\n  msg += ` at \"${schemaPath}\" (strictTypes)`\n  checkStrictMode(it, msg, it.opts.strictTypes)\n}\n\nexport class KeywordCxt implements KeywordErrorCxt {\n  readonly gen: CodeGen\n  readonly allErrors?: boolean\n  readonly keyword: string\n  readonly data: Name // Name referencing the current level of the data instance\n  readonly $data?: string | false\n  schema: any // keyword value in the schema\n  readonly schemaValue: Code | number | boolean // Code reference to keyword schema value or primitive value\n  readonly schemaCode: Code | number | boolean // Code reference to resolved schema value (different if schema is $data)\n  readonly schemaType: JSONType[] // allowed type(s) of keyword value in the schema\n  readonly parentSchema: AnySchemaObject\n  readonly errsCount?: Name // Name reference to the number of validation errors collected before this keyword,\n  // requires option trackErrors in keyword definition\n  params: KeywordCxtParams // object to pass parameters to error messages from keyword code\n  readonly it: SchemaObjCxt // schema compilation context (schema is guaranteed to be an object, not boolean)\n  readonly def: AddedKeywordDefinition\n\n  constructor(it: SchemaObjCxt, def: AddedKeywordDefinition, keyword: string) {\n    validateKeywordUsage(it, def, keyword)\n    this.gen = it.gen\n    this.allErrors = it.allErrors\n    this.keyword = keyword\n    this.data = it.data\n    this.schema = it.schema[keyword]\n    this.$data = def.$data && it.opts.$data && this.schema && this.schema.$data\n    this.schemaValue = schemaRefOrVal(it, this.schema, keyword, this.$data)\n    this.schemaType = def.schemaType\n    this.parentSchema = it.schema\n    this.params = {}\n    this.it = it\n    this.def = def\n\n    if (this.$data) {\n      this.schemaCode = it.gen.const(\"vSchema\", getData(this.$data, it))\n    } else {\n      this.schemaCode = this.schemaValue\n      if (!validSchemaType(this.schema, def.schemaType, def.allowUndefined)) {\n        throw new Error(`${keyword} value must be ${JSON.stringify(def.schemaType)}`)\n      }\n    }\n\n    if (\"code\" in def ? def.trackErrors : def.errors !== false) {\n      this.errsCount = it.gen.const(\"_errs\", N.errors)\n    }\n  }\n\n  result(condition: Code, successAction?: () => void, failAction?: () => void): void {\n    this.failResult(not(condition), successAction, failAction)\n  }\n\n  failResult(condition: Code, successAction?: () => void, failAction?: () => void): void {\n    this.gen.if(condition)\n    if (failAction) failAction()\n    else this.error()\n    if (successAction) {\n      this.gen.else()\n      successAction()\n      if (this.allErrors) this.gen.endIf()\n    } else {\n      if (this.allErrors) this.gen.endIf()\n      else this.gen.else()\n    }\n  }\n\n  pass(condition: Code, failAction?: () => void): void {\n    this.failResult(not(condition), undefined, failAction)\n  }\n\n  fail(condition?: Code): void {\n    if (condition === undefined) {\n      this.error()\n      if (!this.allErrors) this.gen.if(false) // this branch will be removed by gen.optimize\n      return\n    }\n    this.gen.if(condition)\n    this.error()\n    if (this.allErrors) this.gen.endIf()\n    else this.gen.else()\n  }\n\n  fail$data(condition: Code): void {\n    if (!this.$data) return this.fail(condition)\n    const {schemaCode} = this\n    this.fail(_`${schemaCode} !== undefined && (${or(this.invalid$data(), condition)})`)\n  }\n\n  error(append?: boolean, errorParams?: KeywordCxtParams, errorPaths?: ErrorPaths): void {\n    if (errorParams) {\n      this.setParams(errorParams)\n      this._error(append, errorPaths)\n      this.setParams({})\n      return\n    }\n    this._error(append, errorPaths)\n  }\n\n  private _error(append?: boolean, errorPaths?: ErrorPaths): void {\n    ;(append ? reportExtraError : reportError)(this, this.def.error, errorPaths)\n  }\n\n  $dataError(): void {\n    reportError(this, this.def.$dataError || keyword$DataError)\n  }\n\n  reset(): void {\n    if (this.errsCount === undefined) throw new Error('add \"trackErrors\" to keyword definition')\n    resetErrorsCount(this.gen, this.errsCount)\n  }\n\n  ok(cond: Code | boolean): void {\n    if (!this.allErrors) this.gen.if(cond)\n  }\n\n  setParams(obj: KeywordCxtParams, assign?: true): void {\n    if (assign) Object.assign(this.params, obj)\n    else this.params = obj\n  }\n\n  block$data(valid: Name, codeBlock: () => void, $dataValid: Code = nil): void {\n    this.gen.block(() => {\n      this.check$data(valid, $dataValid)\n      codeBlock()\n    })\n  }\n\n  check$data(valid: Name = nil, $dataValid: Code = nil): void {\n    if (!this.$data) return\n    const {gen, schemaCode, schemaType, def} = this\n    gen.if(or(_`${schemaCode} === undefined`, $dataValid))\n    if (valid !== nil) gen.assign(valid, true)\n    if (schemaType.length || def.validateSchema) {\n      gen.elseIf(this.invalid$data())\n      this.$dataError()\n      if (valid !== nil) gen.assign(valid, false)\n    }\n    gen.else()\n  }\n\n  invalid$data(): Code {\n    const {gen, schemaCode, schemaType, def, it} = this\n    return or(wrong$DataType(), invalid$DataSchema())\n\n    function wrong$DataType(): Code {\n      if (schemaType.length) {\n        /* istanbul ignore if */\n        if (!(schemaCode instanceof Name)) throw new Error(\"ajv implementation error\")\n        const st = Array.isArray(schemaType) ? schemaType : [schemaType]\n        return _`${checkDataTypes(st, schemaCode, it.opts.strictNumbers, DataType.Wrong)}`\n      }\n      return nil\n    }\n\n    function invalid$DataSchema(): Code {\n      if (def.validateSchema) {\n        const validateSchemaRef = gen.scopeValue(\"validate$data\", {ref: def.validateSchema}) // TODO value.code for standalone\n        return _`!${validateSchemaRef}(${schemaCode})`\n      }\n      return nil\n    }\n  }\n\n  subschema(appl: SubschemaArgs, valid: Name): SchemaCxt {\n    const subschema = getSubschema(this.it, appl)\n    extendSubschemaData(subschema, this.it, appl)\n    extendSubschemaMode(subschema, appl)\n    const nextContext = {...this.it, ...subschema, items: undefined, props: undefined}\n    subschemaCode(nextContext, valid)\n    return nextContext\n  }\n\n  mergeEvaluated(schemaCxt: SchemaCxt, toName?: typeof Name): void {\n    const {it, gen} = this\n    if (!it.opts.unevaluated) return\n    if (it.props !== true && schemaCxt.props !== undefined) {\n      it.props = mergeEvaluated.props(gen, schemaCxt.props, it.props, toName)\n    }\n    if (it.items !== true && schemaCxt.items !== undefined) {\n      it.items = mergeEvaluated.items(gen, schemaCxt.items, it.items, toName)\n    }\n  }\n\n  mergeValidEvaluated(schemaCxt: SchemaCxt, valid: Name): boolean | void {\n    const {it, gen} = this\n    if (it.opts.unevaluated && (it.props !== true || it.items !== true)) {\n      gen.if(valid, () => this.mergeEvaluated(schemaCxt, Name))\n      return true\n    }\n  }\n}\n\nfunction keywordCode(\n  it: SchemaObjCxt,\n  keyword: string,\n  def: AddedKeywordDefinition,\n  ruleType?: JSONType\n): void {\n  const cxt = new KeywordCxt(it, def, keyword)\n  if (\"code\" in def) {\n    def.code(cxt, ruleType)\n  } else if (cxt.$data && def.validate) {\n    funcKeywordCode(cxt, def)\n  } else if (\"macro\" in def) {\n    macroKeywordCode(cxt, def)\n  } else if (def.compile || def.validate) {\n    funcKeywordCode(cxt, def)\n  }\n}\n\nconst JSON_POINTER = /^\\/(?:[^~]|~0|~1)*$/\nconst RELATIVE_JSON_POINTER = /^([0-9]+)(#|\\/(?:[^~]|~0|~1)*)?$/\nexport function getData(\n  $data: string,\n  {dataLevel, dataNames, dataPathArr}: SchemaCxt\n): Code | number {\n  let jsonPointer\n  let data: Code\n  if ($data === \"\") return N.rootData\n  if ($data[0] === \"/\") {\n    if (!JSON_POINTER.test($data)) throw new Error(`Invalid JSON-pointer: ${$data}`)\n    jsonPointer = $data\n    data = N.rootData\n  } else {\n    const matches = RELATIVE_JSON_POINTER.exec($data)\n    if (!matches) throw new Error(`Invalid JSON-pointer: ${$data}`)\n    const up: number = +matches[1]\n    jsonPointer = matches[2]\n    if (jsonPointer === \"#\") {\n      if (up >= dataLevel) throw new Error(errorMsg(\"property/index\", up))\n      return dataPathArr[dataLevel - up]\n    }\n    if (up > dataLevel) throw new Error(errorMsg(\"data\", up))\n    data = dataNames[dataLevel - up]\n    if (!jsonPointer) return data\n  }\n\n  let expr = data\n  const segments = jsonPointer.split(\"/\")\n  for (const segment of segments) {\n    if (segment) {\n      data = _`${data}${getProperty(unescapeJsonPointer(segment))}`\n      expr = _`${expr} && ${data}`\n    }\n  }\n  return expr\n\n  function errorMsg(pointerType: string, up: number): string {\n    return `Cannot access ${pointerType} ${up} levels up, current level is ${dataLevel}`\n  }\n}\n","import type {ErrorObject} from \"../types\"\n\nexport default class ValidationError extends Error {\n  readonly errors: Partial<ErrorObject>[]\n  readonly ajv: true\n  readonly validation: true\n\n  constructor(errors: Partial<ErrorObject>[]) {\n    super(\"validation failed\")\n    this.errors = errors\n    this.ajv = this.validation = true\n  }\n}\n","import {resolveUrl, normalizeId, getFullPath} from \"./resolve\"\nimport type {UriResolver} from \"../types\"\n\nexport default class MissingRefError extends Error {\n  readonly missingRef: string\n  readonly missingSchema: string\n\n  constructor(resolver: UriResolver, baseId: string, ref: string, msg?: string) {\n    super(msg || `can't resolve reference ${ref} from id ${baseId}`)\n    this.missingRef = resolveUrl(resolver, baseId, ref)\n    this.missingSchema = normalizeId(getFullPath(resolver, this.missingRef))\n  }\n}\n","import type {\n  AnySchema,\n  AnySchemaObject,\n  AnyValidateFunction,\n  AsyncValidateFunction,\n  EvaluatedProperties,\n  EvaluatedItems,\n} from \"../types\"\nimport type Ajv from \"../core\"\nimport type {InstanceOptions} from \"../core\"\nimport {CodeGen, _, nil, stringify, Name, Code, ValueScopeName} from \"./codegen\"\nimport ValidationError from \"../runtime/validation_error\"\nimport N from \"./names\"\nimport {LocalRefs, getFullPath, _getFullPath, inlineRef, normalizeId, resolveUrl} from \"./resolve\"\nimport {schemaHasRulesButRef, unescapeFragment} from \"./util\"\nimport {validateFunctionCode} from \"./validate\"\nimport {URIComponent} from \"fast-uri\"\nimport {JSONType} from \"./rules\"\n\nexport type SchemaRefs = {\n  [Ref in string]?: SchemaEnv | AnySchema\n}\n\nexport interface SchemaCxt {\n  readonly gen: CodeGen\n  readonly allErrors?: boolean // validation mode - whether to collect all errors or break on error\n  readonly data: Name // Name with reference to the current part of data instance\n  readonly parentData: Name // should be used in keywords modifying data\n  readonly parentDataProperty: Code | number // should be used in keywords modifying data\n  readonly dataNames: Name[]\n  readonly dataPathArr: (Code | number)[]\n  readonly dataLevel: number // the level of the currently validated data,\n  // it can be used to access both the property names and the data on all levels from the top.\n  dataTypes: JSONType[] // data types applied to the current part of data instance\n  definedProperties: Set<string> // set of properties to keep track of for required checks\n  readonly topSchemaRef: Code\n  readonly validateName: Name\n  evaluated?: Name\n  readonly ValidationError?: Name\n  readonly schema: AnySchema // current schema object - equal to parentSchema passed via KeywordCxt\n  readonly schemaEnv: SchemaEnv\n  readonly rootId: string\n  baseId: string // the current schema base URI that should be used as the base for resolving URIs in references (\\$ref)\n  readonly schemaPath: Code // the run-time expression that evaluates to the property name of the current schema\n  readonly errSchemaPath: string // this is actual string, should not be changed to Code\n  readonly errorPath: Code\n  readonly propertyName?: Name\n  readonly compositeRule?: boolean // true indicates that the current schema is inside the compound keyword,\n  // where failing some rule doesn't mean validation failure (`anyOf`, `oneOf`, `not`, `if`).\n  // This flag is used to determine whether you can return validation result immediately after any error in case the option `allErrors` is not `true.\n  // You only need to use it if you have many steps in your keywords and potentially can define multiple errors.\n  props?: EvaluatedProperties | Name // properties evaluated by this schema - used by parent schema or assigned to validation function\n  items?: EvaluatedItems | Name // last item evaluated by this schema - used by parent schema or assigned to validation function\n  jtdDiscriminator?: string\n  jtdMetadata?: boolean\n  readonly createErrors?: boolean\n  readonly opts: InstanceOptions // Ajv instance option.\n  readonly self: Ajv // current Ajv instance\n}\n\nexport interface SchemaObjCxt extends SchemaCxt {\n  readonly schema: AnySchemaObject\n}\ninterface SchemaEnvArgs {\n  readonly schema: AnySchema\n  readonly schemaId?: \"$id\" | \"id\"\n  readonly root?: SchemaEnv\n  readonly baseId?: string\n  readonly schemaPath?: string\n  readonly localRefs?: LocalRefs\n  readonly meta?: boolean\n}\n\nexport class SchemaEnv implements SchemaEnvArgs {\n  readonly schema: AnySchema\n  readonly schemaId?: \"$id\" | \"id\"\n  readonly root: SchemaEnv\n  baseId: string // TODO possibly, it should be readonly\n  schemaPath?: string\n  localRefs?: LocalRefs\n  readonly meta?: boolean\n  readonly $async?: boolean // true if the current schema is asynchronous.\n  readonly refs: SchemaRefs = {}\n  readonly dynamicAnchors: {[Ref in string]?: true} = {}\n  validate?: AnyValidateFunction\n  validateName?: ValueScopeName\n  serialize?: (data: unknown) => string\n  serializeName?: ValueScopeName\n  parse?: (data: string) => unknown\n  parseName?: ValueScopeName\n\n  constructor(env: SchemaEnvArgs) {\n    let schema: AnySchemaObject | undefined\n    if (typeof env.schema == \"object\") schema = env.schema\n    this.schema = env.schema\n    this.schemaId = env.schemaId\n    this.root = env.root || this\n    this.baseId = env.baseId ?? normalizeId(schema?.[env.schemaId || \"$id\"])\n    this.schemaPath = env.schemaPath\n    this.localRefs = env.localRefs\n    this.meta = env.meta\n    this.$async = schema?.$async\n    this.refs = {}\n  }\n}\n\n// let codeSize = 0\n// let nodeCount = 0\n\n// Compiles schema in SchemaEnv\nexport function compileSchema(this: Ajv, sch: SchemaEnv): SchemaEnv {\n  // TODO refactor - remove compilations\n  const _sch = getCompilingSchema.call(this, sch)\n  if (_sch) return _sch\n  const rootId = getFullPath(this.opts.uriResolver, sch.root.baseId) // TODO if getFullPath removed 1 tests fails\n  const {es5, lines} = this.opts.code\n  const {ownProperties} = this.opts\n  const gen = new CodeGen(this.scope, {es5, lines, ownProperties})\n  let _ValidationError\n  if (sch.$async) {\n    _ValidationError = gen.scopeValue(\"Error\", {\n      ref: ValidationError,\n      code: _`require(\"ajv/dist/runtime/validation_error\").default`,\n    })\n  }\n\n  const validateName = gen.scopeName(\"validate\")\n  sch.validateName = validateName\n\n  const schemaCxt: SchemaCxt = {\n    gen,\n    allErrors: this.opts.allErrors,\n    data: N.data,\n    parentData: N.parentData,\n    parentDataProperty: N.parentDataProperty,\n    dataNames: [N.data],\n    dataPathArr: [nil], // TODO can its length be used as dataLevel if nil is removed?\n    dataLevel: 0,\n    dataTypes: [],\n    definedProperties: new Set<string>(),\n    topSchemaRef: gen.scopeValue(\n      \"schema\",\n      this.opts.code.source === true\n        ? {ref: sch.schema, code: stringify(sch.schema)}\n        : {ref: sch.schema}\n    ),\n    validateName,\n    ValidationError: _ValidationError,\n    schema: sch.schema,\n    schemaEnv: sch,\n    rootId,\n    baseId: sch.baseId || rootId,\n    schemaPath: nil,\n    errSchemaPath: sch.schemaPath || (this.opts.jtd ? \"\" : \"#\"),\n    errorPath: _`\"\"`,\n    opts: this.opts,\n    self: this,\n  }\n\n  let sourceCode: string | undefined\n  try {\n    this._compilations.add(sch)\n    validateFunctionCode(schemaCxt)\n    gen.optimize(this.opts.code.optimize)\n    // gen.optimize(1)\n    const validateCode = gen.toString()\n    sourceCode = `${gen.scopeRefs(N.scope)}return ${validateCode}`\n    // console.log((codeSize += sourceCode.length), (nodeCount += gen.nodeCount))\n    if (this.opts.code.process) sourceCode = this.opts.code.process(sourceCode, sch)\n    // console.log(\"\\n\\n\\n *** \\n\", sourceCode)\n    const makeValidate = new Function(`${N.self}`, `${N.scope}`, sourceCode)\n    const validate: AnyValidateFunction = makeValidate(this, this.scope.get())\n    this.scope.value(validateName, {ref: validate})\n\n    validate.errors = null\n    validate.schema = sch.schema\n    validate.schemaEnv = sch\n    if (sch.$async) (validate as AsyncValidateFunction).$async = true\n    if (this.opts.code.source === true) {\n      validate.source = {validateName, validateCode, scopeValues: gen._values}\n    }\n    if (this.opts.unevaluated) {\n      const {props, items} = schemaCxt\n      validate.evaluated = {\n        props: props instanceof Name ? undefined : props,\n        items: items instanceof Name ? undefined : items,\n        dynamicProps: props instanceof Name,\n        dynamicItems: items instanceof Name,\n      }\n      if (validate.source) validate.source.evaluated = stringify(validate.evaluated)\n    }\n    sch.validate = validate\n    return sch\n  } catch (e) {\n    delete sch.validate\n    delete sch.validateName\n    if (sourceCode) this.logger.error(\"Error compiling schema, function code:\", sourceCode)\n    // console.log(\"\\n\\n\\n *** \\n\", sourceCode, this.opts)\n    throw e\n  } finally {\n    this._compilations.delete(sch)\n  }\n}\n\nexport function resolveRef(\n  this: Ajv,\n  root: SchemaEnv,\n  baseId: string,\n  ref: string\n): AnySchema | SchemaEnv | undefined {\n  ref = resolveUrl(this.opts.uriResolver, baseId, ref)\n  const schOrFunc = root.refs[ref]\n  if (schOrFunc) return schOrFunc\n\n  let _sch = resolve.call(this, root, ref)\n  if (_sch === undefined) {\n    const schema = root.localRefs?.[ref] // TODO maybe localRefs should hold SchemaEnv\n    const {schemaId} = this.opts\n    if (schema) _sch = new SchemaEnv({schema, schemaId, root, baseId})\n  }\n\n  if (_sch === undefined) return\n  return (root.refs[ref] = inlineOrCompile.call(this, _sch))\n}\n\nfunction inlineOrCompile(this: Ajv, sch: SchemaEnv): AnySchema | SchemaEnv {\n  if (inlineRef(sch.schema, this.opts.inlineRefs)) return sch.schema\n  return sch.validate ? sch : compileSchema.call(this, sch)\n}\n\n// Index of schema compilation in the currently compiled list\nexport function getCompilingSchema(this: Ajv, schEnv: SchemaEnv): SchemaEnv | void {\n  for (const sch of this._compilations) {\n    if (sameSchemaEnv(sch, schEnv)) return sch\n  }\n}\n\nfunction sameSchemaEnv(s1: SchemaEnv, s2: SchemaEnv): boolean {\n  return s1.schema === s2.schema && s1.root === s2.root && s1.baseId === s2.baseId\n}\n\n// resolve and compile the references ($ref)\n// TODO returns AnySchemaObject (if the schema can be inlined) or validation function\nfunction resolve(\n  this: Ajv,\n  root: SchemaEnv, // information about the root schema for the current schema\n  ref: string // reference to resolve\n): SchemaEnv | undefined {\n  let sch\n  while (typeof (sch = this.refs[ref]) == \"string\") ref = sch\n  return sch || this.schemas[ref] || resolveSchema.call(this, root, ref)\n}\n\n// Resolve schema, its root and baseId\nexport function resolveSchema(\n  this: Ajv,\n  root: SchemaEnv, // root object with properties schema, refs TODO below SchemaEnv is assigned to it\n  ref: string // reference to resolve\n): SchemaEnv | undefined {\n  const p = this.opts.uriResolver.parse(ref)\n  const refPath = _getFullPath(this.opts.uriResolver, p)\n  let baseId = getFullPath(this.opts.uriResolver, root.baseId, undefined)\n  // TODO `Object.keys(root.schema).length > 0` should not be needed - but removing breaks 2 tests\n  if (Object.keys(root.schema).length > 0 && refPath === baseId) {\n    return getJsonPointer.call(this, p, root)\n  }\n\n  const id = normalizeId(refPath)\n  const schOrRef = this.refs[id] || this.schemas[id]\n  if (typeof schOrRef == \"string\") {\n    const sch = resolveSchema.call(this, root, schOrRef)\n    if (typeof sch?.schema !== \"object\") return\n    return getJsonPointer.call(this, p, sch)\n  }\n\n  if (typeof schOrRef?.schema !== \"object\") return\n  if (!schOrRef.validate) compileSchema.call(this, schOrRef)\n  if (id === normalizeId(ref)) {\n    const {schema} = schOrRef\n    const {schemaId} = this.opts\n    const schId = schema[schemaId]\n    if (schId) baseId = resolveUrl(this.opts.uriResolver, baseId, schId)\n    return new SchemaEnv({schema, schemaId, root, baseId})\n  }\n  return getJsonPointer.call(this, p, schOrRef)\n}\n\nconst PREVENT_SCOPE_CHANGE = new Set([\n  \"properties\",\n  \"patternProperties\",\n  \"enum\",\n  \"dependencies\",\n  \"definitions\",\n])\n\nfunction getJsonPointer(\n  this: Ajv,\n  parsedRef: URIComponent,\n  {baseId, schema, root}: SchemaEnv\n): SchemaEnv | undefined {\n  if (parsedRef.fragment?.[0] !== \"/\") return\n  for (const part of parsedRef.fragment.slice(1).split(\"/\")) {\n    if (typeof schema === \"boolean\") return\n    const partSchema = schema[unescapeFragment(part)]\n    if (partSchema === undefined) return\n    schema = partSchema\n    // TODO PREVENT_SCOPE_CHANGE could be defined in keyword def?\n    const schId = typeof schema === \"object\" && schema[this.opts.schemaId]\n    if (!PREVENT_SCOPE_CHANGE.has(part) && schId) {\n      baseId = resolveUrl(this.opts.uriResolver, baseId, schId)\n    }\n  }\n  let env: SchemaEnv | undefined\n  if (typeof schema != \"boolean\" && schema.$ref && !schemaHasRulesButRef(schema, this.RULES)) {\n    const $ref = resolveUrl(this.opts.uriResolver, baseId, schema.$ref)\n    env = resolveSchema.call(this, root, $ref)\n  }\n  // even though resolution failed we need to return SchemaEnv to throw exception\n  // so that compileAsync loads missing schema.\n  const {schemaId} = this.opts\n  env = env || new SchemaEnv({schema, schemaId, root, baseId})\n  if (env.schema !== env.root.schema) return env\n  return undefined\n}\n","{\n  \"$id\": \"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#\",\n  \"description\": \"Meta-schema for $data reference (JSON AnySchema extension proposal)\",\n  \"type\": \"object\",\n  \"required\": [\"$data\"],\n  \"properties\": {\n    \"$data\": {\n      \"type\": \"string\",\n      \"anyOf\": [{\"format\": \"relative-json-pointer\"}, {\"format\": \"json-pointer\"}]\n    }\n  },\n  \"additionalProperties\": false\n}\n","'use strict'\n\n/** @type {(value: string) => boolean} */\nconst isUUID = RegExp.prototype.test.bind(/^[\\da-f]{8}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{12}$/iu)\n\n/** @type {(value: string) => boolean} */\nconst isIPv4 = RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)$/u)\n\n/**\n * @param {Array<string>} input\n * @returns {string}\n */\nfunction stringArrayToHexStripped (input) {\n  let acc = ''\n  let code = 0\n  let i = 0\n\n  for (i = 0; i < input.length; i++) {\n    code = input[i].charCodeAt(0)\n    if (code === 48) {\n      continue\n    }\n    if (!((code >= 48 && code <= 57) || (code >= 65 && code <= 70) || (code >= 97 && code <= 102))) {\n      return ''\n    }\n    acc += input[i]\n    break\n  }\n\n  for (i += 1; i < input.length; i++) {\n    code = input[i].charCodeAt(0)\n    if (!((code >= 48 && code <= 57) || (code >= 65 && code <= 70) || (code >= 97 && code <= 102))) {\n      return ''\n    }\n    acc += input[i]\n  }\n  return acc\n}\n\n/**\n * @typedef {Object} GetIPV6Result\n * @property {boolean} error - Indicates if there was an error parsing the IPv6 address.\n * @property {string} address - The parsed IPv6 address.\n * @property {string} [zone] - The zone identifier, if present.\n */\n\n/**\n * @param {string} value\n * @returns {boolean}\n */\nconst nonSimpleDomain = RegExp.prototype.test.bind(/[^!\"$&'()*+,\\-.;=_`a-z{}~]/u)\n\n/**\n * @param {Array<string>} buffer\n * @returns {boolean}\n */\nfunction consumeIsZone (buffer) {\n  buffer.length = 0\n  return true\n}\n\n/**\n * @param {Array<string>} buffer\n * @param {Array<string>} address\n * @param {GetIPV6Result} output\n * @returns {boolean}\n */\nfunction consumeHextets (buffer, address, output) {\n  if (buffer.length) {\n    const hex = stringArrayToHexStripped(buffer)\n    if (hex !== '') {\n      address.push(hex)\n    } else {\n      output.error = true\n      return false\n    }\n    buffer.length = 0\n  }\n  return true\n}\n\n/**\n * @param {string} input\n * @returns {GetIPV6Result}\n */\nfunction getIPV6 (input) {\n  let tokenCount = 0\n  const output = { error: false, address: '', zone: '' }\n  /** @type {Array<string>} */\n  const address = []\n  /** @type {Array<string>} */\n  const buffer = []\n  let endipv6Encountered = false\n  let endIpv6 = false\n\n  let consume = consumeHextets\n\n  for (let i = 0; i < input.length; i++) {\n    const cursor = input[i]\n    if (cursor === '[' || cursor === ']') { continue }\n    if (cursor === ':') {\n      if (endipv6Encountered === true) {\n        endIpv6 = true\n      }\n      if (!consume(buffer, address, output)) { break }\n      if (++tokenCount > 7) {\n        // not valid\n        output.error = true\n        break\n      }\n      if (i > 0 && input[i - 1] === ':') {\n        endipv6Encountered = true\n      }\n      address.push(':')\n      continue\n    } else if (cursor === '%') {\n      if (!consume(buffer, address, output)) { break }\n      // switch to zone detection\n      consume = consumeIsZone\n    } else {\n      buffer.push(cursor)\n      continue\n    }\n  }\n  if (buffer.length) {\n    if (consume === consumeIsZone) {\n      output.zone = buffer.join('')\n    } else if (endIpv6) {\n      address.push(buffer.join(''))\n    } else {\n      address.push(stringArrayToHexStripped(buffer))\n    }\n  }\n  output.address = address.join('')\n  return output\n}\n\n/**\n * @typedef {Object} NormalizeIPv6Result\n * @property {string} host - The normalized host.\n * @property {string} [escapedHost] - The escaped host.\n * @property {boolean} isIPV6 - Indicates if the host is an IPv6 address.\n */\n\n/**\n * @param {string} host\n * @returns {NormalizeIPv6Result}\n */\nfunction normalizeIPv6 (host) {\n  if (findToken(host, ':') < 2) { return { host, isIPV6: false } }\n  const ipv6 = getIPV6(host)\n\n  if (!ipv6.error) {\n    let newHost = ipv6.address\n    let escapedHost = ipv6.address\n    if (ipv6.zone) {\n      newHost += '%' + ipv6.zone\n      escapedHost += '%25' + ipv6.zone\n    }\n    return { host: newHost, isIPV6: true, escapedHost }\n  } else {\n    return { host, isIPV6: false }\n  }\n}\n\n/**\n * @param {string} str\n * @param {string} token\n * @returns {number}\n */\nfunction findToken (str, token) {\n  let ind = 0\n  for (let i = 0; i < str.length; i++) {\n    if (str[i] === token) ind++\n  }\n  return ind\n}\n\n/**\n * @param {string} path\n * @returns {string}\n *\n * @see https://datatracker.ietf.org/doc/html/rfc3986#section-5.2.4\n */\nfunction removeDotSegments (path) {\n  let input = path\n  const output = []\n  let nextSlash = -1\n  let len = 0\n\n  // eslint-disable-next-line no-cond-assign\n  while (len = input.length) {\n    if (len === 1) {\n      if (input === '.') {\n        break\n      } else if (input === '/') {\n        output.push('/')\n        break\n      } else {\n        output.push(input)\n        break\n      }\n    } else if (len === 2) {\n      if (input[0] === '.') {\n        if (input[1] === '.') {\n          break\n        } else if (input[1] === '/') {\n          input = input.slice(2)\n          continue\n        }\n      } else if (input[0] === '/') {\n        if (input[1] === '.' || input[1] === '/') {\n          output.push('/')\n          break\n        }\n      }\n    } else if (len === 3) {\n      if (input === '/..') {\n        if (output.length !== 0) {\n          output.pop()\n        }\n        output.push('/')\n        break\n      }\n    }\n    if (input[0] === '.') {\n      if (input[1] === '.') {\n        if (input[2] === '/') {\n          input = input.slice(3)\n          continue\n        }\n      } else if (input[1] === '/') {\n        input = input.slice(2)\n        continue\n      }\n    } else if (input[0] === '/') {\n      if (input[1] === '.') {\n        if (input[2] === '/') {\n          input = input.slice(2)\n          continue\n        } else if (input[2] === '.') {\n          if (input[3] === '/') {\n            input = input.slice(3)\n            if (output.length !== 0) {\n              output.pop()\n            }\n            continue\n          }\n        }\n      }\n    }\n\n    // Rule 2E: Move normal path segment to output\n    if ((nextSlash = input.indexOf('/', 1)) === -1) {\n      output.push(input)\n      break\n    } else {\n      output.push(input.slice(0, nextSlash))\n      input = input.slice(nextSlash)\n    }\n  }\n\n  return output.join('')\n}\n\n/**\n * @param {import('../types/index').URIComponent} component\n * @param {boolean} esc\n * @returns {import('../types/index').URIComponent}\n */\nfunction normalizeComponentEncoding (component, esc) {\n  const func = esc !== true ? escape : unescape\n  if (component.scheme !== undefined) {\n    component.scheme = func(component.scheme)\n  }\n  if (component.userinfo !== undefined) {\n    component.userinfo = func(component.userinfo)\n  }\n  if (component.host !== undefined) {\n    component.host = func(component.host)\n  }\n  if (component.path !== undefined) {\n    component.path = func(component.path)\n  }\n  if (component.query !== undefined) {\n    component.query = func(component.query)\n  }\n  if (component.fragment !== undefined) {\n    component.fragment = func(component.fragment)\n  }\n  return component\n}\n\n/**\n * @param {import('../types/index').URIComponent} component\n * @returns {string|undefined}\n */\nfunction recomposeAuthority (component) {\n  const uriTokens = []\n\n  if (component.userinfo !== undefined) {\n    uriTokens.push(component.userinfo)\n    uriTokens.push('@')\n  }\n\n  if (component.host !== undefined) {\n    let host = unescape(component.host)\n    if (!isIPv4(host)) {\n      const ipV6res = normalizeIPv6(host)\n      if (ipV6res.isIPV6 === true) {\n        host = `[${ipV6res.escapedHost}]`\n      } else {\n        host = component.host\n      }\n    }\n    uriTokens.push(host)\n  }\n\n  if (typeof component.port === 'number' || typeof component.port === 'string') {\n    uriTokens.push(':')\n    uriTokens.push(String(component.port))\n  }\n\n  return uriTokens.length ? uriTokens.join('') : undefined\n};\n\nmodule.exports = {\n  nonSimpleDomain,\n  recomposeAuthority,\n  normalizeComponentEncoding,\n  removeDotSegments,\n  isIPv4,\n  isUUID,\n  normalizeIPv6,\n  stringArrayToHexStripped\n}\n","'use strict'\n\nconst { isUUID } = require('./utils')\nconst URN_REG = /([\\da-z][\\d\\-a-z]{0,31}):((?:[\\w!$'()*+,\\-.:;=@]|%[\\da-f]{2})+)/iu\n\nconst supportedSchemeNames = /** @type {const} */ (['http', 'https', 'ws',\n  'wss', 'urn', 'urn:uuid'])\n\n/** @typedef {supportedSchemeNames[number]} SchemeName */\n\n/**\n * @param {string} name\n * @returns {name is SchemeName}\n */\nfunction isValidSchemeName (name) {\n  return supportedSchemeNames.indexOf(/** @type {*} */ (name)) !== -1\n}\n\n/**\n * @callback SchemeFn\n * @param {import('../types/index').URIComponent} component\n * @param {import('../types/index').Options} options\n * @returns {import('../types/index').URIComponent}\n */\n\n/**\n * @typedef {Object} SchemeHandler\n * @property {SchemeName} scheme - The scheme name.\n * @property {boolean} [domainHost] - Indicates if the scheme supports domain hosts.\n * @property {SchemeFn} parse - Function to parse the URI component for this scheme.\n * @property {SchemeFn} serialize - Function to serialize the URI component for this scheme.\n * @property {boolean} [skipNormalize] - Indicates if normalization should be skipped for this scheme.\n * @property {boolean} [absolutePath] - Indicates if the scheme uses absolute paths.\n * @property {boolean} [unicodeSupport] - Indicates if the scheme supports Unicode.\n */\n\n/**\n * @param {import('../types/index').URIComponent} wsComponent\n * @returns {boolean}\n */\nfunction wsIsSecure (wsComponent) {\n  if (wsComponent.secure === true) {\n    return true\n  } else if (wsComponent.secure === false) {\n    return false\n  } else if (wsComponent.scheme) {\n    return (\n      wsComponent.scheme.length === 3 &&\n      (wsComponent.scheme[0] === 'w' || wsComponent.scheme[0] === 'W') &&\n      (wsComponent.scheme[1] === 's' || wsComponent.scheme[1] === 'S') &&\n      (wsComponent.scheme[2] === 's' || wsComponent.scheme[2] === 'S')\n    )\n  } else {\n    return false\n  }\n}\n\n/** @type {SchemeFn} */\nfunction httpParse (component) {\n  if (!component.host) {\n    component.error = component.error || 'HTTP URIs must have a host.'\n  }\n\n  return component\n}\n\n/** @type {SchemeFn} */\nfunction httpSerialize (component) {\n  const secure = String(component.scheme).toLowerCase() === 'https'\n\n  // normalize the default port\n  if (component.port === (secure ? 443 : 80) || component.port === '') {\n    component.port = undefined\n  }\n\n  // normalize the empty path\n  if (!component.path) {\n    component.path = '/'\n  }\n\n  // NOTE: We do not parse query strings for HTTP URIs\n  // as WWW Form Url Encoded query strings are part of the HTML4+ spec,\n  // and not the HTTP spec.\n\n  return component\n}\n\n/** @type {SchemeFn} */\nfunction wsParse (wsComponent) {\n// indicate if the secure flag is set\n  wsComponent.secure = wsIsSecure(wsComponent)\n\n  // construct resouce name\n  wsComponent.resourceName = (wsComponent.path || '/') + (wsComponent.query ? '?' + wsComponent.query : '')\n  wsComponent.path = undefined\n  wsComponent.query = undefined\n\n  return wsComponent\n}\n\n/** @type {SchemeFn} */\nfunction wsSerialize (wsComponent) {\n// normalize the default port\n  if (wsComponent.port === (wsIsSecure(wsComponent) ? 443 : 80) || wsComponent.port === '') {\n    wsComponent.port = undefined\n  }\n\n  // ensure scheme matches secure flag\n  if (typeof wsComponent.secure === 'boolean') {\n    wsComponent.scheme = (wsComponent.secure ? 'wss' : 'ws')\n    wsComponent.secure = undefined\n  }\n\n  // reconstruct path from resource name\n  if (wsComponent.resourceName) {\n    const [path, query] = wsComponent.resourceName.split('?')\n    wsComponent.path = (path && path !== '/' ? path : undefined)\n    wsComponent.query = query\n    wsComponent.resourceName = undefined\n  }\n\n  // forbid fragment component\n  wsComponent.fragment = undefined\n\n  return wsComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnParse (urnComponent, options) {\n  if (!urnComponent.path) {\n    urnComponent.error = 'URN can not be parsed'\n    return urnComponent\n  }\n  const matches = urnComponent.path.match(URN_REG)\n  if (matches) {\n    const scheme = options.scheme || urnComponent.scheme || 'urn'\n    urnComponent.nid = matches[1].toLowerCase()\n    urnComponent.nss = matches[2]\n    const urnScheme = `${scheme}:${options.nid || urnComponent.nid}`\n    const schemeHandler = getSchemeHandler(urnScheme)\n    urnComponent.path = undefined\n\n    if (schemeHandler) {\n      urnComponent = schemeHandler.parse(urnComponent, options)\n    }\n  } else {\n    urnComponent.error = urnComponent.error || 'URN can not be parsed.'\n  }\n\n  return urnComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnSerialize (urnComponent, options) {\n  if (urnComponent.nid === undefined) {\n    throw new Error('URN without nid cannot be serialized')\n  }\n  const scheme = options.scheme || urnComponent.scheme || 'urn'\n  const nid = urnComponent.nid.toLowerCase()\n  const urnScheme = `${scheme}:${options.nid || nid}`\n  const schemeHandler = getSchemeHandler(urnScheme)\n\n  if (schemeHandler) {\n    urnComponent = schemeHandler.serialize(urnComponent, options)\n  }\n\n  const uriComponent = urnComponent\n  const nss = urnComponent.nss\n  uriComponent.path = `${nid || options.nid}:${nss}`\n\n  options.skipEscape = true\n  return uriComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnuuidParse (urnComponent, options) {\n  const uuidComponent = urnComponent\n  uuidComponent.uuid = uuidComponent.nss\n  uuidComponent.nss = undefined\n\n  if (!options.tolerant && (!uuidComponent.uuid || !isUUID(uuidComponent.uuid))) {\n    uuidComponent.error = uuidComponent.error || 'UUID is not valid.'\n  }\n\n  return uuidComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnuuidSerialize (uuidComponent) {\n  const urnComponent = uuidComponent\n  // normalize UUID\n  urnComponent.nss = (uuidComponent.uuid || '').toLowerCase()\n  return urnComponent\n}\n\nconst http = /** @type {SchemeHandler} */ ({\n  scheme: 'http',\n  domainHost: true,\n  parse: httpParse,\n  serialize: httpSerialize\n})\n\nconst https = /** @type {SchemeHandler} */ ({\n  scheme: 'https',\n  domainHost: http.domainHost,\n  parse: httpParse,\n  serialize: httpSerialize\n})\n\nconst ws = /** @type {SchemeHandler} */ ({\n  scheme: 'ws',\n  domainHost: true,\n  parse: wsParse,\n  serialize: wsSerialize\n})\n\nconst wss = /** @type {SchemeHandler} */ ({\n  scheme: 'wss',\n  domainHost: ws.domainHost,\n  parse: ws.parse,\n  serialize: ws.serialize\n})\n\nconst urn = /** @type {SchemeHandler} */ ({\n  scheme: 'urn',\n  parse: urnParse,\n  serialize: urnSerialize,\n  skipNormalize: true\n})\n\nconst urnuuid = /** @type {SchemeHandler} */ ({\n  scheme: 'urn:uuid',\n  parse: urnuuidParse,\n  serialize: urnuuidSerialize,\n  skipNormalize: true\n})\n\nconst SCHEMES = /** @type {Record<SchemeName, SchemeHandler>} */ ({\n  http,\n  https,\n  ws,\n  wss,\n  urn,\n  'urn:uuid': urnuuid\n})\n\nObject.setPrototypeOf(SCHEMES, null)\n\n/**\n * @param {string|undefined} scheme\n * @returns {SchemeHandler|undefined}\n */\nfunction getSchemeHandler (scheme) {\n  return (\n    scheme && (\n      SCHEMES[/** @type {SchemeName} */ (scheme)] ||\n      SCHEMES[/** @type {SchemeName} */(scheme.toLowerCase())])\n  ) ||\n    undefined\n}\n\nmodule.exports = {\n  wsIsSecure,\n  SCHEMES,\n  isValidSchemeName,\n  getSchemeHandler,\n}\n","'use strict'\n\nconst { normalizeIPv6, removeDotSegments, recomposeAuthority, normalizeComponentEncoding, isIPv4, nonSimpleDomain } = require('./lib/utils')\nconst { SCHEMES, getSchemeHandler } = require('./lib/schemes')\n\n/**\n * @template {import('./types/index').URIComponent|string} T\n * @param {T} uri\n * @param {import('./types/index').Options} [options]\n * @returns {T}\n */\nfunction normalize (uri, options) {\n  if (typeof uri === 'string') {\n    uri = /** @type {T} */ (serialize(parse(uri, options), options))\n  } else if (typeof uri === 'object') {\n    uri = /** @type {T} */ (parse(serialize(uri, options), options))\n  }\n  return uri\n}\n\n/**\n * @param {string} baseURI\n * @param {string} relativeURI\n * @param {import('./types/index').Options} [options]\n * @returns {string}\n */\nfunction resolve (baseURI, relativeURI, options) {\n  const schemelessOptions = options ? Object.assign({ scheme: 'null' }, options) : { scheme: 'null' }\n  const resolved = resolveComponent(parse(baseURI, schemelessOptions), parse(relativeURI, schemelessOptions), schemelessOptions, true)\n  schemelessOptions.skipEscape = true\n  return serialize(resolved, schemelessOptions)\n}\n\n/**\n * @param {import ('./types/index').URIComponent} base\n * @param {import ('./types/index').URIComponent} relative\n * @param {import('./types/index').Options} [options]\n * @param {boolean} [skipNormalization=false]\n * @returns {import ('./types/index').URIComponent}\n */\nfunction resolveComponent (base, relative, options, skipNormalization) {\n  /** @type {import('./types/index').URIComponent} */\n  const target = {}\n  if (!skipNormalization) {\n    base = parse(serialize(base, options), options) // normalize base component\n    relative = parse(serialize(relative, options), options) // normalize relative component\n  }\n  options = options || {}\n\n  if (!options.tolerant && relative.scheme) {\n    target.scheme = relative.scheme\n    // target.authority = relative.authority;\n    target.userinfo = relative.userinfo\n    target.host = relative.host\n    target.port = relative.port\n    target.path = removeDotSegments(relative.path || '')\n    target.query = relative.query\n  } else {\n    if (relative.userinfo !== undefined || relative.host !== undefined || relative.port !== undefined) {\n      // target.authority = relative.authority;\n      target.userinfo = relative.userinfo\n      target.host = relative.host\n      target.port = relative.port\n      target.path = removeDotSegments(relative.path || '')\n      target.query = relative.query\n    } else {\n      if (!relative.path) {\n        target.path = base.path\n        if (relative.query !== undefined) {\n          target.query = relative.query\n        } else {\n          target.query = base.query\n        }\n      } else {\n        if (relative.path[0] === '/') {\n          target.path = removeDotSegments(relative.path)\n        } else {\n          if ((base.userinfo !== undefined || base.host !== undefined || base.port !== undefined) && !base.path) {\n            target.path = '/' + relative.path\n          } else if (!base.path) {\n            target.path = relative.path\n          } else {\n            target.path = base.path.slice(0, base.path.lastIndexOf('/') + 1) + relative.path\n          }\n          target.path = removeDotSegments(target.path)\n        }\n        target.query = relative.query\n      }\n      // target.authority = base.authority;\n      target.userinfo = base.userinfo\n      target.host = base.host\n      target.port = base.port\n    }\n    target.scheme = base.scheme\n  }\n\n  target.fragment = relative.fragment\n\n  return target\n}\n\n/**\n * @param {import ('./types/index').URIComponent|string} uriA\n * @param {import ('./types/index').URIComponent|string} uriB\n * @param {import ('./types/index').Options} options\n * @returns {boolean}\n */\nfunction equal (uriA, uriB, options) {\n  if (typeof uriA === 'string') {\n    uriA = unescape(uriA)\n    uriA = serialize(normalizeComponentEncoding(parse(uriA, options), true), { ...options, skipEscape: true })\n  } else if (typeof uriA === 'object') {\n    uriA = serialize(normalizeComponentEncoding(uriA, true), { ...options, skipEscape: true })\n  }\n\n  if (typeof uriB === 'string') {\n    uriB = unescape(uriB)\n    uriB = serialize(normalizeComponentEncoding(parse(uriB, options), true), { ...options, skipEscape: true })\n  } else if (typeof uriB === 'object') {\n    uriB = serialize(normalizeComponentEncoding(uriB, true), { ...options, skipEscape: true })\n  }\n\n  return uriA.toLowerCase() === uriB.toLowerCase()\n}\n\n/**\n * @param {Readonly<import('./types/index').URIComponent>} cmpts\n * @param {import('./types/index').Options} [opts]\n * @returns {string}\n */\nfunction serialize (cmpts, opts) {\n  const component = {\n    host: cmpts.host,\n    scheme: cmpts.scheme,\n    userinfo: cmpts.userinfo,\n    port: cmpts.port,\n    path: cmpts.path,\n    query: cmpts.query,\n    nid: cmpts.nid,\n    nss: cmpts.nss,\n    uuid: cmpts.uuid,\n    fragment: cmpts.fragment,\n    reference: cmpts.reference,\n    resourceName: cmpts.resourceName,\n    secure: cmpts.secure,\n    error: ''\n  }\n  const options = Object.assign({}, opts)\n  const uriTokens = []\n\n  // find scheme handler\n  const schemeHandler = getSchemeHandler(options.scheme || component.scheme)\n\n  // perform scheme specific serialization\n  if (schemeHandler && schemeHandler.serialize) schemeHandler.serialize(component, options)\n\n  if (component.path !== undefined) {\n    if (!options.skipEscape) {\n      component.path = escape(component.path)\n\n      if (component.scheme !== undefined) {\n        component.path = component.path.split('%3A').join(':')\n      }\n    } else {\n      component.path = unescape(component.path)\n    }\n  }\n\n  if (options.reference !== 'suffix' && component.scheme) {\n    uriTokens.push(component.scheme, ':')\n  }\n\n  const authority = recomposeAuthority(component)\n  if (authority !== undefined) {\n    if (options.reference !== 'suffix') {\n      uriTokens.push('//')\n    }\n\n    uriTokens.push(authority)\n\n    if (component.path && component.path[0] !== '/') {\n      uriTokens.push('/')\n    }\n  }\n  if (component.path !== undefined) {\n    let s = component.path\n\n    if (!options.absolutePath && (!schemeHandler || !schemeHandler.absolutePath)) {\n      s = removeDotSegments(s)\n    }\n\n    if (\n      authority === undefined &&\n      s[0] === '/' &&\n      s[1] === '/'\n    ) {\n      // don't allow the path to start with \"//\"\n      s = '/%2F' + s.slice(2)\n    }\n\n    uriTokens.push(s)\n  }\n\n  if (component.query !== undefined) {\n    uriTokens.push('?', component.query)\n  }\n\n  if (component.fragment !== undefined) {\n    uriTokens.push('#', component.fragment)\n  }\n  return uriTokens.join('')\n}\n\nconst URI_PARSE = /^(?:([^#/:?]+):)?(?:\\/\\/((?:([^#/?@]*)@)?(\\[[^#/?\\]]+\\]|[^#/:?]*)(?::(\\d*))?))?([^#?]*)(?:\\?([^#]*))?(?:#((?:.|[\\n\\r])*))?/u\n\n/**\n * @param {string} uri\n * @param {import('./types/index').Options} [opts]\n * @returns\n */\nfunction parse (uri, opts) {\n  const options = Object.assign({}, opts)\n  /** @type {import('./types/index').URIComponent} */\n  const parsed = {\n    scheme: undefined,\n    userinfo: undefined,\n    host: '',\n    port: undefined,\n    path: '',\n    query: undefined,\n    fragment: undefined\n  }\n\n  let isIP = false\n  if (options.reference === 'suffix') {\n    if (options.scheme) {\n      uri = options.scheme + ':' + uri\n    } else {\n      uri = '//' + uri\n    }\n  }\n\n  const matches = uri.match(URI_PARSE)\n\n  if (matches) {\n    // store each component\n    parsed.scheme = matches[1]\n    parsed.userinfo = matches[3]\n    parsed.host = matches[4]\n    parsed.port = parseInt(matches[5], 10)\n    parsed.path = matches[6] || ''\n    parsed.query = matches[7]\n    parsed.fragment = matches[8]\n\n    // fix port number\n    if (isNaN(parsed.port)) {\n      parsed.port = matches[5]\n    }\n    if (parsed.host) {\n      const ipv4result = isIPv4(parsed.host)\n      if (ipv4result === false) {\n        const ipv6result = normalizeIPv6(parsed.host)\n        parsed.host = ipv6result.host.toLowerCase()\n        isIP = ipv6result.isIPV6\n      } else {\n        isIP = true\n      }\n    }\n    if (parsed.scheme === undefined && parsed.userinfo === undefined && parsed.host === undefined && parsed.port === undefined && parsed.query === undefined && !parsed.path) {\n      parsed.reference = 'same-document'\n    } else if (parsed.scheme === undefined) {\n      parsed.reference = 'relative'\n    } else if (parsed.fragment === undefined) {\n      parsed.reference = 'absolute'\n    } else {\n      parsed.reference = 'uri'\n    }\n\n    // check for reference errors\n    if (options.reference && options.reference !== 'suffix' && options.reference !== parsed.reference) {\n      parsed.error = parsed.error || 'URI is not a ' + options.reference + ' reference.'\n    }\n\n    // find scheme handler\n    const schemeHandler = getSchemeHandler(options.scheme || parsed.scheme)\n\n    // check if scheme can't handle IRIs\n    if (!options.unicodeSupport && (!schemeHandler || !schemeHandler.unicodeSupport)) {\n      // if host component is a domain name\n      if (parsed.host && (options.domainHost || (schemeHandler && schemeHandler.domainHost)) && isIP === false && nonSimpleDomain(parsed.host)) {\n        // convert Unicode IDN -> ASCII IDN\n        try {\n          parsed.host = URL.domainToASCII(parsed.host.toLowerCase())\n        } catch (e) {\n          parsed.error = parsed.error || \"Host's domain name can not be converted to ASCII: \" + e\n        }\n      }\n      // convert IRI -> URI\n    }\n\n    if (!schemeHandler || (schemeHandler && !schemeHandler.skipNormalize)) {\n      if (uri.indexOf('%') !== -1) {\n        if (parsed.scheme !== undefined) {\n          parsed.scheme = unescape(parsed.scheme)\n        }\n        if (parsed.host !== undefined) {\n          parsed.host = unescape(parsed.host)\n        }\n      }\n      if (parsed.path) {\n        parsed.path = escape(unescape(parsed.path))\n      }\n      if (parsed.fragment) {\n        parsed.fragment = encodeURI(decodeURIComponent(parsed.fragment))\n      }\n    }\n\n    // perform scheme specific parsing\n    if (schemeHandler && schemeHandler.parse) {\n      schemeHandler.parse(parsed, options)\n    }\n  } else {\n    parsed.error = parsed.error || 'URI can not be parsed.'\n  }\n  return parsed\n}\n\nconst fastUri = {\n  SCHEMES,\n  normalize,\n  resolve,\n  resolveComponent,\n  equal,\n  serialize,\n  parse\n}\n\nmodule.exports = fastUri\nmodule.exports.default = fastUri\nmodule.exports.fastUri = fastUri\n","import * as uri from \"fast-uri\"\n\ntype URI = typeof uri & {code: string}\n;(uri as URI).code = 'require(\"ajv/dist/runtime/uri\").default'\n\nexport default uri as URI\n","export {\n  Format,\n  FormatDefinition,\n  AsyncFormatDefinition,\n  KeywordDefinition,\n  KeywordErrorDefinition,\n  CodeKeywordDefinition,\n  MacroKeywordDefinition,\n  FuncKeywordDefinition,\n  Vocabulary,\n  Schema,\n  SchemaObject,\n  AnySchemaObject,\n  AsyncSchema,\n  AnySchema,\n  ValidateFunction,\n  AsyncValidateFunction,\n  AnyValidateFunction,\n  ErrorObject,\n  ErrorNoParams,\n} from \"./types\"\n\nexport {SchemaCxt, SchemaObjCxt} from \"./compile\"\nexport interface Plugin<Opts> {\n  (ajv: Ajv, options?: Opts): Ajv\n  [prop: string]: any\n}\n\nexport {KeywordCxt} from \"./compile/validate\"\nexport {DefinedError} from \"./vocabularies/errors\"\nexport {JSONType} from \"./compile/rules\"\nexport {JSONSchemaType} from \"./types/json-schema\"\nexport {JTDSchemaType, SomeJTDSchemaType, JTDDataType} from \"./types/jtd-schema\"\nexport {_, str, stringify, nil, Name, Code, CodeGen, CodeGenOptions} from \"./compile/codegen\"\n\nimport type {\n  Schema,\n  AnySchema,\n  AnySchemaObject,\n  SchemaObject,\n  AsyncSchema,\n  Vocabulary,\n  KeywordDefinition,\n  AddedKeywordDefinition,\n  AnyValidateFunction,\n  ValidateFunction,\n  AsyncValidateFunction,\n  ErrorObject,\n  Format,\n  AddedFormat,\n  RegExpEngine,\n  UriResolver,\n} from \"./types\"\nimport type {JSONSchemaType} from \"./types/json-schema\"\nimport type {JTDSchemaType, SomeJTDSchemaType, JTDDataType} from \"./types/jtd-schema\"\nimport ValidationError from \"./runtime/validation_error\"\nimport MissingRefError from \"./compile/ref_error\"\nimport {getRules, ValidationRules, Rule, RuleGroup, JSONType} from \"./compile/rules\"\nimport {SchemaEnv, compileSchema, resolveSchema} from \"./compile\"\nimport {Code, ValueScope} from \"./compile/codegen\"\nimport {normalizeId, getSchemaRefs} from \"./compile/resolve\"\nimport {getJSONTypes} from \"./compile/validate/dataType\"\nimport {eachItem} from \"./compile/util\"\nimport * as $dataRefSchema from \"./refs/data.json\"\n\nimport DefaultUriResolver from \"./runtime/uri\"\n\nconst defaultRegExp: RegExpEngine = (str, flags) => new RegExp(str, flags)\ndefaultRegExp.code = \"new RegExp\"\n\nconst META_IGNORE_OPTIONS: (keyof Options)[] = [\"removeAdditional\", \"useDefaults\", \"coerceTypes\"]\nconst EXT_SCOPE_NAMES = new Set([\n  \"validate\",\n  \"serialize\",\n  \"parse\",\n  \"wrapper\",\n  \"root\",\n  \"schema\",\n  \"keyword\",\n  \"pattern\",\n  \"formats\",\n  \"validate$data\",\n  \"func\",\n  \"obj\",\n  \"Error\",\n])\n\nexport type Options = CurrentOptions & DeprecatedOptions\n\nexport interface CurrentOptions {\n  // strict mode options (NEW)\n  strict?: boolean | \"log\"\n  strictSchema?: boolean | \"log\"\n  strictNumbers?: boolean | \"log\"\n  strictTypes?: boolean | \"log\"\n  strictTuples?: boolean | \"log\"\n  strictRequired?: boolean | \"log\"\n  allowMatchingProperties?: boolean // disables a strict mode restriction\n  allowUnionTypes?: boolean\n  validateFormats?: boolean\n  // validation and reporting options:\n  $data?: boolean\n  allErrors?: boolean\n  verbose?: boolean\n  discriminator?: boolean\n  unicodeRegExp?: boolean\n  timestamp?: \"string\" | \"date\" // JTD only\n  parseDate?: boolean // JTD only\n  allowDate?: boolean // JTD only\n  specialNumbers?: \"fast\" | \"null\" // JTD only\n  $comment?:\n    | true\n    | ((comment: string, schemaPath?: string, rootSchema?: AnySchemaObject) => unknown)\n  formats?: {[Name in string]?: Format}\n  keywords?: Vocabulary\n  schemas?: AnySchema[] | {[Key in string]?: AnySchema}\n  logger?: Logger | false\n  loadSchema?: (uri: string) => Promise<AnySchemaObject>\n  // options to modify validated data:\n  removeAdditional?: boolean | \"all\" | \"failing\"\n  useDefaults?: boolean | \"empty\"\n  coerceTypes?: boolean | \"array\"\n  // advanced options:\n  next?: boolean // NEW\n  unevaluated?: boolean // NEW\n  dynamicRef?: boolean // NEW\n  schemaId?: \"id\" | \"$id\"\n  jtd?: boolean // NEW\n  meta?: SchemaObject | boolean\n  defaultMeta?: string | AnySchemaObject\n  validateSchema?: boolean | \"log\"\n  addUsedSchema?: boolean\n  inlineRefs?: boolean | number\n  passContext?: boolean\n  loopRequired?: number\n  loopEnum?: number // NEW\n  ownProperties?: boolean\n  multipleOfPrecision?: number\n  int32range?: boolean // JTD only\n  messages?: boolean\n  code?: CodeOptions // NEW\n  uriResolver?: UriResolver\n}\n\nexport interface CodeOptions {\n  es5?: boolean\n  esm?: boolean\n  lines?: boolean\n  optimize?: boolean | number\n  formats?: Code // code to require (or construct) map of available formats - for standalone code\n  source?: boolean\n  process?: (code: string, schema?: SchemaEnv) => string\n  regExp?: RegExpEngine\n}\n\ninterface InstanceCodeOptions extends CodeOptions {\n  regExp: RegExpEngine\n  optimize: number\n}\n\ninterface DeprecatedOptions {\n  /** @deprecated */\n  ignoreKeywordsWithRef?: boolean\n  /** @deprecated */\n  jsPropertySyntax?: boolean // added instead of jsonPointers\n  /** @deprecated */\n  unicode?: boolean\n}\n\ninterface RemovedOptions {\n  format?: boolean\n  errorDataPath?: \"object\" | \"property\"\n  nullable?: boolean // \"nullable\" keyword is supported by default\n  jsonPointers?: boolean\n  extendRefs?: true | \"ignore\" | \"fail\"\n  missingRefs?: true | \"ignore\" | \"fail\"\n  processCode?: (code: string, schema?: SchemaEnv) => string\n  sourceCode?: boolean\n  strictDefaults?: boolean\n  strictKeywords?: boolean\n  uniqueItems?: boolean\n  unknownFormats?: true | string[] | \"ignore\"\n  cache?: any\n  serialize?: (schema: AnySchema) => unknown\n  ajvErrors?: boolean\n}\n\ntype OptionsInfo<T extends RemovedOptions | DeprecatedOptions> = {\n  [K in keyof T]-?: string | undefined\n}\n\nconst removedOptions: OptionsInfo<RemovedOptions> = {\n  errorDataPath: \"\",\n  format: \"`validateFormats: false` can be used instead.\",\n  nullable: '\"nullable\" keyword is supported by default.',\n  jsonPointers: \"Deprecated jsPropertySyntax can be used instead.\",\n  extendRefs: \"Deprecated ignoreKeywordsWithRef can be used instead.\",\n  missingRefs: \"Pass empty schema with $id that should be ignored to ajv.addSchema.\",\n  processCode: \"Use option `code: {process: (code, schemaEnv: object) => string}`\",\n  sourceCode: \"Use option `code: {source: true}`\",\n  strictDefaults: \"It is default now, see option `strict`.\",\n  strictKeywords: \"It is default now, see option `strict`.\",\n  uniqueItems: '\"uniqueItems\" keyword is always validated.',\n  unknownFormats: \"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).\",\n  cache: \"Map is used as cache, schema object as key.\",\n  serialize: \"Map is used as cache, schema object as key.\",\n  ajvErrors: \"It is default now.\",\n}\n\nconst deprecatedOptions: OptionsInfo<DeprecatedOptions> = {\n  ignoreKeywordsWithRef: \"\",\n  jsPropertySyntax: \"\",\n  unicode: '\"minLength\"/\"maxLength\" account for unicode characters by default.',\n}\n\ntype RequiredInstanceOptions = {\n  [K in\n    | \"strictSchema\"\n    | \"strictNumbers\"\n    | \"strictTypes\"\n    | \"strictTuples\"\n    | \"strictRequired\"\n    | \"inlineRefs\"\n    | \"loopRequired\"\n    | \"loopEnum\"\n    | \"meta\"\n    | \"messages\"\n    | \"schemaId\"\n    | \"addUsedSchema\"\n    | \"validateSchema\"\n    | \"validateFormats\"\n    | \"int32range\"\n    | \"unicodeRegExp\"\n    | \"uriResolver\"]: NonNullable<Options[K]>\n} & {code: InstanceCodeOptions}\n\nexport type InstanceOptions = Options & RequiredInstanceOptions\n\nconst MAX_EXPRESSION = 200\n\n// eslint-disable-next-line complexity\nfunction requiredOptions(o: Options): RequiredInstanceOptions {\n  const s = o.strict\n  const _optz = o.code?.optimize\n  const optimize = _optz === true || _optz === undefined ? 1 : _optz || 0\n  const regExp = o.code?.regExp ?? defaultRegExp\n  const uriResolver = o.uriResolver ?? DefaultUriResolver\n  return {\n    strictSchema: o.strictSchema ?? s ?? true,\n    strictNumbers: o.strictNumbers ?? s ?? true,\n    strictTypes: o.strictTypes ?? s ?? \"log\",\n    strictTuples: o.strictTuples ?? s ?? \"log\",\n    strictRequired: o.strictRequired ?? s ?? false,\n    code: o.code ? {...o.code, optimize, regExp} : {optimize, regExp},\n    loopRequired: o.loopRequired ?? MAX_EXPRESSION,\n    loopEnum: o.loopEnum ?? MAX_EXPRESSION,\n    meta: o.meta ?? true,\n    messages: o.messages ?? true,\n    inlineRefs: o.inlineRefs ?? true,\n    schemaId: o.schemaId ?? \"$id\",\n    addUsedSchema: o.addUsedSchema ?? true,\n    validateSchema: o.validateSchema ?? true,\n    validateFormats: o.validateFormats ?? true,\n    unicodeRegExp: o.unicodeRegExp ?? true,\n    int32range: o.int32range ?? true,\n    uriResolver: uriResolver,\n  }\n}\n\nexport interface Logger {\n  log(...args: unknown[]): unknown\n  warn(...args: unknown[]): unknown\n  error(...args: unknown[]): unknown\n}\n\nexport default class Ajv {\n  opts: InstanceOptions\n  errors?: ErrorObject[] | null // errors from the last validation\n  logger: Logger\n  // shared external scope values for compiled functions\n  readonly scope: ValueScope\n  readonly schemas: {[Key in string]?: SchemaEnv} = {}\n  readonly refs: {[Ref in string]?: SchemaEnv | string} = {}\n  readonly formats: {[Name in string]?: AddedFormat} = {}\n  readonly RULES: ValidationRules\n  readonly _compilations: Set<SchemaEnv> = new Set()\n  private readonly _loading: {[Ref in string]?: Promise<AnySchemaObject>} = {}\n  private readonly _cache: Map<AnySchema, SchemaEnv> = new Map()\n  private readonly _metaOpts: InstanceOptions\n\n  static ValidationError = ValidationError\n  static MissingRefError = MissingRefError\n\n  constructor(opts: Options = {}) {\n    opts = this.opts = {...opts, ...requiredOptions(opts)}\n    const {es5, lines} = this.opts.code\n\n    this.scope = new ValueScope({scope: {}, prefixes: EXT_SCOPE_NAMES, es5, lines})\n    this.logger = getLogger(opts.logger)\n    const formatOpt = opts.validateFormats\n    opts.validateFormats = false\n\n    this.RULES = getRules()\n    checkOptions.call(this, removedOptions, opts, \"NOT SUPPORTED\")\n    checkOptions.call(this, deprecatedOptions, opts, \"DEPRECATED\", \"warn\")\n    this._metaOpts = getMetaSchemaOptions.call(this)\n\n    if (opts.formats) addInitialFormats.call(this)\n    this._addVocabularies()\n    this._addDefaultMetaSchema()\n    if (opts.keywords) addInitialKeywords.call(this, opts.keywords)\n    if (typeof opts.meta == \"object\") this.addMetaSchema(opts.meta)\n    addInitialSchemas.call(this)\n    opts.validateFormats = formatOpt\n  }\n\n  _addVocabularies(): void {\n    this.addKeyword(\"$async\")\n  }\n\n  _addDefaultMetaSchema(): void {\n    const {$data, meta, schemaId} = this.opts\n    let _dataRefSchema: SchemaObject = $dataRefSchema\n    if (schemaId === \"id\") {\n      _dataRefSchema = {...$dataRefSchema}\n      _dataRefSchema.id = _dataRefSchema.$id\n      delete _dataRefSchema.$id\n    }\n    if (meta && $data) this.addMetaSchema(_dataRefSchema, _dataRefSchema[schemaId], false)\n  }\n\n  defaultMeta(): string | AnySchemaObject | undefined {\n    const {meta, schemaId} = this.opts\n    return (this.opts.defaultMeta = typeof meta == \"object\" ? meta[schemaId] || meta : undefined)\n  }\n\n  // Validate data using schema\n  // AnySchema will be compiled and cached using schema itself as a key for Map\n  validate(schema: Schema | string, data: unknown): boolean\n  validate(schemaKeyRef: AnySchema | string, data: unknown): boolean | Promise<unknown>\n  validate<T>(schema: Schema | JSONSchemaType<T> | string, data: unknown): data is T\n  // Separated for type inference to work\n  // eslint-disable-next-line @typescript-eslint/unified-signatures\n  validate<T>(schema: JTDSchemaType<T>, data: unknown): data is T\n  // This overload is only intended for typescript inference, the first\n  // argument prevents manual type annotation from matching this overload\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  validate<N extends never, T extends SomeJTDSchemaType>(\n    schema: T,\n    data: unknown\n  ): data is JTDDataType<T>\n  // eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents\n  validate<T>(schema: AsyncSchema, data: unknown | T): Promise<T>\n  validate<T>(schemaKeyRef: AnySchema | string, data: unknown): data is T | Promise<T>\n  validate<T>(\n    schemaKeyRef: AnySchema | string, // key, ref or schema object\n    // eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents\n    data: unknown | T // to be validated\n  ): boolean | Promise<T> {\n    let v: AnyValidateFunction | undefined\n    if (typeof schemaKeyRef == \"string\") {\n      v = this.getSchema<T>(schemaKeyRef)\n      if (!v) throw new Error(`no schema with key or ref \"${schemaKeyRef}\"`)\n    } else {\n      v = this.compile<T>(schemaKeyRef)\n    }\n\n    const valid = v(data)\n    if (!(\"$async\" in v)) this.errors = v.errors\n    return valid\n  }\n\n  // Create validation function for passed schema\n  // _meta: true if schema is a meta-schema. Used internally to compile meta schemas of user-defined keywords.\n  compile<T = unknown>(schema: Schema | JSONSchemaType<T>, _meta?: boolean): ValidateFunction<T>\n  // Separated for type inference to work\n  // eslint-disable-next-line @typescript-eslint/unified-signatures\n  compile<T = unknown>(schema: JTDSchemaType<T>, _meta?: boolean): ValidateFunction<T>\n  // This overload is only intended for typescript inference, the first\n  // argument prevents manual type annotation from matching this overload\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  compile<N extends never, T extends SomeJTDSchemaType>(\n    schema: T,\n    _meta?: boolean\n  ): ValidateFunction<JTDDataType<T>>\n  compile<T = unknown>(schema: AsyncSchema, _meta?: boolean): AsyncValidateFunction<T>\n  compile<T = unknown>(schema: AnySchema, _meta?: boolean): AnyValidateFunction<T>\n  compile<T = unknown>(schema: AnySchema, _meta?: boolean): AnyValidateFunction<T> {\n    const sch = this._addSchema(schema, _meta)\n    return (sch.validate || this._compileSchemaEnv(sch)) as AnyValidateFunction<T>\n  }\n\n  // Creates validating function for passed schema with asynchronous loading of missing schemas.\n  // `loadSchema` option should be a function that accepts schema uri and returns promise that resolves with the schema.\n  // TODO allow passing schema URI\n  // meta - optional true to compile meta-schema\n  compileAsync<T = unknown>(\n    schema: SchemaObject | JSONSchemaType<T>,\n    _meta?: boolean\n  ): Promise<ValidateFunction<T>>\n  // Separated for type inference to work\n  // eslint-disable-next-line @typescript-eslint/unified-signatures\n  compileAsync<T = unknown>(schema: JTDSchemaType<T>, _meta?: boolean): Promise<ValidateFunction<T>>\n  compileAsync<T = unknown>(schema: AsyncSchema, meta?: boolean): Promise<AsyncValidateFunction<T>>\n  // eslint-disable-next-line @typescript-eslint/unified-signatures\n  compileAsync<T = unknown>(\n    schema: AnySchemaObject,\n    meta?: boolean\n  ): Promise<AnyValidateFunction<T>>\n  compileAsync<T = unknown>(\n    schema: AnySchemaObject,\n    meta?: boolean\n  ): Promise<AnyValidateFunction<T>> {\n    if (typeof this.opts.loadSchema != \"function\") {\n      throw new Error(\"options.loadSchema should be a function\")\n    }\n    const {loadSchema} = this.opts\n    return runCompileAsync.call(this, schema, meta)\n\n    async function runCompileAsync(\n      this: Ajv,\n      _schema: AnySchemaObject,\n      _meta?: boolean\n    ): Promise<AnyValidateFunction> {\n      await loadMetaSchema.call(this, _schema.$schema)\n      const sch = this._addSchema(_schema, _meta)\n      return sch.validate || _compileAsync.call(this, sch)\n    }\n\n    async function loadMetaSchema(this: Ajv, $ref?: string): Promise<void> {\n      if ($ref && !this.getSchema($ref)) {\n        await runCompileAsync.call(this, {$ref}, true)\n      }\n    }\n\n    async function _compileAsync(this: Ajv, sch: SchemaEnv): Promise<AnyValidateFunction> {\n      try {\n        return this._compileSchemaEnv(sch)\n      } catch (e) {\n        if (!(e instanceof MissingRefError)) throw e\n        checkLoaded.call(this, e)\n        await loadMissingSchema.call(this, e.missingSchema)\n        return _compileAsync.call(this, sch)\n      }\n    }\n\n    function checkLoaded(this: Ajv, {missingSchema: ref, missingRef}: MissingRefError): void {\n      if (this.refs[ref]) {\n        throw new Error(`AnySchema ${ref} is loaded but ${missingRef} cannot be resolved`)\n      }\n    }\n\n    async function loadMissingSchema(this: Ajv, ref: string): Promise<void> {\n      const _schema = await _loadSchema.call(this, ref)\n      if (!this.refs[ref]) await loadMetaSchema.call(this, _schema.$schema)\n      if (!this.refs[ref]) this.addSchema(_schema, ref, meta)\n    }\n\n    async function _loadSchema(this: Ajv, ref: string): Promise<AnySchemaObject> {\n      const p = this._loading[ref]\n      if (p) return p\n      try {\n        return await (this._loading[ref] = loadSchema(ref))\n      } finally {\n        delete this._loading[ref]\n      }\n    }\n  }\n\n  // Adds schema to the instance\n  addSchema(\n    schema: AnySchema | AnySchema[], // If array is passed, `key` will be ignored\n    key?: string, // Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.\n    _meta?: boolean, // true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.\n    _validateSchema = this.opts.validateSchema // false to skip schema validation. Used internally, option validateSchema should be used instead.\n  ): Ajv {\n    if (Array.isArray(schema)) {\n      for (const sch of schema) this.addSchema(sch, undefined, _meta, _validateSchema)\n      return this\n    }\n    let id: string | undefined\n    if (typeof schema === \"object\") {\n      const {schemaId} = this.opts\n      id = schema[schemaId]\n      if (id !== undefined && typeof id != \"string\") {\n        throw new Error(`schema ${schemaId} must be string`)\n      }\n    }\n    key = normalizeId(key || id)\n    this._checkUnique(key)\n    this.schemas[key] = this._addSchema(schema, _meta, key, _validateSchema, true)\n    return this\n  }\n\n  // Add schema that will be used to validate other schemas\n  // options in META_IGNORE_OPTIONS are alway set to false\n  addMetaSchema(\n    schema: AnySchemaObject,\n    key?: string, // schema key\n    _validateSchema = this.opts.validateSchema // false to skip schema validation, can be used to override validateSchema option for meta-schema\n  ): Ajv {\n    this.addSchema(schema, key, true, _validateSchema)\n    return this\n  }\n\n  //  Validate schema against its meta-schema\n  validateSchema(schema: AnySchema, throwOrLogError?: boolean): boolean | Promise<unknown> {\n    if (typeof schema == \"boolean\") return true\n    let $schema: string | AnySchemaObject | undefined\n    $schema = schema.$schema\n    if ($schema !== undefined && typeof $schema != \"string\") {\n      throw new Error(\"$schema must be a string\")\n    }\n    $schema = $schema || this.opts.defaultMeta || this.defaultMeta()\n    if (!$schema) {\n      this.logger.warn(\"meta-schema not available\")\n      this.errors = null\n      return true\n    }\n    const valid = this.validate($schema, schema)\n    if (!valid && throwOrLogError) {\n      const message = \"schema is invalid: \" + this.errorsText()\n      if (this.opts.validateSchema === \"log\") this.logger.error(message)\n      else throw new Error(message)\n    }\n    return valid\n  }\n\n  // Get compiled schema by `key` or `ref`.\n  // (`key` that was passed to `addSchema` or full schema reference - `schema.$id` or resolved id)\n  getSchema<T = unknown>(keyRef: string): AnyValidateFunction<T> | undefined {\n    let sch\n    while (typeof (sch = getSchEnv.call(this, keyRef)) == \"string\") keyRef = sch\n    if (sch === undefined) {\n      const {schemaId} = this.opts\n      const root = new SchemaEnv({schema: {}, schemaId})\n      sch = resolveSchema.call(this, root, keyRef)\n      if (!sch) return\n      this.refs[keyRef] = sch\n    }\n    return (sch.validate || this._compileSchemaEnv(sch)) as AnyValidateFunction<T> | undefined\n  }\n\n  // Remove cached schema(s).\n  // If no parameter is passed all schemas but meta-schemas are removed.\n  // If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.\n  // Even if schema is referenced by other schemas it still can be removed as other schemas have local references.\n  removeSchema(schemaKeyRef?: AnySchema | string | RegExp): Ajv {\n    if (schemaKeyRef instanceof RegExp) {\n      this._removeAllSchemas(this.schemas, schemaKeyRef)\n      this._removeAllSchemas(this.refs, schemaKeyRef)\n      return this\n    }\n    switch (typeof schemaKeyRef) {\n      case \"undefined\":\n        this._removeAllSchemas(this.schemas)\n        this._removeAllSchemas(this.refs)\n        this._cache.clear()\n        return this\n      case \"string\": {\n        const sch = getSchEnv.call(this, schemaKeyRef)\n        if (typeof sch == \"object\") this._cache.delete(sch.schema)\n        delete this.schemas[schemaKeyRef]\n        delete this.refs[schemaKeyRef]\n        return this\n      }\n      case \"object\": {\n        const cacheKey = schemaKeyRef\n        this._cache.delete(cacheKey)\n        let id = schemaKeyRef[this.opts.schemaId]\n        if (id) {\n          id = normalizeId(id)\n          delete this.schemas[id]\n          delete this.refs[id]\n        }\n        return this\n      }\n      default:\n        throw new Error(\"ajv.removeSchema: invalid parameter\")\n    }\n  }\n\n  // add \"vocabulary\" - a collection of keywords\n  addVocabulary(definitions: Vocabulary): Ajv {\n    for (const def of definitions) this.addKeyword(def)\n    return this\n  }\n\n  addKeyword(\n    kwdOrDef: string | KeywordDefinition,\n    def?: KeywordDefinition // deprecated\n  ): Ajv {\n    let keyword: string | string[]\n    if (typeof kwdOrDef == \"string\") {\n      keyword = kwdOrDef\n      if (typeof def == \"object\") {\n        this.logger.warn(\"these parameters are deprecated, see docs for addKeyword\")\n        def.keyword = keyword\n      }\n    } else if (typeof kwdOrDef == \"object\" && def === undefined) {\n      def = kwdOrDef\n      keyword = def.keyword\n      if (Array.isArray(keyword) && !keyword.length) {\n        throw new Error(\"addKeywords: keyword must be string or non-empty array\")\n      }\n    } else {\n      throw new Error(\"invalid addKeywords parameters\")\n    }\n\n    checkKeyword.call(this, keyword, def)\n    if (!def) {\n      eachItem(keyword, (kwd) => addRule.call(this, kwd))\n      return this\n    }\n    keywordMetaschema.call(this, def)\n    const definition: AddedKeywordDefinition = {\n      ...def,\n      type: getJSONTypes(def.type),\n      schemaType: getJSONTypes(def.schemaType),\n    }\n    eachItem(\n      keyword,\n      definition.type.length === 0\n        ? (k) => addRule.call(this, k, definition)\n        : (k) => definition.type.forEach((t) => addRule.call(this, k, definition, t))\n    )\n    return this\n  }\n\n  getKeyword(keyword: string): AddedKeywordDefinition | boolean {\n    const rule = this.RULES.all[keyword]\n    return typeof rule == \"object\" ? rule.definition : !!rule\n  }\n\n  // Remove keyword\n  removeKeyword(keyword: string): Ajv {\n    // TODO return type should be Ajv\n    const {RULES} = this\n    delete RULES.keywords[keyword]\n    delete RULES.all[keyword]\n    for (const group of RULES.rules) {\n      const i = group.rules.findIndex((rule) => rule.keyword === keyword)\n      if (i >= 0) group.rules.splice(i, 1)\n    }\n    return this\n  }\n\n  // Add format\n  addFormat(name: string, format: Format): Ajv {\n    if (typeof format == \"string\") format = new RegExp(format)\n    this.formats[name] = format\n    return this\n  }\n\n  errorsText(\n    errors: ErrorObject[] | null | undefined = this.errors, // optional array of validation errors\n    {separator = \", \", dataVar = \"data\"}: ErrorsTextOptions = {} // optional options with properties `separator` and `dataVar`\n  ): string {\n    if (!errors || errors.length === 0) return \"No errors\"\n    return errors\n      .map((e) => `${dataVar}${e.instancePath} ${e.message}`)\n      .reduce((text, msg) => text + separator + msg)\n  }\n\n  $dataMetaSchema(metaSchema: AnySchemaObject, keywordsJsonPointers: string[]): AnySchemaObject {\n    const rules = this.RULES.all\n    metaSchema = JSON.parse(JSON.stringify(metaSchema))\n    for (const jsonPointer of keywordsJsonPointers) {\n      const segments = jsonPointer.split(\"/\").slice(1) // first segment is an empty string\n      let keywords = metaSchema\n      for (const seg of segments) keywords = keywords[seg] as AnySchemaObject\n\n      for (const key in rules) {\n        const rule = rules[key]\n        if (typeof rule != \"object\") continue\n        const {$data} = rule.definition\n        const schema = keywords[key] as AnySchemaObject | undefined\n        if ($data && schema) keywords[key] = schemaOrData(schema)\n      }\n    }\n\n    return metaSchema\n  }\n\n  private _removeAllSchemas(schemas: {[Ref in string]?: SchemaEnv | string}, regex?: RegExp): void {\n    for (const keyRef in schemas) {\n      const sch = schemas[keyRef]\n      if (!regex || regex.test(keyRef)) {\n        if (typeof sch == \"string\") {\n          delete schemas[keyRef]\n        } else if (sch && !sch.meta) {\n          this._cache.delete(sch.schema)\n          delete schemas[keyRef]\n        }\n      }\n    }\n  }\n\n  _addSchema(\n    schema: AnySchema,\n    meta?: boolean,\n    baseId?: string,\n    validateSchema = this.opts.validateSchema,\n    addSchema = this.opts.addUsedSchema\n  ): SchemaEnv {\n    let id: string | undefined\n    const {schemaId} = this.opts\n    if (typeof schema == \"object\") {\n      id = schema[schemaId]\n    } else {\n      if (this.opts.jtd) throw new Error(\"schema must be object\")\n      else if (typeof schema != \"boolean\") throw new Error(\"schema must be object or boolean\")\n    }\n    let sch = this._cache.get(schema)\n    if (sch !== undefined) return sch\n\n    baseId = normalizeId(id || baseId)\n    const localRefs = getSchemaRefs.call(this, schema, baseId)\n    sch = new SchemaEnv({schema, schemaId, meta, baseId, localRefs})\n    this._cache.set(sch.schema, sch)\n    if (addSchema && !baseId.startsWith(\"#\")) {\n      // TODO atm it is allowed to overwrite schemas without id (instead of not adding them)\n      if (baseId) this._checkUnique(baseId)\n      this.refs[baseId] = sch\n    }\n    if (validateSchema) this.validateSchema(schema, true)\n    return sch\n  }\n\n  private _checkUnique(id: string): void {\n    if (this.schemas[id] || this.refs[id]) {\n      throw new Error(`schema with key or id \"${id}\" already exists`)\n    }\n  }\n\n  private _compileSchemaEnv(sch: SchemaEnv): AnyValidateFunction {\n    if (sch.meta) this._compileMetaSchema(sch)\n    else compileSchema.call(this, sch)\n\n    /* istanbul ignore if */\n    if (!sch.validate) throw new Error(\"ajv implementation error\")\n    return sch.validate\n  }\n\n  private _compileMetaSchema(sch: SchemaEnv): void {\n    const currentOpts = this.opts\n    this.opts = this._metaOpts\n    try {\n      compileSchema.call(this, sch)\n    } finally {\n      this.opts = currentOpts\n    }\n  }\n}\n\nexport interface ErrorsTextOptions {\n  separator?: string\n  dataVar?: string\n}\n\nfunction checkOptions(\n  this: Ajv,\n  checkOpts: OptionsInfo<RemovedOptions | DeprecatedOptions>,\n  options: Options & RemovedOptions,\n  msg: string,\n  log: \"warn\" | \"error\" = \"error\"\n): void {\n  for (const key in checkOpts) {\n    const opt = key as keyof typeof checkOpts\n    if (opt in options) this.logger[log](`${msg}: option ${key}. ${checkOpts[opt]}`)\n  }\n}\n\nfunction getSchEnv(this: Ajv, keyRef: string): SchemaEnv | string | undefined {\n  keyRef = normalizeId(keyRef) // TODO tests fail without this line\n  return this.schemas[keyRef] || this.refs[keyRef]\n}\n\nfunction addInitialSchemas(this: Ajv): void {\n  const optsSchemas = this.opts.schemas\n  if (!optsSchemas) return\n  if (Array.isArray(optsSchemas)) this.addSchema(optsSchemas)\n  else for (const key in optsSchemas) this.addSchema(optsSchemas[key] as AnySchema, key)\n}\n\nfunction addInitialFormats(this: Ajv): void {\n  for (const name in this.opts.formats) {\n    const format = this.opts.formats[name]\n    if (format) this.addFormat(name, format)\n  }\n}\n\nfunction addInitialKeywords(\n  this: Ajv,\n  defs: Vocabulary | {[K in string]?: KeywordDefinition}\n): void {\n  if (Array.isArray(defs)) {\n    this.addVocabulary(defs)\n    return\n  }\n  this.logger.warn(\"keywords option as map is deprecated, pass array\")\n  for (const keyword in defs) {\n    const def = defs[keyword] as KeywordDefinition\n    if (!def.keyword) def.keyword = keyword\n    this.addKeyword(def)\n  }\n}\n\nfunction getMetaSchemaOptions(this: Ajv): InstanceOptions {\n  const metaOpts = {...this.opts}\n  for (const opt of META_IGNORE_OPTIONS) delete metaOpts[opt]\n  return metaOpts\n}\n\nconst noLogs = {log() {}, warn() {}, error() {}}\n\nfunction getLogger(logger?: Partial<Logger> | false): Logger {\n  if (logger === false) return noLogs\n  if (logger === undefined) return console\n  if (logger.log && logger.warn && logger.error) return logger as Logger\n  throw new Error(\"logger must implement log, warn and error methods\")\n}\n\nconst KEYWORD_NAME = /^[a-z_$][a-z0-9_$:-]*$/i\n\nfunction checkKeyword(this: Ajv, keyword: string | string[], def?: KeywordDefinition): void {\n  const {RULES} = this\n  eachItem(keyword, (kwd) => {\n    if (RULES.keywords[kwd]) throw new Error(`Keyword ${kwd} is already defined`)\n    if (!KEYWORD_NAME.test(kwd)) throw new Error(`Keyword ${kwd} has invalid name`)\n  })\n  if (!def) return\n  if (def.$data && !(\"code\" in def || \"validate\" in def)) {\n    throw new Error('$data keyword must have \"code\" or \"validate\" function')\n  }\n}\n\nfunction addRule(\n  this: Ajv,\n  keyword: string,\n  definition?: AddedKeywordDefinition,\n  dataType?: JSONType\n): void {\n  const post = definition?.post\n  if (dataType && post) throw new Error('keyword with \"post\" flag cannot have \"type\"')\n  const {RULES} = this\n  let ruleGroup = post ? RULES.post : RULES.rules.find(({type: t}) => t === dataType)\n  if (!ruleGroup) {\n    ruleGroup = {type: dataType, rules: []}\n    RULES.rules.push(ruleGroup)\n  }\n  RULES.keywords[keyword] = true\n  if (!definition) return\n\n  const rule: Rule = {\n    keyword,\n    definition: {\n      ...definition,\n      type: getJSONTypes(definition.type),\n      schemaType: getJSONTypes(definition.schemaType),\n    },\n  }\n  if (definition.before) addBeforeRule.call(this, ruleGroup, rule, definition.before)\n  else ruleGroup.rules.push(rule)\n  RULES.all[keyword] = rule\n  definition.implements?.forEach((kwd) => this.addKeyword(kwd))\n}\n\nfunction addBeforeRule(this: Ajv, ruleGroup: RuleGroup, rule: Rule, before: string): void {\n  const i = ruleGroup.rules.findIndex((_rule) => _rule.keyword === before)\n  if (i >= 0) {\n    ruleGroup.rules.splice(i, 0, rule)\n  } else {\n    ruleGroup.rules.push(rule)\n    this.logger.warn(`rule ${before} is not defined`)\n  }\n}\n\nfunction keywordMetaschema(this: Ajv, def: KeywordDefinition): void {\n  let {metaSchema} = def\n  if (metaSchema === undefined) return\n  if (def.$data && this.opts.$data) metaSchema = schemaOrData(metaSchema)\n  def.validateSchema = this.compile(metaSchema, true)\n}\n\nconst $dataRef = {\n  $ref: \"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#\",\n}\n\nfunction schemaOrData(schema: AnySchema): AnySchemaObject {\n  return {anyOf: [schema, $dataRef]}\n}\n","import type {CodeKeywordDefinition} from \"../../types\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"id\",\n  code() {\n    throw new Error('NOT SUPPORTED: keyword \"id\", use \"$id\" for schema ID')\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, AnySchema} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport MissingRefError from \"../../compile/ref_error\"\nimport {callValidateCode} from \"../code\"\nimport {_, nil, stringify, Code, Name} from \"../../compile/codegen\"\nimport N from \"../../compile/names\"\nimport {SchemaEnv, resolveRef} from \"../../compile\"\nimport {mergeEvaluated} from \"../../compile/util\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"$ref\",\n  schemaType: \"string\",\n  code(cxt: KeywordCxt): void {\n    const {gen, schema: $ref, it} = cxt\n    const {baseId, schemaEnv: env, validateName, opts, self} = it\n    const {root} = env\n    if (($ref === \"#\" || $ref === \"#/\") && baseId === root.baseId) return callRootRef()\n    const schOrEnv = resolveRef.call(self, root, baseId, $ref)\n    if (schOrEnv === undefined) throw new MissingRefError(it.opts.uriResolver, baseId, $ref)\n    if (schOrEnv instanceof SchemaEnv) return callValidate(schOrEnv)\n    return inlineRefSchema(schOrEnv)\n\n    function callRootRef(): void {\n      if (env === root) return callRef(cxt, validateName, env, env.$async)\n      const rootName = gen.scopeValue(\"root\", {ref: root})\n      return callRef(cxt, _`${rootName}.validate`, root, root.$async)\n    }\n\n    function callValidate(sch: SchemaEnv): void {\n      const v = getValidate(cxt, sch)\n      callRef(cxt, v, sch, sch.$async)\n    }\n\n    function inlineRefSchema(sch: AnySchema): void {\n      const schName = gen.scopeValue(\n        \"schema\",\n        opts.code.source === true ? {ref: sch, code: stringify(sch)} : {ref: sch}\n      )\n      const valid = gen.name(\"valid\")\n      const schCxt = cxt.subschema(\n        {\n          schema: sch,\n          dataTypes: [],\n          schemaPath: nil,\n          topSchemaRef: schName,\n          errSchemaPath: $ref,\n        },\n        valid\n      )\n      cxt.mergeEvaluated(schCxt)\n      cxt.ok(valid)\n    }\n  },\n}\n\nexport function getValidate(cxt: KeywordCxt, sch: SchemaEnv): Code {\n  const {gen} = cxt\n  return sch.validate\n    ? gen.scopeValue(\"validate\", {ref: sch.validate})\n    : _`${gen.scopeValue(\"wrapper\", {ref: sch})}.validate`\n}\n\nexport function callRef(cxt: KeywordCxt, v: Code, sch?: SchemaEnv, $async?: boolean): void {\n  const {gen, it} = cxt\n  const {allErrors, schemaEnv: env, opts} = it\n  const passCxt = opts.passContext ? N.this : nil\n  if ($async) callAsyncRef()\n  else callSyncRef()\n\n  function callAsyncRef(): void {\n    if (!env.$async) throw new Error(\"async schema referenced by sync schema\")\n    const valid = gen.let(\"valid\")\n    gen.try(\n      () => {\n        gen.code(_`await ${callValidateCode(cxt, v, passCxt)}`)\n        addEvaluatedFrom(v) // TODO will not work with async, it has to be returned with the result\n        if (!allErrors) gen.assign(valid, true)\n      },\n      (e) => {\n        gen.if(_`!(${e} instanceof ${it.ValidationError as Name})`, () => gen.throw(e))\n        addErrorsFrom(e)\n        if (!allErrors) gen.assign(valid, false)\n      }\n    )\n    cxt.ok(valid)\n  }\n\n  function callSyncRef(): void {\n    cxt.result(\n      callValidateCode(cxt, v, passCxt),\n      () => addEvaluatedFrom(v),\n      () => addErrorsFrom(v)\n    )\n  }\n\n  function addErrorsFrom(source: Code): void {\n    const errs = _`${source}.errors`\n    gen.assign(N.vErrors, _`${N.vErrors} === null ? ${errs} : ${N.vErrors}.concat(${errs})`) // TODO tagged\n    gen.assign(N.errors, _`${N.vErrors}.length`)\n  }\n\n  function addEvaluatedFrom(source: Code): void {\n    if (!it.opts.unevaluated) return\n    const schEvaluated = sch?.validate?.evaluated\n    // TODO refactor\n    if (it.props !== true) {\n      if (schEvaluated && !schEvaluated.dynamicProps) {\n        if (schEvaluated.props !== undefined) {\n          it.props = mergeEvaluated.props(gen, schEvaluated.props, it.props)\n        }\n      } else {\n        const props = gen.var(\"props\", _`${source}.evaluated.props`)\n        it.props = mergeEvaluated.props(gen, props, it.props, Name)\n      }\n    }\n    if (it.items !== true) {\n      if (schEvaluated && !schEvaluated.dynamicItems) {\n        if (schEvaluated.items !== undefined) {\n          it.items = mergeEvaluated.items(gen, schEvaluated.items, it.items)\n        }\n      } else {\n        const items = gen.var(\"items\", _`${source}.evaluated.items`)\n        it.items = mergeEvaluated.items(gen, items, it.items, Name)\n      }\n    }\n  }\n}\n\nexport default def\n","import type {Vocabulary} from \"../../types\"\nimport idKeyword from \"./id\"\nimport refKeyword from \"./ref\"\n\nconst core: Vocabulary = [\n  \"$schema\",\n  \"$id\",\n  \"$defs\",\n  \"$vocabulary\",\n  {keyword: \"$comment\"},\n  \"definitions\",\n  idKeyword,\n  refKeyword,\n]\n\nexport default core\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, operators, Code} from \"../../compile/codegen\"\n\nconst ops = operators\n\ntype Kwd = \"maximum\" | \"minimum\" | \"exclusiveMaximum\" | \"exclusiveMinimum\"\n\ntype Comparison = \"<=\" | \">=\" | \"<\" | \">\"\n\nconst KWDs: {[K in Kwd]: {okStr: Comparison; ok: Code; fail: Code}} = {\n  maximum: {okStr: \"<=\", ok: ops.LTE, fail: ops.GT},\n  minimum: {okStr: \">=\", ok: ops.GTE, fail: ops.LT},\n  exclusiveMaximum: {okStr: \"<\", ok: ops.LT, fail: ops.GTE},\n  exclusiveMinimum: {okStr: \">\", ok: ops.GT, fail: ops.LTE},\n}\n\nexport type LimitNumberError = ErrorObject<\n  Kwd,\n  {limit: number; comparison: Comparison},\n  number | {$data: string}\n>\n\nconst error: KeywordErrorDefinition = {\n  message: ({keyword, schemaCode}) => str`must be ${KWDs[keyword as Kwd].okStr} ${schemaCode}`,\n  params: ({keyword, schemaCode}) =>\n    _`{comparison: ${KWDs[keyword as Kwd].okStr}, limit: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: Object.keys(KWDs),\n  type: \"number\",\n  schemaType: \"number\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {keyword, data, schemaCode} = cxt\n    cxt.fail$data(_`${data} ${KWDs[keyword as Kwd].fail} ${schemaCode} || isNaN(${data})`)\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str} from \"../../compile/codegen\"\n\nexport type MultipleOfError = ErrorObject<\n  \"multipleOf\",\n  {multipleOf: number},\n  number | {$data: string}\n>\n\nconst error: KeywordErrorDefinition = {\n  message: ({schemaCode}) => str`must be multiple of ${schemaCode}`,\n  params: ({schemaCode}) => _`{multipleOf: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"multipleOf\",\n  type: \"number\",\n  schemaType: \"number\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, data, schemaCode, it} = cxt\n    // const bdt = bad$DataType(schemaCode, <string>def.schemaType, $data)\n    const prec = it.opts.multipleOfPrecision\n    const res = gen.let(\"res\")\n    const invalid = prec\n      ? _`Math.abs(Math.round(${res}) - ${res}) > 1e-${prec}`\n      : _`${res} !== parseInt(${res})`\n    cxt.fail$data(_`(${schemaCode} === 0 || (${res} = ${data}/${schemaCode}, ${invalid}))`)\n  },\n}\n\nexport default def\n","// https://mathiasbynens.be/notes/javascript-encoding\n// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode\nexport default function ucs2length(str: string): number {\n  const len = str.length\n  let length = 0\n  let pos = 0\n  let value: number\n  while (pos < len) {\n    length++\n    value = str.charCodeAt(pos++)\n    if (value >= 0xd800 && value <= 0xdbff && pos < len) {\n      // high surrogate, and there is a next character\n      value = str.charCodeAt(pos)\n      if ((value & 0xfc00) === 0xdc00) pos++ // low surrogate\n    }\n  }\n  return length\n}\n\nucs2length.code = 'require(\"ajv/dist/runtime/ucs2length\").default'\n","import type {CodeKeywordDefinition, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, operators} from \"../../compile/codegen\"\nimport {useFunc} from \"../../compile/util\"\nimport ucs2length from \"../../runtime/ucs2length\"\n\nconst error: KeywordErrorDefinition = {\n  message({keyword, schemaCode}) {\n    const comp = keyword === \"maxLength\" ? \"more\" : \"fewer\"\n    return str`must NOT have ${comp} than ${schemaCode} characters`\n  },\n  params: ({schemaCode}) => _`{limit: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: [\"maxLength\", \"minLength\"],\n  type: \"string\",\n  schemaType: \"number\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {keyword, data, schemaCode, it} = cxt\n    const op = keyword === \"maxLength\" ? operators.GT : operators.LT\n    const len =\n      it.opts.unicode === false ? _`${data}.length` : _`${useFunc(cxt.gen, ucs2length)}(${data})`\n    cxt.fail$data(_`${len} ${op} ${schemaCode}`)\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {usePattern} from \"../code\"\nimport {useFunc} from \"../../compile/util\"\nimport {_, str} from \"../../compile/codegen\"\n\nexport type PatternError = ErrorObject<\"pattern\", {pattern: string}, string | {$data: string}>\n\nconst error: KeywordErrorDefinition = {\n  message: ({schemaCode}) => str`must match pattern \"${schemaCode}\"`,\n  params: ({schemaCode}) => _`{pattern: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"pattern\",\n  type: \"string\",\n  schemaType: \"string\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, data, $data, schema, schemaCode, it} = cxt\n    const u = it.opts.unicodeRegExp ? \"u\" : \"\"\n    if ($data) {\n      const {regExp} = it.opts.code\n      const regExpCode = regExp.code === \"new RegExp\" ? _`new RegExp` : useFunc(gen, regExp)\n      const valid = gen.let(\"valid\")\n      gen.try(\n        () => gen.assign(valid, _`${regExpCode}(${schemaCode}, ${u}).test(${data})`),\n        () => gen.assign(valid, false)\n      )\n      cxt.fail$data(_`!${valid}`)\n    } else {\n      const regExp = usePattern(cxt, schema)\n      cxt.fail$data(_`!${regExp}.test(${data})`)\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, operators} from \"../../compile/codegen\"\n\nconst error: KeywordErrorDefinition = {\n  message({keyword, schemaCode}) {\n    const comp = keyword === \"maxProperties\" ? \"more\" : \"fewer\"\n    return str`must NOT have ${comp} than ${schemaCode} properties`\n  },\n  params: ({schemaCode}) => _`{limit: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: [\"maxProperties\", \"minProperties\"],\n  type: \"object\",\n  schemaType: \"number\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {keyword, data, schemaCode} = cxt\n    const op = keyword === \"maxProperties\" ? operators.GT : operators.LT\n    cxt.fail$data(_`Object.keys(${data}).length ${op} ${schemaCode}`)\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {\n  checkReportMissingProp,\n  checkMissingProp,\n  reportMissingProp,\n  propertyInData,\n  noPropertyInData,\n} from \"../code\"\nimport {_, str, nil, not, Name, Code} from \"../../compile/codegen\"\nimport {checkStrictMode} from \"../../compile/util\"\n\nexport type RequiredError = ErrorObject<\n  \"required\",\n  {missingProperty: string},\n  string[] | {$data: string}\n>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params: {missingProperty}}) => str`must have required property '${missingProperty}'`,\n  params: ({params: {missingProperty}}) => _`{missingProperty: ${missingProperty}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"required\",\n  type: \"object\",\n  schemaType: \"array\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, schema, schemaCode, data, $data, it} = cxt\n    const {opts} = it\n    if (!$data && schema.length === 0) return\n    const useLoop = schema.length >= opts.loopRequired\n    if (it.allErrors) allErrorsMode()\n    else exitOnErrorMode()\n\n    if (opts.strictRequired) {\n      const props = cxt.parentSchema.properties\n      const {definedProperties} = cxt.it\n      for (const requiredKey of schema) {\n        if (props?.[requiredKey] === undefined && !definedProperties.has(requiredKey)) {\n          const schemaPath = it.schemaEnv.baseId + it.errSchemaPath\n          const msg = `required property \"${requiredKey}\" is not defined at \"${schemaPath}\" (strictRequired)`\n          checkStrictMode(it, msg, it.opts.strictRequired)\n        }\n      }\n    }\n\n    function allErrorsMode(): void {\n      if (useLoop || $data) {\n        cxt.block$data(nil, loopAllRequired)\n      } else {\n        for (const prop of schema) {\n          checkReportMissingProp(cxt, prop)\n        }\n      }\n    }\n\n    function exitOnErrorMode(): void {\n      const missing = gen.let(\"missing\")\n      if (useLoop || $data) {\n        const valid = gen.let(\"valid\", true)\n        cxt.block$data(valid, () => loopUntilMissing(missing, valid))\n        cxt.ok(valid)\n      } else {\n        gen.if(checkMissingProp(cxt, schema, missing))\n        reportMissingProp(cxt, missing)\n        gen.else()\n      }\n    }\n\n    function loopAllRequired(): void {\n      gen.forOf(\"prop\", schemaCode as Code, (prop) => {\n        cxt.setParams({missingProperty: prop})\n        gen.if(noPropertyInData(gen, data, prop, opts.ownProperties), () => cxt.error())\n      })\n    }\n\n    function loopUntilMissing(missing: Name, valid: Name): void {\n      cxt.setParams({missingProperty: missing})\n      gen.forOf(\n        missing,\n        schemaCode as Code,\n        () => {\n          gen.assign(valid, propertyInData(gen, data, missing, opts.ownProperties))\n          gen.if(not(valid), () => {\n            cxt.error()\n            gen.break()\n          })\n        },\n        nil\n      )\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, operators} from \"../../compile/codegen\"\n\nconst error: KeywordErrorDefinition = {\n  message({keyword, schemaCode}) {\n    const comp = keyword === \"maxItems\" ? \"more\" : \"fewer\"\n    return str`must NOT have ${comp} than ${schemaCode} items`\n  },\n  params: ({schemaCode}) => _`{limit: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: [\"maxItems\", \"minItems\"],\n  type: \"array\",\n  schemaType: \"number\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {keyword, data, schemaCode} = cxt\n    const op = keyword === \"maxItems\" ? operators.GT : operators.LT\n    cxt.fail$data(_`${data}.length ${op} ${schemaCode}`)\n  },\n}\n\nexport default def\n","// https://github.com/ajv-validator/ajv/issues/889\nimport * as equal from \"fast-deep-equal\"\n\ntype Equal = typeof equal & {code: string}\n;(equal as Equal).code = 'require(\"ajv/dist/runtime/equal\").default'\n\nexport default equal as Equal\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {checkDataTypes, getSchemaTypes, DataType} from \"../../compile/validate/dataType\"\nimport {_, str, Name} from \"../../compile/codegen\"\nimport {useFunc} from \"../../compile/util\"\nimport equal from \"../../runtime/equal\"\n\nexport type UniqueItemsError = ErrorObject<\n  \"uniqueItems\",\n  {i: number; j: number},\n  boolean | {$data: string}\n>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params: {i, j}}) =>\n    str`must NOT have duplicate items (items ## ${j} and ${i} are identical)`,\n  params: ({params: {i, j}}) => _`{i: ${i}, j: ${j}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"uniqueItems\",\n  type: \"array\",\n  schemaType: \"boolean\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, data, $data, schema, parentSchema, schemaCode, it} = cxt\n    if (!$data && !schema) return\n    const valid = gen.let(\"valid\")\n    const itemTypes = parentSchema.items ? getSchemaTypes(parentSchema.items) : []\n    cxt.block$data(valid, validateUniqueItems, _`${schemaCode} === false`)\n    cxt.ok(valid)\n\n    function validateUniqueItems(): void {\n      const i = gen.let(\"i\", _`${data}.length`)\n      const j = gen.let(\"j\")\n      cxt.setParams({i, j})\n      gen.assign(valid, true)\n      gen.if(_`${i} > 1`, () => (canOptimize() ? loopN : loopN2)(i, j))\n    }\n\n    function canOptimize(): boolean {\n      return itemTypes.length > 0 && !itemTypes.some((t) => t === \"object\" || t === \"array\")\n    }\n\n    function loopN(i: Name, j: Name): void {\n      const item = gen.name(\"item\")\n      const wrongType = checkDataTypes(itemTypes, item, it.opts.strictNumbers, DataType.Wrong)\n      const indices = gen.const(\"indices\", _`{}`)\n      gen.for(_`;${i}--;`, () => {\n        gen.let(item, _`${data}[${i}]`)\n        gen.if(wrongType, _`continue`)\n        if (itemTypes.length > 1) gen.if(_`typeof ${item} == \"string\"`, _`${item} += \"_\"`)\n        gen\n          .if(_`typeof ${indices}[${item}] == \"number\"`, () => {\n            gen.assign(j, _`${indices}[${item}]`)\n            cxt.error()\n            gen.assign(valid, false).break()\n          })\n          .code(_`${indices}[${item}] = ${i}`)\n      })\n    }\n\n    function loopN2(i: Name, j: Name): void {\n      const eql = useFunc(gen, equal)\n      const outer = gen.name(\"outer\")\n      gen.label(outer).for(_`;${i}--;`, () =>\n        gen.for(_`${j} = ${i}; ${j}--;`, () =>\n          gen.if(_`${eql}(${data}[${i}], ${data}[${j}])`, () => {\n            cxt.error()\n            gen.assign(valid, false).break(outer)\n          })\n        )\n      )\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_} from \"../../compile/codegen\"\nimport {useFunc} from \"../../compile/util\"\nimport equal from \"../../runtime/equal\"\n\nexport type ConstError = ErrorObject<\"const\", {allowedValue: any}>\n\nconst error: KeywordErrorDefinition = {\n  message: \"must be equal to constant\",\n  params: ({schemaCode}) => _`{allowedValue: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"const\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, data, $data, schemaCode, schema} = cxt\n    if ($data || (schema && typeof schema == \"object\")) {\n      cxt.fail$data(_`!${useFunc(gen, equal)}(${data}, ${schemaCode})`)\n    } else {\n      cxt.fail(_`${schema} !== ${data}`)\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, or, Name, Code} from \"../../compile/codegen\"\nimport {useFunc} from \"../../compile/util\"\nimport equal from \"../../runtime/equal\"\n\nexport type EnumError = ErrorObject<\"enum\", {allowedValues: any[]}, any[] | {$data: string}>\n\nconst error: KeywordErrorDefinition = {\n  message: \"must be equal to one of the allowed values\",\n  params: ({schemaCode}) => _`{allowedValues: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"enum\",\n  schemaType: \"array\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, data, $data, schema, schemaCode, it} = cxt\n    if (!$data && schema.length === 0) throw new Error(\"enum must have non-empty array\")\n    const useLoop = schema.length >= it.opts.loopEnum\n    let eql: Name | undefined\n    const getEql = (): Name => (eql ??= useFunc(gen, equal))\n\n    let valid: Code\n    if (useLoop || $data) {\n      valid = gen.let(\"valid\")\n      cxt.block$data(valid, loopEnum)\n    } else {\n      /* istanbul ignore if */\n      if (!Array.isArray(schema)) throw new Error(\"ajv implementation error\")\n      const vSchema = gen.const(\"vSchema\", schemaCode)\n      valid = or(...schema.map((_x: unknown, i: number) => equalCode(vSchema, i)))\n    }\n    cxt.pass(valid)\n\n    function loopEnum(): void {\n      gen.assign(valid, false)\n      gen.forOf(\"v\", schemaCode as Code, (v) =>\n        gen.if(_`${getEql()}(${data}, ${v})`, () => gen.assign(valid, true).break())\n      )\n    }\n\n    function equalCode(vSchema: Name, i: number): Code {\n      const sch = schema[i]\n      return typeof sch === \"object\" && sch !== null\n        ? _`${getEql()}(${data}, ${vSchema}[${i}])`\n        : _`${data} === ${sch}`\n    }\n  },\n}\n\nexport default def\n","import type {ErrorObject, Vocabulary} from \"../../types\"\nimport limitNumber, {LimitNumberError} from \"./limitNumber\"\nimport multipleOf, {MultipleOfError} from \"./multipleOf\"\nimport limitLength from \"./limitLength\"\nimport pattern, {PatternError} from \"./pattern\"\nimport limitProperties from \"./limitProperties\"\nimport required, {RequiredError} from \"./required\"\nimport limitItems from \"./limitItems\"\nimport uniqueItems, {UniqueItemsError} from \"./uniqueItems\"\nimport constKeyword, {ConstError} from \"./const\"\nimport enumKeyword, {EnumError} from \"./enum\"\n\nconst validation: Vocabulary = [\n  // number\n  limitNumber,\n  multipleOf,\n  // string\n  limitLength,\n  pattern,\n  // object\n  limitProperties,\n  required,\n  // array\n  limitItems,\n  uniqueItems,\n  // any\n  {keyword: \"type\", schemaType: [\"string\", \"array\"]},\n  {keyword: \"nullable\", schemaType: \"boolean\"},\n  constKeyword,\n  enumKeyword,\n]\n\nexport default validation\n\ntype LimitError = ErrorObject<\n  \"maxItems\" | \"minItems\" | \"minProperties\" | \"maxProperties\" | \"minLength\" | \"maxLength\",\n  {limit: number},\n  number | {$data: string}\n>\n\nexport type ValidationKeywordError =\n  | LimitError\n  | LimitNumberError\n  | MultipleOfError\n  | PatternError\n  | RequiredError\n  | UniqueItemsError\n  | ConstError\n  | EnumError\n","import type {\n  CodeKeywordDefinition,\n  ErrorObject,\n  KeywordErrorDefinition,\n  AnySchema,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, not, Name} from \"../../compile/codegen\"\nimport {alwaysValidSchema, checkStrictMode, Type} from \"../../compile/util\"\n\nexport type AdditionalItemsError = ErrorObject<\"additionalItems\", {limit: number}, AnySchema>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params: {len}}) => str`must NOT have more than ${len} items`,\n  params: ({params: {len}}) => _`{limit: ${len}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"additionalItems\" as const,\n  type: \"array\",\n  schemaType: [\"boolean\", \"object\"],\n  before: \"uniqueItems\",\n  error,\n  code(cxt: KeywordCxt) {\n    const {parentSchema, it} = cxt\n    const {items} = parentSchema\n    if (!Array.isArray(items)) {\n      checkStrictMode(it, '\"additionalItems\" is ignored when \"items\" is not an array of schemas')\n      return\n    }\n    validateAdditionalItems(cxt, items)\n  },\n}\n\nexport function validateAdditionalItems(cxt: KeywordCxt, items: AnySchema[]): void {\n  const {gen, schema, data, keyword, it} = cxt\n  it.items = true\n  const len = gen.const(\"len\", _`${data}.length`)\n  if (schema === false) {\n    cxt.setParams({len: items.length})\n    cxt.pass(_`${len} <= ${items.length}`)\n  } else if (typeof schema == \"object\" && !alwaysValidSchema(it, schema)) {\n    const valid = gen.var(\"valid\", _`${len} <= ${items.length}`) // TODO var\n    gen.if(not(valid), () => validateItems(valid))\n    cxt.ok(valid)\n  }\n\n  function validateItems(valid: Name): void {\n    gen.forRange(\"i\", items.length, len, (i) => {\n      cxt.subschema({keyword, dataProp: i, dataPropType: Type.Num}, valid)\n      if (!it.allErrors) gen.if(not(valid), () => gen.break())\n    })\n  }\n}\n\nexport default def\n","import type {CodeKeywordDefinition, AnySchema, AnySchemaObject} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_} from \"../../compile/codegen\"\nimport {alwaysValidSchema, mergeEvaluated, checkStrictMode} from \"../../compile/util\"\nimport {validateArray} from \"../code\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"items\",\n  type: \"array\",\n  schemaType: [\"object\", \"array\", \"boolean\"],\n  before: \"uniqueItems\",\n  code(cxt: KeywordCxt) {\n    const {schema, it} = cxt\n    if (Array.isArray(schema)) return validateTuple(cxt, \"additionalItems\", schema)\n    it.items = true\n    if (alwaysValidSchema(it, schema)) return\n    cxt.ok(validateArray(cxt))\n  },\n}\n\nexport function validateTuple(\n  cxt: KeywordCxt,\n  extraItems: string,\n  schArr: AnySchema[] = cxt.schema\n): void {\n  const {gen, parentSchema, data, keyword, it} = cxt\n  checkStrictTuple(parentSchema)\n  if (it.opts.unevaluated && schArr.length && it.items !== true) {\n    it.items = mergeEvaluated.items(gen, schArr.length, it.items)\n  }\n  const valid = gen.name(\"valid\")\n  const len = gen.const(\"len\", _`${data}.length`)\n  schArr.forEach((sch: AnySchema, i: number) => {\n    if (alwaysValidSchema(it, sch)) return\n    gen.if(_`${len} > ${i}`, () =>\n      cxt.subschema(\n        {\n          keyword,\n          schemaProp: i,\n          dataProp: i,\n        },\n        valid\n      )\n    )\n    cxt.ok(valid)\n  })\n\n  function checkStrictTuple(sch: AnySchemaObject): void {\n    const {opts, errSchemaPath} = it\n    const l = schArr.length\n    const fullTuple = l === sch.minItems && (l === sch.maxItems || sch[extraItems] === false)\n    if (opts.strictTuples && !fullTuple) {\n      const msg = `\"${keyword}\" is ${l}-tuple, but minItems or maxItems/${extraItems} are not specified or different at path \"${errSchemaPath}\"`\n      checkStrictMode(it, msg, opts.strictTuples)\n    }\n  }\n}\n\nexport default def\n","import type {CodeKeywordDefinition} from \"../../types\"\nimport {validateTuple} from \"./items\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"prefixItems\",\n  type: \"array\",\n  schemaType: [\"array\"],\n  before: \"uniqueItems\",\n  code: (cxt) => validateTuple(cxt, \"items\"),\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  KeywordErrorDefinition,\n  ErrorObject,\n  AnySchema,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str} from \"../../compile/codegen\"\nimport {alwaysValidSchema} from \"../../compile/util\"\nimport {validateArray} from \"../code\"\nimport {validateAdditionalItems} from \"./additionalItems\"\n\nexport type ItemsError = ErrorObject<\"items\", {limit: number}, AnySchema>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params: {len}}) => str`must NOT have more than ${len} items`,\n  params: ({params: {len}}) => _`{limit: ${len}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"items\",\n  type: \"array\",\n  schemaType: [\"object\", \"boolean\"],\n  before: \"uniqueItems\",\n  error,\n  code(cxt: KeywordCxt) {\n    const {schema, parentSchema, it} = cxt\n    const {prefixItems} = parentSchema\n    it.items = true\n    if (alwaysValidSchema(it, schema)) return\n    if (prefixItems) validateAdditionalItems(cxt, prefixItems)\n    else cxt.ok(validateArray(cxt))\n  },\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  KeywordErrorDefinition,\n  ErrorObject,\n  AnySchema,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, Name} from \"../../compile/codegen\"\nimport {alwaysValidSchema, checkStrictMode, Type} from \"../../compile/util\"\n\nexport type ContainsError = ErrorObject<\n  \"contains\",\n  {minContains: number; maxContains?: number},\n  AnySchema\n>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params: {min, max}}) =>\n    max === undefined\n      ? str`must contain at least ${min} valid item(s)`\n      : str`must contain at least ${min} and no more than ${max} valid item(s)`,\n  params: ({params: {min, max}}) =>\n    max === undefined ? _`{minContains: ${min}}` : _`{minContains: ${min}, maxContains: ${max}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"contains\",\n  type: \"array\",\n  schemaType: [\"object\", \"boolean\"],\n  before: \"uniqueItems\",\n  trackErrors: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, schema, parentSchema, data, it} = cxt\n    let min: number\n    let max: number | undefined\n    const {minContains, maxContains} = parentSchema\n    if (it.opts.next) {\n      min = minContains === undefined ? 1 : minContains\n      max = maxContains\n    } else {\n      min = 1\n    }\n    const len = gen.const(\"len\", _`${data}.length`)\n    cxt.setParams({min, max})\n    if (max === undefined && min === 0) {\n      checkStrictMode(it, `\"minContains\" == 0 without \"maxContains\": \"contains\" keyword ignored`)\n      return\n    }\n    if (max !== undefined && min > max) {\n      checkStrictMode(it, `\"minContains\" > \"maxContains\" is always invalid`)\n      cxt.fail()\n      return\n    }\n    if (alwaysValidSchema(it, schema)) {\n      let cond = _`${len} >= ${min}`\n      if (max !== undefined) cond = _`${cond} && ${len} <= ${max}`\n      cxt.pass(cond)\n      return\n    }\n\n    it.items = true\n    const valid = gen.name(\"valid\")\n    if (max === undefined && min === 1) {\n      validateItems(valid, () => gen.if(valid, () => gen.break()))\n    } else if (min === 0) {\n      gen.let(valid, true)\n      if (max !== undefined) gen.if(_`${data}.length > 0`, validateItemsWithCount)\n    } else {\n      gen.let(valid, false)\n      validateItemsWithCount()\n    }\n    cxt.result(valid, () => cxt.reset())\n\n    function validateItemsWithCount(): void {\n      const schValid = gen.name(\"_valid\")\n      const count = gen.let(\"count\", 0)\n      validateItems(schValid, () => gen.if(schValid, () => checkLimits(count)))\n    }\n\n    function validateItems(_valid: Name, block: () => void): void {\n      gen.forRange(\"i\", 0, len, (i) => {\n        cxt.subschema(\n          {\n            keyword: \"contains\",\n            dataProp: i,\n            dataPropType: Type.Num,\n            compositeRule: true,\n          },\n          _valid\n        )\n        block()\n      })\n    }\n\n    function checkLimits(count: Name): void {\n      gen.code(_`${count}++`)\n      if (max === undefined) {\n        gen.if(_`${count} >= ${min}`, () => gen.assign(valid, true).break())\n      } else {\n        gen.if(_`${count} > ${max}`, () => gen.assign(valid, false).break())\n        if (min === 1) gen.assign(valid, true)\n        else gen.if(_`${count} >= ${min}`, () => gen.assign(valid, true))\n      }\n    }\n  },\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  ErrorObject,\n  KeywordErrorDefinition,\n  SchemaMap,\n  AnySchema,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str} from \"../../compile/codegen\"\nimport {alwaysValidSchema} from \"../../compile/util\"\nimport {checkReportMissingProp, checkMissingProp, reportMissingProp, propertyInData} from \"../code\"\n\nexport type PropertyDependencies = {[K in string]?: string[]}\n\nexport interface DependenciesErrorParams {\n  property: string\n  missingProperty: string\n  depsCount: number\n  deps: string // TODO change to string[]\n}\n\ntype SchemaDependencies = SchemaMap\n\nexport type DependenciesError = ErrorObject<\n  \"dependencies\",\n  DependenciesErrorParams,\n  {[K in string]?: string[] | AnySchema}\n>\n\nexport const error: KeywordErrorDefinition = {\n  message: ({params: {property, depsCount, deps}}) => {\n    const property_ies = depsCount === 1 ? \"property\" : \"properties\"\n    return str`must have ${property_ies} ${deps} when property ${property} is present`\n  },\n  params: ({params: {property, depsCount, deps, missingProperty}}) =>\n    _`{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}`, // TODO change to reference\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"dependencies\",\n  type: \"object\",\n  schemaType: \"object\",\n  error,\n  code(cxt: KeywordCxt) {\n    const [propDeps, schDeps] = splitDependencies(cxt)\n    validatePropertyDeps(cxt, propDeps)\n    validateSchemaDeps(cxt, schDeps)\n  },\n}\n\nfunction splitDependencies({schema}: KeywordCxt): [PropertyDependencies, SchemaDependencies] {\n  const propertyDeps: PropertyDependencies = {}\n  const schemaDeps: SchemaDependencies = {}\n  for (const key in schema) {\n    if (key === \"__proto__\") continue\n    const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps\n    deps[key] = schema[key]\n  }\n  return [propertyDeps, schemaDeps]\n}\n\nexport function validatePropertyDeps(\n  cxt: KeywordCxt,\n  propertyDeps: {[K in string]?: string[]} = cxt.schema\n): void {\n  const {gen, data, it} = cxt\n  if (Object.keys(propertyDeps).length === 0) return\n  const missing = gen.let(\"missing\")\n  for (const prop in propertyDeps) {\n    const deps = propertyDeps[prop] as string[]\n    if (deps.length === 0) continue\n    const hasProperty = propertyInData(gen, data, prop, it.opts.ownProperties)\n    cxt.setParams({\n      property: prop,\n      depsCount: deps.length,\n      deps: deps.join(\", \"),\n    })\n    if (it.allErrors) {\n      gen.if(hasProperty, () => {\n        for (const depProp of deps) {\n          checkReportMissingProp(cxt, depProp)\n        }\n      })\n    } else {\n      gen.if(_`${hasProperty} && (${checkMissingProp(cxt, deps, missing)})`)\n      reportMissingProp(cxt, missing)\n      gen.else()\n    }\n  }\n}\n\nexport function validateSchemaDeps(cxt: KeywordCxt, schemaDeps: SchemaMap = cxt.schema): void {\n  const {gen, data, keyword, it} = cxt\n  const valid = gen.name(\"valid\")\n  for (const prop in schemaDeps) {\n    if (alwaysValidSchema(it, schemaDeps[prop] as AnySchema)) continue\n    gen.if(\n      propertyInData(gen, data, prop, it.opts.ownProperties),\n      () => {\n        const schCxt = cxt.subschema({keyword, schemaProp: prop}, valid)\n        cxt.mergeValidEvaluated(schCxt, valid)\n      },\n      () => gen.var(valid, true) // TODO var\n    )\n    cxt.ok(valid)\n  }\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  ErrorObject,\n  KeywordErrorDefinition,\n  AnySchema,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, not} from \"../../compile/codegen\"\nimport {alwaysValidSchema} from \"../../compile/util\"\n\nexport type PropertyNamesError = ErrorObject<\"propertyNames\", {propertyName: string}, AnySchema>\n\nconst error: KeywordErrorDefinition = {\n  message: \"property name must be valid\",\n  params: ({params}) => _`{propertyName: ${params.propertyName}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"propertyNames\",\n  type: \"object\",\n  schemaType: [\"object\", \"boolean\"],\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, schema, data, it} = cxt\n    if (alwaysValidSchema(it, schema)) return\n    const valid = gen.name(\"valid\")\n\n    gen.forIn(\"key\", data, (key) => {\n      cxt.setParams({propertyName: key})\n      cxt.subschema(\n        {\n          keyword: \"propertyNames\",\n          data: key,\n          dataTypes: [\"string\"],\n          propertyName: key,\n          compositeRule: true,\n        },\n        valid\n      )\n      gen.if(not(valid), () => {\n        cxt.error(true)\n        if (!it.allErrors) gen.break()\n      })\n    })\n\n    cxt.ok(valid)\n  },\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  AddedKeywordDefinition,\n  ErrorObject,\n  KeywordErrorDefinition,\n  AnySchema,\n} from \"../../types\"\nimport {allSchemaProperties, usePattern, isOwnProperty} from \"../code\"\nimport {_, nil, or, not, Code, Name} from \"../../compile/codegen\"\nimport N from \"../../compile/names\"\nimport type {SubschemaArgs} from \"../../compile/validate/subschema\"\nimport {alwaysValidSchema, schemaRefOrVal, Type} from \"../../compile/util\"\n\nexport type AdditionalPropertiesError = ErrorObject<\n  \"additionalProperties\",\n  {additionalProperty: string},\n  AnySchema\n>\n\nconst error: KeywordErrorDefinition = {\n  message: \"must NOT have additional properties\",\n  params: ({params}) => _`{additionalProperty: ${params.additionalProperty}}`,\n}\n\nconst def: CodeKeywordDefinition & AddedKeywordDefinition = {\n  keyword: \"additionalProperties\",\n  type: [\"object\"],\n  schemaType: [\"boolean\", \"object\"],\n  allowUndefined: true,\n  trackErrors: true,\n  error,\n  code(cxt) {\n    const {gen, schema, parentSchema, data, errsCount, it} = cxt\n    /* istanbul ignore if */\n    if (!errsCount) throw new Error(\"ajv implementation error\")\n    const {allErrors, opts} = it\n    it.props = true\n    if (opts.removeAdditional !== \"all\" && alwaysValidSchema(it, schema)) return\n    const props = allSchemaProperties(parentSchema.properties)\n    const patProps = allSchemaProperties(parentSchema.patternProperties)\n    checkAdditionalProperties()\n    cxt.ok(_`${errsCount} === ${N.errors}`)\n\n    function checkAdditionalProperties(): void {\n      gen.forIn(\"key\", data, (key: Name) => {\n        if (!props.length && !patProps.length) additionalPropertyCode(key)\n        else gen.if(isAdditional(key), () => additionalPropertyCode(key))\n      })\n    }\n\n    function isAdditional(key: Name): Code {\n      let definedProp: Code\n      if (props.length > 8) {\n        // TODO maybe an option instead of hard-coded 8?\n        const propsSchema = schemaRefOrVal(it, parentSchema.properties, \"properties\")\n        definedProp = isOwnProperty(gen, propsSchema as Code, key)\n      } else if (props.length) {\n        definedProp = or(...props.map((p) => _`${key} === ${p}`))\n      } else {\n        definedProp = nil\n      }\n      if (patProps.length) {\n        definedProp = or(definedProp, ...patProps.map((p) => _`${usePattern(cxt, p)}.test(${key})`))\n      }\n      return not(definedProp)\n    }\n\n    function deleteAdditional(key: Name): void {\n      gen.code(_`delete ${data}[${key}]`)\n    }\n\n    function additionalPropertyCode(key: Name): void {\n      if (opts.removeAdditional === \"all\" || (opts.removeAdditional && schema === false)) {\n        deleteAdditional(key)\n        return\n      }\n\n      if (schema === false) {\n        cxt.setParams({additionalProperty: key})\n        cxt.error()\n        if (!allErrors) gen.break()\n        return\n      }\n\n      if (typeof schema == \"object\" && !alwaysValidSchema(it, schema)) {\n        const valid = gen.name(\"valid\")\n        if (opts.removeAdditional === \"failing\") {\n          applyAdditionalSchema(key, valid, false)\n          gen.if(not(valid), () => {\n            cxt.reset()\n            deleteAdditional(key)\n          })\n        } else {\n          applyAdditionalSchema(key, valid)\n          if (!allErrors) gen.if(not(valid), () => gen.break())\n        }\n      }\n    }\n\n    function applyAdditionalSchema(key: Name, valid: Name, errors?: false): void {\n      const subschema: SubschemaArgs = {\n        keyword: \"additionalProperties\",\n        dataProp: key,\n        dataPropType: Type.Str,\n      }\n      if (errors === false) {\n        Object.assign(subschema, {\n          compositeRule: true,\n          createErrors: false,\n          allErrors: false,\n        })\n      }\n      cxt.subschema(subschema, valid)\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition} from \"../../types\"\nimport {KeywordCxt} from \"../../compile/validate\"\nimport {propertyInData, allSchemaProperties} from \"../code\"\nimport {alwaysValidSchema, toHash, mergeEvaluated} from \"../../compile/util\"\nimport apDef from \"./additionalProperties\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"properties\",\n  type: \"object\",\n  schemaType: \"object\",\n  code(cxt: KeywordCxt) {\n    const {gen, schema, parentSchema, data, it} = cxt\n    if (it.opts.removeAdditional === \"all\" && parentSchema.additionalProperties === undefined) {\n      apDef.code(new KeywordCxt(it, apDef, \"additionalProperties\"))\n    }\n    const allProps = allSchemaProperties(schema)\n    for (const prop of allProps) {\n      it.definedProperties.add(prop)\n    }\n    if (it.opts.unevaluated && allProps.length && it.props !== true) {\n      it.props = mergeEvaluated.props(gen, toHash(allProps), it.props)\n    }\n    const properties = allProps.filter((p) => !alwaysValidSchema(it, schema[p]))\n    if (properties.length === 0) return\n    const valid = gen.name(\"valid\")\n\n    for (const prop of properties) {\n      if (hasDefault(prop)) {\n        applyPropertySchema(prop)\n      } else {\n        gen.if(propertyInData(gen, data, prop, it.opts.ownProperties))\n        applyPropertySchema(prop)\n        if (!it.allErrors) gen.else().var(valid, true)\n        gen.endIf()\n      }\n      cxt.it.definedProperties.add(prop)\n      cxt.ok(valid)\n    }\n\n    function hasDefault(prop: string): boolean | undefined {\n      return it.opts.useDefaults && !it.compositeRule && schema[prop].default !== undefined\n    }\n\n    function applyPropertySchema(prop: string): void {\n      cxt.subschema(\n        {\n          keyword: \"properties\",\n          schemaProp: prop,\n          dataProp: prop,\n        },\n        valid\n      )\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {allSchemaProperties, usePattern} from \"../code\"\nimport {_, not, Name} from \"../../compile/codegen\"\nimport {alwaysValidSchema, checkStrictMode} from \"../../compile/util\"\nimport {evaluatedPropsToName, Type} from \"../../compile/util\"\nimport {AnySchema} from \"../../types\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"patternProperties\",\n  type: \"object\",\n  schemaType: \"object\",\n  code(cxt: KeywordCxt) {\n    const {gen, schema, data, parentSchema, it} = cxt\n    const {opts} = it\n    const patterns = allSchemaProperties(schema)\n    const alwaysValidPatterns = patterns.filter((p) =>\n      alwaysValidSchema(it, schema[p] as AnySchema)\n    )\n\n    if (\n      patterns.length === 0 ||\n      (alwaysValidPatterns.length === patterns.length &&\n        (!it.opts.unevaluated || it.props === true))\n    ) {\n      return\n    }\n\n    const checkProperties =\n      opts.strictSchema && !opts.allowMatchingProperties && parentSchema.properties\n    const valid = gen.name(\"valid\")\n    if (it.props !== true && !(it.props instanceof Name)) {\n      it.props = evaluatedPropsToName(gen, it.props)\n    }\n    const {props} = it\n    validatePatternProperties()\n\n    function validatePatternProperties(): void {\n      for (const pat of patterns) {\n        if (checkProperties) checkMatchingProperties(pat)\n        if (it.allErrors) {\n          validateProperties(pat)\n        } else {\n          gen.var(valid, true) // TODO var\n          validateProperties(pat)\n          gen.if(valid)\n        }\n      }\n    }\n\n    function checkMatchingProperties(pat: string): void {\n      for (const prop in checkProperties) {\n        if (new RegExp(pat).test(prop)) {\n          checkStrictMode(\n            it,\n            `property ${prop} matches pattern ${pat} (use allowMatchingProperties)`\n          )\n        }\n      }\n    }\n\n    function validateProperties(pat: string): void {\n      gen.forIn(\"key\", data, (key) => {\n        gen.if(_`${usePattern(cxt, pat)}.test(${key})`, () => {\n          const alwaysValid = alwaysValidPatterns.includes(pat)\n          if (!alwaysValid) {\n            cxt.subschema(\n              {\n                keyword: \"patternProperties\",\n                schemaProp: pat,\n                dataProp: key,\n                dataPropType: Type.Str,\n              },\n              valid\n            )\n          }\n\n          if (it.opts.unevaluated && props !== true) {\n            gen.assign(_`${props}[${key}]`, true)\n          } else if (!alwaysValid && !it.allErrors) {\n            // can short-circuit if `unevaluatedProperties` is not supported (opts.next === false)\n            // or if all properties were evaluated (props === true)\n            gen.if(not(valid), () => gen.break())\n          }\n        })\n      })\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorNoParams, AnySchema} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {alwaysValidSchema} from \"../../compile/util\"\n\nexport type NotKeywordError = ErrorNoParams<\"not\", AnySchema>\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"not\",\n  schemaType: [\"object\", \"boolean\"],\n  trackErrors: true,\n  code(cxt: KeywordCxt) {\n    const {gen, schema, it} = cxt\n    if (alwaysValidSchema(it, schema)) {\n      cxt.fail()\n      return\n    }\n\n    const valid = gen.name(\"valid\")\n    cxt.subschema(\n      {\n        keyword: \"not\",\n        compositeRule: true,\n        createErrors: false,\n        allErrors: false,\n      },\n      valid\n    )\n\n    cxt.failResult(\n      valid,\n      () => cxt.reset(),\n      () => cxt.error()\n    )\n  },\n  error: {message: \"must NOT be valid\"},\n}\n\nexport default def\n","import type {CodeKeywordDefinition, ErrorNoParams, AnySchema} from \"../../types\"\nimport {validateUnion} from \"../code\"\n\nexport type AnyOfError = ErrorNoParams<\"anyOf\", AnySchema[]>\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"anyOf\",\n  schemaType: \"array\",\n  trackErrors: true,\n  code: validateUnion,\n  error: {message: \"must match a schema in anyOf\"},\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  ErrorObject,\n  KeywordErrorDefinition,\n  AnySchema,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, Name} from \"../../compile/codegen\"\nimport {alwaysValidSchema} from \"../../compile/util\"\nimport {SchemaCxt} from \"../../compile\"\n\nexport type OneOfError = ErrorObject<\n  \"oneOf\",\n  {passingSchemas: [number, number] | null},\n  AnySchema[]\n>\n\nconst error: KeywordErrorDefinition = {\n  message: \"must match exactly one schema in oneOf\",\n  params: ({params}) => _`{passingSchemas: ${params.passing}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"oneOf\",\n  schemaType: \"array\",\n  trackErrors: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, schema, parentSchema, it} = cxt\n    /* istanbul ignore if */\n    if (!Array.isArray(schema)) throw new Error(\"ajv implementation error\")\n    if (it.opts.discriminator && parentSchema.discriminator) return\n    const schArr: AnySchema[] = schema\n    const valid = gen.let(\"valid\", false)\n    const passing = gen.let(\"passing\", null)\n    const schValid = gen.name(\"_valid\")\n    cxt.setParams({passing})\n    // TODO possibly fail straight away (with warning or exception) if there are two empty always valid schemas\n\n    gen.block(validateOneOf)\n\n    cxt.result(\n      valid,\n      () => cxt.reset(),\n      () => cxt.error(true)\n    )\n\n    function validateOneOf(): void {\n      schArr.forEach((sch: AnySchema, i: number) => {\n        let schCxt: SchemaCxt | undefined\n        if (alwaysValidSchema(it, sch)) {\n          gen.var(schValid, true)\n        } else {\n          schCxt = cxt.subschema(\n            {\n              keyword: \"oneOf\",\n              schemaProp: i,\n              compositeRule: true,\n            },\n            schValid\n          )\n        }\n\n        if (i > 0) {\n          gen\n            .if(_`${schValid} && ${valid}`)\n            .assign(valid, false)\n            .assign(passing, _`[${passing}, ${i}]`)\n            .else()\n        }\n\n        gen.if(schValid, () => {\n          gen.assign(valid, true)\n          gen.assign(passing, i)\n          if (schCxt) cxt.mergeEvaluated(schCxt, Name)\n        })\n      })\n    }\n  },\n}\n\nexport default def\n","import type {CodeKeywordDefinition, AnySchema} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {alwaysValidSchema} from \"../../compile/util\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"allOf\",\n  schemaType: \"array\",\n  code(cxt: KeywordCxt) {\n    const {gen, schema, it} = cxt\n    /* istanbul ignore if */\n    if (!Array.isArray(schema)) throw new Error(\"ajv implementation error\")\n    const valid = gen.name(\"valid\")\n    schema.forEach((sch: AnySchema, i: number) => {\n      if (alwaysValidSchema(it, sch)) return\n      const schCxt = cxt.subschema({keyword: \"allOf\", schemaProp: i}, valid)\n      cxt.ok(valid)\n      cxt.mergeEvaluated(schCxt)\n    })\n  },\n}\n\nexport default def\n","import type {\n  CodeKeywordDefinition,\n  ErrorObject,\n  KeywordErrorDefinition,\n  AnySchema,\n} from \"../../types\"\nimport type {SchemaObjCxt} from \"../../compile\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, not, Name} from \"../../compile/codegen\"\nimport {alwaysValidSchema, checkStrictMode} from \"../../compile/util\"\n\nexport type IfKeywordError = ErrorObject<\"if\", {failingKeyword: string}, AnySchema>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params}) => str`must match \"${params.ifClause}\" schema`,\n  params: ({params}) => _`{failingKeyword: ${params.ifClause}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"if\",\n  schemaType: [\"object\", \"boolean\"],\n  trackErrors: true,\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, parentSchema, it} = cxt\n    if (parentSchema.then === undefined && parentSchema.else === undefined) {\n      checkStrictMode(it, '\"if\" without \"then\" and \"else\" is ignored')\n    }\n    const hasThen = hasSchema(it, \"then\")\n    const hasElse = hasSchema(it, \"else\")\n    if (!hasThen && !hasElse) return\n\n    const valid = gen.let(\"valid\", true)\n    const schValid = gen.name(\"_valid\")\n    validateIf()\n    cxt.reset()\n\n    if (hasThen && hasElse) {\n      const ifClause = gen.let(\"ifClause\")\n      cxt.setParams({ifClause})\n      gen.if(schValid, validateClause(\"then\", ifClause), validateClause(\"else\", ifClause))\n    } else if (hasThen) {\n      gen.if(schValid, validateClause(\"then\"))\n    } else {\n      gen.if(not(schValid), validateClause(\"else\"))\n    }\n\n    cxt.pass(valid, () => cxt.error(true))\n\n    function validateIf(): void {\n      const schCxt = cxt.subschema(\n        {\n          keyword: \"if\",\n          compositeRule: true,\n          createErrors: false,\n          allErrors: false,\n        },\n        schValid\n      )\n      cxt.mergeEvaluated(schCxt)\n    }\n\n    function validateClause(keyword: string, ifClause?: Name): () => void {\n      return () => {\n        const schCxt = cxt.subschema({keyword}, schValid)\n        gen.assign(valid, schValid)\n        cxt.mergeValidEvaluated(schCxt, valid)\n        if (ifClause) gen.assign(ifClause, _`${keyword}`)\n        else cxt.setParams({ifClause: keyword})\n      }\n    }\n  },\n}\n\nfunction hasSchema(it: SchemaObjCxt, keyword: string): boolean {\n  const schema = it.schema[keyword]\n  return schema !== undefined && !alwaysValidSchema(it, schema)\n}\n\nexport default def\n","import type {CodeKeywordDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {checkStrictMode} from \"../../compile/util\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: [\"then\", \"else\"],\n  schemaType: [\"object\", \"boolean\"],\n  code({keyword, parentSchema, it}: KeywordCxt) {\n    if (parentSchema.if === undefined) checkStrictMode(it, `\"${keyword}\" without \"if\" is ignored`)\n  },\n}\n\nexport default def\n","import type {ErrorNoParams, Vocabulary} from \"../../types\"\nimport additionalItems, {AdditionalItemsError} from \"./additionalItems\"\nimport prefixItems from \"./prefixItems\"\nimport items from \"./items\"\nimport items2020, {ItemsError} from \"./items2020\"\nimport contains, {ContainsError} from \"./contains\"\nimport dependencies, {DependenciesError} from \"./dependencies\"\nimport propertyNames, {PropertyNamesError} from \"./propertyNames\"\nimport additionalProperties, {AdditionalPropertiesError} from \"./additionalProperties\"\nimport properties from \"./properties\"\nimport patternProperties from \"./patternProperties\"\nimport notKeyword, {NotKeywordError} from \"./not\"\nimport anyOf, {AnyOfError} from \"./anyOf\"\nimport oneOf, {OneOfError} from \"./oneOf\"\nimport allOf from \"./allOf\"\nimport ifKeyword, {IfKeywordError} from \"./if\"\nimport thenElse from \"./thenElse\"\n\nexport default function getApplicator(draft2020 = false): Vocabulary {\n  const applicator = [\n    // any\n    notKeyword,\n    anyOf,\n    oneOf,\n    allOf,\n    ifKeyword,\n    thenElse,\n    // object\n    propertyNames,\n    additionalProperties,\n    dependencies,\n    properties,\n    patternProperties,\n  ]\n  // array\n  if (draft2020) applicator.push(prefixItems, items2020)\n  else applicator.push(additionalItems, items)\n  applicator.push(contains)\n  return applicator\n}\n\nexport type ApplicatorKeywordError =\n  | ErrorNoParams<\"false schema\">\n  | AdditionalItemsError\n  | ItemsError\n  | ContainsError\n  | AdditionalPropertiesError\n  | DependenciesError\n  | IfKeywordError\n  | AnyOfError\n  | OneOfError\n  | NotKeywordError\n  | PropertyNamesError\n","import type {\n  AddedFormat,\n  FormatValidator,\n  AsyncFormatValidator,\n  CodeKeywordDefinition,\n  KeywordErrorDefinition,\n  ErrorObject,\n} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, str, nil, or, Code, getProperty, regexpCode} from \"../../compile/codegen\"\n\ntype FormatValidate =\n  | FormatValidator<string>\n  | FormatValidator<number>\n  | AsyncFormatValidator<string>\n  | AsyncFormatValidator<number>\n  | RegExp\n  | string\n  | true\n\nexport type FormatError = ErrorObject<\"format\", {format: string}, string | {$data: string}>\n\nconst error: KeywordErrorDefinition = {\n  message: ({schemaCode}) => str`must match format \"${schemaCode}\"`,\n  params: ({schemaCode}) => _`{format: ${schemaCode}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"format\",\n  type: [\"number\", \"string\"],\n  schemaType: \"string\",\n  $data: true,\n  error,\n  code(cxt: KeywordCxt, ruleType?: string) {\n    const {gen, data, $data, schema, schemaCode, it} = cxt\n    const {opts, errSchemaPath, schemaEnv, self} = it\n    if (!opts.validateFormats) return\n\n    if ($data) validate$DataFormat()\n    else validateFormat()\n\n    function validate$DataFormat(): void {\n      const fmts = gen.scopeValue(\"formats\", {\n        ref: self.formats,\n        code: opts.code.formats,\n      })\n      const fDef = gen.const(\"fDef\", _`${fmts}[${schemaCode}]`)\n      const fType = gen.let(\"fType\")\n      const format = gen.let(\"format\")\n      // TODO simplify\n      gen.if(\n        _`typeof ${fDef} == \"object\" && !(${fDef} instanceof RegExp)`,\n        () => gen.assign(fType, _`${fDef}.type || \"string\"`).assign(format, _`${fDef}.validate`),\n        () => gen.assign(fType, _`\"string\"`).assign(format, fDef)\n      )\n      cxt.fail$data(or(unknownFmt(), invalidFmt()))\n\n      function unknownFmt(): Code {\n        if (opts.strictSchema === false) return nil\n        return _`${schemaCode} && !${format}`\n      }\n\n      function invalidFmt(): Code {\n        const callFormat = schemaEnv.$async\n          ? _`(${fDef}.async ? await ${format}(${data}) : ${format}(${data}))`\n          : _`${format}(${data})`\n        const validData = _`(typeof ${format} == \"function\" ? ${callFormat} : ${format}.test(${data}))`\n        return _`${format} && ${format} !== true && ${fType} === ${ruleType} && !${validData}`\n      }\n    }\n\n    function validateFormat(): void {\n      const formatDef: AddedFormat | undefined = self.formats[schema]\n      if (!formatDef) {\n        unknownFormat()\n        return\n      }\n      if (formatDef === true) return\n      const [fmtType, format, fmtRef] = getFormat(formatDef)\n      if (fmtType === ruleType) cxt.pass(validCondition())\n\n      function unknownFormat(): void {\n        if (opts.strictSchema === false) {\n          self.logger.warn(unknownMsg())\n          return\n        }\n        throw new Error(unknownMsg())\n\n        function unknownMsg(): string {\n          return `unknown format \"${schema as string}\" ignored in schema at path \"${errSchemaPath}\"`\n        }\n      }\n\n      function getFormat(fmtDef: AddedFormat): [string, FormatValidate, Code] {\n        const code =\n          fmtDef instanceof RegExp\n            ? regexpCode(fmtDef)\n            : opts.code.formats\n            ? _`${opts.code.formats}${getProperty(schema)}`\n            : undefined\n        const fmt = gen.scopeValue(\"formats\", {key: schema, ref: fmtDef, code})\n        if (typeof fmtDef == \"object\" && !(fmtDef instanceof RegExp)) {\n          return [fmtDef.type || \"string\", fmtDef.validate, _`${fmt}.validate`]\n        }\n\n        return [\"string\", fmtDef, fmt]\n      }\n\n      function validCondition(): Code {\n        if (typeof formatDef == \"object\" && !(formatDef instanceof RegExp) && formatDef.async) {\n          if (!schemaEnv.$async) throw new Error(\"async format in sync schema\")\n          return _`await ${fmtRef}(${data})`\n        }\n        return typeof format == \"function\" ? _`${fmtRef}(${data})` : _`${fmtRef}.test(${data})`\n      }\n    }\n  },\n}\n\nexport default def\n","import type {Vocabulary} from \"../../types\"\nimport formatKeyword from \"./format\"\n\nconst format: Vocabulary = [formatKeyword]\n\nexport default format\n","import type {Vocabulary} from \"../types\"\n\nexport const metadataVocabulary: Vocabulary = [\n  \"title\",\n  \"description\",\n  \"default\",\n  \"deprecated\",\n  \"readOnly\",\n  \"writeOnly\",\n  \"examples\",\n]\n\nexport const contentVocabulary: Vocabulary = [\n  \"contentMediaType\",\n  \"contentEncoding\",\n  \"contentSchema\",\n]\n","import type {Vocabulary} from \"../types\"\nimport coreVocabulary from \"./core\"\nimport validationVocabulary from \"./validation\"\nimport getApplicatorVocabulary from \"./applicator\"\nimport formatVocabulary from \"./format\"\nimport {metadataVocabulary, contentVocabulary} from \"./metadata\"\n\nconst draft7Vocabularies: Vocabulary[] = [\n  coreVocabulary,\n  validationVocabulary,\n  getApplicatorVocabulary(),\n  formatVocabulary,\n  metadataVocabulary,\n  contentVocabulary,\n]\n\nexport default draft7Vocabularies\n","import type {ErrorObject} from \"../../types\"\n\nexport enum DiscrError {\n  Tag = \"tag\",\n  Mapping = \"mapping\",\n}\n\nexport type DiscrErrorObj<E extends DiscrError> = ErrorObject<\n  \"discriminator\",\n  {error: E; tag: string; tagValue: unknown},\n  string\n>\n","import type {CodeKeywordDefinition, AnySchemaObject, KeywordErrorDefinition} from \"../../types\"\nimport type {KeywordCxt} from \"../../compile/validate\"\nimport {_, getProperty, Name} from \"../../compile/codegen\"\nimport {DiscrError, DiscrErrorObj} from \"../discriminator/types\"\nimport {resolveRef, SchemaEnv} from \"../../compile\"\nimport MissingRefError from \"../../compile/ref_error\"\nimport {schemaHasRulesButRef} from \"../../compile/util\"\n\nexport type DiscriminatorError = DiscrErrorObj<DiscrError.Tag> | DiscrErrorObj<DiscrError.Mapping>\n\nconst error: KeywordErrorDefinition = {\n  message: ({params: {discrError, tagName}}) =>\n    discrError === DiscrError.Tag\n      ? `tag \"${tagName}\" must be string`\n      : `value of tag \"${tagName}\" must be in oneOf`,\n  params: ({params: {discrError, tag, tagName}}) =>\n    _`{error: ${discrError}, tag: ${tagName}, tagValue: ${tag}}`,\n}\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"discriminator\",\n  type: \"object\",\n  schemaType: \"object\",\n  error,\n  code(cxt: KeywordCxt) {\n    const {gen, data, schema, parentSchema, it} = cxt\n    const {oneOf} = parentSchema\n    if (!it.opts.discriminator) {\n      throw new Error(\"discriminator: requires discriminator option\")\n    }\n    const tagName = schema.propertyName\n    if (typeof tagName != \"string\") throw new Error(\"discriminator: requires propertyName\")\n    if (schema.mapping) throw new Error(\"discriminator: mapping is not supported\")\n    if (!oneOf) throw new Error(\"discriminator: requires oneOf keyword\")\n    const valid = gen.let(\"valid\", false)\n    const tag = gen.const(\"tag\", _`${data}${getProperty(tagName)}`)\n    gen.if(\n      _`typeof ${tag} == \"string\"`,\n      () => validateMapping(),\n      () => cxt.error(false, {discrError: DiscrError.Tag, tag, tagName})\n    )\n    cxt.ok(valid)\n\n    function validateMapping(): void {\n      const mapping = getMapping()\n      gen.if(false)\n      for (const tagValue in mapping) {\n        gen.elseIf(_`${tag} === ${tagValue}`)\n        gen.assign(valid, applyTagSchema(mapping[tagValue]))\n      }\n      gen.else()\n      cxt.error(false, {discrError: DiscrError.Mapping, tag, tagName})\n      gen.endIf()\n    }\n\n    function applyTagSchema(schemaProp?: number): Name {\n      const _valid = gen.name(\"valid\")\n      const schCxt = cxt.subschema({keyword: \"oneOf\", schemaProp}, _valid)\n      cxt.mergeEvaluated(schCxt, Name)\n      return _valid\n    }\n\n    function getMapping(): {[T in string]?: number} {\n      const oneOfMapping: {[T in string]?: number} = {}\n      const topRequired = hasRequired(parentSchema)\n      let tagRequired = true\n      for (let i = 0; i < oneOf.length; i++) {\n        let sch = oneOf[i]\n        if (sch?.$ref && !schemaHasRulesButRef(sch, it.self.RULES)) {\n          const ref = sch.$ref\n          sch = resolveRef.call(it.self, it.schemaEnv.root, it.baseId, ref)\n          if (sch instanceof SchemaEnv) sch = sch.schema\n          if (sch === undefined) throw new MissingRefError(it.opts.uriResolver, it.baseId, ref)\n        }\n        const propSch = sch?.properties?.[tagName]\n        if (typeof propSch != \"object\") {\n          throw new Error(\n            `discriminator: oneOf subschemas (or referenced schemas) must have \"properties/${tagName}\"`\n          )\n        }\n        tagRequired = tagRequired && (topRequired || hasRequired(sch))\n        addMappings(propSch, i)\n      }\n      if (!tagRequired) throw new Error(`discriminator: \"${tagName}\" must be required`)\n      return oneOfMapping\n\n      function hasRequired({required}: AnySchemaObject): boolean {\n        return Array.isArray(required) && required.includes(tagName)\n      }\n\n      function addMappings(sch: AnySchemaObject, i: number): void {\n        if (sch.const) {\n          addMapping(sch.const, i)\n        } else if (sch.enum) {\n          for (const tagValue of sch.enum) {\n            addMapping(tagValue, i)\n          }\n        } else {\n          throw new Error(`discriminator: \"properties/${tagName}\" must have \"const\" or \"enum\"`)\n        }\n      }\n\n      function addMapping(tagValue: unknown, i: number): void {\n        if (typeof tagValue != \"string\" || tagValue in oneOfMapping) {\n          throw new Error(`discriminator: \"${tagName}\" values must be unique strings`)\n        }\n        oneOfMapping[tagValue] = i\n      }\n    }\n  },\n}\n\nexport default def\n","{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"$id\": \"http://json-schema.org/draft-07/schema#\",\n  \"title\": \"Core schema meta-schema\",\n  \"definitions\": {\n    \"schemaArray\": {\n      \"type\": \"array\",\n      \"minItems\": 1,\n      \"items\": {\"$ref\": \"#\"}\n    },\n    \"nonNegativeInteger\": {\n      \"type\": \"integer\",\n      \"minimum\": 0\n    },\n    \"nonNegativeIntegerDefault0\": {\n      \"allOf\": [{\"$ref\": \"#/definitions/nonNegativeInteger\"}, {\"default\": 0}]\n    },\n    \"simpleTypes\": {\n      \"enum\": [\"array\", \"boolean\", \"integer\", \"null\", \"number\", \"object\", \"string\"]\n    },\n    \"stringArray\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"uniqueItems\": true,\n      \"default\": []\n    }\n  },\n  \"type\": [\"object\", \"boolean\"],\n  \"properties\": {\n    \"$id\": {\n      \"type\": \"string\",\n      \"format\": \"uri-reference\"\n    },\n    \"$schema\": {\n      \"type\": \"string\",\n      \"format\": \"uri\"\n    },\n    \"$ref\": {\n      \"type\": \"string\",\n      \"format\": \"uri-reference\"\n    },\n    \"$comment\": {\n      \"type\": \"string\"\n    },\n    \"title\": {\n      \"type\": \"string\"\n    },\n    \"description\": {\n      \"type\": \"string\"\n    },\n    \"default\": true,\n    \"readOnly\": {\n      \"type\": \"boolean\",\n      \"default\": false\n    },\n    \"examples\": {\n      \"type\": \"array\",\n      \"items\": true\n    },\n    \"multipleOf\": {\n      \"type\": \"number\",\n      \"exclusiveMinimum\": 0\n    },\n    \"maximum\": {\n      \"type\": \"number\"\n    },\n    \"exclusiveMaximum\": {\n      \"type\": \"number\"\n    },\n    \"minimum\": {\n      \"type\": \"number\"\n    },\n    \"exclusiveMinimum\": {\n      \"type\": \"number\"\n    },\n    \"maxLength\": {\"$ref\": \"#/definitions/nonNegativeInteger\"},\n    \"minLength\": {\"$ref\": \"#/definitions/nonNegativeIntegerDefault0\"},\n    \"pattern\": {\n      \"type\": \"string\",\n      \"format\": \"regex\"\n    },\n    \"additionalItems\": {\"$ref\": \"#\"},\n    \"items\": {\n      \"anyOf\": [{\"$ref\": \"#\"}, {\"$ref\": \"#/definitions/schemaArray\"}],\n      \"default\": true\n    },\n    \"maxItems\": {\"$ref\": \"#/definitions/nonNegativeInteger\"},\n    \"minItems\": {\"$ref\": \"#/definitions/nonNegativeIntegerDefault0\"},\n    \"uniqueItems\": {\n      \"type\": \"boolean\",\n      \"default\": false\n    },\n    \"contains\": {\"$ref\": \"#\"},\n    \"maxProperties\": {\"$ref\": \"#/definitions/nonNegativeInteger\"},\n    \"minProperties\": {\"$ref\": \"#/definitions/nonNegativeIntegerDefault0\"},\n    \"required\": {\"$ref\": \"#/definitions/stringArray\"},\n    \"additionalProperties\": {\"$ref\": \"#\"},\n    \"definitions\": {\n      \"type\": \"object\",\n      \"additionalProperties\": {\"$ref\": \"#\"},\n      \"default\": {}\n    },\n    \"properties\": {\n      \"type\": \"object\",\n      \"additionalProperties\": {\"$ref\": \"#\"},\n      \"default\": {}\n    },\n    \"patternProperties\": {\n      \"type\": \"object\",\n      \"additionalProperties\": {\"$ref\": \"#\"},\n      \"propertyNames\": {\"format\": \"regex\"},\n      \"default\": {}\n    },\n    \"dependencies\": {\n      \"type\": \"object\",\n      \"additionalProperties\": {\n        \"anyOf\": [{\"$ref\": \"#\"}, {\"$ref\": \"#/definitions/stringArray\"}]\n      }\n    },\n    \"propertyNames\": {\"$ref\": \"#\"},\n    \"const\": true,\n    \"enum\": {\n      \"type\": \"array\",\n      \"items\": true,\n      \"minItems\": 1,\n      \"uniqueItems\": true\n    },\n    \"type\": {\n      \"anyOf\": [\n        {\"$ref\": \"#/definitions/simpleTypes\"},\n        {\n          \"type\": \"array\",\n          \"items\": {\"$ref\": \"#/definitions/simpleTypes\"},\n          \"minItems\": 1,\n          \"uniqueItems\": true\n        }\n      ]\n    },\n    \"format\": {\"type\": \"string\"},\n    \"contentMediaType\": {\"type\": \"string\"},\n    \"contentEncoding\": {\"type\": \"string\"},\n    \"if\": {\"$ref\": \"#\"},\n    \"then\": {\"$ref\": \"#\"},\n    \"else\": {\"$ref\": \"#\"},\n    \"allOf\": {\"$ref\": \"#/definitions/schemaArray\"},\n    \"anyOf\": {\"$ref\": \"#/definitions/schemaArray\"},\n    \"oneOf\": {\"$ref\": \"#/definitions/schemaArray\"},\n    \"not\": {\"$ref\": \"#\"}\n  },\n  \"default\": true\n}\n","import type {AnySchemaObject} from \"./types\"\nimport AjvCore from \"./core\"\nimport draft7Vocabularies from \"./vocabularies/draft7\"\nimport discriminator from \"./vocabularies/discriminator\"\nimport * as draft7MetaSchema from \"./refs/json-schema-draft-07.json\"\n\nconst META_SUPPORT_DATA = [\"/properties\"]\n\nconst META_SCHEMA_ID = \"http://json-schema.org/draft-07/schema\"\n\nexport class Ajv extends AjvCore {\n  _addVocabularies(): void {\n    super._addVocabularies()\n    draft7Vocabularies.forEach((v) => this.addVocabulary(v))\n    if (this.opts.discriminator) this.addKeyword(discriminator)\n  }\n\n  _addDefaultMetaSchema(): void {\n    super._addDefaultMetaSchema()\n    if (!this.opts.meta) return\n    const metaSchema = this.opts.$data\n      ? this.$dataMetaSchema(draft7MetaSchema, META_SUPPORT_DATA)\n      : draft7MetaSchema\n    this.addMetaSchema(metaSchema, META_SCHEMA_ID, false)\n    this.refs[\"http://json-schema.org/schema\"] = META_SCHEMA_ID\n  }\n\n  defaultMeta(): string | AnySchemaObject | undefined {\n    return (this.opts.defaultMeta =\n      super.defaultMeta() || (this.getSchema(META_SCHEMA_ID) ? META_SCHEMA_ID : undefined))\n  }\n}\n\nmodule.exports = exports = Ajv\nmodule.exports.Ajv = Ajv\nObject.defineProperty(exports, \"__esModule\", {value: true})\n\nexport default Ajv\n\nexport {\n  Format,\n  FormatDefinition,\n  AsyncFormatDefinition,\n  KeywordDefinition,\n  KeywordErrorDefinition,\n  CodeKeywordDefinition,\n  MacroKeywordDefinition,\n  FuncKeywordDefinition,\n  Vocabulary,\n  Schema,\n  SchemaObject,\n  AnySchemaObject,\n  AsyncSchema,\n  AnySchema,\n  ValidateFunction,\n  AsyncValidateFunction,\n  SchemaValidateFunction,\n  ErrorObject,\n  ErrorNoParams,\n} from \"./types\"\n\nexport {Plugin, Options, CodeOptions, InstanceOptions, Logger, ErrorsTextOptions} from \"./core\"\nexport {SchemaCxt, SchemaObjCxt} from \"./compile\"\nexport {KeywordCxt} from \"./compile/validate\"\nexport {DefinedError} from \"./vocabularies/errors\"\nexport {JSONType} from \"./compile/rules\"\nexport {JSONSchemaType} from \"./types/json-schema\"\nexport {_, str, stringify, nil, Name, Code, CodeGen, CodeGenOptions} from \"./compile/codegen\"\nexport {default as ValidationError} from \"./runtime/validation_error\"\nexport {default as MissingRefError} from \"./compile/ref_error\"\n","import type {Format, FormatDefinition} from \"ajv\"\nimport type {FormatValidator, FormatCompare} from \"ajv/dist/types\"\n\nexport type FormatMode = \"fast\" | \"full\"\n\nexport type FormatName =\n  | \"date\"\n  | \"time\"\n  | \"date-time\"\n  | \"iso-time\"\n  | \"iso-date-time\"\n  | \"duration\"\n  | \"uri\"\n  | \"uri-reference\"\n  | \"uri-template\"\n  | \"url\"\n  | \"email\"\n  | \"hostname\"\n  | \"ipv4\"\n  | \"ipv6\"\n  | \"regex\"\n  | \"uuid\"\n  | \"json-pointer\"\n  | \"json-pointer-uri-fragment\"\n  | \"relative-json-pointer\"\n  | \"byte\"\n  | \"int32\"\n  | \"int64\"\n  | \"float\"\n  | \"double\"\n  | \"password\"\n  | \"binary\"\n\nexport type DefinedFormats = {\n  [key in FormatName]: Format\n}\n\nfunction fmtDef(\n  validate: RegExp | FormatValidator<string>,\n  compare: FormatCompare<string>\n): FormatDefinition<string> {\n  return {validate, compare}\n}\n\nexport const fullFormats: DefinedFormats = {\n  // date: http://tools.ietf.org/html/rfc3339#section-5.6\n  date: fmtDef(date, compareDate),\n  // date-time: http://tools.ietf.org/html/rfc3339#section-5.6\n  time: fmtDef(getTime(true), compareTime),\n  \"date-time\": fmtDef(getDateTime(true), compareDateTime),\n  \"iso-time\": fmtDef(getTime(), compareIsoTime),\n  \"iso-date-time\": fmtDef(getDateTime(), compareIsoDateTime),\n  // duration: https://tools.ietf.org/html/rfc3339#appendix-A\n  duration: /^P(?!$)((\\d+Y)?(\\d+M)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+S)?)?|(\\d+W)?)$/,\n  uri,\n  \"uri-reference\":\n    /^(?:[a-z][a-z0-9+\\-.]*:)?(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'\"()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\\?(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,\n  // uri-template: https://tools.ietf.org/html/rfc6570\n  \"uri-template\":\n    /^(?:(?:[^\\x00-\\x20\"'<>%\\\\^`{|}]|%[0-9a-f]{2})|\\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?)*\\})*$/i,\n  // For the source: https://gist.github.com/dperini/729294\n  // For test cases: https://mathiasbynens.be/demo/url-regex\n  url: /^(?:https?|ftp):\\/\\/(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)(?:\\.(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/iu,\n  email:\n    /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,\n  hostname:\n    /^(?=.{1,253}\\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\\.?$/i,\n  // optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html\n  ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)$/,\n  ipv6: /^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))$/i,\n  regex,\n  // uuid: http://tools.ietf.org/html/rfc4122\n  uuid: /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,\n  // JSON-pointer: https://tools.ietf.org/html/rfc6901\n  // uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A\n  \"json-pointer\": /^(?:\\/(?:[^~/]|~0|~1)*)*$/,\n  \"json-pointer-uri-fragment\": /^#(?:\\/(?:[a-z0-9_\\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,\n  // relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00\n  \"relative-json-pointer\": /^(?:0|[1-9][0-9]*)(?:#|(?:\\/(?:[^~/]|~0|~1)*)*)$/,\n  // the following formats are used by the openapi specification: https://spec.openapis.org/oas/v3.0.0#data-types\n  // byte: https://github.com/miguelmota/is-base64\n  byte,\n  // signed 32 bit integer\n  int32: {type: \"number\", validate: validateInt32},\n  // signed 64 bit integer\n  int64: {type: \"number\", validate: validateInt64},\n  // C-type float\n  float: {type: \"number\", validate: validateNumber},\n  // C-type double\n  double: {type: \"number\", validate: validateNumber},\n  // hint to the UI to hide input strings\n  password: true,\n  // unchecked string payload\n  binary: true,\n}\n\nexport const fastFormats: DefinedFormats = {\n  ...fullFormats,\n  date: fmtDef(/^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$/, compareDate),\n  time: fmtDef(\n    /^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)$/i,\n    compareTime\n  ),\n  \"date-time\": fmtDef(\n    /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\dt(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)$/i,\n    compareDateTime\n  ),\n  \"iso-time\": fmtDef(\n    /^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)?$/i,\n    compareIsoTime\n  ),\n  \"iso-date-time\": fmtDef(\n    /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d[t\\s](?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)?$/i,\n    compareIsoDateTime\n  ),\n  // uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js\n  uri: /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/)?[^\\s]*$/i,\n  \"uri-reference\": /^(?:(?:[a-z][a-z0-9+\\-.]*:)?\\/?\\/)?(?:[^\\\\\\s#][^\\s#]*)?(?:#[^\\\\\\s]*)?$/i,\n  // email (sources from jsen validator):\n  // http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363\n  // http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'wilful violation')\n  email:\n    /^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,\n}\n\nexport const formatNames = Object.keys(fullFormats) as FormatName[]\n\nfunction isLeapYear(year: number): boolean {\n  // https://tools.ietf.org/html/rfc3339#appendix-C\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)\n}\n\nconst DATE = /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/\nconst DAYS = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\n\nfunction date(str: string): boolean {\n  // full-date from http://tools.ietf.org/html/rfc3339#section-5.6\n  const matches: string[] | null = DATE.exec(str)\n  if (!matches) return false\n  const year: number = +matches[1]\n  const month: number = +matches[2]\n  const day: number = +matches[3]\n  return (\n    month >= 1 &&\n    month <= 12 &&\n    day >= 1 &&\n    day <= (month === 2 && isLeapYear(year) ? 29 : DAYS[month])\n  )\n}\n\nfunction compareDate(d1: string, d2: string): number | undefined {\n  if (!(d1 && d2)) return undefined\n  if (d1 > d2) return 1\n  if (d1 < d2) return -1\n  return 0\n}\n\nconst TIME = /^(\\d\\d):(\\d\\d):(\\d\\d(?:\\.\\d+)?)(z|([+-])(\\d\\d)(?::?(\\d\\d))?)?$/i\n\nfunction getTime(strictTimeZone?: boolean): (str: string) => boolean {\n  return function time(str: string): boolean {\n    const matches: string[] | null = TIME.exec(str)\n    if (!matches) return false\n    const hr: number = +matches[1]\n    const min: number = +matches[2]\n    const sec: number = +matches[3]\n    const tz: string | undefined = matches[4]\n    const tzSign: number = matches[5] === \"-\" ? -1 : 1\n    const tzH: number = +(matches[6] || 0)\n    const tzM: number = +(matches[7] || 0)\n    if (tzH > 23 || tzM > 59 || (strictTimeZone && !tz)) return false\n    if (hr <= 23 && min <= 59 && sec < 60) return true\n    // leap second\n    const utcMin = min - tzM * tzSign\n    const utcHr = hr - tzH * tzSign - (utcMin < 0 ? 1 : 0)\n    return (utcHr === 23 || utcHr === -1) && (utcMin === 59 || utcMin === -1) && sec < 61\n  }\n}\n\nfunction compareTime(s1: string, s2: string): number | undefined {\n  if (!(s1 && s2)) return undefined\n  const t1 = new Date(\"2020-01-01T\" + s1).valueOf()\n  const t2 = new Date(\"2020-01-01T\" + s2).valueOf()\n  if (!(t1 && t2)) return undefined\n  return t1 - t2\n}\n\nfunction compareIsoTime(t1: string, t2: string): number | undefined {\n  if (!(t1 && t2)) return undefined\n  const a1 = TIME.exec(t1)\n  const a2 = TIME.exec(t2)\n  if (!(a1 && a2)) return undefined\n  t1 = a1[1] + a1[2] + a1[3]\n  t2 = a2[1] + a2[2] + a2[3]\n  if (t1 > t2) return 1\n  if (t1 < t2) return -1\n  return 0\n}\n\nconst DATE_TIME_SEPARATOR = /t|\\s/i\nfunction getDateTime(strictTimeZone?: boolean): (str: string) => boolean {\n  const time = getTime(strictTimeZone)\n\n  return function date_time(str: string): boolean {\n    // http://tools.ietf.org/html/rfc3339#section-5.6\n    const dateTime: string[] = str.split(DATE_TIME_SEPARATOR)\n    return dateTime.length === 2 && date(dateTime[0]) && time(dateTime[1])\n  }\n}\n\nfunction compareDateTime(dt1: string, dt2: string): number | undefined {\n  if (!(dt1 && dt2)) return undefined\n  const d1 = new Date(dt1).valueOf()\n  const d2 = new Date(dt2).valueOf()\n  if (!(d1 && d2)) return undefined\n  return d1 - d2\n}\n\nfunction compareIsoDateTime(dt1: string, dt2: string): number | undefined {\n  if (!(dt1 && dt2)) return undefined\n  const [d1, t1] = dt1.split(DATE_TIME_SEPARATOR)\n  const [d2, t2] = dt2.split(DATE_TIME_SEPARATOR)\n  const res = compareDate(d1, d2)\n  if (res === undefined) return undefined\n  return res || compareTime(t1, t2)\n}\n\nconst NOT_URI_FRAGMENT = /\\/|:/\nconst URI =\n  /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\\?(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i\n\nfunction uri(str: string): boolean {\n  // http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required \".\"\n  return NOT_URI_FRAGMENT.test(str) && URI.test(str)\n}\n\nconst BYTE = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm\n\nfunction byte(str: string): boolean {\n  BYTE.lastIndex = 0\n  return BYTE.test(str)\n}\n\nconst MIN_INT32 = -(2 ** 31)\nconst MAX_INT32 = 2 ** 31 - 1\n\nfunction validateInt32(value: number): boolean {\n  return Number.isInteger(value) && value <= MAX_INT32 && value >= MIN_INT32\n}\n\nfunction validateInt64(value: number): boolean {\n  // JSON and javascript max Int is 2**53, so any int that passes isInteger is valid for Int64\n  return Number.isInteger(value)\n}\n\nfunction validateNumber(): boolean {\n  return true\n}\n\nconst Z_ANCHOR = /[^\\\\]\\\\Z/\nfunction regex(str: string): boolean {\n  if (Z_ANCHOR.test(str)) return false\n  try {\n    new RegExp(str)\n    return true\n  } catch (e) {\n    return false\n  }\n}\n","import type Ajv from \"ajv\"\nimport type {\n  Plugin,\n  CodeKeywordDefinition,\n  KeywordErrorDefinition,\n  Code,\n  Name,\n  ErrorObject,\n} from \"ajv\"\nimport type {AddedFormat} from \"ajv/dist/types\"\nimport type {Rule} from \"ajv/dist/compile/rules\"\nimport {KeywordCxt} from \"ajv\"\nimport {_, str, or, getProperty, operators} from \"ajv/dist/compile/codegen\"\n\ntype Kwd = \"formatMaximum\" | \"formatMinimum\" | \"formatExclusiveMaximum\" | \"formatExclusiveMinimum\"\n\ntype Comparison = \"<=\" | \">=\" | \"<\" | \">\"\n\nconst ops = operators\n\nconst KWDs: {[K in Kwd]: {okStr: Comparison; ok: Code; fail: Code}} = {\n  formatMaximum: {okStr: \"<=\", ok: ops.LTE, fail: ops.GT},\n  formatMinimum: {okStr: \">=\", ok: ops.GTE, fail: ops.LT},\n  formatExclusiveMaximum: {okStr: \"<\", ok: ops.LT, fail: ops.GTE},\n  formatExclusiveMinimum: {okStr: \">\", ok: ops.GT, fail: ops.LTE},\n}\n\nexport type LimitFormatError = ErrorObject<Kwd, {limit: string; comparison: Comparison}>\n\nconst error: KeywordErrorDefinition = {\n  message: ({keyword, schemaCode}) => str`should be ${KWDs[keyword as Kwd].okStr} ${schemaCode}`,\n  params: ({keyword, schemaCode}) =>\n    _`{comparison: ${KWDs[keyword as Kwd].okStr}, limit: ${schemaCode}}`,\n}\n\nexport const formatLimitDefinition: CodeKeywordDefinition = {\n  keyword: Object.keys(KWDs),\n  type: \"string\",\n  schemaType: \"string\",\n  $data: true,\n  error,\n  code(cxt) {\n    const {gen, data, schemaCode, keyword, it} = cxt\n    const {opts, self} = it\n    if (!opts.validateFormats) return\n\n    const fCxt = new KeywordCxt(it, (self.RULES.all.format as Rule).definition, \"format\")\n    if (fCxt.$data) validate$DataFormat()\n    else validateFormat()\n\n    function validate$DataFormat(): void {\n      const fmts = gen.scopeValue(\"formats\", {\n        ref: self.formats,\n        code: opts.code.formats,\n      })\n      const fmt = gen.const(\"fmt\", _`${fmts}[${fCxt.schemaCode}]`)\n      cxt.fail$data(\n        or(\n          _`typeof ${fmt} != \"object\"`,\n          _`${fmt} instanceof RegExp`,\n          _`typeof ${fmt}.compare != \"function\"`,\n          compareCode(fmt)\n        )\n      )\n    }\n\n    function validateFormat(): void {\n      const format = fCxt.schema as string\n      const fmtDef: AddedFormat | undefined = self.formats[format]\n      if (!fmtDef || fmtDef === true) return\n      if (\n        typeof fmtDef != \"object\" ||\n        fmtDef instanceof RegExp ||\n        typeof fmtDef.compare != \"function\"\n      ) {\n        throw new Error(`\"${keyword}\": format \"${format}\" does not define \"compare\" function`)\n      }\n      const fmt = gen.scopeValue(\"formats\", {\n        key: format,\n        ref: fmtDef,\n        code: opts.code.formats ? _`${opts.code.formats}${getProperty(format)}` : undefined,\n      })\n\n      cxt.fail$data(compareCode(fmt))\n    }\n\n    function compareCode(fmt: Name): Code {\n      return _`${fmt}.compare(${data}, ${schemaCode}) ${KWDs[keyword as Kwd].fail} 0`\n    }\n  },\n  dependencies: [\"format\"],\n}\n\nconst formatLimitPlugin: Plugin<undefined> = (ajv: Ajv): Ajv => {\n  ajv.addKeyword(formatLimitDefinition)\n  return ajv\n}\n\nexport default formatLimitPlugin\n","import {\n  DefinedFormats,\n  FormatMode,\n  FormatName,\n  formatNames,\n  fastFormats,\n  fullFormats,\n} from \"./formats\"\nimport formatLimit from \"./limit\"\nimport type Ajv from \"ajv\"\nimport type {Plugin, Format} from \"ajv\"\nimport {_, Name} from \"ajv/dist/compile/codegen\"\n\nexport {FormatMode, FormatName} from \"./formats\"\nexport {LimitFormatError} from \"./limit\"\nexport interface FormatOptions {\n  mode?: FormatMode\n  formats?: FormatName[]\n  keywords?: boolean\n}\n\nexport type FormatsPluginOptions = FormatName[] | FormatOptions\n\nexport interface FormatsPlugin extends Plugin<FormatsPluginOptions> {\n  get: (format: FormatName, mode?: FormatMode) => Format\n}\n\nconst fullName = new Name(\"fullFormats\")\nconst fastName = new Name(\"fastFormats\")\n\nconst formatsPlugin: FormatsPlugin = (\n  ajv: Ajv,\n  opts: FormatsPluginOptions = {keywords: true}\n): Ajv => {\n  if (Array.isArray(opts)) {\n    addFormats(ajv, opts, fullFormats, fullName)\n    return ajv\n  }\n  const [formats, exportName] =\n    opts.mode === \"fast\" ? [fastFormats, fastName] : [fullFormats, fullName]\n  const list = opts.formats || formatNames\n  addFormats(ajv, list, formats, exportName)\n  if (opts.keywords) formatLimit(ajv)\n  return ajv\n}\n\nformatsPlugin.get = (name: FormatName, mode: FormatMode = \"full\"): Format => {\n  const formats = mode === \"fast\" ? fastFormats : fullFormats\n  const f = formats[name]\n  if (!f) throw new Error(`Unknown format \"${name}\"`)\n  return f\n}\n\nfunction addFormats(ajv: Ajv, list: FormatName[], fs: DefinedFormats, exportName: Name): void {\n  ajv.opts.code.formats ??= _`require(\"ajv-formats/dist/formats\").${exportName}`\n  for (const f of list) ajv.addFormat(f, fs[f])\n}\n\nmodule.exports = exports = formatsPlugin\nObject.defineProperty(exports, \"__esModule\", {value: true})\n\nexport default formatsPlugin\n","/**\n * Text Handler\n *\n * Handles plain text formats: txt, md, json, xml, yaml, yml.\n * No external dependencies needed.\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport type {\n  IFormatHandler,\n  DocumentFormat,\n  DocumentReadOptions,\n  DocumentPiece,\n} from '../types.js';\n\nconst CODE_FENCE_FORMATS: Record<string, string> = {\n  json: 'json',\n  xml: 'xml',\n  yaml: 'yaml',\n  yml: 'yaml',\n};\n\nexport class TextHandler implements IFormatHandler {\n  readonly name = 'TextHandler';\n  readonly supportedFormats: DocumentFormat[] = ['txt', 'md', 'json', 'xml', 'yaml', 'yml'];\n\n  async handle(\n    buffer: Buffer,\n    filename: string,\n    format: DocumentFormat,\n    _options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const text = buffer.toString('utf-8');\n    const fenceLanguage = CODE_FENCE_FORMATS[format];\n\n    const content = fenceLanguage\n      ? `\\`\\`\\`${fenceLanguage}\\n${text}\\n\\`\\`\\``\n      : text;\n\n    const sizeBytes = Buffer.byteLength(content, 'utf-8');\n\n    return [\n      {\n        type: 'text',\n        content,\n        metadata: {\n          sourceFilename: filename,\n          format,\n          index: 0,\n          sizeBytes,\n          estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n        },\n      },\n    ];\n  }\n}\n","/**\n * Image Handler\n *\n * Handles image formats: png, jpg, jpeg, gif, webp, svg.\n * Pass-through as base64 image pieces; SVG also included as text.\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport type {\n  IFormatHandler,\n  DocumentFormat,\n  DocumentReadOptions,\n  DocumentPiece,\n} from '../types.js';\n\nconst MIME_TYPES: Record<string, string> = {\n  png: 'image/png',\n  jpg: 'image/jpeg',\n  jpeg: 'image/jpeg',\n  gif: 'image/gif',\n  webp: 'image/webp',\n  svg: 'image/svg+xml',\n};\n\nexport class ImageHandler implements IFormatHandler {\n  readonly name = 'ImageHandler';\n  readonly supportedFormats: DocumentFormat[] = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'svg'];\n\n  async handle(\n    buffer: Buffer,\n    filename: string,\n    format: DocumentFormat,\n    _options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const pieces: DocumentPiece[] = [];\n    const mimeType = MIME_TYPES[format] || 'application/octet-stream';\n\n    // Add image piece\n    pieces.push({\n      type: 'image',\n      base64: buffer.toString('base64'),\n      mimeType,\n      metadata: {\n        sourceFilename: filename,\n        format,\n        index: 0,\n        sizeBytes: buffer.length,\n        estimatedTokens: DOCUMENT_DEFAULTS.IMAGE_TOKENS_AUTO,\n        label: filename,\n      },\n    });\n\n    // For SVG, also add the text representation\n    if (format === 'svg') {\n      const svgText = buffer.toString('utf-8');\n      const sizeBytes = Buffer.byteLength(svgText, 'utf-8');\n      pieces.push({\n        type: 'text',\n        content: `\\`\\`\\`svg\\n${svgText}\\n\\`\\`\\``,\n        metadata: {\n          sourceFilename: filename,\n          format,\n          index: 1,\n          section: 'SVG source',\n          sizeBytes,\n          estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n        },\n      });\n    }\n\n    return pieces;\n  }\n}\n","/**\n * HTML to Markdown conversion utilities\n * Uses Readability for article extraction and Turndown for markdown conversion\n */\n\nimport TurndownService from 'turndown';\nimport { Readability } from '@mozilla/readability';\nimport type { Node as TurndownNode } from 'turndown';\n\n// Lazy-loaded jsdom to avoid bundling issues in Electron\nlet JSDOM: typeof import('jsdom').JSDOM | null = null;\n\nasync function getJSDOM(): Promise<typeof import('jsdom').JSDOM> {\n  if (!JSDOM) {\n    const jsdom = await import('jsdom');\n    JSDOM = jsdom.JSDOM;\n  }\n  return JSDOM;\n}\n\nexport interface MarkdownResult {\n  markdown: string;\n  title: string;\n  byline?: string;\n  excerpt?: string;\n  wasReadabilityUsed: boolean;\n  wasTruncated: boolean;\n}\n\n/**\n * Convert HTML to clean markdown\n *\n * Uses Readability to extract main article content (strips ads, nav, footer, etc.)\n * then converts to markdown with Turndown.\n *\n * @param html - Raw HTML string\n * @param url - URL of the page (used for resolving relative links)\n * @param maxLength - Maximum length of output markdown (default: 50000)\n * @returns MarkdownResult with cleaned content\n */\nexport async function htmlToMarkdown(\n  html: string,\n  url: string,\n  maxLength: number = 50000\n): Promise<MarkdownResult> {\n  // 1. Parse HTML with JSDOM (lazy-loaded)\n  const JSDOMClass = await getJSDOM();\n  const dom = new JSDOMClass(html, { url });\n  const document = dom.window.document;\n\n  let title = document.title || '';\n  let byline: string | undefined;\n  let excerpt: string | undefined;\n  let contentHtml = html;\n  let wasReadabilityUsed = false;\n\n  // 2. Try Readability for article extraction (strips ads, nav, footer, etc.)\n  try {\n    // Clone document for Readability (it modifies the DOM)\n    const clonedDoc = document.cloneNode(true) as typeof document;\n    const reader = new Readability(clonedDoc);\n    const article = reader.parse();\n\n    if (article && article.content && article.content.length > 100) {\n      contentHtml = article.content;\n      title = article.title || title;\n      byline = article.byline || undefined;\n      excerpt = article.excerpt || undefined;\n      wasReadabilityUsed = true;\n    }\n  } catch {\n    // Readability failed, use full HTML\n  }\n\n  // 3. Convert to Markdown with Turndown\n  const turndown = new TurndownService({\n    headingStyle: 'atx',\n    codeBlockStyle: 'fenced',\n    bulletListMarker: '-',\n    emDelimiter: '_',\n  });\n\n  // Remove script, style, nav, footer, aside, iframe tags\n  turndown.remove(['script', 'style', 'nav', 'footer', 'aside', 'iframe', 'noscript']);\n\n  // Custom rule for code blocks to preserve formatting\n  turndown.addRule('pre', {\n    filter: ['pre'],\n    replacement: (content: string, node: TurndownNode) => {\n      const element = node as unknown as Element;\n      const code = element.querySelector?.('code');\n      const lang = code?.className?.match(/language-(\\w+)/)?.[1] || '';\n      const text = code?.textContent || content;\n      return `\\n\\`\\`\\`${lang}\\n${text}\\n\\`\\`\\`\\n`;\n    },\n  });\n\n  // Convert to markdown\n  let markdown = turndown.turndown(contentHtml);\n\n  // 4. Clean up excessive whitespace\n  markdown = markdown\n    .replace(/\\n{3,}/g, '\\n\\n') // Max 2 consecutive newlines\n    .replace(/^\\s+|\\s+$/g, '') // Trim start/end\n    .replace(/[ \\t]+$/gm, ''); // Remove trailing spaces on lines\n\n  // 5. Truncate at paragraph boundary if needed\n  let wasTruncated = false;\n  if (markdown.length > maxLength) {\n    // Find last paragraph break before maxLength\n    const truncateAt = markdown.lastIndexOf('\\n\\n', maxLength);\n    if (truncateAt > maxLength * 0.5) {\n      markdown = markdown.slice(0, truncateAt) + '\\n\\n...[content truncated]';\n    } else {\n      // No good break point, just truncate\n      markdown = markdown.slice(0, maxLength) + '...[truncated]';\n    }\n    wasTruncated = true;\n  }\n\n  return {\n    markdown,\n    title,\n    byline,\n    excerpt,\n    wasReadabilityUsed,\n    wasTruncated,\n  };\n}\n\n/**\n * Quick check if HTML likely needs JavaScript rendering\n * (Useful for fallback decisions)\n */\nexport function likelyNeedsJavaScript(html: string): boolean {\n  const jsFrameworkPatterns = [\n    /__NEXT_DATA__/i,\n    /\\breact-root\\b/i,\n    /\\bng-app\\b/i,\n    /\\bdata-v-/i, // Vue scoped styles\n    /\\bapp-root\\b/i,\n    /\\bnuxt\\b/i,\n  ];\n\n  return jsFrameworkPatterns.some((pattern) => pattern.test(html));\n}\n","/**\n * HTML Handler\n *\n * Wraps existing htmlToMarkdown() utility.\n * No additional dependencies needed.\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport { htmlToMarkdown } from '../../../tools/web/htmlToMarkdown.js';\nimport type {\n  IFormatHandler,\n  DocumentFormat,\n  DocumentReadOptions,\n  DocumentPiece,\n} from '../types.js';\n\nexport class HTMLHandler implements IFormatHandler {\n  readonly name = 'HTMLHandler';\n  readonly supportedFormats: DocumentFormat[] = ['html'];\n\n  async handle(\n    buffer: Buffer,\n    filename: string,\n    format: DocumentFormat,\n    options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const html = buffer.toString('utf-8');\n    const maxLength = options.formatOptions?.html?.maxLength ?? DOCUMENT_DEFAULTS.MAX_HTML_LENGTH;\n\n    const result = await htmlToMarkdown(html, `file://${filename}`, maxLength);\n\n    const content = result.markdown;\n    const sizeBytes = Buffer.byteLength(content, 'utf-8');\n\n    return [\n      {\n        type: 'text',\n        content,\n        metadata: {\n          sourceFilename: filename,\n          format,\n          index: 0,\n          sizeBytes,\n          estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n          label: result.title || undefined,\n        },\n      },\n    ];\n  }\n}\n","/**\n * Office Handler\n *\n * Handles office formats: docx, pptx, odt, odp, ods, rtf.\n * Uses officeparser (lazy-loaded) for AST-based extraction.\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport type {\n  IFormatHandler,\n  DocumentFormat,\n  DocumentReadOptions,\n  DocumentPiece,\n} from '../types.js';\n\n// Lazy-loaded officeparser\nlet parseOffice: ((file: Buffer, config?: any) => Promise<any>) | null = null;\n\nasync function getParseOffice(): Promise<(file: Buffer, config?: any) => Promise<any>> {\n  if (!parseOffice) {\n    const mod = await import('officeparser');\n    parseOffice = mod.parseOffice;\n  }\n  return parseOffice;\n}\n\nexport class OfficeHandler implements IFormatHandler {\n  readonly name = 'OfficeHandler';\n  readonly supportedFormats: DocumentFormat[] = ['docx', 'pptx', 'odt', 'odp', 'ods', 'rtf'];\n\n  async handle(\n    buffer: Buffer,\n    filename: string,\n    format: DocumentFormat,\n    options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const parse = await getParseOffice();\n\n    const extractImages = options.extractImages !== false;\n    const includeSpeakerNotes = options.formatOptions?.office?.includeSpeakerNotes !== false;\n\n    const ast = await parse(buffer, {\n      extractAttachments: extractImages,\n      ignoreNotes: !includeSpeakerNotes,\n    });\n\n    const pieces: DocumentPiece[] = [];\n    let pieceIndex = 0;\n\n    // Convert AST content nodes to markdown\n    const content = ast.content || [];\n    const markdown = this.astToMarkdown(content, format);\n\n    if (format === 'pptx' || format === 'odp') {\n      // Split by slides\n      const slides = this.splitBySlides(content);\n      for (let i = 0; i < slides.length; i++) {\n        const slideContent = this.astToMarkdown(slides[i] ?? [], format);\n        if (slideContent.trim()) {\n          const sizeBytes = Buffer.byteLength(slideContent, 'utf-8');\n          pieces.push({\n            type: 'text',\n            content: slideContent,\n            metadata: {\n              sourceFilename: filename,\n              format,\n              index: pieceIndex++,\n              section: `Slide ${i + 1}`,\n              sizeBytes,\n              estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n            },\n          });\n        }\n      }\n    } else {\n      // Single text piece for other formats\n      if (markdown.trim()) {\n        const sizeBytes = Buffer.byteLength(markdown, 'utf-8');\n        pieces.push({\n          type: 'text',\n          content: markdown,\n          metadata: {\n            sourceFilename: filename,\n            format,\n            index: pieceIndex++,\n            sizeBytes,\n            estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n          },\n        });\n      }\n    }\n\n    // Extract images from attachments\n    if (extractImages && ast.attachments?.length > 0) {\n      for (const attachment of ast.attachments) {\n        if (attachment.type === 'image' && attachment.data) {\n          const imageData = attachment.data;\n          const sizeBytes = Math.ceil(imageData.length * 0.75); // base64  bytes estimate\n          pieces.push({\n            type: 'image',\n            base64: imageData,\n            mimeType: attachment.mimeType || 'image/png',\n            metadata: {\n              sourceFilename: filename,\n              format,\n              index: pieceIndex++,\n              sizeBytes,\n              estimatedTokens: DOCUMENT_DEFAULTS.IMAGE_TOKENS_AUTO,\n              label: attachment.altText || attachment.name || undefined,\n            },\n          });\n        }\n      }\n    }\n\n    return pieces;\n  }\n\n  /**\n   * Split AST content into slide groups\n   */\n  private splitBySlides(content: any[]): any[][] {\n    const slides: any[][] = [];\n    let currentSlide: any[] = [];\n\n    for (const node of content) {\n      if (node.type === 'slide') {\n        if (currentSlide.length > 0) {\n          slides.push(currentSlide);\n        }\n        currentSlide = [node];\n      } else {\n        currentSlide.push(node);\n      }\n    }\n\n    if (currentSlide.length > 0) {\n      slides.push(currentSlide);\n    }\n\n    // If no slide nodes found, return all content as one group\n    if (slides.length === 0 && content.length > 0) {\n      slides.push(content);\n    }\n\n    return slides;\n  }\n\n  /**\n   * Convert AST nodes to markdown\n   */\n  private astToMarkdown(nodes: any[], format: DocumentFormat): string {\n    const parts: string[] = [];\n\n    for (const node of nodes) {\n      const md = this.nodeToMarkdown(node, format);\n      if (md) parts.push(md);\n    }\n\n    return parts.join('\\n\\n');\n  }\n\n  /**\n   * Convert a single AST node to markdown\n   */\n  private nodeToMarkdown(node: any, format: DocumentFormat): string {\n    if (!node) return '';\n\n    switch (node.type) {\n      case 'heading': {\n        const level = node.metadata?.level || 1;\n        const prefix = '#'.repeat(Math.min(level, 6));\n        return `${prefix} ${node.text || ''}`;\n      }\n\n      case 'paragraph':\n        return this.formatText(node);\n\n      case 'text':\n        return this.formatText(node);\n\n      case 'list': {\n        const items = node.children || [];\n        return items\n          .map((item: any, i: number) => {\n            const indent = '  '.repeat(node.metadata?.indentation || 0);\n            const prefix = node.metadata?.listType === 'ordered' ? `${i + 1}.` : '-';\n            return `${indent}${prefix} ${item.text || this.getNodeText(item)}`;\n          })\n          .join('\\n');\n      }\n\n      case 'table': {\n        return this.tableToMarkdown(node);\n      }\n\n      case 'slide': {\n        const slideNum = node.metadata?.slideNumber || '';\n        const childContent = node.children\n          ? node.children.map((c: any) => this.nodeToMarkdown(c, format)).filter(Boolean).join('\\n\\n')\n          : (node.text || '');\n        return slideNum ? `### Slide ${slideNum}\\n\\n${childContent}` : childContent;\n      }\n\n      case 'note':\n        return `> **Note:** ${node.text || this.getNodeText(node)}`;\n\n      case 'sheet': {\n        const sheetName = node.metadata?.sheetName || 'Sheet';\n        const childContent = node.children\n          ? node.children.map((c: any) => this.nodeToMarkdown(c, format)).filter(Boolean).join('\\n')\n          : '';\n        return `## Sheet: ${sheetName}\\n\\n${childContent}`;\n      }\n\n      case 'page': {\n        const pageNum = node.metadata?.pageNumber || '';\n        const childContent = node.children\n          ? node.children.map((c: any) => this.nodeToMarkdown(c, format)).filter(Boolean).join('\\n\\n')\n          : (node.text || '');\n        return pageNum ? `--- Page ${pageNum} ---\\n\\n${childContent}` : childContent;\n      }\n\n      case 'image':\n        return `[Image: ${node.metadata?.altText || node.metadata?.attachmentName || 'embedded image'}]`;\n\n      case 'chart':\n        return `[Chart: ${node.metadata?.attachmentName || 'embedded chart'}]`;\n\n      default:\n        return node.text || this.getNodeText(node);\n    }\n  }\n\n  /**\n   * Get text from a node recursively\n   */\n  private getNodeText(node: any): string {\n    if (node.text) return node.text;\n    if (node.children) {\n      return node.children.map((c: any) => this.getNodeText(c)).join('');\n    }\n    return '';\n  }\n\n  /**\n   * Format text with markdown formatting\n   */\n  private formatText(node: any): string {\n    if (!node.children || node.children.length === 0) {\n      return node.text || '';\n    }\n\n    return node.children.map((child: any) => {\n      let text = child.text || this.getNodeText(child);\n      if (!text) return '';\n\n      const fmt = child.formatting;\n      if (fmt) {\n        if (fmt.bold) text = `**${text}**`;\n        if (fmt.italic) text = `_${text}_`;\n        if (fmt.strikethrough) text = `~~${text}~~`;\n      }\n\n      // Handle hyperlinks\n      if (child.metadata?.link && child.metadata?.linkType === 'external') {\n        text = `[${text}](${child.metadata.link})`;\n      }\n\n      return text;\n    }).join('');\n  }\n\n  /**\n   * Convert table node to markdown table\n   */\n  private tableToMarkdown(node: any): string {\n    if (!node.children || node.children.length === 0) return '';\n\n    const rows: string[][] = [];\n    for (const row of node.children) {\n      if (row.type === 'row' && row.children) {\n        rows.push(row.children.map((cell: any) => {\n          const text = cell.text || this.getNodeText(cell);\n          // Escape pipes in cell content\n          return text.replace(/\\|/g, '\\\\|').trim();\n        }));\n      }\n    }\n\n    if (rows.length === 0) return '';\n\n    // Build markdown table\n    const maxCols = Math.max(...rows.map((r) => r.length));\n    const normalizedRows = rows.map((r) => {\n      while (r.length < maxCols) r.push('');\n      return r;\n    });\n\n    const firstRow = normalizedRows[0] ?? [];\n    const header = `| ${firstRow.join(' | ')} |`;\n    const separator = `| ${firstRow.map(() => '---').join(' | ')} |`;\n    const body = normalizedRows.slice(1).map((r) => `| ${r.join(' | ')} |`).join('\\n');\n\n    return body ? `${header}\\n${separator}\\n${body}` : `${header}\\n${separator}`;\n  }\n}\n","/**\n * Excel Handler\n *\n * Handles spreadsheet formats: xlsx, csv.\n * Uses exceljs (lazy-loaded) for typed cell values and sheet names.\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport type {\n  IFormatHandler,\n  DocumentFormat,\n  DocumentReadOptions,\n  DocumentPiece,\n} from '../types.js';\n\n// Lazy-loaded exceljs\nlet ExcelJS: any = null;\n\nasync function getExcelJS(): Promise<any> {\n  if (!ExcelJS) {\n    ExcelJS = await import('exceljs');\n  }\n  return ExcelJS;\n}\n\nexport class ExcelHandler implements IFormatHandler {\n  readonly name = 'ExcelHandler';\n  readonly supportedFormats: DocumentFormat[] = ['xlsx', 'csv'];\n\n  async handle(\n    buffer: Buffer,\n    filename: string,\n    format: DocumentFormat,\n    options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const exceljs = await getExcelJS();\n    const Workbook = exceljs.Workbook || exceljs.default?.Workbook;\n\n    const excelOpts = {\n      maxRows: options.formatOptions?.excel?.maxRows ?? DOCUMENT_DEFAULTS.MAX_EXCEL_ROWS,\n      maxColumns: options.formatOptions?.excel?.maxColumns ?? DOCUMENT_DEFAULTS.MAX_EXCEL_COLUMNS,\n      tableFormat: options.formatOptions?.excel?.tableFormat ?? 'markdown' as const,\n      includeFormulas: options.formatOptions?.excel?.includeFormulas ?? false,\n    };\n\n    const workbook = new Workbook();\n\n    if (format === 'csv') {\n      await workbook.csv.read(\n        new (await import('node:stream')).Readable({\n          read() {\n            this.push(buffer);\n            this.push(null);\n          },\n        })\n      );\n    } else {\n      await workbook.xlsx.load(buffer);\n    }\n\n    const pieces: DocumentPiece[] = [];\n    let pieceIndex = 0;\n\n    // Filter sheets if specific pages requested\n    const requestedSheets = options.pages;\n\n    workbook.eachSheet((worksheet: any, sheetId: number) => {\n      // Check if sheet is requested\n      if (requestedSheets && requestedSheets.length > 0) {\n        const isRequested = requestedSheets.some((p) => {\n          if (typeof p === 'number') return sheetId === p;\n          return worksheet.name === p || String(sheetId) === p;\n        });\n        if (!isRequested) return;\n      }\n\n      const content = this.sheetToContent(worksheet, excelOpts);\n      if (!content.trim()) return;\n\n      const sheetContent = format === 'csv'\n        ? content\n        : `## Sheet: ${worksheet.name}\\n\\n${content}`;\n\n      const sizeBytes = Buffer.byteLength(sheetContent, 'utf-8');\n      pieces.push({\n        type: 'text',\n        content: sheetContent,\n        metadata: {\n          sourceFilename: filename,\n          format,\n          index: pieceIndex++,\n          section: format === 'csv' ? undefined : worksheet.name,\n          sizeBytes,\n          estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n        },\n      });\n    });\n\n    return pieces;\n  }\n\n  /**\n   * Convert a worksheet to the configured format\n   */\n  private sheetToContent(worksheet: any, opts: { maxRows: number; maxColumns: number; tableFormat: string; includeFormulas: boolean }): string {\n    switch (opts.tableFormat) {\n      case 'csv':\n        return this.sheetToCSV(worksheet, opts);\n      case 'json':\n        return this.sheetToJSON(worksheet, opts);\n      default:\n        return this.sheetToMarkdownTable(worksheet, opts);\n    }\n  }\n\n  /**\n   * Convert worksheet to markdown table\n   */\n  private sheetToMarkdownTable(worksheet: any, opts: { maxRows: number; maxColumns: number; tableFormat: string; includeFormulas: boolean }): string {\n    const rows = this.extractRows(worksheet, opts);\n    if (rows.length === 0) return '';\n\n    // Normalize column count\n    const maxCols = Math.min(\n      Math.max(...rows.map((r) => r.length)),\n      opts.maxColumns\n    );\n\n    const normalizedRows = rows.map((r) => {\n      const truncated = r.slice(0, maxCols);\n      while (truncated.length < maxCols) truncated.push('');\n      return truncated;\n    });\n\n    // Build markdown table\n    const firstRow = normalizedRows[0] ?? [];\n    const header = `| ${firstRow.join(' | ')} |`;\n    const separator = `| ${firstRow.map(() => '---').join(' | ')} |`;\n    const body = normalizedRows\n      .slice(1)\n      .map((r) => `| ${r.join(' | ')} |`)\n      .join('\\n');\n\n    let result = `${header}\\n${separator}`;\n    if (body) result += `\\n${body}`;\n\n    if (worksheet.rowCount > opts.maxRows) {\n      result += `\\n\\n_...truncated (${worksheet.rowCount - opts.maxRows} more rows)_`;\n    }\n\n    return result;\n  }\n\n  /**\n   * Convert worksheet to CSV\n   */\n  private sheetToCSV(worksheet: any, opts: { maxRows: number; maxColumns: number; tableFormat: string; includeFormulas: boolean }): string {\n    const rows = this.extractRows(worksheet, opts);\n    return rows\n      .map((row) =>\n        row\n          .slice(0, opts.maxColumns)\n          .map((cell) => {\n            // Escape CSV values\n            if (cell.includes(',') || cell.includes('\"') || cell.includes('\\n')) {\n              return `\"${cell.replace(/\"/g, '\"\"')}\"`;\n            }\n            return cell;\n          })\n          .join(',')\n      )\n      .join('\\n');\n  }\n\n  /**\n   * Convert worksheet to JSON\n   */\n  private sheetToJSON(worksheet: any, opts: { maxRows: number; maxColumns: number; tableFormat: string; includeFormulas: boolean }): string {\n    const rows = this.extractRows(worksheet, opts);\n    if (rows.length < 2) return '[]';\n\n    const headers = (rows[0] ?? []).slice(0, opts.maxColumns);\n    const data = rows.slice(1).map((row) => {\n      const obj: Record<string, string> = {};\n      headers.forEach((header, i) => {\n        if (header && i < row.length) {\n          obj[header] = row[i] ?? '';\n        }\n      });\n      return obj;\n    });\n\n    return '```json\\n' + JSON.stringify(data, null, 2) + '\\n```';\n  }\n\n  /**\n   * Extract rows from worksheet as string arrays\n   */\n  private extractRows(worksheet: any, opts: { maxRows: number; maxColumns: number; tableFormat: string; includeFormulas: boolean }): string[][] {\n    const rows: string[][] = [];\n    let rowCount = 0;\n\n    worksheet.eachRow({ includeEmpty: false }, (row: any) => {\n      if (rowCount >= opts.maxRows) return;\n      rowCount++;\n\n      const cells: string[] = [];\n      row.eachCell({ includeEmpty: true }, (cell: any, colNumber: number) => {\n        if (colNumber > opts.maxColumns) return;\n\n        let value = '';\n        if (opts.includeFormulas && cell.formula) {\n          value = `${this.getCellValue(cell)} (=${cell.formula})`;\n        } else {\n          value = this.getCellValue(cell);\n        }\n\n        // Ensure cells array is properly filled\n        while (cells.length < colNumber - 1) cells.push('');\n        cells.push(value);\n      });\n\n      rows.push(cells);\n    });\n\n    return rows;\n  }\n\n  /**\n   * Get cell value as string\n   */\n  private getCellValue(cell: any): string {\n    if (cell.value === null || cell.value === undefined) return '';\n\n    // Handle different cell types\n    if (typeof cell.value === 'object') {\n      // Rich text\n      if (cell.value.richText) {\n        return cell.value.richText.map((rt: any) => rt.text || '').join('');\n      }\n      // Hyperlink\n      if (cell.value.hyperlink) {\n        return cell.value.text || cell.value.hyperlink;\n      }\n      // Formula result\n      if ('result' in cell.value) {\n        return String(cell.value.result ?? '');\n      }\n      // Date\n      if (cell.value instanceof Date) {\n        return cell.value.toISOString().split('T')[0];\n      }\n      return String(cell.value);\n    }\n\n    return String(cell.value).replace(/\\|/g, '\\\\|'); // Escape pipes for markdown\n  }\n}\n","/**\n * PDF Handler\n *\n * Handles PDF format using unpdf (lazy-loaded).\n * Extracts text per page and optionally images.\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport type {\n  IFormatHandler,\n  DocumentFormat,\n  DocumentReadOptions,\n  DocumentPiece,\n} from '../types.js';\n\n// Lazy-loaded unpdf functions\nlet unpdfModule: {\n  extractText: (data: any, options?: any) => Promise<any>;\n  extractImages: (data: any, options?: any) => Promise<any>;\n  getMeta: (data: any) => Promise<any>;\n} | null = null;\n\nasync function getUnpdf() {\n  if (!unpdfModule) {\n    const mod = await import('unpdf');\n    unpdfModule = {\n      extractText: mod.extractText,\n      extractImages: mod.extractImages,\n      getMeta: mod.getMeta,\n    };\n  }\n  return unpdfModule;\n}\n\nexport class PDFHandler implements IFormatHandler {\n  readonly name = 'PDFHandler';\n  readonly supportedFormats: DocumentFormat[] = ['pdf'];\n\n  async handle(\n    buffer: Buffer,\n    filename: string,\n    format: DocumentFormat,\n    options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const unpdf = await getUnpdf();\n    const pieces: DocumentPiece[] = [];\n    let pieceIndex = 0;\n\n    // pdf.js (via unpdf) transfers the underlying ArrayBuffer to a worker, which\n    // detaches it from the original view. We must copy into a dedicated ArrayBuffer\n    // so the caller's Buffer is not invalidated, and to avoid issues with pooled\n    // or shared ArrayBuffers that can't be transferred.\n    const data = new Uint8Array(buffer);\n\n    // Extract metadata\n    let metadata: any = {};\n    const includeMetadata = options.formatOptions?.pdf?.includeMetadata !== false;\n    if (includeMetadata) {\n      try {\n        metadata = await unpdf.getMeta(data);\n      } catch {\n        // Metadata extraction failed, continue without\n      }\n    }\n\n    // Extract text (per page)\n    const textResult = await unpdf.extractText(data, { mergePages: false });\n    const pages: string[] = textResult?.pages || textResult?.text\n      ? (Array.isArray(textResult.text) ? textResult.text : [textResult.text])\n      : [];\n\n    // Filter to requested pages\n    const requestedPages = options.pages;\n    const pageEntries = pages.map((text: string, i: number) => ({ text, pageNum: i + 1 }));\n\n    const filteredPages = requestedPages && requestedPages.length > 0\n      ? pageEntries.filter((p) =>\n          requestedPages.some((rp) => {\n            const num = typeof rp === 'string' ? parseInt(rp, 10) : rp;\n            return num === p.pageNum;\n          })\n        )\n      : pageEntries;\n\n    // Add metadata piece if available\n    if (includeMetadata && metadata?.info) {\n      const metaParts: string[] = [];\n      if (metadata.info.Title) metaParts.push(`**Title:** ${metadata.info.Title}`);\n      if (metadata.info.Author) metaParts.push(`**Author:** ${metadata.info.Author}`);\n      if (metadata.info.Subject) metaParts.push(`**Subject:** ${metadata.info.Subject}`);\n      if (metadata.info.Creator) metaParts.push(`**Creator:** ${metadata.info.Creator}`);\n      if (pages.length) metaParts.push(`**Pages:** ${pages.length}`);\n\n      if (metaParts.length > 0) {\n        const metaContent = metaParts.join('\\n');\n        const sizeBytes = Buffer.byteLength(metaContent, 'utf-8');\n        pieces.push({\n          type: 'text',\n          content: metaContent,\n          metadata: {\n            sourceFilename: filename,\n            format,\n            index: pieceIndex++,\n            section: 'Metadata',\n            sizeBytes,\n            estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n          },\n        });\n      }\n    }\n\n    // Add text pieces per page\n    for (const page of filteredPages) {\n      const text = page.text.trim();\n      if (!text) continue;\n\n      const sizeBytes = Buffer.byteLength(text, 'utf-8');\n      pieces.push({\n        type: 'text',\n        content: text,\n        metadata: {\n          sourceFilename: filename,\n          format,\n          index: pieceIndex++,\n          section: `Page ${page.pageNum}`,\n          sizeBytes,\n          estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n        },\n      });\n    }\n\n    // Extract images if requested\n    if (options.extractImages !== false) {\n      try {\n        const imagesResult = await unpdf.extractImages(data, {});\n        const images: any[] = imagesResult?.images || [];\n\n        for (const img of images) {\n          if (!img.data) continue;\n\n          const base64 = typeof img.data === 'string'\n            ? img.data\n            : Buffer.from(img.data).toString('base64');\n          const sizeBytes = Math.ceil(base64.length * 0.75);\n\n          pieces.push({\n            type: 'image',\n            base64,\n            mimeType: img.mimeType || 'image/png',\n            width: img.width,\n            height: img.height,\n            metadata: {\n              sourceFilename: filename,\n              format,\n              index: pieceIndex++,\n              sizeBytes,\n              estimatedTokens: DOCUMENT_DEFAULTS.IMAGE_TOKENS_AUTO,\n              label: img.name || undefined,\n            },\n          });\n        }\n      } catch {\n        // Image extraction failed, continue without images\n      }\n    }\n\n    return pieces;\n  }\n}\n","/**\n * Document Format Handlers\n */\n\nimport type { DocumentFamily, IFormatHandler } from '../types.js';\nimport { TextHandler } from './TextHandler.js';\nimport { ImageHandler } from './ImageHandler.js';\nimport { HTMLHandler } from './HTMLHandler.js';\nimport { OfficeHandler } from './OfficeHandler.js';\nimport { ExcelHandler } from './ExcelHandler.js';\nimport { PDFHandler } from './PDFHandler.js';\n\nexport { TextHandler } from './TextHandler.js';\nexport { ImageHandler } from './ImageHandler.js';\nexport { HTMLHandler } from './HTMLHandler.js';\nexport { OfficeHandler } from './OfficeHandler.js';\nexport { ExcelHandler } from './ExcelHandler.js';\nexport { PDFHandler } from './PDFHandler.js';\n\n/**\n * Get all default format handlers mapped by family\n */\nexport function getDefaultHandlers(): Map<DocumentFamily, IFormatHandler> {\n  return new Map<DocumentFamily, IFormatHandler>([\n    ['text', new TextHandler()],\n    ['image', new ImageHandler()],\n    ['html', new HTMLHandler()],\n    ['office', new OfficeHandler()],\n    ['spreadsheet', new ExcelHandler()],\n    ['pdf', new PDFHandler()],\n  ]);\n}\n","/**\n * Default Document Transformers\n *\n * Built-in transformers that run on every document read:\n * 1. documentHeaderTransformer - Prepends document header\n * 2. tableFormattingTransformer - Normalizes markdown tables\n * 3. truncationTransformer - Enforces token limits\n */\n\nimport { DOCUMENT_DEFAULTS } from '../../../core/constants.js';\nimport type {\n  IDocumentTransformer,\n  DocumentPiece,\n  DocumentTextPiece,\n  TransformerContext,\n  DocumentFormat,\n} from '../types.js';\n\n/**\n * Prepends a document header with filename, format, and size info\n */\nexport const documentHeaderTransformer: IDocumentTransformer = {\n  name: 'documentHeaderTransformer',\n  appliesTo: [], // applies to all formats\n  priority: 10,\n\n  async transform(pieces: DocumentPiece[], context: TransformerContext): Promise<DocumentPiece[]> {\n    if (pieces.length === 0) return pieces;\n\n    const totalSize = pieces.reduce((sum, p) => sum + p.metadata.sizeBytes, 0);\n    const sizeStr = totalSize > 1024 * 1024\n      ? `${(totalSize / 1024 / 1024).toFixed(1)}MB`\n      : `${(totalSize / 1024).toFixed(1)}KB`;\n\n    const header = `# Document: ${context.filename}\\n_Format: ${context.format.toUpperCase()} | Size: ${sizeStr}_`;\n    const headerBytes = Buffer.byteLength(header, 'utf-8');\n\n    const headerPiece: DocumentTextPiece = {\n      type: 'text',\n      content: header,\n      metadata: {\n        sourceFilename: context.filename,\n        format: context.format,\n        index: -1, // will be re-indexed\n        section: 'Header',\n        sizeBytes: headerBytes,\n        estimatedTokens: Math.ceil(headerBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n      },\n    };\n\n    // Re-index all pieces\n    const result = [headerPiece, ...pieces];\n    result.forEach((p, i) => {\n      p.metadata.index = i;\n    });\n\n    return result;\n  },\n};\n\n/**\n * Normalizes markdown table alignment for spreadsheet formats\n */\nexport const tableFormattingTransformer: IDocumentTransformer = {\n  name: 'tableFormattingTransformer',\n  appliesTo: ['xlsx', 'csv'] as DocumentFormat[],\n  priority: 50,\n\n  async transform(pieces: DocumentPiece[], _context: TransformerContext): Promise<DocumentPiece[]> {\n    return pieces.map((piece) => {\n      if (piece.type !== 'text') return piece;\n\n      // Normalize table column widths for better readability\n      let content = piece.content;\n\n      // Find markdown tables and normalize them\n      content = content.replace(\n        /(\\|[^\\n]+\\|\\n\\|[\\s\\-:|]+\\|\\n(?:\\|[^\\n]+\\|\\n?)*)/g,\n        (table) => normalizeTable(table)\n      );\n\n      if (content === piece.content) return piece;\n\n      const sizeBytes = Buffer.byteLength(content, 'utf-8');\n      return {\n        ...piece,\n        content,\n        metadata: {\n          ...piece.metadata,\n          sizeBytes,\n          estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n        },\n      };\n    });\n  },\n};\n\n/**\n * Normalize a markdown table's column widths\n */\nfunction normalizeTable(table: string): string {\n  const lines = table.trim().split('\\n');\n  if (lines.length < 2) return table;\n\n  // Parse columns\n  const rows = lines.map((line) =>\n    line\n      .split('|')\n      .slice(1, -1) // remove empty first/last from leading/trailing |\n      .map((cell) => cell.trim())\n  );\n\n  // Calculate max column widths\n  const colCount = Math.max(...rows.map((r) => r.length));\n  const colWidths = new Array(colCount).fill(3); // minimum 3 for ---\n\n  for (const row of rows) {\n    for (let i = 0; i < row.length; i++) {\n      // Skip separator row for width calculation\n      const cell = row[i] ?? '';\n      if (cell.match(/^[-:]+$/)) continue;\n      colWidths[i] = Math.max(colWidths[i] ?? 3, cell.length);\n    }\n  }\n\n  // Rebuild table with aligned columns\n  const result = rows.map((row, rowIndex) => {\n    const cells = [];\n    for (let i = 0; i < colCount; i++) {\n      const cell = row[i] || '';\n      if (rowIndex === 1) {\n        // Separator row\n        cells.push('-'.repeat(colWidths[i]));\n      } else {\n        cells.push(cell.padEnd(colWidths[i]));\n      }\n    }\n    return `| ${cells.join(' | ')} |`;\n  });\n\n  return result.join('\\n');\n}\n\n/**\n * Enforces maxTokens limit by truncating at paragraph boundaries\n */\nexport const truncationTransformer: IDocumentTransformer = {\n  name: 'truncationTransformer',\n  appliesTo: [], // applies to all formats\n  priority: 1000, // runs last\n\n  async transform(pieces: DocumentPiece[], context: TransformerContext): Promise<DocumentPiece[]> {\n    const maxTokens = context.options.maxTokens ?? DOCUMENT_DEFAULTS.MAX_OUTPUT_TOKENS;\n    const maxBytes = context.options.maxOutputBytes ?? DOCUMENT_DEFAULTS.MAX_OUTPUT_BYTES;\n\n    let totalTokens = 0;\n    let totalBytes = 0;\n    const result: DocumentPiece[] = [];\n\n    for (const piece of pieces) {\n      totalTokens += piece.metadata.estimatedTokens;\n      totalBytes += piece.metadata.sizeBytes;\n\n      if (totalTokens > maxTokens || totalBytes > maxBytes) {\n        // Need to truncate\n        if (piece.type === 'text') {\n          const remainingTokens = maxTokens - (totalTokens - piece.metadata.estimatedTokens);\n          const remainingChars = remainingTokens * DOCUMENT_DEFAULTS.CHARS_PER_TOKEN;\n\n          if (remainingChars > 100) {\n            // Truncate at paragraph boundary\n            const content = piece.content;\n            const truncateAt = content.lastIndexOf('\\n\\n', remainingChars);\n            const cutPoint = truncateAt > remainingChars * 0.3 ? truncateAt : remainingChars;\n            const truncated = content.slice(0, cutPoint) + '\\n\\n..._[content truncated]_';\n\n            const sizeBytes = Buffer.byteLength(truncated, 'utf-8');\n            result.push({\n              ...piece,\n              content: truncated,\n              metadata: {\n                ...piece.metadata,\n                sizeBytes,\n                estimatedTokens: Math.ceil(sizeBytes / DOCUMENT_DEFAULTS.CHARS_PER_TOKEN),\n              },\n            });\n          }\n        }\n        // Drop remaining pieces (images counted against limit too)\n        break;\n      }\n\n      result.push(piece);\n    }\n\n    return result;\n  },\n};\n\n/**\n * Get all default transformers\n */\nexport function getDefaultTransformers(): IDocumentTransformer[] {\n  return [\n    documentHeaderTransformer,\n    tableFormattingTransformer,\n    truncationTransformer,\n  ];\n}\n","/**\n * Document Transformers\n */\n\nexport {\n  documentHeaderTransformer,\n  tableFormattingTransformer,\n  truncationTransformer,\n  getDefaultTransformers,\n} from './DefaultTransformers.js';\n","/**\n * Core module - main public API\n *\n * This is the primary entry point for the library.\n *\n * @example\n * ```typescript\n * import { Connector, Agent, Vendor } from '@everworker/oneringai';\n *\n * // Create a connector\n * Connector.create({\n *   name: 'openai',\n *   vendor: Vendor.OpenAI,\n *   auth: { type: 'api_key', apiKey: process.env.OPENAI_API_KEY! }\n * });\n *\n * // Create an agent\n * const agent = Agent.create({\n *   connector: 'openai',\n *   model: 'gpt-4'\n * });\n *\n * // Run the agent\n * const response = await agent.run('Hello!');\n * ```\n */\n\nexport { Connector } from './Connector.js';\nexport { ScopedConnectorRegistry } from './ScopedConnectorRegistry.js';\nexport { StorageRegistry } from './StorageRegistry.js';\nexport type { StorageConfig, StorageContext } from './StorageRegistry.js';\nexport { ToolCatalogRegistry } from './ToolCatalogRegistry.js';\nexport type { ToolCategoryDefinition, CatalogToolEntry, ToolCategoryScope } from './ToolCatalogRegistry.js';\nexport { Agent } from './Agent.js';\nexport type { AgentConfig, AgentSessionConfig } from './Agent.js';\n\n// Routine Runner\nexport { executeRoutine } from './routineRunner.js';\nexport type { ExecuteRoutineOptions, ValidationContext } from './routineRunner.js';\n\n// Execution Recorder\nexport { createExecutionRecorder } from './createExecutionRecorder.js';\nexport type { ExecutionRecorderOptions, ExecutionRecorder } from './createExecutionRecorder.js';\n\n// ============================================================================\n// AgentContextNextGen - Clean, Simple Context Management\n// ============================================================================\nexport {\n  AgentContextNextGen,\n  DEFAULT_FEATURES,\n  DEFAULT_CONFIG,\n  BasePluginNextGen,\n  simpleTokenEstimator,\n  WorkingMemoryPluginNextGen,\n  InContextMemoryPluginNextGen,\n  PersistentInstructionsPluginNextGen,\n  UserInfoPluginNextGen,\n  ToolCatalogPluginNextGen,\n  // Compaction strategies\n  DefaultCompactionStrategy,\n  // Strategy Registry\n  StrategyRegistry,\n} from './context-nextgen/index.js';\nexport type {\n  IContextPluginNextGen,\n  ITokenEstimator,\n  AuthIdentity,\n  AgentContextNextGenConfig,\n  ContextFeatures,\n  ContextBudget,\n  PreparedContext,\n  OversizedInputResult,\n  IContextStorage,\n  SerializedContextState,\n  ContextEvents,\n  PluginConfigs,\n  WorkingMemoryPluginConfig,\n  SerializedWorkingMemoryState,\n  EvictionStrategy,\n  InContextMemoryConfig,\n  InContextEntry,\n  InContextPriority,\n  SerializedInContextMemoryState,\n  PersistentInstructionsConfig,\n  SerializedPersistentInstructionsState,\n  InstructionEntry,\n  UserInfoPluginConfig,\n  SerializedUserInfoState,\n  ToolCatalogPluginConfig,\n  // Compaction strategy types\n  ICompactionStrategy,\n  CompactionContext,\n  CompactionResult,\n  ConsolidationResult,\n  DefaultCompactionStrategyConfig,\n  // Strategy Registry types\n  StrategyInfo,\n  StrategyRegistryEntry,\n  // Snapshot types\n  IContextSnapshot,\n  IPluginSnapshot,\n  IToolSnapshot,\n  IViewContextData,\n  IViewContextComponent,\n} from './context-nextgen/index.js';\nexport { formatPluginDisplayName } from './context-nextgen/index.js';\n\n// Lifecycle hooks and direct call types (from BaseAgent)\nexport type {\n  AgentLifecycleHooks,\n  ToolExecutionHookContext,\n  ToolExecutionResult,\n  DirectCallOptions,\n} from './BaseAgent.js';\nexport { Vendor, VENDORS, isVendor } from './Vendor.js';\nexport { createProvider, createProviderAsync, getVendorDefaultBaseURL } from './createProvider.js';\n\n// Centralized constants\nexport {\n  TASK_DEFAULTS,\n  CONTEXT_DEFAULTS,\n  MEMORY_DEFAULTS,\n  SESSION_DEFAULTS,\n  AGENT_DEFAULTS,\n  CIRCUIT_BREAKER_DEFAULTS,\n  HISTORY_DEFAULTS,\n  TOKEN_ESTIMATION,\n  TOOL_RESULT_EVICTION_DEFAULTS,\n  DEFAULT_TOOL_RETENTION,\n  SAFETY_CAPS,\n  TOOL_RETENTION_MULTIPLIERS,\n  STRATEGY_THRESHOLDS,\n  DOCUMENT_DEFAULTS,\n} from './constants.js';\nexport type { StrategyName } from './constants.js';\n\n// Global configuration\nexport { Config } from './Config.js';\nexport type { OneRingAIConfig, MCPConfiguration } from '../domain/entities/MCPConfig.js';\n\n// MCP (Model Context Protocol)\nexport * from './mcp/index.js';\n\n// Audio capabilities\nexport { TextToSpeech } from './TextToSpeech.js';\nexport type { TextToSpeechConfig } from './TextToSpeech.js';\nexport { SpeechToText } from './SpeechToText.js';\nexport type { SpeechToTextConfig } from './SpeechToText.js';\n\n// Image capabilities\nexport { createImageProvider } from './createImageProvider.js';\n\n// Tool management (unified - handles registration, execution, and circuit breakers)\nexport { ToolManager } from './ToolManager.js';\nexport type {\n  ToolOptions,\n  ToolCondition,\n  ToolSelectionContext,\n  ToolRegistration,\n  ToolMetadata,\n  ToolManagerStats,\n  ToolManagerConfig,\n  SerializedToolState,\n  ToolManagerEvent,\n  ToolSource,\n} from './ToolManager.js';\n// Note: CircuitBreakerConfig, CircuitState are re-exported from ToolManager but\n// canonically exported from infrastructure/resilience/index.js\n\n// Tool Execution Plugin System\nexport {\n  ToolExecutionPipeline,\n  LoggingPlugin,\n  ResultNormalizerPlugin,\n} from './tool-execution/index.js';\nexport type {\n  PluginExecutionContext,\n  BeforeExecuteResult,\n  IToolExecutionPlugin,\n  IToolExecutionPipeline,\n  ToolExecutionPipelineOptions,\n  LoggingPluginOptions,\n  ResultNormalizerPluginOptions,\n  NormalizedErrorResult,\n} from './tool-execution/index.js';\n\n// Tool permission management\nexport { ToolPermissionManager } from './permissions/ToolPermissionManager.js';\nexport type {\n  PermissionScope,\n  RiskLevel,\n  ToolPermissionConfig,\n  ApprovalCacheEntry,\n  SerializedApprovalState,\n  SerializedApprovalEntry,\n  PermissionCheckResult,\n  ApprovalDecision,\n  AgentPermissionsConfig,\n  PermissionCheckContext,\n  PermissionManagerEvent,\n} from './permissions/types.js';\nexport { APPROVAL_STATE_VERSION, DEFAULT_PERMISSION_CONFIG } from './permissions/types.js';\n\n// Error Handling\nexport { ErrorHandler, globalErrorHandler } from './ErrorHandler.js';\nexport type {\n  ErrorContext,\n  ErrorHandlerConfig,\n  ErrorHandlerEvents,\n} from './ErrorHandler.js';\n","/**\n * ToolCatalogRegistry - Static Global Registry for Tool Categories\n *\n * The single source of truth for all tool categories and their tools.\n * Library users register their own categories and tools at app startup.\n *\n * Built-in tools are auto-registered from registry.generated.ts on first access.\n *\n * @example\n * ```typescript\n * // Register custom category\n * ToolCatalogRegistry.registerCategory({\n *   name: 'knowledge',\n *   displayName: 'Knowledge Graph',\n *   description: 'Search entities, get facts, manage references',\n * });\n *\n * // Register tools in category\n * ToolCatalogRegistry.registerTools('knowledge', [\n *   { name: 'entity_search', displayName: 'Entity Search', description: 'Search people/orgs', tool: entitySearch, safeByDefault: true },\n * ]);\n *\n * // Query\n * const categories = ToolCatalogRegistry.getCategories();\n * const tools = ToolCatalogRegistry.getToolsInCategory('knowledge');\n * const found = ToolCatalogRegistry.findTool('entity_search');\n * ```\n */\n\nimport type { ToolFunction } from '../domain/entities/Tool.js';\nimport { logger } from '../infrastructure/observability/Logger.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/**\n * Definition of a tool category in the catalog.\n */\nexport interface ToolCategoryDefinition {\n  /** Unique category name (e.g., 'filesystem', 'knowledge', 'connector:github') */\n  name: string;\n  /** Human-readable display name (e.g., 'File System') */\n  displayName: string;\n  /** Description shown in catalog metatool display */\n  description: string;\n}\n\n/**\n * A single tool entry in the catalog.\n */\nexport interface CatalogToolEntry {\n  /** The actual tool function */\n  tool: ToolFunction;\n  /** Tool name (matches definition.function.name) */\n  name: string;\n  /** Human-readable display name */\n  displayName: string;\n  /** Brief description */\n  description: string;\n  /** Whether this tool is safe to execute without user approval */\n  safeByDefault: boolean;\n  /** Whether this tool requires a connector to function */\n  requiresConnector?: boolean;\n}\n\n/**\n * Scope for filtering which categories are visible/allowed.\n *\n * - `string[]`  shorthand allowlist (only these categories)\n * - `{ include: string[] }`  explicit allowlist\n * - `{ exclude: string[] }`  blocklist (all except these)\n * - `undefined`  all categories allowed\n */\nexport type ToolCategoryScope =\n  | string[]                  // shorthand allowlist\n  | { include: string[] }     // explicit allowlist\n  | { exclude: string[] };    // blocklist\n  // undefined = all allowed\n\n// ============================================================================\n// ToolCatalogRegistry\n// ============================================================================\n\n/**\n * Static global registry for tool categories and their tools.\n *\n * Like Connector and StorageRegistry, this is a static class that acts\n * as a single source of truth. App code registers categories at startup,\n * and plugins/agents query them at runtime.\n */\nexport class ToolCatalogRegistry {\n  /** Category definitions: name  definition */\n  private static _categories = new Map<string, ToolCategoryDefinition>();\n\n  /** Tools per category: category name  tool entries */\n  private static _tools = new Map<string, CatalogToolEntry[]>();\n\n  /** Whether built-in tools have been registered */\n  private static _initialized = false;\n\n  // --- Built-in category descriptions ---\n  private static readonly BUILTIN_DESCRIPTIONS: Record<string, string> = {\n    filesystem: 'Read, write, edit, search, and list files and directories',\n    shell: 'Execute bash/shell commands',\n    web: 'Fetch and process web content',\n    code: 'Execute JavaScript code in sandboxed VM',\n    json: 'Parse, query, and transform JSON data',\n    desktop: 'Screenshot, mouse, keyboard, and window desktop automation',\n    'custom-tools': 'Create, save, load, and test custom tool definitions',\n    routines: 'Generate and manage agent routines',\n    other: 'Miscellaneous tools',\n  };\n\n  // ========================================================================\n  // Registration\n  // ========================================================================\n\n  /**\n   * Register a tool category.\n   * If the category already exists, updates its metadata.\n   */\n  static registerCategory(def: ToolCategoryDefinition): void {\n    this._categories.set(def.name, def);\n    if (!this._tools.has(def.name)) {\n      this._tools.set(def.name, []);\n    }\n  }\n\n  /**\n   * Register multiple tools in a category.\n   * The category is auto-created if it doesn't exist (with a generic description).\n   */\n  static registerTools(category: string, tools: CatalogToolEntry[]): void {\n    if (!this._categories.has(category)) {\n      this._categories.set(category, {\n        name: category,\n        displayName: category.charAt(0).toUpperCase() + category.slice(1),\n        description: this.BUILTIN_DESCRIPTIONS[category] ?? `Tools in the ${category} category`,\n      });\n    }\n    const existing = this._tools.get(category) ?? [];\n    // Deduplicate: replace existing tools with same name\n    const existingNames = new Set(existing.map(t => t.name));\n    const newTools = tools.filter(t => !existingNames.has(t.name));\n    const updated = existing.map(t => {\n      const replacement = tools.find(nt => nt.name === t.name);\n      return replacement ?? t;\n    });\n    this._tools.set(category, [...updated, ...newTools]);\n  }\n\n  /**\n   * Register a single tool in a category.\n   */\n  static registerTool(category: string, tool: CatalogToolEntry): void {\n    this.registerTools(category, [tool]);\n  }\n\n  /**\n   * Unregister a category and all its tools.\n   */\n  static unregisterCategory(category: string): boolean {\n    const hadCategory = this._categories.delete(category);\n    this._tools.delete(category);\n    return hadCategory;\n  }\n\n  /**\n   * Unregister a single tool from a category.\n   */\n  static unregisterTool(category: string, toolName: string): boolean {\n    const tools = this._tools.get(category);\n    if (!tools) return false;\n    const idx = tools.findIndex(t => t.name === toolName);\n    if (idx === -1) return false;\n    tools.splice(idx, 1);\n    return true;\n  }\n\n  // ========================================================================\n  // Query\n  // ========================================================================\n\n  /**\n   * Get all registered categories.\n   */\n  static getCategories(): ToolCategoryDefinition[] {\n    this.ensureInitialized();\n    return Array.from(this._categories.values());\n  }\n\n  /**\n   * Get a single category by name.\n   */\n  static getCategory(name: string): ToolCategoryDefinition | undefined {\n    this.ensureInitialized();\n    return this._categories.get(name);\n  }\n\n  /**\n   * Check if a category exists.\n   */\n  static hasCategory(name: string): boolean {\n    this.ensureInitialized();\n    return this._categories.has(name);\n  }\n\n  /**\n   * Get all tools in a category.\n   */\n  static getToolsInCategory(category: string): CatalogToolEntry[] {\n    this.ensureInitialized();\n    return this._tools.get(category) ?? [];\n  }\n\n  /**\n   * Get all catalog tools across all categories.\n   */\n  static getAllCatalogTools(): CatalogToolEntry[] {\n    this.ensureInitialized();\n    const all: CatalogToolEntry[] = [];\n    for (const tools of this._tools.values()) {\n      all.push(...tools);\n    }\n    return all;\n  }\n\n  /**\n   * Find a tool by name across all categories.\n   */\n  static findTool(name: string): { category: string; entry: CatalogToolEntry } | undefined {\n    this.ensureInitialized();\n    for (const [category, tools] of this._tools) {\n      const entry = tools.find(t => t.name === name);\n      if (entry) return { category, entry };\n    }\n    return undefined;\n  }\n\n  // ========================================================================\n  // Filtering\n  // ========================================================================\n\n  /**\n   * Filter categories by scope.\n   */\n  static filterCategories(scope?: ToolCategoryScope): ToolCategoryDefinition[] {\n    const all = this.getCategories();\n    if (!scope) return all;\n    return all.filter(cat => this.isCategoryAllowed(cat.name, scope));\n  }\n\n  /**\n   * Check if a category is allowed by a scope.\n   */\n  static isCategoryAllowed(name: string, scope?: ToolCategoryScope): boolean {\n    if (!scope) return true;\n\n    if (Array.isArray(scope)) {\n      // Shorthand allowlist\n      return scope.includes(name);\n    }\n\n    if ('include' in scope) {\n      return scope.include.includes(name);\n    }\n\n    if ('exclude' in scope) {\n      return !scope.exclude.includes(name);\n    }\n\n    return true;\n  }\n\n  // ========================================================================\n  // Resolution\n  // ========================================================================\n\n  /**\n   * Resolve tool names to ToolFunction[].\n   *\n   * Searches registered categories and (optionally) connector tools.\n   * Used by app-level executors (e.g., V25's OneRingAgentExecutor).\n   *\n   * @param toolNames - Array of tool names to resolve\n   * @param options - Resolution options\n   * @returns Resolved tool functions (skips unresolvable names with warning)\n   */\n  static resolveTools(\n    toolNames: string[],\n    options?: { includeConnectors?: boolean; userId?: string },\n  ): ToolFunction[] {\n    this.ensureInitialized();\n    const resolved: ToolFunction[] = [];\n    const missing: string[] = [];\n\n    for (const name of toolNames) {\n      // 1. Search registered categories\n      const found = this.findTool(name);\n      if (found) {\n        resolved.push(found.entry.tool);\n        continue;\n      }\n\n      // 2. Search connector tools (if enabled)\n      if (options?.includeConnectors) {\n        const connectorTool = this.findConnectorTool(name);\n        if (connectorTool) {\n          resolved.push(connectorTool);\n          continue;\n        }\n      }\n\n      missing.push(name);\n    }\n\n    if (missing.length > 0) {\n      logger.warn(\n        { missing, resolved: resolved.length, total: toolNames.length },\n        `[ToolCatalogRegistry.resolveTools] Could not resolve ${missing.length} tool(s): ${missing.join(', ')}`,\n      );\n    }\n\n    return resolved;\n  }\n\n  /**\n   * Search connector tools by name (lazy import to avoid circular deps).\n   */\n  private static findConnectorTool(name: string): ToolFunction | undefined {\n    try {\n      // Dynamic import not feasible in static sync method  use require-style pattern\n      // ConnectorTools is available at runtime since it's already loaded\n      const { ConnectorTools } = require('../../tools/connector/ConnectorTools.js');\n      const allConnectorTools: Map<string, ToolFunction[]> = ConnectorTools.discoverAll();\n      for (const [, tools] of allConnectorTools) {\n        for (const tool of tools) {\n          if (tool.definition.function.name === name) {\n            return tool;\n          }\n        }\n      }\n    } catch {\n      // ConnectorTools not available  skip\n    }\n    return undefined;\n  }\n\n  // ========================================================================\n  // Built-in initialization\n  // ========================================================================\n\n  /**\n   * Ensure built-in tools from registry.generated.ts are registered.\n   * Called lazily on first query.\n   *\n   * In ESM environments, call `initializeFromRegistry(toolRegistry)` explicitly\n   * from your app startup instead of relying on auto-initialization.\n   */\n  static ensureInitialized(): void {\n    if (this._initialized) return;\n    this._initialized = true;\n\n    try {\n      // Try to dynamically require the generated registry\n      // This works in CommonJS and in Node.js ESM with --experimental-require-module\n      // eslint-disable-next-line @typescript-eslint/no-var-requires\n      const mod = require('../../tools/registry.generated.js');\n      const registry = mod?.toolRegistry ?? mod?.default?.toolRegistry;\n      if (Array.isArray(registry)) {\n        this.registerFromToolRegistry(registry);\n      }\n    } catch {\n      // ESM environment or registry not available  app must call initializeFromRegistry() explicitly\n    }\n  }\n\n  /**\n   * Explicitly initialize from the generated tool registry.\n   * Call this at app startup in ESM environments where lazy require() doesn't work.\n   *\n   * @example\n   * ```typescript\n   * import { toolRegistry } from './tools/registry.generated.js';\n   * ToolCatalogRegistry.initializeFromRegistry(toolRegistry);\n   * ```\n   */\n  static initializeFromRegistry(registry: Array<{\n    name: string;\n    displayName: string;\n    category: string;\n    description: string;\n    tool: ToolFunction;\n    safeByDefault: boolean;\n    requiresConnector?: boolean;\n  }>): void {\n    this._initialized = true;\n    this.registerFromToolRegistry(registry);\n  }\n\n  /**\n   * Internal: register tools from a tool registry array.\n   */\n  private static registerFromToolRegistry(registry: Array<{\n    name: string;\n    displayName: string;\n    category: string;\n    description: string;\n    tool: ToolFunction;\n    safeByDefault: boolean;\n    requiresConnector?: boolean;\n  }>): void {\n    for (const entry of registry) {\n      const category = entry.category;\n\n      // Register category if not already registered\n      if (!this._categories.has(category)) {\n        const displayName = category\n          .split('-')\n          .map((w: string) => w.charAt(0).toUpperCase() + w.slice(1))\n          .join(' ');\n        this.registerCategory({\n          name: category,\n          displayName,\n          description: this.BUILTIN_DESCRIPTIONS[category] ?? `Built-in ${category} tools`,\n        });\n      }\n\n      // Register tool\n      const catalogEntry: CatalogToolEntry = {\n        tool: entry.tool,\n        name: entry.name,\n        displayName: entry.displayName,\n        description: entry.description,\n        safeByDefault: entry.safeByDefault,\n        requiresConnector: entry.requiresConnector,\n      };\n\n      const existing = this._tools.get(category) ?? [];\n      // Don't duplicate\n      if (!existing.some(t => t.name === catalogEntry.name)) {\n        existing.push(catalogEntry);\n        this._tools.set(category, existing);\n      }\n    }\n  }\n\n  /**\n   * Reset the registry. Primarily for testing.\n   */\n  static reset(): void {\n    this._categories.clear();\n    this._tools.clear();\n    this._initialized = false;\n  }\n}\n","/**\n * BaseAgent - Abstract base class for all agent types\n *\n * Provides shared functionality for:\n * - Connector resolution\n * - Tool manager initialization\n * - Permission manager initialization\n * - Session management (via AgentContextNextGen)\n * - Lifecycle/cleanup\n *\n * This is an INTERNAL class - not exported in the public API.\n * Use Agent instead.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { Connector } from './Connector.js';\nimport { ToolManager } from './ToolManager.js';\nimport type { ToolOptions } from './ToolManager.js';\nimport { ToolPermissionManager } from './permissions/ToolPermissionManager.js';\nimport type { AgentPermissionsConfig } from './permissions/types.js';\nimport type { ToolFunction } from '../domain/entities/Tool.js';\nimport { logger, FrameworkLogger } from '../infrastructure/observability/Logger.js';\nimport { AgentContextNextGen } from './context-nextgen/AgentContextNextGen.js';\nimport type { AgentContextNextGenConfig, AuthIdentity, SerializedContextState } from './context-nextgen/types.js';\nimport { createProvider } from './createProvider.js';\nimport type { ITextProvider } from '../domain/interfaces/ITextProvider.js';\nimport type { LLMResponse } from '../domain/entities/Response.js';\nimport type { InputItem } from '../domain/entities/Message.js';\nimport type { StreamEvent } from '../domain/entities/StreamEvent.js';\nimport type { IContextStorage, ContextSessionMetadata } from '../domain/interfaces/IContextStorage.js';\nimport type { IConnectorRegistry } from '../domain/interfaces/IConnectorRegistry.js';\n\n/**\n * Options for tool registration\n */\nexport interface ToolRegistrationOptions {\n  /** Namespace for the tool (e.g., 'user', '_meta', 'mcp:fs') */\n  namespace?: string;\n  /** Whether the tool is enabled by default */\n  enabled?: boolean;\n}\n\n/**\n * Session configuration using AgentContext persistence\n */\nexport interface BaseSessionConfig {\n  /** Storage backend for context sessions */\n  storage: IContextStorage;\n  /** Resume existing session by ID */\n  id?: string;\n  /** Auto-save session after each interaction */\n  autoSave?: boolean;\n  /** Auto-save interval in milliseconds */\n  autoSaveIntervalMs?: number;\n}\n\n/**\n * Tool execution context passed to lifecycle hooks\n */\nexport interface ToolExecutionHookContext {\n  /** Name of the tool being executed */\n  toolName: string;\n  /** Arguments passed to the tool */\n  args: Record<string, unknown>;\n  /** Agent ID */\n  agentId: string;\n  /** Task ID (if running in TaskAgent) */\n  taskId?: string;\n}\n\n/**\n * Tool execution result passed to afterToolExecution hook\n */\nexport interface ToolExecutionResult {\n  /** Name of the tool that was executed */\n  toolName: string;\n  /** Result returned by the tool */\n  result: unknown;\n  /** Execution duration in milliseconds */\n  durationMs: number;\n  /** Whether the execution was successful */\n  success: boolean;\n  /** Error if execution failed */\n  error?: Error;\n}\n\n/**\n * Context passed to beforeCompaction hook\n */\nexport interface BeforeCompactionContext {\n  /** Agent identifier */\n  agentId: string;\n  /** Current context budget info */\n  currentBudget: {\n    total: number;\n    used: number;\n    available: number;\n    utilizationPercent: number;\n    status: 'ok' | 'warning' | 'critical';\n  };\n  /** Compaction strategy being used */\n  strategy: string;\n  /** Current context components (read-only) */\n  components: ReadonlyArray<{\n    name: string;\n    priority: number;\n    compactable: boolean;\n  }>;\n  /** Estimated tokens to be freed */\n  estimatedTokensToFree: number;\n}\n\n/**\n * Agent lifecycle hooks for customization.\n * These hooks allow external code to observe and modify agent behavior\n * at key points in the execution lifecycle.\n */\nexport interface AgentLifecycleHooks {\n  /**\n   * Called before a tool is executed.\n   * Can be used for logging, validation, or rate limiting.\n   * Throw an error to prevent tool execution.\n   *\n   * @param context - Tool execution context\n   * @returns Promise that resolves when hook completes\n   */\n  beforeToolExecution?: (context: ToolExecutionHookContext) => Promise<void>;\n\n  /**\n   * Called after a tool execution completes (success or failure).\n   * Can be used for logging, metrics, or cleanup.\n   *\n   * @param result - Tool execution result\n   * @returns Promise that resolves when hook completes\n   */\n  afterToolExecution?: (result: ToolExecutionResult) => Promise<void>;\n\n  /**\n   * Called before context is prepared for LLM call.\n   * Can be used to inject additional context or modify components.\n   *\n   * @param agentId - Agent identifier\n   * @returns Promise that resolves when hook completes\n   */\n  beforeContextPrepare?: (agentId: string) => Promise<void>;\n\n  /**\n   * Called before context compaction occurs.\n   * Use this hook to save important data to working memory before it's compacted.\n   * This is your last chance to preserve critical information from tool outputs\n   * or conversation history that would otherwise be lost.\n   *\n   * @param context - Compaction context with budget info and components\n   * @returns Promise that resolves when hook completes\n   */\n  beforeCompaction?: (context: BeforeCompactionContext) => Promise<void>;\n\n  /**\n   * Called after context compaction occurs.\n   * Can be used for logging or monitoring context management.\n   *\n   * @param log - Compaction log messages\n   * @param tokensFreed - Number of tokens freed\n   * @returns Promise that resolves when hook completes\n   */\n  afterCompaction?: (log: string[], tokensFreed: number) => Promise<void>;\n\n  /**\n   * Called when agent encounters an error.\n   * Can be used for custom error handling or recovery logic.\n   *\n   * @param error - The error that occurred\n   * @param context - Additional context about where the error occurred\n   * @returns Promise that resolves when hook completes\n   */\n  onError?: (error: Error, context: { phase: string; agentId: string }) => Promise<void>;\n}\n\n/**\n * Base configuration shared by all agent types\n */\nexport interface BaseAgentConfig {\n  /** Connector name or instance */\n  connector: string | Connector;\n\n  /** Model identifier */\n  model: string;\n\n  /** Optional scoped connector registry for access-controlled lookup */\n  registry?: IConnectorRegistry;\n\n  /** Agent name (optional, auto-generated if not provided) */\n  name?: string;\n\n  /** User ID for multi-user scenarios. Flows to ToolContext automatically for all tool executions. */\n  userId?: string;\n\n  /**\n   * Restrict this agent to specific auth identities (connector + optional account alias).\n   * Each identity produces its own tool set (e.g., microsoft_work_api, microsoft_personal_api).\n   * When not set, all connectors visible to the current userId are available.\n   */\n  identities?: AuthIdentity[];\n\n  /** Tools available to the agent */\n  tools?: ToolFunction[];\n\n  /** Provide a pre-configured ToolManager (advanced) */\n  toolManager?: ToolManager;\n\n  /** Session configuration (uses AgentContext persistence) */\n  session?: BaseSessionConfig;\n\n  /** Permission configuration */\n  permissions?: AgentPermissionsConfig;\n\n  /** Lifecycle hooks for customization */\n  lifecycleHooks?: AgentLifecycleHooks;\n\n  /**\n   * Hard timeout in milliseconds for any single tool execution.\n   * Acts as a safety net at the ToolManager level: if a tool's own timeout\n   * mechanism fails, this will force-reject with an error.\n   * Default: 0 (disabled - relies on each tool's own timeout).\n   */\n  toolExecutionTimeout?: number;\n\n  /**\n   * Optional AgentContextNextGen configuration.\n   * If provided as AgentContextNextGen instance, it will be used directly.\n   * If provided as config object, a new AgentContextNextGen will be created.\n   * If not provided, a default AgentContextNextGen will be created.\n   */\n  context?: AgentContextNextGen | AgentContextNextGenConfig;\n}\n\n/**\n * Base events emitted by all agent types.\n * Agent subclasses typically extend their own event interfaces.\n */\nexport interface BaseAgentEvents {\n  'session:saved': { sessionId: string };\n  'session:loaded': { sessionId: string };\n  destroyed: void;\n}\n\n/**\n * Options for direct LLM calls (bypassing AgentContext).\n */\nexport interface DirectCallOptions {\n  /** System instructions (optional) */\n  instructions?: string;\n\n  /** Include registered tools in the call. Default: false */\n  includeTools?: boolean;\n\n  /** Temperature for generation */\n  temperature?: number;\n\n  /** Maximum output tokens */\n  maxOutputTokens?: number;\n\n  /** Response format (text, json_object, json_schema) */\n  responseFormat?: {\n    type: 'text' | 'json_object' | 'json_schema';\n    json_schema?: unknown;\n  };\n\n  /** Vendor-specific options */\n  vendorOptions?: Record<string, unknown>;\n}\n\n/**\n * Abstract base class for all agent types.\n *\n * @internal This class is not exported in the public API.\n *\n * Note: TEvents is not constrained to BaseAgentEvents to allow subclasses\n * to define their own event interfaces (e.g., AgentEvents for Agent).\n */\nexport abstract class BaseAgent<\n  TConfig extends BaseAgentConfig = BaseAgentConfig,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  TEvents extends Record<string, any> = BaseAgentEvents,\n> extends EventEmitter<TEvents> {\n  // ===== Core Properties =====\n  readonly name: string;\n  readonly connector: Connector;\n  readonly model: string;\n\n  // ===== Protected State =====\n  protected _config: TConfig;\n  protected _agentContext: AgentContextNextGen;  // SINGLE SOURCE OF TRUTH for tools and sessions\n  protected _permissionManager: ToolPermissionManager;\n  protected _ownsContext = true;\n  protected _isDestroyed = false;\n  protected _cleanupCallbacks: Array<() => void | Promise<void>> = [];\n  protected _logger: FrameworkLogger;\n  protected _lifecycleHooks: AgentLifecycleHooks;\n\n  // Session state\n  protected _sessionConfig: BaseSessionConfig | null = null;\n  protected _autoSaveInterval: ReturnType<typeof setInterval> | null = null;\n  protected _pendingSessionLoad: Promise<boolean> | null = null;\n\n  /** Whether caller provided explicit instructions/systemPrompt (takes precedence over saved session) */\n  protected _hasExplicitInstructions = false;\n\n  // Provider for LLM calls - single instance shared by all methods\n  protected _provider: ITextProvider;\n\n  // ===== Constructor =====\n\n  constructor(config: TConfig, loggerComponent: string) {\n    super();\n    this._config = config;\n\n    // Resolve connector\n    this.connector = this.resolveConnector(config.connector);\n\n    // Set name\n    this.name = config.name ?? `${this.getAgentType()}-${Date.now()}`;\n    this.model = config.model;\n\n    // Create logger\n    this._logger = logger.child({\n      component: loggerComponent,\n      agentName: this.name,\n      model: this.model,\n      connector: this.connector.name,\n    });\n\n    // Initialize AgentContext FIRST (single source of truth for tools and sessions)\n    this._agentContext = this.initializeAgentContext(config);\n\n    // Register tools with AgentContext if provided\n    if (config.tools) {\n      for (const tool of config.tools) {\n        this._agentContext.tools.register(tool);\n      }\n    }\n\n    // Initialize permission manager (uses tools from AgentContext)\n    this._permissionManager = this.initializePermissionManager(config.permissions, config.tools);\n\n    // Initialize lifecycle hooks\n    this._lifecycleHooks = config.lifecycleHooks ?? {};\n\n    // Create provider from connector (single instance for all LLM calls)\n    this._provider = createProvider(this.connector);\n  }\n\n  // ===== Abstract Methods =====\n\n  /**\n   * Get the agent type identifier\n   */\n  protected abstract getAgentType(): 'agent' | 'task-agent' | 'universal-agent';\n\n  // ===== Protected Initialization Helpers =====\n\n  /**\n   * Resolve connector from string name or instance\n   */\n  protected resolveConnector(ref: string | Connector): Connector {\n    if (typeof ref === 'string') {\n      return this._config.registry\n        ? this._config.registry.get(ref)\n        : Connector.get(ref);\n    }\n    return ref;\n  }\n\n  /**\n   * Initialize AgentContextNextGen (single source of truth for tools and sessions).\n   * If AgentContextNextGen is provided, use it directly.\n   * Otherwise, create a new one with the provided configuration.\n   */\n  protected initializeAgentContext(config: TConfig): AgentContextNextGen {\n    // If AgentContextNextGen instance is provided, use it directly (caller owns it)\n    if (config.context instanceof AgentContextNextGen) {\n      this._ownsContext = false;\n      return config.context;\n    }\n    this._ownsContext = true;\n\n    // Create new AgentContextNextGen with merged config\n    // NOTE: Don't pass tools here - they're registered separately after creation\n    // to allow subclasses to wrap or modify tools before registration\n    const contextConfig: AgentContextNextGenConfig = {\n      model: config.model,\n      agentId: config.name,\n      userId: config.userId,\n      identities: config.identities,\n      // Include storage and sessionId if session config is provided\n      storage: config.session?.storage,\n      // Thread tool execution timeout to ToolManager\n      toolExecutionTimeout: config.toolExecutionTimeout,\n      // Subclasses can add systemPrompt via their config\n      // Note: context-level toolExecutionTimeout overrides agent-level if both set\n      ...(typeof config.context === 'object' && config.context !== null ? config.context : {}),\n    };\n\n    return AgentContextNextGen.create(contextConfig);\n  }\n\n  /**\n   * Initialize permission manager\n   */\n  protected initializePermissionManager(\n    config?: AgentPermissionsConfig,\n    tools?: ToolFunction[]\n  ): ToolPermissionManager {\n    const manager = new ToolPermissionManager(config);\n\n    // Register tool permission configs\n    if (tools) {\n      for (const tool of tools) {\n        if (tool.permission) {\n          manager.setToolConfig(tool.definition.function.name, tool.permission);\n        }\n      }\n    }\n\n    return manager;\n  }\n\n  /**\n   * Initialize session management (call from subclass constructor after other setup)\n   * Now uses AgentContext.save()/load() for persistence.\n   */\n  protected initializeSession(sessionConfig?: BaseSessionConfig): void {\n    if (!sessionConfig) {\n      return;\n    }\n\n    this._sessionConfig = sessionConfig;\n\n    if (sessionConfig.id) {\n      // Resume existing session (async)\n      this._pendingSessionLoad = this.loadSession(sessionConfig.id);\n    }\n\n    // Setup auto-save if configured\n    if (sessionConfig.autoSave) {\n      const interval = sessionConfig.autoSaveIntervalMs ?? 30000;\n      this._autoSaveInterval = setInterval(async () => {\n        try {\n          if (this._agentContext.sessionId) {\n            await this._agentContext.save();\n            this._logger.debug({ sessionId: this._agentContext.sessionId }, 'Auto-saved session');\n          }\n        } catch (error) {\n          this._logger.error({ error: (error as Error).message }, 'Auto-save failed');\n        }\n      }, interval);\n    }\n  }\n\n  /**\n   * Ensure any pending session load is complete\n   */\n  protected async ensureSessionLoaded(): Promise<void> {\n    if (this._pendingSessionLoad) {\n      await this._pendingSessionLoad;\n      this._pendingSessionLoad = null;\n    }\n  }\n\n  // ===== Public Session API =====\n\n  /**\n   * Get the current session ID (if session is enabled)\n   * Delegates to AgentContext.\n   */\n  getSessionId(): string | null {\n    return this._agentContext.sessionId;\n  }\n\n  /**\n   * Check if this agent has session support enabled\n   */\n  hasSession(): boolean {\n    return this._agentContext.storage !== null;\n  }\n\n  /**\n   * Save the current session to storage.\n   * Uses getContextState() to get state, allowing subclasses to inject agent-level state.\n   *\n   * @param sessionId - Optional session ID (uses current or generates new)\n   * @param metadata - Optional session metadata\n   * @throws Error if storage is not configured\n   */\n  async saveSession(sessionId?: string, metadata?: ContextSessionMetadata): Promise<void> {\n    await this.ensureSessionLoaded();\n    // Get state via overridable method (allows agents to inject agentState)\n    const state = await this.getContextState();\n    await this._agentContext.save(sessionId, metadata, state);\n    this._logger.debug({ sessionId: this._agentContext.sessionId }, 'Session saved');\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this.emit as any)('session:saved', { sessionId: this._agentContext.sessionId });\n  }\n\n  /**\n   * Load a session from storage.\n   * Uses restoreContextState() to restore state, allowing subclasses to restore agent-level state.\n   *\n   * @param sessionId - Session ID to load\n   * @returns true if session was found and loaded, false if not found\n   * @throws Error if storage is not configured\n   */\n  async loadSession(sessionId: string): Promise<boolean> {\n    // Load raw state (doesn't restore yet)\n    const result = await this._agentContext.loadRaw(sessionId);\n    if (!result) {\n      this._logger.warn({ sessionId }, 'Session not found');\n      return false;\n    }\n    // Restore via overridable method (allows agents to restore agentState)\n    await this.restoreContextState(result.state);\n    this._logger.info({ sessionId }, 'Session loaded');\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this.emit as any)('session:loaded', { sessionId });\n    return true;\n  }\n\n  /**\n   * Check if a session exists in storage.\n   * Delegates to AgentContext.sessionExists().\n   */\n  async sessionExists(sessionId: string): Promise<boolean> {\n    return this._agentContext.sessionExists(sessionId);\n  }\n\n  /**\n   * Delete a session from storage.\n   * Delegates to AgentContext.deleteSession().\n   */\n  async deleteSession(sessionId?: string): Promise<void> {\n    await this._agentContext.deleteSession(sessionId);\n    this._logger.debug({ sessionId }, 'Session deleted');\n  }\n\n  /**\n   * Get context state for session persistence.\n   * Override in subclasses to include agent-specific state in agentState field.\n   */\n  async getContextState(): Promise<SerializedContextState> {\n    return this._agentContext.getState();\n  }\n\n  /**\n   * Restore context from saved state.\n   * Override in subclasses to restore agent-specific state from agentState field.\n   * Preserves explicit instructions if caller provided them at construction time.\n   */\n  async restoreContextState(state: SerializedContextState): Promise<void> {\n    // Preserve caller-provided instructions over saved session's systemPrompt\n    const explicitPrompt = this._hasExplicitInstructions ? this._agentContext.systemPrompt : undefined;\n    this._agentContext.restoreState(state);\n    if (this._hasExplicitInstructions && explicitPrompt !== undefined) {\n      this._agentContext.systemPrompt = explicitPrompt;\n    }\n  }\n\n  // ===== Public Permission API =====\n\n  /**\n   * Advanced tool management. Returns ToolManager for fine-grained control.\n   * This is delegated to AgentContextNextGen.tools (single source of truth).\n   */\n  get tools(): ToolManager {\n    return this._agentContext.tools;\n  }\n\n  /**\n   * Get the AgentContextNextGen (unified context management).\n   * This is the primary way to access tools, memory, and history.\n   */\n  get context(): AgentContextNextGen {\n    return this._agentContext;\n  }\n\n  /**\n   * Get the current user ID. Delegates to AgentContextNextGen.\n   */\n  get userId(): string | undefined {\n    return this._agentContext.userId;\n  }\n\n  /**\n   * Set user ID at runtime. Automatically updates ToolContext for all tool executions.\n   */\n  set userId(value: string | undefined) {\n    this._agentContext.userId = value;\n  }\n\n  /**\n   * Get the auth identities this agent is scoped to (undefined = all visible connectors).\n   */\n  get identities(): AuthIdentity[] | undefined {\n    return this._agentContext.identities;\n  }\n\n  /**\n   * Set auth identities at runtime. Updates ToolContext.connectorRegistry and tool descriptions.\n   */\n  set identities(value: AuthIdentity[] | undefined) {\n    this._agentContext.identities = value;\n  }\n\n  /**\n   * Permission management. Returns ToolPermissionManager for approval control.\n   */\n  get permissions(): ToolPermissionManager {\n    return this._permissionManager;\n  }\n\n  // ===== Tool Management =====\n\n  /**\n   * Add a tool to the agent.\n   * Tools are registered with AgentContext (single source of truth).\n   *\n   * @param tool - The tool function to register\n   * @param options - Optional registration options (namespace, source, priority, etc.)\n   */\n  addTool(tool: ToolFunction, options?: ToolOptions): void {\n    this._agentContext.tools.register(tool, options);\n\n    // Sync permission config if tool has one\n    if (tool.permission) {\n      this._permissionManager.setToolConfig(tool.definition.function.name, tool.permission);\n    }\n  }\n\n  /**\n   * Remove a tool from the agent.\n   * Tools are unregistered from AgentContext (single source of truth).\n   */\n  removeTool(toolName: string): void {\n    this._agentContext.tools.unregister(toolName);\n  }\n\n  /**\n   * List registered tools (returns enabled tool names)\n   */\n  listTools(): string[] {\n    return this._agentContext.tools.listEnabled();\n  }\n\n  /**\n   * Replace all tools with a new array\n   */\n  setTools(tools: ToolFunction[]): void {\n    this._agentContext.tools.clear();\n    for (const tool of tools) {\n      this._agentContext.tools.register(tool);\n      if (tool.permission) {\n        this._permissionManager.setToolConfig(tool.definition.function.name, tool.permission);\n      }\n    }\n  }\n\n  /**\n   * Get enabled tool definitions (for passing to LLM).\n   * This is a helper that extracts definitions from enabled tools.\n   *\n   * If a tool has a `descriptionFactory`, it's called to generate a dynamic description\n   * that reflects current state (e.g., available connectors). This ensures the LLM\n   * always sees up-to-date tool descriptions.\n   */\n  protected getEnabledToolDefinitions(): import('../domain/entities/Tool.js').FunctionToolDefinition[] {\n    const toolContext = this._agentContext.tools.getToolContext();\n    const identities = this._agentContext.identities;\n\n    // Build allowed source set from identities\n    // { connector: 'microsoft', accountId: 'work' }  allows 'connector:microsoft:work'\n    // { connector: 'github' } (no accountId)  allows 'connector:github' and 'connector:github:*'\n    let allowedSources: Set<string> | undefined;\n    let allowedConnectorNames: Set<string> | undefined;\n    if (identities) {\n      allowedSources = new Set<string>();\n      allowedConnectorNames = new Set<string>();\n      for (const id of identities) {\n        allowedConnectorNames.add(id.connector);\n        if (id.accountId) {\n          allowedSources.add(`connector:${id.connector}:${id.accountId}`);\n        } else {\n          // No accountId  allow the base connector source and any account-specific ones\n          allowedSources.add(`connector:${id.connector}`);\n          allowedConnectorNames.add(id.connector); // used for wildcard matching below\n        }\n      }\n    }\n\n    return this._agentContext.tools.getEnabledRegistrations()\n      .filter((reg) => {\n        // No identity restriction  show all tools\n        if (!allowedSources) return true;\n        // Non-connector tools (built-in, custom, mcp, etc.) always pass\n        if (!reg.source?.startsWith('connector:')) return true;\n        // Exact match\n        if (allowedSources.has(reg.source)) return true;\n        // Wildcard: identity without accountId allows any account for that connector\n        const sourceParts = reg.source.slice('connector:'.length).split(':');\n        const connectorName = sourceParts[0]!;\n        // Check if there's an identity without accountId for this connector (wildcard)\n        if (allowedConnectorNames!.has(connectorName) && allowedSources.has(`connector:${connectorName}`)) {\n          return true;\n        }\n        return false;\n      })\n      .map((reg) => {\n        const tool = reg.tool;\n        // If tool has a descriptionFactory, use it to generate dynamic description\n        // Pass current ToolContext so descriptions can scope by userId, etc.\n        if (tool.descriptionFactory) {\n          const dynamicDescription = tool.descriptionFactory(toolContext);\n          return {\n            ...tool.definition,\n            function: {\n              ...tool.definition.function,\n              description: dynamicDescription,\n            },\n          };\n        }\n        // Otherwise, use the static definition as-is\n        return tool.definition;\n      });\n  }\n\n  // ===== Model Discovery =====\n\n  /**\n   * List available models from the provider's API.\n   * Useful for discovering models dynamically (e.g., Ollama local models).\n   */\n  async listModels(): Promise<string[]> {\n    return this._provider.listModels();\n  }\n\n  // ===== Snapshot / Inspection =====\n\n  /**\n   * Get a complete, serializable snapshot of the agent's context state.\n   *\n   * Convenience method that auto-wires tool usage stats from ToolManager.\n   * Used by UI \"Look Inside\" panels.\n   */\n  async getSnapshot(): Promise<import('./context-nextgen/snapshot.js').IContextSnapshot> {\n    const stats = this._agentContext.tools.getStats();\n    return this._agentContext.getSnapshot({ mostUsed: stats.mostUsed });\n  }\n\n  /**\n   * Get a human-readable breakdown of the prepared context.\n   *\n   * Convenience method that delegates to AgentContextNextGen.\n   * Used by \"View Full Context\" UI panels.\n   */\n  async getViewContext(): Promise<import('./context-nextgen/snapshot.js').IViewContextData> {\n    return this._agentContext.getViewContext();\n  }\n\n  // ===== Direct LLM Access (Bypasses AgentContext) =====\n\n  /**\n   * Get the provider for LLM calls.\n   * Returns the single shared provider instance.\n   */\n  protected getProvider(): ITextProvider {\n    return this._provider;\n  }\n\n  /**\n   * Make a direct LLM call bypassing all context management.\n   *\n   * This method:\n   * - Does NOT track messages in history\n   * - Does NOT use AgentContext features (memory, cache, etc.)\n   * - Does NOT prepare context or run compaction\n   * - Does NOT go through the agentic loop (no tool execution)\n   *\n   * Use this for simple, stateless interactions where you want raw LLM access\n   * without the overhead of context management.\n   *\n   * @param input - Text string or array of InputItems (supports multimodal: text + images)\n   * @param options - Optional configuration for the call\n   * @returns Raw LLM response\n   *\n   * @example\n   * ```typescript\n   * // Simple text call\n   * const response = await agent.runDirect('What is 2 + 2?');\n   * console.log(response.output_text);\n   *\n   * // With options\n   * const response = await agent.runDirect('Summarize this', {\n   *   instructions: 'Be concise',\n   *   temperature: 0.5,\n   * });\n   *\n   * // Multimodal (text + image)\n   * const response = await agent.runDirect([\n   *   { type: 'message', role: 'user', content: [\n   *     { type: 'input_text', text: 'What is in this image?' },\n   *     { type: 'input_image', image_url: 'https://...' }\n   *   ]}\n   * ]);\n   *\n   * // With tools (single call, no loop)\n   * const response = await agent.runDirect('Get the weather', {\n   *   includeTools: true,\n   * });\n   * // Note: If the LLM returns a tool call, you must handle it yourself\n   * ```\n   */\n  async runDirect(\n    input: string | InputItem[],\n    options: DirectCallOptions = {}\n  ): Promise<LLMResponse> {\n    if (this._isDestroyed) {\n      throw new Error('Agent has been destroyed');\n    }\n\n    const provider = this.getProvider();\n\n    const generateOptions = {\n      model: this.model,\n      input,\n      instructions: options.instructions,\n      tools: options.includeTools ? this.getEnabledToolDefinitions() : undefined,\n      temperature: options.temperature,\n      max_output_tokens: options.maxOutputTokens,\n      response_format: options.responseFormat,\n      vendorOptions: options.vendorOptions,\n    };\n\n    this._logger.debug({ inputType: typeof input }, 'runDirect called');\n\n    try {\n      const response = await provider.generate(generateOptions);\n      this._logger.debug({ outputLength: response.output_text?.length }, 'runDirect completed');\n      return response;\n    } catch (error) {\n      this._logger.error({ error: (error as Error).message }, 'runDirect failed');\n      throw error;\n    }\n  }\n\n  /**\n   * Stream a direct LLM call bypassing all context management.\n   *\n   * Same as runDirect but returns a stream of events instead of waiting\n   * for the complete response. Useful for real-time output display.\n   *\n   * @param input - Text string or array of InputItems (supports multimodal)\n   * @param options - Optional configuration for the call\n   * @returns Async iterator of stream events\n   *\n   * @example\n   * ```typescript\n   * for await (const event of agent.streamDirect('Tell me a story')) {\n   *   if (event.type === 'output_text_delta') {\n   *     process.stdout.write(event.delta);\n   *   }\n   * }\n   * ```\n   */\n  async *streamDirect(\n    input: string | InputItem[],\n    options: DirectCallOptions = {}\n  ): AsyncIterableIterator<StreamEvent> {\n    if (this._isDestroyed) {\n      throw new Error('Agent has been destroyed');\n    }\n\n    const provider = this.getProvider();\n\n    const generateOptions = {\n      model: this.model,\n      input,\n      instructions: options.instructions,\n      tools: options.includeTools ? this.getEnabledToolDefinitions() : undefined,\n      temperature: options.temperature,\n      max_output_tokens: options.maxOutputTokens,\n      response_format: options.responseFormat,\n      vendorOptions: options.vendorOptions,\n    };\n\n    this._logger.debug({ inputType: typeof input }, 'streamDirect called');\n\n    try {\n      yield* provider.streamGenerate(generateOptions);\n      this._logger.debug('streamDirect completed');\n    } catch (error) {\n      this._logger.error({ error: (error as Error).message }, 'streamDirect failed');\n      throw error;\n    }\n  }\n\n  // ===== Lifecycle Hooks =====\n\n  /**\n   * Get the current lifecycle hooks configuration\n   */\n  get lifecycleHooks(): AgentLifecycleHooks {\n    return this._lifecycleHooks;\n  }\n\n  /**\n   * Set or update lifecycle hooks at runtime\n   */\n  setLifecycleHooks(hooks: Partial<AgentLifecycleHooks>): void {\n    this._lifecycleHooks = { ...this._lifecycleHooks, ...hooks };\n  }\n\n  /**\n   * Invoke beforeToolExecution hook if defined.\n   * Call this before executing a tool.\n   *\n   * @throws Error if hook throws (prevents tool execution)\n   */\n  protected async invokeBeforeToolExecution(context: ToolExecutionHookContext): Promise<void> {\n    if (this._lifecycleHooks.beforeToolExecution) {\n      try {\n        await this._lifecycleHooks.beforeToolExecution(context);\n      } catch (error) {\n        this._logger.error(\n          { error: (error as Error).message, toolName: context.toolName },\n          'beforeToolExecution hook failed'\n        );\n        throw error; // Re-throw to prevent tool execution\n      }\n    }\n  }\n\n  /**\n   * Invoke afterToolExecution hook if defined.\n   * Call this after tool execution completes (success or failure).\n   */\n  protected async invokeAfterToolExecution(result: ToolExecutionResult): Promise<void> {\n    if (this._lifecycleHooks.afterToolExecution) {\n      try {\n        await this._lifecycleHooks.afterToolExecution(result);\n      } catch (error) {\n        this._logger.error(\n          { error: (error as Error).message, toolName: result.toolName },\n          'afterToolExecution hook failed'\n        );\n        // Don't re-throw - hook failure shouldn't affect main flow after execution\n      }\n    }\n  }\n\n  /**\n   * Invoke beforeContextPrepare hook if defined.\n   * Call this before preparing context for LLM.\n   */\n  protected async invokeBeforeContextPrepare(): Promise<void> {\n    if (this._lifecycleHooks.beforeContextPrepare) {\n      try {\n        await this._lifecycleHooks.beforeContextPrepare(this.name);\n      } catch (error) {\n        this._logger.error(\n          { error: (error as Error).message },\n          'beforeContextPrepare hook failed'\n        );\n        // Don't re-throw - allow context preparation to continue\n      }\n    }\n  }\n\n  /**\n   * Invoke beforeCompaction hook if defined.\n   * Call this before context compaction occurs.\n   * Gives the agent a chance to save important data to memory.\n   */\n  protected async invokeBeforeCompaction(context: BeforeCompactionContext): Promise<void> {\n    if (this._lifecycleHooks.beforeCompaction) {\n      try {\n        await this._lifecycleHooks.beforeCompaction(context);\n      } catch (error) {\n        this._logger.error(\n          {\n            error: (error as Error).message,\n            strategy: context.strategy,\n            estimatedTokensToFree: context.estimatedTokensToFree,\n          },\n          'beforeCompaction hook failed'\n        );\n        // Don't re-throw - allow compaction to continue\n      }\n    }\n  }\n\n  /**\n   * Invoke afterCompaction hook if defined.\n   * Call this after context compaction occurs.\n   */\n  protected async invokeAfterCompaction(log: string[], tokensFreed: number): Promise<void> {\n    if (this._lifecycleHooks.afterCompaction) {\n      try {\n        await this._lifecycleHooks.afterCompaction(log, tokensFreed);\n      } catch (error) {\n        this._logger.error(\n          { error: (error as Error).message, tokensFreed },\n          'afterCompaction hook failed'\n        );\n        // Don't re-throw - allow execution to continue\n      }\n    }\n  }\n\n  /**\n   * Invoke onError hook if defined.\n   * Call this when the agent encounters an error.\n   */\n  protected async invokeOnError(error: Error, phase: string): Promise<void> {\n    if (this._lifecycleHooks.onError) {\n      try {\n        await this._lifecycleHooks.onError(error, { phase, agentId: this.name });\n      } catch (hookError) {\n        this._logger.error(\n          { error: (hookError as Error).message, originalError: error.message, phase },\n          'onError hook failed'\n        );\n        // Don't re-throw - hook failure shouldn't mask original error\n      }\n    }\n  }\n\n  // ===== Lifecycle =====\n\n  get isDestroyed(): boolean {\n    return this._isDestroyed;\n  }\n\n  /**\n   * Register a cleanup callback\n   */\n  onCleanup(callback: () => void | Promise<void>): void {\n    this._cleanupCallbacks.push(callback);\n  }\n\n  /**\n   * Base cleanup for session and listeners.\n   * Subclasses should call super.baseDestroy() in their destroy() method.\n   */\n  protected baseDestroy(): void {\n    if (this._isDestroyed) {\n      return;\n    }\n    this._isDestroyed = true;\n\n    this._logger.debug('Agent destroy started');\n\n    // Stop auto-save interval\n    if (this._autoSaveInterval) {\n      clearInterval(this._autoSaveInterval);\n      this._autoSaveInterval = null;\n    }\n\n    // Cleanup AgentContext only if we own it (not shared with other agents)\n    if (this._ownsContext) {\n      this._agentContext.destroy();\n    }\n\n    // Cleanup permission manager listeners\n    this._permissionManager.removeAllListeners();\n\n    // Remove all event listeners\n    this.removeAllListeners();\n\n    // Emit destroyed event (before removing listeners)\n    // Note: This won't be received since we removed listeners above\n    // but subclasses can emit before calling baseDestroy if needed\n  }\n\n  /**\n   * Run cleanup callbacks\n   */\n  protected async runCleanupCallbacks(): Promise<void> {\n    for (const callback of this._cleanupCallbacks) {\n      try {\n        await callback();\n      } catch (error) {\n        this._logger.error({ error: (error as Error).message }, 'Cleanup callback error');\n      }\n    }\n    this._cleanupCallbacks = [];\n  }\n}\n","/**\n * Tool Permission Types\n *\n * Defines permission scopes, risk levels, and approval state for tool execution control.\n *\n * Works with ALL agent types:\n * - Agent (basic)\n * - TaskAgent (task-based)\n * - UniversalAgent (mode-fluid)\n */\n\nimport type { ToolCall } from '../../domain/entities/Tool.js';\n\n// ============================================================================\n// Permission Scopes\n// ============================================================================\n\n/**\n * Permission scope defines when approval is required for a tool\n *\n * - `once` - Require approval for each tool call (most restrictive)\n * - `session` - Approve once, valid for entire session\n * - `always` - Auto-approve (allowlisted, no prompts)\n * - `never` - Always blocked (blocklisted, tool cannot execute)\n */\nexport type PermissionScope = 'once' | 'session' | 'always' | 'never';\n\n/**\n * Risk level classification for tools\n *\n * Used to help users understand the potential impact of approving a tool.\n * Can be used by UI to show different approval dialogs.\n */\nexport type RiskLevel = 'low' | 'medium' | 'high' | 'critical';\n\n// ============================================================================\n// Tool Permission Configuration\n// ============================================================================\n\n/**\n * Permission configuration for a tool\n *\n * Can be set on the tool definition or overridden at registration time.\n */\nexport interface ToolPermissionConfig {\n  /**\n   * When approval is required.\n   * @default 'once'\n   */\n  scope?: PermissionScope;\n\n  /**\n   * Risk classification for the tool.\n   * @default 'low'\n   */\n  riskLevel?: RiskLevel;\n\n  /**\n   * Custom message shown in approval UI.\n   * Should explain what the tool does and any potential risks.\n   */\n  approvalMessage?: string;\n\n  /**\n   * Argument names that should be highlighted in approval UI.\n   * E.g., ['path', 'url'] for file/network operations.\n   */\n  sensitiveArgs?: string[];\n\n  /**\n   * Optional expiration time for session approvals (milliseconds).\n   * If set, session approvals expire after this duration.\n   */\n  sessionTTLMs?: number;\n}\n\n// ============================================================================\n// Permission Check Context (passed to approval hooks)\n// ============================================================================\n\n/**\n * Context passed to approval callbacks/hooks\n */\nexport interface PermissionCheckContext {\n  /** The tool call being checked */\n  toolCall: ToolCall;\n\n  /** Parsed arguments (for display/inspection) */\n  parsedArgs: Record<string, unknown>;\n\n  /** The tool's permission config */\n  config: ToolPermissionConfig;\n\n  /** Current execution context ID */\n  executionId: string;\n\n  /** Current iteration (if in agentic loop) */\n  iteration: number;\n\n  /** Agent type (for context-specific handling) */\n  agentType: 'agent' | 'task-agent' | 'universal-agent';\n\n  /** Optional task name (for TaskAgent/UniversalAgent) */\n  taskName?: string;\n}\n\n// ============================================================================\n// Approval State (Runtime)\n// ============================================================================\n\n/**\n * Entry in the approval cache representing an approved tool\n */\nexport interface ApprovalCacheEntry {\n  /** Name of the approved tool */\n  toolName: string;\n\n  /** The scope that was approved */\n  scope: PermissionScope;\n\n  /** When the approval was granted */\n  approvedAt: Date;\n\n  /** Optional identifier of who approved (for audit) */\n  approvedBy?: string;\n\n  /** When this approval expires (for session/TTL approvals) */\n  expiresAt?: Date;\n\n  /** Arguments hash if approval was for specific arguments */\n  argsHash?: string;\n}\n\n/**\n * Serialized approval state for session persistence\n */\nexport interface SerializedApprovalState {\n  /** Version for future migrations */\n  version: number;\n\n  /** Map of tool name to approval entry */\n  approvals: Record<string, SerializedApprovalEntry>;\n\n  /** Tools that are always blocked (persisted blocklist) */\n  blocklist: string[];\n\n  /** Tools that are always allowed (persisted allowlist) */\n  allowlist: string[];\n}\n\n/**\n * Serialized version of ApprovalCacheEntry (with ISO date strings)\n */\nexport interface SerializedApprovalEntry {\n  toolName: string;\n  scope: PermissionScope;\n  approvedAt: string; // ISO date string\n  approvedBy?: string;\n  expiresAt?: string; // ISO date string\n  argsHash?: string;\n}\n\n// ============================================================================\n// Permission Check Results\n// ============================================================================\n\n/**\n * Result of checking if a tool needs approval\n */\nexport interface PermissionCheckResult {\n  /** Whether the tool can execute without prompting */\n  allowed: boolean;\n\n  /** Whether approval is needed (user should be prompted) */\n  needsApproval: boolean;\n\n  /** Whether the tool is blocked (cannot execute at all) */\n  blocked: boolean;\n\n  /** Reason for the decision */\n  reason: string;\n\n  /** The tool's permission config (for UI display) */\n  config?: ToolPermissionConfig;\n}\n\n/**\n * Result from approval UI/hook\n */\nexport interface ApprovalDecision {\n  /** Whether the tool was approved */\n  approved: boolean;\n\n  /** Scope of the approval (may differ from requested) */\n  scope?: PermissionScope;\n\n  /** Reason for denial (if not approved) */\n  reason?: string;\n\n  /** Optional identifier of who approved */\n  approvedBy?: string;\n\n  /** Whether to remember this decision for future calls */\n  remember?: boolean;\n}\n\n// ============================================================================\n// Agent Configuration (works with ALL agent types)\n// ============================================================================\n\n/**\n * Permission configuration for any agent type.\n *\n * Used in:\n * - Agent.create({ permissions: {...} })\n * - TaskAgent.create({ permissions: {...} })\n * - UniversalAgent.create({ permissions: {...} })\n */\nexport interface AgentPermissionsConfig {\n  /**\n   * Default permission scope for tools without explicit config.\n   * @default 'once'\n   */\n  defaultScope?: PermissionScope;\n\n  /**\n   * Default risk level for tools without explicit config.\n   * @default 'low'\n   */\n  defaultRiskLevel?: RiskLevel;\n\n  /**\n   * Tools that are always allowed (never prompt).\n   * Array of tool names.\n   */\n  allowlist?: string[];\n\n  /**\n   * Tools that are always blocked (cannot execute).\n   * Array of tool names.\n   */\n  blocklist?: string[];\n\n  /**\n   * Per-tool permission overrides.\n   * Keys are tool names, values are permission configs.\n   */\n  tools?: Record<string, ToolPermissionConfig>;\n\n  /**\n   * Callback invoked when a tool needs approval.\n   * Return an ApprovalDecision to approve/deny.\n   *\n   * If not provided, the existing `approve:tool` hook system is used.\n   * This callback runs BEFORE hooks, providing a first-pass check.\n   */\n  onApprovalRequired?: (context: PermissionCheckContext) => Promise<ApprovalDecision>;\n\n  /**\n   * Whether to inherit permission state from parent session.\n   * Only applies when resuming from a session.\n   * @default true\n   */\n  inheritFromSession?: boolean;\n}\n\n// ============================================================================\n// Events\n// ============================================================================\n\n/**\n * Events emitted by ToolPermissionManager\n */\nexport type PermissionManagerEvent =\n  | 'tool:approved'\n  | 'tool:denied'\n  | 'tool:blocked'\n  | 'tool:revoked'\n  | 'allowlist:added'\n  | 'allowlist:removed'\n  | 'blocklist:added'\n  | 'blocklist:removed'\n  | 'session:cleared';\n\n// ============================================================================\n// Constants\n// ============================================================================\n\n/**\n * Current version of serialized approval state\n */\nexport const APPROVAL_STATE_VERSION = 1;\n\n/**\n * Default permission config applied when no config is specified\n */\nexport const DEFAULT_PERMISSION_CONFIG: Required<Pick<ToolPermissionConfig, 'scope' | 'riskLevel'>> = {\n  scope: 'once',\n  riskLevel: 'low',\n};\n\n/**\n * Default allowlist - tools that never require user confirmation.\n *\n * These tools are safe to execute without user approval:\n * - Read-only operations (filesystem reads, searches)\n * - Internal state management (memory tools)\n * - Introspection tools (context stats)\n * - In-context memory tools\n * - Persistent instructions tools\n * - Meta-tools for agent coordination\n *\n * All other tools (write operations, shell commands, external requests)\n * require explicit user approval by default.\n */\nexport const DEFAULT_ALLOWLIST: readonly string[] = [\n  // Filesystem read-only tools\n  'read_file',\n  'glob',\n  'grep',\n  'list_directory',\n\n  // Memory management (internal state - safe)\n  'memory_store',\n  'memory_retrieve',\n  'memory_delete',\n  'memory_query',\n  'memory_cleanup_raw',\n\n  // Context introspection (unified tool)\n  'context_stats',\n\n  // In-context memory tools\n  'context_set',\n  'context_delete',\n  'context_list',\n\n  // Persistent instructions tools\n  'instructions_set',\n  'instructions_remove',\n  'instructions_list',\n  'instructions_clear',\n\n  // User info tools (user-specific data - safe)\n  'user_info_set',\n  'user_info_get',\n  'user_info_remove',\n  'user_info_clear',\n\n  // TODO tools (user-specific data - safe)\n  'todo_add',\n  'todo_update',\n  'todo_remove',\n\n  // Tool catalog tools (browsing and loading  safe)\n  'tool_catalog_search',\n  'tool_catalog_load',\n  'tool_catalog_unload',\n\n  // Meta-tools (internal coordination)\n  '_start_planning',\n  '_modify_plan',\n  '_report_progress',\n  '_request_approval', // CRITICAL: Must be allowlisted to avoid circular dependency!\n] as const;\n\n/**\n * Type for default allowlisted tools\n */\nexport type DefaultAllowlistedTool = (typeof DEFAULT_ALLOWLIST)[number];\n","/**\n * ToolPermissionManager - Core class for managing tool permissions\n *\n * Features:\n * - Approval caching (once, session, always, never scopes)\n * - Allowlist/blocklist management\n * - Session state persistence\n * - Event emission for audit trails\n *\n * Works with ALL agent types:\n * - Agent (basic)\n * - TaskAgent (task-based)\n * - UniversalAgent (mode-fluid)\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport type {\n  PermissionScope,\n  RiskLevel,\n  ToolPermissionConfig,\n  ApprovalCacheEntry,\n  SerializedApprovalState,\n  SerializedApprovalEntry,\n  PermissionCheckResult,\n  ApprovalDecision,\n  AgentPermissionsConfig,\n  PermissionCheckContext,\n} from './types.js';\nimport {\n  APPROVAL_STATE_VERSION,\n  DEFAULT_PERMISSION_CONFIG,\n  DEFAULT_ALLOWLIST,\n} from './types.js';\nimport type { ToolCall } from '../../domain/entities/Tool.js';\n\n// ============================================================================\n// Event Types\n// ============================================================================\n\nexport interface PermissionManagerEvents {\n  'tool:approved': { toolName: string; scope: PermissionScope; approvedBy?: string };\n  'tool:denied': { toolName: string; reason: string };\n  'tool:blocked': { toolName: string; reason: string };\n  'tool:revoked': { toolName: string };\n  'allowlist:added': { toolName: string };\n  'allowlist:removed': { toolName: string };\n  'blocklist:added': { toolName: string };\n  'blocklist:removed': { toolName: string };\n  'session:cleared': {};\n}\n\n// ============================================================================\n// ToolPermissionManager Class\n// ============================================================================\n\nexport class ToolPermissionManager extends EventEmitter {\n  // Approval cache (session-level)\n  private approvalCache: Map<string, ApprovalCacheEntry> = new Map();\n\n  // Allow/block lists\n  private allowlist: Set<string> = new Set();\n  private blocklist: Set<string> = new Set();\n\n  // Per-tool configurations\n  private toolConfigs: Map<string, ToolPermissionConfig> = new Map();\n\n  // Defaults\n  private defaultScope: PermissionScope;\n  private defaultRiskLevel: RiskLevel;\n\n  // Optional approval callback\n  private onApprovalRequired?: (context: PermissionCheckContext) => Promise<ApprovalDecision>;\n\n  constructor(config?: AgentPermissionsConfig) {\n    super();\n\n    this.defaultScope = config?.defaultScope ?? DEFAULT_PERMISSION_CONFIG.scope;\n    this.defaultRiskLevel = config?.defaultRiskLevel ?? DEFAULT_PERMISSION_CONFIG.riskLevel;\n\n    // Initialize allowlist with defaults first\n    // This ensures safe tools (read-only, introspection, meta-tools) are always allowed\n    for (const toolName of DEFAULT_ALLOWLIST) {\n      this.allowlist.add(toolName);\n    }\n\n    // Add user-provided allowlist (merges with defaults)\n    if (config?.allowlist) {\n      for (const toolName of config.allowlist) {\n        this.allowlist.add(toolName);\n      }\n    }\n\n    // Initialize blocklist\n    if (config?.blocklist) {\n      for (const toolName of config.blocklist) {\n        this.blocklist.add(toolName);\n      }\n    }\n\n    // Initialize per-tool configs\n    if (config?.tools) {\n      for (const [toolName, toolConfig] of Object.entries(config.tools)) {\n        this.toolConfigs.set(toolName, toolConfig);\n      }\n    }\n\n    // Store approval callback\n    this.onApprovalRequired = config?.onApprovalRequired;\n  }\n\n  // ==========================================================================\n  // Core Permission Checking\n  // ==========================================================================\n\n  /**\n   * Check if a tool needs approval before execution\n   *\n   * @param toolName - Name of the tool\n   * @param _args - Optional arguments (for args-specific approval, reserved for future use)\n   * @returns PermissionCheckResult with allowed/needsApproval/blocked status\n   */\n  checkPermission(toolName: string, _args?: Record<string, unknown>): PermissionCheckResult {\n    const config = this.getEffectiveConfig(toolName);\n\n    // Check blocklist first (highest priority)\n    if (this.blocklist.has(toolName)) {\n      return {\n        allowed: false,\n        needsApproval: false,\n        blocked: true,\n        reason: 'Tool is blocklisted',\n        config,\n      };\n    }\n\n    // Check allowlist (always allowed)\n    if (this.allowlist.has(toolName)) {\n      return {\n        allowed: true,\n        needsApproval: false,\n        blocked: false,\n        reason: 'Tool is allowlisted',\n        config,\n      };\n    }\n\n    // Check scope\n    const scope = config.scope ?? this.defaultScope;\n\n    switch (scope) {\n      case 'always':\n        return {\n          allowed: true,\n          needsApproval: false,\n          blocked: false,\n          reason: 'Tool scope is \"always\"',\n          config,\n        };\n\n      case 'never':\n        return {\n          allowed: false,\n          needsApproval: false,\n          blocked: true,\n          reason: 'Tool scope is \"never\"',\n          config,\n        };\n\n      case 'session':\n        // Check if already approved this session\n        if (this.isApprovedForSession(toolName)) {\n          return {\n            allowed: true,\n            needsApproval: false,\n            blocked: false,\n            reason: 'Tool approved for session',\n            config,\n          };\n        }\n        return {\n          allowed: false,\n          needsApproval: true,\n          blocked: false,\n          reason: 'Session approval required',\n          config,\n        };\n\n      case 'once':\n      default:\n        // Always require approval\n        return {\n          allowed: false,\n          needsApproval: true,\n          blocked: false,\n          reason: 'Per-call approval required',\n          config,\n        };\n    }\n  }\n\n  /**\n   * Check if a tool call needs approval (uses ToolCall object)\n   */\n  needsApproval(toolCall: ToolCall): boolean {\n    const result = this.checkPermission(toolCall.function.name);\n    return result.needsApproval;\n  }\n\n  /**\n   * Check if a tool is blocked\n   */\n  isBlocked(toolName: string): boolean {\n    return this.checkPermission(toolName).blocked;\n  }\n\n  /**\n   * Check if a tool is approved (either allowlisted or session-approved)\n   */\n  isApproved(toolName: string): boolean {\n    return this.checkPermission(toolName).allowed;\n  }\n\n  // ==========================================================================\n  // Approval Management\n  // ==========================================================================\n\n  /**\n   * Approve a tool (record approval)\n   *\n   * @param toolName - Name of the tool\n   * @param decision - Approval decision with scope\n   */\n  approve(toolName: string, decision?: Partial<ApprovalDecision>): void {\n    const scope = decision?.scope ?? 'session';\n    const config = this.getEffectiveConfig(toolName);\n\n    // Calculate expiration\n    let expiresAt: Date | undefined;\n    if (scope === 'session' && config.sessionTTLMs) {\n      expiresAt = new Date(Date.now() + config.sessionTTLMs);\n    }\n\n    const entry: ApprovalCacheEntry = {\n      toolName,\n      scope,\n      approvedAt: new Date(),\n      approvedBy: decision?.approvedBy,\n      expiresAt,\n    };\n\n    this.approvalCache.set(toolName, entry);\n\n    this.emit('tool:approved', {\n      toolName,\n      scope,\n      approvedBy: decision?.approvedBy,\n    });\n  }\n\n  /**\n   * Approve a tool for the entire session\n   */\n  approveForSession(toolName: string, approvedBy?: string): void {\n    this.approve(toolName, { scope: 'session', approvedBy });\n  }\n\n  /**\n   * Revoke a tool's approval\n   */\n  revoke(toolName: string): void {\n    if (this.approvalCache.has(toolName)) {\n      this.approvalCache.delete(toolName);\n      this.emit('tool:revoked', { toolName });\n    }\n  }\n\n  /**\n   * Deny a tool execution (for audit trail)\n   */\n  deny(toolName: string, reason: string): void {\n    this.emit('tool:denied', { toolName, reason });\n  }\n\n  /**\n   * Check if a tool has been approved for the current session\n   */\n  isApprovedForSession(toolName: string): boolean {\n    const entry = this.approvalCache.get(toolName);\n    if (!entry) return false;\n\n    // Check expiration\n    if (entry.expiresAt && entry.expiresAt < new Date()) {\n      this.approvalCache.delete(toolName);\n      return false;\n    }\n\n    return entry.scope === 'session' || entry.scope === 'always';\n  }\n\n  // ==========================================================================\n  // Allowlist / Blocklist Management\n  // ==========================================================================\n\n  /**\n   * Add a tool to the allowlist (always allowed)\n   */\n  allowlistAdd(toolName: string): void {\n    // Remove from blocklist if present\n    this.blocklist.delete(toolName);\n\n    this.allowlist.add(toolName);\n    this.emit('allowlist:added', { toolName });\n  }\n\n  /**\n   * Remove a tool from the allowlist\n   */\n  allowlistRemove(toolName: string): void {\n    if (this.allowlist.delete(toolName)) {\n      this.emit('allowlist:removed', { toolName });\n    }\n  }\n\n  /**\n   * Check if a tool is in the allowlist\n   */\n  isAllowlisted(toolName: string): boolean {\n    return this.allowlist.has(toolName);\n  }\n\n  /**\n   * Get all allowlisted tools\n   */\n  getAllowlist(): string[] {\n    return Array.from(this.allowlist);\n  }\n\n  /**\n   * Add a tool to the blocklist (always blocked)\n   */\n  blocklistAdd(toolName: string): void {\n    // Remove from allowlist if present\n    this.allowlist.delete(toolName);\n\n    this.blocklist.add(toolName);\n    this.emit('blocklist:added', { toolName });\n  }\n\n  /**\n   * Remove a tool from the blocklist\n   */\n  blocklistRemove(toolName: string): void {\n    if (this.blocklist.delete(toolName)) {\n      this.emit('blocklist:removed', { toolName });\n    }\n  }\n\n  /**\n   * Check if a tool is in the blocklist\n   */\n  isBlocklisted(toolName: string): boolean {\n    return this.blocklist.has(toolName);\n  }\n\n  /**\n   * Get all blocklisted tools\n   */\n  getBlocklist(): string[] {\n    return Array.from(this.blocklist);\n  }\n\n  // ==========================================================================\n  // Tool Configuration\n  // ==========================================================================\n\n  /**\n   * Set permission config for a specific tool\n   */\n  setToolConfig(toolName: string, config: ToolPermissionConfig): void {\n    this.toolConfigs.set(toolName, config);\n  }\n\n  /**\n   * Get permission config for a specific tool\n   */\n  getToolConfig(toolName: string): ToolPermissionConfig | undefined {\n    return this.toolConfigs.get(toolName);\n  }\n\n  /**\n   * Get effective config (tool-specific or defaults)\n   */\n  getEffectiveConfig(toolName: string): ToolPermissionConfig {\n    const toolConfig = this.toolConfigs.get(toolName);\n    return {\n      scope: toolConfig?.scope ?? this.defaultScope,\n      riskLevel: toolConfig?.riskLevel ?? this.defaultRiskLevel,\n      approvalMessage: toolConfig?.approvalMessage,\n      sensitiveArgs: toolConfig?.sensitiveArgs,\n      sessionTTLMs: toolConfig?.sessionTTLMs,\n    };\n  }\n\n  // ==========================================================================\n  // Approval Request Handler\n  // ==========================================================================\n\n  /**\n   * Request approval for a tool call\n   *\n   * If an onApprovalRequired callback is set, it will be called.\n   * Otherwise, this auto-approves for backward compatibility.\n   *\n   * NOTE: If you want to require explicit approval, you MUST either:\n   * 1. Set onApprovalRequired callback in AgentPermissionsConfig\n   * 2. Register an 'approve:tool' hook in the Agent\n   * 3. Add tools to the blocklist if they should never run\n   *\n   * This auto-approval behavior preserves backward compatibility with\n   * existing code that doesn't use the permission system.\n   */\n  async requestApproval(context: PermissionCheckContext): Promise<ApprovalDecision> {\n    if (this.onApprovalRequired) {\n      const decision = await this.onApprovalRequired(context);\n\n      // Record the decision\n      if (decision.approved) {\n        this.approve(context.toolCall.function.name, decision);\n      } else {\n        this.deny(context.toolCall.function.name, decision.reason ?? 'User denied');\n      }\n\n      return decision;\n    }\n\n    // No callback - auto-approve for backward compatibility\n    // This preserves the pre-permission-system behavior where all tools\n    // were automatically allowed to execute. Users who want to require\n    // explicit approval must set onApprovalRequired or use approve:tool hooks.\n    return {\n      approved: true,\n      reason: 'Auto-approved (no approval handler configured)',\n    };\n  }\n\n  // ==========================================================================\n  // Query Methods\n  // ==========================================================================\n\n  /**\n   * Get all tools that have session approvals\n   */\n  getApprovedTools(): string[] {\n    const approved: string[] = [];\n\n    for (const [toolName, entry] of this.approvalCache) {\n      // Skip expired\n      if (entry.expiresAt && entry.expiresAt < new Date()) {\n        continue;\n      }\n      approved.push(toolName);\n    }\n\n    return approved;\n  }\n\n  /**\n   * Get the approval entry for a tool\n   */\n  getApprovalEntry(toolName: string): ApprovalCacheEntry | undefined {\n    const entry = this.approvalCache.get(toolName);\n    if (!entry) return undefined;\n\n    // Check expiration\n    if (entry.expiresAt && entry.expiresAt < new Date()) {\n      this.approvalCache.delete(toolName);\n      return undefined;\n    }\n\n    return entry;\n  }\n\n  // ==========================================================================\n  // Session Management\n  // ==========================================================================\n\n  /**\n   * Clear all session approvals\n   */\n  clearSession(): void {\n    this.approvalCache.clear();\n    this.emit('session:cleared', {});\n  }\n\n  // ==========================================================================\n  // Persistence (for Session integration)\n  // ==========================================================================\n\n  /**\n   * Serialize approval state for persistence\n   */\n  getState(): SerializedApprovalState {\n    const approvals: Record<string, SerializedApprovalEntry> = {};\n\n    for (const [toolName, entry] of this.approvalCache) {\n      // Skip expired entries\n      if (entry.expiresAt && entry.expiresAt < new Date()) {\n        continue;\n      }\n\n      approvals[toolName] = {\n        toolName: entry.toolName,\n        scope: entry.scope,\n        approvedAt: entry.approvedAt.toISOString(),\n        approvedBy: entry.approvedBy,\n        expiresAt: entry.expiresAt?.toISOString(),\n        argsHash: entry.argsHash,\n      };\n    }\n\n    return {\n      version: APPROVAL_STATE_VERSION,\n      approvals,\n      blocklist: Array.from(this.blocklist),\n      allowlist: Array.from(this.allowlist),\n    };\n  }\n\n  /**\n   * Load approval state from persistence\n   */\n  loadState(state: SerializedApprovalState): void {\n    // Clear current state\n    this.approvalCache.clear();\n\n    // Validate version\n    if (state.version !== APPROVAL_STATE_VERSION) {\n      // Future: handle migrations\n      console.warn(`ToolPermissionManager: Unknown state version ${state.version}, ignoring`);\n      return;\n    }\n\n    // Restore approvals\n    for (const [toolName, entry] of Object.entries(state.approvals)) {\n      const approvedAt = new Date(entry.approvedAt);\n      const expiresAt = entry.expiresAt ? new Date(entry.expiresAt) : undefined;\n\n      // Skip expired entries\n      if (expiresAt && expiresAt < new Date()) {\n        continue;\n      }\n\n      this.approvalCache.set(toolName, {\n        toolName: entry.toolName,\n        scope: entry.scope,\n        approvedAt,\n        approvedBy: entry.approvedBy,\n        expiresAt,\n        argsHash: entry.argsHash,\n      });\n    }\n\n    // Restore lists (merge with constructor-provided lists)\n    for (const toolName of state.blocklist) {\n      this.blocklist.add(toolName);\n    }\n\n    for (const toolName of state.allowlist) {\n      // Remove from blocklist if present (allowlist takes precedence in loaded state)\n      this.blocklist.delete(toolName);\n      this.allowlist.add(toolName);\n    }\n  }\n\n  // ==========================================================================\n  // Utility Methods\n  // ==========================================================================\n\n  /**\n   * Get defaults\n   */\n  getDefaults(): { scope: PermissionScope; riskLevel: RiskLevel } {\n    return {\n      scope: this.defaultScope,\n      riskLevel: this.defaultRiskLevel,\n    };\n  }\n\n  /**\n   * Set defaults\n   */\n  setDefaults(defaults: { scope?: PermissionScope; riskLevel?: RiskLevel }): void {\n    if (defaults.scope) this.defaultScope = defaults.scope;\n    if (defaults.riskLevel) this.defaultRiskLevel = defaults.riskLevel;\n  }\n\n  /**\n   * Get summary statistics\n   */\n  getStats(): {\n    approvedCount: number;\n    allowlistedCount: number;\n    blocklistedCount: number;\n    configuredCount: number;\n  } {\n    return {\n      approvedCount: this.getApprovedTools().length,\n      allowlistedCount: this.allowlist.size,\n      blocklistedCount: this.blocklist.size,\n      configuredCount: this.toolConfigs.size,\n    };\n  }\n\n  /**\n   * Reset to initial state\n   */\n  reset(): void {\n    this.approvalCache.clear();\n    this.allowlist.clear();\n    this.blocklist.clear();\n    this.toolConfigs.clear();\n    this.defaultScope = DEFAULT_PERMISSION_CONFIG.scope;\n    this.defaultRiskLevel = DEFAULT_PERMISSION_CONFIG.riskLevel;\n  }\n}\n","/**\n * ToolManager - Unified tool management and execution for agents\n *\n * Provides tool management capabilities:\n * - Enable/disable tools at runtime without removing them\n * - Namespace grouping for organizing related tools\n * - Priority-based selection\n * - Context-aware tool selection\n * - Usage statistics\n * - Circuit breaker protection for tool execution\n * - Implements IToolExecutor for use with Agent\n * - Implements IDisposable for proper lifecycle management\n *\n * This is a SIMPLE tool executor. It does NOT:\n * - Cache results (no idempotency cache)\n * - Access parent context (clean separation of concerns)\n *\n * Context (memory, agentId, etc.) is provided via setToolContext() before execution.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport type { Tool, ToolFunction, ToolPermissionConfig } from '../domain/entities/Tool.js';\nimport type { IToolExecutor } from '../domain/interfaces/IToolExecutor.js';\nimport type { IDisposable } from '../domain/interfaces/IDisposable.js';\nimport type { ToolContext } from '../domain/interfaces/IToolContext.js';\nimport { CircuitBreaker } from '../infrastructure/resilience/CircuitBreaker.js';\nimport type { CircuitState, CircuitBreakerConfig } from '../infrastructure/resilience/CircuitBreaker.js';\nimport { ToolNotFoundError, ToolExecutionError } from '../domain/errors/AIErrors.js';\nimport { logger, FrameworkLogger } from '../infrastructure/observability/Logger.js';\nimport { metrics } from '../infrastructure/observability/Metrics.js';\nimport { ToolExecutionPipeline } from './tool-execution/ToolExecutionPipeline.js';\nimport { ResultNormalizerPlugin } from './tool-execution/plugins/ResultNormalizerPlugin.js';\nimport type { IToolExecutionPipeline } from './tool-execution/types.js';\n\n// Re-export CircuitState for convenience\nexport type { CircuitState, CircuitBreakerConfig } from '../infrastructure/resilience/CircuitBreaker.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/**\n * Source identifier for a registered tool\n */\nexport type ToolSource = 'built-in' | 'connector' | 'custom' | 'mcp' | string;\n\n/**\n * Options for searching tools\n */\nexport interface ToolSearchOptions {\n  /** Filter by tags (any match) */\n  tags?: string[];\n  /** Filter by category */\n  category?: string;\n  /** Only return enabled tools. Default: true */\n  enabledOnly?: boolean;\n  /** Filter by source */\n  source?: ToolSource;\n  /** Filter by namespace */\n  namespace?: string;\n  /** Maximum number of results */\n  limit?: number;\n  /** Offset for pagination */\n  offset?: number;\n}\n\n/**\n * Result from a tool search\n */\nexport interface ToolSearchResult {\n  /** The tool function */\n  tool: ToolFunction;\n  /** Tool name */\n  name: string;\n  /** Tool description */\n  description: string;\n  /** Relevance score (higher = more relevant) */\n  relevanceScore: number;\n  /** Tags */\n  tags?: string[];\n  /** Category */\n  category?: string;\n  /** Source */\n  source?: ToolSource;\n  /** Namespace */\n  namespace: string;\n}\n\nexport interface ToolOptions {\n  /** Whether the tool is enabled. Default: true */\n  enabled?: boolean;\n  /** Namespace for grouping related tools. Default: 'default' */\n  namespace?: string;\n  /** Priority for selection ordering. Higher = preferred. Default: 0 */\n  priority?: number;\n  /** Conditions for auto-enable/disable */\n  conditions?: ToolCondition[];\n  /** Permission configuration override. If not set, uses tool's config or defaults. */\n  permission?: ToolPermissionConfig;\n  /** Tags for categorization and search */\n  tags?: string[];\n  /** Category grouping */\n  category?: string;\n  /** Source identifier (built-in, connector, custom, mcp, etc.) */\n  source?: ToolSource;\n}\n\nexport interface ToolCondition {\n  type: 'mode' | 'context' | 'custom';\n  predicate: (context: ToolSelectionContext) => boolean;\n}\n\nexport interface ToolSelectionContext {\n  /** Current user input or task description */\n  input?: string;\n  /** Current agent mode (for UniversalAgent) */\n  mode?: string;\n  /** Current task name (for TaskAgent) */\n  currentTask?: string;\n  /** Recently used tools (to avoid repetition) */\n  recentTools?: string[];\n  /** Token budget for tool definitions */\n  tokenBudget?: number;\n  /** Custom context data */\n  custom?: Record<string, unknown>;\n}\n\nexport interface ToolRegistration {\n  tool: ToolFunction;\n  enabled: boolean;\n  namespace: string;\n  priority: number;\n  conditions: ToolCondition[];\n  metadata: ToolMetadata;\n  /** Effective permission config (merged from tool.permission and options.permission) */\n  permission?: ToolPermissionConfig;\n  /** Circuit breaker configuration for this tool (uses shared CircuitBreakerConfig from resilience) */\n  circuitBreakerConfig?: Partial<CircuitBreakerConfig>;\n  /** Tags for categorization and search */\n  tags?: string[];\n  /** Category grouping */\n  category?: string;\n  /** Source identifier (built-in, connector, custom, mcp, etc.) */\n  source?: ToolSource;\n}\n\nexport interface ToolMetadata {\n  registeredAt: Date;\n  usageCount: number;\n  lastUsed?: Date;\n  totalExecutionMs: number;\n  avgExecutionMs: number;\n  successCount: number;\n  failureCount: number;\n}\n\nexport interface ToolManagerStats {\n  totalTools: number;\n  enabledTools: number;\n  disabledTools: number;\n  namespaces: string[];\n  toolsByNamespace: Record<string, number>;\n  mostUsed: Array<{ name: string; count: number }>;\n  totalExecutions: number;\n}\n\nexport interface SerializedToolState {\n  enabled: Record<string, boolean>;\n  namespaces: Record<string, string>;\n  priorities: Record<string, number>;\n  /** Permission configs by tool name */\n  permissions?: Record<string, ToolPermissionConfig>;\n  /** Tags by tool name */\n  tags?: Record<string, string[]>;\n  /** Categories by tool name */\n  categories?: Record<string, string>;\n  /** Sources by tool name */\n  sources?: Record<string, ToolSource>;\n}\n\nexport type ToolManagerEvent =\n  | 'tool:registered'\n  | 'tool:unregistered'\n  | 'tool:enabled'\n  | 'tool:disabled'\n  | 'tool:executed'\n  | 'namespace:enabled'\n  | 'namespace:disabled';\n\n// ============================================================================\n// ToolManager Class\n// ============================================================================\n\n/**\n * Configuration for ToolManager\n */\nexport interface ToolManagerConfig {\n  /**\n   * Hard timeout in milliseconds for any single tool execution.\n   * Acts as a safety net: if a tool's own timeout mechanism fails\n   * (e.g. child process doesn't exit), this will force-resolve with an error.\n   * Default: 0 (disabled - relies on tool's own timeout)\n   */\n  toolExecutionTimeout?: number;\n}\n\nexport class ToolManager extends EventEmitter implements IToolExecutor, IDisposable {\n  private registry: Map<string, ToolRegistration> = new Map();\n  private namespaceIndex: Map<string, Set<string>> = new Map();\n  private circuitBreakers: Map<string, CircuitBreaker> = new Map();\n  private toolLogger: FrameworkLogger;\n  private _isDestroyed = false;\n  private pipeline: ToolExecutionPipeline;\n\n  /** Optional tool context for execution (set by agent before runs) */\n  private _toolContext: ToolContext | undefined;\n\n  /** Hard timeout for tool execution (0 = disabled) */\n  private _toolExecutionTimeout: number;\n\n  constructor(config?: ToolManagerConfig) {\n    super();\n    this._toolExecutionTimeout = config?.toolExecutionTimeout ?? 0;\n    // Initialize default namespace\n    this.namespaceIndex.set('default', new Set());\n    this.toolLogger = logger.child({ component: 'ToolManager' });\n    // Initialize execution pipeline for plugin support\n    this.pipeline = new ToolExecutionPipeline();\n    // Register built-in result normalizer to guarantee valid tool results\n    // Runs LAST in afterExecute (priority 0) to catch undefined/null returns\n    this.pipeline.use(new ResultNormalizerPlugin());\n  }\n\n  /**\n   * Get or set the hard tool execution timeout in milliseconds.\n   * 0 = disabled (relies on tool's own timeout).\n   */\n  get toolExecutionTimeout(): number {\n    return this._toolExecutionTimeout;\n  }\n\n  set toolExecutionTimeout(value: number) {\n    this._toolExecutionTimeout = Math.max(0, value);\n  }\n\n  /**\n   * Access the execution pipeline for plugin management.\n   *\n   * Use this to register plugins that intercept and extend tool execution.\n   *\n   * @example\n   * ```typescript\n   * // Add logging plugin\n   * toolManager.executionPipeline.use(new LoggingPlugin());\n   *\n   * // Add custom plugin\n   * toolManager.executionPipeline.use({\n   *   name: 'my-plugin',\n   *   async afterExecute(ctx, result) {\n   *     console.log(`${ctx.toolName} returned:`, result);\n   *     return result;\n   *   },\n   * });\n   * ```\n   */\n  get executionPipeline(): IToolExecutionPipeline {\n    return this.pipeline;\n  }\n\n  /**\n   * Returns true if destroy() has been called.\n   */\n  get isDestroyed(): boolean {\n    return this._isDestroyed;\n  }\n\n  /**\n   * Releases all resources held by this ToolManager.\n   * Cleans up circuit breaker listeners and removes all event listeners.\n   * Safe to call multiple times (idempotent).\n   */\n  destroy(): void {\n    if (this._isDestroyed) {\n      return;\n    }\n\n    this._isDestroyed = true;\n\n    // Clean up circuit breakers and their event listeners\n    for (const breaker of this.circuitBreakers.values()) {\n      breaker.removeAllListeners();\n    }\n    this.circuitBreakers.clear();\n\n    // Clear registry and namespaces\n    this.registry.clear();\n    this.namespaceIndex.clear();\n\n    // Remove all event listeners from this ToolManager\n    this.removeAllListeners();\n  }\n\n  /**\n   * Set tool context for execution (called by agent before runs)\n   */\n  setToolContext(context: ToolContext | undefined): void {\n    this._toolContext = context;\n  }\n\n  /**\n   * Get current tool context\n   */\n  getToolContext(): ToolContext | undefined {\n    return this._toolContext;\n  }\n\n  // ==========================================================================\n  // Registration\n  // ==========================================================================\n\n  /**\n   * Register a tool with optional configuration\n   */\n  register(tool: ToolFunction, options: ToolOptions = {}): void {\n    const name = this.getToolName(tool);\n\n    if (this.registry.has(name)) {\n      // Update existing registration\n      const existing = this.registry.get(name)!;\n      existing.tool = tool;\n      if (options.enabled !== undefined) existing.enabled = options.enabled;\n      if (options.namespace !== undefined) {\n        this.moveToNamespace(name, existing.namespace, options.namespace);\n        existing.namespace = options.namespace;\n      }\n      if (options.priority !== undefined) existing.priority = options.priority;\n      if (options.conditions !== undefined) existing.conditions = options.conditions;\n      if (options.permission !== undefined) existing.permission = options.permission;\n      if (options.tags !== undefined) existing.tags = options.tags;\n      if (options.category !== undefined) existing.category = options.category;\n      if (options.source !== undefined) existing.source = options.source;\n      return;\n    }\n\n    const namespace = options.namespace ?? 'default';\n\n    // Merge permission config: options.permission > tool.permission > undefined\n    const effectivePermission = options.permission ?? tool.permission;\n\n    const registration: ToolRegistration = {\n      tool,\n      enabled: options.enabled ?? true,\n      namespace,\n      priority: options.priority ?? 0,\n      conditions: options.conditions ?? [],\n      metadata: {\n        registeredAt: new Date(),\n        usageCount: 0,\n        totalExecutionMs: 0,\n        avgExecutionMs: 0,\n        successCount: 0,\n        failureCount: 0,\n      },\n      permission: effectivePermission,\n      tags: options.tags,\n      category: options.category,\n      source: options.source,\n    };\n\n    this.registry.set(name, registration);\n    this.addToNamespace(name, namespace);\n\n    this.emit('tool:registered', { name, namespace, enabled: registration.enabled });\n  }\n\n  /**\n   * Register multiple tools at once\n   */\n  registerMany(tools: ToolFunction[], options: Omit<ToolOptions, 'conditions'> = {}): void {\n    for (const tool of tools) {\n      this.register(tool, options);\n    }\n  }\n\n  /**\n   * Register tools produced by a specific connector.\n   * Sets `source: 'connector:<connectorName>'` (or `'connector:<name>:<accountId>'` for identity-bound tools)\n   * so agent-level filtering can restrict which connector tools are visible to a given agent.\n   */\n  registerConnectorTools(connectorName: string, tools: ToolFunction[], options: Omit<ToolOptions, 'source'> & { accountId?: string } = {}): void {\n    const { accountId, ...toolOptions } = options;\n    const source = accountId\n      ? `connector:${connectorName}:${accountId}`\n      : `connector:${connectorName}`;\n    for (const tool of tools) {\n      this.register(tool, { ...toolOptions, source });\n    }\n  }\n\n  /**\n   * Unregister a tool by name\n   */\n  unregister(name: string): boolean {\n    const registration = this.registry.get(name);\n    if (!registration) return false;\n\n    this.removeFromNamespace(name, registration.namespace);\n    this.registry.delete(name);\n\n    // Clean up circuit breaker and its listeners\n    const breaker = this.circuitBreakers.get(name);\n    if (breaker) {\n      breaker.removeAllListeners();\n      this.circuitBreakers.delete(name);\n    }\n\n    this.emit('tool:unregistered', { name });\n    return true;\n  }\n\n  /**\n   * Clear all tools and their circuit breakers.\n   * Does NOT remove event listeners from this ToolManager (use destroy() for full cleanup).\n   */\n  clear(): void {\n    this.registry.clear();\n    this.namespaceIndex.clear();\n    this.namespaceIndex.set('default', new Set());\n\n    // Clean up circuit breaker listeners before clearing\n    for (const breaker of this.circuitBreakers.values()) {\n      breaker.removeAllListeners();\n    }\n    this.circuitBreakers.clear();\n  }\n\n  // ==========================================================================\n  // Enable/Disable\n  // ==========================================================================\n\n  /**\n   * Enable a tool by name\n   */\n  enable(name: string): boolean {\n    const registration = this.registry.get(name);\n    if (!registration) return false;\n\n    if (!registration.enabled) {\n      registration.enabled = true;\n      this.emit('tool:enabled', { name });\n    }\n    return true;\n  }\n\n  /**\n   * Disable a tool by name (keeps it registered but inactive)\n   */\n  disable(name: string): boolean {\n    const registration = this.registry.get(name);\n    if (!registration) return false;\n\n    if (registration.enabled) {\n      registration.enabled = false;\n      this.emit('tool:disabled', { name });\n    }\n    return true;\n  }\n\n  /**\n   * Toggle a tool's enabled state\n   */\n  toggle(name: string): boolean {\n    const registration = this.registry.get(name);\n    if (!registration) return false;\n\n    registration.enabled = !registration.enabled;\n    this.emit(registration.enabled ? 'tool:enabled' : 'tool:disabled', { name });\n    return registration.enabled;\n  }\n\n  /**\n   * Check if a tool is enabled\n   */\n  isEnabled(name: string): boolean {\n    const registration = this.registry.get(name);\n    return registration?.enabled ?? false;\n  }\n\n  /**\n   * Set enabled state for multiple tools\n   */\n  setEnabled(names: string[], enabled: boolean): void {\n    for (const name of names) {\n      if (enabled) {\n        this.enable(name);\n      } else {\n        this.disable(name);\n      }\n    }\n  }\n\n  // ==========================================================================\n  // Namespaces\n  // ==========================================================================\n\n  /**\n   * Set the namespace for a tool\n   */\n  setNamespace(toolName: string, namespace: string): boolean {\n    const registration = this.registry.get(toolName);\n    if (!registration) return false;\n\n    const oldNamespace = registration.namespace;\n    if (oldNamespace === namespace) return true;\n\n    this.moveToNamespace(toolName, oldNamespace, namespace);\n    registration.namespace = namespace;\n    return true;\n  }\n\n  /**\n   * Enable all tools in a namespace\n   */\n  enableNamespace(namespace: string): void {\n    const tools = this.namespaceIndex.get(namespace);\n    if (!tools) return;\n\n    for (const name of tools) {\n      this.enable(name);\n    }\n    this.emit('namespace:enabled', { namespace });\n  }\n\n  /**\n   * Disable all tools in a namespace\n   */\n  disableNamespace(namespace: string): void {\n    const tools = this.namespaceIndex.get(namespace);\n    if (!tools) return;\n\n    for (const name of tools) {\n      this.disable(name);\n    }\n    this.emit('namespace:disabled', { namespace });\n  }\n\n  /**\n   * Get all namespace names\n   */\n  getNamespaces(): string[] {\n    return Array.from(this.namespaceIndex.keys());\n  }\n\n  /**\n   * Create a namespace with tools\n   */\n  createNamespace(namespace: string, tools: ToolFunction[], options: Omit<ToolOptions, 'namespace'> = {}): void {\n    for (const tool of tools) {\n      this.register(tool, { ...options, namespace });\n    }\n  }\n\n  // ==========================================================================\n  // Priority\n  // ==========================================================================\n\n  /**\n   * Set priority for a tool\n   */\n  setPriority(name: string, priority: number): boolean {\n    const registration = this.registry.get(name);\n    if (!registration) return false;\n\n    registration.priority = priority;\n    return true;\n  }\n\n  /**\n   * Get priority for a tool\n   */\n  getPriority(name: string): number | undefined {\n    return this.registry.get(name)?.priority;\n  }\n\n  /**\n   * Get permission config for a tool\n   */\n  getPermission(name: string): ToolPermissionConfig | undefined {\n    return this.registry.get(name)?.permission;\n  }\n\n  /**\n   * Set permission config for a tool\n   */\n  setPermission(name: string, permission: ToolPermissionConfig): boolean {\n    const registration = this.registry.get(name);\n    if (!registration) return false;\n\n    registration.permission = permission;\n    return true;\n  }\n\n  // ==========================================================================\n  // Query\n  // ==========================================================================\n\n  /**\n   * Get a tool by name\n   */\n  get(name: string): ToolFunction | undefined {\n    return this.registry.get(name)?.tool;\n  }\n\n  /**\n   * Check if a tool exists\n   */\n  has(name: string): boolean {\n    return this.registry.has(name);\n  }\n\n  /**\n   * Get all enabled tools (sorted by priority)\n   */\n  getEnabled(): ToolFunction[] {\n    return this.getSortedByPriority()\n      .filter((reg) => reg.enabled)\n      .map((reg) => reg.tool);\n  }\n\n  /**\n   * Get all enabled registrations (sorted by priority).\n   * Includes full registration metadata (source, namespace, etc.)\n   * for use in connector-aware filtering.\n   */\n  getEnabledRegistrations(): ToolRegistration[] {\n    return this.getSortedByPriority().filter((reg) => reg.enabled);\n  }\n\n  /**\n   * Get all tools (enabled and disabled)\n   */\n  getAll(): ToolFunction[] {\n    return Array.from(this.registry.values()).map((reg) => reg.tool);\n  }\n\n  /**\n   * Get tools by namespace\n   */\n  getByNamespace(namespace: string): ToolFunction[] {\n    const toolNames = this.namespaceIndex.get(namespace);\n    if (!toolNames) return [];\n\n    return Array.from(toolNames)\n      .map((name) => this.registry.get(name)!)\n      .filter((reg) => reg.enabled)\n      .sort((a, b) => b.priority - a.priority)\n      .map((reg) => reg.tool);\n  }\n\n  /**\n   * Get all registered tool names in a category.\n   * Used by ToolCatalogPlugin for bulk enable/disable.\n   */\n  getByCategory(category: string): string[] {\n    const names: string[] = [];\n    for (const [name, reg] of this.registry) {\n      if (reg.category === category) names.push(name);\n    }\n    return names;\n  }\n\n  /**\n   * Get tool registration info\n   */\n  getRegistration(name: string): ToolRegistration | undefined {\n    return this.registry.get(name);\n  }\n\n  /**\n   * List all tool names\n   */\n  list(): string[] {\n    return Array.from(this.registry.keys());\n  }\n\n  /**\n   * List enabled tool names\n   */\n  listEnabled(): string[] {\n    return Array.from(this.registry.entries())\n      .filter(([_, reg]) => reg.enabled)\n      .map(([name]) => name);\n  }\n\n  /**\n   * Get count of registered tools\n   */\n  get size(): number {\n    return this.registry.size;\n  }\n\n  // ==========================================================================\n  // Selection\n  // ==========================================================================\n\n  /**\n   * Select tools based on context (uses conditions and smart filtering)\n   */\n  selectForContext(context: ToolSelectionContext): ToolFunction[] {\n    const sorted = this.getSortedByPriority();\n    const selected: ToolFunction[] = [];\n\n    for (const reg of sorted) {\n      // Skip disabled tools\n      if (!reg.enabled) continue;\n\n      // Check conditions\n      if (reg.conditions.length > 0) {\n        const allConditionsMet = reg.conditions.every((cond) => cond.predicate(context));\n        if (!allConditionsMet) continue;\n      }\n\n      // Skip recently used if avoiding repetition\n      if (context.recentTools?.includes(this.getToolName(reg.tool))) {\n        continue;\n      }\n\n      selected.push(reg.tool);\n    }\n\n    // Apply token budget if specified\n    if (context.tokenBudget !== undefined) {\n      return this.filterByTokenBudget(selected, context.tokenBudget);\n    }\n\n    return selected;\n  }\n\n  /**\n   * Select tools by matching capability description\n   */\n  selectByCapability(description: string): ToolFunction[] {\n    const lowerDesc = description.toLowerCase();\n    const keywords = lowerDesc.split(/\\s+/);\n\n    return this.getEnabled().filter((tool) => {\n      const toolDesc = (tool.definition.function.description ?? '').toLowerCase();\n      const toolName = tool.definition.function.name.toLowerCase();\n\n      // Match if any keyword appears in tool name or description\n      return keywords.some((kw) => toolDesc.includes(kw) || toolName.includes(kw));\n    });\n  }\n\n  /**\n   * Filter tools to fit within a token budget\n   */\n  selectWithinBudget(budget: number): ToolFunction[] {\n    return this.filterByTokenBudget(this.getEnabled(), budget);\n  }\n\n  // ==========================================================================\n  // Execution Tracking\n  // ==========================================================================\n\n  /**\n   * Record tool execution (called by agent/loop)\n   */\n  recordExecution(\n    name: string,\n    executionMs: number,\n    success: boolean\n  ): void {\n    const registration = this.registry.get(name);\n    if (!registration) return;\n\n    const meta = registration.metadata;\n    meta.usageCount++;\n    meta.lastUsed = new Date();\n    meta.totalExecutionMs += executionMs;\n    meta.avgExecutionMs = meta.totalExecutionMs / meta.usageCount;\n\n    if (success) {\n      meta.successCount++;\n    } else {\n      meta.failureCount++;\n    }\n\n    this.emit('tool:executed', {\n      name,\n      executionMs,\n      success,\n      totalUsage: meta.usageCount,\n    });\n  }\n\n  /**\n   * Summarize tool result for logging (handles various result types)\n   */\n  private summarizeResult(result: unknown): Record<string, unknown> {\n    if (result === null || result === undefined) {\n      return { type: 'null' };\n    }\n\n    if (typeof result !== 'object') {\n      return { type: typeof result, value: String(result).slice(0, 100) };\n    }\n\n    const obj = result as Record<string, unknown>;\n\n    // Handle common result patterns\n    if ('success' in obj) {\n      const summary: Record<string, unknown> = {\n        success: obj.success,\n      };\n      if ('error' in obj) summary.error = obj.error;\n      if ('count' in obj) summary.count = obj.count;\n      if ('results' in obj && Array.isArray(obj.results)) {\n        summary.resultCount = obj.results.length;\n      }\n      if ('provider' in obj) summary.provider = obj.provider;\n      return summary;\n    }\n\n    // Handle array results\n    if (Array.isArray(result)) {\n      return { type: 'array', length: result.length };\n    }\n\n    // Generic object summary\n    const keys = Object.keys(obj);\n    return {\n      type: 'object',\n      keys: keys.slice(0, 10),\n      keyCount: keys.length,\n    };\n  }\n\n  // ==========================================================================\n  // Statistics\n  // ==========================================================================\n\n  /**\n   * Get comprehensive statistics\n   */\n  getStats(): ToolManagerStats {\n    const registrations = Array.from(this.registry.values());\n    const enabledCount = registrations.filter((r) => r.enabled).length;\n\n    const toolsByNamespace: Record<string, number> = {};\n    for (const [ns, tools] of this.namespaceIndex) {\n      toolsByNamespace[ns] = tools.size;\n    }\n\n    const mostUsed = registrations\n      .filter((r) => r.metadata.usageCount > 0)\n      .sort((a, b) => b.metadata.usageCount - a.metadata.usageCount)\n      .slice(0, 10)\n      .map((r) => ({\n        name: this.getToolName(r.tool),\n        count: r.metadata.usageCount,\n      }));\n\n    const totalExecutions = registrations.reduce((sum, r) => sum + r.metadata.usageCount, 0);\n\n    return {\n      totalTools: this.registry.size,\n      enabledTools: enabledCount,\n      disabledTools: this.registry.size - enabledCount,\n      namespaces: this.getNamespaces(),\n      toolsByNamespace,\n      mostUsed,\n      totalExecutions,\n    };\n  }\n\n  // ==========================================================================\n  // Execution (IToolExecutor implementation)\n  // ==========================================================================\n\n  /**\n   * Execute a tool function with circuit breaker protection and plugin pipeline.\n   * Implements IToolExecutor interface.\n   *\n   * Execution flow:\n   * 1. Validate tool exists and is enabled\n   * 2. Check circuit breaker state\n   * 3. Run through plugin pipeline (beforeExecute -> execute -> afterExecute)\n   * 4. Update metrics and circuit breaker state\n   *\n   * Simple execution - no caching, no parent context.\n   * Context must be set via setToolContext() before calling.\n   */\n  async execute(toolName: string, args: any): Promise<any> {\n    const registration = this.registry.get(toolName);\n    if (!registration) {\n      throw new ToolNotFoundError(toolName);\n    }\n\n    // Check if tool is enabled\n    if (!registration.enabled) {\n      throw new ToolExecutionError(toolName, 'Tool is disabled');\n    }\n\n    // Connector-scoped safety net: block execution if the connector is not in the agent's allowlist\n    if (registration.source?.startsWith('connector:')) {\n      const connName = registration.source.slice('connector:'.length);\n      const registry = this._toolContext?.connectorRegistry;\n      if (registry && !registry.has(connName)) {\n        throw new ToolExecutionError(toolName, `Connector '${connName}' is not available to this agent`);\n      }\n    }\n\n    // Get or create circuit breaker for this tool\n    const breaker = this.getOrCreateCircuitBreaker(toolName, registration);\n\n    this.toolLogger.debug({ toolName, args }, 'Tool execution started');\n\n    const startTime = Date.now();\n    metrics.increment('tool.executed', 1, { tool: toolName });\n\n    try {\n      // Build the core execution promise (circuit breaker + pipeline)\n      const executionPromise = breaker.execute(async () => {\n        // Create a wrapper tool that includes the tool context\n        // This allows the pipeline to execute the tool with proper context\n        const toolWithContext: ToolFunction = {\n          ...registration.tool,\n          execute: async (pipelineArgs: any) => {\n            return await registration.tool.execute(pipelineArgs, this._toolContext);\n          },\n        };\n\n        // Execute through the plugin pipeline\n        return await this.pipeline.execute(toolWithContext, args);\n      });\n\n      // Wrap with hard timeout safety net if configured\n      const result = this._toolExecutionTimeout > 0\n        ? await this.withHardTimeout(executionPromise, toolName, this._toolExecutionTimeout)\n        : await executionPromise;\n\n      const duration = Date.now() - startTime;\n\n      // Update metadata\n      this.recordExecution(toolName, duration, true);\n\n      // Log result summary (truncated for large results)\n      const resultSummary = this.summarizeResult(result);\n      this.toolLogger.debug({\n        toolName,\n        duration,\n        resultSummary,\n      }, 'Tool execution completed');\n\n      metrics.timing('tool.duration', duration, { tool: toolName });\n      metrics.increment('tool.success', 1, { tool: toolName });\n\n      return result;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n\n      // Update metadata\n      this.recordExecution(toolName, duration, false);\n\n      this.toolLogger.error({\n        toolName,\n        error: (error as Error).message,\n        duration,\n      }, 'Tool execution failed');\n\n      metrics.increment('tool.failed', 1, {\n        tool: toolName,\n        error: (error as Error).name,\n      });\n\n      throw new ToolExecutionError(\n        toolName,\n        (error as Error).message,\n        error as Error\n      );\n    }\n  }\n\n  /**\n   * Check if tool is available (IToolExecutor interface)\n   */\n  hasToolFunction(toolName: string): boolean {\n    return this.registry.has(toolName);\n  }\n\n  /**\n   * Get tool definition (IToolExecutor interface)\n   */\n  getToolDefinition(toolName: string): Tool | undefined {\n    const registration = this.registry.get(toolName);\n    return registration?.tool.definition;\n  }\n\n  /**\n   * Register a tool (IToolExecutor interface - delegates to register())\n   */\n  registerTool(tool: ToolFunction): void {\n    this.register(tool);\n  }\n\n  /**\n   * Unregister a tool (IToolExecutor interface - delegates to unregister())\n   */\n  unregisterTool(toolName: string): void {\n    this.unregister(toolName);\n  }\n\n  /**\n   * List all registered tool names (IToolExecutor interface - delegates to list())\n   */\n  listTools(): string[] {\n    return this.list();\n  }\n\n  // ==========================================================================\n  // Hard Timeout\n  // ==========================================================================\n\n  /**\n   * Wrap a promise with a hard timeout safety net.\n   * If the promise doesn't resolve within the timeout, throws ToolExecutionError.\n   */\n  private async withHardTimeout<T>(promise: Promise<T>, toolName: string, timeoutMs: number): Promise<T> {\n    let timeoutId: ReturnType<typeof setTimeout>;\n    const timeoutPromise = new Promise<never>((_, reject) => {\n      timeoutId = setTimeout(() => {\n        reject(new ToolExecutionError(\n          toolName,\n          `Tool execution hard timeout after ${timeoutMs}ms (safety net - tool's own timeout may have failed)`\n        ));\n      }, timeoutMs);\n    });\n\n    try {\n      return await Promise.race([promise, timeoutPromise]);\n    } finally {\n      clearTimeout(timeoutId!);\n    }\n  }\n\n  // ==========================================================================\n  // Circuit Breaker Management\n  // ==========================================================================\n\n  /**\n   * Get or create circuit breaker for a tool\n   */\n  private getOrCreateCircuitBreaker(toolName: string, registration: ToolRegistration): CircuitBreaker {\n    let breaker = this.circuitBreakers.get(toolName);\n\n    if (!breaker) {\n      // Use tool's config or defaults\n      const config = registration.circuitBreakerConfig || {\n        failureThreshold: 3,\n        successThreshold: 2,\n        resetTimeoutMs: 60000, // 1 minute\n        windowMs: 300000, // 5 minutes\n      };\n\n      breaker = new CircuitBreaker(`tool:${toolName}`, config);\n\n      // Forward circuit breaker events to logger and metrics\n      breaker.on('opened', (data) => {\n        this.toolLogger.warn(data, `Circuit breaker opened for tool: ${toolName}`);\n        metrics.increment('circuit_breaker.opened', 1, {\n          breaker: data.name,\n          tool: toolName,\n        });\n      });\n\n      breaker.on('closed', (data) => {\n        this.toolLogger.info(data, `Circuit breaker closed for tool: ${toolName}`);\n        metrics.increment('circuit_breaker.closed', 1, {\n          breaker: data.name,\n          tool: toolName,\n        });\n      });\n\n      this.circuitBreakers.set(toolName, breaker);\n    }\n\n    return breaker;\n  }\n\n  /**\n   * Get circuit breaker states for all tools\n   */\n  getCircuitBreakerStates(): Map<string, CircuitState> {\n    const states = new Map<string, CircuitState>();\n    for (const [toolName, breaker] of this.circuitBreakers.entries()) {\n      states.set(toolName, breaker.getState());\n    }\n    return states;\n  }\n\n  /**\n   * Get circuit breaker metrics for a specific tool\n   */\n  getToolCircuitBreakerMetrics(toolName: string) {\n    const breaker = this.circuitBreakers.get(toolName);\n    return breaker?.getMetrics();\n  }\n\n  /**\n   * Manually reset a tool's circuit breaker\n   */\n  resetToolCircuitBreaker(toolName: string): void {\n    const breaker = this.circuitBreakers.get(toolName);\n    if (breaker) {\n      breaker.reset();\n      this.toolLogger.info({ toolName }, 'Tool circuit breaker manually reset');\n    }\n  }\n\n  /**\n   * Configure circuit breaker for a tool\n   */\n  setCircuitBreakerConfig(toolName: string, config: CircuitBreakerConfig): boolean {\n    const registration = this.registry.get(toolName);\n    if (!registration) return false;\n\n    registration.circuitBreakerConfig = config;\n\n    // If breaker already exists, clean up listeners and remove it\n    const existingBreaker = this.circuitBreakers.get(toolName);\n    if (existingBreaker) {\n      existingBreaker.removeAllListeners();\n      this.circuitBreakers.delete(toolName);\n      // Will be recreated on next execution with new config\n    }\n\n    return true;\n  }\n\n  // ==========================================================================\n  // Persistence\n  // ==========================================================================\n\n  /**\n   * Get serializable state (for session persistence)\n   */\n  getState(): SerializedToolState {\n    const enabled: Record<string, boolean> = {};\n    const namespaces: Record<string, string> = {};\n    const priorities: Record<string, number> = {};\n    const permissions: Record<string, ToolPermissionConfig> = {};\n    const tags: Record<string, string[]> = {};\n    const categories: Record<string, string> = {};\n    const sources: Record<string, ToolSource> = {};\n\n    for (const [name, reg] of this.registry) {\n      enabled[name] = reg.enabled;\n      namespaces[name] = reg.namespace;\n      priorities[name] = reg.priority;\n      if (reg.permission) {\n        permissions[name] = reg.permission;\n      }\n      if (reg.tags) {\n        tags[name] = reg.tags;\n      }\n      if (reg.category) {\n        categories[name] = reg.category;\n      }\n      if (reg.source) {\n        sources[name] = reg.source;\n      }\n    }\n\n    return { enabled, namespaces, priorities, permissions, tags, categories, sources };\n  }\n\n  /**\n   * Load state (restores enabled/disabled, namespaces, priorities, permissions)\n   * Note: Tools must be re-registered separately (they contain functions)\n   */\n  loadState(state: SerializedToolState): void {\n    for (const [name, isEnabled] of Object.entries(state.enabled)) {\n      const reg = this.registry.get(name);\n      if (reg) {\n        reg.enabled = isEnabled;\n      }\n    }\n\n    for (const [name, namespace] of Object.entries(state.namespaces)) {\n      this.setNamespace(name, namespace);\n    }\n\n    for (const [name, priority] of Object.entries(state.priorities)) {\n      this.setPriority(name, priority);\n    }\n\n    // Restore permissions if present\n    if (state.permissions) {\n      for (const [name, permission] of Object.entries(state.permissions)) {\n        this.setPermission(name, permission);\n      }\n    }\n\n    // Restore tags if present\n    if (state.tags) {\n      for (const [name, toolTags] of Object.entries(state.tags)) {\n        const reg = this.registry.get(name);\n        if (reg) reg.tags = toolTags;\n      }\n    }\n\n    // Restore categories if present\n    if (state.categories) {\n      for (const [name, category] of Object.entries(state.categories)) {\n        const reg = this.registry.get(name);\n        if (reg) reg.category = category;\n      }\n    }\n\n    // Restore sources if present\n    if (state.sources) {\n      for (const [name, source] of Object.entries(state.sources)) {\n        const reg = this.registry.get(name);\n        if (reg) reg.source = source;\n      }\n    }\n  }\n\n  // ==========================================================================\n  // Private Helpers\n  // ==========================================================================\n\n  private getToolName(tool: ToolFunction): string {\n    return tool.definition.function.name;\n  }\n\n  private getSortedByPriority(): ToolRegistration[] {\n    return Array.from(this.registry.values()).sort((a, b) => b.priority - a.priority);\n  }\n\n  private addToNamespace(toolName: string, namespace: string): void {\n    if (!this.namespaceIndex.has(namespace)) {\n      this.namespaceIndex.set(namespace, new Set());\n    }\n    this.namespaceIndex.get(namespace)!.add(toolName);\n  }\n\n  private removeFromNamespace(toolName: string, namespace: string): void {\n    this.namespaceIndex.get(namespace)?.delete(toolName);\n  }\n\n  private moveToNamespace(toolName: string, oldNamespace: string, newNamespace: string): void {\n    this.removeFromNamespace(toolName, oldNamespace);\n    this.addToNamespace(toolName, newNamespace);\n  }\n\n  private filterByTokenBudget(tools: ToolFunction[], budget: number): ToolFunction[] {\n    const result: ToolFunction[] = [];\n    let usedTokens = 0;\n\n    for (const tool of tools) {\n      const toolTokens = this.estimateToolTokens(tool);\n      if (usedTokens + toolTokens <= budget) {\n        result.push(tool);\n        usedTokens += toolTokens;\n      }\n    }\n\n    return result;\n  }\n\n  private estimateToolTokens(tool: ToolFunction): number {\n    // Rough estimation: ~4 chars per token\n    const def = tool.definition.function;\n    const nameTokens = Math.ceil((def.name?.length ?? 0) / 4);\n    const descTokens = Math.ceil((def.description?.length ?? 0) / 4);\n    const paramTokens = def.parameters ? Math.ceil(JSON.stringify(def.parameters).length / 4) : 0;\n\n    return nameTokens + descTokens + paramTokens + 20; // +20 for structure overhead\n  }\n}\n","/**\n * Custom error classes for the AI library\n */\n\nexport class AIError extends Error {\n  constructor(\n    message: string,\n    public readonly code: string,\n    public readonly statusCode?: number,\n    public readonly originalError?: Error\n  ) {\n    super(message);\n    this.name = 'AIError';\n    Object.setPrototypeOf(this, AIError.prototype);\n  }\n}\n\nexport class ProviderNotFoundError extends AIError {\n  constructor(providerName: string) {\n    super(\n      `Provider '${providerName}' not found. Did you configure it in OneRingAI constructor?`,\n      'PROVIDER_NOT_FOUND',\n      404\n    );\n    this.name = 'ProviderNotFoundError';\n    Object.setPrototypeOf(this, ProviderNotFoundError.prototype);\n  }\n}\n\nexport class ProviderAuthError extends AIError {\n  constructor(providerName: string, message: string = 'Authentication failed') {\n    super(\n      `${providerName}: ${message}`,\n      'PROVIDER_AUTH_ERROR',\n      401\n    );\n    this.name = 'ProviderAuthError';\n    Object.setPrototypeOf(this, ProviderAuthError.prototype);\n  }\n}\n\nexport class ProviderRateLimitError extends AIError {\n  constructor(\n    providerName: string,\n    public readonly retryAfter?: number\n  ) {\n    super(\n      `${providerName}: Rate limit exceeded${retryAfter ? `. Retry after ${retryAfter}ms` : ''}`,\n      'PROVIDER_RATE_LIMIT',\n      429\n    );\n    this.name = 'ProviderRateLimitError';\n    Object.setPrototypeOf(this, ProviderRateLimitError.prototype);\n  }\n}\n\nexport class ProviderContextLengthError extends AIError {\n  constructor(\n    providerName: string,\n    public readonly maxTokens: number,\n    public readonly requestedTokens?: number\n  ) {\n    super(\n      `${providerName}: Context length exceeded. Max: ${maxTokens}${requestedTokens ? `, Requested: ${requestedTokens}` : ''}`,\n      'PROVIDER_CONTEXT_LENGTH_EXCEEDED',\n      413\n    );\n    this.name = 'ProviderContextLengthError';\n    Object.setPrototypeOf(this, ProviderContextLengthError.prototype);\n  }\n}\n\nexport class ToolExecutionError extends AIError {\n  constructor(\n    toolName: string,\n    message: string,\n    public readonly originalError?: Error\n  ) {\n    super(\n      `Tool '${toolName}' execution failed: ${message}`,\n      'TOOL_EXECUTION_ERROR',\n      500,\n      originalError\n    );\n    this.name = 'ToolExecutionError';\n    Object.setPrototypeOf(this, ToolExecutionError.prototype);\n  }\n}\n\nexport class ToolTimeoutError extends AIError {\n  constructor(\n    toolName: string,\n    public readonly timeoutMs: number\n  ) {\n    super(\n      `Tool '${toolName}' execution timed out after ${timeoutMs}ms`,\n      'TOOL_TIMEOUT',\n      408\n    );\n    this.name = 'ToolTimeoutError';\n    Object.setPrototypeOf(this, ToolTimeoutError.prototype);\n  }\n}\n\nexport class ToolNotFoundError extends AIError {\n  constructor(toolName: string) {\n    super(\n      `Tool '${toolName}' not found. Did you register it with the agent?`,\n      'TOOL_NOT_FOUND',\n      404\n    );\n    this.name = 'ToolNotFoundError';\n    Object.setPrototypeOf(this, ToolNotFoundError.prototype);\n  }\n}\n\nexport class ModelNotSupportedError extends AIError {\n  constructor(providerName: string, model: string, capability: string) {\n    super(\n      `Model '${model}' from ${providerName} does not support ${capability}`,\n      'MODEL_NOT_SUPPORTED',\n      400\n    );\n    this.name = 'ModelNotSupportedError';\n    Object.setPrototypeOf(this, ModelNotSupportedError.prototype);\n  }\n}\n\nexport class InvalidConfigError extends AIError {\n  constructor(message: string) {\n    super(message, 'INVALID_CONFIG', 400);\n    this.name = 'InvalidConfigError';\n    Object.setPrototypeOf(this, InvalidConfigError.prototype);\n  }\n}\n\nexport class InvalidToolArgumentsError extends AIError {\n  constructor(\n    toolName: string,\n    public readonly rawArguments: string,\n    public readonly parseError?: Error\n  ) {\n    super(\n      `Invalid arguments for tool '${toolName}': ${parseError?.message || 'Failed to parse JSON'}`,\n      'INVALID_TOOL_ARGUMENTS',\n      400,\n      parseError\n    );\n    this.name = 'InvalidToolArgumentsError';\n    Object.setPrototypeOf(this, InvalidToolArgumentsError.prototype);\n  }\n}\n\nexport class ProviderError extends AIError {\n  constructor(\n    public readonly providerName: string,\n    message: string,\n    statusCode?: number,\n    originalError?: Error\n  ) {\n    super(\n      `${providerName}: ${message}`,\n      'PROVIDER_ERROR',\n      statusCode,\n      originalError\n    );\n    this.name = 'ProviderError';\n    Object.setPrototypeOf(this, ProviderError.prototype);\n  }\n}\n\n// ============ TaskAgent Errors ============\n\n/**\n * Error thrown when a dependency cycle is detected in a plan\n */\nexport class DependencyCycleError extends AIError {\n  constructor(\n    /** Task IDs forming the cycle (e.g., ['A', 'B', 'C', 'A']) */\n    public readonly cycle: string[],\n    /** Plan ID where the cycle was detected */\n    public readonly planId?: string\n  ) {\n    super(\n      `Dependency cycle detected: ${cycle.join(' -> ')}`,\n      'DEPENDENCY_CYCLE',\n      400\n    );\n    this.name = 'DependencyCycleError';\n    Object.setPrototypeOf(this, DependencyCycleError.prototype);\n  }\n}\n\n/**\n * Error thrown when a task execution times out\n */\nexport class TaskTimeoutError extends AIError {\n  constructor(\n    public readonly taskId: string,\n    public readonly taskName: string,\n    public readonly timeoutMs: number\n  ) {\n    super(\n      `Task '${taskName}' (${taskId}) timed out after ${timeoutMs}ms`,\n      'TASK_TIMEOUT',\n      408\n    );\n    this.name = 'TaskTimeoutError';\n    Object.setPrototypeOf(this, TaskTimeoutError.prototype);\n  }\n}\n\n/**\n * Error thrown when task completion validation fails\n */\nexport class TaskValidationError extends AIError {\n  constructor(\n    public readonly taskId: string,\n    public readonly taskName: string,\n    public readonly reason: string\n  ) {\n    super(\n      `Task '${taskName}' (${taskId}) validation failed: ${reason}`,\n      'TASK_VALIDATION_ERROR',\n      422\n    );\n    this.name = 'TaskValidationError';\n    Object.setPrototypeOf(this, TaskValidationError.prototype);\n  }\n}\n\n/**\n * Task failure info for parallel execution\n */\nexport interface TaskFailure {\n  taskId: string;\n  taskName: string;\n  error: Error;\n}\n\n/**\n * Error thrown when multiple tasks fail in parallel execution (fail-all mode)\n */\nexport class ParallelTasksError extends AIError {\n  constructor(\n    /** Array of task failures */\n    public readonly failures: TaskFailure[]\n  ) {\n    const names = failures.map((f) => f.taskName).join(', ');\n    super(\n      `Multiple tasks failed in parallel execution: ${names}`,\n      'PARALLEL_TASKS_ERROR',\n      500\n    );\n    this.name = 'ParallelTasksError';\n    Object.setPrototypeOf(this, ParallelTasksError.prototype);\n  }\n\n  /**\n   * Get all failure errors\n   */\n  getErrors(): Error[] {\n    return this.failures.map((f) => f.error);\n  }\n\n  /**\n   * Get failed task IDs\n   */\n  getFailedTaskIds(): string[] {\n    return this.failures.map((f) => f.taskId);\n  }\n}\n\n// ============ Document Reader Errors ============\n\n/**\n * Error thrown when document reading fails\n */\nexport class DocumentReadError extends AIError {\n  constructor(\n    public readonly source: string,\n    message: string,\n    originalError?: Error\n  ) {\n    super(\n      `Failed to read document '${source}': ${message}`,\n      'DOCUMENT_READ_ERROR',\n      500,\n      originalError\n    );\n    this.name = 'DocumentReadError';\n    Object.setPrototypeOf(this, DocumentReadError.prototype);\n  }\n}\n\n/**\n * Error thrown when a document format is not supported\n */\nexport class UnsupportedFormatError extends AIError {\n  constructor(\n    public readonly format: string,\n    public readonly family?: string\n  ) {\n    super(\n      `Unsupported document format: '${format}'${family ? ` (family: ${family})` : ''}`,\n      'UNSUPPORTED_FORMAT',\n      400\n    );\n    this.name = 'UnsupportedFormatError';\n    Object.setPrototypeOf(this, UnsupportedFormatError.prototype);\n  }\n}\n\n// ============ Context Management Errors ============\n\n/**\n * Detailed budget information for context overflow diagnosis\n */\nexport interface ContextOverflowBudget {\n  actualTokens: number;\n  maxTokens: number;\n  overageTokens: number;\n  breakdown: Record<string, number>;\n  degradationLog: string[];\n}\n\n/**\n * Error thrown when context cannot be reduced to fit within limits\n * after all graceful degradation levels have been exhausted.\n */\nexport class ContextOverflowError extends AIError {\n  constructor(\n    message: string,\n    /** Detailed budget information for debugging */\n    public readonly budget: ContextOverflowBudget\n  ) {\n    super(\n      `Context overflow: ${message}. Actual: ${budget.actualTokens}, Max: ${budget.maxTokens}, Overage: ${budget.overageTokens}`,\n      'CONTEXT_OVERFLOW',\n      413\n    );\n    this.name = 'ContextOverflowError';\n    Object.setPrototypeOf(this, ContextOverflowError.prototype);\n  }\n\n  /**\n   * Get a formatted summary of what was tried\n   */\n  getDegradationSummary(): string {\n    return this.budget.degradationLog.join('\\n');\n  }\n\n  /**\n   * Get the top token consumers\n   */\n  getTopConsumers(count = 5): Array<{ component: string; tokens: number }> {\n    return Object.entries(this.budget.breakdown)\n      .map(([component, tokens]) => ({ component, tokens }))\n      .sort((a, b) => b.tokens - a.tokens)\n      .slice(0, count);\n  }\n}\n","/**\n * ToolExecutionPipeline\n *\n * Orchestrates the execution of tools through a chain of plugins.\n * Each plugin can intercept and modify the execution at different phases:\n * - beforeExecute: Modify args, abort execution, or pass through\n * - afterExecute: Transform results\n * - onError: Handle or recover from errors\n *\n * @module tool-execution\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type {\n  IToolExecutionPlugin,\n  IToolExecutionPipeline,\n  PluginExecutionContext,\n  ToolExecutionPipelineOptions,\n} from './types.js';\n\n/**\n * Default plugin priority\n */\nconst DEFAULT_PRIORITY = 100;\n\n/**\n * Counter for generating simple execution IDs when crypto.randomUUID is not available\n */\nlet executionCounter = 0;\n\n/**\n * Generate a unique execution ID\n */\nfunction generateExecutionId(useRandomUUID: boolean): string {\n  if (useRandomUUID && typeof crypto !== 'undefined' && crypto.randomUUID) {\n    return crypto.randomUUID();\n  }\n  // Fallback: timestamp + counter\n  return `exec_${Date.now()}_${++executionCounter}`;\n}\n\n/**\n * Deep clone an object for creating mutable args copy.\n * Uses structuredClone if available, otherwise falls back to JSON parse/stringify.\n */\nfunction deepClone<T>(value: T): T {\n  if (value === null || value === undefined) {\n    return value;\n  }\n  if (typeof structuredClone === 'function') {\n    try {\n      return structuredClone(value);\n    } catch {\n      // Fall through to JSON approach for non-cloneable values\n    }\n  }\n  // Fallback for environments without structuredClone or for non-cloneable values\n  try {\n    return JSON.parse(JSON.stringify(value));\n  } catch {\n    // If JSON fails, return the original value\n    // This handles cases like functions or circular references\n    return value;\n  }\n}\n\n/**\n * Tool Execution Pipeline\n *\n * Manages a chain of plugins that can intercept and modify tool execution.\n *\n * @example\n * ```typescript\n * const pipeline = new ToolExecutionPipeline();\n *\n * // Add plugins\n * pipeline.use(new LoggingPlugin());\n * pipeline.use(new AnalyticsPlugin());\n *\n * // Execute tool\n * const result = await pipeline.execute(myTool, { arg: 'value' });\n * ```\n */\nexport class ToolExecutionPipeline implements IToolExecutionPipeline {\n  private plugins: Map<string, IToolExecutionPlugin> = new Map();\n  private sortedPlugins: IToolExecutionPlugin[] = [];\n  private useRandomUUID: boolean;\n\n  constructor(options: ToolExecutionPipelineOptions = {}) {\n    this.useRandomUUID = options.useRandomUUID ?? true;\n  }\n\n  /**\n   * Register a plugin with the pipeline.\n   *\n   * If a plugin with the same name is already registered, it will be\n   * unregistered first (calling its onUnregister hook) and replaced.\n   *\n   * @param plugin - Plugin to register\n   * @returns this for chaining\n   */\n  use(plugin: IToolExecutionPlugin): this {\n    if (this.plugins.has(plugin.name)) {\n      // Remove existing plugin first\n      this.remove(plugin.name);\n    }\n\n    this.plugins.set(plugin.name, plugin);\n    this.rebuildSortedList();\n\n    // Call onRegister hook if provided\n    plugin.onRegister?.(this);\n\n    return this;\n  }\n\n  /**\n   * Remove a plugin by name.\n   *\n   * @param pluginName - Name of the plugin to remove\n   * @returns true if the plugin was found and removed, false otherwise\n   */\n  remove(pluginName: string): boolean {\n    const plugin = this.plugins.get(pluginName);\n    if (!plugin) {\n      return false;\n    }\n\n    // Call onUnregister hook if provided\n    plugin.onUnregister?.();\n\n    this.plugins.delete(pluginName);\n    this.rebuildSortedList();\n\n    return true;\n  }\n\n  /**\n   * Check if a plugin is registered.\n   *\n   * @param pluginName - Name of the plugin to check\n   */\n  has(pluginName: string): boolean {\n    return this.plugins.has(pluginName);\n  }\n\n  /**\n   * Get a registered plugin by name.\n   *\n   * @param pluginName - Name of the plugin to get\n   */\n  get(pluginName: string): IToolExecutionPlugin | undefined {\n    return this.plugins.get(pluginName);\n  }\n\n  /**\n   * List all registered plugins, sorted by priority.\n   */\n  list(): IToolExecutionPlugin[] {\n    return [...this.sortedPlugins];\n  }\n\n  /**\n   * Execute a tool through the plugin pipeline.\n   *\n   * Execution phases:\n   * 1. beforeExecute hooks (in priority order, lowest first)\n   * 2. Tool execution (if not aborted)\n   * 3. afterExecute hooks (in reverse priority order for proper unwinding)\n   * 4. onError hooks if any phase fails\n   *\n   * @param tool - Tool function to execute\n   * @param args - Arguments for the tool\n   * @returns Result from tool execution (possibly transformed by plugins)\n   */\n  async execute(tool: ToolFunction, args: unknown): Promise<unknown> {\n    // Create execution context\n    const ctx: PluginExecutionContext = {\n      toolName: tool.definition.function.name,\n      args,\n      mutableArgs: deepClone(args),\n      metadata: new Map(),\n      startTime: Date.now(),\n      tool,\n      executionId: generateExecutionId(this.useRandomUUID),\n    };\n\n    try {\n      // Phase 1: beforeExecute hooks\n      for (const plugin of this.sortedPlugins) {\n        if (plugin.beforeExecute) {\n          const hookResult = await plugin.beforeExecute(ctx);\n\n          // Check for abort\n          if (hookResult && 'abort' in hookResult && hookResult.abort) {\n            return hookResult.result;\n          }\n\n          // Check for modified args\n          if (hookResult && 'modifiedArgs' in hookResult) {\n            ctx.mutableArgs = hookResult.modifiedArgs;\n          }\n        }\n      }\n\n      // Phase 2: Execute the tool\n      let result = await tool.execute(ctx.mutableArgs);\n\n      // Phase 3: afterExecute hooks (reverse order for proper unwinding)\n      const reversedPlugins = [...this.sortedPlugins].reverse();\n      for (const plugin of reversedPlugins) {\n        if (plugin.afterExecute) {\n          result = await plugin.afterExecute(ctx, result);\n        }\n      }\n\n      return result;\n    } catch (error) {\n      // Phase 4: onError hooks\n      const err = error instanceof Error ? error : new Error(String(error));\n\n      for (const plugin of this.sortedPlugins) {\n        if (plugin.onError) {\n          try {\n            const recovered = await plugin.onError(ctx, err);\n            // If plugin returns a value (not undefined), treat it as recovery\n            if (recovered !== undefined) {\n              return recovered;\n            }\n          } catch {\n            // Plugin's onError threw, continue to next plugin\n          }\n        }\n      }\n\n      // No plugin recovered, re-throw the original error\n      throw error;\n    }\n  }\n\n  /**\n   * Rebuild the sorted plugin list after registration changes.\n   */\n  private rebuildSortedList(): void {\n    this.sortedPlugins = [...this.plugins.values()].sort(\n      (a, b) => (a.priority ?? DEFAULT_PRIORITY) - (b.priority ?? DEFAULT_PRIORITY)\n    );\n  }\n}\n","/**\n * ResultNormalizerPlugin\n *\n * Guarantees every tool execution returns a valid, serializable result.\n * Converts undefined/null to error objects, wraps primitives optionally,\n * and recovers from exceptions.\n *\n * This plugin runs LAST in afterExecute (priority 0) to normalize after\n * all other plugins have processed the result.\n *\n * @module tool-execution\n */\n\nimport type {\n  IToolExecutionPlugin,\n  PluginExecutionContext,\n} from '../types.js';\n\n/**\n * Configuration options for ResultNormalizerPlugin\n */\nexport interface ResultNormalizerPluginOptions {\n  /**\n   * Whether to wrap primitive values in { success: true, result: value }.\n   * Default: false (primitives pass through as-is)\n   */\n  wrapPrimitives?: boolean;\n\n  /**\n   * Whether to add success: true to objects that don't have it.\n   * Default: false\n   */\n  addSuccessField?: boolean;\n}\n\n/**\n * Normalized error result returned when a tool returns undefined/null or throws.\n */\nexport interface NormalizedErrorResult {\n  success: false;\n  error: string;\n  errorType?: string;\n  toolName?: string;\n}\n\n/**\n * ResultNormalizerPlugin - Guarantees valid tool execution results.\n *\n * This is a built-in plugin that ensures every tool execution returns a valid,\n * serializable result. It prevents the \"No tool output found\" error that can\n * occur when tools return undefined/null or throw exceptions.\n *\n * @example\n * ```typescript\n * // Registered automatically by ToolManager\n * // To customize or remove:\n * toolManager.executionPipeline.remove('result-normalizer');\n *\n * // Or with custom options:\n * toolManager.executionPipeline.use(new ResultNormalizerPlugin({\n *   wrapPrimitives: true,\n *   addSuccessField: true,\n * }));\n * ```\n */\nexport class ResultNormalizerPlugin implements IToolExecutionPlugin {\n  readonly name = 'result-normalizer';\n  readonly priority = 0; // Run LAST in afterExecute (reverse order)\n\n  private options: Required<ResultNormalizerPluginOptions>;\n\n  constructor(options: ResultNormalizerPluginOptions = {}) {\n    this.options = {\n      wrapPrimitives: options.wrapPrimitives ?? false,\n      addSuccessField: options.addSuccessField ?? false,\n    };\n  }\n\n  /**\n   * Normalize result after all other plugins have processed it.\n   * Converts undefined/null to error objects, optionally wraps primitives.\n   */\n  async afterExecute(ctx: PluginExecutionContext, result: unknown): Promise<unknown> {\n    return this.normalize(result, ctx.toolName);\n  }\n\n  /**\n   * Convert exceptions to error result objects (recovery).\n   * This allows the tool call to return a valid result instead of throwing.\n   */\n  async onError(ctx: PluginExecutionContext, error: Error): Promise<NormalizedErrorResult> {\n    return {\n      success: false,\n      error: error.message,\n      errorType: error.name,\n      toolName: ctx.toolName,\n    };\n  }\n\n  /**\n   * Normalize a result to ensure it's valid and serializable.\n   */\n  private normalize(result: unknown, toolName: string): unknown {\n    // Case 1: undefined or null  error response\n    if (result === undefined || result === null) {\n      return {\n        success: false,\n        error: `Tool '${toolName}' returned no result`,\n      } satisfies NormalizedErrorResult;\n    }\n\n    // Case 2: Already a proper object with success field  pass through\n    if (typeof result === 'object' && 'success' in (result as object)) {\n      return result;\n    }\n\n    // Case 3: Primitive values\n    if (typeof result !== 'object') {\n      if (this.options.wrapPrimitives) {\n        return { success: true, result };\n      }\n      return result; // Pass through as-is\n    }\n\n    // Case 4: Object without success field\n    if (this.options.addSuccessField) {\n      return { success: true, ...(result as object) };\n    }\n    return result; // Pass through as-is\n  }\n}\n","/**\n * AgentContextNextGen - Clean, Simple Context Manager\n *\n * Design Principles:\n * 1. Single system message with ALL context (prompt, instructions, plugin contents)\n * 2. Clear separation: system message | conversation | current input\n * 3. Compaction happens ONCE, right before LLM call\n * 4. Each plugin manages its own token tracking\n * 5. Tool pairs (tool_use + tool_result) always removed together\n *\n * Context Structure:\n * ```\n * [Developer Message - All glued together]\n *   # System Prompt\n *   # Persistent Instructions (if plugin enabled)\n *   # Plugin Instructions (for enabled plugins)\n *   # In-Context Memory (if plugin enabled)\n *   # Working Memory Index (if plugin enabled)\n *\n * [Conversation History]\n *   ... messages including tool_use/tool_result pairs ...\n *\n * [Current Input]\n *   User message OR tool results (newest, never compacted)\n * ```\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { ToolManager } from '../ToolManager.js';\nimport { logger } from '../../infrastructure/observability/Logger.js';\nimport { getModelInfo } from '../../domain/entities/Model.js';\nimport type { InputItem, Message } from '../../domain/entities/Message.js';\nimport { MessageRole } from '../../domain/entities/Message.js';\nimport type { Content } from '../../domain/entities/Content.js';\nimport { ContentType } from '../../domain/entities/Content.js';\nimport type { ToolResult } from '../../domain/entities/Tool.js';\nimport type { OutputItem } from '../../domain/entities/Message.js';\nimport { simpleTokenEstimator } from './BasePluginNextGen.js';\n\nimport type {\n  AuthIdentity,\n  IContextPluginNextGen,\n  ITokenEstimator,\n  AgentContextNextGenConfig,\n  ContextFeatures,\n  ContextBudget,\n  PreparedContext,\n  OversizedInputResult,\n  SerializedContextState,\n  ContextEvents,\n  PluginConfigs,\n  BeforeCompactionCallback,\n  ICompactionStrategy,\n  CompactionContext,\n  ConsolidationResult,\n} from './types.js';\nimport type { ToolCategoryScope } from '../ToolCatalogRegistry.js';\nimport type {\n  IContextSnapshot,\n  IPluginSnapshot,\n  IToolSnapshot,\n  IViewContextData,\n  IViewContextComponent,\n} from './snapshot.js';\nimport { formatPluginDisplayName } from './snapshot.js';\nimport type { IContextStorage, StoredContextSession } from '../../domain/interfaces/IContextStorage.js';\nimport type { IConnectorRegistry } from '../../domain/interfaces/IConnectorRegistry.js';\nimport { Connector } from '../Connector.js';\n\n// Plugin imports for auto-initialization\nimport {\n  WorkingMemoryPluginNextGen,\n  InContextMemoryPluginNextGen,\n  PersistentInstructionsPluginNextGen,\n  UserInfoPluginNextGen,\n  ToolCatalogPluginNextGen,\n} from './plugins/index.js';\nimport { StorageRegistry } from '../StorageRegistry.js';\nimport type {\n  WorkingMemoryPluginConfig,\n  InContextMemoryConfig,\n  PersistentInstructionsConfig,\n  UserInfoPluginConfig,\n  ToolCatalogPluginConfig,\n} from './plugins/index.js';\n\n// Strategy imports\nimport { StrategyRegistry } from './strategies/index.js';\n\nimport {\n  DEFAULT_FEATURES,\n  DEFAULT_CONFIG,\n} from './types.js';\n\n// ============================================================================\n// AgentContextNextGen\n// ============================================================================\n\n/**\n * Next-generation context manager for AI agents.\n *\n * Usage:\n * ```typescript\n * const ctx = AgentContextNextGen.create({\n *   model: 'gpt-4',\n *   systemPrompt: 'You are a helpful assistant.',\n *   features: { workingMemory: true },\n * });\n *\n * // Add user message\n * ctx.addUserMessage('Hello!');\n *\n * // Prepare for LLM call (handles compaction if needed)\n * const { input, budget } = await ctx.prepare();\n *\n * // Call LLM with input...\n *\n * // Add assistant response\n * ctx.addAssistantResponse(response.output);\n * ```\n */\nexport class AgentContextNextGen extends EventEmitter<ContextEvents> {\n  // ============================================================================\n  // Private State\n  // ============================================================================\n\n  /** Configuration */\n  private readonly _config: Required<Omit<AgentContextNextGenConfig, 'tools' | 'storage' | 'features' | 'systemPrompt' | 'plugins' | 'compactionStrategy' | 'toolExecutionTimeout' | 'userId' | 'identities' | 'toolCategories'>> & {\n    features: Required<ContextFeatures>;\n    storage?: IContextStorage;\n    systemPrompt?: string;\n    toolCategories?: ToolCategoryScope;\n  };\n\n  /** Maximum context tokens for the model */\n  private readonly _maxContextTokens: number;\n\n  /** Compaction strategy */\n  private _compactionStrategy: ICompactionStrategy;\n\n  /** System prompt (user-provided) */\n  private _systemPrompt: string | undefined;\n\n  /** Conversation history (excludes current input) */\n  private _conversation: InputItem[] = [];\n\n  /** Current input (pending, will be added to conversation after LLM response) */\n  private _currentInput: InputItem[] = [];\n\n  /** Registered plugins */\n  private readonly _plugins: Map<string, IContextPluginNextGen> = new Map();\n\n  /** Tool manager */\n  private readonly _tools: ToolManager;\n\n  /** Token estimator for conversation/input */\n  private readonly _estimator: ITokenEstimator = simpleTokenEstimator;\n\n  /** Session ID (if loaded/saved) */\n  private _sessionId: string | null = null;\n\n  /** Agent ID */\n  private readonly _agentId: string;\n\n  /** User ID for multi-user scenarios */\n  private _userId: string | undefined;\n\n  /** Auth identities this agent is scoped to (connector + optional accountId) */\n  private _identities: AuthIdentity[] | undefined;\n\n  /** Storage backend */\n  private readonly _storage?: IContextStorage;\n\n  /** Destroyed flag */\n  private _destroyed = false;\n\n  /** Last thinking/reasoning content from the most recent assistant response */\n  private _lastThinking: string | null = null;\n\n  /** Cached budget from last prepare() call */\n  private _cachedBudget: ContextBudget | null = null;\n\n  /** Callback for beforeCompaction hook (set by Agent) */\n  private _beforeCompactionCallback: BeforeCompactionCallback | null = null;\n\n  // ============================================================================\n  // Static Factory\n  // ============================================================================\n\n  /**\n   * Create a new AgentContextNextGen instance.\n   */\n  static create(config: AgentContextNextGenConfig): AgentContextNextGen {\n    return new AgentContextNextGen(config);\n  }\n\n  // ============================================================================\n  // Constructor\n  // ============================================================================\n\n  private constructor(config: AgentContextNextGenConfig) {\n    super();\n\n    // Resolve max context tokens from model\n    const modelInfo = getModelInfo(config.model);\n    this._maxContextTokens = config.maxContextTokens ?? modelInfo?.features?.input?.tokens ?? 128000;\n\n    // Build full config\n    this._config = {\n      model: config.model,\n      maxContextTokens: this._maxContextTokens,\n      responseReserve: config.responseReserve ?? DEFAULT_CONFIG.responseReserve,\n      systemPrompt: config.systemPrompt,\n      strategy: config.strategy ?? DEFAULT_CONFIG.strategy,\n      features: { ...DEFAULT_FEATURES, ...config.features },\n      agentId: config.agentId ?? this.generateId(),\n      toolCategories: config.toolCategories,\n      storage: config.storage,\n    };\n\n    this._systemPrompt = config.systemPrompt;\n    this._agentId = this._config.agentId;\n    this._userId = config.userId;\n    this._identities = config.identities;\n\n    // Resolve session storage: explicit config > StorageRegistry factory > undefined\n    const sessionFactory = StorageRegistry.get('sessions');\n    const storageCtx = StorageRegistry.getContext() ?? (config.userId ? { userId: config.userId } : undefined);\n    this._storage = config.storage ?? (sessionFactory ? sessionFactory(this._agentId, storageCtx) : undefined);\n\n    // Initialize compaction strategy\n    // Use custom strategy if provided, otherwise create from registry\n    this._compactionStrategy = config.compactionStrategy ?? StrategyRegistry.create(this._config.strategy);\n\n    // Create tool manager (with optional hard execution timeout)\n    this._tools = new ToolManager(\n      config.toolExecutionTimeout ? { toolExecutionTimeout: config.toolExecutionTimeout } : undefined,\n    );\n\n    // Register initial tools\n    if (config.tools) {\n      for (const tool of config.tools) {\n        this._tools.register(tool);\n      }\n    }\n\n    // Auto-initialize plugins based on features config\n    this.initializePlugins(config.plugins);\n\n    // Auto-populate ToolContext with identity fields (agentId, userId)\n    this.syncToolContext();\n  }\n\n  /**\n   * Initialize plugins based on feature flags.\n   * Called automatically in constructor.\n   */\n  private initializePlugins(pluginConfigs?: PluginConfigs): void {\n    const features = this._config.features;\n    const configs = pluginConfigs ?? {};\n\n    // 1. Working Memory (default: enabled)\n    if (features.workingMemory) {\n      this.registerPlugin(new WorkingMemoryPluginNextGen(\n        configs.workingMemory as WorkingMemoryPluginConfig | undefined\n      ));\n    }\n\n    // 2. In-Context Memory (default: disabled)\n    if (features.inContextMemory) {\n      this.registerPlugin(new InContextMemoryPluginNextGen(\n        configs.inContextMemory as InContextMemoryConfig | undefined\n      ));\n    }\n\n    // 3. Persistent Instructions (default: disabled, requires agentId)\n    if (features.persistentInstructions) {\n      if (!this._agentId) {\n        throw new Error('persistentInstructions feature requires agentId to be set');\n      }\n      const piConfig = configs.persistentInstructions as Partial<PersistentInstructionsConfig> | undefined;\n      this.registerPlugin(new PersistentInstructionsPluginNextGen({\n        agentId: this._agentId,\n        ...piConfig,\n      }));\n    }\n\n    // 4. User Info (default: disabled)\n    if (features.userInfo) {\n      const uiConfig = configs.userInfo as Partial<UserInfoPluginConfig> | undefined;\n      this.registerPlugin(new UserInfoPluginNextGen({\n        userId: this._userId,\n        ...uiConfig,\n      }));\n    }\n\n    // 5. Tool Catalog (default: disabled)\n    if (features.toolCatalog) {\n      const tcConfig = configs.toolCatalog as Partial<ToolCatalogPluginConfig> | undefined;\n      const plugin = new ToolCatalogPluginNextGen({\n        categoryScope: this._config.toolCategories,\n        identities: this._identities,\n        ...tcConfig,\n      });\n      this.registerPlugin(plugin);\n      plugin.setToolManager(this._tools);\n    }\n\n    // Validate strategy dependencies now that plugins are initialized\n    this.validateStrategyDependencies(this._compactionStrategy);\n  }\n\n  /**\n   * Validate that a strategy's required plugins are registered.\n   * Logs a warning if required plugins are missing  the strategy should degrade gracefully.\n   */\n  private validateStrategyDependencies(strategy: ICompactionStrategy): void {\n    if (!strategy.requiredPlugins?.length) return;\n\n    const availablePlugins = new Set(this._plugins.keys());\n    const missing = strategy.requiredPlugins.filter(name => !availablePlugins.has(name));\n\n    if (missing.length > 0) {\n      logger.warn(\n        { strategy: strategy.name, missing, available: Array.from(availablePlugins) },\n        `Strategy '${strategy.name}' recommends plugins that are not registered: ${missing.join(', ')}. ` +\n        `Strategy will degrade gracefully.`\n      );\n    }\n  }\n\n  /**\n   * Sync identity fields and connector registry to ToolContext.\n   * Merges with existing ToolContext to preserve other fields (memory, signal, taskId).\n   *\n   * Connector registry resolution order:\n   * 1. If `identities` is set  filtered view showing only identity connectors\n   * 2. If access policy + userId  scoped view via Connector.scoped()\n   * 3. Otherwise  full global registry\n   */\n  private syncToolContext(): void {\n    const existing = this._tools.getToolContext();\n    this._tools.setToolContext({\n      ...existing,\n      agentId: this._agentId,\n      userId: this._userId,\n      identities: this._identities,\n      connectorRegistry: this.buildConnectorRegistry(),\n    });\n  }\n\n  /**\n   * Build the connector registry appropriate for this agent's config.\n   */\n  private buildConnectorRegistry(): IConnectorRegistry {\n    // 1. Identities set  filter global registry by unique connector names from identities\n    if (this._identities?.length) {\n      const allowedSet = new Set(this._identities.map(id => id.connector));\n      const base = this._userId && Connector.getAccessPolicy()\n        ? Connector.scoped({ userId: this._userId })\n        : Connector.asRegistry();\n\n      // Return a filtered view that only exposes connectors from identities\n      return {\n        get: (name) => {\n          if (!allowedSet.has(name)) {\n            const available = [...allowedSet].filter(n => base.has(n)).join(', ') || 'none';\n            throw new Error(`Connector '${name}' not found. Available: ${available}`);\n          }\n          return base.get(name);\n        },\n        has: (name) => allowedSet.has(name) && base.has(name),\n        list: () => base.list().filter(n => allowedSet.has(n)),\n        listAll: () => base.listAll().filter(c => allowedSet.has(c.name)),\n        size: () => base.listAll().filter(c => allowedSet.has(c.name)).length,\n        getDescriptionsForTools: () => {\n          const connectors = base.listAll().filter(c => allowedSet.has(c.name));\n          if (connectors.length === 0) return 'No connectors registered yet.';\n          return connectors.map(c => `  - \"${c.name}\": ${c.displayName} - ${c.config.description || 'No description'}`).join('\\n');\n        },\n        getInfo: () => {\n          const info: Record<string, { displayName: string; description: string; baseURL: string }> = {};\n          for (const c of base.listAll().filter(c => allowedSet.has(c.name))) {\n            info[c.name] = { displayName: c.displayName, description: c.config.description || '', baseURL: c.baseURL };\n          }\n          return info;\n        },\n      };\n    }\n\n    // 2. Access policy + userId  scoped view\n    if (this._userId && Connector.getAccessPolicy()) {\n      return Connector.scoped({ userId: this._userId });\n    }\n\n    // 3. Full global registry\n    return Connector.asRegistry();\n  }\n\n  // ============================================================================\n  // Public Properties\n  // ============================================================================\n\n  /** Get the tool manager */\n  get tools(): ToolManager {\n    return this._tools;\n  }\n\n  /** Get the model name */\n  get model(): string {\n    return this._config.model;\n  }\n\n  /** Get the agent ID */\n  get agentId(): string {\n    return this._agentId;\n  }\n\n  /** Get the current user ID */\n  get userId(): string | undefined {\n    return this._userId;\n  }\n\n  /** Set user ID. Automatically updates ToolContext for all tool executions. */\n  set userId(value: string | undefined) {\n    this._userId = value;\n    this.syncToolContext();\n  }\n\n  /** Get the auth identities this agent is scoped to (undefined = all visible connectors) */\n  get identities(): AuthIdentity[] | undefined {\n    return this._identities;\n  }\n\n  /** Set auth identities. Updates ToolContext.connectorRegistry and identity-aware descriptions. */\n  set identities(value: AuthIdentity[] | undefined) {\n    this._identities = value;\n    this.syncToolContext();\n  }\n\n  /** Get/set system prompt */\n  get systemPrompt(): string | undefined {\n    return this._systemPrompt;\n  }\n\n  set systemPrompt(value: string | undefined) {\n    this._systemPrompt = value;\n  }\n\n  /** Get feature configuration */\n  get features(): Required<ContextFeatures> {\n    return this._config.features;\n  }\n\n  /** Check if destroyed */\n  get isDestroyed(): boolean {\n    return this._destroyed;\n  }\n\n  /** Get current session ID */\n  get sessionId(): string | null {\n    return this._sessionId;\n  }\n\n  /** Get storage (null if not configured) */\n  get storage(): IContextStorage | null {\n    return this._storage ?? null;\n  }\n\n  /**\n   * Get the last thinking/reasoning content from the most recent assistant response.\n   * Updated on every assistant response, always available regardless of persistence setting.\n   */\n  get lastThinking(): string | null {\n    return this._lastThinking;\n  }\n\n  /** Get max context tokens */\n  get maxContextTokens(): number {\n    return this._maxContextTokens;\n  }\n\n  /** Get response reserve tokens */\n  get responseReserve(): number {\n    return this._config.responseReserve;\n  }\n\n  /** Get current tools token usage (useful for debugging) */\n  get toolsTokens(): number {\n    return this.calculateToolsTokens();\n  }\n\n  /**\n   * Get the cached budget from the last prepare() call.\n   * Returns null if prepare() hasn't been called yet.\n   */\n  get lastBudget(): ContextBudget | null {\n    return this._cachedBudget;\n  }\n\n  /**\n   * Get the current compaction strategy.\n   */\n  get compactionStrategy(): ICompactionStrategy {\n    return this._compactionStrategy;\n  }\n\n  /**\n   * Set the compaction strategy.\n   * Can be changed at runtime to switch compaction behavior.\n   */\n  setCompactionStrategy(strategy: ICompactionStrategy): void {\n    this.assertNotDestroyed();\n    this.validateStrategyDependencies(strategy);\n    this._compactionStrategy = strategy;\n  }\n\n  /**\n   * Set the beforeCompaction callback.\n   * Called by Agent to wire up lifecycle hooks.\n   */\n  setBeforeCompactionCallback(callback: BeforeCompactionCallback | null): void {\n    this._beforeCompactionCallback = callback;\n  }\n\n  // ============================================================================\n  // Compatibility / Migration Helpers\n  // ============================================================================\n\n  /**\n   * Get working memory plugin (if registered).\n   * This is a compatibility accessor for code expecting ctx.memory\n   */\n  get memory(): import('./plugins/WorkingMemoryPluginNextGen.js').WorkingMemoryPluginNextGen | null {\n    const plugin = this._plugins.get('working_memory');\n    return plugin as import('./plugins/WorkingMemoryPluginNextGen.js').WorkingMemoryPluginNextGen | null;\n  }\n\n  /**\n   * Get the last message (most recent user message or tool results).\n   * Used for compatibility with old code that expected a single item.\n   */\n  getLastUserMessage(): InputItem | null {\n    if (this._conversation.length === 0) return null;\n    const last = this._conversation[this._conversation.length - 1];\n    if (!last) return null;\n    // Return if it's user message (check for role property and USER role)\n    if ('role' in last && last.role === MessageRole.USER) return last;\n    return null;\n  }\n\n  /**\n   * Set current input (user message).\n   * Adds a user message to the conversation and sets it as the current input for prepare().\n   */\n  setCurrentInput(content: string | Content[]): void {\n    this.assertNotDestroyed();\n    // Clear existing current input array\n    this._currentInput = [];\n    // Add user message to both conversation and current input\n    this.addUserMessage(content);\n    // The last message added is the current input\n    const lastMsg = this._conversation[this._conversation.length - 1];\n    if (lastMsg) {\n      this._currentInput.push(lastMsg);\n    }\n  }\n\n  /**\n   * Add multiple input items to conversation (legacy compatibility).\n   */\n  addInputItems(items: InputItem[]): void {\n    this.assertNotDestroyed();\n    for (const item of items) {\n      this._conversation.push(item);\n    }\n  }\n\n  /**\n   * Legacy alias for prepare() - returns prepared context.\n   */\n  async prepareConversation(): Promise<PreparedContext> {\n    return this.prepare();\n  }\n\n  /**\n   * Add a message (legacy compatibility).\n   * For user messages, use addUserMessage instead.\n   * For assistant messages, use addAssistantResponse instead.\n   */\n  addMessage(role: 'user' | 'assistant', content: string | Content[]): string {\n    this.assertNotDestroyed();\n    if (role === 'user') {\n      return this.addUserMessage(content);\n    }\n    // For assistant, we need to convert to OutputItem format\n    const outputItem: OutputItem = {\n      type: 'message' as const,\n      role: MessageRole.ASSISTANT,\n      content: [{\n        type: ContentType.OUTPUT_TEXT,\n        text: typeof content === 'string' ? content : JSON.stringify(content),\n      }],\n    };\n    return this.addAssistantResponse([outputItem]);\n  }\n\n  // ============================================================================\n  // Plugin Management\n  // ============================================================================\n\n  /**\n   * Register a plugin.\n   * Plugin's tools are automatically registered with ToolManager.\n   */\n  registerPlugin(plugin: IContextPluginNextGen): void {\n    this.assertNotDestroyed();\n\n    if (this._plugins.has(plugin.name)) {\n      throw new Error(`Plugin '${plugin.name}' is already registered`);\n    }\n\n    this._plugins.set(plugin.name, plugin);\n\n    // Register plugin's tools\n    const tools = plugin.getTools();\n    for (const tool of tools) {\n      this._tools.register(tool);\n    }\n  }\n\n  /**\n   * Get a plugin by name.\n   */\n  getPlugin<T extends IContextPluginNextGen>(name: string): T | null {\n    return (this._plugins.get(name) as T) ?? null;\n  }\n\n  /**\n   * Check if a plugin is registered.\n   */\n  hasPlugin(name: string): boolean {\n    return this._plugins.has(name);\n  }\n\n  /**\n   * Get all registered plugins.\n   */\n  getPlugins(): IContextPluginNextGen[] {\n    return Array.from(this._plugins.values());\n  }\n\n  // ============================================================================\n  // Conversation Management\n  // ============================================================================\n\n  /**\n   * Add a user message.\n   * Returns the message ID.\n   */\n  addUserMessage(content: string | Content[]): string {\n    this.assertNotDestroyed();\n\n    const id = this.generateId();\n    const contentArray: Content[] = typeof content === 'string'\n      ? [{ type: ContentType.INPUT_TEXT, text: content }]\n      : content;\n\n    const message: Message = {\n      type: 'message',\n      id,\n      role: MessageRole.USER,\n      content: contentArray,\n    };\n\n    // User message becomes current input\n    this._currentInput = [message];\n\n    this.emit('message:added', { role: 'user', index: this._conversation.length });\n\n    return id;\n  }\n\n  /**\n   * Add assistant response (from LLM output).\n   * Also moves current input to conversation history.\n   * Returns the message ID.\n   */\n  addAssistantResponse(output: OutputItem[]): string {\n    this.assertNotDestroyed();\n\n    // First, move current input to conversation\n    if (this._currentInput.length > 0) {\n      this._conversation.push(...this._currentInput);\n      this._currentInput = [];\n    }\n\n    // Build assistant message\n    const id = this.generateId();\n    const contentArray: Content[] = [];\n    let thinkingText: string | null = null;\n\n    for (const item of output) {\n      if (item.type === 'message' && 'content' in item) {\n        // Text content\n        const msg = item as Message;\n        for (const c of msg.content) {\n          if (c.type === ContentType.OUTPUT_TEXT || c.type === ContentType.INPUT_TEXT) {\n            contentArray.push({\n              type: ContentType.OUTPUT_TEXT,\n              text: (c as any).text || '',\n            });\n          } else if (c.type === ContentType.TOOL_USE) {\n            contentArray.push(c);\n          } else if (c.type === ContentType.THINKING) {\n            // Capture thinking text regardless of persistence\n            const thinking = c as import('../../domain/entities/Content.js').ThinkingContent;\n            thinkingText = thinking.thinking;\n            // Only persist in history when the vendor requires it (e.g., Anthropic)\n            if (thinking.persistInHistory) {\n              contentArray.push(c);\n            }\n          }\n        }\n      } else if (item.type === 'compaction' || item.type === 'reasoning') {\n        // Skip compaction and reasoning items for now\n        continue;\n      }\n    }\n\n    // Always update lastThinking (available for inspection via property)\n    this._lastThinking = thinkingText;\n\n    // Only add if there's content\n    if (contentArray.length > 0) {\n      const message: Message = {\n        type: 'message',\n        id,\n        role: MessageRole.ASSISTANT,\n        content: contentArray,\n      };\n\n      this._conversation.push(message);\n      this.emit('message:added', { role: 'assistant', index: this._conversation.length - 1 });\n    }\n\n    return id;\n  }\n\n  /**\n   * Add tool results.\n   * Returns the message ID.\n   */\n  addToolResults(results: ToolResult[]): string {\n    this.assertNotDestroyed();\n\n    if (results.length === 0) {\n      return '';\n    }\n\n    const id = this.generateId();\n    const contentArray: Content[] = results.map(r => {\n      let contentStr: string;\n      let images: Array<{ base64: string; mediaType: string }> | undefined;\n\n      if (typeof r.content === 'string') {\n        contentStr = r.content;\n      } else if (r.content && Array.isArray(r.content.__images) && r.content.__images.length > 0) {\n        // __images convention: separate images from text content.\n        // Images are stored on the Content object and handled natively by provider converters.\n        // This prevents base64 data from inflating text-based token counts.\n        images = r.content.__images;\n        const { __images: _, base64: __, ...rest } = r.content;\n        contentStr = JSON.stringify(rest);\n      } else {\n        contentStr = JSON.stringify(r.content);\n      }\n\n      return {\n        type: ContentType.TOOL_RESULT,\n        tool_use_id: r.tool_use_id,\n        content: contentStr,\n        error: r.error,\n        ...(images ? { __images: images } : {}),\n      } as Content;\n    });\n\n    const message: Message = {\n      type: 'message',\n      id,\n      role: MessageRole.USER, // Tool results are user role in most APIs\n      content: contentArray,\n    };\n\n    // Tool results become current input\n    this._currentInput = [message];\n\n    this.emit('message:added', { role: 'tool', index: this._conversation.length });\n\n    return id;\n  }\n\n  /**\n   * Get conversation history (read-only).\n   */\n  getConversation(): ReadonlyArray<InputItem> {\n    return this._conversation;\n  }\n\n  /**\n   * Get current input (read-only).\n   */\n  getCurrentInput(): ReadonlyArray<InputItem> {\n    return this._currentInput;\n  }\n\n  /**\n   * Get conversation length.\n   */\n  getConversationLength(): number {\n    return this._conversation.length;\n  }\n\n  /**\n   * Clear conversation history.\n   */\n  clearConversation(reason?: string): void {\n    this.assertNotDestroyed();\n    this._conversation = [];\n    this._currentInput = [];\n    this.emit('conversation:cleared', { reason });\n  }\n\n  // ============================================================================\n  // Context Preparation (THE main method)\n  // ============================================================================\n\n  /**\n   * Prepare context for LLM call.\n   *\n   * This method:\n   * 1. Calculates tool definition tokens (never compacted)\n   * 2. Builds the system message from all components\n   * 3. Calculates token budget\n   * 4. Handles oversized current input if needed\n   * 5. Runs compaction if needed\n   * 6. Returns final InputItem[] ready for LLM\n   *\n   * IMPORTANT: Call this ONCE right before each LLM call!\n   */\n  async prepare(): Promise<PreparedContext> {\n    this.assertNotDestroyed();\n\n    // Reset lastThinking at start of each turn to prevent stale data\n    this._lastThinking = null;\n\n    const compactionLog: string[] = [];\n\n    // Step 1: Calculate tool tokens (NEVER compacted - must fit!)\n    const toolsTokens = this.calculateToolsTokens();\n\n    // Available = maxTokens - responseReserve - toolsTokens\n    const availableForContent = this._maxContextTokens - this._config.responseReserve - toolsTokens;\n\n    if (availableForContent <= 0) {\n      throw new Error(\n        `Too many tools registered: tools use ${toolsTokens} tokens, ` +\n        `only ${this._maxContextTokens - this._config.responseReserve} available. ` +\n        `Consider reducing the number of tools or their descriptions.`\n      );\n    }\n\n    // Step 2: Build system message and calculate its tokens\n    const { systemMessage, systemTokens, breakdown } = await this.buildSystemMessage();\n\n    // Step 3: Calculate current input tokens\n    let currentInputTokens = this.calculateInputTokens(this._currentInput);\n\n    // Step 4: Check if current input is too large\n    const systemPlusInput = systemTokens + currentInputTokens;\n    if (systemPlusInput > availableForContent) {\n      // Current input too large - handle it\n      const result = await this.handleOversizedInput(\n        availableForContent - systemTokens\n      );\n      this.emit('input:oversized', { result });\n\n      if (!result.accepted) {\n        throw new Error(result.error || 'Current input is too large for context');\n      }\n\n      // Recalculate current input tokens after truncation\n      currentInputTokens = this.calculateInputTokens(this._currentInput);\n    }\n\n    // Step 5: Calculate conversation tokens\n    let conversationTokens = this.calculateConversationTokens();\n    let totalUsed = systemTokens + conversationTokens + currentInputTokens;\n\n    // Step 6: Check if compaction needed\n    let compacted = false;\n    const strategyThreshold = this._compactionStrategy.threshold;\n    if (totalUsed / availableForContent > strategyThreshold) {\n      const targetToFree = totalUsed - Math.floor(availableForContent * (strategyThreshold - 0.1));\n\n      const freed = await this.runCompaction(targetToFree, compactionLog);\n      compacted = freed > 0;\n\n      // Recalculate after compaction\n      conversationTokens = this.calculateConversationTokens();\n      totalUsed = systemTokens + conversationTokens + currentInputTokens;\n    }\n\n    // Step 7: Build final budget (include tools in totalUsed for accurate reporting)\n    const totalUsedWithTools = totalUsed + toolsTokens;\n    const budget: ContextBudget = {\n      maxTokens: this._maxContextTokens,\n      responseReserve: this._config.responseReserve,\n      systemMessageTokens: systemTokens,\n      toolsTokens,\n      conversationTokens,\n      currentInputTokens,\n      totalUsed: totalUsedWithTools,\n      available: this._maxContextTokens - this._config.responseReserve - totalUsedWithTools,\n      utilizationPercent: (totalUsedWithTools / (this._maxContextTokens - this._config.responseReserve)) * 100,\n      breakdown: {\n        ...breakdown,\n        tools: toolsTokens,\n        conversation: conversationTokens,\n        currentInput: currentInputTokens,\n      },\n    };\n\n    // Cache the budget for inspection via lastBudget getter\n    this._cachedBudget = budget;\n\n    // Emit budget:updated event for reactive monitoring\n    this.emit('budget:updated', { budget, timestamp: Date.now() });\n\n    // Step 8: Emit budget warnings\n    if (budget.utilizationPercent >= 90) {\n      this.emit('budget:critical', { budget });\n    } else if (budget.utilizationPercent >= 70) {\n      this.emit('budget:warning', { budget });\n    }\n\n    // Step 9: Build final input array\n    let input: InputItem[] = [\n      systemMessage,\n      ...this._conversation,\n      ...this._currentInput,\n    ];\n\n    // Step 10: CRITICAL - Sanitize tool pairs before LLM call\n    // Ensures every TOOL_USE has matching TOOL_RESULT and vice versa\n    input = this.sanitizeToolPairs(input);\n\n    this.emit('context:prepared', { budget, compacted });\n\n    return {\n      input,\n      budget,\n      compacted,\n      compactionLog,\n    };\n  }\n\n  // ============================================================================\n  // System Message Building\n  // ============================================================================\n\n  /**\n   * Build the system message containing all context components.\n   */\n  private async buildSystemMessage(): Promise<{\n    systemMessage: Message;\n    systemTokens: number;\n    breakdown: {\n      systemPrompt: number;\n      persistentInstructions: number;\n      pluginInstructions: number;\n      pluginContents: Record<string, number>;\n    };\n  }> {\n    const parts: string[] = [];\n    const breakdown = {\n      systemPrompt: 0,\n      persistentInstructions: 0,\n      pluginInstructions: 0,\n      pluginContents: {} as Record<string, number>,\n    };\n\n    // 1. System Prompt (user-provided)\n    if (this._systemPrompt) {\n      parts.push(`# System Prompt\\n\\n${this._systemPrompt}`);\n      breakdown.systemPrompt = this._estimator.estimateTokens(this._systemPrompt);\n    }\n\n    // 2. Persistent Instructions (from plugin, if enabled)\n    const persistentPlugin = this._plugins.get('persistent_instructions');\n    if (persistentPlugin) {\n      const content = await persistentPlugin.getContent();\n      if (content) {\n        parts.push(`# Persistent Instructions\\n\\n${content}`);\n        breakdown.persistentInstructions = persistentPlugin.getTokenSize();\n      }\n    }\n\n    // 3. Plugin Instructions (how to use each plugin)\n    const instructionParts: string[] = [];\n    let totalInstructionTokens = 0;\n\n    for (const plugin of this._plugins.values()) {\n      const instructions = plugin.getInstructions();\n      if (instructions) {\n        instructionParts.push(`## ${this.formatPluginName(plugin.name)}\\n\\n${instructions}`);\n        totalInstructionTokens += plugin.getInstructionsTokenSize();\n      }\n    }\n\n    if (instructionParts.length > 0) {\n      parts.push(`# Instructions for Context Plugins\\n\\n${instructionParts.join('\\n\\n')}`);\n      breakdown.pluginInstructions = totalInstructionTokens;\n    }\n\n    // 4. Plugin Contents (actual data from each plugin, except persistent instructions)\n    for (const plugin of this._plugins.values()) {\n      if (plugin.name === 'persistent_instructions') continue; // Already handled above\n\n      const content = await plugin.getContent();\n      if (content) {\n        const sectionTitle = this.formatPluginName(plugin.name);\n        parts.push(`# ${sectionTitle}\\n\\n${content}`);\n        breakdown.pluginContents[plugin.name] = plugin.getTokenSize();\n      }\n    }\n\n    // 5. Current date and time (always injected)\n    const now = new Date();\n    parts.push(`CURRENT DATE AND TIME: ${now.toLocaleString('en-US', { dateStyle: 'full', timeStyle: 'long', timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone })}`);\n\n    // Build final system message\n    const systemText = parts.join('\\n\\n---\\n\\n');\n    const systemTokens = this._estimator.estimateTokens(systemText);\n\n    const systemMessage: Message = {\n      type: 'message',\n      role: MessageRole.DEVELOPER,\n      content: [{ type: ContentType.INPUT_TEXT, text: systemText }],\n    };\n\n    return { systemMessage, systemTokens, breakdown };\n  }\n\n  /**\n   * Format plugin name for display (e.g., 'working_memory' -> 'Working Memory')\n   */\n  private formatPluginName(name: string): string {\n    return name\n      .split('_')\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n      .join(' ');\n  }\n\n  // ============================================================================\n  // Token Calculations\n  // ============================================================================\n\n  /**\n   * Calculate tokens used by tool definitions.\n   * Tools are sent separately to the LLM and take up context space.\n   */\n  private calculateToolsTokens(): number {\n    const enabledTools = this._tools.getEnabled();\n    if (enabledTools.length === 0) return 0;\n\n    let total = 0;\n\n    for (const tool of enabledTools) {\n      // Each tool has: name, description, parameters schema\n      const fn = tool.definition.function;\n\n      // Name: ~2-5 tokens\n      total += this._estimator.estimateTokens(fn.name);\n\n      // Description: varies widely, typically 20-100 tokens\n      if (fn.description) {\n        total += this._estimator.estimateTokens(fn.description);\n      }\n\n      // Parameters schema: JSON schema can be large\n      if (fn.parameters) {\n        total += this._estimator.estimateDataTokens(fn.parameters);\n      }\n\n      // Per-tool overhead (JSON structure, type field, etc.)\n      total += 10;\n    }\n\n    // Overall tools array overhead\n    total += 20;\n\n    return total;\n  }\n\n  /**\n   * Calculate tokens for conversation history.\n   */\n  private calculateConversationTokens(): number {\n    let total = 0;\n    for (const item of this._conversation) {\n      total += this.estimateItemTokens(item);\n    }\n    return total;\n  }\n\n  /**\n   * Calculate tokens for current input.\n   */\n  private calculateInputTokens(items: InputItem[]): number {\n    let total = 0;\n    for (const item of items) {\n      total += this.estimateItemTokens(item);\n    }\n    return total;\n  }\n\n  /**\n   * Estimate tokens for a single InputItem.\n   */\n  private estimateItemTokens(item: InputItem): number {\n    if (item.type !== 'message') return 50; // Default for unknown types\n\n    const msg = item as Message;\n    let total = 4; // Message overhead\n\n    for (const c of msg.content) {\n      if (c.type === ContentType.INPUT_TEXT || c.type === ContentType.OUTPUT_TEXT) {\n        total += this._estimator.estimateTokens((c as any).text || '');\n      } else if (c.type === ContentType.TOOL_USE) {\n        total += this._estimator.estimateTokens((c as any).name || '');\n        total += this._estimator.estimateDataTokens((c as any).input || {});\n      } else if (c.type === ContentType.TOOL_RESULT) {\n        // Count text content tokens (images already stripped from content string)\n        total += this._estimator.estimateTokens((c as any).content || '');\n        // Count attached images separately using image-aware estimation\n        const images = (c as any).__images as Array<{ base64: string; mediaType: string }> | undefined;\n        if (images?.length) {\n          for (const _img of images) {\n            total += this._estimateImageTokens();\n          }\n        }\n      } else if (c.type === ContentType.THINKING) {\n        total += this._estimator.estimateTokens((c as any).thinking || '');\n      } else if (c.type === ContentType.INPUT_IMAGE_URL) {\n        const imgContent = c as any;\n        const detail = imgContent.image_url?.detail;\n        total += this._estimateImageTokens(undefined, undefined, detail);\n      }\n    }\n\n    return total;\n  }\n\n  /**\n   * Estimate tokens for a single image, using the estimator's image method if available.\n   */\n  private _estimateImageTokens(width?: number, height?: number, detail?: string): number {\n    if (this._estimator.estimateImageTokens) {\n      return this._estimator.estimateImageTokens(width, height, detail);\n    }\n    // Fallback for estimators that don't implement estimateImageTokens\n    return 1000;\n  }\n\n  // ============================================================================\n  // Compaction\n  // ============================================================================\n\n  /**\n   * Run compaction to free up tokens.\n   * Delegates to the current compaction strategy.\n   * Returns total tokens freed.\n   */\n  private async runCompaction(targetToFree: number, log: string[]): Promise<number> {\n    const timestamp = Date.now();\n\n    // Emit compaction:starting event BEFORE any compaction occurs\n    if (this._cachedBudget) {\n      this.emit('compaction:starting', {\n        budget: this._cachedBudget,\n        targetTokensToFree: targetToFree,\n        timestamp,\n      });\n    }\n\n    // Call beforeCompaction callback if set (allows Agent to invoke lifecycle hooks)\n    if (this._beforeCompactionCallback && this._cachedBudget) {\n      try {\n        await this._beforeCompactionCallback({\n          budget: this._cachedBudget,\n          targetTokensToFree: targetToFree,\n          strategy: this._compactionStrategy.name,\n        });\n      } catch (error) {\n        // Log but don't block compaction\n        log.push(`beforeCompaction callback error: ${(error as Error).message}`);\n      }\n    }\n\n    // Build CompactionContext for strategy\n    const context = this.buildCompactionContext();\n\n    // Delegate to strategy\n    const result = await this._compactionStrategy.compact(context, targetToFree);\n\n    // Merge strategy log with our log\n    log.push(...result.log);\n\n    if (result.tokensFreed > 0) {\n      this.emit('context:compacted', { tokensFreed: result.tokensFreed, log });\n    }\n\n    return result.tokensFreed;\n  }\n\n  /**\n   * Run post-cycle consolidation.\n   * Called by Agent after agentic cycle completes (before session save).\n   *\n   * Delegates to the current compaction strategy's consolidate() method.\n   * Use for more expensive operations like summarization.\n   */\n  async consolidate(): Promise<ConsolidationResult> {\n    this.assertNotDestroyed();\n\n    const context = this.buildCompactionContext();\n    return this._compactionStrategy.consolidate(context);\n  }\n\n  /**\n   * Build CompactionContext for strategy.\n   * Provides controlled access to context state.\n   */\n  private buildCompactionContext(): CompactionContext {\n    const self = this;\n\n    return {\n      get budget(): ContextBudget {\n        // Return cached budget or calculate fresh\n        return self._cachedBudget ?? {\n          maxTokens: self._maxContextTokens,\n          responseReserve: self._config.responseReserve,\n          systemMessageTokens: 0,\n          toolsTokens: 0,\n          conversationTokens: 0,\n          currentInputTokens: 0,\n          totalUsed: 0,\n          available: self._maxContextTokens - self._config.responseReserve,\n          utilizationPercent: 0,\n          breakdown: {\n            systemPrompt: 0,\n            persistentInstructions: 0,\n            pluginInstructions: 0,\n            pluginContents: {},\n            tools: 0,\n            conversation: 0,\n            currentInput: 0,\n          },\n        };\n      },\n\n      get conversation(): ReadonlyArray<InputItem> {\n        return self._conversation;\n      },\n\n      get currentInput(): ReadonlyArray<InputItem> {\n        return self._currentInput;\n      },\n\n      get plugins(): ReadonlyArray<IContextPluginNextGen> {\n        return Array.from(self._plugins.values());\n      },\n\n      get strategyName(): string {\n        return self._compactionStrategy.name;\n      },\n\n      async removeMessages(indices: number[]): Promise<number> {\n        return self.removeMessagesByIndices(indices);\n      },\n\n      async compactPlugin(pluginName: string, targetTokens: number): Promise<number> {\n        const plugin = self._plugins.get(pluginName);\n        if (!plugin || !plugin.isCompactable()) {\n          return 0;\n        }\n        return plugin.compact(targetTokens);\n      },\n\n      estimateTokens(item: InputItem): number {\n        return self.estimateItemTokens(item);\n      },\n    };\n  }\n\n  /**\n   * Remove messages by indices.\n   * Handles tool pair preservation internally.\n   * Used by CompactionContext.removeMessages().\n   */\n  private removeMessagesByIndices(indices: number[]): number {\n    if (indices.length === 0 || this._conversation.length === 0) {\n      return 0;\n    }\n\n    // Calculate tokens being freed\n    let tokensFreed = 0;\n    const indicesToRemove = new Set(indices);\n\n    for (const idx of indicesToRemove) {\n      const item = this._conversation[idx];\n      if (item) {\n        tokensFreed += this.estimateItemTokens(item);\n      }\n    }\n\n    // Build new conversation without removed messages\n    this._conversation = this._conversation.filter((_, i) => !indicesToRemove.has(i));\n\n    return tokensFreed;\n  }\n\n  /**\n   * Sanitize tool pairs in the input array.\n   * Removes orphan TOOL_USE (no matching TOOL_RESULT) and\n   * orphan TOOL_RESULT (no matching TOOL_USE).\n   *\n   * This is CRITICAL - LLM APIs require matching pairs.\n   */\n  private sanitizeToolPairs(items: InputItem[]): InputItem[] {\n    // Collect all TOOL_USE IDs and TOOL_RESULT tool_use_ids\n    const toolUseIds = new Set<string>();\n    const toolResultIds = new Set<string>();\n\n    for (const item of items) {\n      if (item.type !== 'message') continue;\n      const msg = item as Message;\n      for (const c of msg.content) {\n        if (c.type === ContentType.TOOL_USE) {\n          toolUseIds.add((c as any).id);\n        } else if (c.type === ContentType.TOOL_RESULT) {\n          toolResultIds.add((c as any).tool_use_id);\n        }\n      }\n    }\n\n    // Find orphans: TOOL_USE without TOOL_RESULT, TOOL_RESULT without TOOL_USE\n    const orphanToolUseIds = new Set<string>();\n    const orphanToolResultIds = new Set<string>();\n\n    for (const id of toolUseIds) {\n      if (!toolResultIds.has(id)) {\n        orphanToolUseIds.add(id);\n      }\n    }\n\n    for (const id of toolResultIds) {\n      if (!toolUseIds.has(id)) {\n        orphanToolResultIds.add(id);\n      }\n    }\n\n    // If no orphans, return as-is\n    if (orphanToolUseIds.size === 0 && orphanToolResultIds.size === 0) {\n      return items;\n    }\n\n    // Remove orphan content from messages\n    const result: InputItem[] = [];\n\n    for (const item of items) {\n      if (item.type !== 'message') {\n        result.push(item);\n        continue;\n      }\n\n      const msg = item as Message;\n      const filteredContent: Content[] = [];\n\n      for (const c of msg.content) {\n        if (c.type === ContentType.TOOL_USE) {\n          const id = (c as any).id;\n          if (!orphanToolUseIds.has(id)) {\n            filteredContent.push(c);\n          }\n        } else if (c.type === ContentType.TOOL_RESULT) {\n          const id = (c as any).tool_use_id;\n          if (!orphanToolResultIds.has(id)) {\n            filteredContent.push(c);\n          }\n        } else {\n          filteredContent.push(c);\n        }\n      }\n\n      // Only include message if it has content left\n      if (filteredContent.length > 0) {\n        result.push({\n          ...msg,\n          content: filteredContent,\n        } as Message);\n      }\n    }\n\n    return result;\n  }\n\n  // ============================================================================\n  // Oversized Input Handling\n  // ============================================================================\n\n  /**\n   * Handle oversized current input.\n   */\n  private async handleOversizedInput(maxTokens: number): Promise<OversizedInputResult> {\n    if (this._currentInput.length === 0) {\n      return { accepted: true, content: '', originalSize: 0, finalSize: 0 };\n    }\n\n    const input = this._currentInput[0];\n    if (input?.type !== 'message') {\n      return { accepted: false, content: '', error: 'Invalid input type', originalSize: 0, finalSize: 0 };\n    }\n\n    const msg = input as Message;\n\n    // Check if this is user input or tool results\n    const hasToolResult = msg.content.some(c => c.type === ContentType.TOOL_RESULT);\n\n    if (!hasToolResult) {\n      // User input - reject with clear error\n      const originalSize = this.estimateItemTokens(input);\n      return {\n        accepted: false,\n        content: '',\n        error: `User input is too large (${originalSize} tokens) for available context (${maxTokens} tokens). Please provide shorter input.`,\n        originalSize,\n        finalSize: 0,\n      };\n    }\n\n    // Tool results - attempt truncation\n    return this.emergencyToolResultsTruncation(msg, maxTokens);\n  }\n\n  /**\n   * Emergency truncation of tool results to fit in context.\n   */\n  private emergencyToolResultsTruncation(msg: Message, maxTokens: number): OversizedInputResult {\n    const originalSize = this.estimateItemTokens(msg);\n    const truncatedContent: Content[] = [];\n\n    // Calculate max chars we can keep (rough: tokens * 3.5)\n    const maxChars = Math.floor(maxTokens * 3.5);\n    let totalCharsUsed = 0;\n\n    for (const c of msg.content) {\n      if (c.type === ContentType.TOOL_RESULT) {\n        const toolResult = c as any;\n        const content = toolResult.content || '';\n        const images = toolResult.__images as Array<{ base64: string; mediaType: string }> | undefined;\n\n        // Check if content is binary (base64, etc.)\n        // Skip this check if images are already extracted via __images convention\n        if (!images?.length && this.isBinaryContent(content)) {\n          // Reject binary content\n          truncatedContent.push({\n            type: ContentType.TOOL_RESULT,\n            tool_use_id: toolResult.tool_use_id,\n            content: '[Binary content too large - rejected. Please try a different approach or request smaller output.]',\n            error: 'Binary content too large',\n          });\n          totalCharsUsed += 100;\n        } else {\n          // Truncate text/JSON content (images are stored separately and don't count as chars)\n          const availableChars = maxChars - totalCharsUsed - 200; // Reserve for warning\n          if (content.length > availableChars && availableChars > 0) {\n            const truncated = content.slice(0, availableChars);\n            truncatedContent.push({\n              type: ContentType.TOOL_RESULT,\n              tool_use_id: toolResult.tool_use_id,\n              content: `${truncated}\\n\\n[TRUNCATED: Original output was ${Math.round(content.length / 1024)}KB. Only first ${Math.round(availableChars / 1024)}KB shown. Consider using more targeted queries.]`,\n              // Preserve images even when text is truncated  they're handled natively by providers\n              ...(images ? { __images: images } : {}),\n            });\n            totalCharsUsed += truncated.length + 150;\n          } else if (availableChars > 0) {\n            truncatedContent.push(c);\n            totalCharsUsed += content.length;\n          } else {\n            // No space left for text, but still preserve images if present\n            truncatedContent.push({\n              type: ContentType.TOOL_RESULT,\n              tool_use_id: toolResult.tool_use_id,\n              content: '[Output too large - skipped due to context limits. Try a more targeted query.]',\n              error: 'Output too large',\n              // Preserve images even when text is dropped\n              ...(images ? { __images: images } : {}),\n            });\n            totalCharsUsed += 100;\n          }\n        }\n      } else {\n        truncatedContent.push(c);\n      }\n    }\n\n    // Update message with truncated content\n    msg.content = truncatedContent;\n    const finalSize = this.estimateItemTokens(msg);\n\n    return {\n      accepted: true,\n      content: JSON.stringify(truncatedContent),\n      warning: `Tool results truncated from ${originalSize} to ${finalSize} tokens to fit in context.`,\n      originalSize,\n      finalSize,\n    };\n  }\n\n  /**\n   * Check if content appears to be binary (base64, etc.)\n   */\n  private isBinaryContent(content: string): boolean {\n    if (!content || content.length < 100) return false;\n\n    // Check for base64 patterns\n    const base64Ratio = (content.match(/[A-Za-z0-9+/=]/g)?.length ?? 0) / content.length;\n    if (base64Ratio > 0.95 && content.length > 1000) {\n      return true;\n    }\n\n    // Check for binary-looking patterns\n    if (/^[A-Za-z0-9+/]{50,}={0,2}$/.test(content.slice(0, 100))) {\n      return true;\n    }\n\n    return false;\n  }\n\n  // ============================================================================\n  // Session Persistence\n  // ============================================================================\n\n  /**\n   * Save context state to storage.\n   *\n   * @param sessionId - Optional session ID (uses current or generates new)\n   * @param metadata - Optional additional metadata to merge\n   * @param stateOverride - Optional state override (for agent-level state injection)\n   */\n  async save(\n    sessionId?: string,\n    metadata?: Record<string, unknown>,\n    stateOverride?: SerializedContextState\n  ): Promise<void> {\n    this.assertNotDestroyed();\n\n    if (!this._storage) {\n      throw new Error('No storage configured');\n    }\n\n    const targetSessionId = sessionId ?? this._sessionId ?? this.generateId();\n\n    // Use provided state override or build from current state\n    const state: SerializedContextState = stateOverride ?? this.getState();\n\n    // Merge additional metadata if provided\n    if (metadata) {\n      state.metadata = { ...state.metadata, ...metadata };\n    }\n\n    await this._storage.save(targetSessionId, state);\n    this._sessionId = targetSessionId;\n  }\n\n  /**\n   * Load context state from storage.\n   */\n  async load(sessionId: string): Promise<boolean> {\n    this.assertNotDestroyed();\n\n    if (!this._storage) {\n      throw new Error('No storage configured');\n    }\n\n    const stored = await this._storage.load(sessionId);\n    if (!stored) {\n      return false;\n    }\n\n    // Extract state from StoredContextSession wrapper\n    const state = stored.state;\n\n    // Restore conversation\n    this._conversation = state.conversation;\n    this._systemPrompt = state.systemPrompt;\n\n    // Restore plugin states\n    for (const [name, pluginState] of Object.entries(state.pluginStates)) {\n      const plugin = this._plugins.get(name);\n      if (plugin) {\n        plugin.restoreState(pluginState);\n      }\n    }\n\n    this._sessionId = sessionId;\n    return true;\n  }\n\n  /**\n   * Load raw state from storage without restoring.\n   * Used by BaseAgent for custom state restoration.\n   */\n  async loadRaw(sessionId: string): Promise<{ state: SerializedContextState; stored: StoredContextSession } | null> {\n    this.assertNotDestroyed();\n\n    if (!this._storage) {\n      throw new Error('No storage configured');\n    }\n\n    const stored = await this._storage.load(sessionId);\n    if (!stored) {\n      return null;\n    }\n\n    this._sessionId = sessionId;\n    return { state: stored.state, stored };\n  }\n\n  /**\n   * Check if session exists in storage.\n   */\n  async sessionExists(sessionId: string): Promise<boolean> {\n    if (!this._storage) {\n      return false;\n    }\n    return this._storage.exists(sessionId);\n  }\n\n  /**\n   * Delete a session from storage.\n   */\n  async deleteSession(sessionId?: string): Promise<void> {\n    if (!this._storage) {\n      throw new Error('No storage configured');\n    }\n\n    const targetSessionId = sessionId ?? this._sessionId;\n    if (!targetSessionId) {\n      throw new Error('No session ID provided or loaded');\n    }\n\n    await this._storage.delete(targetSessionId);\n\n    // Clear session ID if deleting current session\n    if (targetSessionId === this._sessionId) {\n      this._sessionId = null;\n    }\n  }\n\n  /**\n   * Get serialized state for persistence.\n   * Used by BaseAgent to inject agent-level state.\n   */\n  getState(): SerializedContextState {\n    this.assertNotDestroyed();\n\n    const pluginStates: Record<string, unknown> = {};\n    for (const [name, plugin] of this._plugins) {\n      pluginStates[name] = plugin.getState();\n    }\n\n    return {\n      conversation: this._conversation,\n      pluginStates,\n      systemPrompt: this._systemPrompt,\n      metadata: {\n        savedAt: Date.now(),\n        agentId: this._agentId,\n        userId: this._userId,\n        model: this._config.model,\n      },\n    };\n  }\n\n  /**\n   * Restore state from serialized form.\n   * Used by BaseAgent for custom state restoration.\n   */\n  restoreState(state: SerializedContextState): void {\n    this.assertNotDestroyed();\n\n    this._conversation = state.conversation ?? [];\n    this._systemPrompt = state.systemPrompt;\n\n    // Restore plugin states (guard against null/undefined)\n    if (state.pluginStates) {\n      for (const [name, pluginState] of Object.entries(state.pluginStates)) {\n        const plugin = this._plugins.get(name);\n        if (plugin) {\n          plugin.restoreState(pluginState);\n        }\n      }\n    }\n  }\n\n  // ============================================================================\n  // Inspection / Monitoring\n  // ============================================================================\n\n  /**\n   * Get the current token budget.\n   *\n   * Returns the cached budget from the last prepare() call if available.\n   * If prepare() hasn't been called yet, calculates a fresh budget.\n   *\n   * For monitoring purposes, prefer using the `lastBudget` getter or\n   * subscribing to the `budget:updated` event for reactive updates.\n   *\n   * @returns Current token budget breakdown\n   */\n  async calculateBudget(): Promise<ContextBudget> {\n    this.assertNotDestroyed();\n\n    // Return cached budget if available (from last prepare() call)\n    if (this._cachedBudget) {\n      return this._cachedBudget;\n    }\n\n    // No cached budget yet - calculate fresh (this happens before first prepare() call)\n    const toolsTokens = this.calculateToolsTokens();\n    const { systemTokens, breakdown } = await this.buildSystemMessage();\n    const conversationTokens = this.calculateConversationTokens();\n    const currentInputTokens = this.calculateInputTokens(this._currentInput);\n    const totalUsed = systemTokens + conversationTokens + currentInputTokens + toolsTokens;\n    const availableForContent = this._maxContextTokens - this._config.responseReserve;\n\n    return {\n      maxTokens: this._maxContextTokens,\n      responseReserve: this._config.responseReserve,\n      systemMessageTokens: systemTokens,\n      toolsTokens,\n      conversationTokens,\n      currentInputTokens,\n      totalUsed,\n      available: availableForContent - totalUsed,\n      utilizationPercent: (totalUsed / availableForContent) * 100,\n      breakdown: {\n        ...breakdown,\n        tools: toolsTokens,\n        conversation: conversationTokens,\n        currentInput: currentInputTokens,\n      },\n    };\n  }\n\n  /**\n   * Get the current strategy threshold (percentage at which compaction triggers).\n   */\n  get strategyThreshold(): number {\n    return this._compactionStrategy.threshold;\n  }\n\n  /**\n   * Get the current strategy name.\n   */\n  get strategy(): string {\n    return this._compactionStrategy.name;\n  }\n\n  /**\n   * Get a complete, serializable snapshot of the context state.\n   *\n   * Returns all data needed by UI \"Look Inside\" panels without reaching\n   * into plugin internals. Plugin data is auto-discovered from the plugin\n   * registry  new/custom plugins appear automatically.\n   *\n   * @param toolStats - Optional tool usage stats (from ToolManager.getStats())\n   * @returns Serializable context snapshot\n   */\n  async getSnapshot(toolStats?: { mostUsed?: Array<{ name: string; count: number }> }): Promise<IContextSnapshot> {\n    // Helper to ensure plugin contents are JSON-serializable (Maps  arrays, await Promises)\n    const resolveContents = async (raw: unknown): Promise<unknown> => {\n      // Await if getContents() returned a Promise (e.g., WorkingMemory)\n      const resolved = raw instanceof Promise ? await raw : raw;\n      // Convert Maps to arrays for JSON transport (Meteor DDP, etc.)\n      if (resolved instanceof Map) return Array.from(resolved.values());\n      return resolved;\n    };\n    if (this._destroyed) {\n      const emptyBudget: ContextBudget = this._cachedBudget ?? {\n        maxTokens: this._maxContextTokens,\n        responseReserve: this._config.responseReserve,\n        systemMessageTokens: 0,\n        toolsTokens: 0,\n        conversationTokens: 0,\n        currentInputTokens: 0,\n        totalUsed: 0,\n        available: this._maxContextTokens - this._config.responseReserve,\n        utilizationPercent: 0,\n        breakdown: {\n          systemPrompt: 0,\n          persistentInstructions: 0,\n          pluginInstructions: 0,\n          pluginContents: {},\n          tools: 0,\n          conversation: 0,\n          currentInput: 0,\n        },\n      };\n      return {\n        available: false,\n        agentId: this._agentId,\n        model: this._config.model,\n        features: this._config.features,\n        budget: emptyBudget,\n        strategy: this._compactionStrategy.name,\n        messagesCount: 0,\n        toolCallsCount: 0,\n        systemPrompt: null,\n        plugins: [],\n        tools: [],\n      };\n    }\n\n    const budget = await this.calculateBudget();\n\n    // Build plugin snapshots from registry (auto-discovery)\n    const plugins: IPluginSnapshot[] = [];\n    for (const plugin of this._plugins.values()) {\n      let formattedContent: string | null = null;\n      try {\n        formattedContent = await plugin.getContent();\n      } catch {\n        // Plugin content may fail  don't break snapshot\n      }\n\n      plugins.push({\n        name: plugin.name,\n        displayName: formatPluginDisplayName(plugin.name),\n        enabled: true,\n        tokenSize: plugin.getTokenSize(),\n        instructionsTokenSize: plugin.getInstructionsTokenSize(),\n        compactable: plugin.isCompactable(),\n        contents: await resolveContents(plugin.getContents()),\n        formattedContent,\n      });\n    }\n\n    // Build tool snapshots\n    const usageCounts = new Map<string, number>();\n    if (toolStats?.mostUsed) {\n      for (const { name, count } of toolStats.mostUsed) {\n        usageCounts.set(name, count);\n      }\n    }\n\n    const tools: IToolSnapshot[] = [];\n    for (const toolName of this._tools.list()) {\n      const reg = this._tools.getRegistration(toolName);\n      if (!reg) continue;\n\n      tools.push({\n        name: toolName,\n        description: reg.tool.definition.function.description || '',\n        enabled: reg.enabled,\n        callCount: reg.metadata.usageCount ?? usageCounts.get(toolName) ?? 0,\n        namespace: reg.namespace || undefined,\n      });\n    }\n\n    // Count tool calls in conversation\n    let toolCallsCount = 0;\n    for (const item of this._conversation) {\n      if (item.type === 'message' && item.role === MessageRole.ASSISTANT) {\n        for (const c of item.content) {\n          if (c.type === ContentType.TOOL_USE) toolCallsCount++;\n        }\n      }\n    }\n\n    return {\n      available: true,\n      agentId: this._agentId,\n      model: this._config.model,\n      features: this._config.features,\n      budget,\n      strategy: this._compactionStrategy.name,\n      messagesCount: this._conversation.length,\n      toolCallsCount,\n      systemPrompt: this._systemPrompt ?? null,\n      plugins,\n      tools,\n    };\n  }\n\n  /**\n   * Get a human-readable breakdown of the prepared context.\n   *\n   * Calls `prepare()` internally, then maps each InputItem to a named\n   * component with content text and token estimate. Used by \"View Full Context\" UIs.\n   *\n   * @returns View context data with components and raw text for \"Copy All\"\n   */\n  async getViewContext(): Promise<IViewContextData> {\n    if (this._destroyed) {\n      return { available: false, components: [], totalTokens: 0, rawContext: '' };\n    }\n\n    const { input, budget } = await this.prepare();\n\n    const components: IViewContextComponent[] = [];\n    let rawParts: string[] = [];\n\n    for (const item of input) {\n      if (item.type === 'compaction') {\n        components.push({\n          name: 'Compaction Block',\n          content: '[Compacted content]',\n          tokenEstimate: 0,\n        });\n        continue;\n      }\n\n      // item.type === 'message'\n      const msg = item;\n      const roleName = msg.role === MessageRole.DEVELOPER\n        ? 'System Message'\n        : msg.role === MessageRole.USER\n          ? 'User Message'\n          : 'Assistant Message';\n\n      // Process each content block\n      for (const block of msg.content) {\n        let name = roleName;\n        let text = '';\n\n        switch (block.type) {\n          case ContentType.INPUT_TEXT:\n            text = block.text;\n            break;\n          case ContentType.OUTPUT_TEXT:\n            text = block.text;\n            break;\n          case ContentType.TOOL_USE:\n            name = `Tool Call: ${block.name}`;\n            text = `${block.name}(${block.arguments})`;\n            break;\n          case ContentType.TOOL_RESULT:\n            name = `Tool Result: ${block.tool_use_id}`;\n            text = typeof block.content === 'string'\n              ? block.content\n              : JSON.stringify(block.content, null, 2);\n            if (block.error) text = `[Error] ${block.error}\\n${text}`;\n            break;\n          case ContentType.INPUT_IMAGE_URL:\n            name = 'Image Input';\n            text = `[Image: ${block.image_url.url.substring(0, 100)}...]`;\n            break;\n          case ContentType.INPUT_FILE:\n            name = 'File Input';\n            text = `[File: ${block.file_id}]`;\n            break;\n          case ContentType.THINKING:\n            name = 'Thinking';\n            text = (block as any).thinking || '';\n            break;\n        }\n\n        const tokenEstimate = this._estimator.estimateTokens(text);\n        components.push({ name, content: text, tokenEstimate });\n        rawParts.push(`--- ${name} ---\\n${text}`);\n      }\n    }\n\n    return {\n      available: true,\n      components,\n      totalTokens: budget.totalUsed,\n      rawContext: rawParts.join('\\n\\n'),\n    };\n  }\n\n  // ============================================================================\n  // Utilities\n  // ============================================================================\n\n  /**\n   * Generate unique ID.\n   */\n  private generateId(): string {\n    return `${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\n  }\n\n  /**\n   * Assert context is not destroyed.\n   */\n  private assertNotDestroyed(): void {\n    if (this._destroyed) {\n      throw new Error('AgentContextNextGen is destroyed');\n    }\n  }\n\n  // ============================================================================\n  // Cleanup\n  // ============================================================================\n\n  /**\n   * Destroy context and release resources.\n   */\n  destroy(): void {\n    if (this._destroyed) return;\n\n    // Destroy plugins\n    for (const plugin of this._plugins.values()) {\n      plugin.destroy();\n    }\n    this._plugins.clear();\n\n    // Destroy tool manager\n    this._tools.destroy();\n\n    // Clear state\n    this._conversation = [];\n    this._currentInput = [];\n\n    this.removeAllListeners();\n    this._destroyed = true;\n  }\n}\n","/**\n * Supported AI Vendors\n *\n * Use this enum instead of string literals for type safety.\n * These map to specific provider implementations.\n */\nexport const Vendor = {\n  OpenAI: 'openai',\n  Anthropic: 'anthropic',\n  Google: 'google',\n  GoogleVertex: 'google-vertex',\n  Groq: 'groq',\n  Together: 'together',\n  Perplexity: 'perplexity',\n  Grok: 'grok',\n  DeepSeek: 'deepseek',\n  Mistral: 'mistral',\n  Ollama: 'ollama',\n  Custom: 'custom', // OpenAI-compatible endpoint\n} as const;\n\nexport type Vendor = (typeof Vendor)[keyof typeof Vendor];\n\n/**\n * All vendor values as array (useful for validation)\n */\nexport const VENDORS = Object.values(Vendor);\n\n/**\n * Check if a string is a valid vendor\n */\nexport function isVendor(value: string): value is Vendor {\n  return VENDORS.includes(value as Vendor);\n}\n","import { Vendor } from '../../core/Vendor.js';\nimport type { Vendor as VendorType } from '../../core/Vendor.js';\n\n/**\n * Complete description of an LLM model including capabilities, pricing, and features\n */\nexport interface ILLMDescription {\n  /** Model identifier (e.g., \"gpt-5.2-instant\") */\n  name: string;\n\n  /** Vendor/provider (Vendor.OpenAI, Vendor.Anthropic, etc.) */\n  provider: string;\n\n  /** Optional description of the model */\n  description?: string;\n\n  /** Whether the model is currently available for use */\n  isActive: boolean;\n\n  /** Release date (YYYY-MM-DD format) */\n  releaseDate?: string;\n\n  /** Knowledge cutoff date */\n  knowledgeCutoff?: string;\n\n  /** Model capabilities and pricing */\n  features: {\n    /** Supports extended reasoning/thinking */\n    reasoning?: boolean;\n\n    /** Supports streaming responses */\n    streaming: boolean;\n\n    /** Supports structured output (JSON mode) */\n    structuredOutput?: boolean;\n\n    /** Supports function/tool calling */\n    functionCalling?: boolean;\n\n    /** Supports fine-tuning */\n    fineTuning?: boolean;\n\n    /** Supports predicted outputs */\n    predictedOutputs?: boolean;\n\n    /** Supports realtime API */\n    realtime?: boolean;\n\n    /** Supports image input (vision) */\n    vision?: boolean;\n\n    /** Supports audio input/output */\n    audio?: boolean;\n\n    /** Supports video input */\n    video?: boolean;\n\n    /** Supports extended thinking (Claude-specific) */\n    extendedThinking?: boolean;\n\n    /** Supports batch API */\n    batchAPI?: boolean;\n\n    /** Supports prompt caching */\n    promptCaching?: boolean;\n\n    /** Parameter support - indicates which sampling parameters are supported */\n    parameters?: {\n      /** Supports temperature parameter */\n      temperature?: boolean;\n      /** Supports top_p parameter */\n      topP?: boolean;\n      /** Supports frequency_penalty parameter */\n      frequencyPenalty?: boolean;\n      /** Supports presence_penalty parameter */\n      presencePenalty?: boolean;\n    };\n\n    /** Input specifications */\n    input: {\n      /** Maximum input context window (in tokens) */\n      tokens: number;\n\n      /** Supports text input */\n      text: boolean;\n\n      /** Supports image input */\n      image?: boolean;\n\n      /** Supports audio input */\n      audio?: boolean;\n\n      /** Supports video input */\n      video?: boolean;\n\n      /** Cost per million tokens (input) */\n      cpm: number;\n\n      /** Cost per million cached tokens (if prompt caching supported) */\n      cpmCached?: number;\n    };\n\n    /** Output specifications */\n    output: {\n      /** Maximum output tokens */\n      tokens: number;\n\n      /** Supports text output */\n      text: boolean;\n\n      /** Supports image output */\n      image?: boolean;\n\n      /** Supports audio output */\n      audio?: boolean;\n\n      /** Cost per million tokens (output) */\n      cpm: number;\n    };\n  };\n}\n\n/**\n * Model name constants organized by vendor\n * Updated: January 2026 - Contains only verified, currently available models\n */\nexport const LLM_MODELS = {\n  [Vendor.OpenAI]: {\n    // GPT-5.2 Series (Current Flagship)\n    GPT_5_2: 'gpt-5.2',\n    GPT_5_2_PRO: 'gpt-5.2-pro',\n    // GPT-5 Series\n    GPT_5: 'gpt-5',\n    GPT_5_MINI: 'gpt-5-mini',\n    GPT_5_NANO: 'gpt-5-nano',\n    // GPT-4.1 Series\n    GPT_4_1: 'gpt-4.1',\n    GPT_4_1_MINI: 'gpt-4.1-mini',\n    GPT_4_1_NANO: 'gpt-4.1-nano',\n    // GPT-4o Series (Legacy, Audio Capable)\n    GPT_4O: 'gpt-4o',\n    GPT_4O_MINI: 'gpt-4o-mini',\n    // Reasoning Models (o-series)\n    O3_MINI: 'o3-mini',\n    O1: 'o1',\n  },\n  [Vendor.Anthropic]: {\n    // Claude 4.5 Series (Current)\n    CLAUDE_OPUS_4_5: 'claude-opus-4-5-20251101',\n    CLAUDE_SONNET_4_5: 'claude-sonnet-4-5-20250929',\n    CLAUDE_HAIKU_4_5: 'claude-haiku-4-5-20251001',\n    // Claude 4.x Legacy\n    CLAUDE_OPUS_4_1: 'claude-opus-4-1-20250805',\n    CLAUDE_SONNET_4: 'claude-sonnet-4-20250514',\n    CLAUDE_SONNET_3_7: 'claude-3-7-sonnet-20250219',\n    // Claude 3.x Legacy\n    CLAUDE_HAIKU_3: 'claude-3-haiku-20240307',\n  },\n  [Vendor.Google]: {\n    // Gemini 3 Series (Preview)\n    GEMINI_3_FLASH_PREVIEW: 'gemini-3-flash-preview',\n    GEMINI_3_PRO_PREVIEW: 'gemini-3-pro-preview',\n    GEMINI_3_PRO_IMAGE_PREVIEW: 'gemini-3-pro-image-preview',\n    // Gemini 2.5 Series (Production)\n    GEMINI_2_5_PRO: 'gemini-2.5-pro',\n    GEMINI_2_5_FLASH: 'gemini-2.5-flash',\n    GEMINI_2_5_FLASH_LITE: 'gemini-2.5-flash-lite',\n    GEMINI_2_5_FLASH_IMAGE: 'gemini-2.5-flash-image',\n  },\n  [Vendor.Grok]: {\n    // Grok 4.1 Series (2M context, fast)\n    GROK_4_1_FAST_REASONING: 'grok-4-1-fast-reasoning',\n    GROK_4_1_FAST_NON_REASONING: 'grok-4-1-fast-non-reasoning',\n    // Grok 4 Series\n    GROK_4_FAST_REASONING: 'grok-4-fast-reasoning',\n    GROK_4_FAST_NON_REASONING: 'grok-4-fast-non-reasoning',\n    GROK_4_0709: 'grok-4-0709',\n    // Grok Code\n    GROK_CODE_FAST_1: 'grok-code-fast-1',\n    // Grok 3 Series\n    GROK_3: 'grok-3',\n    GROK_3_MINI: 'grok-3-mini',\n    // Grok 2 Series (Vision)\n    GROK_2_VISION_1212: 'grok-2-vision-1212',\n  },\n} as const;\n\n/**\n * Complete model registry with all model metadata\n * Updated: January 2026 - Verified from official vendor documentation\n */\nexport const MODEL_REGISTRY: Record<string, ILLMDescription> = {\n  // ============================================================================\n  // OpenAI Models (Verified from platform.openai.com)\n  // ============================================================================\n\n  // GPT-5.2 Series (Current Flagship)\n  'gpt-5.2': {\n    name: 'gpt-5.2',\n    provider: Vendor.OpenAI,\n    description: 'Flagship model for coding and agentic tasks. Reasoning.effort: none, low, medium, high, xhigh',\n    isActive: true,\n    releaseDate: '2025-12-01',\n    knowledgeCutoff: '2025-08-31',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 400000,\n        text: true,\n        image: true,\n        cpm: 1.75,\n      },\n      output: {\n        tokens: 128000,\n        text: true,\n        cpm: 14,\n      },\n    },\n  },\n\n  'gpt-5.2-pro': {\n    name: 'gpt-5.2-pro',\n    provider: Vendor.OpenAI,\n    description: 'GPT-5.2 pro produces smarter and more precise responses. Reasoning.effort: medium, high, xhigh',\n    isActive: true,\n    releaseDate: '2025-12-01',\n    knowledgeCutoff: '2025-08-31',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 400000,\n        text: true,\n        image: true,\n        cpm: 21,\n      },\n      output: {\n        tokens: 128000,\n        text: true,\n        cpm: 168,\n      },\n    },\n  },\n\n  // GPT-5 Series\n  'gpt-5': {\n    name: 'gpt-5',\n    provider: Vendor.OpenAI,\n    description: 'Previous intelligent reasoning model for coding and agentic tasks. Reasoning.effort: minimal, low, medium, high',\n    isActive: true,\n    releaseDate: '2025-08-01',\n    knowledgeCutoff: '2024-09-30',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 400000,\n        text: true,\n        image: true,\n        cpm: 1.25,\n      },\n      output: {\n        tokens: 128000,\n        text: true,\n        cpm: 10,\n      },\n    },\n  },\n\n  'gpt-5-mini': {\n    name: 'gpt-5-mini',\n    provider: Vendor.OpenAI,\n    description: 'Faster, cost-efficient version of GPT-5 for well-defined tasks and precise prompts',\n    isActive: true,\n    releaseDate: '2025-08-01',\n    knowledgeCutoff: '2024-05-31',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 400000,\n        text: true,\n        image: true,\n        cpm: 0.25,\n      },\n      output: {\n        tokens: 128000,\n        text: true,\n        cpm: 2,\n      },\n    },\n  },\n\n  'gpt-5-nano': {\n    name: 'gpt-5-nano',\n    provider: Vendor.OpenAI,\n    description: 'Fastest, most cost-efficient GPT-5. Great for summarization and classification tasks',\n    isActive: true,\n    releaseDate: '2025-08-01',\n    knowledgeCutoff: '2024-05-31',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 400000,\n        text: true,\n        image: true,\n        cpm: 0.05,\n      },\n      output: {\n        tokens: 128000,\n        text: true,\n        cpm: 0.4,\n      },\n    },\n  },\n\n  // GPT-4.1 Series\n  'gpt-4.1': {\n    name: 'gpt-4.1',\n    provider: Vendor.OpenAI,\n    description: 'GPT-4.1 specialized for coding with 1M token context window',\n    isActive: true,\n    releaseDate: '2025-04-14',\n    knowledgeCutoff: '2025-04-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        cpm: 2,\n      },\n      output: {\n        tokens: 32768,\n        text: true,\n        cpm: 8,\n      },\n    },\n  },\n\n  'gpt-4.1-mini': {\n    name: 'gpt-4.1-mini',\n    provider: Vendor.OpenAI,\n    description: 'Efficient GPT-4.1 model, beats GPT-4o in many benchmarks at 83% lower cost',\n    isActive: true,\n    releaseDate: '2025-04-14',\n    knowledgeCutoff: '2025-04-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        cpm: 0.4,\n      },\n      output: {\n        tokens: 16384,\n        text: true,\n        cpm: 1.6,\n      },\n    },\n  },\n\n  'gpt-4.1-nano': {\n    name: 'gpt-4.1-nano',\n    provider: Vendor.OpenAI,\n    description: 'Fastest and cheapest model with 1M context. 80.1% MMLU, ideal for classification/autocompletion',\n    isActive: true,\n    releaseDate: '2025-04-14',\n    knowledgeCutoff: '2025-04-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        cpm: 0.1,\n      },\n      output: {\n        tokens: 16384,\n        text: true,\n        cpm: 0.4,\n      },\n    },\n  },\n\n  // GPT-4o Series (Legacy, Audio Capable)\n  'gpt-4o': {\n    name: 'gpt-4o',\n    provider: Vendor.OpenAI,\n    description: 'Versatile omni model with audio support. Legacy but still available',\n    isActive: true,\n    releaseDate: '2024-05-13',\n    knowledgeCutoff: '2024-04-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: true,\n      realtime: true,\n      vision: true,\n      audio: true,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 128000,\n        text: true,\n        image: true,\n        audio: true,\n        cpm: 2.5,\n      },\n      output: {\n        tokens: 16384,\n        text: true,\n        audio: true,\n        cpm: 10,\n      },\n    },\n  },\n\n  'gpt-4o-mini': {\n    name: 'gpt-4o-mini',\n    provider: Vendor.OpenAI,\n    description: 'Fast, affordable omni model with audio support',\n    isActive: true,\n    releaseDate: '2024-07-18',\n    knowledgeCutoff: '2024-04-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: true,\n      predictedOutputs: false,\n      realtime: true,\n      vision: true,\n      audio: true,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 128000,\n        text: true,\n        image: true,\n        audio: true,\n        cpm: 0.15,\n      },\n      output: {\n        tokens: 16384,\n        text: true,\n        audio: true,\n        cpm: 0.6,\n      },\n    },\n  },\n\n  // Reasoning Models (o-series)\n  'o3-mini': {\n    name: 'o3-mini',\n    provider: Vendor.OpenAI,\n    description: 'Fast reasoning model tailored for coding, math, and science',\n    isActive: true,\n    releaseDate: '2025-01-31',\n    knowledgeCutoff: '2024-10-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: false,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 1.1,\n      },\n      output: {\n        tokens: 100000,\n        text: true,\n        cpm: 4.4,\n      },\n    },\n  },\n\n  'o1': {\n    name: 'o1',\n    provider: Vendor.OpenAI,\n    description: 'Advanced reasoning model for complex problems',\n    isActive: true,\n    releaseDate: '2024-12-17',\n    knowledgeCutoff: '2024-10-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: false,\n      parameters: {\n        temperature: false,\n        topP: false,\n        frequencyPenalty: false,\n        presencePenalty: false,\n      },\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 15,\n      },\n      output: {\n        tokens: 100000,\n        text: true,\n        cpm: 60,\n      },\n    },\n  },\n\n  // ============================================================================\n  // Anthropic Models (Verified from platform.claude.com)\n  // ============================================================================\n\n  // Claude 4.5 Series (Current)\n  'claude-opus-4-5-20251101': {\n    name: 'claude-opus-4-5-20251101',\n    provider: Vendor.Anthropic,\n    description: 'Premium model combining maximum intelligence with practical performance',\n    isActive: true,\n    releaseDate: '2025-11-01',\n    knowledgeCutoff: '2025-05-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 5,\n        cpmCached: 0.5,\n      },\n      output: {\n        tokens: 64000,\n        text: true,\n        cpm: 25,\n      },\n    },\n  },\n\n  'claude-sonnet-4-5-20250929': {\n    name: 'claude-sonnet-4-5-20250929',\n    provider: Vendor.Anthropic,\n    description: 'Smart model for complex agents and coding. Best balance of intelligence, speed, cost',\n    isActive: true,\n    releaseDate: '2025-09-29',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 3,\n        cpmCached: 0.3,\n      },\n      output: {\n        tokens: 64000,\n        text: true,\n        cpm: 15,\n      },\n    },\n  },\n\n  'claude-haiku-4-5-20251001': {\n    name: 'claude-haiku-4-5-20251001',\n    provider: Vendor.Anthropic,\n    description: 'Fastest model with near-frontier intelligence. Matches Sonnet 4 on coding',\n    isActive: true,\n    releaseDate: '2025-10-01',\n    knowledgeCutoff: '2025-02-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 1,\n        cpmCached: 0.1,\n      },\n      output: {\n        tokens: 64000,\n        text: true,\n        cpm: 5,\n      },\n    },\n  },\n\n  // Claude 4.x Legacy\n  'claude-opus-4-1-20250805': {\n    name: 'claude-opus-4-1-20250805',\n    provider: Vendor.Anthropic,\n    description: 'Legacy Opus 4.1 focused on agentic tasks, real-world coding, and reasoning',\n    isActive: true,\n    releaseDate: '2025-08-05',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 15,\n        cpmCached: 1.5,\n      },\n      output: {\n        tokens: 32000,\n        text: true,\n        cpm: 75,\n      },\n    },\n  },\n\n  'claude-sonnet-4-20250514': {\n    name: 'claude-sonnet-4-20250514',\n    provider: Vendor.Anthropic,\n    description: 'Legacy Sonnet 4. Default for most users, supports 1M context beta',\n    isActive: true,\n    releaseDate: '2025-05-14',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000, // 1M with beta header\n        text: true,\n        image: true,\n        cpm: 3,\n        cpmCached: 0.3,\n      },\n      output: {\n        tokens: 64000,\n        text: true,\n        cpm: 15,\n      },\n    },\n  },\n\n  'claude-3-7-sonnet-20250219': {\n    name: 'claude-3-7-sonnet-20250219',\n    provider: Vendor.Anthropic,\n    description: 'Claude 3.7 Sonnet with extended thinking, supports 128K output beta',\n    isActive: true,\n    releaseDate: '2025-02-19',\n    knowledgeCutoff: '2024-10-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 3,\n        cpmCached: 0.3,\n      },\n      output: {\n        tokens: 64000, // 128K with beta header\n        text: true,\n        cpm: 15,\n      },\n    },\n  },\n\n  // Claude 3.x Legacy\n  'claude-3-haiku-20240307': {\n    name: 'claude-3-haiku-20240307',\n    provider: Vendor.Anthropic,\n    description: 'Fast legacy model. Recommend migrating to Haiku 4.5',\n    isActive: true,\n    releaseDate: '2024-03-07',\n    knowledgeCutoff: '2023-08-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      extendedThinking: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 200000,\n        text: true,\n        image: true,\n        cpm: 0.25,\n        cpmCached: 0.03,\n      },\n      output: {\n        tokens: 4096,\n        text: true,\n        cpm: 1.25,\n      },\n    },\n  },\n\n  // ============================================================================\n  // Google Models (Verified from ai.google.dev)\n  // ============================================================================\n\n  // Gemini 3 Series (Preview)\n  'gemini-3-flash-preview': {\n    name: 'gemini-3-flash-preview',\n    provider: Vendor.Google,\n    description: 'Pro-grade reasoning with Flash-level latency and efficiency',\n    isActive: true,\n    releaseDate: '2025-11-18',\n    knowledgeCutoff: '2025-08-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: true,\n      video: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        audio: true,\n        video: true,\n        cpm: 0.15,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.6,\n      },\n    },\n  },\n\n  'gemini-3-pro-preview': {\n    name: 'gemini-3-pro-preview',\n    provider: Vendor.Google,\n    description: 'Most advanced reasoning Gemini model for complex tasks',\n    isActive: true,\n    releaseDate: '2025-11-18',\n    knowledgeCutoff: '2025-08-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: true,\n      video: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        audio: true,\n        video: true,\n        cpm: 1.25,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 10,\n      },\n    },\n  },\n\n  'gemini-3-pro-image-preview': {\n    name: 'gemini-3-pro-image-preview',\n    provider: Vendor.Google,\n    description: 'Highest quality image generation model',\n    isActive: true,\n    releaseDate: '2025-11-18',\n    knowledgeCutoff: '2025-08-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: false,\n      functionCalling: false,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        cpm: 1.25,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        image: true,\n        cpm: 10,\n      },\n    },\n  },\n\n  // Gemini 2.5 Series (Production)\n  'gemini-2.5-pro': {\n    name: 'gemini-2.5-pro',\n    provider: Vendor.Google,\n    description: 'Advanced multimodal model built for deep reasoning and agents',\n    isActive: true,\n    releaseDate: '2025-03-01',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: true,\n      video: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        audio: true,\n        video: true,\n        cpm: 1.25,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 10,\n      },\n    },\n  },\n\n  'gemini-2.5-flash': {\n    name: 'gemini-2.5-flash',\n    provider: Vendor.Google,\n    description: 'Fast, cost-effective model with excellent reasoning',\n    isActive: true,\n    releaseDate: '2025-06-17',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: true,\n      video: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        audio: true,\n        video: true,\n        cpm: 0.15,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.6,\n      },\n    },\n  },\n\n  'gemini-2.5-flash-lite': {\n    name: 'gemini-2.5-flash-lite',\n    provider: Vendor.Google,\n    description: 'Lowest latency for high-volume tasks, summarization, classification',\n    isActive: true,\n    releaseDate: '2025-06-17',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: true,\n      video: true,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        audio: true,\n        video: true,\n        cpm: 0.075,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.3,\n      },\n    },\n  },\n\n  'gemini-2.5-flash-image': {\n    name: 'gemini-2.5-flash-image',\n    provider: Vendor.Google,\n    description: 'Image generation and editing model',\n    isActive: true,\n    releaseDate: '2025-09-01',\n    knowledgeCutoff: '2025-01-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: false,\n      functionCalling: false,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: true,\n      promptCaching: true,\n      input: {\n        tokens: 1000000,\n        text: true,\n        image: true,\n        cpm: 0.15,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        image: true,\n        cpm: 0.6,\n      },\n    },\n  },\n\n  // ============================================================================\n  // xAI Grok Models (Verified from docs.x.ai - January 2026)\n  // ============================================================================\n\n  // Grok 4.1 Series (2M context, fast)\n  'grok-4-1-fast-reasoning': {\n    name: 'grok-4-1-fast-reasoning',\n    provider: Vendor.Grok,\n    description: 'Fast Grok 4.1 with reasoning capabilities, 2M context window, vision support',\n    isActive: true,\n    releaseDate: '2025-11-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 2000000,\n        text: true,\n        image: true,\n        cpm: 0.20,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.50,\n      },\n    },\n  },\n\n  'grok-4-1-fast-non-reasoning': {\n    name: 'grok-4-1-fast-non-reasoning',\n    provider: Vendor.Grok,\n    description: 'Fast Grok 4.1 without reasoning, 2M context window, vision support',\n    isActive: true,\n    releaseDate: '2025-11-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 2000000,\n        text: true,\n        image: true,\n        cpm: 0.20,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.50,\n      },\n    },\n  },\n\n  // Grok Code Series\n  'grok-code-fast-1': {\n    name: 'grok-code-fast-1',\n    provider: Vendor.Grok,\n    description: 'Specialized coding model with reasoning capabilities, 256K context',\n    isActive: true,\n    releaseDate: '2025-10-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: false,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 256000,\n        text: true,\n        cpm: 0.20,\n      },\n      output: {\n        tokens: 32768,\n        text: true,\n        cpm: 1.50,\n      },\n    },\n  },\n\n  // Grok 4 Series\n  'grok-4-fast-reasoning': {\n    name: 'grok-4-fast-reasoning',\n    provider: Vendor.Grok,\n    description: 'Fast Grok 4 with reasoning capabilities, 2M context window',\n    isActive: true,\n    releaseDate: '2025-09-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: true,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: false,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 2000000,\n        text: true,\n        cpm: 0.20,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.50,\n      },\n    },\n  },\n\n  'grok-4-fast-non-reasoning': {\n    name: 'grok-4-fast-non-reasoning',\n    provider: Vendor.Grok,\n    description: 'Fast Grok 4 without reasoning, 2M context window, vision support',\n    isActive: true,\n    releaseDate: '2025-09-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 2000000,\n        text: true,\n        image: true,\n        cpm: 0.20,\n      },\n      output: {\n        tokens: 65536,\n        text: true,\n        cpm: 0.50,\n      },\n    },\n  },\n\n  'grok-4-0709': {\n    name: 'grok-4-0709',\n    provider: Vendor.Grok,\n    description: 'Grok 4 flagship model (July 2025 release), 256K context, vision support',\n    isActive: true,\n    releaseDate: '2025-07-09',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 256000,\n        text: true,\n        image: true,\n        cpm: 3.00,\n      },\n      output: {\n        tokens: 32768,\n        text: true,\n        cpm: 15.00,\n      },\n    },\n  },\n\n  // Grok 3 Series\n  'grok-3-mini': {\n    name: 'grok-3-mini',\n    provider: Vendor.Grok,\n    description: 'Lightweight, cost-efficient model for simpler tasks, 131K context',\n    isActive: true,\n    releaseDate: '2025-06-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: false,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 131072,\n        text: true,\n        cpm: 0.30,\n      },\n      output: {\n        tokens: 32768,\n        text: true,\n        cpm: 0.50,\n      },\n    },\n  },\n\n  'grok-3': {\n    name: 'grok-3',\n    provider: Vendor.Grok,\n    description: 'Production model for general-purpose tasks, 131K context',\n    isActive: true,\n    releaseDate: '2025-06-01',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: false,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 131072,\n        text: true,\n        cpm: 3.00,\n      },\n      output: {\n        tokens: 32768,\n        text: true,\n        cpm: 15.00,\n      },\n    },\n  },\n\n  // Grok 2 Series (Vision)\n  'grok-2-vision-1212': {\n    name: 'grok-2-vision-1212',\n    provider: Vendor.Grok,\n    description: 'Vision-capable model for image understanding, 32K context',\n    isActive: true,\n    releaseDate: '2024-12-12',\n    knowledgeCutoff: '2024-11-01',\n    features: {\n      reasoning: false,\n      streaming: true,\n      structuredOutput: true,\n      functionCalling: true,\n      fineTuning: false,\n      predictedOutputs: false,\n      realtime: false,\n      vision: true,\n      audio: false,\n      video: false,\n      batchAPI: false,\n      promptCaching: false,\n      input: {\n        tokens: 32768,\n        text: true,\n        image: true,\n        cpm: 2.00,\n      },\n      output: {\n        tokens: 8192,\n        text: true,\n        cpm: 10.00,\n      },\n    },\n  },\n};\n\n/**\n * Get model information by name\n * @param modelName The model identifier\n * @returns Model description or undefined if not found\n */\nexport function getModelInfo(modelName: string): ILLMDescription | undefined {\n  return MODEL_REGISTRY[modelName];\n}\n\n/**\n * Get all models for a specific vendor\n * @param vendor The vendor to filter by\n * @returns Array of model descriptions for the vendor\n */\nexport function getModelsByVendor(vendor: VendorType): ILLMDescription[] {\n  return Object.values(MODEL_REGISTRY).filter((model) => model.provider === vendor);\n}\n\n/**\n * Get all currently active models\n * @returns Array of active model descriptions\n */\nexport function getActiveModels(): ILLMDescription[] {\n  return Object.values(MODEL_REGISTRY).filter((model) => model.isActive);\n}\n\n/**\n * Calculate the cost for a given model and token usage\n * @param model Model name\n * @param inputTokens Number of input tokens\n * @param outputTokens Number of output tokens\n * @param options Optional calculation options\n * @returns Total cost in dollars, or null if model not found\n */\nexport function calculateCost(\n  model: string,\n  inputTokens: number,\n  outputTokens: number,\n  options?: { useCachedInput?: boolean }\n): number | null {\n  const modelInfo = getModelInfo(model);\n  if (!modelInfo) {\n    return null;\n  }\n\n  const inputCPM = options?.useCachedInput && modelInfo.features.input.cpmCached !== undefined\n    ? modelInfo.features.input.cpmCached\n    : modelInfo.features.input.cpm;\n\n  const outputCPM = modelInfo.features.output.cpm;\n\n  const inputCost = (inputTokens / 1_000_000) * inputCPM;\n  const outputCost = (outputTokens / 1_000_000) * outputCPM;\n\n  return inputCost + outputCost;\n}\n","/**\n * Message entity based on OpenAI Responses API format\n */\n\nimport { Content } from './Content.js';\n\nexport enum MessageRole {\n  USER = 'user',\n  ASSISTANT = 'assistant',\n  DEVELOPER = 'developer', // Responses API uses \"developer\" instead of \"system\"\n}\n\nexport interface Message {\n  type: 'message';\n  id?: string;\n  role: MessageRole;\n  content: Content[]; // Always an array in Responses API\n}\n\nexport interface CompactionItem {\n  type: 'compaction';\n  id: string;\n  encrypted_content: string;\n}\n\nexport interface ReasoningItem {\n  type: 'reasoning';\n  id: string;\n  effort?: 'low' | 'medium' | 'high';\n  summary?: string;\n  encrypted_content?: string; // For o-series models\n}\n\nexport type InputItem = Message | CompactionItem;\nexport type OutputItem = Message | CompactionItem | ReasoningItem;\n","/**\n * Content types based on OpenAI Responses API format\n */\n\nexport enum ContentType {\n  INPUT_TEXT = 'input_text',\n  INPUT_IMAGE_URL = 'input_image_url',\n  INPUT_FILE = 'input_file',\n  OUTPUT_TEXT = 'output_text',\n  TOOL_USE = 'tool_use',\n  TOOL_RESULT = 'tool_result',\n  THINKING = 'thinking',\n}\n\nexport interface BaseContent {\n  type: ContentType;\n}\n\nexport interface InputTextContent extends BaseContent {\n  type: ContentType.INPUT_TEXT;\n  text: string;\n}\n\nexport interface InputImageContent extends BaseContent {\n  type: ContentType.INPUT_IMAGE_URL;\n  image_url: {\n    url: string; // HTTP URL or data URI\n    detail?: 'auto' | 'low' | 'high';\n  };\n}\n\nexport interface InputFileContent extends BaseContent {\n  type: ContentType.INPUT_FILE;\n  file_id: string;\n}\n\nexport interface OutputTextContent extends BaseContent {\n  type: ContentType.OUTPUT_TEXT;\n  text: string;\n  annotations?: any[];\n}\n\nexport interface ToolUseContent extends BaseContent {\n  type: ContentType.TOOL_USE;\n  id: string;\n  name: string;\n  arguments: string; // JSON string\n}\n\nexport interface ToolResultContent extends BaseContent {\n  type: ContentType.TOOL_RESULT;\n  tool_use_id: string;\n  content: string | any;\n  error?: string;\n  /**\n   * Images extracted from tool results via the __images convention.\n   * Stored separately from `content` so they don't inflate text-based token counts.\n   * Provider converters read this field to inject native multimodal image blocks.\n   */\n  __images?: Array<{ base64: string; mediaType: string }>;\n}\n\nexport interface ThinkingContent extends BaseContent {\n  type: ContentType.THINKING;\n  thinking: string;\n  /** Anthropic's opaque signature for round-tripping thinking blocks */\n  signature?: string;\n  /** Whether this thinking block should be persisted in conversation history.\n   *  Anthropic requires it (true), OpenAI/Google do not (false). */\n  persistInHistory: boolean;\n}\n\nexport type Content =\n  | InputTextContent\n  | InputImageContent\n  | InputFileContent\n  | OutputTextContent\n  | ToolUseContent\n  | ToolResultContent\n  | ThinkingContent;\n","/**\n * BasePluginNextGen - Base class for context plugins\n *\n * Provides common functionality:\n * - Token size tracking with caching\n * - Default implementations for optional methods\n * - Simple token estimation\n */\n\nimport type { IContextPluginNextGen, ITokenEstimator } from './types.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport { TOKEN_ESTIMATION } from '../constants.js';\n\n/**\n * Simple token estimator used by plugins.\n *\n * Uses character-based approximation (~3.5 chars/token) which is\n * accurate enough for budget management purposes. For precise\n * tokenization, you can provide a custom estimator via the\n * `estimator` protected property.\n *\n * @example\n * ```typescript\n * const tokens = simpleTokenEstimator.estimateTokens(\"Hello world\");\n * // ~4 tokens\n *\n * const dataTokens = simpleTokenEstimator.estimateDataTokens({ key: \"value\" });\n * // Stringifies and estimates\n * ```\n */\nexport const simpleTokenEstimator: ITokenEstimator = {\n  estimateTokens(text: string): number {\n    if (!text || text.length === 0) return 0;\n    return Math.ceil(text.length / TOKEN_ESTIMATION.MIXED_CHARS_PER_TOKEN);\n  },\n\n  estimateDataTokens(data: unknown): number {\n    const text = typeof data === 'string' ? data : JSON.stringify(data);\n    return this.estimateTokens(text);\n  },\n\n  estimateImageTokens(width?: number, height?: number, detail?: string): number {\n    // Low detail images are always ~85 tokens (OpenAI pricing model)\n    if (detail === 'low') return 85;\n\n    // If dimensions known, use tile-based estimation (OpenAI model):\n    // 85 base + 170 per 512x512 tile\n    if (width && height) {\n      const tiles = Math.ceil(width / 512) * Math.ceil(height / 512);\n      return 85 + 170 * tiles;\n    }\n\n    // Unknown dimensions  conservative default\n    return 1000;\n  },\n};\n\n/**\n * Base class for NextGen context plugins.\n *\n * Provides:\n * - **Token cache management** - `invalidateTokenCache()`, `updateTokenCache()`, `recalculateTokenCache()`\n * - **Simple token estimator** - `this.estimator` (can be overridden)\n * - **Default implementations** - for optional interface methods\n *\n * ## Implementing a Plugin\n *\n * ```typescript\n * class MyPlugin extends BasePluginNextGen {\n *   readonly name = 'my_plugin';\n *   private _data = new Map<string, string>();\n *\n *   // 1. Return static instructions (cached automatically)\n *   getInstructions(): string {\n *     return '## My Plugin\\n\\nUse my_plugin_set to store data...';\n *   }\n *\n *   // 2. Return formatted content (update token cache!)\n *   async getContent(): Promise<string | null> {\n *     if (this._data.size === 0) return null;\n *     const content = this.formatEntries();\n *     this.updateTokenCache(this.estimator.estimateTokens(content));\n *     return content;\n *   }\n *\n *   // 3. Return raw data for inspection\n *   getContents(): unknown {\n *     return Object.fromEntries(this._data);\n *   }\n *\n *   // 4. Invalidate cache when data changes\n *   set(key: string, value: string): void {\n *     this._data.set(key, value);\n *     this.invalidateTokenCache();  // <-- Important!\n *   }\n * }\n * ```\n *\n * ## Token Cache Lifecycle\n *\n * The token cache is used for budget calculation. Follow this pattern:\n *\n * 1. **When state changes**  Call `invalidateTokenCache()` to clear the cache\n * 2. **In getContent()**  Call `updateTokenCache(tokens)` before returning\n * 3. **For async recalc**  Use `recalculateTokenCache()` helper\n *\n * ```typescript\n * // Pattern 1: Invalidate on change, update in getContent\n * store(key: string, value: unknown): void {\n *   this._entries.set(key, value);\n *   this.invalidateTokenCache();  // Clear cache\n * }\n *\n * async getContent(): Promise<string | null> {\n *   const content = this.formatContent();\n *   this.updateTokenCache(this.estimator.estimateTokens(content));  // Update cache\n *   return content;\n * }\n *\n * // Pattern 2: Recalculate immediately after change\n * async store(key: string, value: unknown): Promise<void> {\n *   this._entries.set(key, value);\n *   await this.recalculateTokenCache();  // Recalc and cache\n * }\n * ```\n *\n * ## Compaction Support\n *\n * To make your plugin compactable:\n *\n * ```typescript\n * isCompactable(): boolean {\n *   return this._entries.size > 0;\n * }\n *\n * async compact(targetTokensToFree: number): Promise<number> {\n *   // Remove low-priority entries\n *   let freed = 0;\n *   for (const [key, entry] of this._entries) {\n *     if (entry.priority !== 'critical' && freed < targetTokensToFree) {\n *       freed += entry.tokens;\n *       this._entries.delete(key);\n *     }\n *   }\n *   this.invalidateTokenCache();\n *   return freed;\n * }\n * ```\n */\nexport abstract class BasePluginNextGen implements IContextPluginNextGen {\n  abstract readonly name: string;\n\n  /**\n   * Cached token size for content.\n   * Updated via updateTokenCache(), cleared via invalidateTokenCache().\n   */\n  private _contentTokenCache: number | null = null;\n\n  /**\n   * Cached token size for instructions.\n   * Computed once on first call to getInstructionsTokenSize().\n   */\n  private _instructionsTokenCache: number | null = null;\n\n  /**\n   * Token estimator instance.\n   * Override this in subclass to use a custom estimator (e.g., tiktoken).\n   *\n   * @example\n   * ```typescript\n   * class MyPlugin extends BasePluginNextGen {\n   *   protected estimator = myCustomTiktokenEstimator;\n   * }\n   * ```\n   */\n  protected estimator: ITokenEstimator = simpleTokenEstimator;\n\n  // ============================================================================\n  // Abstract methods - must be implemented by subclasses\n  // ============================================================================\n\n  abstract getInstructions(): string | null;\n  abstract getContent(): Promise<string | null>;\n  abstract getContents(): unknown;\n\n  // ============================================================================\n  // Token size tracking\n  // ============================================================================\n\n  /**\n   * Get current token size of content.\n   *\n   * Returns the cached value from the last `updateTokenCache()` call.\n   * Returns 0 if cache is null (content hasn't been calculated yet).\n   *\n   * **Note:** This is synchronous but `getContent()` is async. Plugins\n   * should call `updateTokenCache()` in their `getContent()` implementation\n   * to keep the cache accurate.\n   *\n   * @returns Cached token count (0 if cache not set)\n   */\n  getTokenSize(): number {\n    if (this._contentTokenCache === null) {\n      // Cache not set - return 0\n      // Subclasses should call updateTokenCache() in getContent()\n      return 0;\n    }\n    return this._contentTokenCache;\n  }\n\n  /**\n   * Get token size of instructions (cached after first call).\n   *\n   * Instructions are static, so this is computed once and cached permanently.\n   * The cache is never invalidated since instructions don't change.\n   *\n   * @returns Token count for instructions (0 if no instructions)\n   */\n  getInstructionsTokenSize(): number {\n    if (this._instructionsTokenCache === null) {\n      const instructions = this.getInstructions();\n      this._instructionsTokenCache = instructions\n        ? this.estimator.estimateTokens(instructions)\n        : 0;\n    }\n    return this._instructionsTokenCache;\n  }\n\n  /**\n   * Invalidate the content token cache.\n   *\n   * Call this when plugin state changes in a way that affects content size.\n   * The next call to `getTokenSize()` will return 0 until `updateTokenCache()`\n   * is called (typically in `getContent()`).\n   *\n   * @example\n   * ```typescript\n   * delete(key: string): boolean {\n   *   const deleted = this._entries.delete(key);\n   *   if (deleted) {\n   *     this.invalidateTokenCache();  // Content changed\n   *   }\n   *   return deleted;\n   * }\n   * ```\n   */\n  protected invalidateTokenCache(): void {\n    this._contentTokenCache = null;\n  }\n\n  /**\n   * Update the content token cache with a new value.\n   *\n   * Call this in `getContent()` after formatting content, passing the\n   * estimated token count. This keeps budget calculations accurate.\n   *\n   * @param tokens - New token count to cache\n   *\n   * @example\n   * ```typescript\n   * async getContent(): Promise<string | null> {\n   *   const content = this.formatEntries();\n   *   this.updateTokenCache(this.estimator.estimateTokens(content));\n   *   return content;\n   * }\n   * ```\n   */\n  protected updateTokenCache(tokens: number): void {\n    this._contentTokenCache = tokens;\n  }\n\n  /**\n   * Recalculate and cache token size from current content.\n   *\n   * Convenience method that calls `getContent()`, estimates tokens,\n   * and updates the cache. Use this when you need to immediately\n   * refresh the cache after a state change.\n   *\n   * @returns Calculated token count\n   *\n   * @example\n   * ```typescript\n   * async store(key: string, value: unknown): Promise<void> {\n   *   this._entries.set(key, value);\n   *   await this.recalculateTokenCache();  // Refresh immediately\n   * }\n   * ```\n   */\n  protected async recalculateTokenCache(): Promise<number> {\n    const content = await this.getContent();\n    const tokens = content ? this.estimator.estimateTokens(content) : 0;\n    this._contentTokenCache = tokens;\n    return tokens;\n  }\n\n  // ============================================================================\n  // Default implementations\n  // ============================================================================\n\n  /**\n   * Default: not compactable.\n   *\n   * Override to return `true` if your plugin can reduce its content size\n   * when context is tight. Also implement `compact()` to handle the actual\n   * compaction logic.\n   *\n   * @returns false by default\n   */\n  isCompactable(): boolean {\n    return false;\n  }\n\n  /**\n   * Default: no compaction (returns 0).\n   *\n   * Override to implement compaction logic. Should attempt to free\n   * approximately `targetTokensToFree` tokens. Remember to call\n   * `invalidateTokenCache()` after modifying content.\n   *\n   * @param _targetTokensToFree - Approximate tokens to free (best effort)\n   * @returns 0 by default (no tokens freed)\n   *\n   * @example\n   * ```typescript\n   * async compact(targetTokensToFree: number): Promise<number> {\n   *   let freed = 0;\n   *   // Remove entries by priority until target reached\n   *   for (const [key, entry] of this.sortedByPriority()) {\n   *     if (entry.priority === 'critical') continue;\n   *     if (freed >= targetTokensToFree) break;\n   *     freed += entry.tokens;\n   *     this._entries.delete(key);\n   *   }\n   *   this.invalidateTokenCache();\n   *   return freed;\n   * }\n   * ```\n   */\n  async compact(_targetTokensToFree: number): Promise<number> {\n    return 0;\n  }\n\n  /**\n   * Default: no tools (returns empty array).\n   *\n   * Override to provide plugin-specific tools. Tools are auto-registered\n   * with ToolManager when the plugin is added to the context.\n   *\n   * Use a consistent naming convention: `<prefix>_<action>`\n   * - `memory_store`, `memory_retrieve`, `memory_delete`\n   * - `context_set`, `context_delete`, `context_list`\n   *\n   * @returns Empty array by default\n   */\n  getTools(): ToolFunction[] {\n    return [];\n  }\n\n  /**\n   * Default: no-op cleanup.\n   *\n   * Override if your plugin has resources to release (file handles,\n   * timers, connections, etc.). Called when context is destroyed.\n   */\n  destroy(): void {\n    // No-op by default\n  }\n\n  /**\n   * Default: returns empty object.\n   *\n   * Override to serialize plugin state for session persistence.\n   * Return a JSON-serializable object. Consider including a version\n   * number for future migration support.\n   *\n   * @returns Empty object by default\n   *\n   * @example\n   * ```typescript\n   * getState(): unknown {\n   *   return {\n   *     version: 1,\n   *     entries: [...this._entries].map(([k, v]) => ({ key: k, ...v })),\n   *   };\n   * }\n   * ```\n   */\n  getState(): unknown {\n    return {};\n  }\n\n  /**\n   * Default: no-op (ignores state).\n   *\n   * Override to restore plugin state from saved session. The state\n   * comes from a previous `getState()` call.\n   *\n   * **IMPORTANT:** Call `invalidateTokenCache()` after restoring state\n   * to ensure token counts are recalculated on next `getContent()` call.\n   *\n   * @param _state - Previously serialized state from getState()\n   *\n   * @example\n   * ```typescript\n   * restoreState(state: unknown): void {\n   *   const s = state as { entries: Array<{ key: string; value: unknown }> };\n   *   this._entries.clear();\n   *   for (const entry of s.entries || []) {\n   *     this._entries.set(entry.key, entry);\n   *   }\n   *   this.invalidateTokenCache();  // Don't forget this!\n   * }\n   * ```\n   */\n  restoreState(_state: unknown): void {\n    // No-op by default\n  }\n}\n","/**\n * Snapshot Types  Canonical, serializable representations of agent context state.\n *\n * Used by UI components (Hosea, v25, etc.) to render \"Look Inside\" panels\n * without reaching into plugin internals directly.\n *\n * Design: `plugins` is an array (not hardcoded fields) enabling auto-discovery\n * of new/custom plugins without code changes.\n */\n\nimport type { ContextBudget, ContextFeatures } from './types.js';\n\n// ============================================================================\n// Context Snapshot (Main)\n// ============================================================================\n\n/**\n * Complete snapshot of an agent's context state.\n * Returned by `AgentContextNextGen.getSnapshot()` and `BaseAgent.getSnapshot()`.\n */\nexport interface IContextSnapshot {\n  /** Whether the context is available (not destroyed) */\n  available: boolean;\n\n  /** Agent ID */\n  agentId: string;\n\n  /** Model name */\n  model: string;\n\n  /** Feature flags */\n  features: Required<ContextFeatures>;\n\n  /** Token budget breakdown */\n  budget: ContextBudget;\n\n  /** Compaction strategy name */\n  strategy: string;\n\n  /** Number of messages in conversation history */\n  messagesCount: number;\n\n  /** Number of tool calls in conversation */\n  toolCallsCount: number;\n\n  /** System prompt (null if not set) */\n  systemPrompt: string | null;\n\n  /** All registered plugins with their current state */\n  plugins: IPluginSnapshot[];\n\n  /** All registered tools */\n  tools: IToolSnapshot[];\n}\n\n// ============================================================================\n// Plugin Snapshot\n// ============================================================================\n\n/**\n * Snapshot of a single plugin's state.\n * `contents` is the raw data from `plugin.getContents()` (plugin-specific shape).\n * `formattedContent` is the human-readable string from `plugin.getContent()`.\n */\nexport interface IPluginSnapshot {\n  /** Plugin identifier (e.g., 'working_memory') */\n  name: string;\n\n  /** Human-readable display name (e.g., 'Working Memory') */\n  displayName: string;\n\n  /** Whether this plugin is active */\n  enabled: boolean;\n\n  /** Current token size of plugin content */\n  tokenSize: number;\n\n  /** Token size of plugin instructions */\n  instructionsTokenSize: number;\n\n  /** Whether this plugin supports compaction */\n  compactable: boolean;\n\n  /** Raw plugin data (entries, state, etc.) */\n  contents: unknown;\n\n  /** Human-readable formatted content (Markdown) */\n  formattedContent: string | null;\n}\n\n// ============================================================================\n// Tool Snapshot\n// ============================================================================\n\n/**\n * Snapshot of a single tool's registration state.\n */\nexport interface IToolSnapshot {\n  /** Tool name */\n  name: string;\n\n  /** Tool description */\n  description: string;\n\n  /** Whether the tool is currently enabled */\n  enabled: boolean;\n\n  /** Number of times this tool has been called */\n  callCount: number;\n\n  /** Tool namespace (if registered with one) */\n  namespace?: string;\n}\n\n// ============================================================================\n// View Context (Prepared Context Breakdown)\n// ============================================================================\n\n/**\n * Human-readable breakdown of the prepared context.\n * Used by \"View Full Context\" UI panels.\n */\nexport interface IViewContextData {\n  /** Whether the data is available */\n  available: boolean;\n\n  /** Ordered list of context components */\n  components: IViewContextComponent[];\n\n  /** Total estimated tokens across all components */\n  totalTokens: number;\n\n  /** All components concatenated (for \"Copy All\" functionality) */\n  rawContext: string;\n}\n\n/**\n * A single component of the prepared context.\n */\nexport interface IViewContextComponent {\n  /** Component name (e.g., 'System Message', 'User Message', 'Tool Call: search') */\n  name: string;\n\n  /** Human-readable text content */\n  content: string;\n\n  /** Estimated token count for this component */\n  tokenEstimate: number;\n}\n\n// ============================================================================\n// Utility: Plugin name  display name\n// ============================================================================\n\n/**\n * Convert a plugin name to a human-readable display name.\n * e.g., 'working_memory'  'Working Memory'\n */\nexport function formatPluginDisplayName(name: string): string {\n  return name\n    .split('_')\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n}\n","/**\n * Memory entities for WorkingMemory\n *\n * This module provides a GENERIC memory system that works across all agent types:\n * - Basic Agent: Simple session/persistent scoping with static priority\n * - TaskAgent: Task-aware scoping with dynamic priority based on task states\n * - UniversalAgent: Mode-aware, switches strategy based on current mode\n *\n * The key abstraction is PriorityCalculator - a pluggable strategy that\n * determines entry priority for eviction decisions.\n */\n\n// ============================================================================\n// SCOPE TYPES (Generic + Task-Aware)\n// ============================================================================\n\n/**\n * Simple scope for basic agents - just a lifecycle label\n */\nexport type SimpleScope = 'session' | 'persistent';\n\n/**\n * Task-aware scope for TaskAgent/UniversalAgent\n */\nexport type TaskAwareScope =\n  | { type: 'task'; taskIds: string[] }   // Needed for specific task(s)\n  | { type: 'plan' }                       // Needed throughout plan execution\n  | { type: 'persistent' };                // Keep even after plan completes\n\n/**\n * Union type - memory system accepts both\n */\nexport type MemoryScope = SimpleScope | TaskAwareScope;\n\n/**\n * Type guard: is this a task-aware scope?\n */\nexport function isTaskAwareScope(scope: MemoryScope): scope is TaskAwareScope {\n  return typeof scope === 'object' && scope !== null && 'type' in scope;\n}\n\n/**\n * Type guard: is this a simple scope?\n */\nexport function isSimpleScope(scope: MemoryScope): scope is SimpleScope {\n  return scope === 'session' || scope === 'persistent';\n}\n\n/**\n * Compare two scopes for equality\n * Handles both simple scopes (string comparison) and task-aware scopes (deep comparison)\n */\nexport function scopeEquals(a: MemoryScope, b: MemoryScope): boolean {\n  // Simple scope comparison\n  if (isSimpleScope(a) && isSimpleScope(b)) {\n    return a === b;\n  }\n\n  // Task-aware scope comparison\n  if (isTaskAwareScope(a) && isTaskAwareScope(b)) {\n    if (a.type !== b.type) return false;\n\n    // For task scope, compare taskIds arrays\n    if (a.type === 'task' && b.type === 'task') {\n      if (a.taskIds.length !== b.taskIds.length) return false;\n      const sortedA = [...a.taskIds].sort();\n      const sortedB = [...b.taskIds].sort();\n      return sortedA.every((id, i) => id === sortedB[i]);\n    }\n\n    // For plan/persistent scope, type match is enough\n    return true;\n  }\n\n  // Mixed types are never equal\n  return false;\n}\n\n/**\n * Check if a scope matches a filter scope\n * More flexible than scopeEquals - supports partial matching for task scopes\n */\nexport function scopeMatches(entryScope: MemoryScope, filterScope: MemoryScope): boolean {\n  // Exact match first\n  if (scopeEquals(entryScope, filterScope)) return true;\n\n  // Simple scopes must match exactly\n  if (isSimpleScope(filterScope)) return false;\n\n  // For task-aware filter, check if entry scope matches the type\n  if (isTaskAwareScope(entryScope) && isTaskAwareScope(filterScope)) {\n    return entryScope.type === filterScope.type;\n  }\n\n  return false;\n}\n\n// ============================================================================\n// PRIORITY SYSTEM\n// ============================================================================\n\n/**\n * Priority determines eviction order (lower priority evicted first)\n *\n * - critical: Never evicted (pinned, or actively in use)\n * - high: Important data, evicted only when necessary\n * - normal: Default priority\n * - low: Candidate for eviction (stale data, completed task data)\n */\nexport type MemoryPriority = 'critical' | 'high' | 'normal' | 'low';\n\n/**\n * Priority values for comparison (higher = more important, less likely to evict)\n */\nexport const MEMORY_PRIORITY_VALUES: Record<MemoryPriority, number> = {\n  critical: 4,\n  high: 3,\n  normal: 2,\n  low: 1,\n};\n\n// ============================================================================\n// MEMORY TIER SYSTEM (Hierarchical Memory)\n// ============================================================================\n\n/**\n * Memory tier for hierarchical data management\n *\n * The tier system provides a structured approach to managing research/analysis data:\n * - raw: Original data, low priority, first to be evicted\n * - summary: Processed summaries, normal priority\n * - findings: Final conclusions/insights, high priority, kept longest\n *\n * Workflow: raw  summary  findings (data gets more refined, priority increases)\n */\nexport type MemoryTier = 'raw' | 'summary' | 'findings';\n\n/**\n * Default priorities for each tier\n */\nexport const TIER_PRIORITIES: Record<MemoryTier, MemoryPriority> = {\n  raw: 'low',\n  summary: 'normal',\n  findings: 'high',\n};\n\n/**\n * Key prefixes for tiered data (used by helper methods)\n */\nexport const TIER_KEY_PREFIXES: Record<MemoryTier, string> = {\n  raw: 'raw.',\n  summary: 'summary.',\n  findings: 'findings.',\n};\n\n/**\n * Hierarchy metadata for tracking data relationships\n */\nexport interface HierarchyMetadata {\n  /** Memory tier (raw, summary, or findings) */\n  tier: MemoryTier;\n  /** Keys this entry was derived from (e.g., findings derived from summaries) */\n  derivedFrom?: string[];\n  /** Keys derived from this entry (e.g., summaries derived from raw data) */\n  derivedTo?: string[];\n}\n\n/**\n * Check if a key has a tier prefix\n */\nexport function getTierFromKey(key: string): MemoryTier | undefined {\n  if (key.startsWith(TIER_KEY_PREFIXES.raw)) return 'raw';\n  if (key.startsWith(TIER_KEY_PREFIXES.summary)) return 'summary';\n  if (key.startsWith(TIER_KEY_PREFIXES.findings)) return 'findings';\n  return undefined;\n}\n\n/**\n * Strip tier prefix from key\n */\nexport function stripTierPrefix(key: string): string {\n  const tier = getTierFromKey(key);\n  if (!tier) return key;\n  return key.substring(TIER_KEY_PREFIXES[tier].length);\n}\n\n/**\n * Add tier prefix to key (if not already present)\n */\nexport function addTierPrefix(key: string, tier: MemoryTier): string {\n  const existingTier = getTierFromKey(key);\n  if (existingTier) {\n    // Already has a tier prefix - replace it\n    const baseKey = stripTierPrefix(key);\n    return TIER_KEY_PREFIXES[tier] + baseKey;\n  }\n  return TIER_KEY_PREFIXES[tier] + key;\n}\n\n// ============================================================================\n// PRIORITY CALCULATOR (Strategy Pattern)\n// ============================================================================\n\n/**\n * Context passed to priority calculator - varies by agent type\n */\nexport interface PriorityContext {\n  /** For TaskAgent: map of taskId  current status */\n  taskStates?: Map<string, TaskStatusForMemory>;\n  /** For UniversalAgent: current mode */\n  mode?: 'interactive' | 'planning' | 'executing';\n  /** Custom context for extensions */\n  [key: string]: unknown;\n}\n\n/**\n * Task status values for priority calculation\n */\nexport type TaskStatusForMemory = 'pending' | 'in_progress' | 'completed' | 'failed' | 'skipped' | 'cancelled';\n\n/**\n * Terminal statuses - task will not progress further\n */\nexport const TERMINAL_MEMORY_STATUSES: TaskStatusForMemory[] = ['completed', 'failed', 'skipped', 'cancelled'];\n\n/**\n * Check if a task status is terminal (task will not progress further)\n */\nexport function isTerminalMemoryStatus(status: TaskStatusForMemory): boolean {\n  return TERMINAL_MEMORY_STATUSES.includes(status);\n}\n\n/**\n * Priority calculator function type.\n * Given an entry and optional context, returns the effective priority.\n */\nexport type PriorityCalculator = (\n  entry: MemoryEntry,\n  context?: PriorityContext\n) => MemoryPriority;\n\n/**\n * Default: Static priority calculator\n * Returns the priority stored in the entry (or 'normal' if not set)\n */\nexport const staticPriorityCalculator: PriorityCalculator = (entry) => {\n  if (entry.pinned) return 'critical';\n  return entry.basePriority;\n};\n\n/**\n * Task-aware priority calculator\n * Computes priority dynamically based on task states\n */\nexport const taskAwarePriorityCalculator: PriorityCalculator = (entry, context) => {\n  // Pinned entries are always critical\n  if (entry.pinned) return 'critical';\n\n  const scope = entry.scope;\n\n  // Simple scope: use static priority\n  if (isSimpleScope(scope)) {\n    if (scope === 'persistent') return 'high';\n    return entry.basePriority; // 'session' uses base priority\n  }\n\n  // Task-aware scope: compute from task states\n  const taskStates = context?.taskStates;\n  if (!taskStates) {\n    // No task context provided, fall back to base priority\n    return entry.basePriority;\n  }\n\n  // Persistent scope = high priority\n  if (scope.type === 'persistent') return 'high';\n\n  // Plan scope = normal priority\n  if (scope.type === 'plan') return 'normal';\n\n  // Task scope = depends on task states\n  const taskIds = scope.taskIds;\n  if (taskIds.length === 0) {\n    // Empty taskIds array means no tasks need this data - treat as low priority\n    // This is a valid but unusual case, typically a mistake\n    return 'low';\n  }\n\n  let hasActiveTask = false;\n  let hasPendingTask = false;\n  let allTerminal = true;\n\n  for (const taskId of taskIds) {\n    const status = taskStates.get(taskId);\n    if (!status) continue;\n\n    if (status === 'in_progress') {\n      hasActiveTask = true;\n      allTerminal = false;\n    } else if (status === 'pending') {\n      hasPendingTask = true;\n      allTerminal = false;\n    }\n  }\n\n  if (hasActiveTask) return 'critical';\n  if (hasPendingTask) return 'high';\n  if (allTerminal) return 'low';\n\n  return 'normal';\n};\n\n// ============================================================================\n// STALE ENTRY DETECTION\n// ============================================================================\n\n/**\n * Reason why an entry became stale\n */\nexport type StaleReason =\n  | 'task_completed'      // All dependent tasks completed\n  | 'task_failed'         // Dependent task failed\n  | 'unused'              // Not accessed for a long time\n  | 'scope_cleared';      // Scope (e.g., session) was cleared\n\n/**\n * Information about a stale entry for LLM notification\n */\nexport interface StaleEntryInfo {\n  key: string;\n  description: string;\n  reason: StaleReason;\n  previousPriority: MemoryPriority;\n  newPriority: MemoryPriority;\n  taskIds?: string[];     // Which tasks completed (if task_completed)\n}\n\n/**\n * Detect entries that became stale after task completion\n */\nexport function detectStaleEntries(\n  entries: MemoryEntry[],\n  completedTaskId: string,\n  taskStates: Map<string, TaskStatusForMemory>\n): StaleEntryInfo[] {\n  const stale: StaleEntryInfo[] = [];\n\n  for (const entry of entries) {\n    if (entry.pinned) continue; // Pinned entries never stale\n\n    const scope = entry.scope;\n    if (!isTaskAwareScope(scope) || scope.type !== 'task') continue;\n\n    // Check if this entry was scoped to the completed task\n    if (!scope.taskIds.includes(completedTaskId)) continue;\n\n    // Check if ALL tasks for this entry are now terminal\n    const allTerminal = scope.taskIds.every((taskId) => {\n      const status = taskStates.get(taskId);\n      return status ? isTerminalMemoryStatus(status) : false;\n    });\n\n    if (allTerminal) {\n      stale.push({\n        key: entry.key,\n        description: entry.description,\n        reason: 'task_completed',\n        previousPriority: entry.basePriority,\n        newPriority: 'low',\n        taskIds: scope.taskIds,\n      });\n    }\n  }\n\n  return stale;\n}\n\n/**\n * Single memory entry stored in working memory\n */\nexport interface MemoryEntry {\n  key: string;                    // Namespaced key: \"user.profile\"\n  description: string;            // Short description for index (max 150 chars)\n  value: unknown;                 // The actual data\n  sizeBytes: number;              // Computed size for tracking\n  scope: MemoryScope;             // Lifecycle scope (simple or task-aware)\n  basePriority: MemoryPriority;   // Base priority (actual priority may be computed dynamically)\n  pinned: boolean;                // If true, never evicted\n  createdAt: number;              // Unix timestamp\n  lastAccessedAt: number;\n  accessCount: number;\n}\n\n/**\n * Index entry (lightweight, always in context)\n */\nexport interface MemoryIndexEntry {\n  key: string;\n  description: string;\n  size: string;                   // Human readable: \"4.2KB\"\n  scope: MemoryScope;\n  effectivePriority: MemoryPriority;  // Computed priority for display\n  pinned: boolean;\n}\n\n/**\n * Full memory index with metadata\n */\nexport interface MemoryIndex {\n  entries: MemoryIndexEntry[];\n  totalSizeBytes: number;\n  totalSizeHuman: string;         // \"42KB\"\n  limitBytes: number;\n  limitHuman: string;             // \"1MB\"\n  utilizationPercent: number;\n  /** Total entry count (before any truncation for display) */\n  totalEntryCount: number;\n  /** Number of entries omitted from display due to maxIndexEntries limit */\n  omittedCount: number;\n}\n\n/**\n * Configuration for working memory\n */\nexport interface WorkingMemoryConfig {\n  /** Max memory size in bytes. If not set, calculated from model context */\n  maxSizeBytes?: number;\n\n  /** Max number of entries in the memory index. Excess entries are auto-evicted via LRU. Default: 30 */\n  maxIndexEntries?: number;\n\n  /** Max description length */\n  descriptionMaxLength: number;\n\n  /** Percentage at which to warn agent */\n  softLimitPercent: number;\n\n  /** Percentage of model context to allocate to memory */\n  contextAllocationPercent: number;\n}\n\n/**\n * Input for creating a memory entry\n */\nexport interface MemoryEntryInput {\n  key: string;\n  description: string;\n  value: unknown;\n  /** Scope - defaults to 'session' for basic agents */\n  scope?: MemoryScope;\n  /** Base priority - may be overridden by dynamic calculation */\n  priority?: MemoryPriority;\n  /** If true, entry is never evicted */\n  pinned?: boolean;\n}\n\n/**\n * Shorthand for task-scoped entry\n */\nexport interface TaskScopedEntryInput extends Omit<MemoryEntryInput, 'scope'> {\n  /** Task IDs that need this data */\n  neededForTasks: string[];\n}\n\n/**\n * Create a task-scoped memory entry input\n */\nexport function forTasks(\n  key: string,\n  description: string,\n  value: unknown,\n  taskIds: string[],\n  options?: { priority?: MemoryPriority; pinned?: boolean }\n): MemoryEntryInput {\n  return {\n    key,\n    description,\n    value,\n    scope: { type: 'task', taskIds },\n    priority: options?.priority,\n    pinned: options?.pinned,\n  };\n}\n\n/**\n * Create a plan-scoped memory entry input\n */\nexport function forPlan(\n  key: string,\n  description: string,\n  value: unknown,\n  options?: { priority?: MemoryPriority; pinned?: boolean }\n): MemoryEntryInput {\n  return {\n    key,\n    description,\n    value,\n    scope: { type: 'plan' },\n    priority: options?.priority,\n    pinned: options?.pinned,\n  };\n}\n\n/**\n * Default configuration values\n */\nexport const DEFAULT_MEMORY_CONFIG: WorkingMemoryConfig = {\n  maxSizeBytes: 25 * 1024 * 1024, // 25MB default\n  maxIndexEntries: 30, // Limit index entries to prevent context bloat\n  descriptionMaxLength: 150,\n  softLimitPercent: 80,\n  contextAllocationPercent: 20,\n};\n\n/**\n * Validate memory key format\n * Valid: \"simple\", \"user.profile\", \"order.items.123\"\n * Invalid: \"\", \".invalid\", \"invalid.\", \"with spaces\"\n */\nexport function validateMemoryKey(key: string): void {\n  if (!key || key.length === 0) {\n    throw new Error('Memory key cannot be empty');\n  }\n\n  // Check for invalid patterns\n  if (key.startsWith('.') || key.endsWith('.') || key.includes('..')) {\n    throw new Error('Invalid memory key format: keys cannot start/end with dots or contain consecutive dots');\n  }\n\n  // Check for invalid characters (only alphanumeric, dots, dashes, underscores)\n  if (!/^[a-zA-Z0-9._-]+$/.test(key)) {\n    throw new Error('Invalid memory key format: only alphanumeric, dots, dashes, and underscores allowed');\n  }\n}\n\n/**\n * Calculate the size of a value in bytes (JSON serialization)\n * Uses Buffer.byteLength for accurate UTF-8 byte count\n */\nexport function calculateEntrySize(value: unknown): number {\n  if (value === undefined) {\n    return 0;\n  }\n\n  const serialized = JSON.stringify(value);\n  // Use Buffer.byteLength for accurate UTF-8 byte count\n  // This handles multi-byte characters correctly (e.g., ''.length = 2, but byte length = 6)\n  if (typeof Buffer !== 'undefined') {\n    return Buffer.byteLength(serialized, 'utf8');\n  }\n  // Fallback for environments without Buffer (browser)\n  return new Blob([serialized]).size;\n}\n\n/**\n * Create a memory entry with defaults and validation\n */\nexport function createMemoryEntry(\n  input: MemoryEntryInput,\n  config: WorkingMemoryConfig = DEFAULT_MEMORY_CONFIG\n): MemoryEntry {\n  // Validate key\n  validateMemoryKey(input.key);\n\n  // Validate description length\n  if (input.description.length > config.descriptionMaxLength) {\n    throw new Error(`Description exceeds maximum length of ${config.descriptionMaxLength} characters`);\n  }\n\n  // Validate task-aware scope\n  if (input.scope && isTaskAwareScope(input.scope) && input.scope.type === 'task') {\n    if (input.scope.taskIds.length === 0) {\n      // This is valid but unusual - typically indicates a mistake\n      // We allow it but the entry will have low priority\n      console.warn(`Memory entry \"${input.key}\" has empty taskIds array - will have low priority`);\n    }\n  }\n\n  const now = Date.now();\n  const sizeBytes = calculateEntrySize(input.value);\n\n  // If pinned, automatically set priority to critical\n  const pinned = input.pinned ?? false;\n  const priority = pinned ? 'critical' : (input.priority ?? 'normal');\n\n  return {\n    key: input.key,\n    description: input.description,\n    value: input.value,\n    sizeBytes,\n    scope: input.scope ?? 'session',\n    basePriority: priority,\n    pinned,\n    createdAt: now,\n    lastAccessedAt: now,\n    accessCount: 0,\n  };\n}\n\n/**\n * Format bytes to human-readable string\n */\nexport function formatSizeHuman(bytes: number): string {\n  if (bytes === 0) return '0B';\n  if (bytes < 1024) return `${bytes}B`;\n\n  const kb = bytes / 1024;\n  if (bytes < 1024 * 1024) {\n    // Show 1 decimal place, but remove .0\n    return `${kb.toFixed(1).replace(/\\.0$/, '')}KB`;\n  }\n\n  const mb = bytes / (1024 * 1024);\n  if (bytes < 1024 * 1024 * 1024) {\n    return `${mb.toFixed(1).replace(/\\.0$/, '')}MB`;\n  }\n\n  const gb = bytes / (1024 * 1024 * 1024);\n  return `${gb.toFixed(1).replace(/\\.0$/, '')}GB`;\n}\n\n/**\n * Format scope for display\n */\nfunction formatScope(scope: MemoryScope): string {\n  if (isSimpleScope(scope)) {\n    return scope;\n  }\n  // Task-aware scope\n  if (scope.type === 'task') {\n    return `task:${scope.taskIds.join(',')}`;\n  }\n  return scope.type;\n}\n\n/**\n * Format entry flags for display\n */\nfunction formatEntryFlags(entry: MemoryIndexEntry): string {\n  const flags: string[] = [];\n\n  if (entry.pinned) {\n    flags.push('pinned');\n  } else if (entry.effectivePriority !== 'normal') {\n    flags.push(entry.effectivePriority);\n  }\n\n  flags.push(formatScope(entry.scope));\n\n  return flags.join(', ');\n}\n\n/**\n * Format memory index for context injection\n */\nexport function formatMemoryIndex(index: MemoryIndex): string {\n  const lines: string[] = [];\n\n  // Format utilization percent without unnecessary decimals\n  const utilPercent = Number.isInteger(index.utilizationPercent)\n    ? index.utilizationPercent.toString()\n    : index.utilizationPercent.toFixed(1).replace(/\\.0$/, '');\n\n  lines.push(`## Working Memory (${index.totalSizeHuman} / ${index.limitHuman} - ${utilPercent}%)`);\n  lines.push('');\n\n  if (index.entries.length === 0) {\n    lines.push('Memory is empty.');\n  } else {\n    // Group by priority first, then scope\n    const pinned = index.entries.filter((e) => e.pinned);\n    const critical = index.entries.filter((e) => !e.pinned && e.effectivePriority === 'critical');\n    const high = index.entries.filter((e) => !e.pinned && e.effectivePriority === 'high');\n    const normal = index.entries.filter((e) => !e.pinned && e.effectivePriority === 'normal');\n    const low = index.entries.filter((e) => !e.pinned && e.effectivePriority === 'low');\n\n    if (pinned.length > 0) {\n      lines.push('**Pinned (never evicted):**');\n      for (const entry of pinned) {\n        lines.push(`- \\`${entry.key}\\` (${entry.size}): ${entry.description} [${formatEntryFlags(entry)}]`);\n      }\n      lines.push('');\n    }\n\n    if (critical.length > 0) {\n      lines.push('**Critical priority:**');\n      for (const entry of critical) {\n        lines.push(`- \\`${entry.key}\\` (${entry.size}): ${entry.description} [${formatEntryFlags(entry)}]`);\n      }\n      lines.push('');\n    }\n\n    if (high.length > 0) {\n      lines.push('**High priority:**');\n      for (const entry of high) {\n        lines.push(`- \\`${entry.key}\\` (${entry.size}): ${entry.description} [${formatEntryFlags(entry)}]`);\n      }\n      lines.push('');\n    }\n\n    if (normal.length > 0) {\n      lines.push('**Normal priority:**');\n      for (const entry of normal) {\n        lines.push(`- \\`${entry.key}\\` (${entry.size}): ${entry.description} [${formatEntryFlags(entry)}]`);\n      }\n      lines.push('');\n    }\n\n    if (low.length > 0) {\n      lines.push('**Low priority (evicted first):**');\n      for (const entry of low) {\n        lines.push(`- \\`${entry.key}\\` (${entry.size}): ${entry.description} [${formatEntryFlags(entry)}]`);\n      }\n      lines.push('');\n    }\n\n    // Add warning if utilization is high\n    if (index.utilizationPercent > 80) {\n      lines.push('Warning: Memory utilization is high. Consider deleting unused entries.');\n      lines.push('');\n    }\n\n    // Show omitted entries notice\n    if (index.omittedCount > 0) {\n      lines.push(`*${index.omittedCount} additional low-priority entries not shown. Use \\`memory_query()\\` to see all.*`);\n      lines.push('');\n    }\n  }\n\n  lines.push('Use `memory_retrieve(\"key\")` to load full content.');\n  lines.push('Use `memory_persist(\"key\")` to keep data after task completion.');\n\n  return lines.join('\\n');\n}\n","/**\n * In-memory storage implementations (default, non-persistent)\n */\n\nimport { MemoryEntry, MemoryScope, scopeMatches } from '../../domain/entities/Memory.js';\nimport { Plan, Task, PlanStatus } from '../../domain/entities/Task.js';\nimport { AgentState, AgentStatus } from '../../domain/entities/AgentState.js';\nimport { IMemoryStorage } from '../../domain/interfaces/IMemoryStorage.js';\nimport { IPlanStorage } from '../../domain/interfaces/IPlanStorage.js';\nimport { IAgentStateStorage } from '../../domain/interfaces/IAgentStateStorage.js';\n\n/**\n * In-memory implementation of IMemoryStorage\n */\nexport class InMemoryStorage implements IMemoryStorage {\n  private store = new Map<string, MemoryEntry>();\n\n  async get(key: string): Promise<MemoryEntry | undefined> {\n    return this.store.get(key);\n  }\n\n  async set(key: string, entry: MemoryEntry): Promise<void> {\n    this.store.set(key, entry);\n  }\n\n  async delete(key: string): Promise<void> {\n    this.store.delete(key);\n  }\n\n  async has(key: string): Promise<boolean> {\n    return this.store.has(key);\n  }\n\n  async getAll(): Promise<MemoryEntry[]> {\n    return Array.from(this.store.values());\n  }\n\n  async getByScope(scope: MemoryScope): Promise<MemoryEntry[]> {\n    return Array.from(this.store.values()).filter((entry) => scopeMatches(entry.scope, scope));\n  }\n\n  async clearScope(scope: MemoryScope): Promise<void> {\n    const toDelete: string[] = [];\n    for (const [key, entry] of this.store.entries()) {\n      if (scopeMatches(entry.scope, scope)) {\n        toDelete.push(key);\n      }\n    }\n    for (const key of toDelete) {\n      this.store.delete(key);\n    }\n  }\n\n  async clear(): Promise<void> {\n    this.store.clear();\n  }\n\n  async getTotalSize(): Promise<number> {\n    let total = 0;\n    for (const entry of this.store.values()) {\n      total += entry.sizeBytes;\n    }\n    return total;\n  }\n}\n\n/**\n * In-memory implementation of IPlanStorage\n */\nexport class InMemoryPlanStorage implements IPlanStorage {\n  private plans = new Map<string, Plan>();\n\n  async savePlan(plan: Plan): Promise<void> {\n    // Deep clone to avoid mutations\n    this.plans.set(plan.id, JSON.parse(JSON.stringify(plan)));\n  }\n\n  async getPlan(planId: string): Promise<Plan | undefined> {\n    const plan = this.plans.get(planId);\n    return plan ? JSON.parse(JSON.stringify(plan)) : undefined;\n  }\n\n  async updateTask(planId: string, task: Task): Promise<void> {\n    const plan = this.plans.get(planId);\n    if (!plan) {\n      throw new Error(`Plan ${planId} not found`);\n    }\n\n    const taskIndex = plan.tasks.findIndex((t) => t.id === task.id);\n    if (taskIndex === -1) {\n      throw new Error(`Task ${task.id} not found in plan ${planId}`);\n    }\n\n    plan.tasks[taskIndex] = JSON.parse(JSON.stringify(task));\n  }\n\n  async addTask(planId: string, task: Task): Promise<void> {\n    const plan = this.plans.get(planId);\n    if (!plan) {\n      throw new Error(`Plan ${planId} not found`);\n    }\n\n    plan.tasks.push(JSON.parse(JSON.stringify(task)));\n  }\n\n  async deletePlan(planId: string): Promise<void> {\n    this.plans.delete(planId);\n  }\n\n  async listPlans(filter?: { status?: PlanStatus[] }): Promise<Plan[]> {\n    const allPlans = Array.from(this.plans.values());\n\n    if (!filter || !filter.status) {\n      return allPlans.map((p) => JSON.parse(JSON.stringify(p)));\n    }\n\n    return allPlans\n      .filter((plan) => filter.status!.includes(plan.status))\n      .map((p) => JSON.parse(JSON.stringify(p)));\n  }\n\n  async findByWebhookId(webhookId: string): Promise<{ plan: Plan; task: Task } | undefined> {\n    for (const plan of this.plans.values()) {\n      for (const task of plan.tasks) {\n        if (task.externalDependency?.webhookId === webhookId) {\n          return {\n            plan: JSON.parse(JSON.stringify(plan)),\n            task: JSON.parse(JSON.stringify(task)),\n          };\n        }\n      }\n    }\n    return undefined;\n  }\n}\n\n/**\n * In-memory implementation of IAgentStateStorage\n */\nexport class InMemoryAgentStateStorage implements IAgentStateStorage {\n  private agents = new Map<string, AgentState>();\n\n  async save(state: AgentState): Promise<void> {\n    // Deep clone to avoid mutations\n    this.agents.set(state.id, JSON.parse(JSON.stringify(state)));\n  }\n\n  async load(agentId: string): Promise<AgentState | undefined> {\n    const state = this.agents.get(agentId);\n    return state ? JSON.parse(JSON.stringify(state)) : undefined;\n  }\n\n  async delete(agentId: string): Promise<void> {\n    this.agents.delete(agentId);\n  }\n\n  async list(filter?: { status?: AgentStatus[] }): Promise<AgentState[]> {\n    const allStates = Array.from(this.agents.values());\n\n    if (!filter || !filter.status) {\n      return allStates.map((s) => JSON.parse(JSON.stringify(s)));\n    }\n\n    return allStates\n      .filter((state) => filter.status!.includes(state.status))\n      .map((s) => JSON.parse(JSON.stringify(s)));\n  }\n\n  async patch(agentId: string, updates: Partial<AgentState>): Promise<void> {\n    const state = this.agents.get(agentId);\n    if (!state) {\n      throw new Error(`Agent ${agentId} not found`);\n    }\n\n    Object.assign(state, updates);\n  }\n}\n\n/**\n * Unified agent storage interface\n */\nexport interface IAgentStorage {\n  memory: IMemoryStorage;\n  plan: IPlanStorage;\n  agent: IAgentStateStorage;\n}\n\n/**\n * Create agent storage with defaults\n */\nexport function createAgentStorage(options: {\n  memory?: IMemoryStorage;\n  plan?: IPlanStorage;\n  agent?: IAgentStateStorage;\n} = {}): IAgentStorage {\n  return {\n    memory: options.memory ?? new InMemoryStorage(),\n    plan: options.plan ?? new InMemoryPlanStorage(),\n    agent: options.agent ?? new InMemoryAgentStateStorage(),\n  };\n}\n\n// Re-export for convenience\nexport { InMemoryStorage as InMemoryMemoryStorage };\nexport type { IAgentStorage as InMemoryAgentStorage };\n","/**\n * WorkingMemoryPluginNextGen - Working memory plugin for NextGen context\n *\n * Provides external storage with an INDEX shown in context.\n * LLM sees descriptions but must use memory_retrieve() to get full values.\n *\n * Features:\n * - Hierarchical tiers: raw  summary  findings\n * - Priority-based eviction\n * - Task-aware scoping (optional)\n * - Automatic tier-based priorities\n */\n\nimport type { IContextPluginNextGen, ITokenEstimator } from '../types.js';\nimport type { ToolFunction } from '../../../domain/entities/Tool.js';\nimport type { IMemoryStorage } from '../../../domain/interfaces/IMemoryStorage.js';\nimport { InMemoryStorage } from '../../../infrastructure/storage/InMemoryStorage.js';\nimport { simpleTokenEstimator } from '../BasePluginNextGen.js';\nimport { StorageRegistry } from '../../StorageRegistry.js';\n\nimport type {\n  MemoryEntry,\n  MemoryScope,\n  MemoryPriority,\n  MemoryTier,\n  WorkingMemoryConfig,\n  PriorityCalculator,\n  PriorityContext,\n} from '../../../domain/entities/Memory.js';\n\nimport {\n  DEFAULT_MEMORY_CONFIG,\n  staticPriorityCalculator,\n  MEMORY_PRIORITY_VALUES,\n  createMemoryEntry,\n  formatMemoryIndex,\n  formatSizeHuman,\n  TIER_PRIORITIES,\n  getTierFromKey,\n  addTierPrefix,\n} from '../../../domain/entities/Memory.js';\n\nimport type { MemoryIndex, MemoryIndexEntry } from '../../../domain/entities/Memory.js';\n\n// Tool definitions (inline for full control)\nconst memoryStoreDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'memory_store',\n    description: `Store data in working memory. Use this to save important information.\n\nTIER SYSTEM (for research/analysis):\n- \"raw\": Low priority, evicted first. Unprocessed data.\n- \"summary\": Normal priority. Processed summaries.\n- \"findings\": High priority, kept longest. Final conclusions.`,\n    parameters: {\n      type: 'object',\n      properties: {\n        key: { type: 'string', description: 'Namespaced key (e.g., \"user.profile\")' },\n        description: { type: 'string', description: 'Brief description (max 150 chars)' },\n        value: { description: 'Data to store (any JSON value)' },\n        tier: {\n          type: 'string',\n          enum: ['raw', 'summary', 'findings'],\n          description: 'Memory tier (sets priority automatically)',\n        },\n        scope: {\n          type: 'string',\n          enum: ['session', 'plan', 'persistent'],\n          description: 'Lifecycle scope (default: session)',\n        },\n        priority: {\n          type: 'string',\n          enum: ['low', 'normal', 'high', 'critical'],\n          description: 'Override priority (ignored if tier is set)',\n        },\n        pinned: { type: 'boolean', description: 'Never evict this entry' },\n      },\n      required: ['key', 'description', 'value'],\n    },\n  },\n};\n\nconst memoryRetrieveDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'memory_retrieve',\n    description: 'Retrieve full data from working memory by key.',\n    parameters: {\n      type: 'object',\n      properties: {\n        key: { type: 'string', description: 'Key to retrieve' },\n      },\n      required: ['key'],\n    },\n  },\n};\n\nconst memoryDeleteDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'memory_delete',\n    description: 'Delete data from working memory.',\n    parameters: {\n      type: 'object',\n      properties: {\n        key: { type: 'string', description: 'Key to delete' },\n      },\n      required: ['key'],\n    },\n  },\n};\n\nconst memoryQueryDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'memory_query',\n    description: `Query working memory. List, search, or retrieve values.\n\nExamples:\n- memory_query()  list all keys\n- memory_query({ pattern: \"findings.*\" })  match pattern\n- memory_query({ tier: \"raw\", includeValues: true })  get raw tier values`,\n    parameters: {\n      type: 'object',\n      properties: {\n        pattern: { type: 'string', description: 'Glob pattern (e.g., \"raw.*\")' },\n        tier: { type: 'string', enum: ['raw', 'summary', 'findings'], description: 'Filter by tier' },\n        includeValues: { type: 'boolean', description: 'Include values (default: false)' },\n        includeStats: { type: 'boolean', description: 'Include memory stats' },\n      },\n      required: [],\n    },\n  },\n};\n\nconst memoryCleanupRawDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'memory_cleanup_raw',\n    description: 'Delete ALL entries in the raw tier. Use after creating summaries.',\n    parameters: {\n      type: 'object',\n      properties: {},\n      required: [],\n    },\n  },\n};\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface SerializedWorkingMemoryState {\n  version: number;\n  entries: Array<{\n    key: string;\n    description: string;\n    value: unknown;\n    scope: MemoryScope;\n    sizeBytes: number;\n    basePriority?: MemoryPriority;\n    pinned?: boolean;\n  }>;\n}\n\nexport type EvictionStrategy = 'lru' | 'size';\n\nexport interface WorkingMemoryPluginConfig {\n  /** Memory configuration */\n  config?: WorkingMemoryConfig;\n  /** Storage backend (default: InMemoryStorage) */\n  storage?: IMemoryStorage;\n  /** Priority calculator (default: staticPriorityCalculator) */\n  priorityCalculator?: PriorityCalculator;\n}\n\n// ============================================================================\n// Instructions\n// ============================================================================\n\nconst WORKING_MEMORY_INSTRUCTIONS = `Working Memory stores data EXTERNALLY with an index shown below.\nYou see descriptions but must use memory_retrieve(key) to get full values.\n\n**Tier System** (for research/analysis):\n- \\`raw\\`: Low priority, evicted first. Unprocessed data to summarize later.\n- \\`summary\\`: Normal priority. Processed summaries of raw data.\n- \\`findings\\`: High priority, kept longest. Final conclusions and insights.\n\n**Workflow:**\n1. Store raw data: \\`memory_store({ key: \"topic\", tier: \"raw\", ... })\\`\n2. Process and summarize: \\`memory_store({ key: \"topic\", tier: \"summary\", ... })\\`\n3. Extract findings: \\`memory_store({ key: \"topic\", tier: \"findings\", ... })\\`\n4. Clean up raw: \\`memory_cleanup_raw()\\` or \\`memory_delete(key)\\`\n\n**Tools:** memory_store, memory_retrieve, memory_delete, memory_query, memory_cleanup_raw`;\n\n// ============================================================================\n// Plugin Implementation\n// ============================================================================\n\nexport class WorkingMemoryPluginNextGen implements IContextPluginNextGen {\n  readonly name = 'working_memory';\n\n  private storage: IMemoryStorage;\n  private config: WorkingMemoryConfig;\n  private priorityCalculator: PriorityCalculator;\n  private priorityContext: PriorityContext = {};\n  private estimator: ITokenEstimator = simpleTokenEstimator;\n\n  private _destroyed = false;\n  private _tokenCache: number | null = null;\n  private _instructionsTokenCache: number | null = null;\n\n  /**\n   * Synchronous snapshot of entries for getState() serialization.\n   * Updated on every mutation (store, delete, evict, cleanupRaw, restoreState).\n   * Solves the async/sync mismatch: IMemoryStorage.getAll() is async but\n   * IContextPluginNextGen.getState() must be sync.\n   */\n  private _syncEntries: Map<string, SerializedWorkingMemoryState['entries'][number]> = new Map();\n\n  constructor(pluginConfig: WorkingMemoryPluginConfig = {}) {\n    const registryFactory = StorageRegistry.get('workingMemory');\n    this.storage = pluginConfig.storage ?? registryFactory?.(StorageRegistry.getContext()) ?? new InMemoryStorage();\n    this.config = pluginConfig.config ?? DEFAULT_MEMORY_CONFIG;\n    this.priorityCalculator = pluginConfig.priorityCalculator ?? staticPriorityCalculator;\n  }\n\n  // ============================================================================\n  // IContextPluginNextGen Implementation\n  // ============================================================================\n\n  getInstructions(): string {\n    return WORKING_MEMORY_INSTRUCTIONS;\n  }\n\n  async getContent(): Promise<string | null> {\n    const entries = await this.storage.getAll();\n    if (entries.length === 0) {\n      return null;\n    }\n\n    // Build MemoryIndex from entries\n    const index = this.buildMemoryIndex(entries);\n\n    // Format as index (descriptions only, not full values)\n    const formatted = formatMemoryIndex(index);\n    this._tokenCache = this.estimator.estimateTokens(formatted);\n    return formatted;\n  }\n\n  getContents(): unknown {\n    // Return raw entries for inspection\n    return this.storage.getAll();\n  }\n\n  getTokenSize(): number {\n    return this._tokenCache ?? 0;\n  }\n\n  getInstructionsTokenSize(): number {\n    if (this._instructionsTokenCache === null) {\n      this._instructionsTokenCache = this.estimator.estimateTokens(WORKING_MEMORY_INSTRUCTIONS);\n    }\n    return this._instructionsTokenCache;\n  }\n\n  isCompactable(): boolean {\n    return true;\n  }\n\n  async compact(_targetTokensToFree: number): Promise<number> {\n    // TODO: Implement smart compaction based on targetTokensToFree\n    // For now, use simple LRU eviction\n    const before = this.getTokenSize();\n    await this.evict(3, 'lru');\n    const content = await this.getContent();\n    const after = content ? this.estimator.estimateTokens(content) : 0;\n    return Math.max(0, before - after);\n  }\n\n  getTools(): ToolFunction[] {\n    return [\n      this.createMemoryStoreTool(),\n      this.createMemoryRetrieveTool(),\n      this.createMemoryDeleteTool(),\n      this.createMemoryQueryTool(),\n      this.createMemoryCleanupRawTool(),\n    ];\n  }\n\n  destroy(): void {\n    if (this._destroyed) return;\n    this._destroyed = true;\n    this._tokenCache = null;\n  }\n\n  getState(): SerializedWorkingMemoryState {\n    return {\n      version: 1,\n      entries: Array.from(this._syncEntries.values()),\n    };\n  }\n\n  restoreState(state: unknown): void {\n    const s = state as SerializedWorkingMemoryState;\n    if (!s || !s.entries) return;\n\n    // Clear sync snapshot and rebuild\n    this._syncEntries.clear();\n\n    // Restore entries to both storage and sync snapshot\n    for (const entry of s.entries) {\n      const memEntry = createMemoryEntry({\n        key: entry.key,\n        description: entry.description,\n        value: entry.value,\n        scope: entry.scope,\n        priority: entry.basePriority,\n        pinned: entry.pinned,\n      }, this.config);\n      this.storage.set(entry.key, memEntry);\n      this._syncEntries.set(entry.key, {\n        key: entry.key,\n        description: entry.description,\n        value: entry.value,\n        scope: entry.scope,\n        sizeBytes: entry.sizeBytes,\n        basePriority: entry.basePriority,\n        pinned: entry.pinned,\n      });\n    }\n    this._tokenCache = null;\n  }\n\n  // ============================================================================\n  // Memory Operations (Core Implementation)\n  // ============================================================================\n\n  /**\n   * Store a value in memory\n   */\n  async store(\n    key: string,\n    description: string,\n    value: unknown,\n    options?: {\n      scope?: MemoryScope;\n      priority?: MemoryPriority;\n      tier?: MemoryTier;\n      pinned?: boolean;\n    }\n  ): Promise<{ key: string; sizeBytes: number }> {\n    this.assertNotDestroyed();\n\n    // Apply tier prefix and priority if tier specified\n    let finalKey = key;\n    let finalPriority = options?.priority;\n\n    if (options?.tier) {\n      finalKey = addTierPrefix(key, options.tier);\n      finalPriority = TIER_PRIORITIES[options.tier];\n    }\n\n    // Convert simple scope strings to task-aware format\n    let scope: MemoryScope = options?.scope ?? 'session';\n\n    const entry = createMemoryEntry({\n      key: finalKey,\n      description,\n      value,\n      scope,\n      priority: finalPriority,\n      pinned: options?.pinned,\n    }, this.config);\n\n    // Check size limits\n    await this.ensureCapacity(entry.sizeBytes);\n\n    await this.storage.set(finalKey, entry);\n    this._syncEntries.set(finalKey, {\n      key: finalKey,\n      description,\n      value,\n      scope,\n      sizeBytes: entry.sizeBytes,\n      basePriority: finalPriority,\n      pinned: options?.pinned,\n    });\n    this._tokenCache = null; // Invalidate cache\n\n    return { key: finalKey, sizeBytes: entry.sizeBytes };\n  }\n\n  /**\n   * Retrieve a value from memory\n   */\n  async retrieve(key: string): Promise<unknown | undefined> {\n    this.assertNotDestroyed();\n    const entry = await this.storage.get(key);\n    if (entry) {\n      entry.lastAccessedAt = Date.now();\n      entry.accessCount++;\n      await this.storage.set(key, entry);\n      return entry.value;\n    }\n    return undefined;\n  }\n\n  /**\n   * Delete a key from memory\n   */\n  async delete(key: string): Promise<boolean> {\n    this.assertNotDestroyed();\n    const exists = await this.storage.has(key);\n    if (exists) {\n      await this.storage.delete(key);\n      this._syncEntries.delete(key);\n      this._tokenCache = null;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Query memory entries\n   */\n  async query(options?: {\n    pattern?: string;\n    tier?: MemoryTier;\n    includeValues?: boolean;\n    includeStats?: boolean;\n  }): Promise<{\n    entries: Array<{\n      key: string;\n      description: string;\n      tier?: MemoryTier;\n      value?: unknown;\n    }>;\n    stats?: { count: number; totalBytes: number };\n  }> {\n    this.assertNotDestroyed();\n\n    let entries = await this.storage.getAll();\n\n    // Filter by tier\n    if (options?.tier) {\n      entries = entries.filter(e => getTierFromKey(e.key) === options.tier);\n    }\n\n    // Filter by pattern\n    if (options?.pattern && options.pattern !== '*') {\n      const regex = new RegExp(\n        '^' + options.pattern.replace(/\\./g, '\\\\.').replace(/\\*/g, '.*') + '$'\n      );\n      entries = entries.filter(e => regex.test(e.key));\n    }\n\n    const result: Array<{\n      key: string;\n      description: string;\n      tier?: MemoryTier;\n      value?: unknown;\n    }> = entries.map(e => ({\n      key: e.key,\n      description: e.description,\n      tier: getTierFromKey(e.key),\n      ...(options?.includeValues ? { value: e.value } : {}),\n    }));\n\n    if (options?.includeStats) {\n      return {\n        entries: result,\n        stats: {\n          count: entries.length,\n          totalBytes: entries.reduce((sum, e) => sum + e.sizeBytes, 0),\n        },\n      };\n    }\n\n    return { entries: result };\n  }\n\n  /**\n   * Format memory index for context\n   */\n  async formatIndex(): Promise<string> {\n    const entries = await this.storage.getAll();\n    const index = this.buildMemoryIndex(entries);\n    return formatMemoryIndex(index);\n  }\n\n  /**\n   * Evict entries to free space\n   */\n  async evict(count: number, strategy: EvictionStrategy = 'lru'): Promise<string[]> {\n    const entries = await this.storage.getAll();\n\n    // Get evictable entries (not pinned, not critical)\n    const evictable = entries\n      .filter(e => !e.pinned && this.computePriority(e) !== 'critical')\n      .sort((a, b) => {\n        const priorityDiff =\n          MEMORY_PRIORITY_VALUES[this.computePriority(a)] -\n          MEMORY_PRIORITY_VALUES[this.computePriority(b)];\n        if (priorityDiff !== 0) return priorityDiff;\n\n        if (strategy === 'lru') {\n          return a.lastAccessedAt - b.lastAccessedAt;\n        } else {\n          return b.sizeBytes - a.sizeBytes;\n        }\n      });\n\n    const toEvict = evictable.slice(0, count);\n    const evictedKeys: string[] = [];\n\n    for (const entry of toEvict) {\n      await this.storage.delete(entry.key);\n      this._syncEntries.delete(entry.key);\n      evictedKeys.push(entry.key);\n    }\n\n    if (evictedKeys.length > 0) {\n      this._tokenCache = null;\n    }\n\n    return evictedKeys;\n  }\n\n  /**\n   * Cleanup raw tier entries\n   */\n  async cleanupRaw(): Promise<{ deleted: number; keys: string[] }> {\n    const entries = await this.storage.getAll();\n    const rawEntries = entries.filter(e => getTierFromKey(e.key) === 'raw');\n\n    const keys: string[] = [];\n    for (const entry of rawEntries) {\n      await this.storage.delete(entry.key);\n      this._syncEntries.delete(entry.key);\n      keys.push(entry.key);\n    }\n\n    if (keys.length > 0) {\n      this._tokenCache = null;\n    }\n\n    return { deleted: keys.length, keys };\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private computePriority(entry: MemoryEntry): MemoryPriority {\n    return this.priorityCalculator(entry, this.priorityContext);\n  }\n\n  /**\n   * Build a MemoryIndex from raw entries\n   */\n  private buildMemoryIndex(entries: MemoryEntry[]): MemoryIndex {\n    const maxSize = this.config.maxSizeBytes ?? DEFAULT_MEMORY_CONFIG.maxSizeBytes!;\n    const maxIndexEntries = this.config.maxIndexEntries ?? DEFAULT_MEMORY_CONFIG.maxIndexEntries!;\n    const totalSize = entries.reduce((sum, e) => sum + e.sizeBytes, 0);\n\n    // Sort by priority (highest first), then by last access (most recent first)\n    const sorted = [...entries].sort((a, b) => {\n      const priorityDiff =\n        MEMORY_PRIORITY_VALUES[this.computePriority(b)] -\n        MEMORY_PRIORITY_VALUES[this.computePriority(a)];\n      if (priorityDiff !== 0) return priorityDiff;\n      return b.lastAccessedAt - a.lastAccessedAt;\n    });\n\n    // Limit entries for display\n    const displayed = sorted.slice(0, maxIndexEntries);\n    const omittedCount = Math.max(0, entries.length - maxIndexEntries);\n\n    const indexEntries: MemoryIndexEntry[] = displayed.map(e => ({\n      key: e.key,\n      description: e.description,\n      size: formatSizeHuman(e.sizeBytes),\n      scope: e.scope,\n      effectivePriority: this.computePriority(e),\n      pinned: e.pinned,\n    }));\n\n    return {\n      entries: indexEntries,\n      totalSizeBytes: totalSize,\n      totalSizeHuman: formatSizeHuman(totalSize),\n      limitBytes: maxSize,\n      limitHuman: formatSizeHuman(maxSize),\n      utilizationPercent: maxSize > 0 ? (totalSize / maxSize) * 100 : 0,\n      totalEntryCount: entries.length,\n      omittedCount,\n    };\n  }\n\n  private async ensureCapacity(neededBytes: number): Promise<void> {\n    const entries = await this.storage.getAll();\n    const currentSize = entries.reduce((sum, e) => sum + e.sizeBytes, 0);\n    const maxSize = this.config.maxSizeBytes ?? DEFAULT_MEMORY_CONFIG.maxSizeBytes!;\n    const maxEntries = this.config.maxIndexEntries ?? DEFAULT_MEMORY_CONFIG.maxIndexEntries!;\n\n    const needsSizeEviction = currentSize + neededBytes > maxSize;\n    const needsCountEviction = entries.length >= maxEntries;\n\n    if (!needsSizeEviction && !needsCountEviction) return;\n\n    // Sort evictable entries by priority (lowest first), then by LRU\n    const evictable = entries\n      .filter(e => !e.pinned && this.computePriority(e) !== 'critical')\n      .sort((a, b) => {\n        const priorityDiff =\n          MEMORY_PRIORITY_VALUES[this.computePriority(a)] -\n          MEMORY_PRIORITY_VALUES[this.computePriority(b)];\n        if (priorityDiff !== 0) return priorityDiff;\n        return a.lastAccessedAt - b.lastAccessedAt;\n      });\n\n    // Calculate eviction targets\n    const bytesToFree = needsSizeEviction ? currentSize + neededBytes - maxSize * 0.8 : 0;\n    const entriesToFree = needsCountEviction ? entries.length - maxEntries + 1 : 0; // +1 for incoming\n\n    let freedBytes = 0;\n    let freedCount = 0;\n\n    for (const entry of evictable) {\n      if (freedBytes >= bytesToFree && freedCount >= entriesToFree) break;\n      await this.storage.delete(entry.key);\n      this._syncEntries.delete(entry.key);\n      freedBytes += entry.sizeBytes;\n      freedCount++;\n    }\n  }\n\n  private assertNotDestroyed(): void {\n    if (this._destroyed) {\n      throw new Error('WorkingMemoryPluginNextGen is destroyed');\n    }\n  }\n\n  // ============================================================================\n  // Tool Factories\n  // ============================================================================\n\n  private createMemoryStoreTool(): ToolFunction {\n    return {\n      definition: memoryStoreDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        const result = await this.store(\n          args.key as string,\n          args.description as string,\n          args.value,\n          {\n            tier: args.tier as MemoryTier | undefined,\n            scope: args.scope as MemoryScope | undefined,\n            priority: args.priority as MemoryPriority | undefined,\n            pinned: args.pinned as boolean | undefined,\n          }\n        );\n        return { success: true, ...result };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `store ${args.key}`,\n    };\n  }\n\n  private createMemoryRetrieveTool(): ToolFunction {\n    return {\n      definition: memoryRetrieveDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        const value = await this.retrieve(args.key as string);\n        if (value === undefined) {\n          return { found: false, key: args.key };\n        }\n        return { found: true, key: args.key, value };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `retrieve ${args.key}`,\n    };\n  }\n\n  private createMemoryDeleteTool(): ToolFunction {\n    return {\n      definition: memoryDeleteDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        const deleted = await this.delete(args.key as string);\n        return { deleted, key: args.key };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `delete ${args.key}`,\n    };\n  }\n\n  private createMemoryQueryTool(): ToolFunction {\n    return {\n      definition: memoryQueryDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        return await this.query({\n          pattern: args.pattern as string | undefined,\n          tier: args.tier as MemoryTier | undefined,\n          includeValues: args.includeValues as boolean | undefined,\n          includeStats: args.includeStats as boolean | undefined,\n        });\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => args.pattern ? `query ${args.pattern}` : 'query all',\n    };\n  }\n\n  private createMemoryCleanupRawTool(): ToolFunction {\n    return {\n      definition: memoryCleanupRawDefinition,\n      execute: async () => {\n        return await this.cleanupRaw();\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: () => 'cleanup raw tier',\n    };\n  }\n}\n","/**\n * InContextMemoryPluginNextGen - In-context key-value storage for NextGen context\n *\n * Unlike WorkingMemory (external storage with index), InContextMemory stores\n * data DIRECTLY in the LLM context. Values are immediately visible.\n *\n * Use for:\n * - Current state/status that changes frequently\n * - User preferences during a session\n * - Small accumulated results\n * - Counters, flags, control variables\n *\n * Do NOT use for:\n * - Large data (use WorkingMemory)\n * - Rarely accessed reference data\n */\n\nimport type { IContextPluginNextGen, ITokenEstimator } from '../types.js';\nimport type { ToolFunction } from '../../../domain/entities/Tool.js';\nimport { simpleTokenEstimator } from '../BasePluginNextGen.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport type InContextPriority = 'low' | 'normal' | 'high' | 'critical';\n\nexport interface InContextEntry {\n  key: string;\n  description: string;\n  value: unknown;\n  updatedAt: number;\n  priority: InContextPriority;\n  /** If true, this entry is displayed in the user's side panel UI */\n  showInUI?: boolean;\n}\n\nexport interface InContextMemoryConfig {\n  /** Maximum number of entries (default: 20) */\n  maxEntries?: number;\n  /** Maximum total tokens for all entries (default: 4000) */\n  maxTotalTokens?: number;\n  /** Default priority for new entries (default: 'normal') */\n  defaultPriority?: InContextPriority;\n  /** Whether to show timestamps in output (default: false) */\n  showTimestamps?: boolean;\n  /** Callback fired when entries change. Receives all current entries. */\n  onEntriesChanged?: (entries: InContextEntry[]) => void;\n}\n\nexport interface SerializedInContextMemoryState {\n  entries: InContextEntry[];\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst PRIORITY_VALUES: Record<InContextPriority, number> = {\n  low: 1,\n  normal: 2,\n  high: 3,\n  critical: 4,\n};\n\nconst DEFAULT_CONFIG = {\n  maxEntries: 20,\n  maxTotalTokens: 40000,\n  defaultPriority: 'normal' as InContextPriority,\n  showTimestamps: false,\n};\n\n// ============================================================================\n// Instructions\n// ============================================================================\n\nconst IN_CONTEXT_MEMORY_INSTRUCTIONS = `In-Context Memory stores key-value pairs DIRECTLY in context.\nValues are immediately visible - no retrieval needed.\n\n**Use for:** Current state, preferences, counters, small results.\n**Do NOT use for:** Large data (use Working Memory instead).\n\n**Priority levels** (for eviction when space is tight):\n- \\`low\\`: Evicted first. Temporary data.\n- \\`normal\\`: Default. Standard importance.\n- \\`high\\`: Keep longer. Important state.\n- \\`critical\\`: Never auto-evicted.\n\n**UI Display:** Set \\`showInUI: true\\` in context_set to display the entry in the user's side panel.\nValues shown in the UI support the same rich markdown formatting as the chat window\n(see formatting instructions above). Use this for dashboards, progress displays, and results the user should see.\n\n**Tools:** context_set, context_delete, context_list`;\n\n// ============================================================================\n// Tool Definitions\n// ============================================================================\n\nconst contextSetDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'context_set',\n    description: `Store or update a key-value pair in live context.\nValue appears directly in context - no retrieval needed.\nSet showInUI to true to also display the entry in the user's side panel.`,\n    parameters: {\n      type: 'object',\n      properties: {\n        key: { type: 'string', description: 'Unique key (e.g., \"current_state\")' },\n        description: { type: 'string', description: 'Brief description (shown in context)' },\n        value: { description: 'Value to store (any JSON-serializable data)' },\n        priority: {\n          type: 'string',\n          enum: ['low', 'normal', 'high', 'critical'],\n          description: 'Eviction priority. Default: \"normal\"',\n        },\n        showInUI: {\n          type: 'boolean',\n          description: 'If true, display this entry in the user\\'s side panel with full rich markdown rendering  same capabilities as the chat window (code blocks, tables, LaTeX, Mermaid diagrams, Vega-Lite charts, mindmaps, etc.  see formatting instructions in system prompt). Use this for dashboards, status displays, and structured results the user should see. Default: false',\n        },\n      },\n      required: ['key', 'description', 'value'],\n    },\n  },\n};\n\nconst contextDeleteDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'context_delete',\n    description: 'Delete an entry from live context to free space.',\n    parameters: {\n      type: 'object',\n      properties: {\n        key: { type: 'string', description: 'Key to delete' },\n      },\n      required: ['key'],\n    },\n  },\n};\n\nconst contextListDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'context_list',\n    description: 'List all keys in live context with metadata.',\n    parameters: {\n      type: 'object',\n      properties: {},\n      required: [],\n    },\n  },\n};\n\n// ============================================================================\n// Plugin Implementation\n// ============================================================================\n\nexport class InContextMemoryPluginNextGen implements IContextPluginNextGen {\n  readonly name = 'in_context_memory';\n\n  private entries: Map<string, InContextEntry> = new Map();\n  private config: {\n    maxEntries: number;\n    maxTotalTokens: number;\n    defaultPriority: InContextPriority;\n    showTimestamps: boolean;\n    onEntriesChanged?: (entries: InContextEntry[]) => void;\n  };\n  private estimator: ITokenEstimator = simpleTokenEstimator;\n\n  private _destroyed = false;\n  private _tokenCache: number | null = null;\n  private _instructionsTokenCache: number | null = null;\n  private _notifyTimer: ReturnType<typeof setTimeout> | null = null;\n\n  constructor(config: InContextMemoryConfig = {}) {\n    this.config = { ...DEFAULT_CONFIG, ...config };\n  }\n\n  // ============================================================================\n  // IContextPluginNextGen Implementation\n  // ============================================================================\n\n  getInstructions(): string {\n    return IN_CONTEXT_MEMORY_INSTRUCTIONS;\n  }\n\n  async getContent(): Promise<string | null> {\n    if (this.entries.size === 0) {\n      return null;\n    }\n\n    const content = this.formatEntries();\n    this._tokenCache = this.estimator.estimateTokens(content);\n    return content;\n  }\n\n  getContents(): Map<string, InContextEntry> {\n    return new Map(this.entries);\n  }\n\n  getTokenSize(): number {\n    return this._tokenCache ?? 0;\n  }\n\n  getInstructionsTokenSize(): number {\n    if (this._instructionsTokenCache === null) {\n      this._instructionsTokenCache = this.estimator.estimateTokens(IN_CONTEXT_MEMORY_INSTRUCTIONS);\n    }\n    return this._instructionsTokenCache;\n  }\n\n  isCompactable(): boolean {\n    return true;\n  }\n\n  async compact(targetTokensToFree: number): Promise<number> {\n    // TODO: Implement smart compaction\n    // For now, evict lowest priority entries until we free enough\n    const before = this.getTokenSize();\n\n    const evictable = Array.from(this.entries.values())\n      .filter(e => e.priority !== 'critical')\n      .sort((a, b) => {\n        const priorityDiff = PRIORITY_VALUES[a.priority] - PRIORITY_VALUES[b.priority];\n        if (priorityDiff !== 0) return priorityDiff;\n        return a.updatedAt - b.updatedAt; // Oldest first within same priority\n      });\n\n    let freed = 0;\n    let evicted = false;\n    for (const entry of evictable) {\n      if (freed >= targetTokensToFree) break;\n      const entryTokens = this.estimator.estimateTokens(this.formatEntry(entry));\n      this.entries.delete(entry.key);\n      freed += entryTokens;\n      evicted = true;\n    }\n\n    this._tokenCache = null;\n    const content = await this.getContent();\n    const after = content ? this.estimator.estimateTokens(content) : 0;\n\n    if (evicted) this.notifyEntriesChanged();\n\n    return Math.max(0, before - after);\n  }\n\n  getTools(): ToolFunction[] {\n    return [\n      this.createContextSetTool(),\n      this.createContextDeleteTool(),\n      this.createContextListTool(),\n    ];\n  }\n\n  destroy(): void {\n    if (this._destroyed) return;\n    if (this._notifyTimer) clearTimeout(this._notifyTimer);\n    this.entries.clear();\n    this._destroyed = true;\n    this._tokenCache = null;\n  }\n\n  getState(): SerializedInContextMemoryState {\n    return {\n      entries: Array.from(this.entries.values()),\n    };\n  }\n\n  restoreState(state: unknown): void {\n    const s = state as SerializedInContextMemoryState;\n    if (!s || !s.entries) return;\n\n    this.entries.clear();\n    for (const entry of s.entries) {\n      this.entries.set(entry.key, entry);\n    }\n    this._tokenCache = null;\n    this.notifyEntriesChanged();\n  }\n\n  // ============================================================================\n  // Entry Management\n  // ============================================================================\n\n  /**\n   * Store or update a key-value pair\n   */\n  set(key: string, description: string, value: unknown, priority?: InContextPriority, showInUI?: boolean): void {\n    this.assertNotDestroyed();\n\n    const entry: InContextEntry = {\n      key,\n      description,\n      value,\n      updatedAt: Date.now(),\n      priority: priority ?? this.config.defaultPriority,\n      showInUI: showInUI ?? false,\n    };\n\n    this.entries.set(key, entry);\n    this.enforceMaxEntries();\n    this.enforceTokenLimit();\n    this._tokenCache = null;\n    this.notifyEntriesChanged();\n  }\n\n  /**\n   * Get a value by key\n   */\n  get(key: string): unknown | undefined {\n    this.assertNotDestroyed();\n    return this.entries.get(key)?.value;\n  }\n\n  /**\n   * Check if a key exists\n   */\n  has(key: string): boolean {\n    this.assertNotDestroyed();\n    return this.entries.has(key);\n  }\n\n  /**\n   * Delete an entry\n   */\n  delete(key: string): boolean {\n    this.assertNotDestroyed();\n    const deleted = this.entries.delete(key);\n    if (deleted) {\n      this._tokenCache = null;\n      this.notifyEntriesChanged();\n    }\n    return deleted;\n  }\n\n  /**\n   * List all entries with metadata\n   */\n  list(): Array<{ key: string; description: string; priority: InContextPriority; updatedAt: number; showInUI: boolean }> {\n    this.assertNotDestroyed();\n    return Array.from(this.entries.values()).map(e => ({\n      key: e.key,\n      description: e.description,\n      priority: e.priority,\n      updatedAt: e.updatedAt,\n      showInUI: e.showInUI ?? false,\n    }));\n  }\n\n  /**\n   * Clear all entries\n   */\n  clear(): void {\n    this.assertNotDestroyed();\n    this.entries.clear();\n    this._tokenCache = null;\n    this.notifyEntriesChanged();\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private formatEntries(): string {\n    const lines: string[] = [];\n\n    const sorted = Array.from(this.entries.values())\n      .sort((a, b) => PRIORITY_VALUES[b.priority] - PRIORITY_VALUES[a.priority]);\n\n    for (const entry of sorted) {\n      lines.push(this.formatEntry(entry));\n    }\n\n    return lines.join('\\n\\n');\n  }\n\n  private formatEntry(entry: InContextEntry): string {\n    const valueStr = typeof entry.value === 'string'\n      ? entry.value\n      : JSON.stringify(entry.value, null, 2);\n\n    let line = `**${entry.key}** (${entry.priority}): ${entry.description}`;\n    if (this.config.showTimestamps) {\n      line += ` [${new Date(entry.updatedAt).toISOString()}]`;\n    }\n    line += `\\n\\`\\`\\`\\n${valueStr}\\n\\`\\`\\``;\n\n    return line;\n  }\n\n  private enforceMaxEntries(): void {\n    if (this.entries.size <= this.config.maxEntries) return;\n\n    // Evict lowest priority, oldest entries\n    const evictable = this.getEvictableEntries();\n\n    while (this.entries.size > this.config.maxEntries && evictable.length > 0) {\n      const toEvict = evictable.shift()!;\n      this.entries.delete(toEvict.key);\n    }\n  }\n\n  private enforceTokenLimit(): void {\n    const maxTokens = this.config.maxTotalTokens;\n    if (maxTokens <= 0) return;\n\n    let totalTokens = this.estimateTotalTokens();\n    if (totalTokens <= maxTokens) return;\n\n    // Evict lowest priority, oldest entries until under limit\n    const evictable = this.getEvictableEntries();\n\n    while (totalTokens > maxTokens && evictable.length > 0) {\n      const toEvict = evictable.shift()!;\n      const entryTokens = this.estimator.estimateTokens(this.formatEntry(toEvict));\n      this.entries.delete(toEvict.key);\n      totalTokens -= entryTokens;\n    }\n  }\n\n  private estimateTotalTokens(): number {\n    let total = 0;\n    for (const entry of this.entries.values()) {\n      total += this.estimator.estimateTokens(this.formatEntry(entry));\n    }\n    return total;\n  }\n\n  /**\n   * Get entries sorted by eviction priority (lowest priority, oldest first).\n   * Critical entries are excluded.\n   */\n  private getEvictableEntries(): InContextEntry[] {\n    return Array.from(this.entries.values())\n      .filter(e => e.priority !== 'critical')\n      .sort((a, b) => {\n        const priorityDiff = PRIORITY_VALUES[a.priority] - PRIORITY_VALUES[b.priority];\n        if (priorityDiff !== 0) return priorityDiff;\n        return a.updatedAt - b.updatedAt;\n      });\n  }\n\n  /**\n   * Debounced notification when entries change.\n   * Calls config.onEntriesChanged with all current entries.\n   */\n  private notifyEntriesChanged(): void {\n    if (!this.config.onEntriesChanged) return;\n\n    if (this._notifyTimer) clearTimeout(this._notifyTimer);\n    this._notifyTimer = setTimeout(() => {\n      this._notifyTimer = null;\n      if (!this._destroyed && this.config.onEntriesChanged) {\n        this.config.onEntriesChanged(Array.from(this.entries.values()));\n      }\n    }, 100);\n  }\n\n  private assertNotDestroyed(): void {\n    if (this._destroyed) {\n      throw new Error('InContextMemoryPluginNextGen is destroyed');\n    }\n  }\n\n  // ============================================================================\n  // Tool Factories\n  // ============================================================================\n\n  private createContextSetTool(): ToolFunction {\n    return {\n      definition: contextSetDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        this.set(\n          args.key as string,\n          args.description as string,\n          args.value,\n          args.priority as InContextPriority | undefined,\n          args.showInUI as boolean | undefined\n        );\n        return {\n          success: true,\n          key: args.key,\n          showInUI: args.showInUI ?? false,\n          message: `Stored \"${args.key}\" in live context${args.showInUI ? ' (visible in UI)' : ''}`,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `set ${args.key}${args.showInUI ? ' [UI]' : ''}`,\n    };\n  }\n\n  private createContextDeleteTool(): ToolFunction {\n    return {\n      definition: contextDeleteDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        const deleted = this.delete(args.key as string);\n        return { deleted, key: args.key };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `delete ${args.key}`,\n    };\n  }\n\n  private createContextListTool(): ToolFunction {\n    return {\n      definition: contextListDefinition,\n      execute: async () => {\n        return { entries: this.list() };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: () => 'list entries',\n    };\n  }\n}\n","/**\n * FilePersistentInstructionsStorage - File-based storage for persistent instructions\n *\n * Stores custom agent instructions as a JSON file on disk.\n * Path: ~/.oneringai/agents/<agentId>/custom_instructions.json\n * Windows: %APPDATA%/oneringai/agents/<agentId>/custom_instructions.json\n *\n * Features:\n * - Cross-platform path handling\n * - Safe agent ID sanitization\n * - Atomic file operations\n * - Automatic directory creation\n * - Legacy .md file migration\n */\n\nimport { promises as fs } from 'fs';\nimport { join } from 'path';\nimport { homedir } from 'os';\nimport type { IPersistentInstructionsStorage, InstructionEntry } from '../../domain/interfaces/IPersistentInstructionsStorage.js';\n\n/**\n * Configuration for FilePersistentInstructionsStorage\n */\nexport interface FilePersistentInstructionsStorageConfig {\n  /** Agent ID (used to create unique storage path) */\n  agentId: string;\n  /** Override the base directory (default: ~/.oneringai/agents) */\n  baseDirectory?: string;\n  /** Override the filename (default: custom_instructions.json) */\n  filename?: string;\n}\n\n/**\n * On-disk JSON format for instruction entries\n */\ninterface StoredInstructionsFile {\n  version: 2;\n  entries: InstructionEntry[];\n}\n\n/**\n * Get the default base directory for persistent instructions\n * Uses ~/.oneringai/agents on Unix-like systems\n * Uses %APPDATA%/oneringai/agents on Windows\n */\nfunction getDefaultBaseDirectory(): string {\n  const platform = process.platform;\n\n  if (platform === 'win32') {\n    // Windows: Use APPDATA if available, otherwise fall back to home\n    const appData = process.env.APPDATA || process.env.LOCALAPPDATA;\n    if (appData) {\n      return join(appData, 'oneringai', 'agents');\n    }\n  }\n\n  // Unix-like (Linux, macOS) and fallback: Use home directory\n  return join(homedir(), '.oneringai', 'agents');\n}\n\n/**\n * Sanitize agent ID for use as a directory name\n * Removes or replaces characters that are not safe for filenames\n */\nfunction sanitizeAgentId(agentId: string): string {\n  // Replace any character that isn't alphanumeric, dash, or underscore\n  // Also collapse multiple consecutive safe characters into one\n  return agentId\n    .replace(/[^a-zA-Z0-9_-]/g, '_')  // Replace unsafe chars with underscore\n    .replace(/_+/g, '_')               // Collapse multiple underscores\n    .replace(/^_|_$/g, '')             // Remove leading/trailing underscores\n    .toLowerCase()                      // Normalize to lowercase\n    || 'default';                       // Fallback if empty\n}\n\n/**\n * File-based storage for persistent agent instructions\n */\nexport class FilePersistentInstructionsStorage implements IPersistentInstructionsStorage {\n  private readonly directory: string;\n  private readonly filePath: string;\n  private readonly legacyFilePath: string;\n  private readonly agentId: string;\n\n  constructor(config: FilePersistentInstructionsStorageConfig) {\n    this.agentId = config.agentId;\n    const sanitizedId = sanitizeAgentId(config.agentId);\n    const baseDir = config.baseDirectory ?? getDefaultBaseDirectory();\n    const filename = config.filename ?? 'custom_instructions.json';\n\n    this.directory = join(baseDir, sanitizedId);\n    this.filePath = join(this.directory, filename);\n    this.legacyFilePath = join(this.directory, 'custom_instructions.md');\n  }\n\n  /**\n   * Load instruction entries from file.\n   * Falls back to legacy .md file migration if JSON not found.\n   */\n  async load(): Promise<InstructionEntry[] | null> {\n    // Try JSON file first\n    try {\n      const raw = await fs.readFile(this.filePath, 'utf-8');\n      const data = JSON.parse(raw) as StoredInstructionsFile;\n      if (data.version === 2 && Array.isArray(data.entries)) {\n        return data.entries.length > 0 ? data.entries : null;\n      }\n      return null;\n    } catch (error: unknown) {\n      if (!(error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT')) {\n        throw error;\n      }\n      // JSON file not found  try legacy .md migration\n    }\n\n    // Try legacy .md file\n    try {\n      const content = await fs.readFile(this.legacyFilePath, 'utf-8');\n      const trimmed = content.trim();\n      if (!trimmed) return null;\n\n      const now = Date.now();\n      return [{\n        id: 'legacy_instructions',\n        content: trimmed,\n        createdAt: now,\n        updatedAt: now,\n      }];\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Save instruction entries to file as JSON.\n   * Creates directory if it doesn't exist.\n   * Cleans up legacy .md file if present.\n   */\n  async save(entries: InstructionEntry[]): Promise<void> {\n    await this.ensureDirectory();\n\n    const data: StoredInstructionsFile = {\n      version: 2,\n      entries,\n    };\n\n    // Write atomically: write to temp file, then rename\n    const tempPath = `${this.filePath}.tmp`;\n    try {\n      await fs.writeFile(tempPath, JSON.stringify(data, null, 2), 'utf-8');\n      await fs.rename(tempPath, this.filePath);\n    } catch (error) {\n      // Clean up temp file if rename failed\n      try {\n        await fs.unlink(tempPath);\n      } catch {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n\n    // Clean up legacy .md file if it exists\n    await this.removeLegacyFile();\n  }\n\n  /**\n   * Delete instructions file (and legacy .md if exists)\n   */\n  async delete(): Promise<void> {\n    try {\n      await fs.unlink(this.filePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n\n    await this.removeLegacyFile();\n  }\n\n  /**\n   * Check if instructions file exists (JSON or legacy .md)\n   */\n  async exists(): Promise<boolean> {\n    try {\n      await fs.access(this.filePath);\n      return true;\n    } catch {\n      // Also check legacy file\n      try {\n        await fs.access(this.legacyFilePath);\n        return true;\n      } catch {\n        return false;\n      }\n    }\n  }\n\n  /**\n   * Get the file path (for display/debugging)\n   */\n  getPath(): string {\n    return this.filePath;\n  }\n\n  /**\n   * Get the agent ID\n   */\n  getAgentId(): string {\n    return this.agentId;\n  }\n\n  /**\n   * Ensure the directory exists\n   */\n  private async ensureDirectory(): Promise<void> {\n    try {\n      await fs.mkdir(this.directory, { recursive: true });\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * Remove legacy .md file if it exists\n   */\n  private async removeLegacyFile(): Promise<void> {\n    try {\n      await fs.unlink(this.legacyFilePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        // Log but don't throw  this is a best-effort cleanup\n        console.warn(`Failed to remove legacy instructions file: ${this.legacyFilePath}`);\n      }\n    }\n  }\n}\n","/**\n * PersistentInstructionsPluginNextGen - Disk-persisted KVP instructions for NextGen context\n *\n * Stores custom instructions as individually keyed entries that persist across sessions on disk.\n * These are NEVER compacted - always included in context.\n *\n * Use cases:\n * - Agent personality/behavior customization\n * - User-specific preferences\n * - Accumulated knowledge/rules\n * - Custom tool usage guidelines\n *\n * Storage: ~/.oneringai/agents/<agentId>/custom_instructions.json\n */\n\nimport type { IContextPluginNextGen, ITokenEstimator } from '../types.js';\nimport type { ToolFunction } from '../../../domain/entities/Tool.js';\nimport type { IPersistentInstructionsStorage, InstructionEntry } from '../../../domain/interfaces/IPersistentInstructionsStorage.js';\nimport { FilePersistentInstructionsStorage } from '../../../infrastructure/storage/FilePersistentInstructionsStorage.js';\nimport { simpleTokenEstimator } from '../BasePluginNextGen.js';\nimport { StorageRegistry } from '../../StorageRegistry.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport type { InstructionEntry } from '../../../domain/interfaces/IPersistentInstructionsStorage.js';\n\nexport interface PersistentInstructionsConfig {\n  /** Agent ID - used to determine storage path (REQUIRED) */\n  agentId: string;\n  /** Custom storage implementation (default: FilePersistentInstructionsStorage) */\n  storage?: IPersistentInstructionsStorage;\n  /** Maximum total content length across all entries in characters (default: 50000) */\n  maxTotalLength?: number;\n  /** Maximum number of entries (default: 50) */\n  maxEntries?: number;\n}\n\nexport interface SerializedPersistentInstructionsState {\n  entries: InstructionEntry[];\n  agentId: string;\n  version: 2;\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst DEFAULT_MAX_TOTAL_LENGTH = 50000;\nconst DEFAULT_MAX_ENTRIES = 50;\nconst KEY_MAX_LENGTH = 100;\nconst KEY_PATTERN = /^[a-zA-Z0-9_-]+$/;\n\n// ============================================================================\n// Instructions\n// ============================================================================\n\nconst PERSISTENT_INSTRUCTIONS_INSTRUCTIONS = `Persistent Instructions are stored on disk and survive across sessions.\nEach instruction is a keyed entry that can be independently managed.\n\n**To modify:**\n- \\`instructions_set(key, content)\\`: Add or update a single instruction by key\n- \\`instructions_remove(key)\\`: Remove a single instruction by key\n- \\`instructions_list()\\`: List all instructions with keys and content\n- \\`instructions_clear(confirm: true)\\`: Remove all instructions (destructive!)\n\n**Use for:** Agent personality, user preferences, learned rules, guidelines.`;\n\n// ============================================================================\n// Tool Definitions\n// ============================================================================\n\nconst instructionsSetDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'instructions_set',\n    description: `Add or update a single persistent instruction by key. Persists across sessions.\nIf the key exists, it will be updated. If not, a new entry is created.`,\n    parameters: {\n      type: 'object',\n      properties: {\n        key: {\n          type: 'string',\n          description: 'Unique key for the instruction (alphanumeric, dash, underscore; max 100 chars)',\n        },\n        content: {\n          type: 'string',\n          description: 'Instruction content (markdown supported)',\n        },\n      },\n      required: ['key', 'content'],\n    },\n  },\n};\n\nconst instructionsRemoveDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'instructions_remove',\n    description: 'Remove a single persistent instruction by key.',\n    parameters: {\n      type: 'object',\n      properties: {\n        key: {\n          type: 'string',\n          description: 'Key of the instruction to remove',\n        },\n      },\n      required: ['key'],\n    },\n  },\n};\n\nconst instructionsListDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'instructions_list',\n    description: 'List all persistent instructions with their keys and content.',\n    parameters: {\n      type: 'object',\n      properties: {},\n      required: [],\n    },\n  },\n};\n\nconst instructionsClearDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'instructions_clear',\n    description: 'Clear all persistent instructions (DESTRUCTIVE). Requires confirmation.',\n    parameters: {\n      type: 'object',\n      properties: {\n        confirm: {\n          type: 'boolean',\n          description: 'Must be true to confirm deletion',\n        },\n      },\n      required: ['confirm'],\n    },\n  },\n};\n\n// ============================================================================\n// Key Validation\n// ============================================================================\n\nfunction validateKey(key: unknown): string | null {\n  if (typeof key !== 'string') return 'Key must be a string';\n  const trimmed = key.trim();\n  if (trimmed.length === 0) return 'Key cannot be empty';\n  if (trimmed.length > KEY_MAX_LENGTH) return `Key exceeds maximum length (${KEY_MAX_LENGTH} chars)`;\n  if (!KEY_PATTERN.test(trimmed)) return 'Key must contain only alphanumeric characters, dashes, and underscores';\n  return null;\n}\n\n// ============================================================================\n// Plugin Implementation\n// ============================================================================\n\nexport class PersistentInstructionsPluginNextGen implements IContextPluginNextGen {\n  readonly name = 'persistent_instructions';\n\n  private _entries: Map<string, InstructionEntry> = new Map();\n  private _initialized = false;\n  private _destroyed = false;\n\n  private readonly storage: IPersistentInstructionsStorage;\n  private readonly maxTotalLength: number;\n  private readonly maxEntries: number;\n  private readonly agentId: string;\n  private readonly estimator: ITokenEstimator = simpleTokenEstimator;\n\n  private _tokenCache: number | null = null;\n  private _instructionsTokenCache: number | null = null;\n\n  constructor(config: PersistentInstructionsConfig) {\n    if (!config.agentId) {\n      throw new Error('PersistentInstructionsPluginNextGen requires agentId');\n    }\n\n    this.agentId = config.agentId;\n    this.maxTotalLength = config.maxTotalLength ?? DEFAULT_MAX_TOTAL_LENGTH;\n    this.maxEntries = config.maxEntries ?? DEFAULT_MAX_ENTRIES;\n    const registryFactory = StorageRegistry.get('persistentInstructions');\n    this.storage = config.storage\n      ?? registryFactory?.(config.agentId, StorageRegistry.getContext())\n      ?? new FilePersistentInstructionsStorage({ agentId: config.agentId });\n  }\n\n  // ============================================================================\n  // IContextPluginNextGen Implementation\n  // ============================================================================\n\n  getInstructions(): string {\n    return PERSISTENT_INSTRUCTIONS_INSTRUCTIONS;\n  }\n\n  async getContent(): Promise<string | null> {\n    await this.ensureInitialized();\n\n    if (this._entries.size === 0) {\n      this._tokenCache = 0;\n      return null;\n    }\n\n    const rendered = this.renderContent();\n    this._tokenCache = this.estimator.estimateTokens(rendered);\n    return rendered;\n  }\n\n  getContents(): Map<string, InstructionEntry> {\n    return new Map(this._entries);\n  }\n\n  getTokenSize(): number {\n    return this._tokenCache ?? 0;\n  }\n\n  getInstructionsTokenSize(): number {\n    if (this._instructionsTokenCache === null) {\n      this._instructionsTokenCache = this.estimator.estimateTokens(PERSISTENT_INSTRUCTIONS_INSTRUCTIONS);\n    }\n    return this._instructionsTokenCache;\n  }\n\n  isCompactable(): boolean {\n    // Persistent instructions are NEVER compacted\n    return false;\n  }\n\n  async compact(_targetTokensToFree: number): Promise<number> {\n    // Never compacted\n    return 0;\n  }\n\n  getTools(): ToolFunction[] {\n    return [\n      this.createInstructionsSetTool(),\n      this.createInstructionsRemoveTool(),\n      this.createInstructionsListTool(),\n      this.createInstructionsClearTool(),\n    ];\n  }\n\n  destroy(): void {\n    if (this._destroyed) return;\n    this._entries.clear();\n    this._destroyed = true;\n    this._tokenCache = null;\n  }\n\n  getState(): SerializedPersistentInstructionsState {\n    return {\n      entries: Array.from(this._entries.values()),\n      agentId: this.agentId,\n      version: 2,\n    };\n  }\n\n  restoreState(state: unknown): void {\n    if (!state || typeof state !== 'object') return;\n\n    const s = state as Record<string, unknown>;\n\n    // New format: { entries: InstructionEntry[], version: 2 }\n    if ('version' in s && s.version === 2 && Array.isArray(s.entries)) {\n      this._entries.clear();\n      for (const entry of s.entries as InstructionEntry[]) {\n        this._entries.set(entry.id, entry);\n      }\n      this._initialized = true;\n      this._tokenCache = null;\n      return;\n    }\n\n    // Legacy format: { content: string | null }\n    if ('content' in s) {\n      this._entries.clear();\n      const content = s.content as string | null;\n      if (content) {\n        const now = Date.now();\n        this._entries.set('legacy_instructions', {\n          id: 'legacy_instructions',\n          content,\n          createdAt: now,\n          updatedAt: now,\n        });\n      }\n      this._initialized = true;\n      this._tokenCache = null;\n    }\n  }\n\n  // ============================================================================\n  // Public API\n  // ============================================================================\n\n  /**\n   * Initialize by loading from storage (called lazily)\n   */\n  async initialize(): Promise<void> {\n    if (this._initialized || this._destroyed) return;\n\n    try {\n      const entries = await this.storage.load();\n      this._entries.clear();\n      if (entries) {\n        for (const entry of entries) {\n          this._entries.set(entry.id, entry);\n        }\n      }\n      this._initialized = true;\n    } catch (error) {\n      console.warn(`Failed to load persistent instructions for agent '${this.agentId}':`, error);\n      this._entries.clear();\n      this._initialized = true;\n    }\n    this._tokenCache = null;\n  }\n\n  /**\n   * Add or update an instruction entry by key\n   */\n  async set(key: string, content: string): Promise<boolean> {\n    this.assertNotDestroyed();\n    await this.ensureInitialized();\n\n    const keyError = validateKey(key);\n    if (keyError) return false;\n\n    const trimmedContent = content.trim();\n    if (trimmedContent.length === 0) return false;\n\n    // Check maxEntries (new entry only)\n    if (!this._entries.has(key) && this._entries.size >= this.maxEntries) {\n      return false;\n    }\n\n    // Check maxTotalLength\n    const currentTotal = this.calculateTotalContentLength();\n    const existingLength = this._entries.get(key)?.content.length ?? 0;\n    const newTotal = currentTotal - existingLength + trimmedContent.length;\n    if (newTotal > this.maxTotalLength) {\n      return false;\n    }\n\n    const now = Date.now();\n    const existing = this._entries.get(key);\n    this._entries.set(key, {\n      id: key,\n      content: trimmedContent,\n      createdAt: existing?.createdAt ?? now,\n      updatedAt: now,\n    });\n\n    await this.persistToStorage();\n    this._tokenCache = null;\n    return true;\n  }\n\n  /**\n   * Remove an instruction entry by key\n   */\n  async remove(key: string): Promise<boolean> {\n    this.assertNotDestroyed();\n    await this.ensureInitialized();\n\n    if (!this._entries.has(key)) return false;\n\n    this._entries.delete(key);\n\n    if (this._entries.size === 0) {\n      await this.storage.delete();\n    } else {\n      await this.persistToStorage();\n    }\n\n    this._tokenCache = null;\n    return true;\n  }\n\n  /**\n   * Get one entry by key, or all entries if no key provided\n   */\n  async get(key?: string): Promise<InstructionEntry | InstructionEntry[] | null> {\n    this.assertNotDestroyed();\n    await this.ensureInitialized();\n\n    if (key !== undefined) {\n      return this._entries.get(key) ?? null;\n    }\n\n    if (this._entries.size === 0) return null;\n    return this.getSortedEntries();\n  }\n\n  /**\n   * List metadata for all entries\n   */\n  async list(): Promise<{ key: string; contentLength: number; createdAt: number; updatedAt: number }[]> {\n    this.assertNotDestroyed();\n    await this.ensureInitialized();\n\n    return this.getSortedEntries().map(entry => ({\n      key: entry.id,\n      contentLength: entry.content.length,\n      createdAt: entry.createdAt,\n      updatedAt: entry.updatedAt,\n    }));\n  }\n\n  /**\n   * Clear all instruction entries\n   */\n  async clear(): Promise<void> {\n    this.assertNotDestroyed();\n    this._entries.clear();\n    await this.storage.delete();\n    this._tokenCache = null;\n  }\n\n  /**\n   * Check if initialized\n   */\n  get isInitialized(): boolean {\n    return this._initialized;\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private async ensureInitialized(): Promise<void> {\n    if (!this._initialized) {\n      await this.initialize();\n    }\n  }\n\n  private assertNotDestroyed(): void {\n    if (this._destroyed) {\n      throw new Error('PersistentInstructionsPluginNextGen is destroyed');\n    }\n  }\n\n  /**\n   * Persist current entries to storage\n   */\n  private async persistToStorage(): Promise<void> {\n    await this.storage.save(Array.from(this._entries.values()));\n  }\n\n  /**\n   * Calculate total content length across all entries\n   */\n  private calculateTotalContentLength(): number {\n    let total = 0;\n    for (const entry of this._entries.values()) {\n      total += entry.content.length;\n    }\n    return total;\n  }\n\n  /**\n   * Get entries sorted by createdAt (oldest first)\n   */\n  private getSortedEntries(): InstructionEntry[] {\n    return Array.from(this._entries.values()).sort((a, b) => a.createdAt - b.createdAt);\n  }\n\n  /**\n   * Render all entries as markdown for context injection\n   */\n  private renderContent(): string {\n    return this.getSortedEntries()\n      .map(entry => `### ${entry.id}\\n${entry.content}`)\n      .join('\\n\\n');\n  }\n\n  // ============================================================================\n  // Tool Factories\n  // ============================================================================\n\n  private createInstructionsSetTool(): ToolFunction {\n    return {\n      definition: instructionsSetDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        const key = args.key as string;\n        const content = args.content as string;\n\n        const keyError = validateKey(key);\n        if (keyError) {\n          return { error: keyError };\n        }\n\n        if (!content || content.trim().length === 0) {\n          return { error: 'Content cannot be empty. Use instructions_remove to delete an entry.' };\n        }\n\n        const isUpdate = this._entries.has(key.trim());\n        const success = await this.set(key.trim(), content);\n        if (!success) {\n          if (!isUpdate && this._entries.size >= this.maxEntries) {\n            return { error: `Maximum number of entries reached (${this.maxEntries})` };\n          }\n          return { error: `Content would exceed maximum total length (${this.maxTotalLength} chars)` };\n        }\n\n        return {\n          success: true,\n          message: isUpdate ? `Instruction '${key.trim()}' updated` : `Instruction '${key.trim()}' added`,\n          key: key.trim(),\n          contentLength: content.trim().length,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `set instruction '${args.key}'`,\n    };\n  }\n\n  private createInstructionsRemoveTool(): ToolFunction {\n    return {\n      definition: instructionsRemoveDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        const key = args.key as string;\n\n        if (!key || typeof key !== 'string' || key.trim().length === 0) {\n          return { error: 'Key is required' };\n        }\n\n        const success = await this.remove(key.trim());\n        if (!success) {\n          return { error: `Instruction '${key.trim()}' not found` };\n        }\n\n        return {\n          success: true,\n          message: `Instruction '${key.trim()}' removed`,\n          key: key.trim(),\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `remove instruction '${args.key}'`,\n    };\n  }\n\n  private createInstructionsListTool(): ToolFunction {\n    return {\n      definition: instructionsListDefinition,\n      execute: async () => {\n        const entries = await this.list();\n        const all = await this.get();\n\n        if (entries.length === 0) {\n          return {\n            count: 0,\n            entries: [],\n            message: '(no custom instructions set)',\n          };\n        }\n\n        // Include full content in the listing for transparency\n        const allEntries = all as InstructionEntry[];\n        return {\n          count: entries.length,\n          entries: allEntries.map(e => ({\n            key: e.id,\n            content: e.content,\n            contentLength: e.content.length,\n            createdAt: e.createdAt,\n            updatedAt: e.updatedAt,\n          })),\n          agentId: this.agentId,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: () => 'list instructions',\n    };\n  }\n\n  private createInstructionsClearTool(): ToolFunction {\n    return {\n      definition: instructionsClearDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        if (args.confirm !== true) {\n          return { error: 'Must pass confirm: true to clear instructions' };\n        }\n\n        await this.clear();\n        return {\n          success: true,\n          message: 'All custom instructions cleared',\n        };\n      },\n      permission: { scope: 'once', riskLevel: 'medium' },\n      describeCall: () => 'clear instructions',\n    };\n  }\n}\n","/**\n * FileUserInfoStorage - File-based storage for user information\n *\n * Stores user information as a JSON file on disk.\n * Path: ~/.oneringai/users/<userId>/user_info.json\n * Windows: %APPDATA%/oneringai/users/<userId>/user_info.json\n *\n * Features:\n * - Cross-platform path handling\n * - Safe user ID sanitization\n * - Atomic file operations\n * - Automatic directory creation\n * - Multi-user support (one storage instance for all users)\n */\n\nimport { promises as fs } from 'fs';\nimport { join } from 'path';\nimport { homedir } from 'os';\nimport type { IUserInfoStorage, UserInfoEntry } from '../../domain/interfaces/IUserInfoStorage.js';\n\n/**\n * Configuration for FileUserInfoStorage\n */\nexport interface FileUserInfoStorageConfig {\n  /** Override the base directory (default: ~/.oneringai/users) */\n  baseDirectory?: string;\n  /** Override the filename (default: user_info.json) */\n  filename?: string;\n}\n\n/**\n * On-disk JSON format for user info entries\n */\ninterface StoredUserInfoFile {\n  version: 1;\n  userId: string;\n  entries: UserInfoEntry[];\n}\n\n/**\n * Get the default base directory for user info\n * Uses ~/.oneringai/users on Unix-like systems\n * Uses %APPDATA%/oneringai/users on Windows\n */\nfunction getDefaultBaseDirectory(): string {\n  const platform = process.platform;\n\n  if (platform === 'win32') {\n    // Windows: Use APPDATA if available, otherwise fall back to home\n    const appData = process.env.APPDATA || process.env.LOCALAPPDATA;\n    if (appData) {\n      return join(appData, 'oneringai', 'users');\n    }\n  }\n\n  // Unix-like (Linux, macOS) and fallback: Use home directory\n  return join(homedir(), '.oneringai', 'users');\n}\n\n/**\n * Default user ID when none is provided\n */\nconst DEFAULT_USER_ID = 'default';\n\n/**\n * Sanitize user ID for use as a directory name\n * Removes or replaces characters that are not safe for filenames\n */\nfunction sanitizeUserId(userId: string | undefined): string {\n  if (!userId) return DEFAULT_USER_ID;\n  // Replace any character that isn't alphanumeric, dash, or underscore\n  // Also collapse multiple consecutive safe characters into one\n  return userId\n    .replace(/[^a-zA-Z0-9_-]/g, '_')  // Replace unsafe chars with underscore\n    .replace(/_+/g, '_')               // Collapse multiple underscores\n    .replace(/^_|_$/g, '')             // Remove leading/trailing underscores\n    .toLowerCase()                      // Normalize to lowercase\n    || DEFAULT_USER_ID;                 // Fallback if empty\n}\n\n/**\n * File-based storage for user information\n *\n * Single instance handles all users. UserId is passed to each method.\n */\nexport class FileUserInfoStorage implements IUserInfoStorage {\n  private readonly baseDirectory: string;\n  private readonly filename: string;\n\n  constructor(config?: FileUserInfoStorageConfig) {\n    this.baseDirectory = config?.baseDirectory ?? getDefaultBaseDirectory();\n    this.filename = config?.filename ?? 'user_info.json';\n  }\n\n  /**\n   * Get the directory path for a specific user\n   */\n  private getUserDirectory(userId: string | undefined): string {\n    const sanitizedId = sanitizeUserId(userId);\n    return join(this.baseDirectory, sanitizedId);\n  }\n\n  /**\n   * Get the file path for a specific user\n   */\n  private getUserFilePath(userId: string | undefined): string {\n    return join(this.getUserDirectory(userId), this.filename);\n  }\n\n  /**\n   * Load user info entries from file for a specific user\n   */\n  async load(userId: string | undefined): Promise<UserInfoEntry[] | null> {\n    const filePath = this.getUserFilePath(userId);\n\n    try {\n      const raw = await fs.readFile(filePath, 'utf-8');\n      const data = JSON.parse(raw) as StoredUserInfoFile;\n      if (data.version === 1 && Array.isArray(data.entries)) {\n        return data.entries.length > 0 ? data.entries : null;\n      }\n      return null;\n    } catch (error: unknown) {\n      if (!(error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT')) {\n        throw error;\n      }\n      // File not found\n      return null;\n    }\n  }\n\n  /**\n   * Save user info entries to file for a specific user\n   * Creates directory if it doesn't exist.\n   */\n  async save(userId: string | undefined, entries: UserInfoEntry[]): Promise<void> {\n    const directory = this.getUserDirectory(userId);\n    const filePath = this.getUserFilePath(userId);\n\n    await this.ensureDirectory(directory);\n\n    const data: StoredUserInfoFile = {\n      version: 1,\n      userId: userId || DEFAULT_USER_ID,\n      entries,\n    };\n\n    // Write atomically: write to temp file, then rename\n    const tempPath = `${filePath}.tmp`;\n    try {\n      await fs.writeFile(tempPath, JSON.stringify(data, null, 2), 'utf-8');\n      await fs.rename(tempPath, filePath);\n    } catch (error) {\n      // Clean up temp file if rename failed\n      try {\n        await fs.unlink(tempPath);\n      } catch {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Delete user info file for a specific user\n   */\n  async delete(userId: string | undefined): Promise<void> {\n    const filePath = this.getUserFilePath(userId);\n\n    try {\n      await fs.unlink(filePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * Check if user info file exists for a specific user\n   */\n  async exists(userId: string | undefined): Promise<boolean> {\n    const filePath = this.getUserFilePath(userId);\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Get the file path for a specific user (for display/debugging)\n   */\n  getPath(userId: string | undefined): string {\n    return this.getUserFilePath(userId);\n  }\n\n  /**\n   * Ensure the directory exists\n   */\n  private async ensureDirectory(directory: string): Promise<void> {\n    try {\n      await fs.mkdir(directory, { recursive: true });\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        throw error;\n      }\n    }\n  }\n}\n","/**\n * UserInfoPluginNextGen - User information storage plugin for NextGen context\n *\n * Stores key-value information about the current user (preferences, context, metadata).\n * Data is user-scoped, not agent-scoped - different agents share the same user data.\n *\n * Use cases:\n * - User preferences (theme, language, timezone)\n * - User context (location, role, permissions)\n * - User metadata (name, email, profile info)\n * - TODO tracking (stored as entries with `todo_` key prefix)\n *\n * Storage: ~/.oneringai/users/<userId>/user_info.json\n *\n * Design:\n * - UserId passed at construction time from AgentContextNextGen._userId\n * - User data IS injected into context via getContent() (entries rendered as markdown)\n * - TODOs rendered in a separate \"## Current TODOs\" section as a checklist\n * - Internal entries (key starts with `_`) hidden from rendered output\n * - In-memory cache with lazy loading + write-through to storage\n * - Tools access current user's data only (no cross-user access)\n */\n\nimport type { IContextPluginNextGen, ITokenEstimator } from '../types.js';\nimport type { ToolFunction, ToolContext } from '../../../domain/entities/Tool.js';\nimport type { IUserInfoStorage, UserInfoEntry } from '../../../domain/interfaces/IUserInfoStorage.js';\nimport { FileUserInfoStorage } from '../../../infrastructure/storage/FileUserInfoStorage.js';\nimport { simpleTokenEstimator } from '../BasePluginNextGen.js';\nimport { StorageRegistry } from '../../StorageRegistry.js';\nimport type { StorageContext } from '../../StorageRegistry.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport type { UserInfoEntry } from '../../../domain/interfaces/IUserInfoStorage.js';\n\nexport interface UserInfoPluginConfig {\n  /** Custom storage implementation (default: FileUserInfoStorage) */\n  storage?: IUserInfoStorage;\n  /** Maximum total size across all entries in bytes (default: 100000 / ~100KB) */\n  maxTotalSize?: number;\n  /** Maximum number of entries (default: 100) */\n  maxEntries?: number;\n  /** User ID for storage isolation (resolved from AgentContextNextGen._userId) */\n  userId?: string;\n}\n\nexport interface SerializedUserInfoState {\n  version: 1;\n  entries: UserInfoEntry[];\n  userId?: string;\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst DEFAULT_MAX_TOTAL_SIZE = 100000; // ~100KB\nconst DEFAULT_MAX_ENTRIES = 100;\nconst KEY_MAX_LENGTH = 100;\nconst KEY_PATTERN = /^[a-zA-Z0-9_-]+$/;\n\n// ============================================================================\n// Instructions\n// ============================================================================\n\nconst USER_INFO_INSTRUCTIONS = `User Info stores key-value information about the current user.\nData is user-specific and persists across sessions and agents.\nUser info is automatically shown in context  no need to call user_info_get every turn.\n\n**To manage:**\n- \\`user_info_set(key, value, description?)\\`: Store/update user information\n- \\`user_info_get(key?)\\`: Retrieve one entry by key, or all entries if no key\n- \\`user_info_remove(key)\\`: Remove a specific entry\n- \\`user_info_clear(confirm: true)\\`: Remove all entries (destructive!)\n\n**Use for:** User preferences, context, metadata (theme, language, timezone, role, etc.) It is also perfectly fine to search the web and other external sources for information about the user and then store it in user info for future use.\n\n**Important:** Do not store sensitive information (passwords, tokens, PII) in user info. It is not encrypted and may be accessible to other parts of the system. Always follow best practices for security.\n\n**Rules after each user message:** If the user provides new information about themselves, update user info accordingly. If they ask to change or remove existing information, do that as well. Always keep user info up to date with the latest information provided by the user. Learn about the user proactively!\n\n## TODO Management\n\nTODOs are stored alongside user info and shown in a separate \"Current TODOs\" section in context.\n\n**Tools:**\n- \\`todo_add(title, description?, people?, dueDate?, tags?)\\`: Create a new TODO item\n- \\`todo_update(id, title?, description?, people?, dueDate?, tags?, status?)\\`: Update an existing TODO\n- \\`todo_remove(id)\\`: Delete a TODO item\n\n**Proactive creation  be helpful:**\n- If the user's message implies an action item, task, or deadline  ask \"Would you like me to create a TODO for this?\"\n- If the user explicitly says \"remind me\", \"track this\", \"don't forget\"  create a TODO immediately without asking.\n- When discussing plans with deadlines or deliverables  suggest relevant TODOs.\n- When the user mentions other people involved  include them in the \\`people\\` field.\n- Suggest appropriate tags based on context (e.g. \"work\", \"personal\", \"urgent\").\n\n**Reminder rules:**\n- Check the \\`_todo_last_reminded\\` entry in user info. If its value is NOT today's date (YYYY-MM-DD) AND there are overdue or soon-due items (within 2 days), proactively remind the user ONCE at the start of the conversation, then set \\`_todo_last_reminded\\` to today's date via \\`user_info_set\\`.\n- Do NOT remind again in the same day unless the user explicitly asks about their TODOs.\n- When reminding, prioritize: overdue items first, then items due today, then items due tomorrow.\n- If the user asks about their TODOs or schedule, always answer regardless of reminder status.\n- After completing a TODO, mark it as done via \\`todo_update(id, status: 'done')\\`. Suggest marking items done when context indicates completion.\n\n**Cleanup rules:**\n- Completed TODOs older than 48 hours (check updatedAt of done items)  auto-delete via \\`todo_remove\\` without asking.\n- Overdue pending TODOs (past due > 7 days)  ask the user: \"This TODO is overdue by X days  still relevant or should I remove it?\"\n- Run cleanup checks at the same time as reminders (once per day, using \\`_todo_last_reminded\\` marker).`;\n\n// ============================================================================\n// Tool Definitions\n// ============================================================================\n\nconst userInfoSetDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'user_info_set',\n    description: `Store or update user information by key. Data persists across sessions.\nIf the key exists, it will be updated. If not, a new entry is created.`,\n    parameters: {\n      type: 'object',\n      properties: {\n        key: {\n          type: 'string',\n          description: 'Unique key for the information (alphanumeric, dash, underscore; max 100 chars)',\n        },\n        value: {\n          description: 'Value to store (any JSON-serializable data: string, number, boolean, object, array)',\n        },\n        description: {\n          type: 'string',\n          description: 'Optional description for self-documentation',\n        },\n      },\n      required: ['key', 'value'],\n    },\n  },\n};\n\nconst userInfoGetDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'user_info_get',\n    description: 'Retrieve user information. If key is provided, returns that entry. Otherwise returns all entries.',\n    parameters: {\n      type: 'object',\n      properties: {\n        key: {\n          type: 'string',\n          description: 'Key of the entry to retrieve (optional - omit to get all entries)',\n        },\n      },\n      required: [],\n    },\n  },\n};\n\nconst userInfoRemoveDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'user_info_remove',\n    description: 'Remove a specific user information entry by key.',\n    parameters: {\n      type: 'object',\n      properties: {\n        key: {\n          type: 'string',\n          description: 'Key of the entry to remove',\n        },\n      },\n      required: ['key'],\n    },\n  },\n};\n\nconst userInfoClearDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'user_info_clear',\n    description: 'Clear all user information entries (DESTRUCTIVE). Requires confirmation.',\n    parameters: {\n      type: 'object',\n      properties: {\n        confirm: {\n          type: 'boolean',\n          description: 'Must be true to confirm deletion',\n        },\n      },\n      required: ['confirm'],\n    },\n  },\n};\n\n// ============================================================================\n// TODO Tool Definitions\n// ============================================================================\n\nconst todoAddDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'todo_add',\n    description: 'Create a new TODO item for the user. Returns the generated todo ID.',\n    parameters: {\n      type: 'object',\n      properties: {\n        title: {\n          type: 'string',\n          description: 'Short title for the TODO (required)',\n        },\n        description: {\n          type: 'string',\n          description: 'Optional detailed description',\n        },\n        people: {\n          type: 'array',\n          items: { type: 'string' },\n          description: 'People involved besides the current user (optional)',\n        },\n        dueDate: {\n          type: 'string',\n          description: 'Due date in ISO format YYYY-MM-DD (optional)',\n        },\n        tags: {\n          type: 'array',\n          items: { type: 'string' },\n          description: 'Categorization tags (optional, e.g. \"work\", \"personal\", \"urgent\")',\n        },\n      },\n      required: ['title'],\n    },\n  },\n};\n\nconst todoUpdateDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'todo_update',\n    description: 'Update an existing TODO item. Only provided fields are changed.',\n    parameters: {\n      type: 'object',\n      properties: {\n        id: {\n          type: 'string',\n          description: 'The todo ID (e.g. \"todo_a1b2c3\")',\n        },\n        title: {\n          type: 'string',\n          description: 'New title',\n        },\n        description: {\n          type: 'string',\n          description: 'New description (pass empty string to clear)',\n        },\n        people: {\n          type: 'array',\n          items: { type: 'string' },\n          description: 'New people list (replaces existing)',\n        },\n        dueDate: {\n          type: 'string',\n          description: 'New due date in ISO format YYYY-MM-DD (pass empty string to clear)',\n        },\n        tags: {\n          type: 'array',\n          items: { type: 'string' },\n          description: 'New tags list (replaces existing)',\n        },\n        status: {\n          type: 'string',\n          enum: ['pending', 'done'],\n          description: 'New status',\n        },\n      },\n      required: ['id'],\n    },\n  },\n};\n\nconst todoRemoveDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'todo_remove',\n    description: 'Delete a TODO item.',\n    parameters: {\n      type: 'object',\n      properties: {\n        id: {\n          type: 'string',\n          description: 'The todo ID to remove (e.g. \"todo_a1b2c3\")',\n        },\n      },\n      required: ['id'],\n    },\n  },\n};\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\n/**\n * Validate key format\n */\nfunction validateKey(key: unknown): string | null {\n  if (typeof key !== 'string') return 'Key must be a string';\n  const trimmed = key.trim();\n  if (trimmed.length === 0) return 'Key cannot be empty';\n  if (trimmed.length > KEY_MAX_LENGTH) return `Key exceeds maximum length (${KEY_MAX_LENGTH} chars)`;\n  if (!KEY_PATTERN.test(trimmed)) return 'Key must contain only alphanumeric characters, dashes, and underscores';\n  return null;\n}\n\n/**\n * Determine the type of a value for display\n */\nfunction getValueType(value: unknown): UserInfoEntry['valueType'] {\n  if (value === null) return 'null';\n  if (Array.isArray(value)) return 'array';\n  return typeof value as UserInfoEntry['valueType'];\n}\n\n/**\n * Calculate size of a value in bytes (approximate)\n */\nfunction calculateValueSize(value: unknown): number {\n  const json = JSON.stringify(value);\n  return Buffer.byteLength(json, 'utf-8');\n}\n\n/**\n * Build StorageContext from ToolContext\n */\nfunction buildStorageContext(toolContext?: ToolContext): StorageContext | undefined {\n  const global = StorageRegistry.getContext();\n  if (global) return global;\n  if (toolContext?.userId) return { userId: toolContext.userId };\n  return undefined;\n}\n\n// ============================================================================\n// TODO Helpers\n// ============================================================================\n\nconst TODO_KEY_PREFIX = 'todo_';\nconst INTERNAL_KEY_PREFIX = '_';\n\ninterface TodoValue {\n  type: 'todo';\n  title: string;\n  description?: string;\n  people?: string[];\n  dueDate?: string;\n  tags?: string[];\n  status: 'pending' | 'done';\n}\n\nfunction isTodoEntry(entry: UserInfoEntry): boolean {\n  return entry.id.startsWith(TODO_KEY_PREFIX);\n}\n\nfunction isInternalEntry(entry: UserInfoEntry): boolean {\n  return entry.id.startsWith(INTERNAL_KEY_PREFIX);\n}\n\nfunction generateTodoId(): string {\n  const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';\n  let id = '';\n  for (let i = 0; i < 6; i++) {\n    id += chars[Math.floor(Math.random() * chars.length)];\n  }\n  return `${TODO_KEY_PREFIX}${id}`;\n}\n\nfunction renderTodoEntry(entry: UserInfoEntry): string {\n  const val = entry.value as TodoValue;\n  const checkbox = val.status === 'done' ? '[x]' : '[ ]';\n  const parts: string[] = [];\n\n  if (val.dueDate) parts.push(`due: ${val.dueDate}`);\n  if (val.people && val.people.length > 0) parts.push(`people: ${val.people.join(', ')}`);\n  const meta = parts.length > 0 ? ` (${parts.join(', ')})` : '';\n  const tags = val.tags && val.tags.length > 0 ? ` [${val.tags.join(', ')}]` : '';\n\n  let line = `- ${checkbox} ${entry.id}: ${val.title}${meta}${tags}`;\n  if (val.description) {\n    line += `\\n  ${val.description}`;\n  }\n  return line;\n}\n\n/**\n * Format a value for context rendering\n */\nfunction formatValue(value: unknown): string {\n  if (value === null) return 'null';\n  if (typeof value === 'string') return value;\n  if (typeof value === 'number' || typeof value === 'boolean') return String(value);\n  return JSON.stringify(value);\n}\n\n// ============================================================================\n// Plugin Implementation\n// ============================================================================\n\nexport class UserInfoPluginNextGen implements IContextPluginNextGen {\n  readonly name = 'user_info';\n\n  private _destroyed = false;\n  private _storage: IUserInfoStorage | null = null;\n\n  /** In-memory cache of entries */\n  private _entries: Map<string, UserInfoEntry> = new Map();\n  /** Whether entries have been loaded from storage */\n  private _initialized = false;\n\n  private readonly maxTotalSize: number;\n  private readonly maxEntries: number;\n  private readonly estimator: ITokenEstimator = simpleTokenEstimator;\n  private readonly explicitStorage?: IUserInfoStorage;\n\n  /** UserId for getContent() and lazy initialization */\n  readonly userId: string | undefined;\n\n  private _tokenCache: number | null = null;\n  private _instructionsTokenCache: number | null = null;\n\n  constructor(config?: UserInfoPluginConfig) {\n    this.maxTotalSize = config?.maxTotalSize ?? DEFAULT_MAX_TOTAL_SIZE;\n    this.maxEntries = config?.maxEntries ?? DEFAULT_MAX_ENTRIES;\n    this.explicitStorage = config?.storage;\n    this.userId = config?.userId;\n  }\n\n  // ============================================================================\n  // IContextPluginNextGen Implementation\n  // ============================================================================\n\n  getInstructions(): string {\n    return USER_INFO_INSTRUCTIONS;\n  }\n\n  async getContent(): Promise<string | null> {\n    await this.ensureInitialized();\n\n    if (this._entries.size === 0) {\n      this._tokenCache = 0;\n      return null;\n    }\n\n    const rendered = this.renderContent();\n    this._tokenCache = this.estimator.estimateTokens(rendered);\n    return rendered;\n  }\n\n  getContents(): Map<string, UserInfoEntry> {\n    return new Map(this._entries);\n  }\n\n  getTokenSize(): number {\n    return this._tokenCache ?? 0;\n  }\n\n  getInstructionsTokenSize(): number {\n    if (this._instructionsTokenCache === null) {\n      this._instructionsTokenCache = this.estimator.estimateTokens(USER_INFO_INSTRUCTIONS);\n    }\n    return this._instructionsTokenCache;\n  }\n\n  isCompactable(): boolean {\n    // User info is never compacted\n    return false;\n  }\n\n  async compact(_targetTokensToFree: number): Promise<number> {\n    // Never compacted\n    return 0;\n  }\n\n  getTools(): ToolFunction[] {\n    return [\n      this.createUserInfoSetTool(),\n      this.createUserInfoGetTool(),\n      this.createUserInfoRemoveTool(),\n      this.createUserInfoClearTool(),\n      this.createTodoAddTool(),\n      this.createTodoUpdateTool(),\n      this.createTodoRemoveTool(),\n    ];\n  }\n\n  destroy(): void {\n    if (this._destroyed) return;\n    this._entries.clear();\n    this._destroyed = true;\n    this._tokenCache = null;\n  }\n\n  getState(): SerializedUserInfoState {\n    return {\n      version: 1,\n      entries: Array.from(this._entries.values()),\n      userId: this.userId,\n    };\n  }\n\n  restoreState(state: unknown): void {\n    if (!state || typeof state !== 'object') return;\n\n    const s = state as Record<string, unknown>;\n\n    if ('version' in s && s.version === 1 && Array.isArray(s.entries)) {\n      this._entries.clear();\n      for (const entry of s.entries as UserInfoEntry[]) {\n        this._entries.set(entry.id, entry);\n      }\n      this._initialized = true;\n      this._tokenCache = null;\n    }\n  }\n\n  // ============================================================================\n  // Public API\n  // ============================================================================\n\n  /**\n   * Check if initialized\n   */\n  get isInitialized(): boolean {\n    return this._initialized;\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private assertNotDestroyed(): void {\n    if (this._destroyed) {\n      throw new Error('UserInfoPluginNextGen is destroyed');\n    }\n  }\n\n  /**\n   * Lazy load entries from storage\n   */\n  private async ensureInitialized(): Promise<void> {\n    if (this._initialized || this._destroyed) return;\n\n    try {\n      const storage = this.resolveStorage();\n      const entries = await storage.load(this.userId);\n      this._entries.clear();\n      if (entries) {\n        for (const entry of entries) {\n          this._entries.set(entry.id, entry);\n        }\n      }\n      this._initialized = true;\n    } catch (error) {\n      console.warn(`Failed to load user info for userId '${this.userId ?? 'default'}':`, error);\n      this._entries.clear();\n      this._initialized = true;\n    }\n    this._tokenCache = null;\n  }\n\n  /**\n   * Render entries as markdown for context injection\n   */\n  private renderContent(): string {\n    const userEntries: UserInfoEntry[] = [];\n    const todoEntries: UserInfoEntry[] = [];\n\n    for (const entry of this._entries.values()) {\n      if (isTodoEntry(entry)) {\n        todoEntries.push(entry);\n      } else if (!isInternalEntry(entry)) {\n        userEntries.push(entry);\n      }\n      // Internal entries (key starts with `_`) are hidden from rendered output\n    }\n\n    const sections: string[] = [];\n\n    // User info section\n    if (userEntries.length > 0) {\n      userEntries.sort((a, b) => a.createdAt - b.createdAt);\n      sections.push(\n        userEntries.map(entry => `### ${entry.id}\\n${formatValue(entry.value)}`).join('\\n\\n'),\n      );\n    }\n\n    // TODOs section\n    if (todoEntries.length > 0) {\n      // Sort: pending first (by due date asc, then createdAt), done last\n      todoEntries.sort((a, b) => {\n        const aVal = a.value as TodoValue;\n        const bVal = b.value as TodoValue;\n        // Pending before done\n        if (aVal.status !== bVal.status) return aVal.status === 'pending' ? -1 : 1;\n        // By due date (entries without due date go last)\n        if (aVal.dueDate && bVal.dueDate) return aVal.dueDate.localeCompare(bVal.dueDate);\n        if (aVal.dueDate) return -1;\n        if (bVal.dueDate) return 1;\n        return a.createdAt - b.createdAt;\n      });\n      sections.push(\n        '## Current TODOs\\n' + todoEntries.map(renderTodoEntry).join('\\n'),\n      );\n    }\n\n    return sections.join('\\n\\n');\n  }\n\n  /**\n   * Resolve storage instance (lazy singleton)\n   */\n  private resolveStorage(context?: ToolContext): IUserInfoStorage {\n    if (this._storage) return this._storage;\n\n    // 1. Explicit storage (constructor param)\n    if (this.explicitStorage) {\n      this._storage = this.explicitStorage;\n      return this._storage;\n    }\n\n    // 2. Registry factory\n    const factory = StorageRegistry.get('userInfo');\n    if (factory) {\n      this._storage = factory(buildStorageContext(context));\n      return this._storage;\n    }\n\n    // 3. Default file storage\n    this._storage = new FileUserInfoStorage();\n    return this._storage;\n  }\n\n  /**\n   * Persist current entries to storage\n   */\n  private async persistToStorage(userId: string | undefined): Promise<void> {\n    const storage = this.resolveStorage();\n    if (this._entries.size === 0) {\n      await storage.delete(userId);\n    } else {\n      await storage.save(userId, Array.from(this._entries.values()));\n    }\n  }\n\n  // ============================================================================\n  // Tool Factories\n  // ============================================================================\n\n  private createUserInfoSetTool(): ToolFunction {\n    return {\n      definition: userInfoSetDefinition,\n      execute: async (args: Record<string, unknown>, context?: ToolContext) => {\n        this.assertNotDestroyed();\n        await this.ensureInitialized();\n\n        const userId = context?.userId ?? this.userId;\n\n        const key = args.key as string;\n        const value = args.value;\n        const description = args.description as string | undefined;\n\n        // Validate key\n        const keyError = validateKey(key);\n        if (keyError) {\n          return { error: keyError };\n        }\n\n        const trimmedKey = key.trim();\n\n        // Validate value\n        if (value === undefined) {\n          return { error: 'Value cannot be undefined. Use null for explicit null value.' };\n        }\n\n        // Check maxEntries (new entry only)\n        if (!this._entries.has(trimmedKey) && this._entries.size >= this.maxEntries) {\n          return { error: `Maximum number of entries reached (${this.maxEntries})` };\n        }\n\n        // Calculate sizes\n        const valueSize = calculateValueSize(value);\n        let currentTotal = 0;\n        for (const e of this._entries.values()) {\n          currentTotal += calculateValueSize(e.value);\n        }\n        const existingSize = this._entries.has(trimmedKey) ? calculateValueSize(this._entries.get(trimmedKey)!.value) : 0;\n        const newTotal = currentTotal - existingSize + valueSize;\n\n        if (newTotal > this.maxTotalSize) {\n          return { error: `Total size would exceed maximum (${this.maxTotalSize} bytes)` };\n        }\n\n        // Create or update entry\n        const now = Date.now();\n        const existing = this._entries.get(trimmedKey);\n        const entry: UserInfoEntry = {\n          id: trimmedKey,\n          value,\n          valueType: getValueType(value),\n          description,\n          createdAt: existing?.createdAt ?? now,\n          updatedAt: now,\n        };\n\n        this._entries.set(trimmedKey, entry);\n        this._tokenCache = null;\n\n        // Write-through to storage\n        await this.persistToStorage(userId);\n\n        return {\n          success: true,\n          message: existing ? `User info '${trimmedKey}' updated` : `User info '${trimmedKey}' added`,\n          key: trimmedKey,\n          valueType: entry.valueType,\n          valueSize,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `set user info '${args.key}'`,\n    };\n  }\n\n  private createUserInfoGetTool(): ToolFunction {\n    return {\n      definition: userInfoGetDefinition,\n      execute: async (args: Record<string, unknown>, _context?: ToolContext) => {\n        this.assertNotDestroyed();\n        await this.ensureInitialized();\n\n        const key = args.key as string | undefined;\n\n        if (this._entries.size === 0) {\n          return { error: 'User info not found' };\n        }\n\n        // Get specific entry\n        if (key !== undefined) {\n          const trimmedKey = key.trim();\n          const entry = this._entries.get(trimmedKey);\n\n          if (!entry) {\n            return { error: `User info '${trimmedKey}' not found` };\n          }\n\n          return {\n            key: entry.id,\n            value: entry.value,\n            valueType: entry.valueType,\n            description: entry.description,\n            createdAt: entry.createdAt,\n            updatedAt: entry.updatedAt,\n          };\n        }\n\n        // Get all entries\n        const entries = Array.from(this._entries.values());\n        return {\n          count: entries.length,\n          entries: entries.map(e => ({\n            key: e.id,\n            value: e.value,\n            valueType: e.valueType,\n            description: e.description,\n            createdAt: e.createdAt,\n            updatedAt: e.updatedAt,\n          })),\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => args.key ? `get user info '${args.key}'` : 'get all user info',\n    };\n  }\n\n  private createUserInfoRemoveTool(): ToolFunction {\n    return {\n      definition: userInfoRemoveDefinition,\n      execute: async (args: Record<string, unknown>, context?: ToolContext) => {\n        this.assertNotDestroyed();\n        await this.ensureInitialized();\n\n        const userId = context?.userId ?? this.userId;\n\n        const key = args.key as string;\n\n        if (!key || typeof key !== 'string' || key.trim().length === 0) {\n          return { error: 'Key is required' };\n        }\n\n        const trimmedKey = key.trim();\n\n        if (!this._entries.has(trimmedKey)) {\n          return { error: `User info '${trimmedKey}' not found` };\n        }\n\n        this._entries.delete(trimmedKey);\n        this._tokenCache = null;\n\n        // Write-through to storage\n        await this.persistToStorage(userId);\n\n        return {\n          success: true,\n          message: `User info '${trimmedKey}' removed`,\n          key: trimmedKey,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `remove user info '${args.key}'`,\n    };\n  }\n\n  private createUserInfoClearTool(): ToolFunction {\n    return {\n      definition: userInfoClearDefinition,\n      execute: async (args: Record<string, unknown>, context?: ToolContext) => {\n        this.assertNotDestroyed();\n\n        const userId = context?.userId ?? this.userId;\n\n        if (args.confirm !== true) {\n          return { error: 'Must pass confirm: true to clear user info' };\n        }\n\n        this._entries.clear();\n        this._tokenCache = null;\n\n        const storage = this.resolveStorage(context);\n        await storage.delete(userId);\n\n        return {\n          success: true,\n          message: 'All user information cleared',\n        };\n      },\n      permission: { scope: 'once', riskLevel: 'medium' },\n      describeCall: () => 'clear user info',\n    };\n  }\n\n  // ============================================================================\n  // TODO Tool Factories\n  // ============================================================================\n\n  private createTodoAddTool(): ToolFunction {\n    return {\n      definition: todoAddDefinition,\n      execute: async (args: Record<string, unknown>, context?: ToolContext) => {\n        this.assertNotDestroyed();\n        await this.ensureInitialized();\n\n        const userId = context?.userId ?? this.userId;\n        const title = args.title as string;\n\n        if (!title || typeof title !== 'string' || title.trim().length === 0) {\n          return { error: 'Title is required' };\n        }\n\n        // Check maxEntries\n        if (this._entries.size >= this.maxEntries) {\n          return { error: `Maximum number of entries reached (${this.maxEntries})` };\n        }\n\n        // Generate unique ID\n        let todoId = generateTodoId();\n        while (this._entries.has(todoId)) {\n          todoId = generateTodoId();\n        }\n\n        const todoValue: TodoValue = {\n          type: 'todo',\n          title: title.trim(),\n          description: args.description ? String(args.description).trim() : undefined,\n          people: Array.isArray(args.people) ? args.people.filter((p): p is string => typeof p === 'string') : undefined,\n          dueDate: typeof args.dueDate === 'string' && args.dueDate.trim() ? args.dueDate.trim() : undefined,\n          tags: Array.isArray(args.tags) ? args.tags.filter((t): t is string => typeof t === 'string') : undefined,\n          status: 'pending',\n        };\n\n        // Check size\n        const valueSize = calculateValueSize(todoValue);\n        let currentTotal = 0;\n        for (const e of this._entries.values()) {\n          currentTotal += calculateValueSize(e.value);\n        }\n        if (currentTotal + valueSize > this.maxTotalSize) {\n          return { error: `Total size would exceed maximum (${this.maxTotalSize} bytes)` };\n        }\n\n        const now = Date.now();\n        const entry: UserInfoEntry = {\n          id: todoId,\n          value: todoValue,\n          valueType: 'object',\n          description: title.trim(),\n          createdAt: now,\n          updatedAt: now,\n        };\n\n        this._entries.set(todoId, entry);\n        this._tokenCache = null;\n\n        await this.persistToStorage(userId);\n\n        return {\n          success: true,\n          message: `TODO '${title.trim()}' created`,\n          id: todoId,\n          todo: todoValue,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `add todo '${args.title}'`,\n    };\n  }\n\n  private createTodoUpdateTool(): ToolFunction {\n    return {\n      definition: todoUpdateDefinition,\n      execute: async (args: Record<string, unknown>, context?: ToolContext) => {\n        this.assertNotDestroyed();\n        await this.ensureInitialized();\n\n        const userId = context?.userId ?? this.userId;\n        const id = args.id as string;\n\n        if (!id || typeof id !== 'string') {\n          return { error: 'Todo ID is required' };\n        }\n\n        const entry = this._entries.get(id);\n        if (!entry || !isTodoEntry(entry)) {\n          return { error: `TODO '${id}' not found` };\n        }\n\n        const currentValue = entry.value as TodoValue;\n        const updatedValue: TodoValue = { ...currentValue };\n\n        // Apply partial updates\n        if (typeof args.title === 'string' && args.title.trim()) {\n          updatedValue.title = args.title.trim();\n        }\n        if (args.description !== undefined) {\n          updatedValue.description = typeof args.description === 'string' && args.description.trim()\n            ? args.description.trim()\n            : undefined;\n        }\n        if (args.people !== undefined) {\n          updatedValue.people = Array.isArray(args.people)\n            ? args.people.filter((p): p is string => typeof p === 'string')\n            : undefined;\n        }\n        if (args.dueDate !== undefined) {\n          updatedValue.dueDate = typeof args.dueDate === 'string' && args.dueDate.trim()\n            ? args.dueDate.trim()\n            : undefined;\n        }\n        if (args.tags !== undefined) {\n          updatedValue.tags = Array.isArray(args.tags)\n            ? args.tags.filter((t): t is string => typeof t === 'string')\n            : undefined;\n        }\n        if (args.status === 'pending' || args.status === 'done') {\n          updatedValue.status = args.status;\n        }\n\n        // Check size\n        const valueSize = calculateValueSize(updatedValue);\n        let currentTotal = 0;\n        for (const e of this._entries.values()) {\n          currentTotal += calculateValueSize(e.value);\n        }\n        const existingSize = calculateValueSize(currentValue);\n        if (currentTotal - existingSize + valueSize > this.maxTotalSize) {\n          return { error: `Total size would exceed maximum (${this.maxTotalSize} bytes)` };\n        }\n\n        const now = Date.now();\n        const updatedEntry: UserInfoEntry = {\n          ...entry,\n          value: updatedValue,\n          description: updatedValue.title,\n          updatedAt: now,\n        };\n\n        this._entries.set(id, updatedEntry);\n        this._tokenCache = null;\n\n        await this.persistToStorage(userId);\n\n        return {\n          success: true,\n          message: `TODO '${id}' updated`,\n          id,\n          todo: updatedValue,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `update todo '${args.id}'`,\n    };\n  }\n\n  private createTodoRemoveTool(): ToolFunction {\n    return {\n      definition: todoRemoveDefinition,\n      execute: async (args: Record<string, unknown>, context?: ToolContext) => {\n        this.assertNotDestroyed();\n        await this.ensureInitialized();\n\n        const userId = context?.userId ?? this.userId;\n        const id = args.id as string;\n\n        if (!id || typeof id !== 'string') {\n          return { error: 'Todo ID is required' };\n        }\n\n        const entry = this._entries.get(id);\n        if (!entry || !isTodoEntry(entry)) {\n          return { error: `TODO '${id}' not found` };\n        }\n\n        this._entries.delete(id);\n        this._tokenCache = null;\n\n        await this.persistToStorage(userId);\n\n        return {\n          success: true,\n          message: `TODO '${id}' removed`,\n          id,\n        };\n      },\n      permission: { scope: 'always', riskLevel: 'low' },\n      describeCall: (args) => `remove todo '${args.id}'`,\n    };\n  }\n}\n","/**\n * ToolCatalogPluginNextGen - Dynamic Tool Loading/Unloading for Agents\n *\n * When agents need 100+ tools, sending all tool definitions to the LLM wastes\n * tokens and degrades performance. This plugin provides 3 metatools that let\n * agents discover and load only the tool categories they need.\n *\n * Categories come from ToolCatalogRegistry (static global) and ConnectorTools\n * (runtime discovery). The plugin manages loaded/unloaded state via ToolManager.\n *\n * @example\n * ```typescript\n * const ctx = AgentContextNextGen.create({\n *   model: 'gpt-4',\n *   features: { toolCatalog: true },\n *   toolCategories: ['filesystem', 'web'],  // optional scope\n * });\n * ```\n */\n\nimport { BasePluginNextGen } from '../BasePluginNextGen.js';\nimport type { ToolFunction } from '../../../domain/entities/Tool.js';\nimport type { AuthIdentity } from '../types.js';\nimport {\n  ToolCatalogRegistry,\n  type ToolCategoryScope,\n  type ToolCategoryDefinition,\n} from '../../ToolCatalogRegistry.js';\nimport type { ToolManager } from '../../ToolManager.js';\nimport { logger } from '../../../infrastructure/observability/Logger.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface ToolCatalogPluginConfig {\n  /** Scope filter for which categories are visible */\n  categoryScope?: ToolCategoryScope;\n  /** Categories to pre-load on initialization */\n  autoLoadCategories?: string[];\n  /** Maximum loaded categories at once (default: 10) */\n  maxLoadedCategories?: number;\n  /** Auth identities for connector filtering */\n  identities?: AuthIdentity[];\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst DEFAULT_MAX_LOADED = 10;\n\nconst TOOL_CATALOG_INSTRUCTIONS = `## Tool Catalog\n\nYou have access to a dynamic tool catalog. Not all tools are loaded at once  use these metatools to discover and load what you need:\n\n**tool_catalog_search**  Browse available tool categories and search for specific tools.\n  - No params  list all available categories with descriptions\n  - \\`category\\`  list tools in that category\n  - \\`query\\`  keyword search across categories and tools\n\n**tool_catalog_load**  Load a category's tools so you can use them.\n  - Tools become available immediately after loading.\n  - If you need tools from a category, load it first.\n\n**tool_catalog_unload**  Unload a category to free token budget.\n  - Unloaded tools are no longer sent to you.\n  - Use when you're done with a category.\n\n**Best practices:**\n- Search first to find the right category before loading.\n- Unload categories you no longer need to keep context lean.\n- Categories marked [LOADED] are already available.`;\n\n// ============================================================================\n// Tool Definitions\n// ============================================================================\n\nconst catalogSearchDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'tool_catalog_search',\n    description: 'Search the tool catalog. No params lists categories. Use category to list tools in it, or query to keyword-search.',\n    parameters: {\n      type: 'object' as const,\n      properties: {\n        query: {\n          type: 'string',\n          description: 'Keyword to search across category names, descriptions, and tool names',\n        },\n        category: {\n          type: 'string',\n          description: 'Category name to list its tools',\n        },\n      },\n    },\n  },\n};\n\nconst catalogLoadDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'tool_catalog_load',\n    description: 'Load all tools from a category so they become available for use.',\n    parameters: {\n      type: 'object' as const,\n      properties: {\n        category: {\n          type: 'string',\n          description: 'Category name to load',\n        },\n      },\n      required: ['category'],\n    },\n  },\n};\n\nconst catalogUnloadDefinition = {\n  type: 'function' as const,\n  function: {\n    name: 'tool_catalog_unload',\n    description: 'Unload a category to free token budget. Tools from this category will no longer be available.',\n    parameters: {\n      type: 'object' as const,\n      properties: {\n        category: {\n          type: 'string',\n          description: 'Category name to unload',\n        },\n      },\n      required: ['category'],\n    },\n  },\n};\n\n// ============================================================================\n// Plugin\n// ============================================================================\n\nexport class ToolCatalogPluginNextGen extends BasePluginNextGen {\n  readonly name = 'tool_catalog';\n\n  /** category name  array of tool names that were loaded */\n  private _loadedCategories = new Map<string, string[]>();\n\n  /** Reference to the ToolManager for registering/disabling tools */\n  private _toolManager: ToolManager | null = null;\n\n  private _config: Required<Pick<ToolCatalogPluginConfig, 'maxLoadedCategories'>> & ToolCatalogPluginConfig;\n\n  constructor(config?: ToolCatalogPluginConfig) {\n    super();\n    this._config = {\n      maxLoadedCategories: DEFAULT_MAX_LOADED,\n      ...config,\n    };\n  }\n\n  // ========================================================================\n  // Plugin Interface\n  // ========================================================================\n\n  getInstructions(): string {\n    return TOOL_CATALOG_INSTRUCTIONS;\n  }\n\n  async getContent(): Promise<string | null> {\n    const categories = this.getAllowedCategories();\n    if (categories.length === 0) return null;\n\n    const lines: string[] = ['## Tool Catalog'];\n    lines.push('');\n\n    const loaded = Array.from(this._loadedCategories.keys());\n    if (loaded.length > 0) {\n      lines.push(`**Loaded:** ${loaded.join(', ')}`);\n    }\n\n    lines.push(`**Available categories:** ${categories.length}`);\n\n    // Brief summary of categories\n    for (const cat of categories) {\n      const tools = ToolCatalogRegistry.getToolsInCategory(cat.name);\n      const marker = this._loadedCategories.has(cat.name) ? ' [LOADED]' : '';\n      lines.push(`- **${cat.displayName}** (${tools.length} tools)${marker}: ${cat.description}`);\n    }\n\n    // Add connector categories\n    const connectorCats = this.getConnectorCategories();\n    for (const cc of connectorCats) {\n      const marker = this._loadedCategories.has(cc.name) ? ' [LOADED]' : '';\n      lines.push(`- **${cc.displayName}** (${cc.toolCount} tools)${marker}: ${cc.description}`);\n    }\n\n    const content = lines.join('\\n');\n    this.updateTokenCache(this.estimator.estimateTokens(content));\n    return content;\n  }\n\n  getContents(): unknown {\n    return {\n      loadedCategories: Array.from(this._loadedCategories.entries()).map(([name, tools]) => ({\n        category: name,\n        toolCount: tools.length,\n        tools,\n      })),\n    };\n  }\n\n  getTools(): ToolFunction[] {\n    const plugin = this;\n\n    const searchTool: ToolFunction = {\n      definition: catalogSearchDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        return plugin.executeSearch(args.query as string | undefined, args.category as string | undefined);\n      },\n    };\n\n    const loadTool: ToolFunction = {\n      definition: catalogLoadDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        return plugin.executeLoad(args.category as string);\n      },\n    };\n\n    const unloadTool: ToolFunction = {\n      definition: catalogUnloadDefinition,\n      execute: async (args: Record<string, unknown>) => {\n        return plugin.executeUnload(args.category as string);\n      },\n    };\n\n    return [searchTool, loadTool, unloadTool];\n  }\n\n  isCompactable(): boolean {\n    return this._loadedCategories.size > 0;\n  }\n\n  async compact(targetTokensToFree: number): Promise<number> {\n    if (!this._toolManager || this._loadedCategories.size === 0) return 0;\n\n    // Sort loaded categories by least recently used (based on tool metadata)\n    const categoriesByLastUsed = this.getCategoriesSortedByLastUsed();\n    let freed = 0;\n\n    for (const category of categoriesByLastUsed) {\n      if (freed >= targetTokensToFree) break;\n\n      const toolNames = this._loadedCategories.get(category);\n      if (!toolNames) continue;\n\n      // Estimate tokens that will be freed (tool definitions)\n      const toolTokens = this.estimateToolDefinitionTokens(toolNames);\n      this._toolManager.setEnabled(toolNames, false);\n      this._loadedCategories.delete(category);\n      freed += toolTokens;\n\n      logger.debug({ category, toolCount: toolNames.length, freed: toolTokens },\n        `[ToolCatalogPlugin] Compacted category '${category}'`);\n    }\n\n    this.invalidateTokenCache();\n    return freed;\n  }\n\n  getState(): unknown {\n    return {\n      loadedCategories: Array.from(this._loadedCategories.keys()),\n    };\n  }\n\n  restoreState(state: unknown): void {\n    const s = state as { loadedCategories?: string[] };\n    if (!s.loadedCategories?.length) return;\n\n    // Re-load categories from state\n    for (const category of s.loadedCategories) {\n      try {\n        this.executeLoad(category);\n      } catch (err) {\n        logger.warn({ category, error: err instanceof Error ? err.message : String(err) },\n          `[ToolCatalogPlugin] Failed to restore category '${category}'`);\n      }\n    }\n    this.invalidateTokenCache();\n  }\n\n  destroy(): void {\n    this._loadedCategories.clear();\n    this._toolManager = null;\n  }\n\n  // ========================================================================\n  // Public API\n  // ========================================================================\n\n  /**\n   * Set the ToolManager reference. Called by AgentContextNextGen after plugin registration.\n   */\n  setToolManager(tm: ToolManager): void {\n    this._toolManager = tm;\n\n    // Auto-load categories if configured\n    if (this._config.autoLoadCategories?.length) {\n      for (const category of this._config.autoLoadCategories) {\n        try {\n          this.executeLoad(category);\n        } catch (err) {\n          logger.warn({ category, error: err instanceof Error ? err.message : String(err) },\n            `[ToolCatalogPlugin] Failed to auto-load category '${category}'`);\n        }\n      }\n    }\n  }\n\n  /** Get list of currently loaded category names */\n  get loadedCategories(): string[] {\n    return Array.from(this._loadedCategories.keys());\n  }\n\n  // ========================================================================\n  // Metatool Implementations\n  // ========================================================================\n\n  private executeSearch(query?: string, category?: string): Record<string, unknown> {\n    // List tools in a specific category\n    if (category) {\n      // Check if it's a connector category\n      if (category.startsWith('connector:')) {\n        return this.searchConnectorCategory(category);\n      }\n\n      if (!ToolCatalogRegistry.hasCategory(category)) {\n        return { error: `Category '${category}' not found. Use tool_catalog_search with no params to see available categories.` };\n      }\n\n      if (!ToolCatalogRegistry.isCategoryAllowed(category, this._config.categoryScope)) {\n        return { error: `Category '${category}' is not available for this agent.` };\n      }\n\n      const tools = ToolCatalogRegistry.getToolsInCategory(category);\n      const loaded = this._loadedCategories.has(category);\n      return {\n        category,\n        loaded,\n        tools: tools.map(t => ({\n          name: t.name,\n          displayName: t.displayName,\n          description: t.description,\n          safeByDefault: t.safeByDefault,\n        })),\n      };\n    }\n\n    // Keyword search\n    if (query) {\n      return this.keywordSearch(query);\n    }\n\n    // No params  list all available categories\n    const categories = this.getAllowedCategories();\n    const connectorCats = this.getConnectorCategories();\n    const result: Array<{\n      name: string;\n      displayName: string;\n      description: string;\n      toolCount: number;\n      loaded: boolean;\n    }> = [];\n\n    for (const cat of categories) {\n      const tools = ToolCatalogRegistry.getToolsInCategory(cat.name);\n      result.push({\n        name: cat.name,\n        displayName: cat.displayName,\n        description: cat.description,\n        toolCount: tools.length,\n        loaded: this._loadedCategories.has(cat.name),\n      });\n    }\n\n    for (const cc of connectorCats) {\n      result.push({\n        name: cc.name,\n        displayName: cc.displayName,\n        description: cc.description,\n        toolCount: cc.toolCount,\n        loaded: this._loadedCategories.has(cc.name),\n      });\n    }\n\n    return { categories: result };\n  }\n\n  executeLoad(category: string): Record<string, unknown> {\n    if (!this._toolManager) {\n      return { error: 'ToolManager not connected. Plugin not properly initialized.' };\n    }\n\n    // Check scope\n    const isConnector = category.startsWith('connector:');\n    if (!isConnector && !ToolCatalogRegistry.isCategoryAllowed(category, this._config.categoryScope)) {\n      return { error: `Category '${category}' is not available for this agent.` };\n    }\n\n    // Already loaded  idempotent\n    if (this._loadedCategories.has(category)) {\n      const toolNames = this._loadedCategories.get(category)!;\n      return { loaded: toolNames.length, tools: toolNames, alreadyLoaded: true };\n    }\n\n    // Check max loaded limit\n    if (this._loadedCategories.size >= this._config.maxLoadedCategories) {\n      return {\n        error: `Maximum loaded categories (${this._config.maxLoadedCategories}) reached. Unload a category first.`,\n        loaded: Array.from(this._loadedCategories.keys()),\n      };\n    }\n\n    // Resolve tools\n    let tools: Array<{ tool: ToolFunction; name: string }>;\n\n    if (isConnector) {\n      tools = this.resolveConnectorTools(category);\n    } else {\n      const entries = ToolCatalogRegistry.getToolsInCategory(category);\n      if (entries.length === 0) {\n        return { error: `Category '${category}' has no tools or does not exist.` };\n      }\n      tools = entries.map(e => ({ tool: e.tool, name: e.name }));\n    }\n\n    if (tools.length === 0) {\n      return { error: `No tools found for category '${category}'.` };\n    }\n\n    // Register with ToolManager\n    const toolNames: string[] = [];\n    for (const { tool, name } of tools) {\n      const existing = this._toolManager.getRegistration(name);\n      if (existing) {\n        // Already registered (maybe from a previous load)  just enable\n        this._toolManager.setEnabled([name], true);\n      } else {\n        this._toolManager.register(tool, { category, source: `catalog:${category}` });\n      }\n      toolNames.push(name);\n    }\n\n    this._loadedCategories.set(category, toolNames);\n    this.invalidateTokenCache();\n\n    logger.debug({ category, toolCount: toolNames.length, tools: toolNames },\n      `[ToolCatalogPlugin] Loaded category '${category}'`);\n\n    return { loaded: toolNames.length, tools: toolNames };\n  }\n\n  private executeUnload(category: string): Record<string, unknown> {\n    if (!this._toolManager) {\n      return { error: 'ToolManager not connected.' };\n    }\n\n    const toolNames = this._loadedCategories.get(category);\n    if (!toolNames) {\n      return { unloaded: 0, message: `Category '${category}' is not loaded.` };\n    }\n\n    // Disable tools (don't unregister  cheaper to re-enable later)\n    this._toolManager.setEnabled(toolNames, false);\n    this._loadedCategories.delete(category);\n    this.invalidateTokenCache();\n\n    logger.debug({ category, toolCount: toolNames.length },\n      `[ToolCatalogPlugin] Unloaded category '${category}'`);\n\n    return { unloaded: toolNames.length };\n  }\n\n  // ========================================================================\n  // Helpers\n  // ========================================================================\n\n  private getAllowedCategories(): ToolCategoryDefinition[] {\n    return ToolCatalogRegistry.filterCategories(this._config.categoryScope);\n  }\n\n  private keywordSearch(query: string): Record<string, unknown> {\n    const lq = query.toLowerCase();\n    const results: Array<{\n      category: string;\n      categoryDisplayName: string;\n      tools: Array<{ name: string; displayName: string; description: string }>;\n    }> = [];\n\n    // Search registered categories\n    for (const cat of this.getAllowedCategories()) {\n      const catMatch = cat.name.toLowerCase().includes(lq) ||\n        cat.displayName.toLowerCase().includes(lq) ||\n        cat.description.toLowerCase().includes(lq);\n\n      const tools = ToolCatalogRegistry.getToolsInCategory(cat.name);\n      const matchingTools = tools.filter(t =>\n        t.name.toLowerCase().includes(lq) ||\n        t.displayName.toLowerCase().includes(lq) ||\n        t.description.toLowerCase().includes(lq),\n      );\n\n      if (catMatch || matchingTools.length > 0) {\n        results.push({\n          category: cat.name,\n          categoryDisplayName: cat.displayName,\n          tools: (catMatch ? tools : matchingTools).map(t => ({\n            name: t.name,\n            displayName: t.displayName,\n            description: t.description,\n          })),\n        });\n      }\n    }\n\n    // Search connector categories\n    for (const cc of this.getConnectorCategories()) {\n      if (cc.name.toLowerCase().includes(lq) ||\n        cc.displayName.toLowerCase().includes(lq) ||\n        cc.description.toLowerCase().includes(lq)) {\n        results.push({\n          category: cc.name,\n          categoryDisplayName: cc.displayName,\n          tools: cc.tools.map(t => ({\n            name: t.definition.function.name,\n            displayName: t.definition.function.name.replace(/_/g, ' '),\n            description: t.definition.function.description || '',\n          })),\n        });\n      }\n    }\n\n    return { query, results, totalMatches: results.length };\n  }\n\n  private searchConnectorCategory(category: string): Record<string, unknown> {\n    const connectorName = category.replace('connector:', '');\n    const tools = this.resolveConnectorTools(category);\n    const loaded = this._loadedCategories.has(category);\n\n    return {\n      category,\n      loaded,\n      connectorName,\n      tools: tools.map(t => ({\n        name: t.name,\n        description: t.tool.definition.function.description || '',\n      })),\n    };\n  }\n\n  private getConnectorCategories(): Array<{\n    name: string;\n    displayName: string;\n    description: string;\n    toolCount: number;\n    tools: ToolFunction[];\n  }> {\n    try {\n      const { ConnectorTools } = require('../../../tools/connector/ConnectorTools.js');\n      const discovered: Map<string, ToolFunction[]> = ConnectorTools.discoverAll();\n      const results: Array<{\n        name: string;\n        displayName: string;\n        description: string;\n        toolCount: number;\n        tools: ToolFunction[];\n      }> = [];\n\n      for (const [connectorName, tools] of discovered) {\n        const catName = `connector:${connectorName}`;\n\n        // Check scope\n        if (!ToolCatalogRegistry.isCategoryAllowed(catName, this._config.categoryScope)) {\n          continue;\n        }\n\n        // Check identities filter\n        if (this._config.identities?.length) {\n          const hasIdentity = this._config.identities.some(id => id.connector === connectorName);\n          if (!hasIdentity) continue;\n        }\n\n        // Check if there's a pre-registered category with better metadata\n        const preRegistered = ToolCatalogRegistry.getCategory(catName);\n        results.push({\n          name: catName,\n          displayName: preRegistered?.displayName ?? connectorName.charAt(0).toUpperCase() + connectorName.slice(1),\n          description: preRegistered?.description ?? `API tools for ${connectorName}`,\n          toolCount: tools.length,\n          tools,\n        });\n      }\n\n      return results;\n    } catch {\n      return [];\n    }\n  }\n\n  private resolveConnectorTools(category: string): Array<{ tool: ToolFunction; name: string }> {\n    const connectorName = category.replace('connector:', '');\n    try {\n      const { ConnectorTools } = require('../../../tools/connector/ConnectorTools.js');\n      const tools: ToolFunction[] = ConnectorTools.for(connectorName);\n      return tools.map(t => ({ tool: t, name: t.definition.function.name }));\n    } catch {\n      return [];\n    }\n  }\n\n  private getCategoriesSortedByLastUsed(): string[] {\n    if (!this._toolManager) return Array.from(this._loadedCategories.keys());\n\n    const categoryLastUsed: Array<{ category: string; lastUsed: number }> = [];\n\n    for (const [category, toolNames] of this._loadedCategories) {\n      let maxLastUsed = 0;\n      for (const name of toolNames) {\n        const reg = this._toolManager.getRegistration(name);\n        if (reg?.metadata?.lastUsed) {\n          const ts = reg.metadata.lastUsed instanceof Date\n            ? reg.metadata.lastUsed.getTime()\n            : 0;\n          if (ts > maxLastUsed) maxLastUsed = ts;\n        }\n      }\n      categoryLastUsed.push({ category, lastUsed: maxLastUsed });\n    }\n\n    // Sort ascending  least recently used first\n    categoryLastUsed.sort((a, b) => a.lastUsed - b.lastUsed);\n    return categoryLastUsed.map(c => c.category);\n  }\n\n  private estimateToolDefinitionTokens(toolNames: string[]): number {\n    let total = 0;\n    for (const name of toolNames) {\n      const reg = this._toolManager?.getRegistration(name);\n      if (reg) {\n        // Rough estimate: tool definition JSON stringified\n        const defStr = JSON.stringify(reg.tool.definition);\n        total += this.estimator.estimateTokens(defStr);\n      }\n    }\n    return total;\n  }\n}\n","/**\n * DefaultCompactionStrategy - Standard compaction behavior\n *\n * Implements the default compaction strategy:\n * - compact(): Plugins first (by priority), then conversation history\n * - consolidate(): No-op for now (returns performed: false)\n *\n * This strategy preserves the original AgentContextNextGen behavior.\n */\n\nimport type {\n  ICompactionStrategy,\n  CompactionContext,\n  CompactionResult,\n  ConsolidationResult,\n} from '../types.js';\n\n/**\n * Default threshold (70%)\n */\nconst DEFAULT_THRESHOLD = 0.70;\n\n/**\n * Configuration for DefaultCompactionStrategy\n */\nexport interface DefaultCompactionStrategyConfig {\n  /** Custom threshold (default: 0.70 = 70%) */\n  threshold?: number;\n}\n\n/**\n * Default compaction strategy.\n *\n * Behavior:\n * - compact(): First compacts plugins (in_context_memory first, then working_memory),\n *   then removes oldest messages from conversation while preserving tool pairs.\n * - consolidate(): No-op - returns performed: false\n *\n * This strategy is fast and suitable for most use cases.\n * Default threshold is 70%.\n */\nexport class DefaultCompactionStrategy implements ICompactionStrategy {\n  readonly name = 'default';\n  readonly displayName = 'Dumb';\n  readonly description = 'Do not use';\n  readonly threshold: number;\n\n  constructor(config?: DefaultCompactionStrategyConfig) {\n    this.threshold = config?.threshold ?? DEFAULT_THRESHOLD;\n  }\n\n  /**\n   * Emergency compaction when thresholds exceeded.\n   *\n   * Strategy:\n   * 1. Compact plugins first (in_context_memory, then working_memory)\n   * 2. If still needed, remove oldest conversation messages (preserving tool pairs)\n   */\n  async compact(context: CompactionContext, targetToFree: number): Promise<CompactionResult> {\n    const log: string[] = [];\n    const pluginsCompacted: string[] = [];\n    let tokensFreed = 0;\n    let messagesRemoved = 0;\n    let remaining = targetToFree;\n\n    log.push(`Compaction started: need to free ~${targetToFree} tokens`);\n\n    // Step 1: Compact plugins (in order of priority - most expendable first)\n    const compactablePlugins = [...context.plugins]\n      .filter(p => p.isCompactable())\n      .sort((a, b) => {\n        // InContextMemory first, then WorkingMemory\n        const order: Record<string, number> = {\n          'in_context_memory': 1,\n          'working_memory': 2,\n        };\n        return (order[a.name] ?? 10) - (order[b.name] ?? 10);\n      });\n\n    for (const plugin of compactablePlugins) {\n      if (remaining <= 0) break;\n\n      const freed = await context.compactPlugin(plugin.name, remaining);\n      if (freed > 0) {\n        tokensFreed += freed;\n        remaining -= freed;\n        pluginsCompacted.push(plugin.name);\n        log.push(`Compacted ${plugin.name}: freed ~${freed} tokens`);\n      }\n    }\n\n    // Step 2: Compact conversation if still needed\n    if (remaining > 0 && context.conversation.length > 0) {\n      const conversationResult = await this.compactConversation(context, remaining, log);\n      tokensFreed += conversationResult.tokensFreed;\n      messagesRemoved = conversationResult.messagesRemoved;\n      remaining -= conversationResult.tokensFreed;\n    }\n\n    log.push(`Compaction complete: freed ~${tokensFreed} tokens total`);\n\n    return {\n      tokensFreed,\n      messagesRemoved,\n      pluginsCompacted,\n      log,\n    };\n  }\n\n  /**\n   * Post-cycle consolidation.\n   *\n   * Default strategy does nothing - override in subclasses for:\n   * - Conversation summarization\n   * - Memory deduplication\n   * - Data promotion to persistent storage\n   */\n  async consolidate(_context: CompactionContext): Promise<ConsolidationResult> {\n    // Default: no consolidation\n    return {\n      performed: false,\n      tokensChanged: 0,\n      actions: [],\n    };\n  }\n\n  /**\n   * Compact conversation by removing oldest messages.\n   * Preserves tool pairs (tool_use + tool_result).\n   */\n  private async compactConversation(\n    context: CompactionContext,\n    targetToFree: number,\n    log: string[]\n  ): Promise<{ tokensFreed: number; messagesRemoved: number }> {\n    const conversation = context.conversation;\n    if (conversation.length === 0) {\n      return { tokensFreed: 0, messagesRemoved: 0 };\n    }\n\n    // Find tool pairs (tool_use_id -> indices)\n    const toolPairs = this.findToolPairs(conversation);\n\n    // Build set of indices that are part of pairs\n    const inPair = new Set<number>();\n    for (const indices of toolPairs.values()) {\n      for (const idx of indices) {\n        inPair.add(idx);\n      }\n    }\n\n    // Find safe indices to remove (from oldest first)\n    const safeToRemove: number[] = [];\n\n    // First pass: find messages not in pairs\n    for (let i = 0; i < conversation.length; i++) {\n      if (!inPair.has(i)) {\n        safeToRemove.push(i);\n      }\n    }\n\n    // Second pass: add complete pairs (both tool_use and tool_result present)\n    for (const [, indices] of toolPairs) {\n      if (indices.length >= 2) {\n        for (const idx of indices) {\n          if (!safeToRemove.includes(idx)) {\n            safeToRemove.push(idx);\n          }\n        }\n      }\n    }\n\n    // Sort by index (oldest first)\n    safeToRemove.sort((a, b) => a - b);\n\n    // Remove messages until we've freed enough tokens\n    let tokensFreed = 0;\n    const indicesToRemove: number[] = [];\n\n    for (const idx of safeToRemove) {\n      if (tokensFreed >= targetToFree) break;\n\n      const item = conversation[idx];\n      if (!item) continue;\n\n      // Check if this message is part of a tool pair\n      const toolUseId = this.getToolUseId(item);\n      if (toolUseId) {\n        const pairIndices = toolPairs.get(toolUseId);\n        if (pairIndices && pairIndices.length >= 2) {\n          // Remove entire pair\n          for (const pairIdx of pairIndices) {\n            if (!indicesToRemove.includes(pairIdx)) {\n              indicesToRemove.push(pairIdx);\n              const pairItem = conversation[pairIdx];\n              if (pairItem) {\n                tokensFreed += context.estimateTokens(pairItem);\n              }\n            }\n          }\n          continue;\n        }\n      }\n\n      // Not part of a pair, remove single message\n      if (!indicesToRemove.includes(idx)) {\n        indicesToRemove.push(idx);\n        tokensFreed += context.estimateTokens(item);\n      }\n    }\n\n    // Actually remove the messages\n    if (indicesToRemove.length > 0) {\n      await context.removeMessages(indicesToRemove);\n      log.push(`Removed ${indicesToRemove.length} messages from conversation: freed ~${tokensFreed} tokens`);\n    }\n\n    return {\n      tokensFreed,\n      messagesRemoved: indicesToRemove.length,\n    };\n  }\n\n  /**\n   * Find tool_use/tool_result pairs in conversation.\n   * Returns Map<tool_use_id, array of message indices>.\n   */\n  private findToolPairs(conversation: ReadonlyArray<unknown>): Map<string, number[]> {\n    const pairs = new Map<string, number[]>();\n\n    for (let i = 0; i < conversation.length; i++) {\n      const item = conversation[i] as Record<string, unknown>;\n      if (item?.type !== 'message') continue;\n\n      const content = item.content as Array<Record<string, unknown>> | undefined;\n      if (!content) continue;\n\n      for (const c of content) {\n        if (c.type === 'tool_use') {\n          const toolUseId = c.id as string;\n          if (toolUseId) {\n            const existing = pairs.get(toolUseId) ?? [];\n            existing.push(i);\n            pairs.set(toolUseId, existing);\n          }\n        } else if (c.type === 'tool_result') {\n          const toolUseId = c.tool_use_id as string;\n          if (toolUseId) {\n            const existing = pairs.get(toolUseId) ?? [];\n            existing.push(i);\n            pairs.set(toolUseId, existing);\n          }\n        }\n      }\n    }\n\n    return pairs;\n  }\n\n  /**\n   * Get tool_use_id from an item (if it contains tool_use or tool_result).\n   */\n  private getToolUseId(item: unknown): string | null {\n    const msg = item as Record<string, unknown>;\n    if (msg?.type !== 'message') return null;\n\n    const content = msg.content as Array<Record<string, unknown>> | undefined;\n    if (!content) return null;\n\n    for (const c of content) {\n      if (c.type === 'tool_use') {\n        return c.id as string;\n      } else if (c.type === 'tool_result') {\n        return c.tool_use_id as string;\n      }\n    }\n\n    return null;\n  }\n}\n","/**\n * AlgorithmicCompactionStrategy - Intelligent tool result management\n *\n * This strategy:\n * 1. Moves large tool results to Working Memory (preserving them for later retrieval)\n * 2. Limits the number of tool pairs in conversation\n * 3. Applies rolling window compaction for remaining messages\n *\n * Requires the working_memory plugin to be enabled.\n */\n\nimport type {\n  ICompactionStrategy,\n  CompactionContext,\n  CompactionResult,\n  ConsolidationResult,\n} from '../types.js';\nimport type { WorkingMemoryPluginNextGen } from '../plugins/WorkingMemoryPluginNextGen.js';\n\n/**\n * Default threshold (75%)\n */\nconst DEFAULT_THRESHOLD = 0.75;\n\n/**\n * Default size threshold for moving tool results to memory (1KB)\n */\nconst DEFAULT_TOOL_RESULT_SIZE_THRESHOLD = 1024;\n\n/**\n * Default maximum number of tool pairs to keep in conversation\n */\nconst DEFAULT_MAX_TOOL_PAIRS = 10;\n\n/**\n * Configuration for AlgorithmicCompactionStrategy\n */\nexport interface AlgorithmicCompactionStrategyConfig {\n  /** Custom threshold (default: 0.75 = 75%) */\n  threshold?: number;\n\n  /** Size threshold in bytes for moving tool results to memory (default: 1024 = 1KB) */\n  toolResultSizeThreshold?: number;\n\n  /** Maximum number of tool pairs to keep in conversation (default: 10) */\n  maxToolPairs?: number;\n}\n\n/**\n * Represents a matched tool_use/tool_result pair in conversation\n */\ninterface ToolPair {\n  /** Index of message containing tool_use */\n  toolUseIndex: number;\n\n  /** Index of message containing tool_result */\n  toolResultIndex: number;\n\n  /** The tool_use_id that links the pair */\n  toolUseId: string;\n\n  /** Name of the tool */\n  toolName: string;\n\n  /** Arguments passed to the tool */\n  toolArgs: unknown;\n\n  /** Content of the tool result */\n  resultContent: unknown;\n\n  /** Size of the result in bytes */\n  resultSizeBytes: number;\n}\n\n/**\n * Algorithmic compaction strategy.\n *\n * Behavior:\n * - consolidate(): Moves large tool results to Working Memory, limits tool pairs\n * - compact(): Runs consolidate() first, then applies rolling window\n *\n * This strategy is ideal for agents that make many tool calls with potentially\n * large results (file reads, API responses, etc.).\n */\nexport class AlgorithmicCompactionStrategy implements ICompactionStrategy {\n  readonly name = 'algorithmic';\n  readonly displayName = 'Algorithmic';\n  readonly description =\n    'Moves large tool results to working memory, limits tool pairs, applies rolling window. Ideal for tool-heavy agents.';\n  readonly threshold: number;\n  readonly requiredPlugins = ['working_memory'] as const;\n\n  private readonly toolResultSizeThreshold: number;\n  private readonly maxToolPairs: number;\n\n  constructor(config?: AlgorithmicCompactionStrategyConfig) {\n    this.threshold = config?.threshold ?? DEFAULT_THRESHOLD;\n    this.toolResultSizeThreshold = config?.toolResultSizeThreshold ?? DEFAULT_TOOL_RESULT_SIZE_THRESHOLD;\n    this.maxToolPairs = config?.maxToolPairs ?? DEFAULT_MAX_TOOL_PAIRS;\n  }\n\n  /**\n   * Emergency compaction when context exceeds threshold.\n   *\n   * Strategy:\n   * 1. Run consolidate() first to move tool results to memory (if working memory available)\n   * 2. If still need space, apply rolling window (remove oldest messages)\n   *\n   * Gracefully degrades: if working memory plugin is not registered,\n   * skips step 1 and only uses rolling window compaction.\n   */\n  async compact(context: CompactionContext, targetToFree: number): Promise<CompactionResult> {\n    const log: string[] = [];\n    let tokensFreed = 0;\n    let messagesRemoved = 0;\n    const pluginsCompacted: string[] = [];\n\n    log.push(`Algorithmic compaction started: need to free ~${targetToFree} tokens`);\n\n    // 1. Run consolidate first to move large tool results to memory (if available)\n    const consolidateResult = await this.consolidate(context);\n    if (consolidateResult.performed) {\n      tokensFreed += Math.abs(consolidateResult.tokensChanged);\n      log.push(...consolidateResult.actions);\n    }\n\n    // 2. If still need more space, apply rolling window\n    const remaining = targetToFree - tokensFreed;\n    if (remaining > 0 && context.conversation.length > 0) {\n      log.push(`Rolling window: need to free ~${remaining} more tokens`);\n      const result = await this.applyRollingWindow(context, remaining, log);\n      tokensFreed += result.tokensFreed;\n      messagesRemoved = result.messagesRemoved;\n    }\n\n    log.push(`Algorithmic compaction complete: freed ~${tokensFreed} tokens total`);\n\n    return { tokensFreed, messagesRemoved, pluginsCompacted, log };\n  }\n\n  /**\n   * Post-cycle consolidation.\n   *\n   * 1. Find all tool pairs in conversation\n   * 2. Move large tool results (> threshold) to Working Memory (if available)\n   * 3. Limit remaining tool pairs to maxToolPairs\n   *\n   * Gracefully degrades: if working memory is not available, skips step 2\n   * and only limits tool pairs + removes excess via rolling window.\n   */\n  async consolidate(context: CompactionContext): Promise<ConsolidationResult> {\n    const log: string[] = [];\n    let tokensChanged = 0;\n\n    const memory = this.getWorkingMemory(context);\n    const toolPairs = this.findToolPairs(context.conversation);\n\n    if (toolPairs.length === 0) {\n      return { performed: false, tokensChanged: 0, actions: [] };\n    }\n\n    const indicesToRemove: number[] = [];\n\n    // 1. Move large results to memory (only if working memory is available)\n    if (memory) {\n      for (const pair of toolPairs) {\n        if (pair.resultSizeBytes > this.toolResultSizeThreshold) {\n          const key = this.generateKey(pair.toolName, pair.toolUseId);\n          const desc = this.generateDescription(pair.toolName, pair.toolArgs);\n\n          await memory.store(key, desc, pair.resultContent, {\n            tier: 'raw',\n            priority: 'normal',\n          });\n\n          // Mark both messages for removal\n          if (!indicesToRemove.includes(pair.toolUseIndex)) {\n            indicesToRemove.push(pair.toolUseIndex);\n          }\n          if (!indicesToRemove.includes(pair.toolResultIndex)) {\n            indicesToRemove.push(pair.toolResultIndex);\n          }\n\n          log.push(\n            `Moved ${pair.toolName} result (${this.formatBytes(pair.resultSizeBytes)}) to memory: ${key}`\n          );\n        }\n      }\n    }\n\n    // 2. Limit remaining tool pairs\n    const remainingPairs = toolPairs.filter(\n      p => !indicesToRemove.includes(p.toolUseIndex) && !indicesToRemove.includes(p.toolResultIndex)\n    );\n\n    if (remainingPairs.length > this.maxToolPairs) {\n      // Remove oldest pairs (they're sorted oldest first)\n      const toRemove = remainingPairs.slice(0, remainingPairs.length - this.maxToolPairs);\n      for (const pair of toRemove) {\n        if (!indicesToRemove.includes(pair.toolUseIndex)) {\n          indicesToRemove.push(pair.toolUseIndex);\n        }\n        if (!indicesToRemove.includes(pair.toolResultIndex)) {\n          indicesToRemove.push(pair.toolResultIndex);\n        }\n        log.push(`Removed old tool pair: ${pair.toolName} (exceeds ${this.maxToolPairs} pair limit)`);\n      }\n    }\n\n    // 3. Remove all marked messages\n    if (indicesToRemove.length > 0) {\n      tokensChanged = -(await context.removeMessages(indicesToRemove));\n      log.push(`Removed ${indicesToRemove.length} messages, freed ~${Math.abs(tokensChanged)} tokens`);\n    }\n\n    return {\n      performed: indicesToRemove.length > 0,\n      tokensChanged,\n      actions: log,\n    };\n  }\n\n  /**\n   * Get the Working Memory plugin from context, or null if not available.\n   * When null, the strategy degrades gracefully (skips memory operations).\n   */\n  private getWorkingMemory(context: CompactionContext): WorkingMemoryPluginNextGen | null {\n    const plugin = context.plugins.find(p => p.name === 'working_memory');\n    return plugin ? (plugin as WorkingMemoryPluginNextGen) : null;\n  }\n\n  /**\n   * Find all tool_use/tool_result pairs in conversation.\n   * Returns pairs sorted by oldest first (lowest index).\n   */\n  private findToolPairs(conversation: ReadonlyArray<unknown>): ToolPair[] {\n    // Map: tool_use_id -> tool_use info\n    const toolUses = new Map<\n      string,\n      { index: number; toolName: string; toolArgs: unknown }\n    >();\n\n    // Map: tool_use_id -> tool_result info\n    const toolResults = new Map<\n      string,\n      { index: number; content: unknown; sizeBytes: number }\n    >();\n\n    // Scan conversation for tool_use and tool_result content blocks\n    for (let i = 0; i < conversation.length; i++) {\n      const item = conversation[i] as Record<string, unknown>;\n      if (item?.type !== 'message') continue;\n\n      const content = item.content as Array<Record<string, unknown>> | undefined;\n      if (!Array.isArray(content)) continue;\n\n      for (const block of content) {\n        if (block.type === 'tool_use') {\n          const toolUseId = block.id as string;\n          if (toolUseId) {\n            toolUses.set(toolUseId, {\n              index: i,\n              toolName: (block.name as string) || 'unknown',\n              toolArgs: block.input,\n            });\n          }\n        } else if (block.type === 'tool_result') {\n          const toolUseId = block.tool_use_id as string;\n          if (toolUseId) {\n            const resultContent = block.content;\n            const sizeBytes = this.estimateSize(resultContent);\n            toolResults.set(toolUseId, {\n              index: i,\n              content: resultContent,\n              sizeBytes,\n            });\n          }\n        }\n      }\n    }\n\n    // Match pairs\n    const pairs: ToolPair[] = [];\n    for (const [toolUseId, useInfo] of toolUses) {\n      const resultInfo = toolResults.get(toolUseId);\n      if (resultInfo) {\n        pairs.push({\n          toolUseId,\n          toolUseIndex: useInfo.index,\n          toolResultIndex: resultInfo.index,\n          toolName: useInfo.toolName,\n          toolArgs: useInfo.toolArgs,\n          resultContent: resultInfo.content,\n          resultSizeBytes: resultInfo.sizeBytes,\n        });\n      }\n    }\n\n    // Sort by oldest first (lowest toolUseIndex)\n    pairs.sort((a, b) => a.toolUseIndex - b.toolUseIndex);\n\n    return pairs;\n  }\n\n  /**\n   * Generate a key for storing tool result in memory.\n   * Format: tool_result.<tool_name>.<short_id>\n   */\n  private generateKey(toolName: string, toolUseId: string): string {\n    // Use last 8 chars of tool_use_id for uniqueness\n    const shortId = toolUseId.slice(-8);\n    // Sanitize tool name (replace non-alphanumeric with underscore)\n    const safeName = toolName.replace(/[^a-zA-Z0-9_]/g, '_');\n    return `tool_result.${safeName}.${shortId}`;\n  }\n\n  /**\n   * Generate a description for the stored tool result.\n   * Format: \"Result of <tool_name>(<arg_summary>)\"\n   */\n  private generateDescription(toolName: string, toolArgs: unknown): string {\n    const argSummary = this.summarizeArgs(toolArgs, 100);\n    const desc = `Result of ${toolName}(${argSummary})`;\n    // Truncate to 150 chars (Working Memory limit)\n    return desc.length > 150 ? desc.slice(0, 147) + '...' : desc;\n  }\n\n  /**\n   * Summarize arguments for description, limiting to maxLength chars.\n   */\n  private summarizeArgs(args: unknown, maxLength: number): string {\n    if (args === undefined || args === null) {\n      return '';\n    }\n\n    try {\n      if (typeof args === 'object') {\n        // For objects, show key=value pairs\n        const entries = Object.entries(args as Record<string, unknown>);\n        const parts: string[] = [];\n        let totalLen = 0;\n\n        for (const [key, value] of entries) {\n          let valueStr: string;\n          if (typeof value === 'string') {\n            // Truncate long strings\n            valueStr = value.length > 30 ? `\"${value.slice(0, 27)}...\"` : `\"${value}\"`;\n          } else if (typeof value === 'object' && value !== null) {\n            valueStr = Array.isArray(value) ? `[${value.length} items]` : '{...}';\n          } else {\n            valueStr = String(value);\n          }\n\n          const part = `${key}=${valueStr}`;\n          if (totalLen + part.length + 2 > maxLength) {\n            parts.push('...');\n            break;\n          }\n          parts.push(part);\n          totalLen += part.length + 2;\n        }\n\n        return parts.join(', ');\n      }\n\n      return String(args).slice(0, maxLength);\n    } catch {\n      return '...';\n    }\n  }\n\n  /**\n   * Estimate the size of a value in bytes.\n   */\n  private estimateSize(value: unknown): number {\n    if (value === undefined || value === null) {\n      return 0;\n    }\n\n    try {\n      const json = JSON.stringify(value);\n      // UTF-8 byte length approximation\n      return new TextEncoder().encode(json).length;\n    } catch {\n      // Fallback: rough estimate\n      return String(value).length * 2;\n    }\n  }\n\n  /**\n   * Format bytes for logging.\n   */\n  private formatBytes(bytes: number): string {\n    if (bytes < 1024) return `${bytes}B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)}KB`;\n    return `${(bytes / (1024 * 1024)).toFixed(1)}MB`;\n  }\n\n  /**\n   * Apply rolling window compaction - remove oldest messages until target is met.\n   */\n  private async applyRollingWindow(\n    context: CompactionContext,\n    targetToFree: number,\n    log: string[]\n  ): Promise<{ tokensFreed: number; messagesRemoved: number }> {\n    const conversation = context.conversation;\n    if (conversation.length === 0) {\n      return { tokensFreed: 0, messagesRemoved: 0 };\n    }\n\n    // Find tool pairs to avoid breaking them\n    const toolPairs = this.findToolPairs(conversation);\n    const pairIndices = new Set<number>();\n    for (const pair of toolPairs) {\n      pairIndices.add(pair.toolUseIndex);\n      pairIndices.add(pair.toolResultIndex);\n    }\n\n    // Build removal order: non-tool messages first, then complete tool pairs\n    const nonToolIndices: number[] = [];\n    for (let i = 0; i < conversation.length; i++) {\n      if (!pairIndices.has(i)) {\n        nonToolIndices.push(i);\n      }\n    }\n\n    // Collect indices to remove, tracking freed tokens\n    let tokensFreed = 0;\n    const indicesToRemove: number[] = [];\n\n    // First, try removing non-tool messages (oldest first)\n    for (const idx of nonToolIndices) {\n      if (tokensFreed >= targetToFree) break;\n\n      const item = conversation[idx];\n      if (item) {\n        tokensFreed += context.estimateTokens(item);\n        indicesToRemove.push(idx);\n      }\n    }\n\n    // If still need more, remove complete tool pairs (oldest first)\n    if (tokensFreed < targetToFree) {\n      for (const pair of toolPairs) {\n        if (tokensFreed >= targetToFree) break;\n\n        const useItem = conversation[pair.toolUseIndex];\n        const resultItem = conversation[pair.toolResultIndex];\n\n        if (useItem && !indicesToRemove.includes(pair.toolUseIndex)) {\n          tokensFreed += context.estimateTokens(useItem);\n          indicesToRemove.push(pair.toolUseIndex);\n        }\n        if (resultItem && !indicesToRemove.includes(pair.toolResultIndex)) {\n          tokensFreed += context.estimateTokens(resultItem);\n          indicesToRemove.push(pair.toolResultIndex);\n        }\n      }\n    }\n\n    // Actually remove the messages\n    if (indicesToRemove.length > 0) {\n      await context.removeMessages(indicesToRemove);\n      log.push(`Rolling window removed ${indicesToRemove.length} messages`);\n    }\n\n    return {\n      tokensFreed,\n      messagesRemoved: indicesToRemove.length,\n    };\n  }\n}\n","/**\n * StrategyRegistry - Centralized registry for compaction strategies\n *\n * Follows the Connector pattern: static registry with register/get/list methods.\n * Auto-registers built-in strategy classes on first access.\n *\n * Each registered entry represents an actual strategy CLASS.\n * Library users can register their own custom strategy classes.\n *\n * Strategy metadata (name, displayName, description, threshold) comes from\n * the strategy class itself via the ICompactionStrategy interface.\n *\n * @example\n * ```typescript\n * // Get available strategies for UI\n * const strategies = StrategyRegistry.getInfo();\n *\n * // Create a strategy instance\n * const strategy = StrategyRegistry.create('default');\n *\n * // Register a custom strategy class (metadata comes from the class)\n * StrategyRegistry.register(SmartCompactionStrategy);\n *\n * // Register with isBuiltIn flag\n * StrategyRegistry.register(SmartCompactionStrategy, { isBuiltIn: false });\n * ```\n */\n\nimport type { ICompactionStrategy } from '../types.js';\nimport { DefaultCompactionStrategy } from './DefaultCompactionStrategy.js';\nimport { AlgorithmicCompactionStrategy } from './AlgorithmicCompactionStrategy.js';\n\n/**\n * Strategy constructor type\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type StrategyClass = new (config?: any) => ICompactionStrategy;\n\n/**\n * Strategy information for UI display (serializable, no class reference)\n */\nexport interface StrategyInfo {\n  /** Strategy name (unique identifier) */\n  name: string;\n\n  /** Human-readable name for UI */\n  displayName: string;\n\n  /** Description explaining the strategy behavior */\n  description: string;\n\n  /** Compaction threshold (0-1, e.g., 0.70 = 70%) */\n  threshold: number;\n\n  /** Whether this is a built-in strategy */\n  isBuiltIn: boolean;\n}\n\n/**\n * Full strategy registry entry (includes class reference)\n */\nexport interface StrategyRegistryEntry extends StrategyInfo {\n  /** Strategy constructor class */\n  strategyClass: StrategyClass;\n}\n\n/**\n * Options for registering a strategy\n */\nexport interface StrategyRegisterOptions {\n  /** Whether this is a built-in strategy (default: false) */\n  isBuiltIn?: boolean;\n}\n\n/**\n * Strategy Registry - manages compaction strategy registration and creation.\n *\n * Features:\n * - Static registry pattern (like Connector)\n * - Auto-registers built-in strategy classes on first access\n * - Supports custom strategy class registration\n * - Provides UI-safe getInfo() for serialization\n * - Metadata (displayName, description) comes from strategy class\n */\nexport class StrategyRegistry {\n  private static registry: Map<string, StrategyRegistryEntry> = new Map();\n  private static initialized = false;\n\n  /**\n   * Ensure built-in strategies are registered\n   */\n  private static ensureInitialized(): void {\n    if (this.initialized) return;\n\n    // Register the built-in strategies\n    this.registerInternal(DefaultCompactionStrategy, { isBuiltIn: true });\n    this.registerInternal(AlgorithmicCompactionStrategy, { isBuiltIn: true });\n\n    this.initialized = true;\n  }\n\n  /**\n   * Internal registration that reads metadata from strategy instance\n   */\n  private static registerInternal(\n    strategyClass: StrategyClass,\n    options: StrategyRegisterOptions = {}\n  ): void {\n    // Create temporary instance to read metadata\n    const instance = new strategyClass();\n\n    const entry: StrategyRegistryEntry = {\n      name: instance.name,\n      displayName: instance.displayName,\n      description: instance.description,\n      threshold: instance.threshold,\n      isBuiltIn: options.isBuiltIn ?? false,\n      strategyClass,\n    };\n\n    if (this.registry.has(entry.name)) {\n      throw new Error(\n        `Strategy '${entry.name}' is already registered. Available strategies: ${this.list().join(', ')}`\n      );\n    }\n\n    this.registry.set(entry.name, entry);\n  }\n\n  /**\n   * Register a new strategy class.\n   *\n   * Metadata (name, displayName, description, threshold) is read from\n   * the strategy class itself.\n   *\n   * @param strategyClass - Strategy class to register\n   * @param options - Registration options (isBuiltIn defaults to false)\n   * @throws Error if a strategy with this name already exists\n   *\n   * @example\n   * ```typescript\n   * // Simple registration\n   * StrategyRegistry.register(SmartCompactionStrategy);\n   *\n   * // With options\n   * StrategyRegistry.register(SmartCompactionStrategy, { isBuiltIn: false });\n   * ```\n   */\n  static register(strategyClass: StrategyClass, options?: StrategyRegisterOptions): void {\n    this.ensureInitialized();\n    this.registerInternal(strategyClass, options);\n  }\n\n  /**\n   * Get a strategy entry by name.\n   *\n   * @throws Error if strategy not found\n   */\n  static get(name: string): StrategyRegistryEntry {\n    this.ensureInitialized();\n\n    const entry = this.registry.get(name);\n    if (!entry) {\n      throw new Error(\n        `Strategy '${name}' not found. Available strategies: ${this.list().join(', ')}`\n      );\n    }\n\n    return entry;\n  }\n\n  /**\n   * Check if a strategy exists.\n   */\n  static has(name: string): boolean {\n    this.ensureInitialized();\n    return this.registry.has(name);\n  }\n\n  /**\n   * List all registered strategy names.\n   */\n  static list(): string[] {\n    this.ensureInitialized();\n    return Array.from(this.registry.keys());\n  }\n\n  /**\n   * Create a strategy instance by name.\n   *\n   * @param name - Strategy name\n   * @param config - Optional configuration for the strategy\n   * @throws Error if strategy not found\n   */\n  static create(name: string, config?: unknown): ICompactionStrategy {\n    const entry = this.get(name);\n    return new entry.strategyClass(config);\n  }\n\n  /**\n   * Get strategy information for UI display (serializable, no class refs).\n   *\n   * Returns array of StrategyInfo objects that can be safely serialized\n   * and sent over IPC.\n   */\n  static getInfo(): StrategyInfo[] {\n    this.ensureInitialized();\n\n    return Array.from(this.registry.values()).map(\n      ({ name, displayName, description, threshold, isBuiltIn }) => ({\n        name,\n        displayName,\n        description,\n        threshold,\n        isBuiltIn,\n      })\n    );\n  }\n\n  /**\n   * Remove a strategy from the registry.\n   *\n   * @param name - Strategy name to remove\n   * @returns true if removed, false if not found\n   * @throws Error if trying to remove a built-in strategy\n   */\n  static remove(name: string): boolean {\n    this.ensureInitialized();\n\n    const entry = this.registry.get(name);\n    if (!entry) {\n      return false;\n    }\n\n    if (entry.isBuiltIn) {\n      throw new Error(`Cannot remove built-in strategy '${name}'`);\n    }\n\n    return this.registry.delete(name);\n  }\n\n  /**\n   * Get a strategy entry without throwing.\n   * Returns undefined if not found.\n   */\n  static getIfExists(name: string): StrategyRegistryEntry | undefined {\n    this.ensureInitialized();\n    return this.registry.get(name);\n  }\n\n  /**\n   * Reset the registry to initial state (for testing).\n   * @internal\n   */\n  static _reset(): void {\n    this.registry.clear();\n    this.initialized = false;\n  }\n}\n","/**\n * AgentContextNextGen - Type Definitions\n *\n * Clean, minimal type definitions for the next-generation context manager.\n */\n\nimport type { InputItem } from '../../domain/entities/Message.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { IContextStorage as IContextStorageFromDomain } from '../../domain/interfaces/IContextStorage.js';\nimport type { ToolCategoryScope } from '../ToolCatalogRegistry.js';\n\n// ============================================================================\n// Auth Identity\n// ============================================================================\n\n/**\n * A single auth identity: connector + optional account alias.\n *\n * Used to scope agents to specific OAuth accounts. When `accountId` is set,\n * the identity represents a specific multi-account OAuth session (e.g., 'work'\n * or 'personal' Microsoft account). When omitted, uses the connector's default account.\n */\nexport interface AuthIdentity {\n  /** Name of the registered connector */\n  connector: string;\n\n  /** Optional account alias for multi-account OAuth (e.g., 'work', 'personal') */\n  accountId?: string;\n}\n\n// ============================================================================\n// Token Estimation\n// ============================================================================\n\n/**\n * Token estimator interface - used for conversation and input estimation\n * Plugins handle their own token estimation internally.\n */\nexport interface ITokenEstimator {\n  /** Estimate tokens for a string */\n  estimateTokens(text: string): number;\n\n  /** Estimate tokens for arbitrary data (will be JSON stringified) */\n  estimateDataTokens(data: unknown): number;\n\n  /**\n   * Estimate tokens for an image. Provider-specific implementations can override.\n   *\n   * Default heuristic (matches OpenAI's image token pricing):\n   * - detail='low': 85 tokens\n   * - detail='high' with known dimensions: 85 + 170 * ceil(w/512) * ceil(h/512)\n   * - Unknown dimensions: ~1000 tokens (conservative default)\n   *\n   * @param width - Image width in pixels (if known)\n   * @param height - Image height in pixels (if known)\n   * @param detail - Image detail level: 'low', 'high', or 'auto' (default 'auto')\n   */\n  estimateImageTokens?(width?: number, height?: number, detail?: string): number;\n}\n\n// ============================================================================\n// Plugin Interface\n// ============================================================================\n\n/**\n * Context plugin interface for NextGen context management.\n *\n * ## Implementing a Custom Plugin\n *\n * 1. **Extend BasePluginNextGen** - provides token caching helpers\n * 2. **Implement getInstructions()** - return LLM usage guide (static, cached)\n * 3. **Implement getContent()** - return formatted content (Markdown with `##` header)\n * 4. **Call updateTokenCache()** - after any state change that affects content\n * 5. **Implement getTools()** - return tools with `<plugin_prefix>_*` naming\n *\n * ## Plugin Contributions\n *\n * Plugins provide three types of content to the system message:\n * 1. **Instructions** - static usage guide for the LLM (NEVER compacted)\n * 2. **Content** - dynamic plugin data/state (may be compacted)\n * 3. **Tools** - registered with ToolManager (NEVER compacted)\n *\n * ## Token Cache Lifecycle\n *\n * Plugins must track their own token size for budget calculation. The pattern:\n *\n * ```typescript\n * // When state changes:\n * this._entries.set(key, value);\n * this.invalidateTokenCache();  // Clear cached size\n *\n * // In getContent():\n * const content = this.formatContent();\n * this.updateTokenCache(this.estimator.estimateTokens(content));  // Update cache\n * return content;\n * ```\n *\n * ## Content Format\n *\n * `getContent()` should return Markdown with a descriptive header:\n *\n * ```markdown\n * ## Plugin Display Name (optional stats)\n *\n * Formatted content here...\n * - Entry 1: value\n * - Entry 2: value\n * ```\n *\n * Built-in plugins use these headers:\n * - WorkingMemory: `## Working Memory (N entries)`\n * - InContextMemory: `## Live Context (N entries)`\n * - PersistentInstructions: No header (user's raw instructions)\n *\n * ## Tool Naming Convention\n *\n * Use a consistent prefix based on plugin name:\n * - `working_memory` plugin  `memory_store`, `memory_retrieve`, `memory_delete`, `memory_list`\n * - `in_context_memory` plugin  `context_set`, `context_delete`, `context_list`\n * - `persistent_instructions` plugin  `instructions_set`, `instructions_remove`, `instructions_list`, `instructions_clear`\n *\n * ## State Serialization\n *\n * `getState()` and `restoreState()` are **synchronous** for simplicity.\n * If your plugin has async data, consider:\n * - Storing only references/keys in state\n * - Using a separate async initialization method\n *\n * @example\n * ```typescript\n * class MyPlugin extends BasePluginNextGen {\n *   readonly name = 'my_plugin';\n *   private _data = new Map<string, string>();\n *\n *   getInstructions(): string {\n *     return '## My Plugin\\n\\nUse my_plugin_set to store data...';\n *   }\n *\n *   async getContent(): Promise<string | null> {\n *     if (this._data.size === 0) return null;\n *     const lines = [...this._data].map(([k, v]) => `- ${k}: ${v}`);\n *     const content = `## My Plugin (${this._data.size} entries)\\n\\n${lines.join('\\n')}`;\n *     this.updateTokenCache(this.estimator.estimateTokens(content));\n *     return content;\n *   }\n *\n *   getTools(): ToolFunction[] {\n *     return [myPluginSetTool, myPluginGetTool];\n *   }\n *\n *   getState(): unknown {\n *     return { data: Object.fromEntries(this._data) };\n *   }\n *\n *   restoreState(state: unknown): void {\n *     const s = state as { data: Record<string, string> };\n *     this._data = new Map(Object.entries(s.data || {}));\n *     this.invalidateTokenCache();\n *   }\n * }\n * ```\n */\nexport interface IContextPluginNextGen {\n  /** Unique plugin name (used for lookup and tool prefixing) */\n  readonly name: string;\n\n  /**\n   * Get usage instructions for the LLM.\n   *\n   * Returns static text explaining how to use this plugin's tools\n   * and data. This is placed in the system message and is NEVER\n   * compacted - it persists throughout the conversation.\n   *\n   * Instructions should include:\n   * - What the plugin does\n   * - How to use available tools\n   * - Best practices and conventions\n   *\n   * @returns Instructions string or null if no instructions needed\n   *\n   * @example\n   * ```typescript\n   * getInstructions(): string {\n   *   return `## Working Memory\n   *\n   * Use memory_store to save important data for later retrieval.\n   * Use memory_retrieve to recall previously stored data.\n   *\n   * Best practices:\n   * - Use descriptive keys like 'user_preferences' not 'data1'\n   * - Store intermediate results that may be needed later`;\n   * }\n   * ```\n   */\n  getInstructions(): string | null;\n\n  /**\n   * Get formatted content to include in system message.\n   *\n   * Returns the plugin's current state formatted for LLM consumption.\n   * Should be Markdown with a `## Header`. This content CAN be compacted\n   * if `isCompactable()` returns true.\n   *\n   * **IMPORTANT:** Call `updateTokenCache()` with the content's token size\n   * before returning to keep budget calculations accurate.\n   *\n   * @returns Formatted content string or null if empty\n   *\n   * @example\n   * ```typescript\n   * async getContent(): Promise<string | null> {\n   *   if (this._entries.size === 0) return null;\n   *\n   *   const lines = this._entries.map(e => `- ${e.key}: ${e.value}`);\n   *   const content = `## My Plugin (${this._entries.size} entries)\\n\\n${lines.join('\\n')}`;\n   *\n   *   // IMPORTANT: Update token cache before returning\n   *   this.updateTokenCache(this.estimator.estimateTokens(content));\n   *   return content;\n   * }\n   * ```\n   */\n  getContent(): Promise<string | null>;\n\n  /**\n   * Get the full raw contents of this plugin for inspection.\n   *\n   * Used by library clients to programmatically inspect plugin state.\n   * Returns the actual data structure, not the formatted string.\n   *\n   * @returns Raw plugin data (entries map, array, etc.)\n   */\n  getContents(): unknown;\n\n  /**\n   * Get current token size of plugin content.\n   *\n   * Returns the cached token count from the last `updateTokenCache()` call.\n   * This is used for budget calculation in `prepare()`.\n   *\n   * The cache should be updated via `updateTokenCache()` whenever content\n   * changes. If cache is null, returns 0.\n   *\n   * @returns Current token count (0 if no content or cache not set)\n   */\n  getTokenSize(): number;\n\n  /**\n   * Get token size of instructions (cached after first call).\n   *\n   * Instructions are static, so this is computed once and cached.\n   * Used for budget calculation.\n   *\n   * @returns Token count for instructions (0 if no instructions)\n   */\n  getInstructionsTokenSize(): number;\n\n  /**\n   * Whether this plugin's content can be compacted when context is tight.\n   *\n   * Return true if the plugin can reduce its content size when requested.\n   * Examples: evicting low-priority entries, summarizing, removing old data.\n   *\n   * Return false if content cannot be reduced (e.g., critical state).\n   *\n   * @returns true if compact() can free tokens\n   */\n  isCompactable(): boolean;\n\n  /**\n   * Compact plugin content to free tokens.\n   *\n   * Called by compaction strategies when context is too full.\n   * Should attempt to free **approximately** `targetTokensToFree` tokens.\n   *\n   * This is a **best effort** operation:\n   * - May free more or less than requested\n   * - May return 0 if nothing can be compacted (e.g., all entries are critical)\n   * - Should prioritize removing lowest-priority/oldest data first\n   *\n   * Strategies may include:\n   * - Evicting low-priority entries\n   * - Summarizing verbose content\n   * - Removing oldest data\n   * - Truncating large values\n   *\n   * **IMPORTANT:** Call `invalidateTokenCache()` or `updateTokenCache()`\n   * after modifying content.\n   *\n   * @param targetTokensToFree - Approximate tokens to free (best effort)\n   * @returns Actual tokens freed (may be 0 if nothing can be compacted)\n   *\n   * @example\n   * ```typescript\n   * async compact(targetTokensToFree: number): Promise<number> {\n   *   const before = this.getTokenSize();\n   *   let freed = 0;\n   *\n   *   // Remove low-priority entries until target reached\n   *   const sorted = [...this._entries].sort(byPriority);\n   *   for (const entry of sorted) {\n   *     if (entry.priority === 'critical') continue; // Never remove critical\n   *     if (freed >= targetTokensToFree) break;\n   *\n   *     freed += entry.tokens;\n   *     this._entries.delete(entry.key);\n   *   }\n   *\n   *   this.invalidateTokenCache();\n   *   return freed;\n   * }\n   * ```\n   */\n  compact(targetTokensToFree: number): Promise<number>;\n\n  /**\n   * Get tools provided by this plugin.\n   *\n   * Tools are automatically registered with ToolManager when the plugin\n   * is added to the context. Use a consistent naming convention:\n   * `<prefix>_<action>` (e.g., `memory_store`, `context_set`).\n   *\n   * @returns Array of tool definitions (empty array if no tools)\n   */\n  getTools(): ToolFunction[];\n\n  /**\n   * Cleanup resources when context is destroyed.\n   *\n   * Called when AgentContextNextGen.destroy() is invoked.\n   * Use for releasing resources, closing connections, etc.\n   */\n  destroy(): void;\n\n  /**\n   * Serialize plugin state for session persistence.\n   *\n   * **MUST be synchronous.** Return a JSON-serializable object representing\n   * the plugin's current state. This is called when saving a session.\n   *\n   * For plugins with async data (e.g., external storage), return only\n   * references/keys here and handle async restoration separately.\n   *\n   * @returns Serializable state object\n   *\n   * @example\n   * ```typescript\n   * getState(): unknown {\n   *   return {\n   *     entries: [...this._entries].map(([k, v]) => ({ key: k, ...v })),\n   *     version: 1,  // Include version for future migrations\n   *   };\n   * }\n   * ```\n   */\n  getState(): unknown;\n\n  /**\n   * Restore plugin state from serialized data.\n   *\n   * Called when loading a saved session. The state comes from a previous\n   * `getState()` call on the same plugin type.\n   *\n   * **IMPORTANT:** Call `invalidateTokenCache()` after restoring state\n   * to ensure token counts are recalculated.\n   *\n   * @param state - Previously serialized state from getState()\n   *\n   * @example\n   * ```typescript\n   * restoreState(state: unknown): void {\n   *   const s = state as { entries: Array<{ key: string; value: unknown }> };\n   *   this._entries.clear();\n   *   for (const entry of s.entries || []) {\n   *     this._entries.set(entry.key, entry);\n   *   }\n   *   this.invalidateTokenCache(); // IMPORTANT: refresh token cache\n   * }\n   * ```\n   */\n  restoreState(state: unknown): void;\n}\n\n// ============================================================================\n// Compaction Strategy\n// ============================================================================\n\n// ============================================================================\n// Context Budget\n// ============================================================================\n\n/**\n * Token budget breakdown - clear and simple\n */\nexport interface ContextBudget {\n  /** Maximum context tokens for the model */\n  maxTokens: number;\n\n  /** Tokens reserved for LLM response */\n  responseReserve: number;\n\n  /** Tokens used by system message (prompt + instructions + plugin content) */\n  systemMessageTokens: number;\n\n  /** Tokens used by tool definitions (NEVER compacted) */\n  toolsTokens: number;\n\n  /** Tokens used by conversation history */\n  conversationTokens: number;\n\n  /** Tokens used by current input (user message or tool results) */\n  currentInputTokens: number;\n\n  /** Total tokens used */\n  totalUsed: number;\n\n  /** Available tokens (maxTokens - responseReserve - totalUsed) */\n  available: number;\n\n  /** Usage percentage (totalUsed / (maxTokens - responseReserve)) */\n  utilizationPercent: number;\n\n  /** Breakdown by component for debugging */\n  breakdown: {\n    systemPrompt: number;\n    persistentInstructions: number;\n    pluginInstructions: number;\n    pluginContents: Record<string, number>;\n    tools: number;\n    conversation: number;\n    currentInput: number;\n  };\n}\n\n// ============================================================================\n// Prepared Context\n// ============================================================================\n\n/**\n * Result of prepare() - ready for LLM call\n */\nexport interface PreparedContext {\n  /** Final input items array for LLM */\n  input: InputItem[];\n\n  /** Token budget breakdown */\n  budget: ContextBudget;\n\n  /** Whether compaction was performed */\n  compacted: boolean;\n\n  /** Log of compaction actions taken */\n  compactionLog: string[];\n}\n\n// ============================================================================\n// Current Input Handling\n// ============================================================================\n\n/**\n * Result of handling oversized current input\n */\nexport interface OversizedInputResult {\n  /** Whether the input was accepted (possibly truncated) */\n  accepted: boolean;\n\n  /** Processed content (truncated if needed) */\n  content: string;\n\n  /** Error message if rejected */\n  error?: string;\n\n  /** Warning message if truncated */\n  warning?: string;\n\n  /** Original size in bytes */\n  originalSize: number;\n\n  /** Final size in bytes */\n  finalSize: number;\n}\n\n// ============================================================================\n// Configuration\n// ============================================================================\n\n/**\n * Feature flags for enabling/disabling plugins\n */\nexport interface ContextFeatures {\n  /** Enable WorkingMemory plugin (default: true) */\n  workingMemory?: boolean;\n\n  /** Enable InContextMemory plugin (default: false) */\n  inContextMemory?: boolean;\n\n  /** Enable PersistentInstructions plugin (default: false) */\n  persistentInstructions?: boolean;\n\n  /** Enable UserInfo plugin (default: false) */\n  userInfo?: boolean;\n\n  /** Enable ToolCatalog plugin for dynamic tool loading/unloading (default: false) */\n  toolCatalog?: boolean;\n}\n\n/**\n * Default feature configuration\n */\nexport const DEFAULT_FEATURES: Required<ContextFeatures> = {\n  workingMemory: true,\n  inContextMemory: true,\n  persistentInstructions: false,\n  userInfo: false,\n  toolCatalog: false,\n};\n\n// ============================================================================\n// Plugin Configurations (for auto-initialization)\n// ============================================================================\n\n/**\n * Plugin configurations for auto-initialization.\n * When features are enabled, plugins are created with these configs.\n * The config shapes match each plugin's constructor parameter.\n */\nexport interface PluginConfigs {\n  /**\n   * Working memory plugin config (used when features.workingMemory=true).\n   * See WorkingMemoryPluginConfig for full options.\n   */\n  workingMemory?: Record<string, unknown>;\n\n  /**\n   * In-context memory plugin config (used when features.inContextMemory=true).\n   * See InContextMemoryConfig for full options.\n   */\n  inContextMemory?: Record<string, unknown>;\n\n  /**\n   * Persistent instructions plugin config (used when features.persistentInstructions=true).\n   * Note: agentId is auto-filled from context config if not provided.\n   * See PersistentInstructionsConfig for full options.\n   */\n  persistentInstructions?: Record<string, unknown>;\n\n  /**\n   * User info plugin config (used when features.userInfo=true).\n   * See UserInfoPluginConfig for full options.\n   */\n  userInfo?: Record<string, unknown>;\n\n  /**\n   * Tool catalog plugin config (used when features.toolCatalog=true).\n   * See ToolCatalogPluginConfig for full options.\n   */\n  toolCatalog?: Record<string, unknown>;\n}\n\n/**\n * AgentContextNextGen configuration\n */\nexport interface AgentContextNextGenConfig {\n  /** Model name (used for context window lookup) */\n  model: string;\n\n  /** Maximum context tokens (auto-detected from model if not provided) */\n  maxContextTokens?: number;\n\n  /** Tokens to reserve for response (default: 4096) */\n  responseReserve?: number;\n\n  /** System prompt provided by user */\n  systemPrompt?: string;\n\n  /**\n   * Compaction strategy name (default: 'default').\n   * Used to create strategy from StrategyRegistry if compactionStrategy not provided.\n   */\n  strategy?: string;\n\n  /**\n   * Custom compaction strategy instance.\n   * If provided, overrides the `strategy` option.\n   */\n  compactionStrategy?: ICompactionStrategy;\n\n  /** Feature flags */\n  features?: ContextFeatures;\n\n  /** Agent ID (required for PersistentInstructions) */\n  agentId?: string;\n\n  /** User ID for multi-user scenarios. Automatically flows to ToolContext for all tool executions. */\n  userId?: string;\n\n  /**\n   * Restrict this agent to specific auth identities (connector + optional account alias).\n   * When set, only these identities are visible in ToolContext and tool descriptions.\n   * Each identity produces its own tool set (e.g., microsoft_work_api, microsoft_personal_api).\n   * When not set, all connectors visible to the current userId are available.\n   */\n  identities?: AuthIdentity[];\n\n  /** Initial tools to register */\n  tools?: ToolFunction[];\n\n  /** Storage for session persistence */\n  storage?: IContextStorageFromDomain;\n\n  /** Restrict tool catalog to specific categories */\n  toolCategories?: ToolCategoryScope;\n\n  /** Plugin-specific configurations (used with features flags) */\n  plugins?: PluginConfigs;\n\n  /**\n   * Hard timeout in milliseconds for any single tool execution.\n   * Acts as a safety net: if a tool's own timeout mechanism fails\n   * (e.g. a child process doesn't exit), this will force-resolve with an error.\n   * Default: 0 (disabled - relies on each tool's own timeout)\n   */\n  toolExecutionTimeout?: number;\n}\n\n/**\n * Default configuration values\n */\nexport const DEFAULT_CONFIG = {\n  responseReserve: 4096,\n  strategy: 'algorithmic',\n};\n\n// ============================================================================\n// Storage Interface (re-exported from domain for convenience)\n// ============================================================================\n\n/**\n * Re-export storage types from domain layer.\n * Domain is the single source of truth for these interfaces.\n */\nexport type {\n  IContextStorage,\n  SerializedContextState,\n  StoredContextSession,\n  ContextSessionMetadata,\n} from '../../domain/interfaces/IContextStorage.js';\n\n// ============================================================================\n// Events\n// ============================================================================\n\n/**\n * Events emitted by AgentContextNextGen\n */\nexport interface ContextEvents {\n  /** Emitted when context is prepared */\n  'context:prepared': { budget: ContextBudget; compacted: boolean };\n\n  /** Emitted when compaction is performed */\n  'context:compacted': { tokensFreed: number; log: string[] };\n\n  /** Emitted right after budget is calculated in prepare() - for reactive monitoring */\n  'budget:updated': { budget: ContextBudget; timestamp: number };\n\n  /** Emitted when budget reaches warning threshold (>70%) */\n  'budget:warning': { budget: ContextBudget };\n\n  /** Emitted when budget reaches critical threshold (>90%) */\n  'budget:critical': { budget: ContextBudget };\n\n  /** Emitted when compaction is about to start */\n  'compaction:starting': {\n    budget: ContextBudget;\n    targetTokensToFree: number;\n    timestamp: number;\n  };\n\n  /** Emitted when current input is too large */\n  'input:oversized': { result: OversizedInputResult };\n\n  /** Emitted when a message is added */\n  'message:added': { role: string; index: number };\n\n  /** Emitted when conversation is cleared */\n  'conversation:cleared': { reason?: string };\n}\n\n/**\n * Callback type for beforeCompaction hook.\n * Called before compaction starts, allowing agents to save important data.\n */\nexport type BeforeCompactionCallback = (info: {\n  budget: ContextBudget;\n  targetTokensToFree: number;\n  strategy: string;\n}) => Promise<void>;\n\n// ============================================================================\n// Compaction Strategy Interface (Pluggable)\n// ============================================================================\n\n/**\n * Result of compact() operation.\n */\nexport interface CompactionResult {\n  /** Tokens actually freed by compaction */\n  tokensFreed: number;\n\n  /** Number of messages removed from conversation */\n  messagesRemoved: number;\n\n  /** Names of plugins that were compacted */\n  pluginsCompacted: string[];\n\n  /** Log of actions taken during compaction */\n  log: string[];\n}\n\n/**\n * Result of consolidate() operation.\n */\nexport interface ConsolidationResult {\n  /** Whether any consolidation was performed */\n  performed: boolean;\n\n  /** Net token change (negative = freed, positive = added, e.g., summaries) */\n  tokensChanged: number;\n\n  /** Description of actions taken */\n  actions: string[];\n}\n\n/**\n * Read-only context passed to compaction strategies.\n * Provides access to data needed for compaction decisions and\n * controlled methods to modify state.\n */\nexport interface CompactionContext {\n  /** Current budget (from prepare) */\n  readonly budget: ContextBudget;\n\n  /** Current conversation history (read-only) */\n  readonly conversation: ReadonlyArray<InputItem>;\n\n  /** Current input (read-only) */\n  readonly currentInput: ReadonlyArray<InputItem>;\n\n  /** Registered plugins (for querying state) */\n  readonly plugins: ReadonlyArray<IContextPluginNextGen>;\n\n  /** Strategy name for logging */\n  readonly strategyName: string;\n\n  // === Methods for strategy to modify state (controlled access) ===\n\n  /**\n   * Remove messages by indices.\n   * Handles tool pair preservation internally.\n   *\n   * @param indices - Array of message indices to remove\n   * @returns Tokens actually freed\n   */\n  removeMessages(indices: number[]): Promise<number>;\n\n  /**\n   * Compact a specific plugin.\n   *\n   * @param pluginName - Name of the plugin to compact\n   * @param targetTokens - Approximate tokens to free\n   * @returns Tokens actually freed\n   */\n  compactPlugin(pluginName: string, targetTokens: number): Promise<number>;\n\n  /**\n   * Estimate tokens for an item.\n   *\n   * @param item - Input item to estimate\n   * @returns Estimated token count\n   */\n  estimateTokens(item: InputItem): number;\n}\n\n/**\n * Compaction strategy interface.\n *\n * Strategies implement two methods:\n * - `compact()`: Emergency compaction when thresholds exceeded (called from prepare())\n * - `consolidate()`: Post-cycle cleanup and optimization (called after agentic loop)\n *\n * Use `compact()` for quick, threshold-based token reduction.\n * Use `consolidate()` for more expensive operations like summarization.\n */\nexport interface ICompactionStrategy {\n  /** Strategy name (unique identifier) for identification and logging */\n  readonly name: string;\n\n  /** Human-readable display name for UI */\n  readonly displayName: string;\n\n  /** Description explaining the strategy behavior */\n  readonly description: string;\n\n  /** Threshold percentage (0-1) at which compact() is triggered */\n  readonly threshold: number;\n\n  /**\n   * Plugin names this strategy requires to function.\n   * Validation is performed when strategy is assigned to context.\n   * If any required plugin is missing, an error is thrown.\n   *\n   * @example\n   * ```typescript\n   * readonly requiredPlugins = ['working_memory'] as const;\n   * ```\n   */\n  readonly requiredPlugins?: readonly string[];\n\n  /**\n   * Emergency compaction - triggered when context usage exceeds threshold.\n   * Called from prepare() when utilization > threshold.\n   *\n   * Should be fast and focus on freeing tokens quickly.\n   *\n   * @param context - Compaction context with controlled access to state\n   * @param targetToFree - Approximate tokens to free\n   * @returns Result describing what was done\n   */\n  compact(context: CompactionContext, targetToFree: number): Promise<CompactionResult>;\n\n  /**\n   * Post-cycle consolidation - run after agentic cycle completes.\n   * Called from Agent after run()/stream() finishes (before session save).\n   *\n   * Use for more expensive operations:\n   * - Summarizing long conversations\n   * - Memory optimization and deduplication\n   * - Promoting important data to persistent storage\n   *\n   * @param context - Compaction context with controlled access to state\n   * @returns Result describing what was done\n   */\n  consolidate(context: CompactionContext): Promise<ConsolidationResult>;\n}\n","/**\n * Base provider class with common functionality\n */\n\nimport { IProvider, ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport { ProviderConfig } from '../../../domain/types/ProviderConfig.js';\nimport { InvalidConfigError } from '../../../domain/errors/AIErrors.js';\n\nexport abstract class BaseProvider implements IProvider {\n  abstract readonly name: string;\n  abstract readonly capabilities: ProviderCapabilities;\n\n  constructor(protected config: ProviderConfig) {}\n\n  /**\n   * Validate provider configuration\n   * Returns validation result with details\n   */\n  async validateConfig(): Promise<boolean> {\n    const validation = this.validateApiKey();\n    return validation.isValid;\n  }\n\n  /**\n   * Validate API key format and presence\n   * Can be overridden by providers with specific key formats\n   */\n  protected validateApiKey(): { isValid: boolean; warning?: string } {\n    const apiKey = this.config.apiKey;\n\n    // Check for presence\n    if (!apiKey || apiKey.trim().length === 0) {\n      return { isValid: false };\n    }\n\n    // Check for common placeholder values\n    const placeholders = [\n      'your-api-key',\n      'YOUR_API_KEY',\n      'sk-xxx',\n      'api-key-here',\n      'REPLACE_ME',\n      '<your-key>',\n    ];\n\n    if (placeholders.some((p) => apiKey.includes(p))) {\n      return {\n        isValid: false,\n        warning: `API key appears to be a placeholder value`,\n      };\n    }\n\n    // Provider-specific format validation (can be overridden)\n    return this.validateProviderSpecificKeyFormat(apiKey);\n  }\n\n  /**\n   * Override this method in provider implementations for specific key format validation\n   */\n  protected validateProviderSpecificKeyFormat(_apiKey: string): { isValid: boolean; warning?: string } {\n    // Default: accept any non-empty key\n    // Override in subclasses for provider-specific validation\n    return { isValid: true };\n  }\n\n  /**\n   * Validate config and throw if invalid\n   */\n  protected assertValidConfig(): void {\n    const validation = this.validateApiKey();\n    if (!validation.isValid) {\n      throw new InvalidConfigError(\n        `Invalid API key for provider '${this.name}'${validation.warning ? `: ${validation.warning}` : ''}`\n      );\n    }\n  }\n\n  /**\n   * Get API key from config\n   */\n  protected getApiKey(): string {\n    return this.config.apiKey;\n  }\n\n  /**\n   * Get base URL if configured\n   */\n  protected getBaseURL(): string | undefined {\n    return this.config.baseURL;\n  }\n\n  /**\n   * Get timeout configuration\n   */\n  protected getTimeout(): number {\n    return this.config.timeout || 60000; // 60s default\n  }\n\n  /**\n   * Get max retries configuration\n   */\n  protected getMaxRetries(): number {\n    return this.config.maxRetries || 3;\n  }\n}\n","/**\n * Base text provider with common text generation functionality\n */\n\nimport { BaseProvider } from './BaseProvider.js';\nimport { ITextProvider, ModelCapabilities, TextGenerateOptions } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { StreamEvent } from '../../../domain/entities/StreamEvent.js';\nimport { CircuitBreaker, DEFAULT_CIRCUIT_BREAKER_CONFIG } from '../../resilience/CircuitBreaker.js';\nimport { logger, FrameworkLogger } from '../../observability/Logger.js';\nimport { metrics } from '../../observability/Metrics.js';\n\nexport abstract class BaseTextProvider extends BaseProvider implements ITextProvider {\n  protected circuitBreaker?: CircuitBreaker;\n  protected logger: FrameworkLogger;\n  private _isObservabilityInitialized = false;\n\n  constructor(config: any) {\n    super(config);\n\n    // Initialize with default logger (will be updated with provider name on first use)\n    this.logger = logger.child({\n      component: 'Provider',\n      provider: 'unknown',\n    });\n\n    // Circuit breaker created lazily on first use\n  }\n\n  /**\n   * Auto-initialize observability on first use (lazy initialization)\n   * This is called automatically by executeWithCircuitBreaker()\n   * @internal\n   */\n  private ensureObservabilityInitialized(): void {\n    if (this._isObservabilityInitialized) {\n      return;\n    }\n\n    const providerName = this.name || 'unknown';\n\n    // Create circuit breaker with provider name\n    const cbConfig = (this.config as any).circuitBreaker || DEFAULT_CIRCUIT_BREAKER_CONFIG;\n    this.circuitBreaker = new CircuitBreaker(\n      `provider:${providerName}`,\n      cbConfig\n    );\n\n    // Update logger with provider name\n    this.logger = logger.child({\n      component: 'Provider',\n      provider: providerName,\n    });\n\n    // Forward circuit breaker events to metrics\n    this.circuitBreaker.on('opened', (data) => {\n      this.logger.warn(data, 'Circuit breaker opened');\n      metrics.increment('circuit_breaker.opened', 1, {\n        breaker: data.name,\n        provider: providerName,\n      });\n    });\n\n    this.circuitBreaker.on('closed', (data) => {\n      this.logger.info(data, 'Circuit breaker closed');\n      metrics.increment('circuit_breaker.closed', 1, {\n        breaker: data.name,\n        provider: providerName,\n      });\n    });\n\n    this._isObservabilityInitialized = true;\n  }\n\n  /**\n   * DEPRECATED: No longer needed, kept for backward compatibility\n   * Observability is now auto-initialized on first use\n   * @deprecated Initialization happens automatically\n   */\n  protected initializeObservability(_providerName: string): void {\n    // Force initialization now (for providers that still call this)\n    this.ensureObservabilityInitialized();\n  }\n\n  abstract generate(options: TextGenerateOptions): Promise<LLMResponse>;\n  abstract streamGenerate(options: TextGenerateOptions): AsyncIterableIterator<StreamEvent>;\n  abstract getModelCapabilities(model: string): ModelCapabilities;\n\n  /**\n   * Execute with circuit breaker protection (helper for subclasses)\n   */\n  protected async executeWithCircuitBreaker<TResult>(\n    operation: () => Promise<TResult>,\n    model?: string\n  ): Promise<TResult> {\n    // Auto-initialize observability on first use\n    this.ensureObservabilityInitialized();\n\n    const startTime = Date.now();\n    const operationName = 'llm.generate';\n\n    this.logger.debug({\n      operation: operationName,\n      model,\n    }, 'LLM call started');\n\n    metrics.increment('provider.llm.request', 1, {\n      provider: this.name,\n      model: model || 'unknown',\n    });\n\n    try {\n      // Execute with circuit breaker (should always be initialized after ensureObservabilityInitialized)\n      if (!this.circuitBreaker) {\n        // Fallback: execute without circuit breaker (should never happen)\n        return await operation();\n      }\n\n      const result = await this.circuitBreaker.execute(operation);\n\n      const duration = Date.now() - startTime;\n\n      this.logger.info({\n        operation: operationName,\n        model,\n        duration,\n      }, 'LLM call completed');\n\n      metrics.timing('provider.llm.latency', duration, {\n        provider: this.name,\n        model: model || 'unknown',\n      });\n\n      metrics.increment('provider.llm.response', 1, {\n        provider: this.name,\n        model: model || 'unknown',\n        status: 'success',\n      });\n\n      return result;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n\n      this.logger.error({\n        operation: operationName,\n        model,\n        error: (error as Error).message,\n        duration,\n      }, 'LLM call failed');\n\n      metrics.increment('provider.llm.error', 1, {\n        provider: this.name,\n        model: model || 'unknown',\n        error: (error as Error).name,\n      });\n\n      throw error;\n    }\n  }\n\n  /**\n   * Get circuit breaker metrics\n   */\n  getCircuitBreakerMetrics() {\n    if (!this.circuitBreaker) {\n      // Not yet initialized (no calls made yet)\n      return null;\n    }\n    return this.circuitBreaker.getMetrics();\n  }\n\n  /**\n   * Normalize input to string (helper for providers that don't support complex input)\n   */\n  protected normalizeInputToString(input: string | any[]): string {\n    if (typeof input === 'string') {\n      return input;\n    }\n\n    // Extract text from InputItem array\n    const textParts: string[] = [];\n    for (const item of input) {\n      if (item.type === 'message') {\n        for (const content of item.content) {\n          if (content.type === 'input_text') {\n            textParts.push(content.text);\n          } else if (content.type === 'output_text') {\n            textParts.push(content.text);\n          }\n        }\n      }\n    }\n\n    return textParts.join('\\n');\n  }\n\n  /**\n   * List available models from the provider's API.\n   * Default returns empty array; providers override when they have SDK support.\n   */\n  async listModels(): Promise<string[]> {\n    return [];\n  }\n\n  /**\n   * Clean up provider resources (circuit breaker listeners, etc.)\n   * Should be called when the provider is no longer needed.\n   */\n  destroy(): void {\n    if (this.circuitBreaker) {\n      this.circuitBreaker.removeAllListeners();\n      this.circuitBreaker = undefined;\n    }\n    this._isObservabilityInitialized = false;\n  }\n}\n","/**\n * OpenAI Responses API Converter\n *\n * Converts between our internal format and OpenAI's Responses API format.\n * The Responses API is the successor to Chat Completions API and is required\n * for GPT-5.2 Pro, GPT-5.2 Codex, and other advanced models.\n *\n * Key differences from Chat Completions:\n * - Uses `input` (Items array) instead of `messages`\n * - Uses `instructions` (top-level) instead of system message\n * - Tool definitions are internally-tagged (no nested `function` object)\n * - Responses contain Items array with different types\n */\n\nimport { InputItem, MessageRole } from '../../../domain/entities/Message.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { Tool } from '../../../domain/entities/Tool.js';\nimport { ContentType } from '../../../domain/entities/Content.js';\nimport * as ResponsesAPI from 'openai/resources/responses/responses.js';\n\ntype ResponsesAPIInputItem = ResponsesAPI.ResponseInputItem;\ntype ResponsesAPIResponse = ResponsesAPI.Response;\n\nexport class OpenAIResponsesConverter {\n  /**\n   * Convert our input format to Responses API format\n   */\n  convertInput(\n    input: string | InputItem[],\n    instructions?: string\n  ): { input: string | ResponsesAPIInputItem[]; instructions?: string } {\n    // Simple string input\n    if (typeof input === 'string') {\n      return {\n        input,\n        instructions,\n      };\n    }\n\n    // Convert InputItem[] to Responses API Items\n    const items: ResponsesAPIInputItem[] = [];\n\n    for (const item of input) {\n      if (item.type === 'message') {\n        // Convert message item\n        const messageContent: any[] = [];\n\n        // OpenAI Responses API requires specific content types based on role:\n        // - user messages: input_text, input_image, input_audio, input_file\n        // - assistant messages: output_text, refusal\n        const isAssistant = item.role === 'assistant';\n\n        for (const content of item.content) {\n          switch (content.type) {\n            case 'input_text':\n            case 'output_text':\n              // Map text content type based on message role\n              messageContent.push({\n                type: isAssistant ? 'output_text' : 'input_text',\n                text: content.text,\n              });\n              break;\n\n            case 'input_image_url':\n              // Images are only valid for user messages\n              if (!isAssistant) {\n                messageContent.push({\n                  type: 'input_image',\n                  image_url: content.image_url.url,\n                  ...(content.image_url.detail && { detail: content.image_url.detail }),\n                });\n              }\n              break;\n\n            case 'tool_use':\n              // Tool use becomes a separate function_call item\n              items.push({\n                type: 'function_call',\n                call_id: content.id,\n                name: content.name,\n                arguments: content.arguments,\n              } as ResponsesAPI.ResponseFunctionToolCall);\n              break;\n\n            case 'tool_result': {\n              // Read images from Content object first (set by addToolResults),\n              // fall back to JSON extraction for backward compat\n              const contentImages = (content as any).__images as Array<{ base64: string; mediaType: string }> | undefined;\n\n              let outputText: string;\n              let images: Array<{ base64: string; mediaType: string }>;\n\n              if (contentImages?.length) {\n                // Images already extracted at context layer  use text content as-is\n                outputText = typeof content.content === 'string'\n                  ? content.content\n                  : JSON.stringify(content.content);\n                images = contentImages;\n              } else {\n                // Fallback: try extracting from raw JSON output\n                const rawOutput = typeof content.content === 'string'\n                  ? content.content\n                  : JSON.stringify(content.content);\n                const extracted = this.extractImagesFromOutput(rawOutput);\n                outputText = extracted.text;\n                images = extracted.images;\n              }\n\n              items.push({\n                type: 'function_call_output',\n                call_id: content.tool_use_id,\n                output: outputText,\n              } as any);\n\n              // OpenAI function_call_output only supports text.\n              // Inject a follow-up user message with the image(s) so the model can see them.\n              if (images.length > 0) {\n                const imageContent: any[] = images.map((img) => ({\n                  type: 'input_image',\n                  image_url: `data:${img.mediaType};base64,${img.base64}`,\n                }));\n                items.push({\n                  type: 'message',\n                  role: 'user',\n                  content: [\n                    { type: 'input_text', text: '[Screenshot from tool result]' },\n                    ...imageContent,\n                  ],\n                  status: 'completed' as const,\n                } as any);\n              }\n              break;\n            }\n          }\n        }\n\n        // Only add message if it has content (tool_use/tool_result don't go in message)\n        if (messageContent.length > 0) {\n          items.push({\n            type: 'message',\n            role: item.role,\n            content: messageContent,\n            // Only include id if it's a valid OpenAI message ID (starts with msg_)\n            // New messages shouldn't have id; previous outputs keep their original id\n            ...(item.id?.startsWith('msg_') ? { id: item.id } : {}),\n            status: 'completed' as const,\n          } as ResponsesAPI.ResponseInputItem.Message);\n        }\n      } else if (item.type === 'compaction') {\n        // Pass through compaction items\n        items.push({\n          type: 'compaction',\n          id: item.id,\n          encrypted_content: item.encrypted_content,\n        } as ResponsesAPI.ResponseCompactionItemParam);\n      }\n    }\n\n    return {\n      input: items,\n      instructions,\n    };\n  }\n\n  /**\n   * Convert Responses API response to our LLMResponse format\n   */\n  convertResponse(response: ResponsesAPIResponse): LLMResponse {\n    const content: any[] = [];\n    let outputText = '';\n    let messageId: string | undefined;\n\n    // Process all output items\n    for (const item of response.output || []) {\n      if (item.type === 'message') {\n        // Extract message content\n        const messageItem = item as ResponsesAPI.ResponseOutputMessage;\n\n        // Extract message ID (first message item wins)\n        if (!messageId && messageItem.id) {\n          messageId = messageItem.id;\n        }\n\n        for (const contentItem of messageItem.content || []) {\n          if (contentItem.type === 'output_text') {\n            const textContent = contentItem as ResponsesAPI.ResponseOutputText;\n            content.push({\n              type: 'output_text',\n              text: textContent.text,\n              annotations: textContent.annotations || [],\n            });\n            outputText += textContent.text;\n          }\n        }\n      } else if (item.type === 'function_call') {\n        // Convert function_call to tool_use\n        const functionCall = item as ResponsesAPI.ResponseFunctionToolCall;\n        content.push({\n          type: 'tool_use',\n          id: functionCall.call_id,\n          name: functionCall.name,\n          arguments: functionCall.arguments,\n        });\n      } else if (item.type === 'reasoning') {\n        // Extract reasoning summary as ThinkingContent (unified thinking API)\n        const reasoning = item as ResponsesAPI.ResponseReasoningItem;\n        if (reasoning.summary) {\n          let summaryText: string;\n          if (typeof reasoning.summary === 'string') {\n            summaryText = reasoning.summary;\n          } else if (Array.isArray(reasoning.summary)) {\n            summaryText = reasoning.summary\n              .map((s: any) => s.text || '')\n              .filter(Boolean)\n              .join('\\n');\n          } else {\n            summaryText = '';\n          }\n          if (summaryText) {\n            content.push({\n              type: ContentType.THINKING,\n              thinking: summaryText,\n              persistInHistory: false,\n            });\n          }\n        }\n      }\n    }\n\n    // Use output_text helper from SDK\n    if (!outputText) {\n      outputText = response.output_text || '';\n    }\n\n    // IMPORTANT: Use the actual message ID from output items, not the response ID\n    // Response IDs start with \"resp_\" but OpenAI expects message IDs starting with \"msg_\"\n    // when we send them back in subsequent requests\n    const finalMessageId = messageId || response.id;\n\n    return {\n      id: response.id,\n      object: 'response',\n      created_at: response.created_at,\n      status: response.status || 'completed',\n      model: response.model,\n      output: [\n        {\n          type: 'message',\n          id: finalMessageId,\n          role: MessageRole.ASSISTANT,\n          content,\n        },\n      ],\n      output_text: outputText,\n      // Extract thinking text from content for convenience field\n      ...((() => {\n        const thinkingTexts = content\n          .filter((c: any) => c.type === ContentType.THINKING)\n          .map((c: any) => c.thinking as string)\n          .filter(Boolean);\n        return thinkingTexts.length > 0 ? { thinking: thinkingTexts.join('\\n') } : {};\n      })()),\n      usage: {\n        input_tokens: response.usage?.input_tokens || 0,\n        output_tokens: response.usage?.output_tokens || 0,\n        total_tokens: response.usage?.total_tokens || 0,\n        ...((response.usage as any)?.output_tokens_details?.reasoning_tokens != null && {\n          output_tokens_details: {\n            reasoning_tokens: (response.usage as any).output_tokens_details.reasoning_tokens,\n          },\n        }),\n      },\n    };\n  }\n\n  /**\n   * Convert our tool definitions to Responses API format\n   *\n   * Key difference: Responses API uses internally-tagged format\n   * (no nested `function` object) and strict mode requires proper schemas\n   */\n  convertTools(tools: Tool[]): ResponsesAPI.Tool[] {\n    return tools.map((tool) => {\n      if (tool.type === 'function') {\n        // Remove the nested `function` wrapper\n        const funcDef = tool.function;\n\n        // IMPORTANT: Only enable strict mode if explicitly requested (backward compatible)\n        // Strict mode requires all object schemas to have \"additionalProperties\": false\n        // Default to false for backward compatibility with existing tools\n        const useStrict = funcDef.strict === true;\n\n        return {\n          type: 'function',\n          name: funcDef.name,\n          description: funcDef.description || '',\n          parameters: funcDef.parameters || null,\n          strict: useStrict,\n        } as ResponsesAPI.FunctionTool;\n      }\n\n      // Built-in tools (web_search, file_search, etc.)\n      return tool as ResponsesAPI.Tool;\n    });\n  }\n\n  /**\n   * Convert tool_choice option to Responses API format\n   */\n  convertToolChoice(\n    toolChoice?: 'auto' | 'required' | { type: 'function'; function: { name: string } }\n  ): ResponsesAPI.ResponseCreateParams['tool_choice'] {\n    if (!toolChoice || toolChoice === 'auto') {\n      return 'auto';\n    }\n\n    if (toolChoice === 'required') {\n      return 'required';\n    }\n\n    // Specific function\n    return {\n      type: 'function',\n      name: toolChoice.function.name,\n    } as ResponsesAPI.ToolChoiceFunction;\n  }\n\n  /**\n   * Convert response_format option to Responses API format (modalities)\n   */\n  convertResponseFormat(\n    responseFormat?: {\n      type: 'text' | 'json_object' | 'json_schema';\n      json_schema?: any;\n    }\n  ): ResponsesAPI.ResponseTextConfig | undefined {\n    if (!responseFormat) {\n      return undefined;\n    }\n\n    if (responseFormat.type === 'json_schema' && responseFormat.json_schema) {\n      return {\n        type: 'text',\n        text: {\n          type: 'json_schema',\n          name: responseFormat.json_schema.name || 'response',\n          schema: responseFormat.json_schema.schema || responseFormat.json_schema,\n          description: responseFormat.json_schema.description,\n          strict: responseFormat.json_schema.strict !== false,\n        },\n      } as ResponsesAPI.ResponseTextConfig;\n    }\n\n    if (responseFormat.type === 'json_object') {\n      return {\n        type: 'text',\n        text: {\n          type: 'json_object',\n        },\n      } as ResponsesAPI.ResponseTextConfig;\n    }\n\n    return {\n      type: 'text',\n      text: {\n        type: 'text',\n      },\n    } as ResponsesAPI.ResponseTextConfig;\n  }\n\n  /**\n   * Extract __images from a JSON tool result and return cleaned text + images.\n   * Used by the __images convention for multimodal tool results.\n   */\n  private extractImagesFromOutput(output: string): {\n    text: string;\n    images: Array<{ base64: string; mediaType: string }>;\n  } {\n    try {\n      const parsed = JSON.parse(output);\n      if (parsed && Array.isArray(parsed.__images) && parsed.__images.length > 0) {\n        const images = parsed.__images;\n        const { __images: _, base64: __, ...rest } = parsed;\n        return { text: JSON.stringify(rest), images };\n      }\n    } catch {\n      // Not JSON or no __images\n    }\n    return { text: output, images: [] };\n  }\n}\n","/**\n * Streaming event types for real-time LLM responses\n * Based on OpenAI Responses API event format as the internal standard\n */\n\nimport { TokenUsage } from './Response.js';\n\n/**\n * Stream event type enum\n */\nexport enum StreamEventType {\n  RESPONSE_CREATED = 'response.created',\n  RESPONSE_IN_PROGRESS = 'response.in_progress',\n  OUTPUT_TEXT_DELTA = 'response.output_text.delta',\n  OUTPUT_TEXT_DONE = 'response.output_text.done',\n  TOOL_CALL_START = 'response.tool_call.start',\n  TOOL_CALL_ARGUMENTS_DELTA = 'response.tool_call_arguments.delta',\n  TOOL_CALL_ARGUMENTS_DONE = 'response.tool_call_arguments.done',\n  TOOL_EXECUTION_START = 'response.tool_execution.start',\n  TOOL_EXECUTION_DONE = 'response.tool_execution.done',\n  ITERATION_COMPLETE = 'response.iteration.complete',\n  REASONING_DELTA = 'response.reasoning.delta',\n  REASONING_DONE = 'response.reasoning.done',\n  RESPONSE_COMPLETE = 'response.complete',\n  ERROR = 'response.error',\n}\n\n/**\n * Base interface for all stream events\n */\ninterface BaseStreamEvent {\n  type: StreamEventType;\n  response_id: string;\n}\n\n/**\n * Response created - first event in stream\n */\nexport interface ResponseCreatedEvent extends BaseStreamEvent {\n  type: StreamEventType.RESPONSE_CREATED;\n  model: string;\n  created_at: number;\n}\n\n/**\n * Response in progress\n */\nexport interface ResponseInProgressEvent extends BaseStreamEvent {\n  type: StreamEventType.RESPONSE_IN_PROGRESS;\n}\n\n/**\n * Text delta - incremental text output\n */\nexport interface OutputTextDeltaEvent extends BaseStreamEvent {\n  type: StreamEventType.OUTPUT_TEXT_DELTA;\n  item_id: string;\n  output_index: number;\n  content_index: number;\n  delta: string;\n  sequence_number: number;\n}\n\n/**\n * Text output complete for this item\n */\nexport interface OutputTextDoneEvent extends BaseStreamEvent {\n  type: StreamEventType.OUTPUT_TEXT_DONE;\n  item_id: string;\n  output_index: number;\n  text: string; // Complete accumulated text\n}\n\n/**\n * Tool call detected and starting\n */\nexport interface ToolCallStartEvent extends BaseStreamEvent {\n  type: StreamEventType.TOOL_CALL_START;\n  item_id: string;\n  tool_call_id: string;\n  tool_name: string;\n}\n\n/**\n * Tool call arguments delta - incremental JSON\n */\nexport interface ToolCallArgumentsDeltaEvent extends BaseStreamEvent {\n  type: StreamEventType.TOOL_CALL_ARGUMENTS_DELTA;\n  item_id: string;\n  tool_call_id: string;\n  tool_name: string;\n  delta: string; // JSON chunk\n  sequence_number: number;\n}\n\n/**\n * Tool call arguments complete\n */\nexport interface ToolCallArgumentsDoneEvent extends BaseStreamEvent {\n  type: StreamEventType.TOOL_CALL_ARGUMENTS_DONE;\n  tool_call_id: string;\n  tool_name: string;\n  arguments: string; // Complete JSON string\n  incomplete?: boolean; // True if truncated by max_tokens\n}\n\n/**\n * Tool execution starting\n */\nexport interface ToolExecutionStartEvent extends BaseStreamEvent {\n  type: StreamEventType.TOOL_EXECUTION_START;\n  tool_call_id: string;\n  tool_name: string;\n  arguments: any; // Parsed arguments\n}\n\n/**\n * Tool execution complete\n */\nexport interface ToolExecutionDoneEvent extends BaseStreamEvent {\n  type: StreamEventType.TOOL_EXECUTION_DONE;\n  tool_call_id: string;\n  tool_name: string;\n  result: any;\n  execution_time_ms: number;\n  error?: string; // If tool failed\n}\n\n/**\n * Iteration complete - end of agentic loop iteration\n */\nexport interface IterationCompleteEvent extends BaseStreamEvent {\n  type: StreamEventType.ITERATION_COMPLETE;\n  iteration: number;\n  tool_calls_count: number;\n  has_more_iterations: boolean;\n}\n\n/**\n * Response complete - final event\n */\nexport interface ResponseCompleteEvent extends BaseStreamEvent {\n  type: StreamEventType.RESPONSE_COMPLETE;\n  status: 'completed' | 'incomplete' | 'failed';\n  usage: TokenUsage;\n  iterations: number;\n  duration_ms?: number;\n}\n\n/**\n * Reasoning/thinking delta - incremental reasoning output\n */\nexport interface ReasoningDeltaEvent extends BaseStreamEvent {\n  type: StreamEventType.REASONING_DELTA;\n  item_id: string;\n  delta: string;\n  sequence_number: number;\n}\n\n/**\n * Reasoning/thinking complete for this item\n */\nexport interface ReasoningDoneEvent extends BaseStreamEvent {\n  type: StreamEventType.REASONING_DONE;\n  item_id: string;\n  thinking: string; // Complete accumulated thinking\n}\n\n/**\n * Error event\n */\nexport interface ErrorEvent extends BaseStreamEvent {\n  type: StreamEventType.ERROR;\n  error: {\n    type: string;\n    message: string;\n    code?: string;\n  };\n  recoverable: boolean;\n}\n\n/**\n * Union type of all stream events\n * Discriminated by 'type' field for type narrowing\n */\nexport type StreamEvent =\n  | ResponseCreatedEvent\n  | ResponseInProgressEvent\n  | OutputTextDeltaEvent\n  | OutputTextDoneEvent\n  | ReasoningDeltaEvent\n  | ReasoningDoneEvent\n  | ToolCallStartEvent\n  | ToolCallArgumentsDeltaEvent\n  | ToolCallArgumentsDoneEvent\n  | ToolExecutionStartEvent\n  | ToolExecutionDoneEvent\n  | IterationCompleteEvent\n  | ResponseCompleteEvent\n  | ErrorEvent;\n\n/**\n * Type guard to check if event is a specific type\n */\nexport function isStreamEvent<T extends StreamEvent>(\n  event: StreamEvent,\n  type: StreamEventType\n): event is T {\n  return event.type === type;\n}\n\n/**\n * Type guards for specific events\n */\nexport function isOutputTextDelta(event: StreamEvent): event is OutputTextDeltaEvent {\n  return event.type === StreamEventType.OUTPUT_TEXT_DELTA;\n}\n\nexport function isToolCallStart(event: StreamEvent): event is ToolCallStartEvent {\n  return event.type === StreamEventType.TOOL_CALL_START;\n}\n\nexport function isToolCallArgumentsDelta(\n  event: StreamEvent\n): event is ToolCallArgumentsDeltaEvent {\n  return event.type === StreamEventType.TOOL_CALL_ARGUMENTS_DELTA;\n}\n\nexport function isToolCallArgumentsDone(\n  event: StreamEvent\n): event is ToolCallArgumentsDoneEvent {\n  return event.type === StreamEventType.TOOL_CALL_ARGUMENTS_DONE;\n}\n\nexport function isReasoningDelta(event: StreamEvent): event is ReasoningDeltaEvent {\n  return event.type === StreamEventType.REASONING_DELTA;\n}\n\nexport function isReasoningDone(event: StreamEvent): event is ReasoningDoneEvent {\n  return event.type === StreamEventType.REASONING_DONE;\n}\n\nexport function isResponseComplete(event: StreamEvent): event is ResponseCompleteEvent {\n  return event.type === StreamEventType.RESPONSE_COMPLETE;\n}\n\nexport function isErrorEvent(event: StreamEvent): event is ErrorEvent {\n  return event.type === StreamEventType.ERROR;\n}\n","/**\n * OpenAI Responses API Streaming Converter\n *\n * Converts streaming events from OpenAI's Responses API to our internal StreamEvent format.\n *\n * Responses API streaming events:\n * - response.created\n * - response.output_item.added\n * - response.output_item.content.added\n * - response.output_item.content.delta (text/arguments)\n * - response.output_item.done\n * - response.reasoning_text.delta / response.reasoning_text.done\n * - response.reasoning_summary_text.delta / response.reasoning_summary_text.done\n * - response.done\n */\n\nimport * as ResponsesAPI from 'openai/resources/responses/responses.js';\nimport { StreamEvent, StreamEventType, ReasoningDeltaEvent, ReasoningDoneEvent } from '../../../domain/entities/StreamEvent.js';\n\ntype ResponseStreamEvent = ResponsesAPI.ResponseStreamEvent;\n\nexport class OpenAIResponsesStreamConverter {\n  /**\n   * Convert Responses API stream to our StreamEvent format\n   */\n  async *convertStream(\n    stream: AsyncIterable<ResponseStreamEvent>\n  ): AsyncIterableIterator<StreamEvent> {\n    let responseId = '';\n    let sequenceNumber = 0;\n\n    // Track active items and tool calls\n    const activeItems = new Map<string, { type: string; toolCallId?: string; toolName?: string }>();\n    const toolCallBuffers = new Map<string, { id: string; name: string; args: string }>();\n    // Track reasoning content\n    const reasoningBuffers = new Map<string, string[]>();\n    // Track items that already emitted REASONING_DONE (avoid duplicates)\n    const reasoningDoneEmitted = new Set<string>();\n\n    for await (const event of stream) {\n      // Debug logging\n      if (process.env.DEBUG_OPENAI) {\n        console.error('[DEBUG] Responses API event:', event.type);\n      }\n\n      switch (event.type) {\n        case 'response.created': {\n          responseId = event.response.id;\n          yield {\n            type: StreamEventType.RESPONSE_CREATED,\n            response_id: responseId,\n            model: event.response.model,\n            created_at: event.response.created_at,\n          };\n          break;\n        }\n\n        case 'response.output_item.added': {\n          const addedEvent = event as ResponsesAPI.ResponseOutputItemAddedEvent;\n          const item = addedEvent.item;\n          activeItems.set(addedEvent.output_index.toString(), {\n            type: item.type,\n          });\n\n          // If it's a reasoning item, track it\n          if (item.type === 'reasoning') {\n            activeItems.set(addedEvent.output_index.toString(), {\n              type: 'reasoning',\n            });\n            reasoningBuffers.set(addedEvent.output_index.toString(), []);\n          }\n\n          // If it's a function call, track it\n          if (item.type === 'function_call') {\n            const functionCall = item as ResponsesAPI.ResponseFunctionToolCall;\n            const toolCallId = functionCall.call_id;\n            const toolName = functionCall.name;\n\n            activeItems.set(addedEvent.output_index.toString(), {\n              type: 'function_call',\n              toolCallId,\n              toolName,\n            });\n\n            toolCallBuffers.set(toolCallId, {\n              id: toolCallId,\n              name: toolName,\n              args: '',\n            });\n\n            yield {\n              type: StreamEventType.TOOL_CALL_START,\n              response_id: responseId,\n              item_id: `item_${addedEvent.output_index}`,\n              tool_call_id: toolCallId,\n              tool_name: toolName,\n            };\n          }\n          break;\n        }\n\n        case 'response.output_text.delta': {\n          const textEvent = event as ResponsesAPI.ResponseTextDeltaEvent;\n          yield {\n            type: StreamEventType.OUTPUT_TEXT_DELTA,\n            response_id: responseId,\n            item_id: textEvent.item_id,\n            output_index: textEvent.output_index,\n            content_index: textEvent.content_index,\n            delta: textEvent.delta || '',\n            sequence_number: sequenceNumber++,\n          };\n          break;\n        }\n\n        case 'response.function_call_arguments.delta': {\n          const argsEvent = event as ResponsesAPI.ResponseFunctionCallArgumentsDeltaEvent;\n          const itemInfo = activeItems.get(argsEvent.output_index.toString());\n\n          if (itemInfo?.toolCallId) {\n            const buffer = toolCallBuffers.get(itemInfo.toolCallId);\n            if (buffer) {\n              buffer.args += argsEvent.delta || '';\n\n              yield {\n                type: StreamEventType.TOOL_CALL_ARGUMENTS_DELTA,\n                response_id: responseId,\n                item_id: argsEvent.item_id,\n                tool_call_id: buffer.id,\n                tool_name: buffer.name,\n                delta: argsEvent.delta || '',\n                sequence_number: sequenceNumber++,\n              };\n            }\n          }\n          break;\n        }\n\n        case 'response.reasoning_summary_text.delta':\n        case 'response.reasoning_text.delta': {\n          // Reasoning delta from OpenAI (both full reasoning text and summary)\n          const reasoningEvent = event as {\n            type: string;\n            output_index?: number;\n            item_id?: string;\n            delta?: string;\n          };\n          const outputIdx = reasoningEvent.output_index?.toString();\n          const buffer = outputIdx ? reasoningBuffers.get(outputIdx) : undefined;\n          if (buffer) {\n            buffer.push(reasoningEvent.delta || '');\n          }\n\n          yield {\n            type: StreamEventType.REASONING_DELTA,\n            response_id: responseId,\n            item_id: reasoningEvent.item_id || `reasoning_${responseId}`,\n            delta: reasoningEvent.delta || '',\n            sequence_number: sequenceNumber++,\n          } as ReasoningDeltaEvent;\n          break;\n        }\n\n        case 'response.reasoning_text.done': {\n          // Full reasoning text completed  emit reasoning done\n          const doneEvent = event as ResponsesAPI.ResponseReasoningTextDoneEvent;\n          const outputIdx = doneEvent.output_index.toString();\n          const rBuf = reasoningBuffers.get(outputIdx);\n          const thinkingText = rBuf ? rBuf.join('') : doneEvent.text || '';\n          reasoningDoneEmitted.add(outputIdx);\n\n          yield {\n            type: StreamEventType.REASONING_DONE,\n            response_id: responseId,\n            item_id: doneEvent.item_id || `reasoning_${responseId}`,\n            thinking: thinkingText,\n          } as ReasoningDoneEvent;\n          break;\n        }\n\n        case 'response.output_item.done': {\n          const doneEvent = event as ResponsesAPI.ResponseOutputItemDoneEvent;\n          const item = doneEvent.item;\n\n          // If reasoning item is done, emit reasoning done (only if not already emitted by reasoning_text.done)\n          if (item.type === 'reasoning') {\n            const outputIdx = doneEvent.output_index.toString();\n            if (!reasoningDoneEmitted.has(outputIdx)) {\n              const rBuf = reasoningBuffers.get(outputIdx);\n              const thinkingText = rBuf ? rBuf.join('') : '';\n\n              yield {\n                type: StreamEventType.REASONING_DONE,\n                response_id: responseId,\n                item_id: (item as any).id || `reasoning_${responseId}`,\n                thinking: thinkingText,\n              } as ReasoningDoneEvent;\n            }\n          }\n\n          // If function call is done, emit arguments complete\n          if (item.type === 'function_call') {\n            const functionCall = item as ResponsesAPI.ResponseFunctionToolCall;\n            const buffer = toolCallBuffers.get(functionCall.call_id);\n\n            if (buffer) {\n              yield {\n                type: StreamEventType.TOOL_CALL_ARGUMENTS_DONE,\n                response_id: responseId,\n                tool_call_id: buffer.id,\n                tool_name: buffer.name,\n                arguments: buffer.args || functionCall.arguments,\n              };\n            }\n          }\n          break;\n        }\n\n        case 'response.completed': {\n          const completedEvent = event as ResponsesAPI.ResponseCompletedEvent;\n          const response = completedEvent.response;\n\n          // Map ResponseStatus to our status type\n          let status: 'completed' | 'failed' | 'incomplete' = 'completed';\n          if (response.status === 'failed') {\n            status = 'failed';\n          } else if (response.status === 'incomplete') {\n            status = 'incomplete';\n          }\n\n          yield {\n            type: StreamEventType.RESPONSE_COMPLETE,\n            response_id: responseId,\n            status,\n            usage: {\n              input_tokens: response.usage?.input_tokens || 0,\n              output_tokens: response.usage?.output_tokens || 0,\n              total_tokens: response.usage?.total_tokens || 0,\n              ...((response.usage as any)?.output_tokens_details?.reasoning_tokens != null && {\n                output_tokens_details: {\n                  reasoning_tokens: (response.usage as any).output_tokens_details.reasoning_tokens,\n                },\n              }),\n            },\n            iterations: 1,\n          };\n          break;\n        }\n\n        // Handle other event types if needed\n        default:\n          if (process.env.DEBUG_OPENAI) {\n            console.error('[DEBUG] Unhandled Responses API event type:', (event as any).type);\n          }\n      }\n    }\n  }\n}\n","/**\n * Registry-driven model capability resolver\n * Maps ILLMDescription from the centralized model registry to ModelCapabilities\n * used by all providers, with vendor-specific fallbacks for unregistered models.\n */\n\nimport { getModelInfo, type ILLMDescription } from '../../../domain/entities/Model.js';\nimport type { ModelCapabilities } from '../../../domain/interfaces/ITextProvider.js';\n\n/**\n * Maps a registry model description to provider ModelCapabilities\n */\nfunction mapRegistryToCapabilities(info: ILLMDescription): ModelCapabilities {\n  return {\n    supportsTools: info.features.functionCalling ?? false,\n    supportsVision: info.features.vision ?? false,\n    supportsJSON: info.features.structuredOutput ?? false,\n    supportsJSONSchema: info.features.structuredOutput ?? false,\n    maxTokens: info.features.input.tokens,\n    maxInputTokens: info.features.input.tokens,\n    maxOutputTokens: info.features.output.tokens,\n  };\n}\n\n/**\n * Resolve model capabilities from the centralized registry, falling back to vendor defaults.\n *\n * @param model - The model identifier (e.g., 'gpt-5.2', 'claude-sonnet-4-5-20250929')\n * @param vendorDefaults - Vendor-specific defaults for models not in the registry\n * @returns ModelCapabilities from registry or vendor defaults\n */\nexport function resolveModelCapabilities(\n  model: string,\n  vendorDefaults: ModelCapabilities\n): ModelCapabilities {\n  const info = getModelInfo(model);\n  if (info) {\n    return mapRegistryToCapabilities(info);\n  }\n  return vendorDefaults;\n}\n\n/**\n * Resolve the max context token limit for a specific model.\n * Used primarily for accurate error messages.\n *\n * @param model - The model identifier\n * @param fallback - Fallback value if model is not in registry\n * @returns The max input token count\n */\nexport function resolveMaxContextTokens(\n  model: string | undefined,\n  fallback: number\n): number {\n  if (!model) return fallback;\n  const info = getModelInfo(model);\n  return info ? info.features.input.tokens : fallback;\n}\n","/**\n * Shared validation for thinking/reasoning configuration across all providers.\n */\nexport function validateThinkingConfig(\n  thinking: { enabled: boolean; budgetTokens?: number; effort?: string }\n): void {\n  if (!thinking.enabled) return;\n\n  if (thinking.budgetTokens !== undefined) {\n    if (typeof thinking.budgetTokens !== 'number' || thinking.budgetTokens < 1) {\n      throw new Error(\n        `Invalid thinking budgetTokens: ${thinking.budgetTokens}. Must be a positive number.`\n      );\n    }\n  }\n\n  if (thinking.effort !== undefined) {\n    const validEfforts = ['low', 'medium', 'high'];\n    if (!validEfforts.includes(thinking.effort)) {\n      throw new Error(\n        `Invalid thinking effort: '${thinking.effort}'. Must be one of: ${validEfforts.join(', ')}`\n      );\n    }\n  }\n}\n","/**\n * OpenAI text provider using Responses API\n */\n\nimport OpenAI from 'openai';\nimport { BaseTextProvider } from '../base/BaseTextProvider.js';\nimport { TextGenerateOptions, ModelCapabilities } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport { OpenAIConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderContextLengthError,\n} from '../../../domain/errors/AIErrors.js';\nimport { StreamEvent } from '../../../domain/entities/StreamEvent.js';\nimport { OpenAIResponsesConverter } from './OpenAIResponsesConverter.js';\nimport { OpenAIResponsesStreamConverter } from './OpenAIResponsesStreamConverter.js';\nimport * as ResponsesAPI from 'openai/resources/responses/responses.js';\nimport { getModelInfo } from '../../../domain/entities/Model.js';\nimport { resolveModelCapabilities, resolveMaxContextTokens } from '../base/ModelCapabilityResolver.js';\nimport { validateThinkingConfig } from '../shared/validateThinkingConfig.js';\n\nexport class OpenAITextProvider extends BaseTextProvider {\n  readonly name: string = 'openai';\n  readonly capabilities: ProviderCapabilities = {\n    text: true,\n    images: true,\n    videos: false,\n    audio: true,\n  };\n\n  private client: OpenAI;\n  private converter: OpenAIResponsesConverter;\n  private streamConverter: OpenAIResponsesStreamConverter;\n\n  constructor(config: OpenAIConfig) {\n    super(config);\n\n    this.client = new OpenAI({\n      apiKey: this.getApiKey(),\n      baseURL: this.getBaseURL(),\n      organization: config.organization,\n      timeout: this.getTimeout(),\n      maxRetries: this.getMaxRetries(),\n    });\n\n    this.converter = new OpenAIResponsesConverter();\n    this.streamConverter = new OpenAIResponsesStreamConverter();\n  }\n\n  /**\n   * Check if a parameter is supported by the model\n   */\n  private supportsParameter(model: string, parameter: 'temperature' | 'topP' | 'frequencyPenalty' | 'presencePenalty'): boolean {\n    const modelInfo = getModelInfo(model);\n    if (!modelInfo?.features.parameters) {\n      // If no parameter info, assume supported (backward compatibility)\n      return true;\n    }\n    return modelInfo.features.parameters[parameter] !== false;\n  }\n\n  /**\n   * Generate response using OpenAI Responses API\n   */\n  async generate(options: TextGenerateOptions): Promise<LLMResponse> {\n    // Execute with circuit breaker protection and observability\n    return this.executeWithCircuitBreaker(async () => {\n      try {\n        // Convert to Responses API format\n        const { input, instructions } = this.converter.convertInput(\n          options.input,\n          options.instructions\n        );\n\n        // Build request parameters\n        const params: any = {\n          model: options.model,\n          input,\n          ...(instructions && { instructions }),\n          ...(options.tools && options.tools.length > 0 && {\n            tools: this.converter.convertTools(options.tools),\n          }),\n          ...(options.tool_choice && {\n            tool_choice: this.converter.convertToolChoice(options.tool_choice),\n          }),\n          ...(options.temperature !== undefined &&\n              this.supportsParameter(options.model, 'temperature') &&\n              { temperature: options.temperature }),\n          ...(options.max_output_tokens && { max_output_tokens: options.max_output_tokens }),\n          ...(options.response_format && {\n            text: this.converter.convertResponseFormat(options.response_format),\n          }),\n          ...(options.parallel_tool_calls !== undefined && {\n            parallel_tool_calls: options.parallel_tool_calls,\n          }),\n          ...(options.previous_response_id && {\n            previous_response_id: options.previous_response_id,\n          }),\n          ...(options.metadata && { metadata: options.metadata }),\n        };\n\n        // Add reasoning config from unified thinking option\n        this.applyReasoningConfig(params, options);\n\n        // Call Responses API\n        const response = await this.client.responses.create(params);\n\n        // Convert response to our format\n        return this.converter.convertResponse(response);\n      } catch (error: any) {\n        this.handleError(error, options.model);\n        throw error; // TypeScript needs this\n      }\n    }, options.model);\n  }\n\n  /**\n   * Stream response using OpenAI Responses API\n   */\n  async *streamGenerate(options: TextGenerateOptions): AsyncIterableIterator<StreamEvent> {\n    try {\n      // Convert to Responses API format\n      const { input, instructions } = this.converter.convertInput(\n        options.input,\n        options.instructions\n      );\n\n      // Build request parameters\n      const params: any = {\n        model: options.model,\n        input,\n        ...(instructions && { instructions }),\n        ...(options.tools && options.tools.length > 0 && {\n          tools: this.converter.convertTools(options.tools),\n        }),\n        ...(options.tool_choice && {\n          tool_choice: this.converter.convertToolChoice(options.tool_choice),\n        }),\n        ...(options.temperature !== undefined &&\n            this.supportsParameter(options.model, 'temperature') &&\n            { temperature: options.temperature }),\n        ...(options.max_output_tokens && { max_output_tokens: options.max_output_tokens }),\n        ...(options.response_format && {\n          text: this.converter.convertResponseFormat(options.response_format),\n        }),\n        ...(options.parallel_tool_calls !== undefined && {\n          parallel_tool_calls: options.parallel_tool_calls,\n        }),\n        ...(options.previous_response_id && {\n          previous_response_id: options.previous_response_id,\n        }),\n        ...(options.metadata && { metadata: options.metadata }),\n        stream: true,\n      };\n\n      // Add reasoning config from unified thinking option\n      this.applyReasoningConfig(params, options);\n\n      // Call Responses API with streaming\n      const stream = await this.client.responses.create(params) as any;\n\n      // Convert stream events using the stream converter\n      yield* this.streamConverter.convertStream(stream as AsyncIterable<ResponsesAPI.ResponseStreamEvent>);\n    } catch (error: any) {\n      this.handleError(error, options.model);\n      throw error;\n    }\n  }\n\n  /**\n   * Get model capabilities (registry-driven with OpenAI vendor defaults)\n   */\n  getModelCapabilities(model: string): ModelCapabilities {\n    return resolveModelCapabilities(model, {\n      supportsTools: true,\n      supportsVision: true,\n      supportsJSON: true,\n      supportsJSONSchema: true,\n      maxTokens: 128000,\n      maxInputTokens: 128000,\n      maxOutputTokens: 16384,\n    });\n  }\n\n\n  /**\n   * List available models from the OpenAI API\n   */\n  async listModels(): Promise<string[]> {\n    const models: string[] = [];\n    for await (const model of this.client.models.list()) {\n      models.push(model.id);\n    }\n    return models.sort();\n  }\n\n  /**\n   * Apply reasoning config from unified thinking option to request params\n   */\n  private applyReasoningConfig(params: any, options: TextGenerateOptions): void {\n    if (options.thinking?.enabled) {\n      validateThinkingConfig(options.thinking);\n      params.reasoning = {\n        effort: options.thinking.effort || 'medium',\n      };\n    }\n  }\n\n  /**\n   * Handle OpenAI-specific errors\n   */\n  private handleError(error: any, model?: string): never {\n    if (error.status === 401) {\n      throw new ProviderAuthError('openai', 'Invalid API key');\n    }\n\n    if (error.status === 429) {\n      const retryAfter = error.headers?.['retry-after'];\n      throw new ProviderRateLimitError(\n        'openai',\n        retryAfter ? parseInt(retryAfter) * 1000 : undefined\n      );\n    }\n\n    if (error.code === 'context_length_exceeded' || error.status === 413) {\n      throw new ProviderContextLengthError('openai', resolveMaxContextTokens(model, 128000));\n    }\n\n    // Re-throw other errors\n    throw error;\n  }\n}\n","/**\n * Shared Response Builder Utilities\n *\n * DRY principle: Response building logic shared across all providers.\n * Each provider has different raw response formats, but the final\n * LLMResponse structure is the same.\n */\n\nimport { randomUUID } from 'crypto';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { OutputItem, MessageRole } from '../../../domain/entities/Message.js';\nimport { Content, ContentType } from '../../../domain/entities/Content.js';\n\n/**\n * Response status type (matches LLMResponse.status)\n */\nexport type ResponseStatus = 'completed' | 'failed' | 'in_progress' | 'cancelled' | 'queued' | 'incomplete';\n\n/**\n * Usage statistics for a response\n */\nexport interface UsageStats {\n  inputTokens: number;\n  outputTokens: number;\n  totalTokens?: number;\n}\n\n/**\n * Options for building an LLMResponse\n */\nexport interface ResponseBuilderOptions {\n  /** Provider name for ID prefix (e.g., 'anthropic', 'google') */\n  provider: string;\n  /** Raw response ID from the provider (optional) */\n  rawId?: string;\n  /** Model name/version */\n  model: string;\n  /** Response status */\n  status: ResponseStatus;\n  /** Content array for the assistant message */\n  content: Content[];\n  /** Usage statistics */\n  usage: UsageStats;\n  /** Optional message ID (separate from response ID) */\n  messageId?: string;\n  /** Timestamp (defaults to now) */\n  createdAt?: number;\n}\n\n/**\n * Build a standardized LLMResponse object\n *\n * All providers should use this to ensure consistent response format.\n *\n * @param options - Response building options\n * @returns Standardized LLMResponse\n */\nexport function buildLLMResponse(options: ResponseBuilderOptions): LLMResponse {\n  const {\n    provider,\n    rawId,\n    model,\n    status,\n    content,\n    usage,\n    messageId,\n    createdAt = Math.floor(Date.now() / 1000),\n  } = options;\n\n  // Generate IDs\n  const responseId = rawId ? `resp_${provider}_${rawId}` : `resp_${provider}_${randomUUID()}`;\n  const msgId = messageId || `msg_${provider}_${randomUUID()}`;\n\n  // Build output array with assistant message\n  const output: OutputItem[] = [\n    {\n      type: 'message',\n      id: msgId,\n      role: MessageRole.ASSISTANT,\n      content,\n    },\n  ];\n\n  // Extract text and thinking from content\n  const outputText = extractTextFromContent(content);\n  const thinking = extractThinkingFromContent(content);\n\n  return {\n    id: responseId,\n    object: 'response',\n    created_at: createdAt,\n    status,\n    model,\n    output,\n    output_text: outputText,\n    ...(thinking && { thinking }),\n    usage: {\n      input_tokens: usage.inputTokens,\n      output_tokens: usage.outputTokens,\n      total_tokens: usage.totalTokens ?? (usage.inputTokens + usage.outputTokens),\n    },\n  };\n}\n\n/**\n * Extract text content from a Content array\n *\n * @param content - Content array to extract text from\n * @returns Concatenated text content\n */\nexport function extractTextFromContent(content: Content[]): string {\n  return content\n    .filter((c): c is Content & { type: typeof ContentType.OUTPUT_TEXT } =>\n      c.type === ContentType.OUTPUT_TEXT\n    )\n    .map((c) => c.text)\n    .join('\\n');\n}\n\n/**\n * Extract thinking/reasoning content from a Content array\n *\n * @param content - Content array to extract thinking from\n * @returns Concatenated thinking text, or undefined if none\n */\nexport function extractThinkingFromContent(content: Content[]): string | undefined {\n  const thinkingTexts = content\n    .filter((c) => c.type === ContentType.THINKING)\n    .map((c) => (c as any).thinking as string)\n    .filter(Boolean);\n  return thinkingTexts.length > 0 ? thinkingTexts.join('\\n') : undefined;\n}\n\n/**\n * Create a text content item\n *\n * @param text - The text content\n * @returns Content object\n */\nexport function createTextContent(text: string): Content {\n  return {\n    type: ContentType.OUTPUT_TEXT,\n    text,\n    annotations: [],\n  };\n}\n\n/**\n * Create a tool_use content item\n *\n * @param id - Tool call ID\n * @param name - Tool/function name\n * @param args - Arguments as JSON string or object\n * @returns Content object\n */\nexport function createToolUseContent(\n  id: string,\n  name: string,\n  args: string | Record<string, unknown>\n): Content {\n  return {\n    type: ContentType.TOOL_USE,\n    id,\n    name,\n    arguments: typeof args === 'string' ? args : JSON.stringify(args),\n  };\n}\n\n/**\n * Mapping functions for provider-specific status to our ResponseStatus\n */\n\n/**\n * Map OpenAI status to ResponseStatus\n */\nexport function mapOpenAIStatus(status?: string): ResponseStatus {\n  switch (status) {\n    case 'completed':\n      return 'completed';\n    case 'incomplete':\n      return 'incomplete';\n    case 'cancelled':\n    case 'failed':\n      return 'failed';\n    default:\n      return 'completed';\n  }\n}\n\n/**\n * Map Anthropic stop_reason to ResponseStatus\n */\nexport function mapAnthropicStatus(stopReason: string | null): ResponseStatus {\n  switch (stopReason) {\n    case 'end_turn':\n    case 'tool_use':\n    case 'stop_sequence':\n      return 'completed';\n    case 'max_tokens':\n      return 'incomplete';\n    default:\n      return 'incomplete';\n  }\n}\n\n/**\n * Map Google finish_reason to ResponseStatus\n */\nexport function mapGoogleStatus(finishReason?: string): ResponseStatus {\n  switch (finishReason) {\n    case 'STOP':\n      return 'completed';\n    case 'MAX_TOKENS':\n      return 'incomplete';\n    case 'SAFETY':\n    case 'RECITATION':\n      return 'failed';\n    case 'OTHER':\n    default:\n      return 'incomplete';\n  }\n}\n\n/**\n * Generate a tool call ID with optional provider prefix\n *\n * @param provider - Provider name for prefix\n * @returns Generated tool call ID\n */\nexport function generateToolCallId(provider?: string): string {\n  const uuid = randomUUID();\n  return provider ? `${provider}_${uuid}` : uuid;\n}\n","/**\n * Shared Tool Conversion Utilities\n *\n * DRY principle: Tool conversion logic shared across all providers\n * Each provider has slightly different tool formats, but the extraction\n * and basic conversion is the same.\n */\n\nimport { FunctionToolDefinition, Tool } from '../../../domain/entities/Tool.js';\n\n/**\n * Standardized tool format before provider-specific transformation\n */\nexport interface ProviderToolFormat {\n  name: string;\n  description: string;\n  parameters: Record<string, any>;\n}\n\n/**\n * Extract function tools from mixed tool array\n * Filters out built-in tools (web_search, code_interpreter, etc.)\n *\n * @param tools - Mixed array of tool definitions\n * @returns Only function tools\n */\nexport function extractFunctionTools(\n  tools: Tool[]\n): FunctionToolDefinition[] {\n  return tools.filter((t): t is FunctionToolDefinition => t.type === 'function');\n}\n\n/**\n * Convert tools to standard format (before provider transformation)\n * Extracts common properties: name, description, parameters\n *\n * @param tools - Array of tool definitions\n * @returns Standardized tool format\n */\nexport function convertToolsToStandardFormat(\n  tools: Tool[]\n): ProviderToolFormat[] {\n  return extractFunctionTools(tools).map((tool) => ({\n    name: tool.function.name,\n    description: tool.function.description || '',\n    parameters: tool.function.parameters || { type: 'object', properties: {} },\n  }));\n}\n\n/**\n * Transform for Anthropic API (uses input_schema)\n *\n * @param tool - Standardized tool format\n * @returns Anthropic-specific tool format\n */\nexport function transformForAnthropic(tool: ProviderToolFormat) {\n  return {\n    name: tool.name,\n    description: tool.description,\n    input_schema: tool.parameters,\n  };\n}\n\n/**\n * Transform for Google Gemini API (uses parameters)\n *\n * @param tool - Standardized tool format\n * @returns Google-specific tool format\n */\nexport function transformForGoogle(tool: ProviderToolFormat) {\n  return {\n    name: tool.name,\n    description: tool.description,\n    parameters: tool.parameters,\n  };\n}\n\n/**\n * Transform for OpenAI API (uses function definition)\n *\n * @param tool - Standardized tool format\n * @returns OpenAI-specific tool format\n */\nexport function transformForOpenAI(tool: ProviderToolFormat) {\n  return {\n    type: 'function' as const,\n    function: {\n      name: tool.name,\n      description: tool.description,\n      parameters: tool.parameters,\n    },\n  };\n}\n","/**\n * Base Converter - Abstract base class for provider-specific message conversion\n *\n * DRY principle: Provides common patterns for all provider converters:\n * - Input normalization (string | InputItem[]  provider format)\n * - Content type conversion (ContentType  provider content blocks)\n * - Tool schema conversion (Tool[]  provider tool format)\n * - Response extraction (provider response  LLMResponse)\n * - Error mapping (provider error  standard error)\n * - Resource cleanup lifecycle\n *\n * Provider-specific converters extend this and implement abstract methods.\n */\n\nimport { TextGenerateOptions } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { InputItem, MessageRole } from '../../../domain/entities/Message.js';\nimport { Content, ContentType } from '../../../domain/entities/Content.js';\nimport { Tool } from '../../../domain/entities/Tool.js';\nimport { InvalidToolArgumentsError } from '../../../domain/errors/AIErrors.js';\nimport {\n  buildLLMResponse,\n  createTextContent,\n  createToolUseContent,\n  ResponseStatus,\n  UsageStats,\n} from '../shared/ResponseBuilder.js';\nimport { convertToolsToStandardFormat, ProviderToolFormat } from '../shared/ToolConversionUtils.js';\n\n/**\n * Image data parsed from a data URI\n */\nexport interface ParsedImageData {\n  mediaType: string;\n  data: string;\n  format: string;\n}\n\n/**\n * Provider-specific request format (abstract, defined by subclass)\n * Using Record<string, unknown> would be too restrictive -\n * providers have their own typed request formats\n */\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface ProviderRequest {}\n\n/**\n * Provider-specific response format (abstract, defined by subclass)\n */\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface ProviderResponse {}\n\n/**\n * Abstract base converter for all LLM providers.\n *\n * Subclasses implement provider-specific conversion logic while inheriting\n * common patterns for input normalization, tool conversion, and response building.\n *\n * @template TRequest - Provider-specific request type\n * @template TResponse - Provider-specific response type\n */\nexport abstract class BaseConverter<\n  TRequest extends ProviderRequest = ProviderRequest,\n  TResponse extends ProviderResponse = ProviderResponse,\n> {\n  // ==========================================================================\n  // Abstract Methods (must be implemented by subclasses)\n  // ==========================================================================\n\n  /**\n   * Get the provider name (used for error messages and IDs)\n   */\n  abstract readonly providerName: string;\n\n  /**\n   * Convert our TextGenerateOptions to provider-specific request format\n   */\n  abstract convertRequest(options: TextGenerateOptions): TRequest | Promise<TRequest>;\n\n  /**\n   * Convert provider response to our LLMResponse format\n   */\n  abstract convertResponse(response: TResponse): LLMResponse;\n\n  /**\n   * Transform a standardized tool to provider-specific format\n   */\n  protected abstract transformTool(tool: ProviderToolFormat): unknown;\n\n  /**\n   * Convert provider-specific content blocks to our Content[]\n   */\n  protected abstract convertProviderContent(blocks: unknown[]): Content[];\n\n  /**\n   * Map provider status to our ResponseStatus\n   */\n  protected abstract mapProviderStatus(status: unknown): ResponseStatus;\n\n  // ==========================================================================\n  // Protected Helper Methods (shared by all providers)\n  // ==========================================================================\n\n  /**\n   * Convert InputItem array to provider messages\n   * @param input - String or InputItem array\n   * @returns Normalized input ready for provider conversion\n   */\n  protected normalizeInput(input: string | InputItem[]): InputItem[] {\n    if (typeof input === 'string') {\n      return [\n        {\n          type: 'message',\n          role: MessageRole.USER,\n          content: [{ type: ContentType.INPUT_TEXT, text: input }],\n        },\n      ];\n    }\n    return input;\n  }\n\n  /**\n   * Map our role to provider-specific role\n   * Override in subclass if provider uses different role names\n   */\n  protected mapRole(role: MessageRole): string {\n    // Most providers don't have 'developer' role - map to 'user'\n    if (role === MessageRole.DEVELOPER) {\n      return 'user';\n    }\n    return role;\n  }\n\n  /**\n   * Convert our Tool[] to provider-specific tool format\n   */\n  protected convertTools(tools?: Tool[]): unknown[] | undefined {\n    if (!tools || tools.length === 0) {\n      return undefined;\n    }\n\n    const standardTools = convertToolsToStandardFormat(tools);\n    return standardTools.map((tool) => this.transformTool(tool));\n  }\n\n  /**\n   * Parse tool arguments from JSON string\n   * Throws InvalidToolArgumentsError on parse failure\n   */\n  protected parseToolArguments(name: string, argsString: string): unknown {\n    try {\n      return JSON.parse(argsString);\n    } catch (parseError) {\n      throw new InvalidToolArgumentsError(\n        name,\n        argsString,\n        parseError instanceof Error ? parseError : new Error(String(parseError))\n      );\n    }\n  }\n\n  /**\n   * Parse a data URI into components\n   * @returns Parsed image data or null if not a data URI\n   */\n  protected parseDataUri(url: string): ParsedImageData | null {\n    const matches = url.match(/^data:image\\/(\\w+);base64,(.+)$/);\n    if (!matches || matches.length < 3) {\n      return null;\n    }\n\n    const format = matches[1]!;\n    const data = matches[2]!;\n\n    return {\n      format,\n      mediaType: `image/${format}`,\n      data,\n    };\n  }\n\n  /**\n   * Check if URL is a data URI\n   */\n  protected isDataUri(url: string): boolean {\n    return url.startsWith('data:');\n  }\n\n  /**\n   * Build standardized LLMResponse using shared utility\n   */\n  protected buildResponse(options: {\n    rawId?: string;\n    model: string;\n    status: ResponseStatus;\n    content: Content[];\n    usage: UsageStats;\n    messageId?: string;\n  }): LLMResponse {\n    return buildLLMResponse({\n      provider: this.providerName,\n      ...options,\n    });\n  }\n\n  /**\n   * Create a text content block\n   */\n  protected createText(text: string): Content {\n    return createTextContent(text);\n  }\n\n  /**\n   * Create a tool_use content block\n   */\n  protected createToolUse(id: string, name: string, args: string | Record<string, unknown>): Content {\n    return createToolUseContent(id, name, args);\n  }\n\n  /**\n   * Extract text from Content array\n   */\n  protected extractText(content: Content[]): string {\n    return content\n      .filter((c) => c.type === ContentType.OUTPUT_TEXT)\n      .map((c) => (c as { text: string }).text)\n      .join('\\n');\n  }\n\n  /**\n   * Handle content conversion for common content types\n   * Can be used as a starting point in subclass convertContent methods\n   */\n  protected handleCommonContent(\n    content: Content,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    _handlers: {\n      onText?: (text: string) => void;\n      onImage?: (url: string, parsed: ParsedImageData | null) => void;\n      onToolUse?: (id: string, name: string, args: unknown) => void;\n      onToolResult?: (\n        toolUseId: string,\n        result: string | unknown,\n        isError: boolean,\n        errorMessage?: string\n      ) => void;\n    }\n  ): boolean {\n    const handlers = _handlers;\n\n    switch (content.type) {\n      case ContentType.INPUT_TEXT:\n      case ContentType.OUTPUT_TEXT:\n        handlers.onText?.((content as { text: string }).text);\n        return true;\n\n      case ContentType.INPUT_IMAGE_URL: {\n        const imgContent = content as { image_url: { url: string } };\n        const parsed = this.parseDataUri(imgContent.image_url.url);\n        handlers.onImage?.(imgContent.image_url.url, parsed);\n        return true;\n      }\n\n      case ContentType.TOOL_USE: {\n        const toolContent = content as { id: string; name: string; arguments: string };\n        const parsedArgs = this.parseToolArguments(toolContent.name, toolContent.arguments);\n        handlers.onToolUse?.(toolContent.id, toolContent.name, parsedArgs);\n        return true;\n      }\n\n      case ContentType.TOOL_RESULT: {\n        const resultContent = content as {\n          tool_use_id: string;\n          content: string | unknown;\n          error?: string;\n        };\n        const isError = !!resultContent.error;\n        handlers.onToolResult?.(\n          resultContent.tool_use_id,\n          resultContent.content,\n          isError,\n          resultContent.error\n        );\n        return true;\n      }\n\n      default:\n        return false;\n    }\n  }\n\n  // ==========================================================================\n  // Resource Cleanup (required lifecycle method)\n  // ==========================================================================\n\n  /**\n   * Clean up any internal state/caches\n   * Should be called after each request/response cycle to prevent memory leaks\n   *\n   * Default implementation does nothing - override if subclass maintains state\n   */\n  clear(): void {\n    // Default: no state to clear\n    // Subclasses override if they maintain Maps, caches, etc.\n  }\n\n  /**\n   * Alias for clear() - reset converter state\n   */\n  reset(): void {\n    this.clear();\n  }\n}\n\n/**\n * Type guard for checking if converter has async request conversion\n */\nexport function hasAsyncConvert(\n  _converter: BaseConverter\n): _converter is BaseConverter & { convertRequest: (options: TextGenerateOptions) => Promise<ProviderRequest> } {\n  // All converters may be async (convertRequest can return Promise)\n  return true;\n}\n","/**\n * Anthropic Converter - Converts between our Responses API format and Anthropic Messages API\n *\n * Extends BaseConverter for common patterns:\n * - Input normalization\n * - Tool conversion\n * - Response building\n * - Resource cleanup\n */\n\nimport Anthropic from '@anthropic-ai/sdk';\nimport { BaseConverter } from '../base/BaseConverter.js';\nimport { TextGenerateOptions } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { InputItem } from '../../../domain/entities/Message.js';\nimport { Content, ContentType } from '../../../domain/entities/Content.js';\nimport { Tool } from '../../../domain/entities/Tool.js';\nimport { convertToolsToStandardFormat, transformForAnthropic, ProviderToolFormat } from '../shared/ToolConversionUtils.js';\nimport { mapAnthropicStatus, ResponseStatus } from '../shared/ResponseBuilder.js';\nimport { validateThinkingConfig } from '../shared/validateThinkingConfig.js';\n\nexport class AnthropicConverter extends BaseConverter<Anthropic.MessageCreateParams, Anthropic.Message> {\n  readonly providerName = 'anthropic';\n\n  /**\n   * Convert our format -> Anthropic Messages API format\n   */\n  convertRequest(options: TextGenerateOptions): Anthropic.MessageCreateParams {\n    const messages = this.convertMessages(options.input);\n    const tools = this.convertAnthropicTools(options.tools);\n\n    const params: Anthropic.MessageCreateParams = {\n      model: options.model,\n      max_tokens: options.max_output_tokens || 4096,\n      messages,\n    };\n\n    // Add system instruction if provided\n    if (options.instructions) {\n      params.system = options.instructions;\n    }\n\n    // Add tools if provided\n    if (tools && tools.length > 0) {\n      params.tools = tools;\n    }\n\n    // Add thinking/reasoning support\n    if (options.thinking?.enabled) {\n      validateThinkingConfig(options.thinking);\n      const budgetTokens = options.thinking.budgetTokens || 10000;\n      (params as any).thinking = {\n        type: 'enabled',\n        budget_tokens: budgetTokens,\n      };\n      // Anthropic requires temperature=1 when thinking is enabled\n      params.temperature = 1;\n    } else if (options.temperature !== undefined) {\n      // Only set temperature if thinking is not enabled\n      params.temperature = options.temperature;\n    }\n\n    return params;\n  }\n\n  /**\n   * Convert Anthropic response -> our LLMResponse format\n   */\n  convertResponse(response: Anthropic.Message): LLMResponse {\n    return this.buildResponse({\n      rawId: response.id,\n      model: response.model,\n      status: this.mapProviderStatus(response.stop_reason),\n      content: this.convertProviderContent(response.content),\n      messageId: response.id,\n      usage: {\n        inputTokens: response.usage.input_tokens,\n        outputTokens: response.usage.output_tokens,\n      },\n    });\n  }\n\n  // ==========================================================================\n  // BaseConverter Abstract Method Implementations\n  // ==========================================================================\n\n  /**\n   * Transform standardized tool to Anthropic format\n   */\n  protected transformTool(tool: ProviderToolFormat): Anthropic.Tool {\n    return {\n      ...transformForAnthropic(tool),\n      input_schema: {\n        type: 'object',\n        ...tool.parameters,\n      } as Anthropic.Tool.InputSchema,\n    };\n  }\n\n  /**\n   * Convert Anthropic content blocks to our Content[]\n   */\n  protected convertProviderContent(blocks: unknown[]): Content[] {\n    const content: Content[] = [];\n\n    for (const block of blocks as Anthropic.ContentBlock[]) {\n      if (block.type === 'text') {\n        content.push(this.createText(block.text));\n      } else if (block.type === 'tool_use') {\n        content.push(this.createToolUse(block.id, block.name, block.input as Record<string, unknown>));\n      } else if (block.type === 'thinking') {\n        // Anthropic thinking block - must persist in history for round-tripping\n        const thinkingBlock = block as { type: 'thinking'; thinking: string; signature: string };\n        content.push({\n          type: ContentType.THINKING,\n          thinking: thinkingBlock.thinking || '',\n          signature: thinkingBlock.signature,\n          persistInHistory: true,\n        });\n      }\n    }\n\n    return content;\n  }\n\n  /**\n   * Map Anthropic stop_reason to ResponseStatus\n   */\n  protected mapProviderStatus(status: unknown): ResponseStatus {\n    return mapAnthropicStatus(status as string | null);\n  }\n\n  // ==========================================================================\n  // Anthropic-Specific Conversion Methods\n  // ==========================================================================\n\n  /**\n   * Convert our InputItem[] -> Anthropic messages\n   */\n  private convertMessages(input: string | InputItem[]): Anthropic.MessageParam[] {\n    if (typeof input === 'string') {\n      return [{ role: 'user', content: input }];\n    }\n\n    const messages: Anthropic.MessageParam[] = [];\n\n    for (const item of input) {\n      if (item.type === 'message') {\n        // Map roles: 'developer' -> 'user' (Anthropic doesn't have developer role)\n        const role = this.mapRole(item.role);\n\n        // Convert content\n        const content = this.convertContent(item.content);\n\n        // Skip messages with empty content (Anthropic rejects these)\n        if (!content || (Array.isArray(content) && content.length === 0) || content === '') {\n          continue;\n        }\n\n        messages.push({\n          role: role as 'user' | 'assistant',\n          content,\n        });\n      }\n    }\n\n    return messages;\n  }\n\n  /**\n   * Convert our Content[] -> Anthropic content blocks\n   */\n  private convertContent(content: Content[]): Anthropic.MessageParam['content'] {\n    const blocks: Array<Anthropic.TextBlockParam | Anthropic.ImageBlockParam | Anthropic.ToolUseBlockParam | Anthropic.ToolResultBlockParam> = [];\n\n    for (const c of content) {\n      switch (c.type) {\n        case ContentType.INPUT_TEXT:\n        case ContentType.OUTPUT_TEXT: {\n          // Anthropic rejects empty text content blocks\n          const textContent = (c as { text: string }).text;\n          if (textContent && textContent.trim()) {\n            blocks.push({\n              type: 'text',\n              text: textContent,\n            });\n          }\n          break;\n        }\n\n        case ContentType.INPUT_IMAGE_URL: {\n          const imgContent = c as { image_url: { url: string } };\n          const block = this.convertImageToAnthropicBlock(imgContent.image_url.url);\n          if (block) {\n            blocks.push(block);\n          }\n          break;\n        }\n\n        case ContentType.TOOL_RESULT: {\n          const resultContent = c as {\n            tool_use_id: string;\n            content: string | unknown;\n            error?: string;\n            __images?: Array<{ base64: string; mediaType: string }>;\n          };\n          blocks.push(this.convertToolResultToAnthropicBlock(resultContent));\n          break;\n        }\n\n        case ContentType.TOOL_USE: {\n          const toolContent = c as { id: string; name: string; arguments: string };\n          const parsedInput = this.parseToolArguments(toolContent.name, toolContent.arguments);\n          blocks.push({\n            type: 'tool_use',\n            id: toolContent.id,\n            name: toolContent.name,\n            input: parsedInput as Record<string, unknown>,\n          });\n          break;\n        }\n\n        case ContentType.THINKING: {\n          // Round-trip thinking blocks back to Anthropic format.\n          // Only include blocks that have a valid signature  Anthropic requires it.\n          // Streaming-path thinking blocks lack signatures and cannot be round-tripped;\n          // non-streaming responses (via convertResponse) always carry signatures.\n          const thinkingContent = c as { thinking: string; signature?: string };\n          if (thinkingContent.signature) {\n            blocks.push({\n              type: 'thinking',\n              thinking: thinkingContent.thinking,\n              signature: thinkingContent.signature,\n            } as any);\n          }\n          break;\n        }\n      }\n    }\n\n    // If only one text block, return as string\n    if (blocks.length === 1 && blocks[0]?.type === 'text') {\n      return (blocks[0] as Anthropic.TextBlockParam).text;\n    }\n\n    return blocks;\n  }\n\n  /**\n   * Convert image URL to Anthropic image block\n   */\n  private convertImageToAnthropicBlock(url: string): Anthropic.ImageBlockParam | null {\n    const parsed = this.parseDataUri(url);\n\n    if (parsed) {\n      // Base64 data URI\n      return {\n        type: 'image',\n        source: {\n          type: 'base64',\n          media_type: parsed.mediaType as 'image/jpeg' | 'image/png' | 'image/gif' | 'image/webp',\n          data: parsed.data,\n        },\n      };\n    } else {\n      // URL (Claude 3.5+ supports this)\n      return {\n        type: 'image',\n        source: {\n          type: 'url',\n          url,\n        },\n      };\n    }\n  }\n\n  /**\n   * Convert tool result to Anthropic block\n   * Anthropic requires non-empty content when is_error is true\n   * Supports __images convention: tool results with __images get multimodal content\n   */\n  private convertToolResultToAnthropicBlock(resultContent: {\n    tool_use_id: string;\n    content: string | unknown;\n    error?: string;\n    __images?: Array<{ base64: string; mediaType: string }>;\n  }): Anthropic.ToolResultBlockParam {\n    const isError = !!resultContent.error;\n    let toolResultContent: string;\n\n    if (typeof resultContent.content === 'string') {\n      // For error cases with empty content, use the error message\n      toolResultContent = resultContent.content || (isError ? resultContent.error! : '');\n    } else {\n      toolResultContent = JSON.stringify(resultContent.content);\n    }\n\n    // Anthropic API rejects empty content when is_error is true\n    if (isError && !toolResultContent) {\n      toolResultContent = resultContent.error || 'Tool execution failed';\n    }\n\n    // Read images from Content object first (set by addToolResults),\n    // fall back to JSON extraction for backward compat\n    const images = resultContent.__images?.length\n      ? resultContent.__images\n      : this.extractImages(toolResultContent);\n\n    if (images) {\n      // Strip __images and base64 from text to save tokens (needed for JSON fallback path)\n      const textContent = resultContent.__images?.length\n        ? toolResultContent  // Already stripped at context layer\n        : this.stripImagesFromContent(toolResultContent);\n      const contentBlocks: Array<Anthropic.TextBlockParam | Anthropic.ImageBlockParam> = [];\n\n      if (textContent.trim()) {\n        contentBlocks.push({ type: 'text', text: textContent });\n      }\n\n      for (const img of images) {\n        contentBlocks.push({\n          type: 'image',\n          source: {\n            type: 'base64',\n            media_type: (img.mediaType || 'image/png') as 'image/png' | 'image/jpeg' | 'image/gif' | 'image/webp',\n            data: img.base64,\n          },\n        });\n      }\n\n      return {\n        type: 'tool_result',\n        tool_use_id: resultContent.tool_use_id,\n        content: contentBlocks.length > 0 ? contentBlocks : textContent,\n        is_error: isError,\n      };\n    }\n\n    return {\n      type: 'tool_result',\n      tool_use_id: resultContent.tool_use_id,\n      content: toolResultContent,\n      is_error: isError,\n    };\n  }\n\n  /**\n   * Extract __images from a JSON-stringified tool result content.\n   * Returns null if no images found.\n   */\n  private extractImages(content: string): Array<{ base64: string; mediaType: string }> | null {\n    try {\n      const parsed = JSON.parse(content);\n      if (parsed && Array.isArray(parsed.__images) && parsed.__images.length > 0) {\n        return parsed.__images;\n      }\n    } catch {\n      // Not JSON or no __images\n    }\n    return null;\n  }\n\n  /**\n   * Strip __images and base64 fields from JSON content to reduce token usage in text.\n   */\n  private stripImagesFromContent(content: string): string {\n    try {\n      const parsed = JSON.parse(content);\n      const { __images: _, base64: __, ...rest } = parsed;\n      return JSON.stringify(rest);\n    } catch {\n      return content;\n    }\n  }\n\n  /**\n   * Convert our Tool[] -> Anthropic tools\n   * Uses shared conversion utilities (DRY)\n   */\n  private convertAnthropicTools(tools?: Tool[]): Anthropic.Tool[] | undefined {\n    if (!tools || tools.length === 0) {\n      return undefined;\n    }\n\n    const standardTools = convertToolsToStandardFormat(tools);\n    return standardTools.map((tool) => this.transformTool(tool));\n  }\n}\n","/**\n * Base Stream Converter - Abstract base class for streaming event conversion\n *\n * DRY principle: Provides common patterns for all stream converters:\n * - State management (response ID, sequence numbers)\n * - Tool call buffering (incremental argument accumulation)\n * - Usage tracking (input/output tokens)\n * - Lifecycle management (clear/reset)\n *\n * Provider-specific stream converters extend this and implement abstract methods.\n */\n\nimport { StreamEvent, StreamEventType } from '../../../domain/entities/StreamEvent.js';\n\n/**\n * Buffer for accumulating tool call arguments during streaming\n */\nexport interface ToolCallBuffer {\n  id: string;\n  name: string;\n  args: string;\n}\n\n/**\n * Usage statistics tracked during streaming\n */\nexport interface StreamUsage {\n  inputTokens: number;\n  outputTokens: number;\n}\n\n/**\n * Abstract base class for streaming event converters.\n *\n * Manages common state and provides helper methods for emitting events.\n *\n * @template TEvent - Provider-specific stream event type\n */\nexport abstract class BaseStreamConverter<TEvent = unknown> {\n  // ==========================================================================\n  // Protected State (shared across all stream converters)\n  // ==========================================================================\n\n  /** Current response ID */\n  protected responseId: string = '';\n\n  /** Model name */\n  protected model: string = '';\n\n  /** Event sequence number for ordering */\n  protected sequenceNumber: number = 0;\n\n  /** Usage statistics */\n  protected usage: StreamUsage = { inputTokens: 0, outputTokens: 0 };\n\n  /** Buffers for accumulating tool call arguments */\n  protected toolCallBuffers: Map<string, ToolCallBuffer> = new Map();\n\n  /** Buffer for accumulating reasoning/thinking content */\n  protected reasoningBuffer: string = '';\n\n  // ==========================================================================\n  // Abstract Methods (must be implemented by subclasses)\n  // ==========================================================================\n\n  /**\n   * Get the provider name (used for ID generation)\n   */\n  abstract readonly providerName: string;\n\n  /**\n   * Convert a single provider event to our StreamEvent(s)\n   * May return empty array if event should be ignored\n   */\n  protected abstract convertEvent(event: TEvent): StreamEvent[];\n\n  // ==========================================================================\n  // Public API\n  // ==========================================================================\n\n  /**\n   * Convert provider stream to our StreamEvent format\n   *\n   * @param stream - Provider-specific async stream\n   * @param model - Model name (may not be available in all events)\n   */\n  async *convertStream(\n    stream: AsyncIterable<TEvent>,\n    model?: string\n  ): AsyncIterableIterator<StreamEvent> {\n    // Initialize/reset state for new stream\n    this.reset();\n    if (model) {\n      this.model = model;\n    }\n\n    try {\n      for await (const event of stream) {\n        const converted = this.convertEvent(event);\n        for (const evt of converted) {\n          yield evt;\n        }\n      }\n    } finally {\n      // Note: Don't clear state here - response may need final events\n      // Caller should call clear() when done processing\n    }\n  }\n\n  /**\n   * Clear all internal state\n   * Should be called after stream is fully processed\n   */\n  clear(): void {\n    this.responseId = '';\n    this.model = '';\n    this.sequenceNumber = 0;\n    this.usage = { inputTokens: 0, outputTokens: 0 };\n    this.toolCallBuffers.clear();\n    this.reasoningBuffer = '';\n  }\n\n  /**\n   * Reset converter state for a new stream\n   * Alias for clear()\n   */\n  reset(): void {\n    this.clear();\n  }\n\n  // ==========================================================================\n  // Protected Helper Methods\n  // ==========================================================================\n\n  /**\n   * Generate a response ID with provider prefix\n   */\n  protected generateResponseId(): string {\n    const uuid = crypto.randomUUID();\n    return `resp_${this.providerName}_${uuid}`;\n  }\n\n  /**\n   * Get next sequence number (auto-increments)\n   */\n  protected nextSequence(): number {\n    return this.sequenceNumber++;\n  }\n\n  /**\n   * Create RESPONSE_CREATED event\n   */\n  protected emitResponseCreated(responseId?: string): StreamEvent {\n    if (responseId) {\n      this.responseId = responseId;\n    } else if (!this.responseId) {\n      this.responseId = this.generateResponseId();\n    }\n\n    return {\n      type: StreamEventType.RESPONSE_CREATED,\n      response_id: this.responseId,\n      model: this.model,\n      created_at: Date.now(),\n    };\n  }\n\n  /**\n   * Create OUTPUT_TEXT_DELTA event\n   */\n  protected emitTextDelta(\n    delta: string,\n    options?: { itemId?: string; outputIndex?: number; contentIndex?: number }\n  ): StreamEvent {\n    return {\n      type: StreamEventType.OUTPUT_TEXT_DELTA,\n      response_id: this.responseId,\n      item_id: options?.itemId || `msg_${this.responseId}`,\n      output_index: options?.outputIndex ?? 0,\n      content_index: options?.contentIndex ?? 0,\n      delta,\n      sequence_number: this.nextSequence(),\n    };\n  }\n\n  /**\n   * Create REASONING_DELTA event and accumulate reasoning buffer\n   */\n  protected emitReasoningDelta(\n    delta: string,\n    itemId?: string\n  ): StreamEvent {\n    this.reasoningBuffer += delta;\n    return {\n      type: StreamEventType.REASONING_DELTA,\n      response_id: this.responseId,\n      item_id: itemId || `reasoning_${this.responseId}`,\n      delta,\n      sequence_number: this.nextSequence(),\n    };\n  }\n\n  /**\n   * Create REASONING_DONE event with accumulated reasoning\n   */\n  protected emitReasoningDone(itemId?: string): StreamEvent {\n    const id = itemId || `reasoning_${this.responseId}`;\n    const thinking = this.reasoningBuffer;\n    this.reasoningBuffer = '';\n    return {\n      type: StreamEventType.REASONING_DONE,\n      response_id: this.responseId,\n      item_id: id,\n      thinking,\n    };\n  }\n\n  /**\n   * Create TOOL_CALL_START event\n   */\n  protected emitToolCallStart(toolCallId: string, toolName: string, itemId?: string): StreamEvent {\n    // Initialize buffer for this tool call\n    this.toolCallBuffers.set(toolCallId, {\n      id: toolCallId,\n      name: toolName,\n      args: '',\n    });\n\n    return {\n      type: StreamEventType.TOOL_CALL_START,\n      response_id: this.responseId,\n      item_id: itemId || `msg_${this.responseId}`,\n      tool_call_id: toolCallId,\n      tool_name: toolName,\n    };\n  }\n\n  /**\n   * Create TOOL_CALL_ARGUMENTS_DELTA event and accumulate args\n   */\n  protected emitToolCallArgsDelta(\n    toolCallId: string,\n    delta: string,\n    toolName?: string\n  ): StreamEvent {\n    // Accumulate arguments\n    const buffer = this.toolCallBuffers.get(toolCallId);\n    if (buffer) {\n      buffer.args += delta;\n    }\n\n    return {\n      type: StreamEventType.TOOL_CALL_ARGUMENTS_DELTA,\n      response_id: this.responseId,\n      item_id: `msg_${this.responseId}`,\n      tool_call_id: toolCallId,\n      tool_name: toolName || buffer?.name || '',\n      delta,\n      sequence_number: this.nextSequence(),\n    };\n  }\n\n  /**\n   * Create TOOL_CALL_ARGUMENTS_DONE event with accumulated args\n   */\n  protected emitToolCallArgsDone(toolCallId: string, toolName?: string): StreamEvent {\n    const buffer = this.toolCallBuffers.get(toolCallId);\n    const args = buffer?.args || '{}';\n    const name = toolName || buffer?.name || '';\n\n    return {\n      type: StreamEventType.TOOL_CALL_ARGUMENTS_DONE,\n      response_id: this.responseId,\n      tool_call_id: toolCallId,\n      tool_name: name,\n      arguments: args,\n    };\n  }\n\n  /**\n   * Create RESPONSE_COMPLETE event\n   */\n  protected emitResponseComplete(status: 'completed' | 'failed' | 'incomplete' = 'completed'): StreamEvent {\n    return {\n      type: StreamEventType.RESPONSE_COMPLETE,\n      response_id: this.responseId,\n      status,\n      usage: {\n        input_tokens: this.usage.inputTokens,\n        output_tokens: this.usage.outputTokens,\n        total_tokens: this.usage.inputTokens + this.usage.outputTokens,\n      },\n      iterations: 1,\n    };\n  }\n\n  /**\n   * Update usage statistics\n   */\n  protected updateUsage(inputTokens?: number, outputTokens?: number): void {\n    if (inputTokens !== undefined) {\n      this.usage.inputTokens = inputTokens;\n    }\n    if (outputTokens !== undefined) {\n      this.usage.outputTokens = outputTokens;\n    }\n  }\n\n  /**\n   * Get accumulated arguments for a tool call\n   */\n  protected getAccumulatedArgs(toolCallId: string): string {\n    return this.toolCallBuffers.get(toolCallId)?.args || '{}';\n  }\n\n  /**\n   * Check if we have buffered data for a tool call\n   */\n  protected hasToolCallBuffer(toolCallId: string): boolean {\n    return this.toolCallBuffers.has(toolCallId);\n  }\n}\n","/**\n * Anthropic Stream Converter - Converts Anthropic SSE events to our unified StreamEvent format\n *\n * Extends BaseStreamConverter for common patterns:\n * - State management (response ID, sequence numbers)\n * - Tool call buffering\n * - Usage tracking\n * - Resource cleanup\n */\n\nimport Anthropic from '@anthropic-ai/sdk';\nimport { StreamEvent } from '../../../domain/entities/StreamEvent.js';\nimport { BaseStreamConverter } from '../base/BaseStreamConverter.js';\n\n/**\n * Block info tracked during streaming\n */\ninterface ContentBlockInfo {\n  type: string;\n  id?: string;\n  name?: string;\n}\n\n/**\n * Converts Anthropic streaming events to our unified StreamEvent format\n */\nexport class AnthropicStreamConverter extends BaseStreamConverter<Anthropic.MessageStreamEvent> {\n  readonly providerName = 'anthropic';\n\n  /** Map of content block index to block info */\n  private contentBlockIndex: Map<number, ContentBlockInfo> = new Map();\n\n  /**\n   * Convert a single Anthropic event to our StreamEvent(s)\n   */\n  protected convertEvent(event: Anthropic.MessageStreamEvent): StreamEvent[] {\n    const eventType = event.type;\n\n    switch (eventType) {\n      case 'message_start':\n        return this.handleMessageStart(event as Anthropic.MessageStartEvent);\n\n      case 'content_block_start':\n        return this.handleContentBlockStart(event as Anthropic.ContentBlockStartEvent);\n\n      case 'content_block_delta':\n        return this.handleContentBlockDelta(event as Anthropic.ContentBlockDeltaEvent);\n\n      case 'content_block_stop':\n        return this.handleContentBlockStop(event as Anthropic.ContentBlockStopEvent);\n\n      case 'message_delta':\n        return this.handleMessageDelta(event as Anthropic.MessageDeltaEvent);\n\n      case 'message_stop':\n        return this.handleMessageStop();\n\n      default:\n        // Handle ping and other event types\n        return [];\n    }\n  }\n\n  /**\n   * Clear all internal state\n   */\n  override clear(): void {\n    super.clear();\n    this.contentBlockIndex.clear();\n  }\n\n  // ==========================================================================\n  // Anthropic-Specific Event Handlers\n  // ==========================================================================\n\n  /**\n   * Handle message_start event\n   */\n  private handleMessageStart(event: Anthropic.MessageStartEvent): StreamEvent[] {\n    this.responseId = event.message.id;\n\n    // Capture input_tokens from message_start (only place it's available)\n    if (event.message.usage) {\n      this.updateUsage(event.message.usage.input_tokens, undefined);\n    }\n\n    return [this.emitResponseCreated(this.responseId)];\n  }\n\n  /**\n   * Handle content_block_start event\n   */\n  private handleContentBlockStart(event: Anthropic.ContentBlockStartEvent): StreamEvent[] {\n    const index = event.index;\n    const block = event.content_block;\n\n    // Track block type\n    if (block.type === 'thinking') {\n      this.contentBlockIndex.set(index, { type: 'thinking' });\n      return []; // No event needed, thinking will come in deltas\n    } else if (block.type === 'text') {\n      this.contentBlockIndex.set(index, { type: 'text' });\n      return []; // No event needed, text will come in deltas\n    } else if (block.type === 'tool_use') {\n      this.contentBlockIndex.set(index, {\n        type: 'tool_use',\n        id: block.id,\n        name: block.name,\n      });\n\n      return [this.emitToolCallStart(block.id, block.name, `msg_${this.responseId}`)];\n    }\n\n    return [];\n  }\n\n  /**\n   * Handle content_block_delta event\n   */\n  private handleContentBlockDelta(event: Anthropic.ContentBlockDeltaEvent): StreamEvent[] {\n    const index = event.index;\n    const delta = event.delta;\n    const blockInfo = this.contentBlockIndex.get(index);\n\n    if (!blockInfo) return [];\n\n    if (delta.type === 'thinking_delta') {\n      // Anthropic thinking delta\n      const thinkingDelta = delta as { type: 'thinking_delta'; thinking: string };\n      return [\n        this.emitReasoningDelta(thinkingDelta.thinking || '', `thinking_${this.responseId}`),\n      ];\n    } else if (delta.type === 'text_delta') {\n      return [\n        this.emitTextDelta(delta.text, {\n          itemId: `msg_${this.responseId}`,\n          contentIndex: index,\n        }),\n      ];\n    } else if (delta.type === 'input_json_delta') {\n      const toolCallId = blockInfo.id || '';\n      return [this.emitToolCallArgsDelta(toolCallId, delta.partial_json, blockInfo.name)];\n    }\n\n    return [];\n  }\n\n  /**\n   * Handle content_block_stop event\n   */\n  private handleContentBlockStop(event: Anthropic.ContentBlockStopEvent): StreamEvent[] {\n    const index = event.index;\n    const blockInfo = this.contentBlockIndex.get(index);\n\n    if (!blockInfo) return [];\n\n    // If this was a thinking block, emit reasoning done\n    if (blockInfo.type === 'thinking') {\n      return [this.emitReasoningDone(`thinking_${this.responseId}`)];\n    }\n\n    // If this was a tool use block, emit arguments done\n    if (blockInfo.type === 'tool_use') {\n      return [this.emitToolCallArgsDone(blockInfo.id || '', blockInfo.name)];\n    }\n\n    return [];\n  }\n\n  /**\n   * Handle message_delta event (usage info, stop_reason)\n   */\n  private handleMessageDelta(event: Anthropic.MessageDeltaEvent): StreamEvent[] {\n    // Extract usage info (Anthropic sends output_tokens in message_delta)\n    // Note: input_tokens is only available in message_start, not in delta\n    if (event.usage) {\n      this.updateUsage(undefined, event.usage.output_tokens);\n    }\n\n    // No events to emit - we'll include usage in message_stop\n    return [];\n  }\n\n  /**\n   * Handle message_stop event (final event)\n   */\n  private handleMessageStop(): StreamEvent[] {\n    return [this.emitResponseComplete('completed')];\n  }\n}\n","/**\n * Anthropic (Claude) text provider\n */\n\nimport Anthropic from '@anthropic-ai/sdk';\nimport { BaseTextProvider } from '../base/BaseTextProvider.js';\nimport { TextGenerateOptions, ModelCapabilities } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport { AnthropicConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderContextLengthError,\n} from '../../../domain/errors/AIErrors.js';\nimport { AnthropicConverter } from './AnthropicConverter.js';\nimport { AnthropicStreamConverter } from './AnthropicStreamConverter.js';\nimport { StreamEvent } from '../../../domain/entities/StreamEvent.js';\nimport { resolveModelCapabilities, resolveMaxContextTokens } from '../base/ModelCapabilityResolver.js';\n\nexport class AnthropicTextProvider extends BaseTextProvider {\n  readonly name = 'anthropic';\n  readonly capabilities: ProviderCapabilities = {\n    text: true,\n    images: true, // Claude 3+ supports vision\n    videos: false,\n    audio: false,\n  };\n\n  private client: Anthropic;\n  private converter: AnthropicConverter;\n  private streamConverter: AnthropicStreamConverter;\n\n  constructor(config: AnthropicConfig) {\n    super(config);\n\n    this.client = new Anthropic({\n      apiKey: this.getApiKey(),\n      baseURL: this.getBaseURL(),\n      maxRetries: this.getMaxRetries(),\n    });\n    this.converter = new AnthropicConverter();\n    this.streamConverter = new AnthropicStreamConverter();\n  }\n\n  /**\n   * Generate response using Anthropic Messages API\n   */\n  async generate(options: TextGenerateOptions): Promise<LLMResponse> {\n    return this.executeWithCircuitBreaker(async () => {\n      try {\n        // Convert our format  Anthropic Messages API format\n        const anthropicRequest = this.converter.convertRequest(options);\n\n        // Call Anthropic API (not stream)\n        const anthropicResponse = await this.client.messages.create({\n          ...anthropicRequest,\n          stream: false,\n        });\n\n        // Convert Anthropic response  our format\n        return this.converter.convertResponse(anthropicResponse);\n      } catch (error: any) {\n        this.handleError(error, options.model);\n        throw error; // TypeScript needs this\n      }\n    }, options.model);\n  }\n\n  /**\n   * Stream response using Anthropic Messages API\n   */\n  async *streamGenerate(options: TextGenerateOptions): AsyncIterableIterator<StreamEvent> {\n    try {\n      // Convert our format  Anthropic Messages API format\n      const anthropicRequest = this.converter.convertRequest(options);\n\n      // Create stream\n      const stream = await this.client.messages.create({\n        ...anthropicRequest,\n        stream: true,\n      });\n\n      // Reset stream converter for reuse\n      this.streamConverter.reset();\n\n      // Convert Anthropic events  our StreamEvent format\n      yield* this.streamConverter.convertStream(stream, options.model);\n    } catch (error: any) {\n      this.handleError(error, options.model);\n      throw error;\n    } finally {\n      // ALWAYS clear stream converter to prevent memory leaks\n      // Use finally block to ensure cleanup even on exception\n      this.streamConverter.clear();\n    }\n  }\n\n  /**\n   * Get model capabilities (registry-driven with Anthropic vendor defaults)\n   */\n  getModelCapabilities(model: string): ModelCapabilities {\n    const caps = resolveModelCapabilities(model, {\n      supportsTools: true,\n      supportsVision: true,\n      supportsJSON: true,\n      supportsJSONSchema: false,\n      maxTokens: 200000,\n      maxInputTokens: 200000,\n      maxOutputTokens: 8192,\n    });\n    // Anthropic doesn't support JSON schema mode even though registry has structuredOutput: true\n    caps.supportsJSONSchema = false;\n    return caps;\n  }\n\n  /**\n   * List available models from the Anthropic API\n   */\n  async listModels(): Promise<string[]> {\n    const models: string[] = [];\n    for await (const model of this.client.models.list()) {\n      models.push(model.id);\n    }\n    return models.sort();\n  }\n\n  /**\n   * Handle Anthropic-specific errors\n   */\n  private handleError(error: any, model?: string): never {\n    if (error.status === 401) {\n      throw new ProviderAuthError('anthropic', 'Invalid API key');\n    }\n\n    if (error.status === 429) {\n      const retryAfter = error.headers?.['retry-after'];\n      throw new ProviderRateLimitError(\n        'anthropic',\n        retryAfter ? parseInt(retryAfter) * 1000 : undefined\n      );\n    }\n\n    if (\n      error.type === 'invalid_request_error' &&\n      (error.message?.includes('prompt is too long') ||\n        error.message?.includes('maximum context length'))\n    ) {\n      throw new ProviderContextLengthError('anthropic', resolveMaxContextTokens(model, 200000));\n    }\n\n    // Re-throw other errors\n    throw error;\n  }\n}\n","/**\n * Image utilities for processing images\n */\n\nexport interface ImageData {\n  mimeType: string;\n  base64Data: string;\n  size: number;\n}\n\nexport interface FetchImageOptions {\n  /** Timeout in milliseconds (default: 30000) */\n  timeoutMs?: number;\n  /** Maximum image size in bytes (default: 10MB) */\n  maxSizeBytes?: number;\n}\n\nconst DEFAULT_TIMEOUT_MS = 30000; // 30 seconds\nconst DEFAULT_MAX_SIZE_BYTES = 10 * 1024 * 1024; // 10MB\n\n/**\n * Fetch an image from URL and convert to base64\n * Used by providers that require base64 (like Google)\n */\nexport async function fetchImageAsBase64(\n  url: string,\n  options?: FetchImageOptions\n): Promise<ImageData> {\n  const { timeoutMs = DEFAULT_TIMEOUT_MS, maxSizeBytes = DEFAULT_MAX_SIZE_BYTES } = options || {};\n\n  // Check if it's already a data URI\n  if (url.startsWith('data:image/')) {\n    const matches = url.match(/^data:(image\\/\\w+);base64,(.+)$/);\n    if (matches) {\n      const base64Data = matches[2] || '';\n      const size = calculateBase64Size(base64Data);\n\n      // Check size limit for data URIs too\n      if (size > maxSizeBytes) {\n        throw new Error(`Image size (${formatBytes(size)}) exceeds maximum allowed (${formatBytes(maxSizeBytes)})`);\n      }\n\n      return {\n        mimeType: matches[1] || 'image/png',\n        base64Data,\n        size,\n      };\n    }\n  }\n\n  // Fetch from URL with timeout and size limit\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), timeoutMs);\n\n  try {\n    const response = await fetch(url, {\n      signal: controller.signal,\n    });\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch image: ${response.status} ${response.statusText}`);\n    }\n\n    // Check content-length header before downloading\n    const contentLength = response.headers.get('content-length');\n    if (contentLength) {\n      const size = parseInt(contentLength, 10);\n      if (size > maxSizeBytes) {\n        throw new Error(\n          `Image size (${formatBytes(size)}) exceeds maximum allowed (${formatBytes(maxSizeBytes)})`\n        );\n      }\n    }\n\n    // Stream the response with size limit\n    const reader = response.body?.getReader();\n    if (!reader) {\n      throw new Error('Failed to get response body reader');\n    }\n\n    const chunks: Uint8Array[] = [];\n    let totalSize = 0;\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n\n      totalSize += value.length;\n      if (totalSize > maxSizeBytes) {\n        reader.cancel();\n        throw new Error(\n          `Image size exceeds maximum allowed (${formatBytes(maxSizeBytes)})`\n        );\n      }\n      chunks.push(value);\n    }\n\n    // Combine chunks into a single buffer\n    const buffer = Buffer.concat(chunks.map((chunk) => Buffer.from(chunk)));\n    const base64Data = buffer.toString('base64');\n\n    // Detect MIME type from content-type header or buffer magic numbers\n    let mimeType = response.headers.get('content-type') || 'image/png';\n\n    // Validate it's an image\n    if (!mimeType.startsWith('image/')) {\n      // Try to detect from magic numbers\n      mimeType = detectImageFormatFromBuffer(buffer);\n    }\n\n    return {\n      mimeType,\n      base64Data,\n      size: buffer.length,\n    };\n  } catch (error: any) {\n    if (error.name === 'AbortError') {\n      throw new Error(`Image fetch timed out after ${timeoutMs}ms`);\n    }\n    throw new Error(`Failed to fetch image from URL: ${error.message}`);\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\n/**\n * Detect image format from buffer magic numbers\n */\nfunction detectImageFormatFromBuffer(buffer: Buffer): string {\n  const magic = buffer.slice(0, 4).toString('hex');\n\n  if (magic.startsWith('89504e47')) return 'image/png';\n  if (magic.startsWith('ffd8ff')) return 'image/jpeg';\n  if (magic.startsWith('47494638')) return 'image/gif';\n  if (magic.startsWith('52494646')) return 'image/webp';\n\n  throw new Error('URL does not point to a valid image');\n}\n\n/**\n * Detect image format from base64 data\n */\nexport function detectImageFormat(base64Data: string): string {\n  const buffer = Buffer.from(base64Data, 'base64');\n  const magic = buffer.slice(0, 4).toString('hex');\n\n  if (magic.startsWith('89504e47')) return 'image/png';\n  if (magic.startsWith('ffd8ff')) return 'image/jpeg';\n  if (magic.startsWith('47494638')) return 'image/gif';\n  if (magic.startsWith('52494646')) return 'image/webp';\n\n  return 'image/png'; // Default\n}\n\n/**\n * Calculate accurate size from base64 data (in bytes)\n * Accounts for padding characters\n */\nexport function calculateBase64Size(base64Data: string): number {\n  // Remove data URI prefix if present\n  const data = base64Data.includes(',') ? base64Data.split(',')[1] : base64Data;\n\n  if (!data || data.length === 0) return 0;\n\n  // Count padding characters\n  let padding = 0;\n  if (data.endsWith('==')) padding = 2;\n  else if (data.endsWith('=')) padding = 1;\n\n  // Accurate calculation: (length * 3 / 4) - padding\n  return Math.floor((data.length * 3) / 4) - padding;\n}\n\n/**\n * Format bytes into human-readable string\n */\nfunction formatBytes(bytes: number): string {\n  if (bytes < 1024) return `${bytes} bytes`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n","/**\n * Google Gemini converter - Converts between our Responses API format and Google Gemini API\n * Works with both @google/genai SDK (for Gemini API and Vertex AI)\n */\n\n// Import types - the new SDK may have different type names\nimport type {\n  Content as GeminiContent,\n  Part,\n  FunctionDeclaration,\n} from '@google/genai';\nimport { TextGenerateOptions } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { InputItem, MessageRole } from '../../../domain/entities/Message.js';\nimport { convertToolsToStandardFormat } from '../shared/ToolConversionUtils.js';\nimport { validateThinkingConfig } from '../shared/validateThinkingConfig.js';\nimport { Content, ContentType } from '../../../domain/entities/Content.js';\nimport { Tool } from '../../../domain/entities/Tool.js';\nimport { fetchImageAsBase64 } from '../../../utils/imageUtils.js';\nimport { InvalidToolArgumentsError } from '../../../domain/errors/AIErrors.js';\nimport {\n  buildLLMResponse,\n  createTextContent,\n  createToolUseContent,\n  mapGoogleStatus,\n  generateToolCallId,\n} from '../shared/ResponseBuilder.js';\n\nexport class GoogleConverter {\n  // Track tool call ID  tool name mapping for tool results\n  private toolCallMapping: Map<string, string> = new Map();\n  // Track tool call ID  thought signature for Gemini 3+\n  // NOTE: This map is shared with GoogleStreamConverter for streaming responses\n  private thoughtSignatures: Map<string, string> = new Map();\n\n  /**\n   * Get the thought signatures storage map\n   * Used by GoogleStreamConverter to store signatures from streaming responses\n   */\n  getThoughtSignatureStorage(): Map<string, string> {\n    return this.thoughtSignatures;\n  }\n\n  /**\n   * Get the tool call mapping storage\n   * Used by GoogleStreamConverter to store tool name mappings from streaming responses\n   */\n  getToolCallMappingStorage(): Map<string, string> {\n    return this.toolCallMapping;\n  }\n\n  /**\n   * Convert our format  Google Gemini format\n   */\n  async convertRequest(options: TextGenerateOptions): Promise<any> {\n    // Debug input messages\n    if (process.env.DEBUG_GOOGLE && Array.isArray(options.input)) {\n      console.error('[DEBUG] Input messages:', JSON.stringify(options.input.map((msg: any) => ({\n        type: msg.type,\n        role: msg.role,\n        contentTypes: msg.content?.map((c: any) => c.type),\n      })), null, 2));\n    }\n\n    const contents = await this.convertMessages(options.input);\n    const tools = this.convertTools(options.tools);\n\n    // Debug: Check final contents\n    if (process.env.DEBUG_GOOGLE) {\n      console.error('[DEBUG] Final contents array length:', contents.length);\n    }\n\n    const request: any = {\n      contents,\n    };\n\n    // Add system instruction if provided\n    if (options.instructions) {\n      request.systemInstruction = { parts: [{ text: options.instructions }] };\n    }\n\n    // Add tools if provided\n    if (tools && tools.length > 0) {\n      request.tools = [{ functionDeclarations: tools }];\n\n      // Add tool config to encourage tool use\n      request.toolConfig = {\n        functionCallingConfig: {\n          mode: options.tool_choice === 'required' ? 'ANY' : 'AUTO',\n        },\n      };\n    }\n\n    // Add generation config\n    request.generationConfig = {\n      temperature: options.temperature,\n      maxOutputTokens: options.max_output_tokens,\n    };\n\n    // Add thinking config for Gemini 3+ reasoning models\n    if (options.vendorOptions?.thinkingLevel) {\n      request.generationConfig.thinkingConfig = {\n        thinkingLevel: options.vendorOptions.thinkingLevel,\n      };\n    } else if (options.thinking?.enabled) {\n      validateThinkingConfig(options.thinking);\n      // Unified thinking API: set thinkingBudget from thinking.budgetTokens\n      request.generationConfig.thinkingConfig = {\n        thinkingBudget: options.thinking.budgetTokens || 8192,\n      };\n    }\n\n    // Disable Google's code execution if we have function tools\n    // (prevents model from generating code instead of calling tools)\n    if (tools && tools.length > 0) {\n      request.generationConfig.allowCodeExecution = false;\n    }\n\n    // Handle JSON output\n    if (options.response_format) {\n      if (options.response_format.type === 'json_object') {\n        request.generationConfig.responseMimeType = 'application/json';\n      } else if (options.response_format.type === 'json_schema') {\n        request.generationConfig.responseMimeType = 'application/json';\n        // Google doesn't support full JSON schema - would need to add to system instruction\n      }\n    }\n\n    return request;\n  }\n\n  /**\n   * Convert our InputItem[]  Google contents\n   */\n  private async convertMessages(input: string | InputItem[]): Promise<GeminiContent[]> {\n    if (typeof input === 'string') {\n      return [\n        {\n          role: 'user',\n          parts: [{ text: input }],\n        },\n      ];\n    }\n\n    const contents: GeminiContent[] = [];\n\n    for (const item of input) {\n      if (item.type === 'message') {\n        // Map roles\n        const role = item.role === MessageRole.USER || item.role === MessageRole.DEVELOPER ? 'user' : 'model';\n\n        // Convert content to parts\n        const parts = await this.convertContentToParts(item.content);\n\n        // Debug logging\n        if (process.env.DEBUG_GOOGLE) {\n          console.error(`[DEBUG] Converting message - role: ${item.role}  ${role}, parts: ${parts.length}`,\n            parts.map((p: any) => Object.keys(p)));\n        }\n\n        if (parts.length > 0) {\n          contents.push({\n            role,\n            parts,\n          });\n        }\n      }\n    }\n\n    return contents;\n  }\n\n  /**\n   * Convert our Content[]  Google parts\n   */\n  private async convertContentToParts(content: Content[]): Promise<Part[]> {\n    const parts: Part[] = [];\n\n    for (const c of content) {\n      switch (c.type) {\n        case ContentType.INPUT_TEXT:\n        case ContentType.OUTPUT_TEXT:\n          parts.push({ text: c.text });\n          break;\n\n        case ContentType.INPUT_IMAGE_URL:\n          // Google requires inline data (base64), not URLs\n          try {\n            const imageData = await fetchImageAsBase64(c.image_url.url);\n            parts.push({\n              inlineData: {\n                mimeType: imageData.mimeType,\n                data: imageData.base64Data,\n              },\n            });\n          } catch (error: any) {\n            // If image fetch fails, skip it and add error as text\n            console.error(`Failed to fetch image: ${error.message}`);\n            parts.push({\n              text: `[Error: Could not load image from ${c.image_url.url}]`,\n            });\n          }\n          break;\n\n        case ContentType.TOOL_USE:\n          // Store tool call ID  name mapping for later use\n          this.toolCallMapping.set(c.id, c.name);\n\n          // Safe JSON parse with error handling\n          let parsedArgs: unknown;\n          try {\n            parsedArgs = JSON.parse(c.arguments);\n          } catch (parseError) {\n            throw new InvalidToolArgumentsError(\n              c.name,\n              c.arguments,\n              parseError instanceof Error ? parseError : new Error(String(parseError))\n            );\n          }\n\n          // Google uses functionCall\n          const functionCallPart: any = {\n            functionCall: {\n              name: c.name,\n              args: parsedArgs,\n            },\n          };\n\n          // Add thought signature if we have one (required for Gemini 3+)\n          const signature = this.thoughtSignatures.get(c.id);\n\n          if (process.env.DEBUG_GOOGLE) {\n            console.error(`[DEBUG] Looking up signature for tool ID: ${c.id}`);\n            console.error(`[DEBUG] Found signature:`, signature ? 'YES' : 'NO');\n            console.error(`[DEBUG] Available signatures:`, Array.from(this.thoughtSignatures.keys()));\n          }\n\n          if (signature) {\n            functionCallPart.thoughtSignature = signature;\n          }\n\n          parts.push(functionCallPart);\n          break;\n\n        case ContentType.TOOL_RESULT: {\n          // Google uses functionResponse - look up the actual function name\n          const functionName = this.toolCallMapping.get(c.tool_use_id) || this.extractToolName(c.tool_use_id);\n\n          // Read images from Content object first (set by addToolResults),\n          // fall back to JSON extraction for backward compat\n          const contentImages = (c as any).__images as Array<{ base64: string; mediaType: string }> | undefined;\n          let resultText: string;\n          let resultImages: Array<{ base64: string; mediaType: string }>;\n\n          if (contentImages?.length) {\n            // Images already extracted at context layer\n            resultText = typeof c.content === 'string' ? c.content : JSON.stringify(c.content);\n            resultImages = contentImages;\n          } else {\n            // Fallback: try extracting from raw JSON\n            const resultStr = typeof c.content === 'string' ? c.content : JSON.stringify(c.content);\n            const extracted = this.extractImagesFromResult(resultStr);\n            resultText = extracted.text;\n            resultImages = extracted.images;\n          }\n\n          parts.push({\n            functionResponse: {\n              name: functionName,\n              response: {\n                result: resultText,\n              },\n            },\n          });\n\n          // Add images as inline data parts after the function response\n          for (const img of resultImages) {\n            parts.push({\n              inlineData: {\n                mimeType: img.mediaType || 'image/png',\n                data: img.base64,\n              },\n            } as any);\n          }\n          break;\n        }\n      }\n    }\n\n    return parts;\n  }\n\n  /**\n   * Convert our Tool[]  Google function declarations\n   */\n  private convertTools(tools?: Tool[]): FunctionDeclaration[] | undefined {\n    if (!tools || tools.length === 0) {\n      return undefined;\n    }\n\n    // Use shared conversion utilities (DRY)\n    const standardTools = convertToolsToStandardFormat(tools);\n    return standardTools.map((tool) => ({\n      name: tool.name,\n      description: tool.description,\n      parameters: this.convertParametersSchema(tool.parameters),\n    }));\n  }\n\n  /**\n   * Convert JSON Schema parameters to Google's format\n   */\n  private convertParametersSchema(schema: any): any {\n    if (!schema) return undefined;\n\n    const converted: any = {\n      type: 'OBJECT', // Google uses uppercase 'OBJECT'\n      properties: {},\n    };\n\n    // Convert property types to uppercase\n    if (schema.properties) {\n      for (const [key, value] of Object.entries(schema.properties)) {\n        const prop = value as any;\n        converted.properties[key] = {\n          type: prop.type?.toUpperCase() || 'STRING',\n          description: prop.description,\n        };\n\n        // Handle enums\n        if (prop.enum) {\n          converted.properties[key].enum = prop.enum;\n        }\n\n        // Handle nested objects/arrays\n        if (prop.type === 'object' && prop.properties) {\n          converted.properties[key] = this.convertParametersSchema(prop);\n        }\n        if (prop.type === 'array' && prop.items) {\n          converted.properties[key].items = this.convertParametersSchema(prop.items);\n        }\n      }\n    }\n\n    // Add required fields\n    if (schema.required) {\n      converted.required = schema.required;\n    }\n\n    return converted;\n  }\n\n  /**\n   * Convert Google response  our LLMResponse format\n   */\n  convertResponse(response: any): LLMResponse {\n    const candidate = response.candidates?.[0];\n    const geminiContent = candidate?.content;\n\n    // Convert Google parts to our content\n    const content = this.convertGeminiPartsToContent(geminiContent?.parts || []);\n\n    // Debug output\n    if (process.env.DEBUG_GOOGLE) {\n      console.error('[DEBUG] Content array:', JSON.stringify(content, null, 2));\n      console.error('[DEBUG] Raw parts:', JSON.stringify(geminiContent?.parts, null, 2));\n    }\n\n    return buildLLMResponse({\n      provider: 'google',\n      model: response.modelVersion || 'gemini',\n      status: mapGoogleStatus(candidate?.finishReason),\n      content,\n      messageId: response.id,\n      usage: {\n        inputTokens: response.usageMetadata?.promptTokenCount || 0,\n        outputTokens: response.usageMetadata?.candidatesTokenCount || 0,\n        totalTokens: response.usageMetadata?.totalTokenCount || 0,\n      },\n    });\n  }\n\n  /**\n   * Convert Google parts  our Content[]\n   */\n  private convertGeminiPartsToContent(parts: Part[]): Content[] {\n    const content: Content[] = [];\n\n    for (const part of parts) {\n      // Check for thought/thinking parts (Gemini 3+ with thinking enabled)\n      if ('thought' in part && (part as any).thought === true && 'text' in part && part.text) {\n        content.push({\n          type: ContentType.THINKING,\n          thinking: part.text,\n          persistInHistory: false,\n        });\n      } else if ('text' in part && part.text) {\n        content.push(createTextContent(part.text));\n      } else if ('functionCall' in part && part.functionCall) {\n        const toolId = generateToolCallId('google');\n        const functionName = part.functionCall.name || '';\n\n        // Store thought signature if present (required for Gemini 3+)\n        if ('thoughtSignature' in part && part.thoughtSignature) {\n          const sig = part.thoughtSignature as string;\n          this.thoughtSignatures.set(toolId, sig);\n\n          if (process.env.DEBUG_GOOGLE) {\n            console.error(`[DEBUG] Captured thought signature for tool ID: ${toolId}`);\n            console.error(`[DEBUG] Signature length:`, sig.length);\n          }\n        } else if (process.env.DEBUG_GOOGLE) {\n          console.error(`[DEBUG] NO thought signature in part for ${functionName}`);\n          console.error(`[DEBUG] Part keys:`, Object.keys(part));\n        }\n\n        content.push(createToolUseContent(toolId, functionName, part.functionCall.args || {}));\n      }\n    }\n\n    return content;\n  }\n\n  /**\n   * Extract tool name from tool_use_id using tracked mapping\n   */\n  private extractToolName(toolUseId: string): string {\n    const name = this.toolCallMapping.get(toolUseId);\n    if (name) {\n      return name;\n    }\n    // Fallback - log warning and return placeholder\n    console.warn(`[GoogleConverter] Tool name not found for ID: ${toolUseId}`);\n    return 'unknown_tool';\n  }\n\n  /**\n   * Check if content array has tool calls requiring follow-up\n   * Used to determine when to clear thought signatures (must persist across tool execution)\n   */\n  hasToolCalls(content: Content[]): boolean {\n    return content.some(c => c.type === ContentType.TOOL_USE);\n  }\n\n  /**\n   * Clear all internal mappings\n   * Should be called after each request/response cycle to prevent memory leaks\n   */\n  clearMappings(): void {\n    this.toolCallMapping.clear();\n    this.thoughtSignatures.clear();\n  }\n\n  /**\n   * Reset converter state for a new request\n   * Alias for clearMappings()\n   */\n  reset(): void {\n    this.clearMappings();\n  }\n\n  /**\n   * Extract __images from a JSON tool result and return cleaned text + images.\n   * Used by the __images convention for multimodal tool results.\n   */\n  private extractImagesFromResult(content: string): {\n    text: string;\n    images: Array<{ base64: string; mediaType: string }>;\n  } {\n    try {\n      const parsed = JSON.parse(content);\n      if (parsed && Array.isArray(parsed.__images) && parsed.__images.length > 0) {\n        const images = parsed.__images;\n        const { __images: _, base64: __, ...rest } = parsed;\n        return { text: JSON.stringify(rest), images };\n      }\n    } catch {\n      // Not JSON or no __images\n    }\n    return { text: content, images: [] };\n  }\n}\n","/**\n * Google Gemini stream converter - converts Google streaming responses to our unified StreamEvent format\n */\n\nimport { randomUUID } from 'crypto';\nimport { GenerateContentResponse } from '@google/genai';\nimport { StreamEvent, StreamEventType, ReasoningDeltaEvent, ReasoningDoneEvent } from '../../../domain/entities/StreamEvent.js';\n\n/**\n * Converts Google Gemini streaming responses to our unified StreamEvent format\n */\nexport class GoogleStreamConverter {\n  private responseId: string = '';\n  private model: string = '';\n  private sequenceNumber: number = 0;\n  private isFirst: boolean = true;\n  private toolCallBuffers: Map<string, { name: string; args: string; signature?: string }> = new Map();\n  private hadToolCalls: boolean = false;\n  private reasoningBuffer: string = '';\n  private wasThinking: boolean = false;\n\n  // External storage for thought signatures (shared with GoogleConverter)\n  private thoughtSignatureStorage: Map<string, string> | null = null;\n  // External storage for tool call ID  name mapping (shared with GoogleConverter)\n  private toolCallMappingStorage: Map<string, string> | null = null;\n\n  /**\n   * Set external storage for thought signatures\n   * This allows sharing signatures with GoogleConverter for multi-turn conversations\n   */\n  setThoughtSignatureStorage(storage: Map<string, string>): void {\n    this.thoughtSignatureStorage = storage;\n  }\n\n  /**\n   * Set external storage for tool call mappings\n   * This allows sharing tool name lookups with GoogleConverter\n   */\n  setToolCallMappingStorage(storage: Map<string, string>): void {\n    this.toolCallMappingStorage = storage;\n  }\n\n  /**\n   * Convert Google stream to our StreamEvent format\n   */\n  async *convertStream(\n    googleStream: AsyncIterable<GenerateContentResponse>,\n    model: string\n  ): AsyncIterableIterator<StreamEvent> {\n    this.model = model;\n    this.sequenceNumber = 0;\n    this.isFirst = true;\n    this.toolCallBuffers.clear();\n    this.hadToolCalls = false;\n    this.reasoningBuffer = '';\n    this.wasThinking = false;\n\n    let lastUsage: { input_tokens: number; output_tokens: number; total_tokens: number } = {\n      input_tokens: 0,\n      output_tokens: 0,\n      total_tokens: 0,\n    };\n\n    for await (const chunk of googleStream) {\n      if (this.isFirst) {\n        this.responseId = this.generateResponseId();\n        yield {\n          type: StreamEventType.RESPONSE_CREATED,\n          response_id: this.responseId,\n          model: this.model,\n          created_at: Date.now(),\n        };\n        this.isFirst = false;\n      }\n\n      // Extract usage from chunk (Google includes it in every chunk)\n      const usage = this.extractUsage(chunk);\n      if (usage) {\n        lastUsage = usage;\n      }\n\n      const events = this.convertChunk(chunk);\n      for (const event of events) {\n        yield event;\n      }\n    }\n\n    // Emit reasoning done if we were still in thinking mode\n    if (this.wasThinking && this.reasoningBuffer) {\n      yield {\n        type: StreamEventType.REASONING_DONE,\n        response_id: this.responseId,\n        item_id: `thinking_${this.responseId}`,\n        thinking: this.reasoningBuffer,\n      } as ReasoningDoneEvent;\n      this.reasoningBuffer = '';\n      this.wasThinking = false;\n    }\n\n    // Emit completion for any pending tool calls\n    if (this.toolCallBuffers.size > 0) {\n      for (const [toolCallId, buffer] of this.toolCallBuffers) {\n        yield {\n          type: StreamEventType.TOOL_CALL_ARGUMENTS_DONE,\n          response_id: this.responseId,\n          tool_call_id: toolCallId,\n          tool_name: buffer.name,\n          arguments: buffer.args,\n        };\n      }\n    }\n\n    // Final completion event with actual usage\n    yield {\n      type: StreamEventType.RESPONSE_COMPLETE,\n      response_id: this.responseId,\n      status: 'completed',\n      usage: lastUsage,\n      iterations: 1,\n    };\n  }\n\n  /**\n   * Extract usage from Google chunk\n   */\n  private extractUsage(chunk: GenerateContentResponse): { input_tokens: number; output_tokens: number; total_tokens: number } | null {\n    const usage = chunk.usageMetadata;\n    if (!usage) return null;\n\n    return {\n      input_tokens: usage.promptTokenCount || 0,\n      output_tokens: usage.candidatesTokenCount || 0,\n      total_tokens: usage.totalTokenCount || 0,\n    };\n  }\n\n  /**\n   * Convert single Google chunk to our event(s)\n   */\n  private convertChunk(chunk: GenerateContentResponse): StreamEvent[] {\n    const events: StreamEvent[] = [];\n\n    const candidate = chunk.candidates?.[0];\n    if (!candidate?.content?.parts) return events;\n\n    for (const part of candidate.content.parts) {\n      const isThought = 'thought' in part && (part as any).thought === true;\n\n      if (isThought && part.text) {\n        // Thought/thinking delta from Gemini\n        // If we were not thinking before, this is a new thinking block\n        this.wasThinking = true;\n        this.reasoningBuffer += part.text;\n\n        events.push({\n          type: StreamEventType.REASONING_DELTA,\n          response_id: this.responseId,\n          item_id: `thinking_${this.responseId}`,\n          delta: part.text,\n          sequence_number: this.sequenceNumber++,\n        } as ReasoningDeltaEvent);\n      } else if (part.text) {\n        // If we were thinking and now we're not, emit reasoning done\n        if (this.wasThinking) {\n          this.wasThinking = false;\n          events.push({\n            type: StreamEventType.REASONING_DONE,\n            response_id: this.responseId,\n            item_id: `thinking_${this.responseId}`,\n            thinking: this.reasoningBuffer,\n          } as ReasoningDoneEvent);\n          this.reasoningBuffer = '';\n        }\n\n        // Text delta\n        events.push({\n          type: StreamEventType.OUTPUT_TEXT_DELTA,\n          response_id: this.responseId,\n          item_id: `msg_${this.responseId}`,\n          output_index: 0,\n          content_index: 0,\n          delta: part.text,\n          sequence_number: this.sequenceNumber++,\n        });\n      } else if (part.functionCall) {\n        // Function call (tool use)\n        const functionCall = part.functionCall;\n        const toolName = functionCall.name || 'unknown';\n        const toolCallId = `call_${this.responseId}_${toolName}`;\n\n        // Extract thought signature if present (required for Gemini 3+)\n        const thoughtSignature = 'thoughtSignature' in part ? (part.thoughtSignature as string) : undefined;\n\n        // Check if this is a new tool call\n        if (!this.toolCallBuffers.has(toolCallId)) {\n          this.hadToolCalls = true;\n          this.toolCallBuffers.set(toolCallId, {\n            name: toolName,\n            args: '',\n            signature: thoughtSignature,\n          });\n\n          // Store tool call ID  name mapping for tool result conversion\n          if (this.toolCallMappingStorage) {\n            this.toolCallMappingStorage.set(toolCallId, toolName);\n          }\n\n          // Store signature in external storage for use in next request\n          if (thoughtSignature && this.thoughtSignatureStorage) {\n            this.thoughtSignatureStorage.set(toolCallId, thoughtSignature);\n            if (process.env.DEBUG_GOOGLE) {\n              console.error(`[DEBUG] Stream: Captured thought signature for tool ID: ${toolCallId}`);\n            }\n          } else if (process.env.DEBUG_GOOGLE && !thoughtSignature) {\n            console.error(`[DEBUG] Stream: NO thought signature in part for ${toolName}`);\n          }\n\n          events.push({\n            type: StreamEventType.TOOL_CALL_START,\n            response_id: this.responseId,\n            item_id: `msg_${this.responseId}`,\n            tool_call_id: toolCallId,\n            tool_name: toolName,\n          });\n        } else if (thoughtSignature) {\n          // Update signature if we get it in a later chunk\n          const buffer = this.toolCallBuffers.get(toolCallId)!;\n          if (!buffer.signature) {\n            buffer.signature = thoughtSignature;\n            if (this.thoughtSignatureStorage) {\n              this.thoughtSignatureStorage.set(toolCallId, thoughtSignature);\n              if (process.env.DEBUG_GOOGLE) {\n                console.error(`[DEBUG] Stream: Updated thought signature for tool ID: ${toolCallId}`);\n              }\n            }\n          }\n        }\n\n        // Convert args object to JSON string\n        if (functionCall.args) {\n          const argsJson = JSON.stringify(functionCall.args);\n          const buffer = this.toolCallBuffers.get(toolCallId)!;\n\n          // Check if this is new content (Google sends complete args each time)\n          if (argsJson !== buffer.args) {\n            const delta = argsJson.slice(buffer.args.length);\n            buffer.args = argsJson;\n\n            if (delta) {\n              events.push({\n                type: StreamEventType.TOOL_CALL_ARGUMENTS_DELTA,\n                response_id: this.responseId,\n                item_id: `msg_${this.responseId}`,\n                tool_call_id: toolCallId,\n                tool_name: toolName,\n                delta,\n                sequence_number: this.sequenceNumber++,\n              });\n            }\n          }\n        }\n      }\n    }\n\n    return events;\n  }\n\n  /**\n   * Generate unique response ID using cryptographically secure UUID\n   */\n  private generateResponseId(): string {\n    return `resp_google_${randomUUID()}`;\n  }\n\n  /**\n   * Check if the stream had tool calls\n   * Used to determine when to clear thought signatures (must persist across tool execution)\n   */\n  hasToolCalls(): boolean {\n    return this.hadToolCalls;\n  }\n\n  /**\n   * Clear all internal state\n   * Should be called after each stream completes to prevent memory leaks\n   */\n  clear(): void {\n    this.responseId = '';\n    this.model = '';\n    this.sequenceNumber = 0;\n    this.isFirst = true;\n    this.toolCallBuffers.clear();\n    this.hadToolCalls = false;\n    this.reasoningBuffer = '';\n    this.wasThinking = false;\n  }\n\n  /**\n   * Reset converter state for a new stream\n   * Alias for clear()\n   */\n  reset(): void {\n    this.clear();\n  }\n}\n","/**\n * Google Gemini text provider (using new unified SDK)\n */\n\nimport { GoogleGenAI } from '@google/genai';\nimport { BaseTextProvider } from '../base/BaseTextProvider.js';\nimport { TextGenerateOptions, ModelCapabilities } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport { GoogleConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderContextLengthError,\n} from '../../../domain/errors/AIErrors.js';\nimport { GoogleConverter } from './GoogleConverter.js';\nimport { GoogleStreamConverter } from './GoogleStreamConverter.js';\nimport { StreamEvent } from '../../../domain/entities/StreamEvent.js';\nimport { resolveModelCapabilities, resolveMaxContextTokens } from '../base/ModelCapabilityResolver.js';\n\nexport class GoogleTextProvider extends BaseTextProvider {\n  readonly name = 'google';\n  readonly capabilities: ProviderCapabilities = {\n    text: true,\n    images: true, // Gemini supports vision\n    videos: false,\n    audio: false,\n  };\n\n  private client: GoogleGenAI;\n  private converter: GoogleConverter;\n  private streamConverter: GoogleStreamConverter;\n\n  constructor(config: GoogleConfig) {\n    super(config);\n\n    // New SDK uses object config\n    this.client = new GoogleGenAI({\n      apiKey: this.getApiKey(),\n      // Pass custom baseURL for proxy support (e.g. when routing through EW proxy)\n      ...(config.baseURL ? { httpOptions: { baseUrl: config.baseURL } } : {}),\n    });\n    this.converter = new GoogleConverter();\n    this.streamConverter = new GoogleStreamConverter();\n\n    // Share storage between converters for multi-turn conversations\n    // This allows streaming responses to store signatures and mappings that the\n    // regular converter can use when preparing the next request\n    this.streamConverter.setThoughtSignatureStorage(this.converter.getThoughtSignatureStorage());\n    this.streamConverter.setToolCallMappingStorage(this.converter.getToolCallMappingStorage());\n  }\n\n  /**\n   * Generate response using Google Gemini API\n   */\n  async generate(options: TextGenerateOptions): Promise<LLMResponse> {\n    return this.executeWithCircuitBreaker(async () => {\n      try {\n        // Convert our format  Google format\n        const googleRequest = await this.converter.convertRequest(options);\n\n        // Debug logging\n        if (process.env.DEBUG_GOOGLE) {\n          console.error('[DEBUG] Google Request:', JSON.stringify({\n            model: options.model,\n            tools: googleRequest.tools,\n            toolConfig: googleRequest.toolConfig,\n            generationConfig: googleRequest.generationConfig,\n            contents: googleRequest.contents?.slice(0, 1), // First message only\n          }, null, 2));\n        }\n\n        // Call Google API using new SDK structure\n        // Note: contents goes at top level, generation config properties go directly in config\n        const result = await this.client.models.generateContent({\n          model: options.model,\n          contents: googleRequest.contents,\n          config: {\n            systemInstruction: googleRequest.systemInstruction,\n            tools: googleRequest.tools,\n            toolConfig: googleRequest.toolConfig,\n            ...googleRequest.generationConfig,\n          },\n        });\n\n        // Debug logging for response\n        if (process.env.DEBUG_GOOGLE) {\n          console.error('[DEBUG] Google Response:', JSON.stringify({\n            candidates: result.candidates?.map((c: any) => ({\n              finishReason: c.finishReason,\n              content: c.content,\n            })),\n            usageMetadata: result.usageMetadata,\n          }, null, 2));\n        }\n\n        // Convert Google response  our format\n        const response = this.converter.convertResponse(result);\n\n        // Only clear mappings when conversation is complete (no pending tool calls)\n        // For Gemini 3+, thought signatures must persist across tool execution rounds\n        const firstOutput = response.output?.[0];\n        const outputContent = firstOutput && 'content' in firstOutput ? firstOutput.content : [];\n        const hasToolCalls = this.converter.hasToolCalls(outputContent);\n        if (!hasToolCalls) {\n          this.converter.clearMappings();\n        }\n\n        return response;\n      } catch (error: any) {\n        // Clear mappings on error to prevent stale state\n        this.converter.clearMappings();\n        this.handleError(error, options.model);\n        throw error; // TypeScript needs this\n      }\n    }, options.model);\n  }\n\n  /**\n   * Stream response using Google Gemini API\n   */\n  async *streamGenerate(options: TextGenerateOptions): AsyncIterableIterator<StreamEvent> {\n    try {\n      // Convert our format  Google format\n      const googleRequest = await this.converter.convertRequest(options);\n\n      // Create stream using new SDK\n      // Note: contents goes at top level, generation config properties go directly in config\n      const stream = await this.client.models.generateContentStream({\n        model: options.model,\n        contents: googleRequest.contents,\n        config: {\n          systemInstruction: googleRequest.systemInstruction,\n          tools: googleRequest.tools,\n          toolConfig: googleRequest.toolConfig,\n          ...googleRequest.generationConfig,\n        },\n      });\n\n      // Reset stream converter for reuse\n      this.streamConverter.reset();\n\n      // Convert Google stream  our StreamEvent format\n      yield* this.streamConverter.convertStream(stream, options.model);\n\n      // Only clear mappings when conversation is complete (no pending tool calls)\n      // For Gemini 3+, thought signatures must persist across tool execution rounds\n      if (!this.streamConverter.hasToolCalls()) {\n        this.converter.clearMappings();\n        this.streamConverter.clear();\n      }\n    } catch (error: any) {\n      // Clear converters on error to prevent stale state\n      this.converter.clearMappings();\n      this.streamConverter.clear();\n      this.handleError(error, options.model);\n      throw error;\n    }\n  }\n\n  /**\n   * Get model capabilities (registry-driven with Google vendor defaults)\n   */\n  getModelCapabilities(model: string): ModelCapabilities {\n    return resolveModelCapabilities(model, {\n      supportsTools: true,\n      supportsVision: true,\n      supportsJSON: true,\n      supportsJSONSchema: false,\n      maxTokens: 1048576,\n      maxInputTokens: 1048576,\n      maxOutputTokens: 65536,\n    });\n  }\n\n  /**\n   * List available models from the Google Gemini API\n   */\n  async listModels(): Promise<string[]> {\n    const models: string[] = [];\n    const pager = await this.client.models.list();\n    for await (const model of pager) {\n      // Google model names are like \"models/gemini-2.0-flash\"  strip the prefix\n      const name = model.name?.replace(/^models\\//, '') ?? '';\n      if (name) models.push(name);\n    }\n    return models.sort();\n  }\n\n  /**\n   * Handle Google-specific errors\n   */\n  private handleError(error: any, model?: string): never {\n    const errorMessage = error.message || '';\n\n    if (error.status === 401 || errorMessage.includes('API key not valid')) {\n      throw new ProviderAuthError('google', 'Invalid API key');\n    }\n\n    if (error.status === 429 || errorMessage.includes('Resource exhausted')) {\n      throw new ProviderRateLimitError('google');\n    }\n\n    if (errorMessage.includes('context length') || errorMessage.includes('too long')) {\n      throw new ProviderContextLengthError('google', resolveMaxContextTokens(model, 1048576));\n    }\n\n    // Re-throw other errors\n    throw error;\n  }\n}\n","/**\n * Google Vertex AI text provider (enterprise features)\n * Uses the same unified @google/genai SDK as GoogleTextProvider\n */\n\nimport { GoogleGenAI } from '@google/genai';\nimport { BaseTextProvider } from '../base/BaseTextProvider.js';\nimport { TextGenerateOptions, ModelCapabilities } from '../../../domain/interfaces/ITextProvider.js';\nimport { LLMResponse } from '../../../domain/entities/Response.js';\nimport { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport { VertexAIConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderContextLengthError,\n  InvalidConfigError,\n} from '../../../domain/errors/AIErrors.js';\nimport { GoogleConverter } from '../google/GoogleConverter.js';\nimport { GoogleStreamConverter } from '../google/GoogleStreamConverter.js';\nimport { StreamEvent } from '../../../domain/entities/StreamEvent.js';\nimport { resolveModelCapabilities, resolveMaxContextTokens } from '../base/ModelCapabilityResolver.js';\n\nexport class VertexAITextProvider extends BaseTextProvider {\n  readonly name = 'vertex-ai';\n  readonly capabilities: ProviderCapabilities = {\n    text: true,\n    images: true,\n    videos: true, // Vertex AI supports video input\n    audio: true, // Vertex AI supports audio input\n  };\n\n  private client: GoogleGenAI;\n  private converter: GoogleConverter;\n  protected override config: VertexAIConfig;\n\n  constructor(config: VertexAIConfig) {\n    super(config);\n    this.config = config;\n\n    // Validate required config\n    if (!config.projectId) {\n      throw new InvalidConfigError('Vertex AI requires projectId');\n    }\n    if (!config.location) {\n      throw new InvalidConfigError('Vertex AI requires location (e.g., \"us-central1\")');\n    }\n\n    // Configure environment for Vertex AI\n    process.env.GOOGLE_GENAI_USE_VERTEXAI = 'True';\n    process.env.GOOGLE_CLOUD_PROJECT = config.projectId;\n    process.env.GOOGLE_CLOUD_LOCATION = config.location;\n\n    // If credentials provided, set them\n    if (config.credentials) {\n      // Note: The SDK will use credentials from the environment or ADC\n      // Service account JSON can be passed via GOOGLE_APPLICATION_CREDENTIALS env var\n    }\n\n    // Initialize client for Vertex AI\n    this.client = new GoogleGenAI({\n      // No API key for Vertex AI - uses Application Default Credentials\n    });\n\n    // Reuse Google converter - same API format!\n    this.converter = new GoogleConverter();\n  }\n\n  /**\n   * Generate response using Vertex AI\n   */\n  async generate(options: TextGenerateOptions): Promise<LLMResponse> {\n    try {\n      // Convert our format  Google format (same as regular Gemini API)\n      const googleRequest = await this.converter.convertRequest(options);\n\n      // Call Vertex AI using new SDK structure\n      // Note: contents goes at top level, generation config properties go directly in config\n      const result = await this.client.models.generateContent({\n        model: options.model,\n        contents: googleRequest.contents,\n        config: {\n          systemInstruction: googleRequest.systemInstruction,\n          tools: googleRequest.tools,\n          toolConfig: googleRequest.toolConfig,\n          ...googleRequest.generationConfig,\n        },\n      });\n\n      // Convert response  our format (same as regular Gemini API)\n      return this.converter.convertResponse(result);\n    } catch (error: any) {\n      this.handleError(error, options.model);\n      throw error; // TypeScript needs this\n    }\n  }\n\n  /**\n   * Stream response using Vertex AI\n   */\n  async *streamGenerate(options: TextGenerateOptions): AsyncIterableIterator<StreamEvent> {\n    try {\n      // Convert our format  Google format\n      const googleRequest = await this.converter.convertRequest(options);\n\n      // Create stream using new SDK\n      // Note: contents goes at top level, generation config properties go directly in config\n      const stream = await this.client.models.generateContentStream({\n        model: options.model,\n        contents: googleRequest.contents,\n        config: {\n          systemInstruction: googleRequest.systemInstruction,\n          tools: googleRequest.tools,\n          toolConfig: googleRequest.toolConfig,\n          ...googleRequest.generationConfig,\n        },\n      });\n\n      // Convert Google stream  our StreamEvent format\n      const streamConverter = new GoogleStreamConverter();\n      yield* streamConverter.convertStream(stream, options.model);\n    } catch (error: any) {\n      this.handleError(error, options.model);\n      throw error;\n    }\n  }\n\n  /**\n   * Get model capabilities (registry-driven with Vertex AI vendor defaults)\n   */\n  getModelCapabilities(model: string): ModelCapabilities {\n    return resolveModelCapabilities(model, {\n      supportsTools: true,\n      supportsVision: true,\n      supportsJSON: true,\n      supportsJSONSchema: false,\n      maxTokens: 1048576,\n      maxInputTokens: 1048576,\n      maxOutputTokens: 65536,\n    });\n  }\n\n  /**\n   * List available models from the Vertex AI API\n   */\n  async listModels(): Promise<string[]> {\n    const models: string[] = [];\n    const pager = await this.client.models.list();\n    for await (const model of pager) {\n      // Google model names are like \"models/gemini-2.0-flash\"  strip the prefix\n      const name = model.name?.replace(/^models\\//, '') ?? '';\n      if (name) models.push(name);\n    }\n    return models.sort();\n  }\n\n  /**\n   * Handle Vertex AI-specific errors\n   */\n  private handleError(error: any, model?: string): never {\n    const errorMessage = error.message || '';\n\n    // Authentication errors\n    if (\n      error.status === 401 ||\n      error.status === 403 ||\n      errorMessage.includes('not authenticated') ||\n      errorMessage.includes('permission denied')\n    ) {\n      throw new ProviderAuthError(\n        'vertex-ai',\n        'Authentication failed. Make sure you have set up Application Default Credentials or provided service account credentials.'\n      );\n    }\n\n    if (error.status === 429 || errorMessage.includes('Resource exhausted')) {\n      throw new ProviderRateLimitError('vertex-ai');\n    }\n\n    if (errorMessage.includes('context length') || errorMessage.includes('too long')) {\n      throw new ProviderContextLengthError('vertex-ai', resolveMaxContextTokens(model, 1048576));\n    }\n\n    // Re-throw other errors\n    throw error;\n  }\n}\n","/**\n * Generic OpenAI-compatible provider\n * Works with any service that implements the OpenAI Chat Completions API\n * Examples: Together AI, Groq, Perplexity, Grok (xAI), local models, etc.\n */\n\nimport { OpenAITextProvider } from '../openai/OpenAITextProvider.js';\nimport { ModelCapabilities } from '../../../domain/interfaces/ITextProvider.js';\nimport { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport { resolveModelCapabilities } from '../base/ModelCapabilityResolver.js';\n\nexport interface GenericOpenAIConfig {\n  apiKey: string;\n  baseURL: string; // Required - the API endpoint\n  organization?: string;\n  timeout?: number;\n  maxRetries?: number;\n  defaultModel?: string;\n}\n\nexport class GenericOpenAIProvider extends OpenAITextProvider {\n  readonly name: string;\n  readonly capabilities: ProviderCapabilities;\n\n  constructor(\n    name: string,\n    config: GenericOpenAIConfig,\n    capabilities?: Partial<ProviderCapabilities>\n  ) {\n    super(config as any);\n    this.name = name;\n\n    // Set capabilities\n    if (capabilities) {\n      this.capabilities = {\n        text: capabilities.text ?? true,\n        images: capabilities.images ?? false,\n        videos: capabilities.videos ?? false,\n        audio: capabilities.audio ?? false,\n      };\n    } else {\n      // Default generic capabilities\n      this.capabilities = {\n        text: true,\n        images: false, // Conservative default\n        videos: false,\n        audio: false,\n      };\n    }\n  }\n\n  /**\n   * Override API key validation for generic providers.\n   * Services like Ollama don't require authentication, so accept any key including mock/placeholder keys.\n   */\n  protected override validateApiKey(): { isValid: boolean; warning?: string } {\n    // Generic providers (Ollama, local models, etc.) may not need real API keys\n    // Accept any non-undefined apiKey, including 'mock-key' from auth: { type: 'none' }\n    return { isValid: true };\n  }\n\n  /**\n   * Override listModels for error safety  some OpenAI-compatible APIs may not support /v1/models\n   */\n  async listModels(): Promise<string[]> {\n    try {\n      return await super.listModels();\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Override model capabilities for generic providers (registry-driven with conservative defaults)\n   */\n  getModelCapabilities(model: string): ModelCapabilities {\n    return resolveModelCapabilities(model, {\n      supportsTools: true,\n      supportsVision: false,\n      supportsJSON: true,\n      supportsJSONSchema: false,\n      maxTokens: 32000,\n      maxInputTokens: 32000,\n      maxOutputTokens: 4096,\n    });\n  }\n}\n","/**\n * Provider Factory - creates the right provider from a Connector\n *\n * This is the bridge between Connectors and provider implementations.\n * It extracts credentials from the connector and instantiates the appropriate SDK.\n */\n\nimport OpenAI from 'openai';\nimport Anthropic from '@anthropic-ai/sdk';\nimport { Connector } from './Connector.js';\nimport { Vendor } from './Vendor.js';\nimport { ITextProvider } from '../domain/interfaces/ITextProvider.js';\nimport { ProviderConfig } from '../domain/types/ProviderConfig.js';\n\n// Import providers\nimport { OpenAITextProvider } from '../infrastructure/providers/openai/OpenAITextProvider.js';\nimport { AnthropicTextProvider } from '../infrastructure/providers/anthropic/AnthropicTextProvider.js';\nimport { GoogleTextProvider } from '../infrastructure/providers/google/GoogleTextProvider.js';\nimport { VertexAITextProvider } from '../infrastructure/providers/vertex/VertexAITextProvider.js';\nimport { GenericOpenAIProvider } from '../infrastructure/providers/generic/GenericOpenAIProvider.js';\n\n// ---------------------------------------------------------------------------\n// Vendor default base URLs  built once at module load from SDKs\n// ---------------------------------------------------------------------------\n\n/**\n * Immutable map of vendor  default API base URL, built at startup.\n * For OpenAI/Anthropic: reads from the installed SDK so we auto-track URL changes.\n * For OpenAI-compatible vendors: same URLs already in createProvider().\n * For Google/Vertex: stable API gateway endpoints.\n */\nconst VENDOR_DEFAULT_URLS: ReadonlyMap<string, string> = (() => {\n  const map = new Map<string, string>();\n\n  // Read from actual SDKs at startup\n  try { map.set(Vendor.OpenAI, new OpenAI({ apiKey: '_' }).baseURL); } catch { /* SDK not installed */ }\n  try { map.set(Vendor.Anthropic, new Anthropic({ apiKey: '_' }).baseURL); } catch { /* SDK not installed */ }\n\n  // Google  SDKs don't expose a simple baseURL property\n  map.set(Vendor.Google, 'https://generativelanguage.googleapis.com');\n  map.set(Vendor.GoogleVertex, 'https://us-central1-aiplatform.googleapis.com');\n\n  // OpenAI-compatible vendors  no dedicated SDKs\n  map.set(Vendor.Groq, 'https://api.groq.com/openai/v1');\n  map.set(Vendor.Together, 'https://api.together.xyz/v1');\n  map.set(Vendor.Perplexity, 'https://api.perplexity.ai');\n  map.set(Vendor.Grok, 'https://api.x.ai/v1');\n  map.set(Vendor.DeepSeek, 'https://api.deepseek.com/v1');\n  map.set(Vendor.Mistral, 'https://api.mistral.ai/v1');\n  map.set(Vendor.Ollama, 'http://localhost:11434/v1');\n\n  return map;\n})();\n\n/**\n * Get the default API base URL for a vendor.\n * For OpenAI/Anthropic reads from the installed SDK at runtime.\n * Returns undefined for Custom or unknown vendors.\n */\nexport function getVendorDefaultBaseURL(vendor: string): string | undefined {\n  return VENDOR_DEFAULT_URLS.get(vendor);\n}\n\n/**\n * Create a text provider from a connector\n */\nexport function createProvider(connector: Connector): ITextProvider {\n  // Allow injecting a provider directly for testing\n  const injectedProvider = connector.getOptions().provider;\n  if (injectedProvider && typeof (injectedProvider as any).generate === 'function') {\n    return injectedProvider as ITextProvider;\n  }\n\n  const vendor = connector.vendor;\n\n  if (!vendor) {\n    throw new Error(\n      `Connector '${connector.name}' has no vendor specified. ` +\n        `Set vendor to create an AI provider.`\n    );\n  }\n\n  // Extract config from connector\n  const config = extractProviderConfig(connector);\n\n  switch (vendor) {\n    case Vendor.OpenAI:\n      return new OpenAITextProvider({\n        ...config,\n        organization: connector.getOptions().organization as string | undefined,\n        project: connector.getOptions().project as string | undefined,\n      });\n\n    case Vendor.Anthropic:\n      return new AnthropicTextProvider({\n        ...config,\n        anthropicVersion: connector.getOptions().anthropicVersion as string | undefined,\n      });\n\n    case Vendor.Google:\n      return new GoogleTextProvider(config);\n\n    case Vendor.GoogleVertex:\n      return new VertexAITextProvider({\n        ...config,\n        projectId: connector.getOptions().projectId as string || '',\n        location: connector.getOptions().location as string || 'us-central1',\n      });\n\n    // OpenAI-compatible providers (use connector.name for unique identification)\n    case Vendor.Groq:\n    case Vendor.Together:\n    case Vendor.Perplexity:\n    case Vendor.Grok:\n    case Vendor.DeepSeek:\n    case Vendor.Mistral:\n    case Vendor.Ollama:\n      return new GenericOpenAIProvider(connector.name, {\n        ...config,\n        baseURL: config.baseURL || getVendorDefaultBaseURL(vendor)!,\n      });\n\n    case Vendor.Custom:\n      if (!config.baseURL) {\n        throw new Error(\n          `Connector '${connector.name}' with Custom vendor requires baseURL`\n        );\n      }\n      return new GenericOpenAIProvider(connector.name, {\n        ...config,\n        baseURL: config.baseURL,\n      });\n\n    default:\n      throw new Error(`Unknown vendor: ${vendor}`);\n  }\n}\n\n/**\n * Extract ProviderConfig from a Connector\n */\nfunction extractProviderConfig(connector: Connector): ProviderConfig {\n  const auth = connector.config.auth;\n\n  // Get API key based on auth type\n  let apiKey: string;\n\n  if (auth.type === 'api_key') {\n    apiKey = auth.apiKey;\n  } else if (auth.type === 'none') {\n    // For testing/mock providers and local services like Ollama\n    apiKey = 'mock-key';\n  } else if (auth.type === 'oauth') {\n    // For OAuth, we'd need to get the token asynchronously\n    // For now, throw an error - OAuth providers need special handling\n    throw new Error(\n      `Connector '${connector.name}' uses OAuth. ` +\n        `Call connector.getToken() to get the access token first.`\n    );\n  } else if (auth.type === 'jwt') {\n    throw new Error(\n      `Connector '${connector.name}' uses JWT auth. ` +\n        `JWT auth for AI providers is not yet supported.`\n    );\n  } else {\n    throw new Error(`Unknown auth type for connector '${connector.name}'`);\n  }\n\n  return {\n    apiKey,\n    baseURL: connector.config.baseURL,\n    timeout: connector.getOptions().timeout as number | undefined,\n    maxRetries: connector.getOptions().maxRetries as number | undefined,\n  };\n}\n\n/**\n * Create a text provider from a Connector with async token support\n * Use this for OAuth connectors\n */\nexport async function createProviderAsync(\n  connector: Connector,\n  userId?: string\n): Promise<ITextProvider> {\n  const auth = connector.config.auth;\n\n  // For API key auth, use sync version\n  if (auth.type === 'api_key') {\n    return createProvider(connector);\n  }\n\n  // For OAuth, get the token first\n  const token = await connector.getToken(userId);\n\n  // Create a temporary config with the token as API key\n  // (Most providers accept Bearer tokens the same way as API keys)\n  const tempConnector = {\n    ...connector,\n    config: {\n      ...connector.config,\n      auth: {\n        type: 'api_key' as const,\n        apiKey: token,\n      },\n    },\n  } as Connector;\n\n  return createProvider(tempConnector);\n}\n","/**\n * Tool entities with blocking/non-blocking execution support\n */\n\n// Import the canonical ToolContext from IToolContext.ts (single source of truth)\nimport type { ToolContext } from '../interfaces/IToolContext.js';\n\n// Re-export for backward compatibility\nexport type { ToolContext };\n\nexport interface JSONSchema {\n  type: string;\n  properties?: Record<string, any>;\n  required?: string[];\n  [key: string]: any;\n}\n\nexport interface FunctionToolDefinition {\n  type: 'function';\n  function: {\n    name: string;\n    description?: string;\n    parameters?: JSONSchema;\n    strict?: boolean; // Enforce schema strictly\n  };\n  blocking?: boolean; // Default: true (wait for result before continuing)\n  timeout?: number; // Timeout in ms (default: 30000)\n}\n\nexport interface BuiltInTool {\n  type: 'web_search' | 'file_search' | 'computer_use' | 'code_interpreter';\n  blocking?: boolean;\n}\n\nexport type Tool = FunctionToolDefinition | BuiltInTool;\n\nexport enum ToolCallState {\n  PENDING = 'pending', // Tool call identified, not yet executed\n  EXECUTING = 'executing', // Currently executing\n  COMPLETED = 'completed', // Successfully completed\n  FAILED = 'failed', // Execution failed\n  TIMEOUT = 'timeout', // Execution timed out\n}\n\nexport interface ToolCall {\n  id: string;\n  type: 'function';\n  function: {\n    name: string;\n    arguments: string; // JSON string\n  };\n  blocking: boolean; // Copied from tool definition\n  state: ToolCallState;\n  startTime?: Date;\n  endTime?: Date;\n  error?: string;\n}\n\nexport interface ToolResult {\n  tool_use_id: string;\n  tool_name?: string; // Name of the tool that was executed (for eviction tracking)\n  tool_args?: Record<string, unknown>; // Arguments passed to the tool (for description generation)\n  content: any;\n  error?: string;\n  executionTime?: number; // ms\n  state: ToolCallState;\n}\n\n/**\n * Tool execution context - tracks all tool calls in a generation\n */\nexport interface ToolExecutionContext {\n  executionId: string; // Unique ID for this LLM generation\n  toolCalls: Map<string, ToolCall>; // tool_use_id  ToolCall\n  pendingNonBlocking: Set<string>; // IDs of pending non-blocking calls\n  completedResults: Map<string, ToolResult>; // tool_use_id  ToolResult\n}\n\n// ToolContext is imported from IToolContext.ts and re-exported above\n// This eliminates the duplicate definition and ensures type consistency\n\n/**\n * Output handling hints for context management\n */\nexport interface ToolOutputHints {\n  expectedSize?: 'small' | 'medium' | 'large' | 'variable';\n  summarize?: (output: unknown) => string;\n}\n\n/**\n * Idempotency configuration for tool caching\n */\nexport interface ToolIdempotency {\n  /**\n   * @deprecated Use 'cacheable' instead. Will be removed in a future version.\n   * If true, tool is naturally idempotent (e.g., read-only) and doesn't need caching.\n   * If false, tool results should be cached based on arguments.\n   */\n  safe?: boolean;\n\n  /**\n   * If true, tool results can be cached based on arguments.\n   * Use this for tools that return deterministic results for the same inputs.\n   * Takes precedence over the deprecated 'safe' field.\n   * @default false\n   */\n  cacheable?: boolean;\n\n  keyFn?: (args: Record<string, unknown>) => string;\n  ttlMs?: number;\n}\n\n/**\n * Permission configuration for a tool\n *\n * Controls when approval is required for tool execution.\n * Used by the ToolPermissionManager.\n */\nexport interface ToolPermissionConfig {\n  /**\n   * When approval is required.\n   * - 'once' - Require approval for each call\n   * - 'session' - Approve once per session\n   * - 'always' - Auto-approve (no prompts)\n   * - 'never' - Always blocked\n   * @default 'once'\n   */\n  scope?: 'once' | 'session' | 'always' | 'never';\n\n  /**\n   * Risk level classification.\n   * @default 'low'\n   */\n  riskLevel?: 'low' | 'medium' | 'high' | 'critical';\n\n  /**\n   * Custom message shown in approval UI.\n   */\n  approvalMessage?: string;\n\n  /**\n   * Argument names that should be highlighted as sensitive.\n   */\n  sensitiveArgs?: string[];\n\n  /**\n   * TTL for session approvals (milliseconds).\n   */\n  sessionTTLMs?: number;\n}\n\n/**\n * User-provided tool function\n */\nexport interface ToolFunction<TArgs = any, TResult = any> {\n  definition: FunctionToolDefinition;\n  execute: (args: TArgs, context?: ToolContext) => Promise<TResult>;\n\n  // Extended fields for TaskAgent (optional, backward compatible)\n  idempotency?: ToolIdempotency;\n  output?: ToolOutputHints;\n\n  // Permission configuration (optional, backward compatible)\n  /** Permission settings for this tool. If not set, defaults are used. */\n  permission?: ToolPermissionConfig;\n\n  /**\n   * Dynamic description generator for the tool.\n   * If provided, this function is called when tool definitions are serialized for the LLM,\n   * allowing the description to reflect current state (e.g., available connectors).\n   *\n   * The returned string replaces definition.function.description when sending to LLM.\n   * The static description in definition.function.description serves as a fallback.\n   *\n   * @param context - Current ToolContext (includes userId, agentId, etc.)\n   * @returns The current tool description\n   *\n   * @example\n   * // Tool with dynamic connector list scoped to current user:\n   * descriptionFactory: (context) => {\n   *   const connectors = getConnectorsForUser(context?.userId);\n   *   return `Execute API calls. Available connectors: ${connectors.map(c => c.name).join(', ')}`;\n   * }\n   */\n  descriptionFactory?: (context?: ToolContext) => string;\n\n  /**\n   * Returns a human-readable description of a tool call.\n   * Used for logging, UI display, and debugging.\n   *\n   * @param args - The arguments passed to the tool\n   * @returns A concise description (e.g., \"reading /path/to/file.ts\")\n   *\n   * If not implemented, use `defaultDescribeCall()` as a fallback.\n   *\n   * @example\n   * // For read_file tool:\n   * describeCall: (args) => args.file_path\n   *\n   * @example\n   * // For bash tool:\n   * describeCall: (args) => args.command.length > 50\n   *   ? args.command.slice(0, 47) + '...'\n   *   : args.command\n   */\n  describeCall?: (args: TArgs) => string;\n}\n\n/**\n * Default implementation for describeCall.\n * Shows the first meaningful argument value.\n *\n * @param args - Tool arguments object\n * @param maxLength - Maximum length before truncation (default: 60)\n * @returns Human-readable description\n *\n * @example\n * defaultDescribeCall({ file_path: '/path/to/file.ts' })\n * // Returns: '/path/to/file.ts'\n *\n * @example\n * defaultDescribeCall({ query: 'search term', limit: 10 })\n * // Returns: 'search term'\n */\nexport function defaultDescribeCall(\n  args: Record<string, unknown>,\n  maxLength = 60\n): string {\n  if (!args || typeof args !== 'object') {\n    return '';\n  }\n\n  // Priority order for common argument names\n  const priorityKeys = [\n    'file_path', 'path', 'command', 'query', 'pattern', 'url',\n    'key', 'name', 'message', 'content', 'expression', 'prompt',\n  ];\n\n  // Try priority keys first\n  for (const key of priorityKeys) {\n    if (key in args && args[key] != null) {\n      const value = args[key];\n      const str = typeof value === 'string' ? value : JSON.stringify(value);\n      return str.length > maxLength ? str.slice(0, maxLength - 3) + '...' : str;\n    }\n  }\n\n  // Fall back to first string argument\n  for (const [, value] of Object.entries(args)) {\n    if (typeof value === 'string' && value.length > 0) {\n      return value.length > maxLength ? value.slice(0, maxLength - 3) + '...' : value;\n    }\n  }\n\n  // Fall back to first argument of any type\n  const firstEntry = Object.entries(args)[0];\n  if (firstEntry) {\n    const [key, value] = firstEntry;\n    const str = typeof value === 'string' ? value : JSON.stringify(value);\n    if (str.length > maxLength) {\n      return `${key}=${str.slice(0, maxLength - key.length - 4)}...`;\n    }\n    return `${key}=${str}`;\n  }\n\n  return '';\n}\n\n/**\n * Get a human-readable description of a tool call.\n * Uses the tool's describeCall method if available, otherwise falls back to default.\n *\n * @param tool - The tool function\n * @param args - The arguments passed to the tool\n * @returns Human-readable description\n */\nexport function getToolCallDescription<TArgs>(\n  tool: ToolFunction<TArgs>,\n  args: TArgs\n): string {\n  if (tool.describeCall) {\n    try {\n      return tool.describeCall(args);\n    } catch {\n      // Fall through to default\n    }\n  }\n  return defaultDescribeCall(args as Record<string, unknown>);\n}\n","/**\n * Execution context - tracks state, metrics, and history for agent execution\n * Includes memory safety (circular buffers) and resource limits\n */\n\nimport { AgentResponse } from '../../domain/entities/Response.js';\nimport { TextGenerateOptions } from '../../domain/interfaces/ITextProvider.js';\nimport { ToolCall, ToolResult, ToolCallState } from '../../domain/entities/Tool.js';\n\nexport type HistoryMode = 'none' | 'summary' | 'full';\n\nexport interface ExecutionContextConfig {\n  maxHistorySize?: number; // Max iterations to store (default: 10)\n  historyMode?: HistoryMode; // What to store (default: 'summary')\n  maxAuditTrailSize?: number; // Max audit entries (default: 1000)\n}\n\nexport interface IterationRecord {\n  iteration: number;\n  request: TextGenerateOptions;\n  response: AgentResponse;\n  toolCalls: ToolCall[];\n  toolResults: ToolResult[];\n  startTime: Date;\n  endTime: Date;\n}\n\nexport interface IterationSummary {\n  iteration: number;\n  tokens: number;\n  toolCount: number;\n  duration: number;\n  timestamp: Date;\n}\n\nexport interface ExecutionMetrics {\n  // Timing\n  totalDuration: number;\n  llmDuration: number;\n  toolDuration: number;\n  hookDuration: number;\n\n  // Counts\n  iterationCount: number;\n  toolCallCount: number;\n  toolSuccessCount: number;\n  toolFailureCount: number;\n  toolTimeoutCount: number;\n\n  // Tokens\n  inputTokens: number;\n  outputTokens: number;\n  totalTokens: number;\n\n  // Errors\n  errors: Array<{ type: string; message: string; timestamp: Date }>;\n}\n\nexport interface AuditEntry {\n  timestamp: Date;\n  type:\n    | 'hook_executed'\n    | 'tool_modified'\n    | 'tool_skipped'\n    | 'execution_paused'\n    | 'execution_resumed'\n    | 'tool_approved'\n    | 'tool_rejected'\n    | 'tool_blocked'\n    | 'tool_permission_approved';\n  hookName?: string;\n  toolName?: string;\n  details: any;\n}\n\nexport class ExecutionContext {\n  // Execution metadata\n  readonly executionId: string;\n  readonly startTime: Date;\n  iteration: number = 0;\n\n  // Tool tracking\n  readonly toolCalls: Map<string, ToolCall> = new Map();\n  readonly toolResults: Map<string, ToolResult> = new Map();\n\n  // Control state\n  paused: boolean = false;\n  pauseReason?: string;\n  cancelled: boolean = false;\n  cancelReason?: string;\n\n  // User data (for hooks to share state)\n  readonly metadata: Map<string, any> = new Map();\n\n  // History storage (memory-safe)\n  private readonly config: ExecutionContextConfig;\n  private readonly iterations: IterationRecord[] = [];\n  private readonly iterationSummaries: IterationSummary[] = [];\n\n  // Metrics\n  readonly metrics: ExecutionMetrics = {\n    totalDuration: 0,\n    llmDuration: 0,\n    toolDuration: 0,\n    hookDuration: 0,\n    iterationCount: 0,\n    toolCallCount: 0,\n    toolSuccessCount: 0,\n    toolFailureCount: 0,\n    toolTimeoutCount: 0,\n    inputTokens: 0,\n    outputTokens: 0,\n    totalTokens: 0,\n    errors: [],\n  };\n\n  // Audit trail\n  private readonly auditTrail: AuditEntry[] = [];\n\n  constructor(\n    executionId: string,\n    config: ExecutionContextConfig = {}\n  ) {\n    this.executionId = executionId;\n    this.startTime = new Date();\n    this.config = {\n      maxHistorySize: config.maxHistorySize || 10,\n      historyMode: config.historyMode || 'summary',\n      maxAuditTrailSize: config.maxAuditTrailSize || 1000,\n    };\n  }\n\n  /**\n   * Add iteration to history (memory-safe)\n   */\n  addIteration(record: IterationRecord): void {\n    switch (this.config.historyMode) {\n      case 'none':\n        // Don't store anything\n        break;\n\n      case 'summary':\n        // Store lightweight summary only\n        this.iterationSummaries.push({\n          iteration: record.iteration,\n          tokens: record.response.usage.total_tokens,\n          toolCount: record.toolCalls.length,\n          duration: record.endTime.getTime() - record.startTime.getTime(),\n          timestamp: record.startTime,\n        });\n\n        // Keep circular buffer\n        if (this.iterationSummaries.length > this.config.maxHistorySize!) {\n          this.iterationSummaries.shift();\n        }\n        break;\n\n      case 'full':\n        // Store full iteration data\n        this.iterations.push(record);\n\n        // Keep circular buffer\n        if (this.iterations.length > this.config.maxHistorySize!) {\n          this.iterations.shift();\n        }\n        break;\n    }\n  }\n\n  /**\n   * Get iteration history\n   */\n  getHistory(): IterationRecord[] | IterationSummary[] {\n    return this.config.historyMode === 'full' ? this.iterations : this.iterationSummaries;\n  }\n\n  /**\n   * Add audit entry\n   */\n  audit(type: AuditEntry['type'], details: any, hookName?: string, toolName?: string): void {\n    this.auditTrail.push({\n      timestamp: new Date(),\n      type,\n      hookName,\n      toolName,\n      details,\n    });\n\n    // Keep circular buffer\n    if (this.auditTrail.length > this.config.maxAuditTrailSize!) {\n      this.auditTrail.shift();\n    }\n  }\n\n  /**\n   * Get audit trail\n   */\n  getAuditTrail(): readonly AuditEntry[] {\n    return this.auditTrail;\n  }\n\n  /**\n   * Update metrics\n   */\n  updateMetrics(update: Partial<ExecutionMetrics>): void {\n    Object.assign(this.metrics, update);\n  }\n\n  /**\n   * Add tool call to tracking\n   */\n  addToolCall(toolCall: ToolCall): void {\n    this.toolCalls.set(toolCall.id, toolCall);\n    this.metrics.toolCallCount++;\n  }\n\n  /**\n   * Add tool result to tracking\n   */\n  addToolResult(result: ToolResult): void {\n    this.toolResults.set(result.tool_use_id, result);\n\n    // Update metrics\n    if (result.state === ToolCallState.COMPLETED) {\n      this.metrics.toolSuccessCount++;\n    } else if (result.state === ToolCallState.FAILED) {\n      this.metrics.toolFailureCount++;\n    } else if (result.state === ToolCallState.TIMEOUT) {\n      this.metrics.toolTimeoutCount++;\n    }\n  }\n\n  /**\n   * Check resource limits\n   */\n  checkLimits(limits?: {\n    maxExecutionTime?: number;\n    maxToolCalls?: number;\n    maxContextSize?: number;\n  }): void {\n    if (!limits) return;\n\n    // Check execution time\n    if (limits.maxExecutionTime) {\n      const elapsed = Date.now() - this.startTime.getTime();\n      if (elapsed > limits.maxExecutionTime) {\n        throw new Error(\n          `Execution time limit exceeded: ${elapsed}ms > ${limits.maxExecutionTime}ms`\n        );\n      }\n    }\n\n    // Check tool call count\n    if (limits.maxToolCalls && this.toolCalls.size > limits.maxToolCalls) {\n      throw new Error(\n        `Tool call limit exceeded: ${this.toolCalls.size} > ${limits.maxToolCalls}`\n      );\n    }\n\n    // Check context size\n    if (limits.maxContextSize) {\n      const size = this.estimateSize();\n      if (size > limits.maxContextSize) {\n        throw new Error(\n          `Context size limit exceeded: ${size} bytes > ${limits.maxContextSize} bytes`\n        );\n      }\n    }\n  }\n\n  /**\n   * Estimate memory usage (rough approximation)\n   */\n  private estimateSize(): number {\n    try {\n      const data = {\n        toolCalls: Array.from(this.toolCalls.values()),\n        toolResults: Array.from(this.toolResults.values()),\n        iterations: this.config.historyMode === 'full' ? this.iterations : this.iterationSummaries,\n        auditTrail: this.auditTrail,\n      };\n      return JSON.stringify(data).length;\n    } catch {\n      return 0; // Error estimating, return 0\n    }\n  }\n\n  /**\n   * Cleanup resources and release memory\n   * Clears all internal arrays and maps to allow garbage collection\n   */\n  cleanup(): void {\n    // Store execution summary before clearing\n    const summary = {\n      executionId: this.executionId,\n      totalIterations: this.iteration,\n      totalToolCalls: this.metrics.toolCallCount,\n      totalDuration: Date.now() - this.startTime.getTime(),\n      success: !this.cancelled && this.metrics.errors.length === 0,\n    };\n\n    // Clear all maps\n    this.toolCalls.clear();\n    this.toolResults.clear();\n    this.metadata.clear();\n\n    // Clear all arrays (modify length to allow GC of items)\n    this.iterations.length = 0;\n    this.iterationSummaries.length = 0;\n    this.auditTrail.length = 0;\n    this.metrics.errors.length = 0;\n\n    // Store summary after clearing (for final access if needed)\n    this.metadata.set('execution_summary', summary);\n  }\n\n  /**\n   * Get execution summary\n   */\n  getSummary() {\n    return {\n      executionId: this.executionId,\n      startTime: this.startTime,\n      currentIteration: this.iteration,\n      paused: this.paused,\n      cancelled: this.cancelled,\n      metrics: { ...this.metrics },\n      totalDuration: Date.now() - this.startTime.getTime(),\n    };\n  }\n}\n","/**\n * Hook manager - handles hook registration and execution\n * Includes error isolation, timeouts, and optional parallel execution\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport {\n  Hook,\n  HookConfig,\n  HookName,\n  HookSignatures,\n} from './types/HookTypes.js';\n\nexport class HookManager {\n  private hooks: Map<HookName, Hook<any, any>[]> = new Map();\n  private timeout: number;\n  private parallel: boolean;\n  // Per-hook error tracking: hookKey -> consecutive error count\n  private hookErrorCounts: Map<string, number> = new Map();\n  // Disabled hooks that exceeded error threshold\n  private disabledHooks: Set<string> = new Set();\n  private maxConsecutiveErrors: number = 3;\n  private emitter: EventEmitter;\n\n  constructor(\n    config: HookConfig = {},\n    emitter: EventEmitter,\n    errorHandling?: { maxConsecutiveErrors?: number }\n  ) {\n    this.timeout = config.hookTimeout || 5000; // 5 second default\n    this.parallel = config.parallelHooks || false;\n    this.emitter = emitter;\n    this.maxConsecutiveErrors = errorHandling?.maxConsecutiveErrors || 3;\n\n    // Register hooks from config\n    this.registerFromConfig(config);\n  }\n\n  /**\n   * Register hooks from configuration\n   */\n  private registerFromConfig(config: HookConfig): void {\n    const hookNames: HookName[] = [\n      'before:execution',\n      'after:execution',\n      'before:llm',\n      'after:llm',\n      'before:tool',\n      'after:tool',\n      'approve:tool',\n      'pause:check',\n    ];\n\n    for (const name of hookNames) {\n      const hook = config[name];\n      if (hook) {\n        this.register(name, hook);\n      }\n    }\n  }\n\n  /**\n   * Register a hook\n   */\n  register(name: HookName, hook: Hook<any, any>): void {\n    // Validate hook is a function\n    if (typeof hook !== 'function') {\n      throw new Error(`Hook must be a function, got: ${typeof hook}`);\n    }\n\n    // Get or create hooks array\n    if (!this.hooks.has(name)) {\n      this.hooks.set(name, []);\n    }\n\n    const existing = this.hooks.get(name)!;\n\n    // Limit number of hooks per name\n    if (existing.length >= 10) {\n      throw new Error(`Too many hooks for ${name} (max: 10)`);\n    }\n\n    existing.push(hook);\n  }\n\n  /**\n   * Unregister a specific hook function by reference.\n   * Returns true if the hook was found and removed.\n   */\n  unregister(name: HookName, hook: Hook<any, any>): boolean {\n    const hooks = this.hooks.get(name);\n    if (!hooks) return false;\n\n    const index = hooks.indexOf(hook);\n    if (index === -1) return false;\n\n    hooks.splice(index, 1);\n    return true;\n  }\n\n  /**\n   * Execute hooks for a given name\n   */\n  async executeHooks<K extends HookName>(\n    name: K,\n    context: HookSignatures[K]['context'],\n    defaultResult: HookSignatures[K]['result']\n  ): Promise<HookSignatures[K]['result']> {\n    const hooks = this.hooks.get(name);\n\n    if (!hooks || hooks.length === 0) {\n      return defaultResult;\n    }\n\n    // Parallel execution (for independent hooks)\n    if (this.parallel && hooks.length > 1) {\n      return this.executeHooksParallel(hooks, context, defaultResult);\n    }\n\n    // Sequential execution (default)\n    return this.executeHooksSequential(hooks, context, defaultResult);\n  }\n\n  /**\n   * Execute hooks sequentially\n   */\n  private async executeHooksSequential<T>(\n    hooks: Hook<any, any>[],\n    context: any,\n    defaultResult: T\n  ): Promise<T> {\n    let result = defaultResult;\n\n    for (let i = 0; i < hooks.length; i++) {\n      const hook = hooks[i]!;\n      const hookKey = this.getHookKey(hook, i);\n      const hookResult = await this.executeHookSafely(hook, context, hookKey);\n\n      // Skip failed hooks (loose equality catches both null and undefined)\n      if (hookResult == null) {\n        continue;\n      }\n\n      // Merge hook result\n      result = { ...result, ...hookResult };\n\n      // Check for early exit\n      if ((hookResult as any).skip === true) {\n        break;\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Execute hooks in parallel\n   */\n  private async executeHooksParallel<T>(\n    hooks: Hook<any, any>[],\n    context: any,\n    defaultResult: T\n  ): Promise<T> {\n    // Execute all hooks concurrently with unique keys\n    const results = await Promise.all(\n      hooks.map((hook, i) => {\n        const hookKey = this.getHookKey(hook, i);\n        return this.executeHookSafely(hook, context, hookKey);\n      })\n    );\n\n    // Filter out failures and merge results\n    const validResults = results.filter((r) => r != null);\n\n    return validResults.reduce(\n      (acc, hookResult) => ({ ...acc, ...hookResult }),\n      defaultResult\n    );\n  }\n\n  /**\n   * Generate unique key for a hook\n   */\n  private getHookKey(hook: Hook<any, any>, index: number): string {\n    return `${hook.name || 'anonymous'}_${index}`;\n  }\n\n  /**\n   * Execute single hook with error isolation and timeout (with per-hook error tracking)\n   */\n  private async executeHookSafely<T>(\n    hook: Hook<any, any>,\n    context: any,\n    hookKey?: string\n  ): Promise<T | null> {\n    const key = hookKey || hook.name || 'anonymous';\n\n    // Skip disabled hooks\n    if (this.disabledHooks.has(key)) {\n      return null;\n    }\n\n    const startTime = Date.now();\n\n    try {\n      // Execute with timeout\n      const result = await Promise.race([\n        hook(context),\n        new Promise<never>((_, reject) =>\n          setTimeout(() => reject(new Error('Hook timeout')), this.timeout)\n        ),\n      ]);\n\n      // Reset error counter for this hook on success\n      this.hookErrorCounts.delete(key);\n\n      // Track timing\n      const duration = Date.now() - startTime;\n      if (context.context?.updateMetrics) {\n        context.context.updateMetrics({\n          hookDuration: (context.context.metrics.hookDuration || 0) + duration,\n        });\n      }\n\n      return result as T;\n    } catch (error) {\n      // Increment error counter for this specific hook\n      const errorCount = (this.hookErrorCounts.get(key) || 0) + 1;\n      this.hookErrorCounts.set(key, errorCount);\n\n      // Emit error event\n      this.emitter.emit('hook:error', {\n        executionId: context.executionId,\n        hookName: hook.name || 'anonymous',\n        error: error as Error,\n        consecutiveErrors: errorCount,\n        timestamp: new Date(),\n      });\n\n      // Check consecutive error threshold for this hook\n      if (errorCount >= this.maxConsecutiveErrors) {\n        // Disable this specific hook, not all hooks\n        this.disabledHooks.add(key);\n        console.warn(\n          `Hook \"${key}\" disabled after ${errorCount} consecutive failures. Last error: ${(error as Error).message}`\n        );\n      } else {\n        // Log warning but continue (degraded mode)\n        console.warn(\n          `Hook execution failed (${key}): ${(error as Error).message} (${errorCount}/${this.maxConsecutiveErrors} errors)`\n        );\n      }\n\n      return null; // Hook failed, skip its result\n    }\n  }\n\n  /**\n   * Check if there are any hooks registered\n   */\n  hasHooks(name: HookName): boolean {\n    const hooks = this.hooks.get(name);\n    return !!hooks && hooks.length > 0;\n  }\n\n  /**\n   * Get hook count\n   */\n  getHookCount(name?: HookName): number {\n    if (name) {\n      return this.hooks.get(name)?.length || 0;\n    }\n    // Total across all hooks\n    return Array.from(this.hooks.values()).reduce((sum, arr) => sum + arr.length, 0);\n  }\n\n  /**\n   * Clear all hooks and reset error tracking\n   */\n  clear(): void {\n    this.hooks.clear();\n    this.hookErrorCounts.clear();\n    this.disabledHooks.clear();\n  }\n\n  /**\n   * Re-enable a disabled hook\n   */\n  enableHook(hookKey: string): void {\n    this.disabledHooks.delete(hookKey);\n    this.hookErrorCounts.delete(hookKey);\n  }\n\n  /**\n   * Get list of disabled hooks\n   */\n  getDisabledHooks(): string[] {\n    return Array.from(this.disabledHooks);\n  }\n}\n","/**\n * StreamState - Accumulates streaming events to reconstruct complete response\n */\n\nimport { TokenUsage } from './Response.js';\nimport { ToolCall } from './Tool.js';\n\n/**\n * Buffer for accumulating tool call arguments\n */\nexport interface ToolCallBuffer {\n  toolName: string;\n  argumentChunks: string[];\n  isComplete: boolean;\n  startTime: Date;\n}\n\n/**\n * StreamState tracks all accumulated data during streaming\n */\nexport class StreamState {\n  // Core identifiers\n  public responseId: string;\n  public model: string;\n  public createdAt: number;\n\n  // Text accumulation: item_id -> text chunks\n  private textBuffers: Map<string, string[]>;\n\n  // Reasoning accumulation: item_id -> reasoning chunks\n  private reasoningBuffers: Map<string, string[]>;\n\n  // Tool call accumulation: tool_call_id -> buffer\n  private toolCallBuffers: Map<string, ToolCallBuffer>;\n\n  // Completed tool calls\n  private completedToolCalls: ToolCall[];\n\n  // Tool execution results\n  private toolResults: Map<string, any>;\n\n  // Metadata\n  public currentIteration: number;\n  public usage: TokenUsage;\n  public status: 'in_progress' | 'completed' | 'incomplete' | 'failed';\n  public startTime: Date;\n  public endTime?: Date;\n\n  // Statistics\n  public totalChunks: number;\n  public totalTextDeltas: number;\n  public totalToolCalls: number;\n\n  constructor(responseId: string, model: string, createdAt?: number) {\n    this.responseId = responseId;\n    this.model = model;\n    this.createdAt = createdAt || Date.now();\n\n    this.textBuffers = new Map();\n    this.reasoningBuffers = new Map();\n    this.toolCallBuffers = new Map();\n    this.completedToolCalls = [];\n    this.toolResults = new Map();\n\n    this.currentIteration = 0;\n    this.usage = {\n      input_tokens: 0,\n      output_tokens: 0,\n      total_tokens: 0,\n    };\n    this.status = 'in_progress';\n    this.startTime = new Date();\n\n    this.totalChunks = 0;\n    this.totalTextDeltas = 0;\n    this.totalToolCalls = 0;\n  }\n\n  /**\n   * Accumulate text delta for a specific item\n   */\n  accumulateTextDelta(itemId: string, delta: string): void {\n    if (!this.textBuffers.has(itemId)) {\n      this.textBuffers.set(itemId, []);\n    }\n    this.textBuffers.get(itemId)!.push(delta);\n    this.totalTextDeltas++;\n    this.totalChunks++;\n  }\n\n  /**\n   * Get complete accumulated text for an item\n   */\n  getCompleteText(itemId: string): string {\n    const chunks = this.textBuffers.get(itemId);\n    return chunks ? chunks.join('') : '';\n  }\n\n  /**\n   * Get all accumulated text (all items concatenated)\n   */\n  getAllText(): string {\n    const allText: string[] = [];\n    for (const chunks of this.textBuffers.values()) {\n      allText.push(chunks.join(''));\n    }\n    return allText.join('');\n  }\n\n  /**\n   * Accumulate reasoning delta for a specific item\n   */\n  accumulateReasoningDelta(itemId: string, delta: string): void {\n    if (!this.reasoningBuffers.has(itemId)) {\n      this.reasoningBuffers.set(itemId, []);\n    }\n    this.reasoningBuffers.get(itemId)!.push(delta);\n    this.totalChunks++;\n  }\n\n  /**\n   * Get complete accumulated reasoning for an item\n   */\n  getCompleteReasoning(itemId: string): string {\n    const chunks = this.reasoningBuffers.get(itemId);\n    return chunks ? chunks.join('') : '';\n  }\n\n  /**\n   * Get all accumulated reasoning (all items concatenated)\n   */\n  getAllReasoning(): string {\n    const allReasoning: string[] = [];\n    for (const chunks of this.reasoningBuffers.values()) {\n      allReasoning.push(chunks.join(''));\n    }\n    return allReasoning.join('');\n  }\n\n  /**\n   * Check if stream has any accumulated reasoning\n   */\n  hasReasoning(): boolean {\n    return this.reasoningBuffers.size > 0;\n  }\n\n  /**\n   * Start accumulating tool call arguments\n   */\n  startToolCall(toolCallId: string, toolName: string): void {\n    this.toolCallBuffers.set(toolCallId, {\n      toolName,\n      argumentChunks: [],\n      isComplete: false,\n      startTime: new Date(),\n    });\n  }\n\n  /**\n   * Accumulate tool argument delta\n   */\n  accumulateToolArguments(toolCallId: string, delta: string): void {\n    const buffer = this.toolCallBuffers.get(toolCallId);\n    if (!buffer) {\n      throw new Error(`Tool call buffer not found for id: ${toolCallId}`);\n    }\n    buffer.argumentChunks.push(delta);\n    this.totalChunks++;\n  }\n\n  /**\n   * Mark tool call arguments as complete\n   */\n  completeToolCall(toolCallId: string): void {\n    const buffer = this.toolCallBuffers.get(toolCallId);\n    if (!buffer) {\n      throw new Error(`Tool call buffer not found for id: ${toolCallId}`);\n    }\n    buffer.isComplete = true;\n    this.totalToolCalls++;\n  }\n\n  /**\n   * Get complete tool arguments (joined chunks)\n   */\n  getCompleteToolArguments(toolCallId: string): string {\n    const buffer = this.toolCallBuffers.get(toolCallId);\n    if (!buffer) {\n      throw new Error(`Tool call buffer not found for id: ${toolCallId}`);\n    }\n    return buffer.argumentChunks.join('');\n  }\n\n  /**\n   * Check if tool call is complete\n   */\n  isToolCallComplete(toolCallId: string): boolean {\n    const buffer = this.toolCallBuffers.get(toolCallId);\n    return buffer ? buffer.isComplete : false;\n  }\n\n  /**\n   * Get tool name for a tool call\n   */\n  getToolName(toolCallId: string): string | undefined {\n    return this.toolCallBuffers.get(toolCallId)?.toolName;\n  }\n\n  /**\n   * Add completed tool call\n   */\n  addCompletedToolCall(toolCall: ToolCall): void {\n    this.completedToolCalls.push(toolCall);\n  }\n\n  /**\n   * Get all completed tool calls\n   */\n  getCompletedToolCalls(): ToolCall[] {\n    return [...this.completedToolCalls];\n  }\n\n  /**\n   * Store tool execution result\n   */\n  setToolResult(toolCallId: string, result: any): void {\n    this.toolResults.set(toolCallId, result);\n  }\n\n  /**\n   * Get tool execution result\n   */\n  getToolResult(toolCallId: string): any {\n    return this.toolResults.get(toolCallId);\n  }\n\n  /**\n   * Update token usage (replaces values, doesn't accumulate)\n   */\n  updateUsage(usage: Partial<TokenUsage>): void {\n    if (usage.input_tokens !== undefined) {\n      this.usage.input_tokens = usage.input_tokens;\n    }\n    if (usage.output_tokens !== undefined) {\n      this.usage.output_tokens = usage.output_tokens;\n    }\n    if (usage.total_tokens !== undefined) {\n      this.usage.total_tokens = usage.total_tokens;\n    } else {\n      // Calculate total if not provided\n      this.usage.total_tokens = this.usage.input_tokens + this.usage.output_tokens;\n    }\n  }\n\n  /**\n   * Accumulate token usage (adds to existing values)\n   */\n  accumulateUsage(usage: Partial<TokenUsage>): void {\n    if (usage.input_tokens !== undefined) {\n      this.usage.input_tokens += usage.input_tokens;\n    }\n    if (usage.output_tokens !== undefined) {\n      this.usage.output_tokens += usage.output_tokens;\n    }\n    if (usage.total_tokens !== undefined) {\n      this.usage.total_tokens += usage.total_tokens;\n    } else {\n      // Recalculate total\n      this.usage.total_tokens = this.usage.input_tokens + this.usage.output_tokens;\n    }\n  }\n\n  /**\n   * Mark stream as complete\n   */\n  markComplete(status: 'completed' | 'incomplete' | 'failed' = 'completed'): void {\n    this.status = status;\n    this.endTime = new Date();\n  }\n\n  /**\n   * Get duration in milliseconds\n   */\n  getDuration(): number {\n    const end = this.endTime || new Date();\n    return end.getTime() - this.startTime.getTime();\n  }\n\n  /**\n   * Increment iteration counter\n   */\n  incrementIteration(): void {\n    this.currentIteration++;\n  }\n\n  /**\n   * Get summary statistics\n   */\n  getStatistics() {\n    return {\n      responseId: this.responseId,\n      model: this.model,\n      status: this.status,\n      iterations: this.currentIteration,\n      totalChunks: this.totalChunks,\n      totalTextDeltas: this.totalTextDeltas,\n      totalToolCalls: this.totalToolCalls,\n      textItemsCount: this.textBuffers.size,\n      toolCallBuffersCount: this.toolCallBuffers.size,\n      completedToolCallsCount: this.completedToolCalls.length,\n      durationMs: this.getDuration(),\n      usage: { ...this.usage },\n    };\n  }\n\n  /**\n   * Check if stream has any accumulated text\n   */\n  hasText(): boolean {\n    return this.textBuffers.size > 0;\n  }\n\n  /**\n   * Check if stream has any tool calls\n   */\n  hasToolCalls(): boolean {\n    return this.toolCallBuffers.size > 0;\n  }\n\n  /**\n   * Clear all buffers (for memory management)\n   */\n  clear(): void {\n    this.textBuffers.clear();\n    this.reasoningBuffers.clear();\n    this.toolCallBuffers.clear();\n    this.completedToolCalls = [];\n    this.toolResults.clear();\n  }\n\n  /**\n   * Create a snapshot for checkpointing (error recovery)\n   */\n  createSnapshot() {\n    return {\n      responseId: this.responseId,\n      model: this.model,\n      createdAt: this.createdAt,\n      textBuffers: new Map(this.textBuffers),\n      reasoningBuffers: new Map(this.reasoningBuffers),\n      toolCallBuffers: new Map(this.toolCallBuffers),\n      completedToolCalls: [...this.completedToolCalls],\n      toolResults: new Map(this.toolResults),\n      currentIteration: this.currentIteration,\n      usage: { ...this.usage },\n      status: this.status,\n      startTime: this.startTime,\n      endTime: this.endTime,\n    };\n  }\n}\n","/**\n * Interface for objects that manage resources and need explicit cleanup.\n *\n * Implementing classes should release all resources (event listeners, timers,\n * connections, etc.) when destroy() is called. After destruction, the instance\n * should not be used.\n */\n\nexport interface IDisposable {\n  /**\n   * Releases all resources held by this instance.\n   *\n   * After calling destroy():\n   * - All event listeners should be removed\n   * - All timers/intervals should be cleared\n   * - All internal state should be cleaned up\n   * - The instance should not be reused\n   *\n   * Multiple calls to destroy() should be safe (idempotent).\n   */\n  destroy(): void;\n\n  /**\n   * Returns true if destroy() has been called.\n   * Methods should check this before performing operations.\n   */\n  readonly isDestroyed: boolean;\n}\n\n/**\n * Async version of IDisposable for resources requiring async cleanup.\n */\nexport interface IAsyncDisposable {\n  /**\n   * Asynchronously releases all resources held by this instance.\n   */\n  destroy(): Promise<void>;\n\n  /**\n   * Returns true if destroy() has been called.\n   */\n  readonly isDestroyed: boolean;\n}\n\n/**\n * Helper to check if an object is destroyed and throw if so.\n * @param obj - The disposable object to check\n * @param operation - Name of the operation being attempted\n */\nexport function assertNotDestroyed(obj: IDisposable | IAsyncDisposable, operation: string): void {\n  if (obj.isDestroyed) {\n    throw new Error(`Cannot ${operation}: instance has been destroyed`);\n  }\n}\n","/**\n * Agent - AI assistant bound to a Connector\n *\n * This is the main public API for creating and using agents.\n * Extends BaseAgent for shared functionality.\n *\n * The agentic loop (tool calling, iterations) is implemented directly\n * in this class for clarity and simplicity.\n */\n\nimport { randomUUID } from 'crypto';\nimport { BaseAgent, BaseAgentConfig, BaseSessionConfig } from './BaseAgent.js';\nimport { ExecutionContext, HistoryMode } from '../capabilities/agents/ExecutionContext.js';\nimport { HookManager } from '../capabilities/agents/HookManager.js';\nimport { InputItem, MessageRole, OutputItem } from '../domain/entities/Message.js';\nimport { AgentResponse } from '../domain/entities/Response.js';\nimport { StreamEvent, StreamEventType, isToolCallArgumentsDone, isReasoningDelta } from '../domain/entities/StreamEvent.js';\nimport { StreamState } from '../domain/entities/StreamState.js';\nimport { Tool, ToolCall, ToolCallState, ToolResult } from '../domain/entities/Tool.js';\nimport { Content, ContentType } from '../domain/entities/Content.js';\nimport { ToolTimeoutError } from '../domain/errors/AIErrors.js';\nimport type { HookConfig, HookName } from '../capabilities/agents/types/HookTypes.js';\nimport { AgentEvents } from '../capabilities/agents/types/EventTypes.js';\nimport { IDisposable, assertNotDestroyed } from '../domain/interfaces/IDisposable.js';\nimport { TextGenerateOptions } from '../domain/interfaces/ITextProvider.js';\nimport { Vendor } from './Vendor.js';\nimport type { IContextStorage } from '../domain/interfaces/IContextStorage.js';\nimport type { PermissionCheckContext } from './permissions/types.js';\nimport { metrics } from '../infrastructure/observability/Metrics.js';\nimport { AGENT_DEFAULTS } from './constants.js';\nimport { AgentContextNextGen } from './context-nextgen/AgentContextNextGen.js';\nimport type { AgentContextNextGenConfig, ContextFeatures } from './context-nextgen/types.js';\nimport type {\n  IAgentDefinitionStorage,\n  StoredAgentDefinition,\n  AgentDefinitionMetadata,\n} from '../domain/interfaces/IAgentDefinitionStorage.js';\nimport { StorageRegistry } from './StorageRegistry.js';\n\n/**\n * Session configuration for Agent (same as BaseSessionConfig)\n */\nexport type AgentSessionConfig = BaseSessionConfig;\n\n/**\n * Agent configuration - extends BaseAgentConfig with Agent-specific options\n */\nexport interface AgentConfig extends BaseAgentConfig {\n  /** System instructions for the agent */\n  instructions?: string;\n\n  /** Temperature for generation */\n  temperature?: number;\n\n  /** Maximum iterations for tool calling loop */\n  maxIterations?: number;\n\n  /** Vendor-agnostic thinking/reasoning configuration */\n  thinking?: {\n    enabled: boolean;\n    /** Budget in tokens for thinking (Anthropic & Google) */\n    budgetTokens?: number;\n    /** Reasoning effort level (OpenAI) */\n    effort?: 'low' | 'medium' | 'high';\n  };\n\n  /** Vendor-specific options (e.g., Google's thinkingLevel: 'low' | 'high') */\n  vendorOptions?: Record<string, unknown>;\n\n  /**\n   * Optional unified context management.\n   * When provided (as AgentContextNextGen instance or config), Agent will:\n   * - Track conversation history\n   * - Provide unified memory access\n   * - Support session persistence via context\n   *\n   * Pass an AgentContextNextGen instance or AgentContextNextGenConfig to enable.\n   */\n  context?: AgentContextNextGen | AgentContextNextGenConfig;\n\n  /**\n   * Hard timeout in milliseconds for any single tool execution.\n   * Acts as a safety net: if a tool's own timeout mechanism fails\n   * (e.g. a spawned child process doesn't exit), this will force-resolve\n   * with an error. Default: 0 (disabled - relies on each tool's own timeout).\n   *\n   * Example: `toolExecutionTimeout: 300000` (5 minutes hard cap per tool call)\n   */\n  toolExecutionTimeout?: number;\n\n  /**\n   * @deprecated Use `toolExecutionTimeout` instead.\n   */\n  toolTimeout?: number;\n\n  // Enterprise features\n  hooks?: HookConfig;\n  historyMode?: HistoryMode;\n  limits?: {\n    maxExecutionTime?: number;\n    maxToolCalls?: number;\n    maxContextSize?: number;\n    maxInputMessages?: number;\n  };\n  errorHandling?: {\n    hookFailureMode?: 'fail' | 'warn' | 'ignore';\n    toolFailureMode?: 'fail' | 'continue';\n    maxConsecutiveErrors?: number;\n  };\n}\n\n/**\n * Execution setup information returned by _prepareExecution()\n */\ninterface ExecutionSetup {\n  executionId: string;\n  startTime: number;\n  maxIterations: number;\n}\n\n/**\n * Result of iteration precondition checks\n */\ninterface IterationPreconditionResult {\n  shouldExit: boolean;\n  exitReason?: 'cancelled' | 'paused';\n}\n\n/**\n * Agent class - represents an AI assistant with tool calling capabilities\n *\n * Extends BaseAgent to inherit:\n * - Connector resolution\n * - Provider initialization\n * - Tool manager initialization\n * - Permission manager initialization\n * - Session management\n * - Lifecycle/cleanup\n */\nexport class Agent extends BaseAgent<AgentConfig, AgentEvents> implements IDisposable {\n  // ===== Agent-specific State =====\n  private hookManager: HookManager;\n  private executionContext: ExecutionContext | null = null;\n\n  // Pause/resume/cancel state\n  private _paused = false;\n  private _cancelled = false;\n  private _pausePromise: Promise<void> | null = null;\n  private _resumeCallback: (() => void) | null = null;\n  private _pauseResumeMutex: Promise<void> = Promise.resolve();\n\n  // ===== Static Factory =====\n\n  /**\n   * Create a new agent\n   *\n   * @example\n   * ```typescript\n   * const agent = Agent.create({\n   *   connector: 'openai',  // or Connector instance\n   *   model: 'gpt-4',\n   *   userId: 'user-123',   // flows to all tool executions automatically\n   *   instructions: 'You are a helpful assistant',\n   *   tools: [myTool]\n   * });\n   * ```\n   */\n  static create(config: AgentConfig): Agent {\n    return new Agent(config);\n  }\n\n  /**\n   * Resume an agent from a saved session\n   *\n   * @example\n   * ```typescript\n   * const agent = await Agent.resume('session-123', {\n   *   connector: 'openai',\n   *   model: 'gpt-4',\n   *   session: { storage: myStorage }\n   * });\n   * ```\n   */\n  static async resume(\n    sessionId: string,\n    config: Omit<AgentConfig, 'session'> & { session: { storage: IContextStorage } }\n  ): Promise<Agent> {\n    const agent = new Agent({\n      ...config,\n      session: {\n        ...config.session,\n        id: sessionId,\n      },\n    });\n\n    // Wait for session to load\n    await agent.ensureSessionLoaded();\n\n    return agent;\n  }\n\n  /**\n   * Create an agent from a stored definition\n   *\n   * Loads agent configuration from storage and creates a new Agent instance.\n   * The connector must be registered at runtime before calling this method.\n   *\n   * @param agentId - Agent identifier to load\n   * @param storage - Storage backend to load from\n   * @param overrides - Optional config overrides\n   * @returns Agent instance, or null if not found\n   */\n  static async fromStorage(\n    agentId: string,\n    storage?: IAgentDefinitionStorage,\n    overrides?: Partial<AgentConfig>\n  ): Promise<Agent | null> {\n    const s = storage ?? StorageRegistry.get('agentDefinitions');\n    if (!s) {\n      throw new Error('No storage provided and no agentDefinitions configured in StorageRegistry');\n    }\n    const definition = await s.load(agentId);\n    if (!definition) {\n      return null;\n    }\n\n    // Build config from definition\n    const contextConfig: AgentContextNextGenConfig = {\n      model: definition.connector.model,\n      agentId: definition.agentId,\n      systemPrompt: definition.systemPrompt ?? definition.instructions,\n    };\n    if (definition.features) {\n      contextConfig.features = definition.features as ContextFeatures;\n    }\n\n    const config: AgentConfig = {\n      connector: definition.connector.name,\n      model: definition.connector.model,\n      instructions: definition.systemPrompt,\n      context: contextConfig,\n      ...definition.typeConfig,\n      ...overrides,\n    };\n\n    return new Agent(config);\n  }\n\n  // ===== Constructor =====\n\n  private constructor(config: AgentConfig) {\n    super(config, 'Agent');\n\n    this._logger.debug({ model: this.model, connector: this.connector.name }, 'Agent created');\n    metrics.increment('agent.created', 1, {\n      model: this.model,\n      connector: this.connector.name,\n    });\n\n    // Provider is inherited from BaseAgent (this._provider)\n\n    // Set system prompt on inherited AgentContext if instructions provided\n    if (config.instructions) {\n      this._agentContext.systemPrompt = config.instructions;\n      this._hasExplicitInstructions = true;\n    }\n\n    // Sync tool permission configs from ToolManager (via AgentContext) to PermissionManager\n    this._agentContext.tools.on('tool:registered', ({ name }) => {\n      const permission = this._agentContext.tools.getPermission(name);\n      if (permission) {\n        this._permissionManager.setToolConfig(name, permission);\n      }\n    });\n\n    // Create hook manager\n    this.hookManager = new HookManager(\n      config.hooks || {},\n      this,\n      config.errorHandling\n    );\n\n    // Wire up beforeCompaction callback to invoke lifecycle hooks\n    this._agentContext.setBeforeCompactionCallback(async (info) => {\n      // Build BeforeCompactionContext for lifecycle hook\n      const status = info.budget.utilizationPercent >= 90 ? 'critical'\n        : info.budget.utilizationPercent >= 70 ? 'warning'\n        : 'ok';\n\n      // Build components list from plugins\n      const components: Array<{ name: string; priority: number; compactable: boolean }> = [];\n      for (const plugin of this._agentContext.getPlugins()) {\n        const order: Record<string, number> = {\n          'in_context_memory': 1,\n          'working_memory': 2,\n        };\n        components.push({\n          name: plugin.name,\n          priority: order[plugin.name] ?? 10,\n          compactable: plugin.isCompactable(),\n        });\n      }\n\n      await this.invokeBeforeCompaction({\n        agentId: this.name,\n        currentBudget: {\n          total: info.budget.maxTokens,\n          used: info.budget.totalUsed,\n          available: info.budget.available,\n          utilizationPercent: info.budget.utilizationPercent,\n          status,\n        },\n        strategy: info.strategy,\n        components,\n        estimatedTokensToFree: info.targetTokensToFree,\n      });\n    });\n\n    // Initialize session (from BaseAgent)\n    this.initializeSession(config.session);\n  }\n\n  // ===== Abstract Method Implementations =====\n\n  protected getAgentType(): 'agent' | 'task-agent' | 'universal-agent' {\n    return 'agent';\n  }\n\n  // ===== Context Access =====\n\n  // Note: `context` getter is inherited from BaseAgent (returns _agentContext)\n\n  /**\n   * Check if context management is enabled.\n   * Always returns true since AgentContext is always created by BaseAgent.\n   */\n  hasContext(): boolean {\n    return true;\n  }\n\n  // getContextState() and restoreContextState() are inherited from BaseAgent\n\n  // ===== Shared Execution Helpers =====\n\n  /**\n   * Prepare execution - shared setup for run() and stream()\n   */\n  private async _prepareExecution(\n    input: string | InputItem[],\n    methodName: 'run' | 'stream'\n  ): Promise<ExecutionSetup> {\n    assertNotDestroyed(this, `${methodName} agent`);\n\n    // Ensure any pending session load is complete\n    await this.ensureSessionLoaded();\n\n    const inputPreview = typeof input === 'string'\n      ? input.substring(0, 100)\n      : `${input.length} messages`;\n\n    this._logger.info({ inputPreview, toolCount: this._config.tools?.length || 0 }, `Agent ${methodName} started`);\n    metrics.increment(`agent.${methodName}.started`, 1, { model: this.model, connector: this.connector.name });\n\n    const startTime = Date.now();\n\n    // Set current input for task type detection\n    const userContent = typeof input === 'string'\n      ? input\n      : input.map(i => JSON.stringify(i)).join('\\n');\n    this._agentContext.setCurrentInput(userContent);\n\n    // Generate execution ID and create execution context\n    const executionId = `exec_${randomUUID()}`;\n    this.executionContext = new ExecutionContext(executionId, {\n      maxHistorySize: 10,\n      historyMode: this._config.historyMode || 'summary',\n      maxAuditTrailSize: 1000,\n    });\n\n    // Reset control state\n    this._paused = false;\n    this._cancelled = false;\n    if (methodName === 'stream') {\n      this._pausePromise = null;\n      this._resumeCallback = null;\n    }\n\n    // Add user message to AgentContext\n    if (typeof input === 'string') {\n      this._agentContext.addUserMessage(input);\n    } else {\n      this._agentContext.addInputItems(input);\n    }\n\n    // Emit execution start\n    this.emit('execution:start', {\n      executionId,\n      config: { model: this.model, maxIterations: this._config.maxIterations || 10 },\n      timestamp: new Date(),\n    });\n\n    // Execute before:execution hook\n    await this.hookManager.executeHooks('before:execution', {\n      executionId,\n      config: { model: this.model },\n      timestamp: new Date(),\n    }, undefined);\n\n    return {\n      executionId,\n      startTime,\n      maxIterations: this._config.maxIterations || AGENT_DEFAULTS.MAX_ITERATIONS,\n    };\n  }\n\n  /**\n   * Check iteration preconditions - pause, cancel, limits, hooks\n   */\n  private async _checkIterationPreconditions(\n    executionId: string,\n    iteration: number\n  ): Promise<IterationPreconditionResult> {\n    // Check pause\n    await this.checkPause();\n\n    // Check if cancelled\n    if (this._cancelled) {\n      return { shouldExit: true, exitReason: 'cancelled' };\n    }\n\n    // Check resource limits\n    if (this.executionContext) {\n      this.executionContext.checkLimits(this._config.limits);\n    }\n\n    // Check pause hook\n    const pauseCheck = await this.hookManager.executeHooks('pause:check', {\n      executionId,\n      iteration,\n      context: this.executionContext!,\n      timestamp: new Date(),\n    }, { shouldPause: false });\n\n    if (pauseCheck.shouldPause) {\n      this.pause(pauseCheck.reason || 'Hook requested pause');\n      await this.checkPause();\n    }\n\n    // Update iteration\n    if (this.executionContext) {\n      this.executionContext.iteration = iteration;\n    }\n\n    // Emit iteration start\n    this.emit('iteration:start', { executionId, iteration, timestamp: new Date() });\n\n    return { shouldExit: false };\n  }\n\n  /**\n   * Record iteration metrics and store iteration record\n   */\n  private _recordIterationMetrics(\n    iteration: number,\n    iterationStartTime: number,\n    response: AgentResponse,\n    toolCalls: ToolCall[],\n    toolResults: ToolResult[],\n    prepared: { input: InputItem[] }\n  ): void {\n    if (!this.executionContext) return;\n\n    // Store iteration record\n    this.executionContext.addIteration({\n      iteration,\n      request: {\n        model: this.model,\n        input: prepared.input,\n        instructions: this._config.instructions,\n        tools: this.getEnabledToolDefinitions(),\n        temperature: this._config.temperature,\n      },\n      response,\n      toolCalls,\n      toolResults,\n      startTime: new Date(iterationStartTime),\n      endTime: new Date(),\n    });\n\n    // Update metrics\n    this.executionContext.updateMetrics({\n      iterationCount: iteration + 1,\n      inputTokens: this.executionContext.metrics.inputTokens + (response.usage?.input_tokens || 0),\n      outputTokens: this.executionContext.metrics.outputTokens + (response.usage?.output_tokens || 0),\n      totalTokens: this.executionContext.metrics.totalTokens + (response.usage?.total_tokens || 0),\n    });\n  }\n\n  /**\n   * Finalize successful execution - hooks, events, metrics\n   */\n  private async _finalizeExecution(\n    executionId: string,\n    startTime: number,\n    response: AgentResponse,\n    methodName: 'run' | 'stream'\n  ): Promise<void> {\n    // Calculate total duration\n    const totalDuration = this.executionContext\n      ? Date.now() - this.executionContext.startTime.getTime()\n      : Date.now() - startTime;\n\n    if (this.executionContext) {\n      this.executionContext.updateMetrics({ totalDuration });\n    }\n\n    // Execute after:execution hook\n    await this.hookManager.executeHooks('after:execution', {\n      executionId,\n      response,\n      context: this.executionContext!,\n      timestamp: new Date(),\n      duration: totalDuration,\n    }, undefined);\n\n    // Emit execution complete\n    this.emit('execution:complete', {\n      executionId,\n      response,\n      timestamp: new Date(),\n      duration: totalDuration,\n    });\n\n    const duration = Date.now() - startTime;\n    this._logger.info({ duration }, `Agent ${methodName} completed`);\n    metrics.timing(`agent.${methodName}.duration`, duration, { model: this.model, connector: this.connector.name });\n    metrics.increment(`agent.${methodName}.completed`, 1, { model: this.model, connector: this.connector.name, status: 'success' });\n  }\n\n  /**\n   * Handle execution error - events, metrics, logging\n   */\n  private _handleExecutionError(\n    executionId: string,\n    error: Error,\n    startTime: number,\n    methodName: 'run' | 'stream'\n  ): void {\n    // Emit execution error\n    this.emit('execution:error', { executionId, error, timestamp: new Date() });\n\n    // Record error in metrics\n    this.executionContext?.metrics.errors.push({\n      type: 'execution_error',\n      message: error.message,\n      timestamp: new Date(),\n    });\n\n    const duration = Date.now() - startTime;\n    this._logger.error({ error: error.message, duration }, `Agent ${methodName} failed`);\n    metrics.increment(`agent.${methodName}.completed`, 1, { model: this.model, connector: this.connector.name, status: 'error' });\n  }\n\n  /**\n   * Cleanup execution resources\n   */\n  private _cleanupExecution(streamState?: StreamState): void {\n    streamState?.clear();\n    this.executionContext?.cleanup();\n  }\n\n  /**\n   * Emit iteration complete event (helper for run loop)\n   */\n  private _emitIterationComplete(\n    executionId: string,\n    iteration: number,\n    response: AgentResponse,\n    iterationStartTime: number\n  ): void {\n    this.emit('iteration:complete', {\n      executionId,\n      iteration,\n      response,\n      timestamp: new Date(),\n      duration: Date.now() - iterationStartTime,\n    });\n  }\n\n  // ===== Main API =====\n\n  /**\n   * Run the agent with input\n   */\n  async run(input: string | InputItem[]): Promise<AgentResponse> {\n    const { executionId, startTime, maxIterations } = await this._prepareExecution(input, 'run');\n\n    let iteration = 0;\n    let finalResponse: AgentResponse | null = null;\n\n    try {\n      while (iteration < maxIterations) {\n        const { shouldExit } = await this._checkIterationPreconditions(executionId, iteration);\n        if (shouldExit) {\n          throw new Error('Execution cancelled');\n        }\n\n        const iterationStartTime = Date.now();\n\n        // Prepare context (handles compaction)\n        // Note: instructions are set in systemPrompt during context creation\n        const prepared = await this._agentContext.prepare();\n\n        // Generate LLM response\n        const response = await this.generateWithHooks(prepared.input, iteration, executionId);\n\n        // Extract tool calls\n        const toolCalls = this.extractToolCalls(response.output);\n\n        // Add assistant response to AgentContext\n        this._agentContext.addAssistantResponse(response.output);\n\n        // Emit tool detection\n        if (toolCalls.length > 0) {\n          this.emit('tool:detected', { executionId, iteration, toolCalls, timestamp: new Date() });\n        }\n\n        // If no tool calls, we're done\n        if (toolCalls.length === 0) {\n          this._emitIterationComplete(executionId, iteration, response, iterationStartTime);\n          finalResponse = response;\n          break;\n        }\n\n        // Execute tools with hooks\n        const toolResults = await this.executeToolsWithHooks(toolCalls, iteration, executionId);\n\n        // Add tool results to AgentContext\n        this._agentContext.addToolResults(toolResults);\n\n        // Record iteration metrics\n        this._recordIterationMetrics(iteration, iterationStartTime, response, toolCalls, toolResults, prepared);\n\n        // Emit iteration complete\n        this._emitIterationComplete(executionId, iteration, response, iterationStartTime);\n\n        iteration++;\n      }\n\n      // Check if we exited normally or hit max iterations\n      if (iteration >= maxIterations && !finalResponse) {\n        // Do a final LLM call WITHOUT tools to let the agent wrap up gracefully\n        this._logger.info({ maxIterations }, 'Max iterations reached, generating wrap-up response');\n\n        // Add a user message prompting the wrap-up\n        this._agentContext.addUserMessage(AGENT_DEFAULTS.MAX_ITERATIONS_MESSAGE);\n\n        // Prepare context and generate final response WITHOUT tools\n        const prepared = await this._agentContext.prepare();\n        const wrapUpResponse = await this._provider.generate({\n          model: this.model,\n          input: prepared.input,\n          instructions: this._config.instructions,\n          tools: [], // No tools - force text-only response\n          temperature: this._config.temperature,\n          vendorOptions: this._config.vendorOptions,\n        });\n\n        // Add the wrap-up response to context\n        this._agentContext.addAssistantResponse(wrapUpResponse.output);\n\n        // Emit event for max iterations reached\n        this.emit('execution:maxIterations', {\n          executionId,\n          iteration,\n          maxIterations,\n          timestamp: new Date(),\n        });\n\n        finalResponse = wrapUpResponse;\n      }\n\n      // Run post-cycle consolidation (summarization, memory optimization, etc.)\n      await this._agentContext.consolidate();\n\n      await this._finalizeExecution(executionId, startTime, finalResponse!, 'run');\n      return finalResponse!;\n    } catch (error) {\n      this._handleExecutionError(executionId, error as Error, startTime, 'run');\n      throw error;\n    } finally {\n      this._cleanupExecution();\n    }\n  }\n\n  // ===== Stream-Specific Helpers =====\n\n  /**\n   * Build tool calls array from accumulated map\n   */\n  private _buildToolCallsFromMap(\n    toolCallsMap: Map<string, { name: string; args: string }>\n  ): ToolCall[] {\n    const toolCalls: ToolCall[] = [];\n    for (const [toolCallId, buffer] of toolCallsMap) {\n      toolCalls.push({\n        id: toolCallId,\n        type: 'function',\n        function: {\n          name: buffer.name,\n          arguments: buffer.args,\n        },\n        blocking: true,\n        state: ToolCallState.PENDING,\n      });\n    }\n    return toolCalls;\n  }\n\n  /**\n   * Build and add streaming assistant message to context\n   */\n  private _addStreamingAssistantMessage(\n    streamState: StreamState,\n    toolCalls: ToolCall[]\n  ): void {\n    const assistantText = streamState.getAllText();\n    const assistantContent: Content[] = [];\n\n    // Add thinking content if reasoning was accumulated\n    if (streamState.hasReasoning()) {\n      const reasoning = streamState.getAllReasoning();\n      if (reasoning) {\n        // Use actual connector vendor for reliable detection\n        const isAnthropic = this.connector.vendor === Vendor.Anthropic;\n        assistantContent.push({\n          type: ContentType.THINKING,\n          thinking: reasoning,\n          // Streaming doesn't carry Anthropic signatures, so signature is undefined here.\n          // Non-streaming responses (via convertResponse) capture signatures correctly.\n          signature: undefined,\n          persistInHistory: isAnthropic,\n        });\n      }\n    }\n\n    if (assistantText && assistantText.trim()) {\n      assistantContent.push({\n        type: ContentType.OUTPUT_TEXT,\n        text: assistantText,\n      });\n    }\n\n    // Add tool use blocks\n    for (const tc of toolCalls) {\n      assistantContent.push({\n        type: ContentType.TOOL_USE,\n        id: tc.id,\n        name: tc.function.name,\n        arguments: tc.function.arguments,\n      });\n    }\n\n    // Build output format for addAssistantResponse (which properly moves _currentInput to _conversation)\n    const outputItem: OutputItem = {\n      type: 'message',\n      role: MessageRole.ASSISTANT,\n      content: assistantContent,\n    };\n\n    // Use addAssistantResponse instead of addInputItems to ensure user message\n    // in _currentInput is moved to _conversation first (critical for history preservation)\n    this._agentContext.addAssistantResponse([outputItem]);\n  }\n\n  /**\n   * Build placeholder response for streaming finalization\n   */\n  private _buildPlaceholderResponse(\n    executionId: string,\n    startTime: number,\n    streamState: StreamState\n  ): AgentResponse {\n    return {\n      id: executionId,\n      object: 'response',\n      created_at: Math.floor(startTime / 1000),\n      status: 'completed',\n      model: this.model,\n      output: [],\n      usage: streamState.usage,\n    };\n  }\n\n  /**\n   * Stream response from the agent\n   */\n  async *stream(input: string | InputItem[]): AsyncIterableIterator<StreamEvent> {\n    const { executionId, startTime, maxIterations } = await this._prepareExecution(input, 'stream');\n\n    // Create a single StreamState for the entire execution (tracks usage across iterations)\n    const globalStreamState = new StreamState(executionId, this.model);\n    let iteration = 0;\n\n    try {\n      // Main agentic loop\n      while (iteration < maxIterations) {\n        iteration++;\n\n        // Check preconditions (pause, cancel, limits)\n        const { shouldExit } = await this._checkIterationPreconditions(executionId, iteration);\n        if (shouldExit) {\n          this.emit('execution:cancelled', { executionId, iteration, timestamp: new Date() });\n          break;\n        }\n\n        // Prepare context (handles compaction)\n        // Note: instructions are set in systemPrompt during context creation\n        const prepared = await this._agentContext.prepare();\n\n        // Stream LLM response and accumulate state (per-iteration state)\n        const iterationStreamState = new StreamState(executionId, this.model);\n        const toolCallsMap = new Map<string, { name: string; args: string }>();\n\n        // Stream from provider with hooks\n        yield* this.streamGenerateWithHooks(\n          prepared.input,\n          iteration,\n          executionId,\n          iterationStreamState,\n          toolCallsMap\n        );\n\n        // Accumulate usage from this iteration into global state\n        globalStreamState.accumulateUsage(iterationStreamState.usage);\n\n        // Build tool calls from accumulated map\n        const toolCalls = this._buildToolCallsFromMap(toolCallsMap);\n\n        // No tool calls? We're done - add assistant message and exit\n        if (toolCalls.length === 0) {\n          // Add the final assistant response to conversation history\n          // (this also moves user message from _currentInput to _conversation)\n          this._addStreamingAssistantMessage(iterationStreamState, []);\n\n          yield {\n            type: StreamEventType.ITERATION_COMPLETE,\n            response_id: executionId,\n            iteration,\n            tool_calls_count: 0,\n            has_more_iterations: false,\n          };\n\n          yield {\n            type: StreamEventType.RESPONSE_COMPLETE,\n            response_id: executionId,\n            status: 'completed',\n            usage: globalStreamState.usage,\n            iterations: iteration,\n            duration_ms: Date.now() - startTime,\n          };\n\n          break;\n        }\n\n        // Execute tools and yield execution events\n        const toolResults: ToolResult[] = [];\n\n        for (const toolCall of toolCalls) {\n          // Parse and validate arguments\n          let parsedArgs: Record<string, unknown>;\n          try {\n            parsedArgs = JSON.parse(toolCall.function.arguments);\n          } catch (error) {\n            const errorMessage = `Invalid tool arguments JSON: ${(error as Error).message}`;\n            // CRITICAL: Add a ToolResult for the failed parse to ensure TOOL_USE has a matching TOOL_RESULT\n            // Without this, subsequent API calls fail with \"No tool output found for function call\"\n            const failedResult: ToolResult = {\n              tool_use_id: toolCall.id,\n              tool_name: toolCall.function.name,\n              tool_args: {},\n              content: { success: false, error: errorMessage },\n              state: ToolCallState.FAILED,\n              error: errorMessage,\n            };\n            toolResults.push(failedResult);\n\n            yield {\n              type: StreamEventType.TOOL_EXECUTION_DONE,\n              response_id: executionId,\n              tool_call_id: toolCall.id,\n              tool_name: toolCall.function.name,\n              result: failedResult.content,\n              execution_time_ms: 0,\n              error: errorMessage,\n            };\n            continue;\n          }\n\n          yield {\n            type: StreamEventType.TOOL_EXECUTION_START,\n            response_id: executionId,\n            tool_call_id: toolCall.id,\n            tool_name: toolCall.function.name,\n            arguments: parsedArgs,\n          };\n\n          const toolStartTime = Date.now();\n\n          try {\n            const result = await this.executeToolWithHooks(toolCall, iteration, executionId);\n            toolResults.push(result);\n\n            yield {\n              type: StreamEventType.TOOL_EXECUTION_DONE,\n              response_id: executionId,\n              tool_call_id: toolCall.id,\n              tool_name: toolCall.function.name,\n              result: result.content,\n              execution_time_ms: Date.now() - toolStartTime,\n            };\n          } catch (error) {\n            yield {\n              type: StreamEventType.TOOL_EXECUTION_DONE,\n              response_id: executionId,\n              tool_call_id: toolCall.id,\n              tool_name: toolCall.function.name,\n              result: null,\n              execution_time_ms: Date.now() - toolStartTime,\n              error: (error as Error).message,\n            };\n\n            const failureMode = this._config.errorHandling?.toolFailureMode || 'continue';\n            if (failureMode === 'fail') {\n              throw error;\n            }\n\n            toolResults.push({\n              tool_use_id: toolCall.id,\n              tool_name: toolCall.function.name,\n              tool_args: parsedArgs,\n              content: '',\n              error: (error as Error).message,\n              state: ToolCallState.FAILED,\n            });\n          }\n        }\n\n        // Build and add assistant message to context\n        this._addStreamingAssistantMessage(iterationStreamState, toolCalls);\n        this._agentContext.addToolResults(toolResults);\n\n        yield {\n          type: StreamEventType.ITERATION_COMPLETE,\n          response_id: executionId,\n          iteration,\n          tool_calls_count: toolCalls.length,\n          has_more_iterations: true,\n        };\n\n        globalStreamState.incrementIteration();\n        iterationStreamState.clear();\n        toolCallsMap.clear();\n      }\n\n      // If loop ended due to max iterations, generate wrap-up response\n      if (iteration >= maxIterations) {\n        this._logger.info({ maxIterations }, 'Max iterations reached, streaming wrap-up response');\n\n        // Add a user message prompting the wrap-up\n        this._agentContext.addUserMessage(AGENT_DEFAULTS.MAX_ITERATIONS_MESSAGE);\n\n        // Prepare context and stream final response WITHOUT tools\n        const prepared = await this._agentContext.prepare();\n        const wrapUpStreamState = new StreamState(executionId, this.model);\n\n        // Stream the wrap-up response\n        for await (const event of this._provider.streamGenerate({\n          model: this.model,\n          input: prepared.input,\n          instructions: this._config.instructions,\n          tools: [], // No tools - force text-only response\n          temperature: this._config.temperature,\n          vendorOptions: this._config.vendorOptions,\n        })) {\n          // Update stream state\n          if (event.type === StreamEventType.OUTPUT_TEXT_DELTA) {\n            wrapUpStreamState.accumulateTextDelta(event.item_id, event.delta);\n          } else if (event.type === StreamEventType.RESPONSE_COMPLETE) {\n            wrapUpStreamState.updateUsage(event.usage);\n            continue; // Don't yield provider's RESPONSE_COMPLETE\n          }\n          yield event;\n        }\n\n        // Add wrap-up response to context\n        this._addStreamingAssistantMessage(wrapUpStreamState, []);\n        globalStreamState.accumulateUsage(wrapUpStreamState.usage);\n\n        // Emit event for max iterations reached\n        this.emit('execution:maxIterations', {\n          executionId,\n          iteration,\n          maxIterations,\n          timestamp: new Date(),\n        });\n\n        yield {\n          type: StreamEventType.RESPONSE_COMPLETE,\n          response_id: executionId,\n          status: 'completed', // Now completed with wrap-up message\n          usage: globalStreamState.usage,\n          iterations: iteration + 1, // Include wrap-up iteration\n          duration_ms: Date.now() - startTime,\n        };\n\n        wrapUpStreamState.clear();\n      }\n\n      // Run post-cycle consolidation (summarization, memory optimization, etc.)\n      await this._agentContext.consolidate();\n\n      // Finalize execution\n      const placeholderResponse = this._buildPlaceholderResponse(executionId, startTime, globalStreamState);\n      await this._finalizeExecution(executionId, startTime, placeholderResponse, 'stream');\n    } catch (error) {\n      this._handleExecutionError(executionId, error as Error, startTime, 'stream');\n\n      yield {\n        type: StreamEventType.ERROR,\n        response_id: executionId,\n        error: {\n          type: 'execution_error',\n          message: (error as Error).message,\n        },\n        recoverable: false,\n      };\n\n      throw error;\n    } finally {\n      this._cleanupExecution(globalStreamState);\n    }\n  }\n\n  // ===== LLM Generation with Hooks =====\n\n  /**\n   * Generate LLM response with hooks\n   */\n  private async generateWithHooks(\n    input: InputItem[],\n    iteration: number,\n    executionId: string\n  ): Promise<AgentResponse> {\n    const llmStartTime = Date.now();\n\n    // Prepare options\n    let generateOptions: TextGenerateOptions = {\n      model: this.model,\n      input,\n      instructions: this._config.instructions,\n      tools: this.getEnabledToolDefinitions(),\n      tool_choice: 'auto',\n      temperature: this._config.temperature,\n      thinking: this._config.thinking,\n      vendorOptions: this._config.vendorOptions,\n    };\n\n    // Execute before:llm hook\n    const beforeLLM = await this.hookManager.executeHooks('before:llm', {\n      executionId,\n      iteration,\n      options: generateOptions,\n      context: this.executionContext!,\n      timestamp: new Date(),\n    }, {});\n\n    // Apply modifications\n    if (beforeLLM.modified) {\n      generateOptions = { ...generateOptions, ...beforeLLM.modified };\n    }\n\n    // Skip if requested\n    if (beforeLLM.skip) {\n      throw new Error('LLM call skipped by hook');\n    }\n\n    // Emit LLM request\n    this.emit('llm:request', {\n      executionId,\n      iteration,\n      options: generateOptions,\n      timestamp: new Date(),\n    });\n\n    try {\n      // Call provider\n      const response = await this._provider.generate(generateOptions);\n\n      const llmDuration = Date.now() - llmStartTime;\n\n      // Update metrics\n      this.executionContext?.updateMetrics({\n        llmDuration: (this.executionContext.metrics.llmDuration || 0) + llmDuration,\n      });\n\n      // Emit LLM response\n      this.emit('llm:response', {\n        executionId,\n        iteration,\n        response,\n        timestamp: new Date(),\n        duration: llmDuration,\n      });\n\n      // Execute after:llm hook\n      await this.hookManager.executeHooks('after:llm', {\n        executionId,\n        iteration,\n        response,\n        context: this.executionContext!,\n        timestamp: new Date(),\n        duration: llmDuration,\n      }, {});\n\n      return response;\n    } catch (error) {\n      // Emit LLM error\n      this.emit('llm:error', {\n        executionId,\n        iteration,\n        error: error as Error,\n        timestamp: new Date(),\n      });\n\n      throw error;\n    }\n  }\n\n  /**\n   * Stream LLM response with hooks\n   */\n  private async *streamGenerateWithHooks(\n    input: InputItem[],\n    iteration: number,\n    executionId: string,\n    streamState: StreamState,\n    toolCallsMap: Map<string, { name: string; args: string }>\n  ): AsyncIterableIterator<StreamEvent> {\n    const llmStartTime = Date.now();\n\n    // Prepare options\n    const generateOptions: TextGenerateOptions = {\n      model: this.model,\n      input,\n      instructions: this._config.instructions,\n      tools: this.getEnabledToolDefinitions(),\n      tool_choice: 'auto',\n      temperature: this._config.temperature,\n      thinking: this._config.thinking,\n      vendorOptions: this._config.vendorOptions,\n    };\n\n    // Execute before:llm hook\n    await this.hookManager.executeHooks('before:llm', {\n      executionId,\n      iteration,\n      options: generateOptions,\n      context: this.executionContext!,\n      timestamp: new Date(),\n    }, {});\n\n    // Emit LLM request event\n    this.emit('llm:request', {\n      executionId,\n      iteration,\n      model: this.model,\n      timestamp: new Date(),\n    });\n\n    try {\n      // Stream from provider\n      for await (const event of this._provider.streamGenerate(generateOptions)) {\n        // Update stream state based on event\n        if (isReasoningDelta(event)) {\n          streamState.accumulateReasoningDelta(event.item_id, event.delta);\n        } else if (event.type === StreamEventType.OUTPUT_TEXT_DELTA) {\n          streamState.accumulateTextDelta(event.item_id, event.delta);\n        } else if (event.type === StreamEventType.TOOL_CALL_START) {\n          streamState.startToolCall(event.tool_call_id, event.tool_name);\n          toolCallsMap.set(event.tool_call_id, { name: event.tool_name, args: '' });\n        } else if (event.type === StreamEventType.TOOL_CALL_ARGUMENTS_DELTA) {\n          streamState.accumulateToolArguments(event.tool_call_id, event.delta);\n          const buffer = toolCallsMap.get(event.tool_call_id);\n          if (buffer) {\n            buffer.args += event.delta;\n          }\n        } else if (isToolCallArgumentsDone(event)) {\n          streamState.completeToolCall(event.tool_call_id);\n          const buffer = toolCallsMap.get(event.tool_call_id);\n          if (buffer) {\n            buffer.args = event.arguments;\n          }\n        } else if (event.type === StreamEventType.RESPONSE_COMPLETE) {\n          streamState.updateUsage(event.usage);\n          // Don't yield provider's RESPONSE_COMPLETE - we emit our own at the end\n          continue;\n        }\n\n        // Yield event to caller\n        yield event;\n      }\n\n      // Update metrics\n      if (this.executionContext) {\n        this.executionContext.metrics.llmDuration += Date.now() - llmStartTime;\n        this.executionContext.metrics.inputTokens += streamState.usage.input_tokens;\n        this.executionContext.metrics.outputTokens += streamState.usage.output_tokens;\n        this.executionContext.metrics.totalTokens += streamState.usage.total_tokens;\n      }\n\n      // Execute after:llm hook with a placeholder response for streaming\n      const llmPlaceholderResponse: AgentResponse = {\n        id: executionId,\n        object: 'response',\n        created_at: Math.floor(llmStartTime / 1000),\n        status: 'completed',\n        model: this.model,\n        output: [],\n        usage: streamState.usage,\n      };\n      await this.hookManager.executeHooks('after:llm', {\n        executionId,\n        iteration,\n        response: llmPlaceholderResponse,\n        context: this.executionContext!,\n        timestamp: new Date(),\n        duration: Date.now() - llmStartTime,\n      }, {});\n\n      // Emit LLM response event\n      this.emit('llm:response', {\n        executionId,\n        iteration,\n        timestamp: new Date(),\n      });\n    } catch (error) {\n      this.emit('llm:error', {\n        executionId,\n        iteration,\n        error: error as Error,\n        timestamp: new Date(),\n      });\n      throw error;\n    }\n  }\n\n  // ===== Tool Execution =====\n\n  /**\n   * Extract tool calls from response output\n   */\n  private extractToolCalls(output: OutputItem[]): ToolCall[] {\n    const toolCalls: ToolCall[] = [];\n    const toolDefinitions = this.getEnabledToolDefinitions();\n\n    // Create tool map for quick lookup\n    const toolMap = new Map<string, Tool>();\n    for (const tool of toolDefinitions) {\n      if (tool.type === 'function') {\n        toolMap.set(tool.function.name, tool);\n      }\n    }\n\n    // Extract tool calls from output\n    for (const item of output) {\n      if (item.type === 'message' && item.role === MessageRole.ASSISTANT) {\n        for (const content of item.content) {\n          if (content.type === ContentType.TOOL_USE) {\n            const toolDef = toolMap.get(content.name);\n            const isBlocking = toolDef?.blocking !== false;\n\n            const toolCall: ToolCall = {\n              id: content.id,\n              type: 'function',\n              function: {\n                name: content.name,\n                arguments: content.arguments,\n              },\n              blocking: isBlocking,\n              state: ToolCallState.PENDING,\n            };\n\n            toolCalls.push(toolCall);\n          }\n        }\n      }\n    }\n\n    return toolCalls;\n  }\n\n  /**\n   * Execute tools with hooks\n   */\n  private async executeToolsWithHooks(\n    toolCalls: ToolCall[],\n    iteration: number,\n    executionId: string\n  ): Promise<ToolResult[]> {\n    const results: ToolResult[] = [];\n\n    for (const toolCall of toolCalls) {\n      // Add to context\n      this.executionContext?.addToolCall(toolCall);\n\n      // Check pause before each tool\n      await this.checkPause();\n\n      // Execute before:tool hook\n      const beforeTool = await this.hookManager.executeHooks('before:tool', {\n        executionId,\n        iteration,\n        toolCall,\n        context: this.executionContext!,\n        timestamp: new Date(),\n      }, {});\n\n      // Check if tool should be skipped\n      if (beforeTool.skip) {\n        this.executionContext?.audit('tool_skipped', { toolCall }, undefined, toolCall.function.name);\n\n        // Parse args for tracking\n        let parsedArgs: Record<string, unknown> = {};\n        try {\n          parsedArgs = JSON.parse(toolCall.function.arguments);\n        } catch { /* ignore parse errors */ }\n\n        const mockResult: ToolResult = {\n          tool_use_id: toolCall.id,\n          tool_name: toolCall.function.name,\n          tool_args: parsedArgs,\n          content: beforeTool.mockResult || '',\n          state: ToolCallState.COMPLETED,\n          executionTime: 0,\n        };\n\n        results.push(mockResult);\n        this.executionContext?.addToolResult(mockResult);\n        continue;\n      }\n\n      // Apply modifications if any\n      if (beforeTool.modified) {\n        Object.assign(toolCall, beforeTool.modified);\n        this.executionContext?.audit('tool_modified', { modifications: beforeTool.modified }, undefined, toolCall.function.name);\n      }\n\n      // Execute tool\n      try {\n        const result = await this.executeToolWithHooks(toolCall, iteration, executionId);\n        results.push(result);\n        this.executionContext?.addToolResult(result);\n      } catch (error) {\n        // Parse args for tracking (even on error)\n        let parsedArgs: Record<string, unknown> = {};\n        try {\n          parsedArgs = JSON.parse(toolCall.function.arguments);\n        } catch { /* ignore parse errors */ }\n\n        const toolResult: ToolResult = {\n          tool_use_id: toolCall.id,\n          tool_name: toolCall.function.name,\n          tool_args: parsedArgs,\n          content: '',\n          error: (error as Error).message,\n          state: ToolCallState.FAILED,\n        };\n\n        results.push(toolResult);\n        this.executionContext?.addToolResult(toolResult);\n\n        // Check tool failure mode\n        const failureMode = this._config.errorHandling?.toolFailureMode || 'continue';\n        if (failureMode === 'fail') {\n          throw error;\n        }\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Execute single tool with hooks\n   */\n  private async executeToolWithHooks(\n    toolCall: ToolCall,\n    iteration: number,\n    executionId: string\n  ): Promise<ToolResult> {\n    const toolStartTime = Date.now();\n\n    toolCall.state = ToolCallState.EXECUTING;\n    toolCall.startTime = new Date();\n\n    // Permission check\n    const permissionApproved = await this.checkToolPermission(toolCall, iteration, executionId);\n\n    // Execute approve:tool hook if needed\n    if (!permissionApproved || this.hookManager.hasHooks('approve:tool')) {\n      const approval = await this.hookManager.executeHooks('approve:tool', {\n        executionId,\n        iteration,\n        toolCall,\n        context: this.executionContext!,\n        timestamp: new Date(),\n      }, { approved: permissionApproved });\n\n      if (!approval.approved) {\n        throw new Error(`Tool execution rejected: ${approval.reason || 'No reason provided'}`);\n      }\n    }\n\n    // Emit tool start\n    this.emit('tool:start', { executionId, iteration, toolCall, timestamp: new Date() });\n\n    try {\n      // Execute tool (timeout is handled by ToolManager per-tool)\n      const args = JSON.parse(toolCall.function.arguments);\n      const result = await this._agentContext.tools.execute(toolCall.function.name, args);\n\n      toolCall.state = ToolCallState.COMPLETED;\n      toolCall.endTime = new Date();\n\n      let toolResult: ToolResult = {\n        tool_use_id: toolCall.id,\n        tool_name: toolCall.function.name,\n        tool_args: args,\n        content: result,\n        state: ToolCallState.COMPLETED,\n        executionTime: Date.now() - toolStartTime,\n      };\n\n      // Execute after:tool hook\n      const afterTool = await this.hookManager.executeHooks('after:tool', {\n        executionId,\n        iteration,\n        toolCall,\n        result: toolResult,\n        context: this.executionContext!,\n        timestamp: new Date(),\n      }, {});\n\n      // Apply result modifications\n      if (afterTool.modified) {\n        toolResult = { ...toolResult, ...afterTool.modified };\n      }\n\n      // Update metrics\n      if (this.executionContext) {\n        this.executionContext.metrics.toolCallCount++;\n        this.executionContext.metrics.toolSuccessCount++;\n        this.executionContext.metrics.toolDuration += toolResult.executionTime || 0;\n      }\n\n      // Emit tool complete\n      this.emit('tool:complete', { executionId, iteration, toolCall, result: toolResult, timestamp: new Date() });\n\n      return toolResult;\n    } catch (error) {\n      toolCall.state = ToolCallState.FAILED;\n      toolCall.endTime = new Date();\n      toolCall.error = (error as Error).message;\n\n      // Update metrics\n      if (this.executionContext) {\n        this.executionContext.metrics.toolFailureCount++;\n      }\n\n      // Emit tool error or timeout\n      if (error instanceof ToolTimeoutError) {\n        this.emit('tool:timeout', {\n          executionId,\n          iteration,\n          toolCall,\n          timeout: error.timeoutMs,\n          timestamp: new Date(),\n        });\n      } else {\n        this.emit('tool:error', { executionId, iteration, toolCall, error: error as Error, timestamp: new Date() });\n      }\n\n      throw error;\n    }\n  }\n\n  /**\n   * Check tool permission before execution\n   */\n  private async checkToolPermission(\n    toolCall: ToolCall,\n    iteration: number,\n    executionId: string\n  ): Promise<boolean> {\n    // Check if blocked first\n    if (this._permissionManager.isBlocked(toolCall.function.name)) {\n      this.executionContext?.audit('tool_blocked', { reason: 'Tool is blocklisted' }, undefined, toolCall.function.name);\n      throw new Error(`Tool \"${toolCall.function.name}\" is blocked and cannot be executed`);\n    }\n\n    // Check if already approved\n    if (this._permissionManager.isApproved(toolCall.function.name)) {\n      return true;\n    }\n\n    // Check if needs approval\n    const checkResult = this._permissionManager.checkPermission(toolCall.function.name);\n    if (!checkResult.needsApproval) {\n      return true;\n    }\n\n    // Parse arguments for context\n    let parsedArgs: Record<string, unknown> = {};\n    try {\n      parsedArgs = JSON.parse(toolCall.function.arguments);\n    } catch {\n      // Use empty args if parsing fails\n    }\n\n    // Build permission context\n    const context: PermissionCheckContext = {\n      toolCall,\n      parsedArgs,\n      config: checkResult.config || {},\n      executionId,\n      iteration,\n      agentType: 'agent',\n    };\n\n    // Request approval via permission manager's callback\n    const decision = await this._permissionManager.requestApproval(context);\n\n    if (decision.approved) {\n      this.executionContext?.audit('tool_permission_approved', {\n        scope: decision.scope,\n        approvedBy: decision.approvedBy,\n      }, undefined, toolCall.function.name);\n      return true;\n    }\n\n    return false;\n  }\n\n  // ===== Pause/Resume/Cancel =====\n\n  /**\n   * Pause execution\n   */\n  pause(reason?: string): void {\n    this._pauseResumeMutex = this._pauseResumeMutex.then(() => {\n      if (this._paused) return;\n\n      this._paused = true;\n      this._pausePromise = new Promise((resolve) => {\n        this._resumeCallback = resolve;\n      });\n\n      if (this.executionContext) {\n        this.executionContext.paused = true;\n        this.executionContext.pauseReason = reason;\n        this.executionContext.audit('execution_paused', { reason });\n      }\n\n      this.emit('execution:paused', {\n        executionId: this.executionContext?.executionId || 'unknown',\n        reason: reason || 'Manual pause',\n        timestamp: new Date(),\n      });\n    });\n  }\n\n  /**\n   * Resume execution\n   */\n  resume(): void {\n    this._pauseResumeMutex = this._pauseResumeMutex.then(() => {\n      if (!this._paused) return;\n\n      this._paused = false;\n\n      if (this.executionContext) {\n        this.executionContext.paused = false;\n        this.executionContext.pauseReason = undefined;\n        this.executionContext.audit('execution_resumed', {});\n      }\n\n      if (this._resumeCallback) {\n        this._resumeCallback();\n        this._resumeCallback = null;\n      }\n\n      this._pausePromise = null;\n\n      this.emit('execution:resumed', {\n        executionId: this.executionContext?.executionId || 'unknown',\n        timestamp: new Date(),\n      });\n    });\n  }\n\n  /**\n   * Cancel execution\n   */\n  cancel(reason?: string): void {\n    this._cancelled = true;\n\n    if (this.executionContext) {\n      this.executionContext.cancelled = true;\n      this.executionContext.cancelReason = reason;\n    }\n\n    // Resume if paused (to allow cancellation to proceed)\n    if (this._paused) {\n      this._paused = false;\n      if (this._resumeCallback) {\n        this._resumeCallback();\n        this._resumeCallback = null;\n      }\n      this._pausePromise = null;\n    }\n\n    this.emit('execution:cancelled', {\n      executionId: this.executionContext?.executionId || 'unknown',\n      reason: reason || 'Manual cancellation',\n      timestamp: new Date(),\n    });\n  }\n\n  /**\n   * Check if paused and wait\n   */\n  private async checkPause(): Promise<void> {\n    if (this._paused && this._pausePromise) {\n      await this._pausePromise;\n    }\n  }\n\n  // ===== Tool Management =====\n  // Note: addTool, removeTool, listTools, setTools are inherited from BaseAgent\n\n  // ===== Permission Convenience Methods =====\n\n  approveToolForSession(toolName: string): void {\n    this._permissionManager.approveForSession(toolName);\n  }\n\n  revokeToolApproval(toolName: string): void {\n    this._permissionManager.revoke(toolName);\n  }\n\n  getApprovedTools(): string[] {\n    return this._permissionManager.getApprovedTools();\n  }\n\n  toolNeedsApproval(toolName: string): boolean {\n    return this._permissionManager.checkPermission(toolName).needsApproval;\n  }\n\n  toolIsBlocked(toolName: string): boolean {\n    return this._permissionManager.isBlocked(toolName);\n  }\n\n  allowlistTool(toolName: string): void {\n    this._permissionManager.allowlistAdd(toolName);\n  }\n\n  blocklistTool(toolName: string): void {\n    this._permissionManager.blocklistAdd(toolName);\n  }\n\n  // ===== Configuration Methods =====\n\n  setModel(model: string): void {\n    (this as { model: string }).model = model;\n    this._config.model = model;\n  }\n\n  getTemperature(): number | undefined {\n    return this._config.temperature;\n  }\n\n  setTemperature(temperature: number): void {\n    this._config.temperature = temperature;\n  }\n\n  // ===== Definition Persistence =====\n\n  async saveDefinition(\n    storage?: IAgentDefinitionStorage,\n    metadata?: AgentDefinitionMetadata\n  ): Promise<void> {\n    const s = storage ?? StorageRegistry.get('agentDefinitions');\n    if (!s) {\n      throw new Error('No storage provided and no agentDefinitions configured in StorageRegistry');\n    }\n    const now = new Date().toISOString();\n\n    const definition: StoredAgentDefinition = {\n      version: 1,\n      agentId: this._agentContext.agentId,\n      name: this._agentContext.agentId,\n      agentType: 'agent',\n      createdAt: now,\n      updatedAt: now,\n      connector: {\n        name: this.connector.name,\n        model: this.model,\n      },\n      systemPrompt: this._agentContext.systemPrompt,\n      instructions: this._config.instructions,\n      features: this._agentContext.features,\n      metadata,\n      typeConfig: {\n        temperature: this._config.temperature,\n        maxIterations: this._config.maxIterations,\n        vendorOptions: this._config.vendorOptions,\n      },\n    };\n\n    await s.save(definition);\n  }\n\n  // ===== Introspection =====\n\n  getExecutionContext(): ExecutionContext | null {\n    return this.executionContext;\n  }\n\n  /**\n   * Alias for getExecutionContext() for backward compatibility\n   */\n  getContext(): ExecutionContext | null {\n    return this.executionContext;\n  }\n\n  getMetrics() {\n    return this.executionContext?.metrics || null;\n  }\n\n  getSummary() {\n    return this.executionContext?.getSummary() || null;\n  }\n\n  getAuditTrail() {\n    return this.executionContext?.getAuditTrail() || [];\n  }\n\n  getProviderCircuitBreakerMetrics() {\n    if ('getCircuitBreakerMetrics' in this._provider) {\n      return (this._provider as { getCircuitBreakerMetrics: () => unknown }).getCircuitBreakerMetrics();\n    }\n    return null;\n  }\n\n  getToolCircuitBreakerStates() {\n    return this._agentContext.tools.getCircuitBreakerStates();\n  }\n\n  getToolCircuitBreakerMetrics(toolName: string) {\n    return this._agentContext.tools.getToolCircuitBreakerMetrics(toolName);\n  }\n\n  resetToolCircuitBreaker(toolName: string): void {\n    this._agentContext.tools.resetToolCircuitBreaker(toolName);\n    this._logger.info({ toolName }, 'Tool circuit breaker reset by user');\n  }\n\n  isRunning(): boolean {\n    return this.executionContext !== null && !this._cancelled;\n  }\n\n  isPaused(): boolean {\n    return this._paused;\n  }\n\n  isCancelled(): boolean {\n    return this._cancelled;\n  }\n\n  /**\n   * Clear conversation history, resetting the context for a fresh interaction.\n   * Plugins (working memory, in-context memory, etc.) are NOT affected.\n   */\n  clearConversation(reason?: string): void {\n    this._agentContext.clearConversation(reason);\n    this._logger.info({ reason }, 'Conversation cleared');\n  }\n\n  // ===== Hook Management =====\n\n  /**\n   * Register a hook on the agent. Can be called after creation.\n   */\n  registerHook(name: HookName, hook: Function): void {\n    this.hookManager.register(name, hook as any);\n  }\n\n  /**\n   * Unregister a previously registered hook by reference.\n   */\n  unregisterHook(name: HookName, hook: Function): boolean {\n    return this.hookManager.unregister(name, hook as any);\n  }\n\n  // ===== Cleanup =====\n\n  destroy(): void {\n    if (this._isDestroyed) {\n      return;\n    }\n\n    this._logger.debug('Agent destroy started');\n\n    // Cancel any ongoing execution\n    try {\n      this.cancel('Agent destroyed');\n    } catch {\n      // Ignore errors during cancel\n    }\n\n    // Cleanup execution context\n    this.executionContext?.cleanup();\n    this.executionContext = null;\n\n    // Note: AgentContext cleanup is handled by baseDestroy() in BaseAgent\n\n    // Run cleanup callbacks\n    for (const callback of this._cleanupCallbacks) {\n      try {\n        callback();\n      } catch (error) {\n        this._logger.error({ error: (error as Error).message }, 'Cleanup callback error');\n      }\n    }\n    this._cleanupCallbacks = [];\n\n    // Call base destroy (handles session, tool manager, permission manager cleanup)\n    this.baseDestroy();\n\n    metrics.increment('agent.destroyed', 1, {\n      model: this.model,\n      connector: this.connector.name,\n    });\n\n    this._logger.debug('Agent destroyed');\n  }\n}\n","/**\n * Task and Plan entities for TaskAgent\n *\n * Defines the data structures for task-based autonomous agents.\n */\n\nimport { DependencyCycleError } from '../errors/AIErrors.js';\nimport type { RoutineDefinition } from './Routine.js';\n\n/**\n * Task status lifecycle\n */\nexport type TaskStatus =\n  | 'pending'           // Not started\n  | 'blocked'           // Dependencies not met\n  | 'in_progress'       // Currently executing\n  | 'waiting_external'  // Waiting on external event\n  | 'completed'         // Successfully finished\n  | 'failed'            // Failed after max retries\n  | 'skipped'           // Skipped (condition not met)\n  | 'cancelled';        // Manually cancelled\n\n/**\n * Terminal statuses - task will not progress further\n */\nexport const TERMINAL_TASK_STATUSES: TaskStatus[] = ['completed', 'failed', 'skipped', 'cancelled'];\n\n/**\n * Check if a task status is terminal (task will not progress further)\n */\nexport function isTerminalStatus(status: TaskStatus): boolean {\n  return TERMINAL_TASK_STATUSES.includes(status);\n}\n\n/**\n * Plan status\n */\nexport type PlanStatus =\n  | 'pending'\n  | 'running'\n  | 'suspended'\n  | 'completed'\n  | 'failed'\n  | 'cancelled';\n\n/**\n * Condition operators for conditional task execution\n */\nexport type ConditionOperator =\n  | 'exists'\n  | 'not_exists'\n  | 'equals'\n  | 'contains'\n  | 'truthy'\n  | 'greater_than'\n  | 'less_than';\n\n/**\n * Task condition - evaluated before execution\n */\nexport interface TaskCondition {\n  memoryKey: string;\n  operator: ConditionOperator;\n  value?: unknown;\n  onFalse: 'skip' | 'fail' | 'wait';\n}\n\n/**\n * External dependency configuration\n */\nexport interface ExternalDependency {\n  type: 'webhook' | 'poll' | 'manual' | 'scheduled';\n\n  /** For webhook: unique ID to match incoming webhook */\n  webhookId?: string;\n\n  /** For poll: how to check if complete */\n  pollConfig?: {\n    toolName: string;\n    toolArgs: Record<string, unknown>;\n    intervalMs: number;\n    maxAttempts: number;\n  };\n\n  /** For scheduled: when to resume */\n  scheduledAt?: number;\n\n  /** For manual: description of what's needed */\n  manualDescription?: string;\n\n  /** Timeout for all types */\n  timeoutMs?: number;\n\n  /** Current state */\n  state: 'waiting' | 'received' | 'timeout';\n\n  /** Data received from external source */\n  receivedData?: unknown;\n  receivedAt?: number;\n}\n\n// ============================================================================\n// Control Flow Types\n// ============================================================================\n\n/** Sub-routine specification: either inline tasks or a full RoutineDefinition */\nexport type SubRoutineSpec = TaskInput[] | RoutineDefinition;\n\n/** Reference to a source value for control flow operations. */\nexport interface TaskSourceRef {\n  /** Reference the output of a named task (resolves to __task_output_{name}) */\n  task?: string;\n  /** Direct memory key lookup */\n  key?: string;\n  /** JSON path to extract from the resolved value (e.g., 'data.items', 'results[0].entries') */\n  path?: string;\n}\n\n/** Source can be a simple key string (legacy) or a structured reference. */\nexport type ControlFlowSource = string | TaskSourceRef;\n\n/** Map: execute a sub-routine for each element in an array */\nexport interface TaskMapFlow {\n  type: 'map';\n  /** Source array reference  task name, memory key, or structured ref. */\n  source: ControlFlowSource;\n  /** Sub-routine to run per element */\n  tasks: SubRoutineSpec;\n  /** Memory key for collected results array */\n  resultKey?: string;\n  /** Cap iterations (default: array.length, hard max: 1000) */\n  maxIterations?: number;\n  /** Timeout per sub-execution iteration in ms (default: no timeout) */\n  iterationTimeoutMs?: number;\n}\n\n/** Fold: accumulate a result across array elements */\nexport interface TaskFoldFlow {\n  type: 'fold';\n  /** Source array reference  task name, memory key, or structured ref. */\n  source: ControlFlowSource;\n  /** Sub-routine to run per element */\n  tasks: SubRoutineSpec;\n  /** Starting accumulator value */\n  initialValue: unknown;\n  /** Memory key for final accumulated result */\n  resultKey: string;\n  /** Cap iterations (default: array.length, hard max: 1000) */\n  maxIterations?: number;\n  /** Timeout per sub-execution iteration in ms (default: no timeout) */\n  iterationTimeoutMs?: number;\n}\n\n/** Until: repeat a sub-routine until a condition is met */\nexport interface TaskUntilFlow {\n  type: 'until';\n  /** Sub-routine to run each iteration */\n  tasks: SubRoutineSpec;\n  /** Checked AFTER each iteration (reuses existing TaskCondition type) */\n  condition: TaskCondition;\n  /** Maximum iterations (required  no default) */\n  maxIterations: number;\n  /** Optional ICM key for current iteration index */\n  iterationKey?: string;\n  /** Timeout per sub-execution iteration in ms (default: no timeout) */\n  iterationTimeoutMs?: number;\n}\n\n/** Union of all control flow types */\nexport type TaskControlFlow = TaskMapFlow | TaskFoldFlow | TaskUntilFlow;\n\n/**\n * Task execution settings\n */\nexport interface TaskExecution {\n  /** Can run in parallel with other parallel tasks */\n  parallel?: boolean;\n\n  /** Max concurrent if this spawns sub-work */\n  maxConcurrency?: number;\n\n  /** Priority (higher = executed first) */\n  priority?: number;\n\n  /**\n   * Maximum LLM iterations (tool-call loops) per agent.run() for this task.\n   * Prevents runaway agents. Default: 50.\n   */\n  maxIterations?: number;\n\n  /**\n   * If true (default), re-check condition immediately before LLM call\n   * to protect against race conditions when parallel tasks modify memory.\n   * Set to false to skip re-check for performance if you know condition won't change.\n   */\n  raceProtection?: boolean;\n}\n\n/**\n * Task completion validation settings\n *\n * Used to verify that a task actually achieved its goal before marking it complete.\n * Supports multiple validation approaches:\n * - Programmatic checks (memory keys, hooks)\n * - LLM self-reflection with completeness scoring\n * - Natural language criteria evaluation\n */\nexport interface TaskValidation {\n  /**\n   * Natural language completion criteria.\n   * These are evaluated by LLM self-reflection to determine if the task is complete.\n   * Examples:\n   * - \"The response contains at least 3 specific examples\"\n   * - \"User's email has been validated and stored in memory\"\n   * - \"All requested data fields are present in the output\"\n   *\n   * This is the RECOMMENDED approach for flexible, intelligent validation.\n   */\n  completionCriteria?: string[];\n\n  /**\n   * Minimum completeness score (0-100) to consider task successful.\n   * LLM self-reflection returns a score; if below this threshold:\n   * - If requireUserApproval is set, ask user\n   * - Otherwise, follow the mode setting (strict = fail, warn = continue)\n   * Default: 80\n   */\n  minCompletionScore?: number;\n\n  /**\n   * When to require user approval:\n   * - 'never': Never ask user, use automated decision (default)\n   * - 'uncertain': Ask user when score is between minCompletionScore and minCompletionScore + 15\n   * - 'always': Always ask user to confirm task completion\n   */\n  requireUserApproval?: 'never' | 'uncertain' | 'always';\n\n  /**\n   * Memory keys that must exist after task completion.\n   * If the task should store data in memory, list the required keys here.\n   * This is a hard requirement checked BEFORE LLM reflection.\n   */\n  requiredMemoryKeys?: string[];\n\n  /**\n   * Custom validation function name (registered via validateTask hook).\n   * The hook will be called with this identifier to dispatch to the right validator.\n   * Runs AFTER LLM reflection, can override the result.\n   */\n  customValidator?: string;\n\n  /**\n   * Validation mode:\n   * - 'strict': Validation failure marks task as failed (default)\n   * - 'warn': Validation failure logs warning but task still completes\n   */\n  mode?: 'strict' | 'warn';\n\n  /**\n   * Skip LLM self-reflection validation.\n   * LLM validation is opt-in: set to `false` to enable it (requires completionCriteria).\n   * Default: undefined (treated as true  validation auto-passes).\n   */\n  skipReflection?: boolean;\n}\n\n/**\n * Result of task validation (returned by LLM reflection)\n */\nexport interface TaskValidationResult {\n  /** Whether the task is considered complete */\n  isComplete: boolean;\n\n  /** Completeness score from 0-100 */\n  completionScore: number;\n\n  /** LLM's explanation of why the task is/isn't complete */\n  explanation: string;\n\n  /** Per-criterion evaluation results */\n  criteriaResults?: Array<{\n    criterion: string;\n    met: boolean;\n    evidence?: string;\n  }>;\n\n  /** Whether user approval is needed */\n  requiresUserApproval: boolean;\n\n  /** Reason for requiring user approval */\n  approvalReason?: string;\n}\n\n/**\n * A single unit of work\n */\nexport interface Task {\n  id: string;\n  name: string;\n  description: string;\n  status: TaskStatus;\n\n  /** Tasks that must complete before this one (task IDs) */\n  dependsOn: string[];\n\n  /** External dependency (if waiting on external event) */\n  externalDependency?: ExternalDependency;\n\n  /** Condition for execution */\n  condition?: TaskCondition;\n\n  /** Execution settings */\n  execution?: TaskExecution;\n\n  /** Completion validation settings */\n  validation?: TaskValidation;\n\n  /** Tool names the LLM should prefer for this task (advisory, not enforced) */\n  suggestedTools?: string[];\n\n  /** Optional expected output description */\n  expectedOutput?: string;\n\n  /** Control flow: map, fold, or until (replaces normal LLM execution for this task) */\n  controlFlow?: TaskControlFlow;\n\n  /** Result after completion */\n  result?: {\n    success: boolean;\n    output?: unknown;\n    error?: string;\n    /** Validation score (0-100) if validation was performed */\n    validationScore?: number;\n    /** Explanation of validation result */\n    validationExplanation?: string;\n  };\n\n  /** Timestamps */\n  createdAt: number;\n  startedAt?: number;\n  completedAt?: number;\n  lastUpdatedAt: number;\n\n  /** Retry tracking */\n  attempts: number;\n  maxAttempts: number;\n\n  /** Metadata for extensions */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Input for creating a task\n */\nexport interface TaskInput {\n  id?: string;\n  name: string;\n  description: string;\n  dependsOn?: string[];           // Task names or IDs\n  externalDependency?: ExternalDependency;\n  condition?: TaskCondition;\n  execution?: TaskExecution;\n  suggestedTools?: string[];\n  validation?: TaskValidation;\n  expectedOutput?: string;\n  controlFlow?: TaskControlFlow;\n  maxAttempts?: number;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Plan concurrency settings\n */\nexport interface PlanConcurrency {\n  maxParallelTasks: number;\n  strategy: 'fifo' | 'priority' | 'shortest-first';\n\n  /**\n   * How to handle failures when executing tasks in parallel\n   * - 'fail-fast': Stop on first failure (Promise.all behavior) - DEFAULT\n   * - 'continue': Continue other tasks on failure, mark failed ones\n   * - 'fail-all': Wait for all to complete, then report all failures together\n   */\n  failureMode?: 'fail-fast' | 'continue' | 'fail-all';\n}\n\n/**\n * Execution plan - a goal with steps to achieve it\n */\nexport interface Plan {\n  id: string;\n  goal: string;\n  context?: string;\n\n  tasks: Task[];\n\n  /** Concurrency settings */\n  concurrency?: PlanConcurrency;\n\n  /** Can agent modify the plan? */\n  allowDynamicTasks: boolean;\n\n  /** Plan status */\n  status: PlanStatus;\n\n  /** Why is the plan suspended? */\n  suspendedReason?: {\n    type: 'waiting_external' | 'manual_pause' | 'error';\n    taskId?: string;\n    message?: string;\n  };\n\n  /** Timestamps */\n  createdAt: number;\n  startedAt?: number;\n  completedAt?: number;\n  lastUpdatedAt: number;\n\n  /** For resume: which task to continue from */\n  currentTaskId?: string;\n\n  /** Metadata */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Input for creating a plan\n */\nexport interface PlanInput {\n  goal: string;\n  context?: string;\n  tasks: TaskInput[];\n  concurrency?: PlanConcurrency;\n  allowDynamicTasks?: boolean;\n  metadata?: Record<string, unknown>;\n  /** Skip dependency cycle detection (default: false) */\n  skipCycleCheck?: boolean;\n}\n\n/**\n * Memory access interface for condition evaluation\n */\nexport interface ConditionMemoryAccess {\n  get(key: string): Promise<unknown>;\n}\n\n// ============ Factory Functions ============\n\n/**\n * Create a task with defaults\n */\nexport function createTask(input: TaskInput): Task {\n  const now = Date.now();\n  const id = input.id ?? `task-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  return {\n    id,\n    name: input.name,\n    description: input.description,\n    status: 'pending',\n    dependsOn: input.dependsOn ?? [],\n    externalDependency: input.externalDependency,\n    condition: input.condition,\n    execution: input.execution,\n    suggestedTools: input.suggestedTools,\n    validation: input.validation,\n    expectedOutput: input.expectedOutput,\n    controlFlow: input.controlFlow,\n    attempts: 0,\n    maxAttempts: input.maxAttempts ?? 3,\n    createdAt: now,\n    lastUpdatedAt: now,\n    metadata: input.metadata,\n  };\n}\n\n/**\n * Create a plan with tasks\n * @throws {DependencyCycleError} If circular dependencies detected (unless skipCycleCheck is true)\n */\nexport function createPlan(input: PlanInput): Plan {\n  const now = Date.now();\n  const id = `plan-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  // Create tasks first\n  const tasks = input.tasks.map((taskInput) => createTask(taskInput));\n\n  // Build name to ID map\n  const nameToId = new Map<string, string>();\n  for (const task of tasks) {\n    nameToId.set(task.name, task.id);\n  }\n\n  // Resolve dependencies from names to IDs\n  for (let i = 0; i < tasks.length; i++) {\n    const taskInput = input.tasks[i]!;\n    const task = tasks[i]!;\n\n    if (taskInput.dependsOn && taskInput.dependsOn.length > 0) {\n      task.dependsOn = taskInput.dependsOn.map((dep) => {\n        // Check if it's already an ID (starts with 'task-')\n        if (dep.startsWith('task-')) {\n          return dep;\n        }\n\n        // Otherwise, it's a name - resolve it\n        const resolvedId = nameToId.get(dep);\n        if (!resolvedId) {\n          throw new Error(`Task dependency \"${dep}\" not found in plan`);\n        }\n        return resolvedId;\n      });\n    }\n  }\n\n  // Check for dependency cycles (unless explicitly skipped)\n  if (!input.skipCycleCheck) {\n    const cycle = detectDependencyCycle(tasks);\n    if (cycle) {\n      // Convert task IDs to names for better error message\n      const cycleNames = cycle.map((taskId) => {\n        const task = tasks.find((t) => t.id === taskId);\n        return task ? task.name : taskId;\n      });\n      throw new DependencyCycleError(cycleNames, id);\n    }\n  }\n\n  return {\n    id,\n    goal: input.goal,\n    context: input.context,\n    tasks,\n    concurrency: input.concurrency,\n    allowDynamicTasks: input.allowDynamicTasks ?? true,\n    status: 'pending',\n    createdAt: now,\n    lastUpdatedAt: now,\n    metadata: input.metadata,\n  };\n}\n\n// ============ Task Utilities ============\n\n/**\n * Check if a task can be executed (dependencies met, status is pending)\n */\nexport function canTaskExecute(task: Task, allTasks: Task[]): boolean {\n  // Must be pending\n  if (task.status !== 'pending') {\n    return false;\n  }\n\n  // Check if all dependencies are completed\n  if (task.dependsOn.length > 0) {\n    for (const depId of task.dependsOn) {\n      const depTask = allTasks.find((t) => t.id === depId);\n      if (!depTask || depTask.status !== 'completed') {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\n/**\n * Get the next tasks that can be executed\n */\nexport function getNextExecutableTasks(plan: Plan): Task[] {\n  const executable = plan.tasks.filter((task) => canTaskExecute(task, plan.tasks));\n\n  if (executable.length === 0) {\n    return [];\n  }\n\n  // If no concurrency config, return sequential (first one only)\n  if (!plan.concurrency) {\n    return [executable[0]!];\n  }\n\n  // Count currently running tasks\n  const runningCount = plan.tasks.filter((t) => t.status === 'in_progress').length;\n  const availableSlots = plan.concurrency.maxParallelTasks - runningCount;\n\n  if (availableSlots <= 0) {\n    return [];\n  }\n\n  // Filter for parallel-capable tasks\n  const parallelTasks = executable.filter((task) => task.execution?.parallel === true);\n\n  if (parallelTasks.length === 0) {\n    // No parallel tasks available, return first sequential task\n    return [executable[0]!];\n  }\n\n  // Sort by strategy\n  let sortedTasks = [...parallelTasks];\n  if (plan.concurrency.strategy === 'priority') {\n    sortedTasks.sort((a, b) => (b.execution?.priority ?? 0) - (a.execution?.priority ?? 0));\n  }\n  // 'fifo' and 'shortest-first' use default order (creation order)\n\n  // Return up to availableSlots tasks\n  return sortedTasks.slice(0, availableSlots);\n}\n\n/**\n * Evaluate a task condition against memory\n */\nexport async function evaluateCondition(\n  condition: TaskCondition,\n  memory: ConditionMemoryAccess\n): Promise<boolean> {\n  const value = await memory.get(condition.memoryKey);\n\n  switch (condition.operator) {\n    case 'exists':\n      return value !== undefined;\n\n    case 'not_exists':\n      return value === undefined;\n\n    case 'equals':\n      return value === condition.value;\n\n    case 'contains':\n      if (Array.isArray(value)) {\n        return value.includes(condition.value);\n      }\n      if (typeof value === 'string' && typeof condition.value === 'string') {\n        return value.includes(condition.value);\n      }\n      return false;\n\n    case 'truthy':\n      return !!value;\n\n    case 'greater_than':\n      if (typeof value === 'number' && typeof condition.value === 'number') {\n        return value > condition.value;\n      }\n      return false;\n\n    case 'less_than':\n      if (typeof value === 'number' && typeof condition.value === 'number') {\n        return value < condition.value;\n      }\n      return false;\n\n    default:\n      return false;\n  }\n}\n\n/**\n * Update task status and timestamps\n */\nexport function updateTaskStatus(task: Task, status: TaskStatus): Task {\n  const now = Date.now();\n  const updated: Task = {\n    ...task,\n    status,\n    lastUpdatedAt: now,\n  };\n\n  // Set startedAt when moving to in_progress (first time only)\n  // But always increment attempts when moving to in_progress\n  if (status === 'in_progress') {\n    if (!updated.startedAt) {\n      updated.startedAt = now;\n    }\n    updated.attempts += 1;\n  }\n\n  // Set completedAt when moving to completed or failed\n  if ((status === 'completed' || status === 'failed') && !updated.completedAt) {\n    updated.completedAt = now;\n  }\n\n  return updated;\n}\n\n/**\n * Check if a task is blocked by dependencies\n */\nexport function isTaskBlocked(task: Task, allTasks: Task[]): boolean {\n  if (task.dependsOn.length === 0) {\n    return false;\n  }\n\n  for (const depId of task.dependsOn) {\n    const depTask = allTasks.find((t) => t.id === depId);\n    if (!depTask) {\n      return true; // Dependency not found\n    }\n    if (depTask.status !== 'completed') {\n      return true; // Dependency not completed\n    }\n  }\n\n  return false;\n}\n\n/**\n * Get the dependency tasks for a task\n */\nexport function getTaskDependencies(task: Task, allTasks: Task[]): Task[] {\n  if (task.dependsOn.length === 0) {\n    return [];\n  }\n\n  return task.dependsOn\n    .map((depId) => allTasks.find((t) => t.id === depId))\n    .filter((t): t is Task => t !== undefined);\n}\n\n/**\n * Resolve task name dependencies to task IDs\n * Modifies taskInputs in place\n */\nexport function resolveDependencies(taskInputs: TaskInput[], tasks: Task[]): void {\n  // Build name to ID map\n  const nameToId = new Map<string, string>();\n  for (const task of tasks) {\n    nameToId.set(task.name, task.id);\n  }\n\n  // Resolve dependencies\n  for (const input of taskInputs) {\n    if (input.dependsOn && input.dependsOn.length > 0) {\n      input.dependsOn = input.dependsOn.map((dep) => {\n        // If it's already an ID, keep it\n        if (dep.startsWith('task-')) {\n          return dep;\n        }\n\n        // Otherwise, resolve name to ID\n        const resolvedId = nameToId.get(dep);\n        if (!resolvedId) {\n          throw new Error(`Task dependency \"${dep}\" not found`);\n        }\n        return resolvedId;\n      });\n    }\n  }\n}\n\n/**\n * Detect dependency cycles in tasks using depth-first search\n * @param tasks Array of tasks with resolved dependencies (IDs, not names)\n * @returns Array of task IDs forming the cycle (e.g., ['A', 'B', 'C', 'A']), or null if no cycle\n */\nexport function detectDependencyCycle(tasks: Task[]): string[] | null {\n  const visited = new Set<string>();\n  const recStack = new Set<string>();\n  const taskMap = new Map(tasks.map((t) => [t.id, t]));\n\n  /**\n   * DFS to detect back edges (cycles)\n   * @param taskId Current task being visited\n   * @param path Path from root to current node\n   * @returns Cycle path if found, null otherwise\n   */\n  function dfs(taskId: string, path: string[]): string[] | null {\n    // If taskId is in recursion stack, we found a cycle\n    if (recStack.has(taskId)) {\n      const cycleStart = path.indexOf(taskId);\n      return [...path.slice(cycleStart), taskId];\n    }\n\n    // If already fully visited, no cycle through this node\n    if (visited.has(taskId)) {\n      return null;\n    }\n\n    // Mark as being visited (in current DFS path)\n    visited.add(taskId);\n    recStack.add(taskId);\n\n    // Visit all dependencies (edges go from task to its dependencies)\n    const task = taskMap.get(taskId);\n    if (task) {\n      for (const depId of task.dependsOn) {\n        const cycle = dfs(depId, [...path, taskId]);\n        if (cycle) {\n          return cycle;\n        }\n      }\n    }\n\n    // Done with this node, remove from recursion stack\n    recStack.delete(taskId);\n    return null;\n  }\n\n  // Start DFS from each unvisited node\n  for (const task of tasks) {\n    if (!visited.has(task.id)) {\n      const cycle = dfs(task.id, []);\n      if (cycle) {\n        return cycle;\n      }\n    }\n  }\n\n  return null;\n}\n","/**\n * Routine entities for reusable task-based workflows.\n *\n * A RoutineDefinition is a template (recipe) that can be executed multiple times.\n * A RoutineExecution is a running instance backed by an existing Plan.\n */\n\nimport type { TaskInput, Plan, PlanConcurrency } from './Task.js';\nimport { createPlan, isTerminalStatus } from './Task.js';\n\n// ============================================================================\n// Routine Parameters\n// ============================================================================\n\n/**\n * A parameter that a routine accepts as input.\n * Enables parameterized, reusable routines.\n */\nexport interface RoutineParameter {\n  /** Parameter name (used as {{param.name}} in templates) */\n  name: string;\n  /** Human-readable description */\n  description: string;\n  /** Whether this parameter must be provided (default: false) */\n  required?: boolean;\n  /** Default value when not provided */\n  default?: unknown;\n}\n\n// ============================================================================\n// Routine Definition (Template)\n// ============================================================================\n\n/**\n * A reusable routine definition (template).\n *\n * Defines what to do but has no runtime state.\n * Multiple RoutineExecutions can be created from one RoutineDefinition.\n */\nexport interface RoutineDefinition {\n  /** Unique routine identifier */\n  id: string;\n\n  /** Human-readable name */\n  name: string;\n\n  /** Description of what this routine accomplishes */\n  description: string;\n\n  /** Version string for tracking routine evolution */\n  version?: string;\n\n  /** Task templates in execution order (dependencies may override order) */\n  tasks: TaskInput[];\n\n  /** Tool names that must be available before starting */\n  requiredTools?: string[];\n\n  /** Plugin names that must be enabled before starting (e.g. 'working_memory') */\n  requiredPlugins?: string[];\n\n  /** Additional instructions injected into system prompt when routine is active */\n  instructions?: string;\n\n  /** Concurrency settings for task execution */\n  concurrency?: PlanConcurrency;\n\n  /** Whether the LLM can dynamically add/modify tasks during execution. Default: false */\n  allowDynamicTasks?: boolean;\n\n  /** Input parameters this routine accepts (templates use {{param.name}}) */\n  parameters?: RoutineParameter[];\n\n  /** Tags for categorization and filtering */\n  tags?: string[];\n\n  /** Author/creator */\n  author?: string;\n\n  /** When the definition was created (ISO string) */\n  createdAt: string;\n\n  /** When the definition was last updated (ISO string) */\n  updatedAt: string;\n\n  /** Metadata for extensions */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Input for creating a RoutineDefinition.\n * id, createdAt, updatedAt are auto-generated if not provided.\n */\nexport interface RoutineDefinitionInput {\n  id?: string;\n  name: string;\n  description: string;\n  version?: string;\n  tasks: TaskInput[];\n  requiredTools?: string[];\n  requiredPlugins?: string[];\n  instructions?: string;\n  concurrency?: PlanConcurrency;\n  allowDynamicTasks?: boolean;\n  parameters?: RoutineParameter[];\n  tags?: string[];\n  author?: string;\n  metadata?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Routine Execution (Runtime)\n// ============================================================================\n\n/**\n * Execution status for a routine run\n */\nexport type RoutineExecutionStatus =\n  | 'pending'     // Created but not started\n  | 'running'     // Currently executing\n  | 'paused'      // Manually paused\n  | 'completed'   // All tasks completed successfully\n  | 'failed'      // Failed (unrecoverable)\n  | 'cancelled';  // Manually cancelled\n\n/**\n * Runtime state when executing a routine.\n * Created from a RoutineDefinition, delegates task management to Plan.\n */\nexport interface RoutineExecution {\n  /** Unique execution ID */\n  id: string;\n\n  /** Reference to the routine definition ID */\n  routineId: string;\n\n  /** The live plan managing task execution (created via createPlan) */\n  plan: Plan;\n\n  /** Current execution status */\n  status: RoutineExecutionStatus;\n\n  /** Overall progress (0-100) based on completed tasks */\n  progress: number;\n\n  /** Timestamps */\n  startedAt?: number;\n  completedAt?: number;\n  lastUpdatedAt: number;\n\n  /** Error message if failed */\n  error?: string;\n\n  /** Metadata */\n  metadata?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Factory Functions\n// ============================================================================\n\n/**\n * Create a RoutineDefinition with defaults.\n * Validates task dependency references and detects cycles.\n */\nexport function createRoutineDefinition(input: RoutineDefinitionInput): RoutineDefinition {\n  const now = new Date().toISOString();\n  const id = input.id ?? `routine-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  // Validate dependency references exist within the routine's tasks\n  const taskNames = new Set(input.tasks.map((t) => t.name));\n  const taskIds = new Set(input.tasks.filter((t) => t.id).map((t) => t.id!));\n\n  for (const task of input.tasks) {\n    if (task.dependsOn) {\n      for (const dep of task.dependsOn) {\n        if (!taskNames.has(dep) && !taskIds.has(dep)) {\n          throw new Error(\n            `Routine \"${input.name}\": task \"${task.name}\" depends on unknown task \"${dep}\"`\n          );\n        }\n      }\n    }\n  }\n\n  // Cycle detection: create a temporary plan (which runs detectDependencyCycle internally)\n  // This validates the dependency graph is a DAG\n  createPlan({\n    goal: input.name,\n    tasks: input.tasks,\n  });\n\n  return {\n    id,\n    name: input.name,\n    description: input.description,\n    version: input.version,\n    tasks: input.tasks,\n    requiredTools: input.requiredTools,\n    requiredPlugins: input.requiredPlugins,\n    instructions: input.instructions,\n    concurrency: input.concurrency,\n    allowDynamicTasks: input.allowDynamicTasks ?? false,\n    parameters: input.parameters,\n    tags: input.tags,\n    author: input.author,\n    createdAt: now,\n    updatedAt: now,\n    metadata: input.metadata,\n  };\n}\n\n/**\n * Create a RoutineExecution from a RoutineDefinition.\n * Instantiates all tasks into a Plan via createPlan().\n */\nexport function createRoutineExecution(definition: RoutineDefinition): RoutineExecution {\n  const now = Date.now();\n  const executionId = `rexec-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  const plan = createPlan({\n    goal: definition.name,\n    context: definition.description,\n    tasks: definition.tasks,\n    concurrency: definition.concurrency,\n    allowDynamicTasks: definition.allowDynamicTasks,\n  });\n\n  return {\n    id: executionId,\n    routineId: definition.id,\n    plan,\n    status: 'pending',\n    progress: 0,\n    lastUpdatedAt: now,\n  };\n}\n\n// ============================================================================\n// Utilities\n// ============================================================================\n\n/**\n * Compute routine progress (0-100) from plan task statuses.\n */\nexport function getRoutineProgress(execution: RoutineExecution): number {\n  const { tasks } = execution.plan;\n  if (tasks.length === 0) return 100;\n\n  const completed = tasks.filter((t) => isTerminalStatus(t.status)).length;\n  return Math.round((completed / tasks.length) * 100);\n}\n","/**\n * JSON Extractor Utilities\n *\n * Extracts JSON from LLM responses that may contain markdown formatting,\n * code blocks, or other text mixed with JSON data.\n */\n\n/**\n * Result of JSON extraction attempt\n */\nexport interface JSONExtractionResult<T = unknown> {\n  /** Whether extraction was successful */\n  success: boolean;\n  /** Extracted and parsed data (if successful) */\n  data?: T;\n  /** Raw JSON string that was parsed (if found) */\n  rawJson?: string;\n  /** Error message (if failed) */\n  error?: string;\n  /** How the JSON was found */\n  method?: 'code_block' | 'inline' | 'raw';\n}\n\n/**\n * Extract JSON from a string that may contain markdown code blocks or other formatting.\n *\n * Tries multiple extraction strategies in order:\n * 1. JSON inside markdown code blocks (```json ... ``` or ``` ... ```)\n * 2. First complete JSON object/array found in text\n * 3. Raw string as JSON\n *\n * @param text - Text that may contain JSON\n * @returns Extraction result with parsed data or error\n *\n * @example\n * ```typescript\n * const response = `Here's the result:\n * \\`\\`\\`json\n * {\"score\": 85, \"valid\": true}\n * \\`\\`\\`\n * That's the answer.`;\n *\n * const result = extractJSON<{score: number, valid: boolean}>(response);\n * if (result.success) {\n *   console.log(result.data.score); // 85\n * }\n * ```\n */\nexport function extractJSON<T = unknown>(text: string): JSONExtractionResult<T> {\n  if (!text || typeof text !== 'string') {\n    return {\n      success: false,\n      error: 'Input is empty or not a string',\n    };\n  }\n\n  const trimmedText = text.trim();\n\n  // Strategy 1: Try to find JSON in markdown code blocks\n  const codeBlockResult = extractFromCodeBlock<T>(trimmedText);\n  if (codeBlockResult.success) {\n    return codeBlockResult;\n  }\n\n  // Strategy 2: Try to find inline JSON object or array\n  const inlineResult = extractInlineJSON<T>(trimmedText);\n  if (inlineResult.success) {\n    return inlineResult;\n  }\n\n  // Strategy 3: Try parsing the raw text as JSON\n  try {\n    const data = JSON.parse(trimmedText) as T;\n    return {\n      success: true,\n      data,\n      rawJson: trimmedText,\n      method: 'raw',\n    };\n  } catch (e) {\n    return {\n      success: false,\n      error: `Could not extract JSON from text: ${e instanceof Error ? e.message : String(e)}`,\n    };\n  }\n}\n\n/**\n * Extract JSON from markdown code blocks\n */\nfunction extractFromCodeBlock<T>(text: string): JSONExtractionResult<T> {\n  // Match ```json ... ``` or ``` ... ``` code blocks\n  const codeBlockRegex = /```(?:json)?\\s*([\\s\\S]*?)```/g;\n  let match: RegExpExecArray | null;\n\n  while ((match = codeBlockRegex.exec(text)) !== null) {\n    const content = match[1];\n    if (content) {\n      const trimmed = content.trim();\n      try {\n        const data = JSON.parse(trimmed) as T;\n        return {\n          success: true,\n          data,\n          rawJson: trimmed,\n          method: 'code_block',\n        };\n      } catch {\n        // This code block doesn't contain valid JSON, try next\n        continue;\n      }\n    }\n  }\n\n  return { success: false };\n}\n\n/**\n * Extract inline JSON object or array from text\n */\nfunction extractInlineJSON<T>(text: string): JSONExtractionResult<T> {\n  // Try to find a JSON object\n  const objectMatch = findJSONObject(text);\n  if (objectMatch) {\n    try {\n      const data = JSON.parse(objectMatch) as T;\n      return {\n        success: true,\n        data,\n        rawJson: objectMatch,\n        method: 'inline',\n      };\n    } catch {\n      // Not valid JSON despite matching braces\n    }\n  }\n\n  // Try to find a JSON array\n  const arrayMatch = findJSONArray(text);\n  if (arrayMatch) {\n    try {\n      const data = JSON.parse(arrayMatch) as T;\n      return {\n        success: true,\n        data,\n        rawJson: arrayMatch,\n        method: 'inline',\n      };\n    } catch {\n      // Not valid JSON despite matching brackets\n    }\n  }\n\n  return { success: false };\n}\n\n/**\n * Find the first complete JSON object in text by matching braces\n */\nfunction findJSONObject(text: string): string | null {\n  const startIndex = text.indexOf('{');\n  if (startIndex === -1) return null;\n\n  let depth = 0;\n  let inString = false;\n  let escaped = false;\n\n  for (let i = startIndex; i < text.length; i++) {\n    const char = text[i];\n\n    if (escaped) {\n      escaped = false;\n      continue;\n    }\n\n    if (char === '\\\\' && inString) {\n      escaped = true;\n      continue;\n    }\n\n    if (char === '\"') {\n      inString = !inString;\n      continue;\n    }\n\n    if (inString) continue;\n\n    if (char === '{') {\n      depth++;\n    } else if (char === '}') {\n      depth--;\n      if (depth === 0) {\n        return text.slice(startIndex, i + 1);\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find the first complete JSON array in text by matching brackets\n */\nfunction findJSONArray(text: string): string | null {\n  const startIndex = text.indexOf('[');\n  if (startIndex === -1) return null;\n\n  let depth = 0;\n  let inString = false;\n  let escaped = false;\n\n  for (let i = startIndex; i < text.length; i++) {\n    const char = text[i];\n\n    if (escaped) {\n      escaped = false;\n      continue;\n    }\n\n    if (char === '\\\\' && inString) {\n      escaped = true;\n      continue;\n    }\n\n    if (char === '\"') {\n      inString = !inString;\n      continue;\n    }\n\n    if (inString) continue;\n\n    if (char === '[') {\n      depth++;\n    } else if (char === ']') {\n      depth--;\n      if (depth === 0) {\n        return text.slice(startIndex, i + 1);\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Safely extract a specific field from JSON embedded in text\n *\n * @param text - Text that may contain JSON\n * @param field - Field name to extract\n * @param defaultValue - Default value if extraction fails\n * @returns Extracted value or default\n *\n * @example\n * ```typescript\n * const score = extractJSONField<number>(llmResponse, 'completionScore', 50);\n * ```\n */\nexport function extractJSONField<T>(\n  text: string,\n  field: string,\n  defaultValue: T\n): T {\n  const result = extractJSON<Record<string, unknown>>(text);\n  if (result.success && result.data && field in result.data) {\n    return result.data[field] as T;\n  }\n  return defaultValue;\n}\n\n/**\n * Extract a number from text, trying JSON first, then regex patterns\n *\n * @param text - Text that may contain a number\n * @param patterns - Optional regex patterns to try (default: common score patterns)\n * @param defaultValue - Default value if extraction fails\n * @returns Extracted number or default\n *\n * @example\n * ```typescript\n * const score = extractNumber(llmResponse, [/(\\d{1,3})%?\\s*complete/i], 50);\n * ```\n */\nexport function extractNumber(\n  text: string,\n  patterns: RegExp[] = [\n    /(\\d{1,3})%?\\s*(?:complete|score|percent)/i,\n    /(?:score|completion|rating)[:\\s]+(\\d{1,3})/i,\n    /(\\d{1,3})\\s*(?:out of|\\/)\\s*100/i,\n  ],\n  defaultValue: number = 0\n): number {\n  // Try JSON extraction first\n  const jsonResult = extractJSON<Record<string, unknown>>(text);\n  if (jsonResult.success && jsonResult.data) {\n    // Look for common score field names\n    const scoreFields = ['score', 'completionScore', 'completion_score', 'rating', 'percent', 'value'];\n    for (const field of scoreFields) {\n      if (field in jsonResult.data && typeof jsonResult.data[field] === 'number') {\n        return jsonResult.data[field] as number;\n      }\n    }\n  }\n\n  // Try regex patterns\n  for (const pattern of patterns) {\n    const match = text.match(pattern);\n    if (match && match[1]) {\n      const num = parseInt(match[1], 10);\n      if (!isNaN(num)) {\n        return num;\n      }\n    }\n  }\n\n  return defaultValue;\n}\n","/**\n * Routine Execution Runner\n *\n * Executes a RoutineDefinition by creating an Agent, running tasks in dependency order,\n * validating completion via LLM self-reflection, and using working/in-context memory\n * as the bridge between tasks.\n */\n\nimport { Agent } from './Agent.js';\nimport type { ToolFunction } from '../domain/entities/Tool.js';\nimport type {\n  Task,\n  TaskValidationResult,\n  TaskMapFlow,\n  TaskFoldFlow,\n} from '../domain/entities/Task.js';\nimport {\n  getNextExecutableTasks,\n  updateTaskStatus,\n  isTerminalStatus,\n} from '../domain/entities/Task.js';\nimport type {\n  RoutineDefinition,\n  RoutineExecution,\n} from '../domain/entities/Routine.js';\nimport {\n  createRoutineExecution,\n  getRoutineProgress,\n} from '../domain/entities/Routine.js';\nimport { ContentType } from '../domain/entities/Content.js';\nimport type { Content } from '../domain/entities/Content.js';\nimport type { Message, OutputItem } from '../domain/entities/Message.js';\nimport type { HookConfig } from '../capabilities/agents/types/HookTypes.js';\nimport { extractJSON } from '../utils/jsonExtractor.js';\nimport { logger } from '../infrastructure/observability/Logger.js';\nimport { ProviderAuthError, ProviderContextLengthError, ProviderNotFoundError, ModelNotSupportedError, InvalidConfigError } from '../domain/errors/AIErrors.js';\nimport {\n  validateAndResolveInputs,\n  resolveTaskTemplates,\n  executeControlFlow,\n  ROUTINE_KEYS,\n  getPlugins,\n} from './routineControlFlow.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/**\n * Options for executing a routine.\n *\n * Two modes:\n * 1. **New agent**: Pass `connector` + `model` (+ optional `tools`, `hooks`).\n *    An agent is created internally and destroyed after execution.\n * 2. **Existing agent**: Pass `agent` (a pre-created Agent instance).\n *    The agent is NOT destroyed after execution  caller owns its lifecycle.\n *    The agent's existing connector, model, tools, and hooks are used.\n */\nexport interface ExecuteRoutineOptions {\n  /** Routine definition to execute */\n  definition: RoutineDefinition;\n\n  /**\n   * Pre-created Agent instance. When provided, `connector`/`model`/`tools` are ignored.\n   * The agent is NOT destroyed after execution  caller manages its lifecycle.\n   */\n  agent?: Agent;\n\n  /** Connector name  required when `agent` is not provided */\n  connector?: string;\n\n  /** Model ID  required when `agent` is not provided */\n  model?: string;\n\n  /** Additional tools  only used when creating a new agent (no `agent` provided) */\n  tools?: ToolFunction[];\n\n  /** Input parameter values for parameterized routines */\n  inputs?: Record<string, unknown>;\n\n  /** Hooks  applied to agent for the duration of routine execution.\n   *  For new agents: baked in at creation. For existing agents: registered before\n   *  execution and unregistered after. */\n  hooks?: HookConfig;\n\n  /** Called when a task starts executing (set to in_progress) */\n  onTaskStarted?: (task: Task, execution: RoutineExecution) => void;\n\n  /** Called when a task completes successfully */\n  onTaskComplete?: (task: Task, execution: RoutineExecution) => void;\n\n  /** Called when a task fails */\n  onTaskFailed?: (task: Task, execution: RoutineExecution) => void;\n\n  /** Called after each validation attempt (whether pass or fail) */\n  onTaskValidation?: (task: Task, result: TaskValidationResult, execution: RoutineExecution) => void;\n\n  /** Configurable prompts (all have sensible defaults) */\n  prompts?: {\n    /** Override system prompt builder. Receives definition, should return full system prompt. */\n    system?: (definition: RoutineDefinition) => string;\n    /** Override task prompt builder. Receives task and optional execution context, should return the user message for that task. */\n    task?: (task: Task, execution?: RoutineExecution) => string;\n    /** Override validation prompt builder. Receives task + validation context (response, memory state, tool calls). */\n    validation?: (task: Task, context: ValidationContext) => string;\n  };\n}\n\n/**\n * Context snapshot passed to the validation prompt builder.\n * Contains everything the validator needs to evaluate task completion\n * WITHOUT conversation history.\n */\nexport interface ValidationContext {\n  /** Agent's final text output */\n  responseText: string;\n  /** Current in-context memory entries (key-value pairs set via context_set) */\n  inContextMemory: string | null;\n  /** Current working memory index (keys + descriptions of stored data) */\n  workingMemoryIndex: string | null;\n  /** Formatted log of all tool calls made during this task execution */\n  toolCallLog: string;\n}\n\n// ============================================================================\n// Default Prompt Builders\n// ============================================================================\n\n/**\n * Default system prompt for routine execution.\n */\nfunction defaultSystemPrompt(definition: RoutineDefinition): string {\n  const parts: string[] = [];\n\n  if (definition.instructions) {\n    parts.push(definition.instructions);\n  }\n\n  parts.push(\n    `You are executing a routine called \"${definition.name}\".`,\n    '',\n    'Between tasks, your conversation history is cleared but your memory persists.',\n    'Use these strategies to pass information between tasks:',\n    '- Use context_set for small key results that subsequent tasks need immediately (visible in context, no retrieval needed).',\n    '- Use memory_store with tier=\"findings\" for larger data that may be needed later.',\n    '- Use memory_retrieve to access data stored by previous tasks.',\n    '',\n    'IMPORTANT: When you have completed the current task, you MUST stop immediately.',\n    'Do NOT repeat work you have already done. Do NOT re-fetch data you already have.',\n    'Store key results in memory once, then produce a final text response (no more tool calls) to signal completion.'\n  );\n\n  return parts.join('\\n');\n}\n\n/** Describes what a downstream control flow task needs from the current task's output. */\ninterface OutputContract {\n  storageKey: string;\n  format: 'array';\n  consumingTaskName: string;\n  flowType: 'map' | 'fold';\n}\n\n/**\n * Scan the execution plan for downstream control flow tasks that reference\n * the current task via source.task. Returns output storage contracts.\n */\nfunction getOutputContracts(\n  execution: RoutineExecution,\n  currentTask: Task\n): OutputContract[] {\n  const contracts: OutputContract[] = [];\n\n  for (const task of execution.plan.tasks) {\n    if (task.status !== 'pending' || !task.controlFlow) continue;\n    const flow = task.controlFlow;\n    if (flow.type === 'until') continue;\n\n    const source = (flow as TaskMapFlow | TaskFoldFlow).source;\n\n    const sourceTaskName = typeof source === 'string'\n      ? undefined  // string source = key reference, not task reference\n      : source.task;\n\n    if (sourceTaskName === currentTask.name) {\n      contracts.push({\n        storageKey: `${ROUTINE_KEYS.TASK_OUTPUT_PREFIX}${currentTask.name}`,\n        format: 'array',\n        consumingTaskName: task.name,\n        flowType: flow.type as 'map' | 'fold',\n      });\n    }\n  }\n\n  return contracts;\n}\n\n/**\n * Default task prompt builder.\n */\nfunction defaultTaskPrompt(task: Task, execution?: RoutineExecution): string {\n  const parts: string[] = [];\n\n  parts.push(`## Current Task: ${task.name}`, '');\n  parts.push(task.description, '');\n\n  if (task.expectedOutput) {\n    parts.push(`**Expected output:** ${task.expectedOutput}`, '');\n  }\n\n  if (task.suggestedTools && task.suggestedTools.length > 0) {\n    parts.push(`**Suggested tools:** ${task.suggestedTools.join(', ')}`, '');\n  }\n\n  const criteria = task.validation?.completionCriteria;\n  if (criteria && criteria.length > 0) {\n    parts.push('### Completion Criteria');\n    parts.push('When you are done, ensure the following are met:');\n    for (const c of criteria) {\n      parts.push(`- ${c}`);\n    }\n    parts.push('');\n  }\n\n  if (task.dependsOn.length > 0) {\n    parts.push('Note: Results from prerequisite tasks are available in your live context.');\n    parts.push('Small results appear directly; larger results are in working memory  use memory_retrieve to access them.');\n    parts.push('Review the plan overview and dependency results before starting.');\n    parts.push('');\n  }\n\n  // Output contract injection  tell the LLM how to store results for downstream control flow\n  if (execution) {\n    const contracts = getOutputContracts(execution, task);\n    if (contracts.length > 0) {\n      parts.push('### Output Storage');\n      for (const contract of contracts) {\n        parts.push(\n          `A downstream task (\"${contract.consumingTaskName}\") will ${contract.flowType} over your results.`,\n          `Store your result as a JSON ${contract.format} using:`,\n          `  context_set(\"${contract.storageKey}\", <your JSON ${contract.format}>)`,\n          'Each array element should represent one item to process independently.',\n          ''\n        );\n      }\n    }\n  }\n\n  parts.push('After completing the work, store key results in memory once, then respond with a text summary (no more tool calls).');\n\n  return parts.join('\\n');\n}\n\n/**\n * Default validation prompt builder.\n * Receives the full validation context: response text, memory state, and tool call log.\n */\nfunction defaultValidationPrompt(task: Task, context: ValidationContext): string {\n  const criteria = task.validation?.completionCriteria ?? [];\n  const criteriaList = criteria.length > 0\n    ? criteria.map((c, i) => `${i + 1}. ${c}`).join('\\n')\n    : 'The task was completed as described.';\n\n  const parts: string[] = [\n    `Evaluate if the task \"${task.name}\" was completed successfully.`,\n    '',\n    `Task description: ${task.description}`,\n    '',\n    'Completion criteria:',\n    criteriaList,\n    '',\n    '--- EVIDENCE ---',\n    '',\n    'Agent response (final text output):',\n    context.responseText || '(no text output)',\n    '',\n    'Tool calls made during this task:',\n    context.toolCallLog,\n  ];\n\n  if (context.inContextMemory) {\n    parts.push('', 'In-context memory (current state):', context.inContextMemory);\n  }\n\n  if (context.workingMemoryIndex) {\n    parts.push('', 'Working memory index (stored data):', context.workingMemoryIndex);\n  }\n\n  parts.push(\n    '',\n    '--- END EVIDENCE ---',\n    '',\n    'Use the evidence above to verify each criterion. Check tool call results, not just the agent\\'s claims.',\n    '',\n    'Return a JSON object with the following structure:',\n    '```json',\n    '{ \"isComplete\": boolean, \"completionScore\": number (0-100), \"explanation\": \"...\" }',\n    '```',\n    '',\n    'Be strict: only mark isComplete=true if all criteria are clearly met based on the evidence.',\n  );\n\n  return parts.join('\\n');\n}\n\n// ============================================================================\n// Context Collection\n// ============================================================================\n\n/**\n * Extract a formatted tool call log from the conversation history.\n * Shows every tool_use  tool_result pair so the validator can see what actually happened.\n */\nfunction formatToolCallLog(conversation: ReadonlyArray<OutputItem>): string {\n  const calls: string[] = [];\n\n  for (const item of conversation) {\n    if (!('content' in item) || !Array.isArray((item as Message).content)) continue;\n    const msg = item as Message;\n    for (const c of msg.content as Content[]) {\n      if (c.type === ContentType.TOOL_USE) {\n        let argsStr: string;\n        try {\n          // Pretty-print but truncate large args\n          const parsed = JSON.parse(c.arguments);\n          argsStr = JSON.stringify(parsed, null, 2);\n          if (argsStr.length > 500) argsStr = argsStr.slice(0, 500) + '... (truncated)';\n        } catch {\n          argsStr = c.arguments;\n        }\n        calls.push(`CALL: ${c.name}(${argsStr})`);\n      } else if (c.type === ContentType.TOOL_RESULT) {\n        let resultStr = typeof c.content === 'string' ? c.content : JSON.stringify(c.content);\n        if (resultStr.length > 500) resultStr = resultStr.slice(0, 500) + '... (truncated)';\n        const prefix = c.error ? 'ERROR' : 'RESULT';\n        calls.push(`  ${prefix}: ${resultStr}`);\n      }\n    }\n  }\n\n  return calls.length > 0 ? calls.join('\\n') : '(no tool calls)';\n}\n\n/**\n * Collect all context the validator needs: memory state + tool call log.\n */\nasync function collectValidationContext(\n  agent: Agent,\n  responseText: string\n): Promise<ValidationContext> {\n  // Get in-context memory state\n  const icmPlugin = agent.context.getPlugin('in_context_memory');\n  const inContextMemory = icmPlugin ? await icmPlugin.getContent() : null;\n\n  // Get working memory index\n  const wmPlugin = agent.context.memory;\n  const workingMemoryIndex = wmPlugin ? await wmPlugin.getContent() : null;\n\n  // Get tool call log from conversation history\n  const conversation = agent.context.getConversation();\n  const toolCallLog = formatToolCallLog(conversation);\n\n  return {\n    responseText,\n    inContextMemory,\n    workingMemoryIndex,\n    toolCallLog,\n  };\n}\n\n// ============================================================================\n// Error Classification\n// ============================================================================\n\n/**\n * Determine if an error is transient (worth retrying) or permanent (should fail immediately).\n * Unknown errors default to transient  safer to retry than to give up prematurely.\n */\nfunction isTransientError(error: unknown): boolean {\n  // Permanent errors: configuration, auth, or model issues that won't resolve on retry\n  if (error instanceof ProviderAuthError) return false;\n  if (error instanceof ProviderContextLengthError) return false;\n  if (error instanceof ProviderNotFoundError) return false;\n  if (error instanceof ModelNotSupportedError) return false;\n  if (error instanceof InvalidConfigError) return false;\n  // Everything else (rate limits, timeouts, network errors, etc.)  retry\n  return true;\n}\n\n// ============================================================================\n// Routine Context Injection\n// ============================================================================\n\n/**\n * Simple token estimator: ~4 chars per token.\n */\nfunction estimateTokens(text: string): number {\n  return Math.ceil(text.length / 4);\n}\n\n/**\n * Build a compact plan overview showing all tasks with statuses and dependencies.\n */\nfunction buildPlanOverview(execution: RoutineExecution, definition: RoutineDefinition, currentTaskId?: string): string {\n  const parts: string[] = [];\n  const progress = execution.progress ?? 0;\n\n  parts.push(`Routine: ${definition.name}`);\n  if (definition.description) {\n    parts.push(`Goal: ${definition.description}`);\n  }\n  parts.push(`Progress: ${Math.round(progress * 100)}%`);\n  parts.push('');\n  parts.push('Tasks:');\n\n  for (const task of execution.plan.tasks) {\n    let statusIcon: string;\n    switch (task.status) {\n      case 'completed': statusIcon = '[x]'; break;\n      case 'in_progress': statusIcon = '[>]'; break;\n      case 'failed': statusIcon = '[!]'; break;\n      case 'skipped': statusIcon = '[-]'; break;\n      default: statusIcon = '[ ]';\n    }\n\n    let line = `${statusIcon} ${task.name}`;\n\n    if (task.dependsOn.length > 0) {\n      const depNames = task.dependsOn\n        .map((depId) => execution.plan.tasks.find((t) => t.id === depId)?.name ?? depId)\n        .join(', ');\n      line += ` (after: ${depNames})`;\n    }\n\n    if (task.id === currentTaskId) {\n      line += '   CURRENT';\n    }\n\n    parts.push(line);\n  }\n\n  return parts.join('\\n');\n}\n\n/**\n * Delete ICM/WM entries matching given prefix lists.\n * Shared by injectRoutineContext (dep cleanup) and cleanupRoutineContext (full cleanup).\n */\nasync function cleanupMemoryKeys(\n  icmPlugin: ReturnType<typeof getPlugins>['icmPlugin'],\n  wmPlugin: ReturnType<typeof getPlugins>['wmPlugin'],\n  config: {\n    icmPrefixes: string[];\n    icmExactKeys?: string[];\n    wmPrefixes: string[];\n  }\n): Promise<void> {\n  if (icmPlugin) {\n    for (const entry of icmPlugin.list()) {\n      const shouldDelete =\n        config.icmPrefixes.some((p) => entry.key.startsWith(p)) ||\n        (config.icmExactKeys?.includes(entry.key) ?? false);\n      if (shouldDelete) icmPlugin.delete(entry.key);\n    }\n  }\n\n  if (wmPlugin) {\n    const { entries: wmEntries } = await wmPlugin.query();\n    for (const entry of wmEntries) {\n      if (config.wmPrefixes.some((p) => entry.key.startsWith(p))) {\n        await wmPlugin.delete(entry.key);\n      }\n    }\n  }\n}\n\n/** Prefixes for dependency-only cleanup (between tasks). */\nconst DEP_CLEANUP_CONFIG = {\n  icmPrefixes: [ROUTINE_KEYS.DEP_RESULT_PREFIX],\n  icmExactKeys: [ROUTINE_KEYS.DEPS],\n  wmPrefixes: [ROUTINE_KEYS.DEP_RESULT_PREFIX, ROUTINE_KEYS.WM_DEP_FINDINGS_PREFIX],\n};\n\n/** Prefixes for full routine cleanup (after execution). */\nconst FULL_CLEANUP_CONFIG = {\n  icmPrefixes: ['__routine_', ROUTINE_KEYS.DEP_RESULT_PREFIX, '__map_', '__fold_', ROUTINE_KEYS.TASK_OUTPUT_PREFIX],\n  wmPrefixes: [ROUTINE_KEYS.DEP_RESULT_PREFIX, ROUTINE_KEYS.WM_DEP_FINDINGS_PREFIX, ROUTINE_KEYS.TASK_OUTPUT_PREFIX],\n};\n\n/**\n * Inject routine context (plan overview + dependency results) into ICM/WM\n * before each task runs.\n *\n * Strategy:\n * - Plan overview  ICM as __routine_plan (high priority)\n * - Small dep results (< 5000 tokens)  ICM as __dep_result_{depId}\n * - Large dep results (>= 5000 tokens)  WM as __dep_result_{depId}\n * - Dependency summary note  ICM as __routine_deps\n */\nasync function injectRoutineContext(\n  agent: Agent,\n  execution: RoutineExecution,\n  definition: RoutineDefinition,\n  currentTask: Task\n): Promise<void> {\n  const { icmPlugin, wmPlugin } = getPlugins(agent);\n\n  if (!icmPlugin && !wmPlugin) {\n    logger.warn('injectRoutineContext: No ICM or WM plugin available  skipping context injection');\n    return;\n  }\n\n  // 1. Inject plan overview into ICM\n  const planOverview = buildPlanOverview(execution, definition, currentTask.id);\n  if (icmPlugin) {\n    icmPlugin.set(ROUTINE_KEYS.PLAN, 'Routine plan overview with task statuses', planOverview, 'high');\n  }\n\n  // 2. Clean up previous task's dependency keys\n  await cleanupMemoryKeys(icmPlugin, wmPlugin, DEP_CLEANUP_CONFIG);\n\n  // 3. Inject dependency results\n  if (currentTask.dependsOn.length === 0) return;\n\n  const inContextDeps: string[] = [];\n  const workingMemoryDeps: string[] = [];\n\n  for (const depId of currentTask.dependsOn) {\n    const depTask = execution.plan.tasks.find((t) => t.id === depId);\n    if (!depTask?.result?.output) continue;\n\n    const output = typeof depTask.result.output === 'string'\n      ? depTask.result.output\n      : JSON.stringify(depTask.result.output);\n\n    const tokens = estimateTokens(output);\n    const depKey = `${ROUTINE_KEYS.DEP_RESULT_PREFIX}${depId}`;\n    const depLabel = `Result from task \"${depTask.name}\"`;\n\n    if (tokens < 5000 && icmPlugin) {\n      // Small result  ICM (directly in context)\n      icmPlugin.set(depKey, depLabel, output, 'high');\n      inContextDeps.push(depTask.name);\n    } else if (wmPlugin) {\n      // Large result  WM (accessible via memory_retrieve)\n      await wmPlugin.store(depKey, depLabel, output, { tier: 'findings' });\n      workingMemoryDeps.push(depTask.name);\n    } else if (icmPlugin) {\n      // No WM available, truncate and put in ICM\n      const truncated = output.slice(0, 20000) + '\\n... (truncated, full result not available)';\n      icmPlugin.set(depKey, depLabel, truncated, 'high');\n      inContextDeps.push(depTask.name + ' (truncated)');\n    }\n  }\n\n  // 4. Inject dependency summary note\n  if (icmPlugin && (inContextDeps.length > 0 || workingMemoryDeps.length > 0)) {\n    const summaryParts: string[] = ['Dependency results available:'];\n    if (inContextDeps.length > 0) {\n      summaryParts.push(`In context (visible now): ${inContextDeps.join(', ')}`);\n    }\n    if (workingMemoryDeps.length > 0) {\n      summaryParts.push(`In working memory (use memory_retrieve): ${workingMemoryDeps.join(', ')}`);\n    }\n    icmPlugin.set(ROUTINE_KEYS.DEPS, 'Dependency results location guide', summaryParts.join('\\n'), 'high');\n  }\n}\n\n/**\n * Clean up all routine-managed keys from ICM and WM.\n */\nasync function cleanupRoutineContext(agent: Agent): Promise<void> {\n  const { icmPlugin, wmPlugin } = getPlugins(agent);\n  await cleanupMemoryKeys(icmPlugin, wmPlugin, FULL_CLEANUP_CONFIG);\n}\n\n// ============================================================================\n// Validation Helper\n// ============================================================================\n\n/**\n * Validate task completion using LLM self-reflection via agent.runDirect().\n * Collects full context (memory state, tool calls) so the validator can verify\n * what actually happened, not just what the agent claimed.\n *\n * LLM validation is OPT-IN: it only runs when the task explicitly sets\n * `validation.skipReflection = false` AND provides completionCriteria.\n * By default, tasks auto-pass with score 100.\n */\nasync function validateTaskCompletion(\n  agent: Agent,\n  task: Task,\n  responseText: string,\n  validationPromptBuilder: (task: Task, context: ValidationContext) => string\n): Promise<TaskValidationResult> {\n  // LLM validation is opt-in: only run when skipReflection is explicitly false\n  // AND completion criteria are provided. Otherwise auto-pass.\n  const hasExplicitValidation =\n    task.validation?.skipReflection === false &&\n    task.validation?.completionCriteria &&\n    task.validation.completionCriteria.length > 0;\n\n  if (!hasExplicitValidation) {\n    return {\n      isComplete: true,\n      completionScore: 100,\n      explanation: 'Auto-passed (LLM validation not enabled)',\n      requiresUserApproval: false,\n    };\n  }\n\n  // Collect full context snapshot for the validator\n  const validationContext = await collectValidationContext(agent, responseText);\n\n  const prompt = validationPromptBuilder(task, validationContext);\n  const response = await agent.runDirect(prompt, {\n    instructions: 'You are a task completion evaluator. Return only JSON.',\n    temperature: 0.1,\n  });\n\n  const text = response.output_text ?? '';\n  const extracted = extractJSON<{\n    isComplete: boolean;\n    completionScore: number;\n    explanation: string;\n  }>(text);\n\n  if (!extracted.success || !extracted.data) {\n    // Failed to parse validation response  treat as uncertain\n    return {\n      isComplete: false,\n      completionScore: 0,\n      explanation: `Failed to parse validation response: ${extracted.error ?? 'unknown error'}`,\n      requiresUserApproval: false,\n    };\n  }\n\n  const { isComplete, completionScore, explanation } = extracted.data;\n  const minScore = task.validation?.minCompletionScore ?? 80;\n\n  return {\n    isComplete: isComplete && completionScore >= minScore,\n    completionScore,\n    explanation,\n    requiresUserApproval: false,\n  };\n}\n\n// ============================================================================\n// Main Runner\n// ============================================================================\n\n/**\n * Execute a routine definition.\n *\n * Creates an Agent with working memory + in-context memory enabled, then runs\n * each task in dependency order. Between tasks, conversation history is cleared\n * but memory plugins persist, allowing tasks to share data via memory.\n *\n * @example\n * ```typescript\n * const execution = await executeRoutine({\n *   definition: myRoutine,\n *   connector: 'openai',\n *   model: 'gpt-4',\n *   tools: [myCustomTool],\n *   onTaskComplete: (task) => console.log(` ${task.name}`),\n * });\n *\n * console.log(execution.status); // 'completed' | 'failed'\n * ```\n */\nexport async function executeRoutine(options: ExecuteRoutineOptions): Promise<RoutineExecution> {\n  const {\n    definition,\n    agent: existingAgent,\n    connector,\n    model,\n    tools: extraTools,\n    onTaskStarted,\n    onTaskComplete,\n    onTaskFailed,\n    onTaskValidation,\n    hooks,\n    prompts,\n    inputs: rawInputs,\n  } = options;\n\n  // Validate: must provide either `agent` or `connector` + `model`\n  if (!existingAgent && (!connector || !model)) {\n    throw new Error('executeRoutine requires either `agent` or both `connector` and `model`');\n  }\n\n  // Validate and resolve input parameters\n  const resolvedInputs = validateAndResolveInputs(definition.parameters, rawInputs);\n\n  const ownsAgent = !existingAgent;\n  const log = logger.child({ routine: definition.name });\n\n  // 1. Create execution\n  const execution = createRoutineExecution(definition);\n  execution.status = 'running';\n  execution.startedAt = Date.now();\n  execution.lastUpdatedAt = Date.now();\n\n  // 2. Resolve prompt builders\n  const buildSystemPrompt = prompts?.system ?? defaultSystemPrompt;\n  const userTaskPromptBuilder = prompts?.task ?? defaultTaskPrompt;\n  const buildTaskPrompt = (task: Task) => userTaskPromptBuilder(task, execution);\n  const buildValidationPrompt = prompts?.validation ?? defaultValidationPrompt;\n\n  // 3. Resolve agent: reuse existing or create new\n  let agent: Agent;\n\n  // Track hooks registered on an existing agent so we can unregister in finally\n  const registeredHooks: Array<{ name: string; hook: Function }> = [];\n\n  if (existingAgent) {\n    // Mode 2: Reuse pre-created agent  caller owns lifecycle\n    agent = existingAgent;\n\n    // Register routine-specific hooks on the existing agent (cleaned up in finally)\n    if (hooks) {\n      const hookNames = [\n        'before:execution', 'after:execution', 'before:llm', 'after:llm',\n        'before:tool', 'after:tool', 'approve:tool', 'pause:check',\n      ] as const;\n      for (const name of hookNames) {\n        const hook = hooks[name];\n        if (hook) {\n          agent.registerHook(name, hook as any);\n          registeredHooks.push({ name, hook });\n        }\n      }\n    }\n  } else {\n    // Mode 1: Create new agent  we own lifecycle and destroy in finally\n\n    // Collect tools\n    const allTools: ToolFunction[] = [...(extraTools ?? [])];\n\n    // Validate required tools\n    if (definition.requiredTools && definition.requiredTools.length > 0) {\n      const availableToolNames = new Set(allTools.map((t) => t.definition.function.name));\n      const missing = definition.requiredTools.filter((name) => !availableToolNames.has(name));\n      if (missing.length > 0) {\n        execution.status = 'failed';\n        execution.error = `Missing required tools: ${missing.join(', ')}`;\n        execution.completedAt = Date.now();\n        execution.lastUpdatedAt = Date.now();\n        return execution;\n      }\n    }\n\n    agent = Agent.create({\n      connector: connector!,\n      model: model!,\n      tools: allTools,\n      instructions: buildSystemPrompt(definition),\n      hooks,\n      context: {\n        model: model!,\n        features: {\n          workingMemory: true,\n          inContextMemory: true,\n        },\n      },\n    });\n  }\n\n  // 4. Validate required plugins\n  if (definition.requiredPlugins && definition.requiredPlugins.length > 0) {\n    const missing = definition.requiredPlugins.filter(\n      (name) => !agent.context.hasPlugin(name)\n    );\n    if (missing.length > 0) {\n      if (ownsAgent) agent.destroy();\n      execution.status = 'failed';\n      execution.error = `Missing required plugins: ${missing.join(', ')}`;\n      execution.completedAt = Date.now();\n      execution.lastUpdatedAt = Date.now();\n      return execution;\n    }\n  }\n\n  const failureMode = definition.concurrency?.failureMode ?? 'fail-fast';\n\n  try {\n    // 7. Main execution loop\n    let nextTasks = getNextExecutableTasks(execution.plan);\n\n    while (nextTasks.length > 0) {\n      // Pick first task (sequential for now; parallel support can be added later)\n      const task = nextTasks[0]!;\n      const taskIndex = execution.plan.tasks.findIndex((t) => t.id === task.id);\n\n      log.info({ taskName: task.name, taskId: task.id }, 'Starting task');\n\n      // Set task to in_progress\n      execution.plan.tasks[taskIndex] = updateTaskStatus(task, 'in_progress');\n      execution.lastUpdatedAt = Date.now();\n      onTaskStarted?.(execution.plan.tasks[taskIndex]!, execution);\n\n      let taskCompleted = false;\n      const maxTaskIterations = task.execution?.maxIterations ?? 50;\n\n      // Safety: limit iterations per task via pause:check hook.\n      // When exceeded, cancel the agent to break out of the run loop.\n      // We reset _cancelled after each agent.run() so the next task can proceed.\n      const iterationLimiter = async (ctx: { iteration: number }) => {\n        if (ctx.iteration >= maxTaskIterations) {\n          agent.cancel(`Task \"${task.name}\" exceeded max iterations (${maxTaskIterations})`);\n        }\n        return { shouldPause: false };\n      };\n      agent.registerHook('pause:check', iterationLimiter);\n\n      try {\n        // Helper to get the live task reference (updateTaskStatus returns new objects)\n        const getTask = () => execution.plan.tasks[taskIndex]!;\n\n        // Inject routine context (plan overview + dependency results) before task runs\n        await injectRoutineContext(agent, execution, definition, getTask());\n\n        // Resolve ICM plugin for template resolution\n        const { icmPlugin } = getPlugins(agent);\n\n        // Control flow branch: map/fold/until handle their own execution\n        if (getTask().controlFlow) {\n          try {\n            const cfResult = await executeControlFlow(agent, getTask(), resolvedInputs, execution);\n\n            if (cfResult.completed) {\n              execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'completed');\n              execution.plan.tasks[taskIndex]!.result = { success: true, output: cfResult.result };\n              taskCompleted = true;\n              execution.progress = getRoutineProgress(execution);\n              execution.lastUpdatedAt = Date.now();\n              onTaskComplete?.(execution.plan.tasks[taskIndex]!, execution);\n            } else {\n              execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'failed');\n              execution.plan.tasks[taskIndex]!.result = { success: false, error: cfResult.error };\n            }\n          } catch (error) {\n            const errorMessage = (error as Error).message;\n            log.error({ taskName: getTask().name, error: errorMessage }, 'Control flow error');\n            execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'failed');\n            execution.plan.tasks[taskIndex]!.result = { success: false, error: errorMessage };\n          }\n        } else {\n          // Standard task execution  retry loop\n          // First attempt is already counted by updateTaskStatus(task, 'in_progress') above.\n          // Loop until task succeeds, fails definitively, or exhausts maxAttempts.\n          while (!taskCompleted) {\n            try {\n              // Resolve templates in task description and expectedOutput\n              const resolvedTask = resolveTaskTemplates(getTask(), resolvedInputs, icmPlugin);\n\n              // Build task prompt\n              const taskPrompt = buildTaskPrompt(resolvedTask);\n\n              // Run agent\n              const response = await agent.run(taskPrompt);\n              const responseText = response.output_text ?? '';\n\n              // Validate\n              const validationResult = await validateTaskCompletion(\n                agent,\n                getTask(),\n                responseText,\n                buildValidationPrompt\n              );\n\n              // Notify caller of validation result\n              onTaskValidation?.(getTask(), validationResult, execution);\n\n              if (validationResult.isComplete) {\n                // Mark completed\n                execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'completed');\n                execution.plan.tasks[taskIndex]!.result = {\n                  success: true,\n                  output: responseText,\n                  validationScore: validationResult.completionScore,\n                  validationExplanation: validationResult.explanation,\n                };\n                taskCompleted = true;\n\n                log.info(\n                  { taskName: getTask().name, score: validationResult.completionScore },\n                  'Task completed'\n                );\n\n                execution.progress = getRoutineProgress(execution);\n                execution.lastUpdatedAt = Date.now();\n                onTaskComplete?.(execution.plan.tasks[taskIndex]!, execution);\n              } else {\n                // Validation failed\n                log.warn(\n                  {\n                    taskName: getTask().name,\n                    score: validationResult.completionScore,\n                    attempt: getTask().attempts,\n                    maxAttempts: getTask().maxAttempts,\n                  },\n                  'Task validation failed'\n                );\n\n                if (getTask().attempts >= getTask().maxAttempts) {\n                  // Max attempts exceeded  mark failed\n                  execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'failed');\n                  execution.plan.tasks[taskIndex]!.result = {\n                    success: false,\n                    error: validationResult.explanation,\n                    validationScore: validationResult.completionScore,\n                    validationExplanation: validationResult.explanation,\n                  };\n                  break;\n                }\n\n                // Retry  don't clear conversation so agent can build on previous attempt\n                // Re-set in_progress to increment attempts counter\n                execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'in_progress');\n              }\n            } catch (error) {\n              const errorMessage = (error as Error).message;\n              log.error({ taskName: getTask().name, error: errorMessage }, 'Task execution error');\n\n              if (!isTransientError(error) || getTask().attempts >= getTask().maxAttempts) {\n                // Permanent error or max attempts exceeded  mark failed\n                execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'failed');\n                execution.plan.tasks[taskIndex]!.result = {\n                  success: false,\n                  error: errorMessage,\n                };\n                break;\n              }\n\n              // Transient error  retry\n              execution.plan.tasks[taskIndex] = updateTaskStatus(getTask(), 'in_progress');\n            }\n          }\n        }\n\n        // Handle task failure\n        if (!taskCompleted) {\n          execution.progress = getRoutineProgress(execution);\n          execution.lastUpdatedAt = Date.now();\n          onTaskFailed?.(execution.plan.tasks[taskIndex]!, execution);\n\n          if (failureMode === 'fail-fast') {\n            execution.status = 'failed';\n            execution.error = `Task \"${getTask().name}\" failed after ${getTask().attempts} attempt(s)`;\n            execution.completedAt = Date.now();\n            execution.lastUpdatedAt = Date.now();\n            break;\n          }\n          // 'continue' mode: skip this task, proceed to next\n        }\n      } finally {\n        // Always unregister per-task iteration limiter  even on error/break paths\n        try { agent.unregisterHook('pause:check', iterationLimiter); } catch { /* already unregistered */ }\n      }\n\n      // Clear conversation for next task (memory persists)\n      agent.clearConversation('task-boundary');\n\n      // Get next executable tasks\n      nextTasks = getNextExecutableTasks(execution.plan);\n    }\n\n    // Finalize\n    if (execution.status === 'running') {\n      // Check if all tasks are terminal\n      const allTerminal = execution.plan.tasks.every((t) => isTerminalStatus(t.status));\n      const allCompleted = execution.plan.tasks.every((t) => t.status === 'completed');\n\n      if (allCompleted) {\n        execution.status = 'completed';\n      } else if (allTerminal) {\n        // Some failed/skipped but all are terminal\n        execution.status = 'failed';\n        execution.error = 'Not all tasks completed successfully';\n      } else {\n        // Blocked tasks remain  deadlock\n        execution.status = 'failed';\n        execution.error = 'Execution stalled: remaining tasks are blocked by incomplete dependencies';\n      }\n\n      execution.completedAt = Date.now();\n      execution.lastUpdatedAt = Date.now();\n      execution.progress = getRoutineProgress(execution);\n    }\n\n    log.info(\n      { status: execution.status, progress: execution.progress },\n      'Routine execution finished'\n    );\n\n    return execution;\n  } finally {\n    // Clean up routine-managed keys from ICM/WM (important for reused agents)\n    try {\n      await cleanupRoutineContext(agent);\n    } catch (e) {\n      log.debug({ error: (e as Error).message }, 'Failed to clean up routine context');\n    }\n\n    // Unregister routine-specific hooks from existing agent\n    for (const { name, hook } of registeredHooks) {\n      try {\n        agent.unregisterHook(name as any, hook as any);\n      } catch (e) {\n        log.debug({ hookName: name, error: (e as Error).message }, 'Failed to unregister hook');\n      }\n    }\n\n    if (ownsAgent) {\n      try {\n        agent.destroy();\n      } catch (e) {\n        log.debug({ error: (e as Error).message }, 'Failed to destroy agent');\n      }\n    }\n  }\n}\n","/**\n * Routine Control Flow  map, fold, until handlers + template resolution\n *\n * Control flow tasks delegate to executeRoutine() recursively with the shared agent,\n * using ICM keys (__map_item, __map_index, etc.) to pass iteration state.\n */\n\nimport type { Agent } from './Agent.js';\nimport type { Task, TaskInput, SubRoutineSpec, ConditionMemoryAccess, TaskMapFlow, TaskFoldFlow, TaskUntilFlow, ControlFlowSource } from '../domain/entities/Task.js';\nimport { evaluateCondition } from '../domain/entities/Task.js';\nimport type { RoutineDefinition, RoutineExecution, RoutineParameter } from '../domain/entities/Routine.js';\nimport { createRoutineDefinition } from '../domain/entities/Routine.js';\nimport type { InContextMemoryPluginNextGen } from './context-nextgen/plugins/InContextMemoryPluginNextGen.js';\nimport type { WorkingMemoryPluginNextGen } from './context-nextgen/plugins/WorkingMemoryPluginNextGen.js';\nimport { executeRoutine } from './routineRunner.js';\nimport { logger } from '../infrastructure/observability/Logger.js';\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst HARD_MAX_ITERATIONS = 1000;\nconst ICM_LARGE_THRESHOLD = 5000; // tokens  results above this go to WM\n\n/** Well-known ICM/WM keys used by the routine execution framework. */\nexport const ROUTINE_KEYS = {\n  /** Plan overview with task statuses (ICM) */\n  PLAN: '__routine_plan',\n  /** Dependency results location guide (ICM) */\n  DEPS: '__routine_deps',\n  /** Prefix for per-dependency result keys (ICM/WM) */\n  DEP_RESULT_PREFIX: '__dep_result_',\n  /** Current map/fold item (ICM) */\n  MAP_ITEM: '__map_item',\n  /** Current map/fold index, 0-based (ICM) */\n  MAP_INDEX: '__map_index',\n  /** Total items in map/fold (ICM) */\n  MAP_TOTAL: '__map_total',\n  /** Running fold accumulator (ICM) */\n  FOLD_ACCUMULATOR: '__fold_accumulator',\n  /** Prefix for large dep results stored in WM findings tier */\n  WM_DEP_FINDINGS_PREFIX: 'findings/__dep_result_',\n  /** Prefix for auto-stored task outputs (set by output contracts) */\n  TASK_OUTPUT_PREFIX: '__task_output_',\n} as const;\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface ControlFlowResult {\n  completed: boolean;\n  result?: unknown;\n  error?: string;\n}\n\n// ============================================================================\n// Template Resolution\n// ============================================================================\n\n/**\n * Resolve template placeholders in text.\n *\n * Supported namespaces:\n * - {{param.name}}  inputs[name]\n * - {{map.item}} / {{map.index}} / {{map.total}}  ICM keys\n * - {{fold.accumulator}}  ICM key\n *\n * Non-string values are JSON.stringify'd. Unresolved templates are left as-is.\n */\nexport function resolveTemplates(\n  text: string,\n  inputs: Record<string, unknown>,\n  icmPlugin: InContextMemoryPluginNextGen | null\n): string {\n  return text.replace(/\\{\\{(\\w+)\\.(\\w+)\\}\\}/g, (_match, namespace: string, key: string) => {\n    let value: unknown;\n\n    if (namespace === 'param') {\n      value = inputs[key];\n    } else if (namespace === 'map') {\n      const icmKey = `__map_${key}`;\n      value = icmPlugin?.get(icmKey);\n    } else if (namespace === 'fold') {\n      const icmKey = `__fold_${key}`;\n      value = icmPlugin?.get(icmKey);\n    } else {\n      // Unknown namespace  leave as-is\n      return _match;\n    }\n\n    if (value === undefined) {\n      return _match; // Unresolved  leave as-is\n    }\n\n    return typeof value === 'string' ? value : JSON.stringify(value);\n  });\n}\n\n/**\n * Resolve templates in task description, expectedOutput, and controlFlow.source.\n * Returns a shallow copy  original task is NOT mutated.\n */\nexport function resolveTaskTemplates(\n  task: Task,\n  inputs: Record<string, unknown>,\n  icmPlugin: InContextMemoryPluginNextGen | null\n): Task {\n  const resolvedDescription = resolveTemplates(task.description, inputs, icmPlugin);\n  const resolvedExpectedOutput = task.expectedOutput\n    ? resolveTemplates(task.expectedOutput, inputs, icmPlugin)\n    : task.expectedOutput;\n\n  // Resolve templates in controlFlow.source\n  let resolvedControlFlow = task.controlFlow;\n  if (task.controlFlow && 'source' in task.controlFlow) {\n    const flow = task.controlFlow as TaskMapFlow | TaskFoldFlow;\n    const source = flow.source;\n\n    if (typeof source === 'string') {\n      const r = resolveTemplates(source, inputs, icmPlugin);\n      if (r !== source) {\n        resolvedControlFlow = { ...flow, source: r };\n      }\n    } else if (source) {\n      let changed = false;\n      const resolved = { ...source };\n\n      if (resolved.task) {\n        const r = resolveTemplates(resolved.task, inputs, icmPlugin);\n        if (r !== resolved.task) { resolved.task = r; changed = true; }\n      }\n      if (resolved.key) {\n        const r = resolveTemplates(resolved.key, inputs, icmPlugin);\n        if (r !== resolved.key) { resolved.key = r; changed = true; }\n      }\n\n      if (changed) {\n        resolvedControlFlow = { ...flow, source: resolved };\n      }\n    }\n  }\n\n  if (\n    resolvedDescription === task.description &&\n    resolvedExpectedOutput === task.expectedOutput &&\n    resolvedControlFlow === task.controlFlow\n  ) {\n    return task; // No changes  avoid unnecessary copy\n  }\n\n  return {\n    ...task,\n    description: resolvedDescription,\n    expectedOutput: resolvedExpectedOutput,\n    controlFlow: resolvedControlFlow,\n  };\n}\n\n// ============================================================================\n// Parameter Validation\n// ============================================================================\n\n/**\n * Validate inputs against parameter definitions and apply defaults.\n * @throws Error if a required parameter is missing\n */\nexport function validateAndResolveInputs(\n  parameters: RoutineParameter[] | undefined,\n  inputs: Record<string, unknown> | undefined\n): Record<string, unknown> {\n  const resolved: Record<string, unknown> = { ...(inputs ?? {}) };\n\n  if (!parameters || parameters.length === 0) {\n    return resolved;\n  }\n\n  for (const param of parameters) {\n    if (resolved[param.name] === undefined) {\n      if (param.required) {\n        throw new Error(`Missing required parameter: \"${param.name}\"`);\n      }\n      if (param.default !== undefined) {\n        resolved[param.name] = param.default;\n      }\n    }\n  }\n\n  return resolved;\n}\n\n// ============================================================================\n// Memory Helpers\n// ============================================================================\n\n/**\n * Read a value from ICM first, falling back to WM.\n */\nexport async function readMemoryValue(\n  key: string,\n  icmPlugin: InContextMemoryPluginNextGen | null,\n  wmPlugin: WorkingMemoryPluginNextGen | null\n): Promise<unknown> {\n  // Try ICM first\n  if (icmPlugin) {\n    const icmValue = icmPlugin.get(key);\n    if (icmValue !== undefined) return icmValue;\n  }\n\n  // Fall back to WM\n  if (wmPlugin) {\n    const wmValue = await wmPlugin.retrieve(key);\n    if (wmValue !== undefined) return wmValue;\n  }\n\n  return undefined;\n}\n\n/**\n * Store a value in ICM (if small enough) or WM (if large).\n */\nasync function storeResult(\n  key: string,\n  description: string,\n  value: unknown,\n  icmPlugin: InContextMemoryPluginNextGen | null,\n  wmPlugin: WorkingMemoryPluginNextGen | null\n): Promise<void> {\n  const serialized = typeof value === 'string' ? value : JSON.stringify(value);\n  const estimatedTokens = Math.ceil(serialized.length / 4);\n\n  if (estimatedTokens < ICM_LARGE_THRESHOLD && icmPlugin) {\n    icmPlugin.set(key, description, value, 'high');\n  } else if (wmPlugin) {\n    await wmPlugin.store(key, description, serialized, { tier: 'findings' });\n  } else if (icmPlugin) {\n    // No WM  put in ICM anyway\n    icmPlugin.set(key, description, value, 'high');\n  }\n}\n\n// ============================================================================\n// Sub-routine Resolution\n// ============================================================================\n\n/**\n * Resolve a SubRoutineSpec into a RoutineDefinition.\n * If it's already a RoutineDefinition, return as-is.\n * If it's TaskInput[], wrap into a minimal RoutineDefinition.\n */\nexport function resolveSubRoutine(spec: SubRoutineSpec, parentTaskName: string): RoutineDefinition {\n  if (!Array.isArray(spec)) {\n    // Already a RoutineDefinition\n    return spec;\n  }\n\n  // It's TaskInput[]  wrap into a RoutineDefinition\n  return createRoutineDefinition({\n    name: `${parentTaskName} (sub-routine)`,\n    description: `Sub-routine of ${parentTaskName}`,\n    tasks: spec as TaskInput[],\n  });\n}\n\n// ============================================================================\n// Helpers\n// ============================================================================\n\nexport function getPlugins(agent: Agent) {\n  const icmPlugin = agent.context.getPlugin('in_context_memory') as InContextMemoryPluginNextGen | null;\n  const wmPlugin = agent.context.memory as WorkingMemoryPluginNextGen | null;\n  return { icmPlugin, wmPlugin };\n}\n\nfunction cleanMapKeys(icmPlugin: InContextMemoryPluginNextGen | null): void {\n  if (!icmPlugin) return;\n  icmPlugin.delete(ROUTINE_KEYS.MAP_ITEM);\n  icmPlugin.delete(ROUTINE_KEYS.MAP_INDEX);\n  icmPlugin.delete(ROUTINE_KEYS.MAP_TOTAL);\n}\n\nfunction cleanFoldKeys(icmPlugin: InContextMemoryPluginNextGen | null): void {\n  if (!icmPlugin) return;\n  cleanMapKeys(icmPlugin);\n  icmPlugin.delete(ROUTINE_KEYS.FOLD_ACCUMULATOR);\n}\n\n/**\n * Resolve a sub-routine spec and prepare an augmented copy for instruction injection.\n */\nfunction prepareSubRoutine(\n  tasks: SubRoutineSpec,\n  parentTaskName: string\n): { augmented: RoutineDefinition; baseInstructions: string } {\n  const subRoutine = resolveSubRoutine(tasks, parentTaskName);\n  return {\n    augmented: { ...subRoutine },\n    baseInstructions: subRoutine.instructions ?? '',\n  };\n}\n\n/**\n * Get the output from the last completed task in a sub-execution,\n * iterating backwards without copying the array.\n */\nfunction getSubRoutineOutput(execution: RoutineExecution): unknown {\n  const tasks = execution.plan.tasks;\n  for (let i = tasks.length - 1; i >= 0; i--) {\n    if (tasks[i]!.status === 'completed') {\n      return tasks[i]!.result?.output ?? null;\n    }\n  }\n  return null;\n}\n\n/**\n * Set ICM iteration keys (__map_item, __map_index, __map_total) for map/fold loops.\n */\nfunction setIterationKeys(\n  icmPlugin: InContextMemoryPluginNextGen | null,\n  item: unknown,\n  index: number,\n  total: number,\n  label: string\n): void {\n  if (!icmPlugin) return;\n  icmPlugin.set(ROUTINE_KEYS.MAP_ITEM, `Current ${label} item (${index + 1}/${total})`, item, 'high');\n  icmPlugin.set(ROUTINE_KEYS.MAP_INDEX, `Current ${label} index (0-based)`, index, 'high');\n  icmPlugin.set(ROUTINE_KEYS.MAP_TOTAL, `Total items in ${label}`, total, 'high');\n}\n\n/**\n * Wrap a promise with an optional timeout. Returns the promise result if it resolves\n * before the timeout, otherwise rejects with a descriptive error.\n */\nasync function withTimeout<T>(\n  promise: Promise<T>,\n  timeoutMs: number | undefined,\n  label: string\n): Promise<T> {\n  if (!timeoutMs) return promise;\n  let timer: ReturnType<typeof setTimeout>;\n  const timeout = new Promise<never>((_, reject) => {\n    timer = setTimeout(() => reject(new Error(`${label} timed out after ${timeoutMs}ms`)), timeoutMs);\n  });\n  try {\n    return await Promise.race([promise, timeout]);\n  } finally {\n    clearTimeout(timer!);\n  }\n}\n\n// ============================================================================\n// Source Resolution (Three-Layer)\n// ============================================================================\n\n/** Well-known field names that commonly contain array data. */\nconst COMMON_ARRAY_FIELDS = ['data', 'items', 'results', 'entries', 'list', 'records', 'values', 'elements'] as const;\n\n/**\n * Extract a nested value using dot notation + bracket indexing.\n * E.g., 'data.items', 'results[0].entries', 'response.data'\n * Auto-parses JSON strings before traversing.\n */\nfunction extractByPath(value: unknown, path: string): unknown {\n  let current: unknown = value;\n\n  // Auto-parse JSON strings\n  if (typeof current === 'string') {\n    try { current = JSON.parse(current); } catch { return undefined; }\n  }\n\n  const segments = path.replace(/\\[(\\d+)\\]/g, '.$1').split('.').filter(Boolean);\n  for (const segment of segments) {\n    if (current == null || typeof current !== 'object') return undefined;\n    current = (current as Record<string, unknown>)[segment];\n  }\n  return current;\n}\n\n/**\n * Attempt to coerce a value to an array without LLM calls:\n * 1. Already an array  return as-is\n * 2. JSON string  parse, check if array or object with array field\n * 3. Object  check common array field names (data, items, results, ...)\n * Returns the original value unchanged if no coercion succeeds.\n */\nfunction tryCoerceToArray(value: unknown): unknown {\n  if (value === undefined || value === null) return value;\n  if (Array.isArray(value)) return value;\n\n  // JSON string  parse\n  if (typeof value === 'string') {\n    try {\n      const parsed = JSON.parse(value);\n      if (Array.isArray(parsed)) return parsed;\n      // Parsed to non-array object  fall through to object check\n      if (typeof parsed === 'object' && parsed !== null) {\n        value = parsed;\n      } else {\n        return value; // primitive  can't coerce\n      }\n    } catch {\n      return value; // not JSON  will go to LLM fallback\n    }\n  }\n\n  // Object  check common array fields\n  if (typeof value === 'object' && value !== null) {\n    for (const field of COMMON_ARRAY_FIELDS) {\n      const candidate = (value as Record<string, unknown>)[field];\n      if (Array.isArray(candidate)) return candidate;\n    }\n  }\n\n  return value; // not coercible algorithmically\n}\n\n/**\n * Last-resort LLM extraction: ask the agent to extract a JSON array from raw data.\n * Uses runDirect() to avoid polluting the agent's conversation history.\n * Truncates input to 8000 chars to keep the extraction call fast and cheap.\n */\nasync function llmExtractArray(agent: Agent, rawValue: unknown): Promise<unknown[]> {\n  const serialized = typeof rawValue === 'string' ? rawValue : JSON.stringify(rawValue);\n  const truncated = serialized.length > 8000\n    ? serialized.slice(0, 8000) + '\\n...(truncated)'\n    : serialized;\n\n  const response = await agent.runDirect(\n    [\n      'Extract a JSON array from the data below for iteration.',\n      'Return ONLY a valid JSON array. No explanation, no markdown fences, no extra text.',\n      'If the data contains a list in any format (JSON, markdown, numbered list, comma-separated), convert it to a JSON array of items.',\n      '',\n      'Data:',\n      truncated,\n    ].join('\\n'),\n    { temperature: 0, maxOutputTokens: 4096 }\n  );\n\n  const text = response.output_text?.trim() ?? '';\n\n  // Strip markdown code fences if present (LLMs often wrap in ```json)\n  const cleaned = text\n    .replace(/^```(?:json|JSON)?\\s*\\n?/, '')\n    .replace(/\\n?\\s*```$/, '')\n    .trim();\n\n  let parsed: unknown;\n  try {\n    parsed = JSON.parse(cleaned);\n  } catch (parseErr) {\n    throw new Error(`LLM returned invalid JSON: ${(parseErr as Error).message}. Raw: \"${text.slice(0, 200)}\"`);\n  }\n\n  if (!Array.isArray(parsed)) {\n    throw new Error(`LLM extraction produced ${typeof parsed}, expected array`);\n  }\n\n  return parsed;\n}\n\n/**\n * Resolve the source array for a map/fold control flow using layered resolution:\n * 1. Determine lookup key(s) from source config\n * 2. Read from ICM/WM with fallback chain\n * 3. Apply JSON path extraction if specified\n * 4. Coerce to array algorithmically (JSON parse, common field names)\n * 5. LLM extraction fallback if still not an array\n */\nexport async function resolveFlowSource(\n  flow: { source: ControlFlowSource; maxIterations?: number },\n  flowType: string,\n  agent: Agent,\n  execution: RoutineExecution | undefined,\n  icmPlugin: InContextMemoryPluginNextGen | null,\n  wmPlugin: WorkingMemoryPluginNextGen | null\n): Promise<{ array: unknown[]; maxIter: number } | ControlFlowResult> {\n  const log = logger.child({ fn: 'resolveFlowSource', flowType });\n\n  //  Phase 1: Build ordered lookup chain \n  const source = flow.source;\n  const lookups: Array<{ key: string; path?: string; label: string }> = [];\n\n  if (typeof source === 'string') {\n    // Simple key string: source: 'my_key'\n    lookups.push({ key: source, label: `key \"${source}\"` });\n  } else if (source.task) {\n    // Task reference: source: { task: 'Research' }\n    // Primary: output contract key (__task_output_Research)\n    lookups.push({\n      key: `${ROUTINE_KEYS.TASK_OUTPUT_PREFIX}${source.task}`,\n      path: source.path,\n      label: `task output \"${source.task}\"`,\n    });\n    // Fallback: dep_result key (injected by injectRoutineContext)\n    if (execution) {\n      const depTask = execution.plan.tasks.find(t => t.name === source.task);\n      if (depTask) {\n        lookups.push({\n          key: `${ROUTINE_KEYS.DEP_RESULT_PREFIX}${depTask.id}`,\n          path: source.path,\n          label: `dep result \"${source.task}\"`,\n        });\n      }\n    }\n  } else if (source.key) {\n    // Direct key with optional path: source: { key: 'data', path: 'items' }\n    lookups.push({ key: source.key, path: source.path, label: `key \"${source.key}\"` });\n  }\n\n  if (lookups.length === 0) {\n    return { completed: false, error: `${flowType}: source has no task, key, or string value` };\n  }\n\n  //  Phase 2: Try each lookup in order \n  let rawValue: unknown;\n  let resolvedVia: string | undefined;\n\n  for (const { key, path, label } of lookups) {\n    const value = await readMemoryValue(key, icmPlugin, wmPlugin);\n    if (value !== undefined) {\n      rawValue = path ? extractByPath(value, path) : value;\n      resolvedVia = label;\n      break;\n    }\n  }\n\n  if (rawValue === undefined) {\n    const tried = lookups.map(l => l.label).join(', ');\n    return { completed: false, error: `${flowType}: source not found (tried: ${tried})` };\n  }\n\n  log.debug({ resolvedVia }, 'Source value found');\n\n  //  Phase 3: Coerce to array (algorithmic, zero-cost) \n  let value = tryCoerceToArray(rawValue);\n\n  //  Phase 4: LLM extraction fallback \n  if (!Array.isArray(value)) {\n    log.info({ resolvedVia, valueType: typeof value }, 'Source not an array, attempting LLM extraction');\n    try {\n      value = await llmExtractArray(agent, rawValue);\n      log.info({ extractedLength: (value as unknown[]).length }, 'LLM extraction succeeded');\n    } catch (err) {\n      return {\n        completed: false,\n        error: `${flowType}: source value is not an array and LLM extraction failed: ${(err as Error).message}`,\n      };\n    }\n  }\n\n  const arr = value as unknown[];\n  if (arr.length === 0) {\n    log.warn('Source array is empty');\n  }\n\n  const maxIter = Math.min(arr.length, flow.maxIterations ?? arr.length, HARD_MAX_ITERATIONS);\n  return { array: arr, maxIter };\n}\n\n// ============================================================================\n// Control Flow Handlers\n// ============================================================================\n\n/**\n * Handle map control flow: iterate array, run sub-routine per element.\n */\nasync function handleMap(\n  agent: Agent,\n  flow: TaskMapFlow,\n  task: Task,\n  inputs: Record<string, unknown>,\n  execution?: RoutineExecution\n): Promise<ControlFlowResult> {\n  const { icmPlugin, wmPlugin } = getPlugins(agent);\n  const log = logger.child({ controlFlow: 'map', task: task.name });\n\n  // 1. Resolve source array via layered resolution\n  const sourceResult = await resolveFlowSource(flow, 'Map', agent, execution, icmPlugin, wmPlugin);\n  if ('completed' in sourceResult) return sourceResult;\n  const { array, maxIter } = sourceResult;\n  const results: unknown[] = [];\n\n  // 2. Resolve sub-routine\n  const { augmented, baseInstructions } = prepareSubRoutine(flow.tasks, task.name);\n\n  log.info({ arrayLength: array.length, maxIterations: maxIter }, 'Starting map iteration');\n\n  try {\n    for (let i = 0; i < maxIter; i++) {\n      setIterationKeys(icmPlugin, array[i], i, array.length, 'map');\n\n      // Inject iteration-specific instructions\n      augmented.instructions = [\n        `You are processing item ${i + 1} of ${array.length} in a map operation.`,\n        'The current item is available in your live context as __map_item.',\n        'Current index (0-based) is in __map_index, total count in __map_total.',\n        '',\n        baseInstructions,\n      ].join('\\n');\n\n      // Execute sub-routine recursively (with optional per-iteration timeout)\n      const subExecution = await withTimeout(\n        executeRoutine({ definition: augmented, agent, inputs }),\n        flow.iterationTimeoutMs,\n        `Map iteration ${i}`\n      );\n\n      if (subExecution.status !== 'completed') {\n        return {\n          completed: false,\n          error: `Map iteration ${i} failed: ${subExecution.error ?? 'sub-routine failed'}`,\n        };\n      }\n\n      results.push(getSubRoutineOutput(subExecution));\n    }\n  } finally {\n    cleanMapKeys(icmPlugin);\n  }\n\n  // Store results if resultKey specified\n  if (flow.resultKey) {\n    await storeResult(flow.resultKey, `Map results from \"${task.name}\"`, results, icmPlugin, wmPlugin);\n  }\n\n  log.info({ resultCount: results.length }, 'Map completed');\n  return { completed: true, result: results };\n}\n\n/**\n * Handle fold control flow: accumulate across array elements.\n */\nasync function handleFold(\n  agent: Agent,\n  flow: TaskFoldFlow,\n  task: Task,\n  inputs: Record<string, unknown>,\n  execution?: RoutineExecution\n): Promise<ControlFlowResult> {\n  const { icmPlugin, wmPlugin } = getPlugins(agent);\n  const log = logger.child({ controlFlow: 'fold', task: task.name });\n\n  // 1. Resolve source array via layered resolution\n  const sourceResult = await resolveFlowSource(flow, 'Fold', agent, execution, icmPlugin, wmPlugin);\n  if ('completed' in sourceResult) return sourceResult;\n  const { array, maxIter } = sourceResult;\n  let accumulator: unknown = flow.initialValue;\n\n  // 2. Resolve sub-routine\n  const { augmented, baseInstructions } = prepareSubRoutine(flow.tasks, task.name);\n\n  log.info({ arrayLength: array.length, maxIterations: maxIter }, 'Starting fold iteration');\n\n  try {\n    for (let i = 0; i < maxIter; i++) {\n      setIterationKeys(icmPlugin, array[i], i, array.length, 'fold');\n      if (icmPlugin) {\n        icmPlugin.set(ROUTINE_KEYS.FOLD_ACCUMULATOR, 'Running accumulator  update via context_set', accumulator, 'high');\n      }\n\n      // Inject iteration-specific instructions\n      augmented.instructions = [\n        `You are processing item ${i + 1} of ${array.length} in a fold/accumulate operation.`,\n        'The current item is in __map_item. The running accumulator is in __fold_accumulator.',\n        'After processing, use context_set to update __fold_accumulator with the new accumulated value.',\n        'Your final text response will also be captured as the result.',\n        '',\n        baseInstructions,\n      ].join('\\n');\n\n      // Execute sub-routine (with optional per-iteration timeout)\n      const subExecution = await withTimeout(\n        executeRoutine({ definition: augmented, agent, inputs }),\n        flow.iterationTimeoutMs,\n        `Fold iteration ${i}`\n      );\n\n      if (subExecution.status !== 'completed') {\n        return {\n          completed: false,\n          error: `Fold iteration ${i} failed: ${subExecution.error ?? 'sub-routine failed'}`,\n        };\n      }\n\n      // Read new accumulator: try sub-execution's last task output first.\n      // getSubRoutineOutput() returns null when no completed task exists \n      // any other value (including '', undefined, 0, false) is a valid accumulator.\n      const taskOutput = getSubRoutineOutput(subExecution);\n\n      if (taskOutput !== null) {\n        accumulator = taskOutput;\n      } else if (icmPlugin) {\n        // Fallback: LLM may have updated via context_set\n        const icmAccumulator = icmPlugin.get(ROUTINE_KEYS.FOLD_ACCUMULATOR);\n        if (icmAccumulator !== undefined) {\n          accumulator = icmAccumulator;\n        }\n      }\n    }\n  } finally {\n    cleanFoldKeys(icmPlugin);\n  }\n\n  // Store final accumulator\n  await storeResult(flow.resultKey, `Fold result from \"${task.name}\"`, accumulator, icmPlugin, wmPlugin);\n\n  log.info('Fold completed');\n  return { completed: true, result: accumulator };\n}\n\n/**\n * Handle until control flow: repeat until condition is met.\n */\nasync function handleUntil(\n  agent: Agent,\n  flow: TaskUntilFlow,\n  task: Task,\n  inputs: Record<string, unknown>\n): Promise<ControlFlowResult> {\n  const { icmPlugin, wmPlugin } = getPlugins(agent);\n  const log = logger.child({ controlFlow: 'until', task: task.name });\n\n  // Resolve sub-routine\n  const { augmented, baseInstructions } = prepareSubRoutine(flow.tasks, task.name);\n\n  log.info({ maxIterations: flow.maxIterations }, 'Starting until loop');\n\n  // Build ConditionMemoryAccess adapter from readMemoryValue\n  const memoryAccess: ConditionMemoryAccess = {\n    get: (key: string) => readMemoryValue(key, icmPlugin, wmPlugin),\n  };\n\n  try {\n    for (let i = 0; i < flow.maxIterations; i++) {\n      // Set iteration key if configured\n      if (flow.iterationKey && icmPlugin) {\n        icmPlugin.set(flow.iterationKey, 'Current iteration index', i, 'high');\n      }\n\n      // Inject iteration-specific instructions\n      augmented.instructions = [\n        `You are in iteration ${i + 1} of a repeating operation (max ${flow.maxIterations}).`,\n        'Complete the task. The loop will continue until its exit condition is met.',\n        '',\n        baseInstructions,\n      ].join('\\n');\n\n      // Execute sub-routine (with optional per-iteration timeout)\n      const subExecution = await withTimeout(\n        executeRoutine({ definition: augmented, agent, inputs }),\n        flow.iterationTimeoutMs,\n        `Until iteration ${i}`\n      );\n\n      if (subExecution.status !== 'completed') {\n        return {\n          completed: false,\n          error: `Until iteration ${i} failed: ${subExecution.error ?? 'sub-routine failed'}`,\n        };\n      }\n\n      // Evaluate condition AFTER iteration\n      const conditionMet = await evaluateCondition(flow.condition, memoryAccess);\n      if (conditionMet) {\n        log.info({ iteration: i + 1 }, 'Until condition met');\n        return { completed: true };\n      }\n    }\n  } finally {\n    // Clean up iteration key if set\n    if (flow.iterationKey && icmPlugin) {\n      icmPlugin.delete(flow.iterationKey);\n    }\n  }\n\n  return { completed: false, error: `Until loop: maxIterations (${flow.maxIterations}) exceeded` };\n}\n\n// ============================================================================\n// Dispatcher\n// ============================================================================\n\n/**\n * Execute a control flow task. Dispatches to the appropriate handler.\n */\nexport async function executeControlFlow(\n  agent: Agent,\n  task: Task,\n  inputs: Record<string, unknown>,\n  execution?: RoutineExecution\n): Promise<ControlFlowResult> {\n  const flow = task.controlFlow!;\n\n  switch (flow.type) {\n    case 'map':\n      return handleMap(agent, flow, task, inputs, execution);\n    case 'fold':\n      return handleFold(agent, flow, task, inputs, execution);\n    case 'until':\n      return handleUntil(agent, flow, task, inputs);\n    default:\n      return { completed: false, error: `Unknown control flow type: ${(flow as any).type}` };\n  }\n}\n","/**\n * Execution Recorder Factory\n *\n * Creates ready-to-use hooks + callbacks for `executeRoutine()` that\n * persist execution state to an IRoutineExecutionStorage backend.\n *\n * Replaces the manual hook wiring previously done in v25's\n * RoutineExecutionService._runInBackground().\n *\n * @example\n * ```typescript\n * const record = createRoutineExecutionRecord(definition, connector, model);\n * const execId = await storage.insert(userId, record);\n * const recorder = createExecutionRecorder({ storage, executionId: execId });\n *\n * executeRoutine({\n *   definition, agent, inputs,\n *   hooks: recorder.hooks,\n *   onTaskStarted: recorder.onTaskStarted,\n *   onTaskComplete: recorder.onTaskComplete,\n *   onTaskFailed: recorder.onTaskFailed,\n *   onTaskValidation: recorder.onTaskValidation,\n * })\n *   .then(exec => recorder.finalize(exec))\n *   .catch(err => recorder.finalize(null, err));\n * ```\n */\n\nimport type { HookConfig } from '../capabilities/agents/types/HookTypes.js';\nimport type { Task, TaskValidationResult } from '../domain/entities/Task.js';\nimport type { RoutineExecution } from '../domain/entities/Routine.js';\nimport type { RoutineExecutionStep } from '../domain/entities/RoutineExecutionRecord.js';\nimport type { IRoutineExecutionStorage } from '../domain/interfaces/IRoutineExecutionStorage.js';\nimport { logger } from '../infrastructure/observability/Logger.js';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface ExecutionRecorderOptions {\n  /** Storage backend for persisting execution state. */\n  storage: IRoutineExecutionStorage;\n  /** ID of the execution record (must already be inserted). */\n  executionId: string;\n  /** Optional prefix for log messages. */\n  logPrefix?: string;\n  /** Max length for truncated tool args/results in steps. Default: 500. */\n  maxTruncateLength?: number;\n}\n\nexport interface ExecutionRecorder {\n  /** Hook config to pass to executeRoutine(). */\n  hooks: HookConfig;\n  /** Callback for onTaskStarted. */\n  onTaskStarted: (task: Task, execution: RoutineExecution) => void;\n  /** Callback for onTaskComplete. */\n  onTaskComplete: (task: Task, execution: RoutineExecution) => void;\n  /** Callback for onTaskFailed. */\n  onTaskFailed: (task: Task, execution: RoutineExecution) => void;\n  /** Callback for onTaskValidation. */\n  onTaskValidation: (task: Task, result: TaskValidationResult, execution: RoutineExecution) => void;\n  /** Call after executeRoutine() resolves/rejects to write final status. */\n  finalize: (execution: RoutineExecution | null, error?: Error) => Promise<void>;\n}\n\n// ============================================================================\n// Helpers\n// ============================================================================\n\nfunction truncate(value: unknown, maxLen: number): string {\n  const str = typeof value === 'string' ? value : JSON.stringify(value);\n  if (!str) return '';\n  return str.length > maxLen ? str.slice(0, maxLen) + '...(truncated)' : str;\n}\n\nfunction safeCall(fn: () => void | Promise<void>, prefix: string): void {\n  try {\n    const result = fn();\n    if (result && typeof (result as Promise<void>).catch === 'function') {\n      (result as Promise<void>).catch((err) => {\n        logger.debug({ error: (err as Error).message }, `${prefix} async error`);\n      });\n    }\n  } catch (err) {\n    logger.debug({ error: (err as Error).message }, `${prefix} sync error`);\n  }\n}\n\n// ============================================================================\n// Factory\n// ============================================================================\n\n/**\n * Create an ExecutionRecorder that wires hooks + callbacks to persist\n * execution state via the provided storage backend.\n */\nexport function createExecutionRecorder(options: ExecutionRecorderOptions): ExecutionRecorder {\n  const { storage, executionId, logPrefix = '[Recorder]', maxTruncateLength = 500 } = options;\n  const log = logger.child({ executionId });\n\n  // Track current task name for hooks (hooks don't receive task context)\n  let currentTaskName = '(unknown)';\n\n  function pushStep(step: RoutineExecutionStep): void {\n    safeCall(() => storage.pushStep(executionId, step), `${logPrefix} pushStep`);\n  }\n\n  function heartbeat(): void {\n    safeCall(\n      () => storage.update(executionId, { lastActivityAt: Date.now() }),\n      `${logPrefix} heartbeat`,\n    );\n  }\n\n  // ---- Hooks ----\n\n  const hooks: HookConfig = {\n    'before:llm': (ctx) => {\n      pushStep({\n        timestamp: Date.now(),\n        taskName: currentTaskName,\n        type: 'llm.start',\n        data: { iteration: ctx.iteration },\n      });\n      return {};\n    },\n\n    'after:llm': (ctx) => {\n      pushStep({\n        timestamp: Date.now(),\n        taskName: currentTaskName,\n        type: 'llm.complete',\n        data: {\n          iteration: ctx.iteration,\n          duration: ctx.duration,\n          tokens: ctx.response?.usage,\n        },\n      });\n      return {};\n    },\n\n    'before:tool': (ctx) => {\n      pushStep({\n        timestamp: Date.now(),\n        taskName: currentTaskName,\n        type: 'tool.start',\n        data: {\n          toolName: ctx.toolCall.function.name,\n          args: truncate(ctx.toolCall.function.arguments, maxTruncateLength),\n        },\n      });\n      return {};\n    },\n\n    'after:tool': (ctx) => {\n      pushStep({\n        timestamp: Date.now(),\n        taskName: currentTaskName,\n        type: 'tool.call',\n        data: {\n          toolName: ctx.toolCall.function.name,\n          args: truncate(ctx.toolCall.function.arguments, maxTruncateLength),\n          result: truncate(ctx.result?.content, maxTruncateLength),\n          error: ctx.result?.error ? true : undefined,\n        },\n      });\n      return {};\n    },\n\n    'after:execution': () => {\n      pushStep({\n        timestamp: Date.now(),\n        taskName: currentTaskName,\n        type: 'iteration.complete',\n      });\n    },\n\n    'pause:check': () => {\n      heartbeat();\n      return { shouldPause: false };\n    },\n  };\n\n  // ---- Task Callbacks ----\n\n  const onTaskStarted = (task: Task, execution: RoutineExecution): void => {\n    currentTaskName = task.name;\n    const now = Date.now();\n\n    safeCall(\n      () => storage.updateTask(executionId, task.name, {\n        status: 'in_progress',\n        startedAt: now,\n        attempts: task.attempts,\n      }),\n      `${logPrefix} onTaskStarted`,\n    );\n\n    pushStep({\n      timestamp: now,\n      taskName: task.name,\n      type: 'task.started',\n      data: { taskId: task.id },\n    });\n\n    // Track control flow start\n    if (task.controlFlow) {\n      pushStep({\n        timestamp: now,\n        taskName: task.name,\n        type: 'control_flow.started',\n        data: { flowType: task.controlFlow.type },\n      });\n    }\n\n    // Update progress\n    safeCall(\n      () => storage.update(executionId, {\n        progress: execution.progress,\n        lastActivityAt: now,\n      }),\n      `${logPrefix} onTaskStarted progress`,\n    );\n  };\n\n  const onTaskComplete = (task: Task, execution: RoutineExecution): void => {\n    const now = Date.now();\n\n    safeCall(\n      () => storage.updateTask(executionId, task.name, {\n        status: 'completed',\n        completedAt: now,\n        attempts: task.attempts,\n        result: task.result ? {\n          success: true,\n          output: truncate(task.result.output, maxTruncateLength),\n          validationScore: task.result.validationScore,\n          validationExplanation: task.result.validationExplanation,\n        } : undefined,\n      }),\n      `${logPrefix} onTaskComplete`,\n    );\n\n    pushStep({\n      timestamp: now,\n      taskName: task.name,\n      type: 'task.completed',\n      data: {\n        taskId: task.id,\n        validationScore: task.result?.validationScore,\n      },\n    });\n\n    if (task.controlFlow) {\n      pushStep({\n        timestamp: now,\n        taskName: task.name,\n        type: 'control_flow.completed',\n        data: { flowType: task.controlFlow.type },\n      });\n    }\n\n    safeCall(\n      () => storage.update(executionId, {\n        progress: execution.progress,\n        lastActivityAt: now,\n      }),\n      `${logPrefix} onTaskComplete progress`,\n    );\n  };\n\n  const onTaskFailed = (task: Task, execution: RoutineExecution): void => {\n    const now = Date.now();\n\n    safeCall(\n      () => storage.updateTask(executionId, task.name, {\n        status: 'failed',\n        completedAt: now,\n        attempts: task.attempts,\n        result: task.result ? {\n          success: false,\n          error: task.result.error,\n          validationScore: task.result.validationScore,\n          validationExplanation: task.result.validationExplanation,\n        } : undefined,\n      }),\n      `${logPrefix} onTaskFailed`,\n    );\n\n    pushStep({\n      timestamp: now,\n      taskName: task.name,\n      type: 'task.failed',\n      data: {\n        taskId: task.id,\n        error: task.result?.error,\n        attempts: task.attempts,\n      },\n    });\n\n    safeCall(\n      () => storage.update(executionId, {\n        progress: execution.progress,\n        lastActivityAt: now,\n      }),\n      `${logPrefix} onTaskFailed progress`,\n    );\n  };\n\n  const onTaskValidation = (\n    task: Task,\n    result: TaskValidationResult,\n    _execution: RoutineExecution,\n  ): void => {\n    pushStep({\n      timestamp: Date.now(),\n      taskName: task.name,\n      type: 'task.validation',\n      data: {\n        taskId: task.id,\n        isComplete: result.isComplete,\n        completionScore: result.completionScore,\n        explanation: truncate(result.explanation, maxTruncateLength),\n      },\n    });\n  };\n\n  // ---- Finalize ----\n\n  const finalize = async (\n    execution: RoutineExecution | null,\n    error?: Error,\n  ): Promise<void> => {\n    const now = Date.now();\n\n    try {\n      if (error || !execution) {\n        await storage.update(executionId, {\n          status: 'failed',\n          error: error?.message ?? 'Unknown error',\n          completedAt: now,\n          lastActivityAt: now,\n        });\n\n        if (error) {\n          await storage.pushStep(executionId, {\n            timestamp: now,\n            taskName: currentTaskName,\n            type: 'execution.error',\n            data: { error: error.message },\n          });\n        }\n      } else {\n        await storage.update(executionId, {\n          status: execution.status,\n          progress: execution.progress,\n          error: execution.error,\n          completedAt: execution.completedAt ?? now,\n          lastActivityAt: now,\n        });\n      }\n    } catch (err) {\n      log.error({ error: (err as Error).message }, `${logPrefix} finalize error`);\n    }\n  };\n\n  return {\n    hooks,\n    onTaskStarted,\n    onTaskComplete,\n    onTaskFailed,\n    onTaskValidation,\n    finalize,\n  };\n}\n","/**\n * Configuration Loader\n *\n * Loads and parses oneringai.config.json with environment variable interpolation.\n */\n\nimport { promises as fs } from 'fs';\nimport { resolve, join } from 'path';\nimport { homedir } from 'os';\nimport type { OneRingAIConfig } from '../../domain/entities/MCPConfig.js';\n\n/**\n * Configuration loader class\n */\nexport class ConfigLoader {\n  private static DEFAULT_PATHS = [\n    './oneringai.config.json',\n    join(homedir(), '.oneringai', 'config.json'),\n  ];\n\n  /**\n   * Load configuration from file\n   */\n  static async load(path?: string): Promise<OneRingAIConfig> {\n    const configPath = path ? resolve(path) : await this.findConfig();\n\n    if (!configPath) {\n      throw new Error('Configuration file not found. Searched: ' + this.DEFAULT_PATHS.join(', '));\n    }\n\n    try {\n      const content = await fs.readFile(configPath, 'utf-8');\n      let config: OneRingAIConfig = JSON.parse(content);\n\n      // Interpolate environment variables\n      config = this.interpolateEnvVars(config);\n\n      // Validate configuration\n      this.validate(config);\n\n      return config;\n    } catch (error) {\n      if (error instanceof SyntaxError) {\n        throw new Error(`Invalid JSON in configuration file '${configPath}': ${error.message}`);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Load configuration synchronously\n   */\n  static loadSync(path?: string): OneRingAIConfig {\n    const configPath = path ? resolve(path) : this.findConfigSync();\n\n    if (!configPath) {\n      throw new Error('Configuration file not found. Searched: ' + this.DEFAULT_PATHS.join(', '));\n    }\n\n    try {\n      const fs = require('fs');\n      const content = fs.readFileSync(configPath, 'utf-8');\n      let config: OneRingAIConfig = JSON.parse(content);\n\n      // Interpolate environment variables\n      config = this.interpolateEnvVars(config);\n\n      // Validate configuration\n      this.validate(config);\n\n      return config;\n    } catch (error) {\n      if (error instanceof SyntaxError) {\n        throw new Error(`Invalid JSON in configuration file '${configPath}': ${error.message}`);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Find configuration file in default paths\n   */\n  private static async findConfig(): Promise<string | null> {\n    for (const path of this.DEFAULT_PATHS) {\n      try {\n        await fs.access(resolve(path));\n        return resolve(path);\n      } catch {\n        // Continue searching\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Find configuration file synchronously\n   */\n  private static findConfigSync(): string | null {\n    const fs = require('fs');\n    for (const path of this.DEFAULT_PATHS) {\n      try {\n        fs.accessSync(resolve(path));\n        return resolve(path);\n      } catch {\n        // Continue searching\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Interpolate environment variables in configuration\n   * Replaces ${ENV_VAR} with process.env.ENV_VAR\n   */\n  private static interpolateEnvVars(config: OneRingAIConfig): OneRingAIConfig {\n    const jsonString = JSON.stringify(config);\n    const interpolated = jsonString.replace(/\\$\\{([^}]+)\\}/g, (match, envVar) => {\n      const value = process.env[envVar];\n      if (value === undefined) {\n        // Don't fail on missing env vars, just keep the placeholder\n        console.warn(`Warning: Environment variable '${envVar}' is not set`);\n        return match;\n      }\n      return value;\n    });\n\n    return JSON.parse(interpolated);\n  }\n\n  /**\n   * Basic validation of configuration structure\n   */\n  private static validate(config: OneRingAIConfig): void {\n    if (typeof config !== 'object' || config === null) {\n      throw new Error('Configuration must be an object');\n    }\n\n    // Validate MCP section if present\n    if (config.mcp) {\n      if (!Array.isArray(config.mcp.servers)) {\n        throw new Error('MCP configuration must have a \"servers\" array');\n      }\n\n      for (const server of config.mcp.servers) {\n        if (!server.name) {\n          throw new Error('Each MCP server must have a \"name\" field');\n        }\n        if (!server.transport) {\n          throw new Error(`MCP server '${server.name}' must have a \"transport\" field`);\n        }\n        if (!server.transportConfig) {\n          throw new Error(`MCP server '${server.name}' must have a \"transportConfig\" field`);\n        }\n      }\n    }\n  }\n}\n",null,null,null,"import { setResponseValueAndErrors } from \"../errorMessages.js\";\nlet emojiRegex = undefined;\n/**\n * Generated from the regular expressions found here as of 2024-05-22:\n * https://github.com/colinhacks/zod/blob/master/src/types.ts.\n *\n * Expressions with /i flag have been changed accordingly.\n */\nexport const zodPatterns = {\n    /**\n     * `c` was changed to `[cC]` to replicate /i flag\n     */\n    cuid: /^[cC][^\\s-]{8,}$/,\n    cuid2: /^[0-9a-z]+$/,\n    ulid: /^[0-9A-HJKMNP-TV-Z]{26}$/,\n    /**\n     * `a-z` was added to replicate /i flag\n     */\n    email: /^(?!\\.)(?!.*\\.\\.)([a-zA-Z0-9_'+\\-\\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\\-]*\\.)+[a-zA-Z]{2,}$/,\n    /**\n     * Constructed a valid Unicode RegExp\n     *\n     * Lazily instantiate since this type of regex isn't supported\n     * in all envs (e.g. React Native).\n     *\n     * See:\n     * https://github.com/colinhacks/zod/issues/2433\n     * Fix in Zod:\n     * https://github.com/colinhacks/zod/commit/9340fd51e48576a75adc919bff65dbc4a5d4c99b\n     */\n    emoji: () => {\n        if (emojiRegex === undefined) {\n            emojiRegex = RegExp(\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\", \"u\");\n        }\n        return emojiRegex;\n    },\n    /**\n     * Unused\n     */\n    uuid: /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/,\n    /**\n     * Unused\n     */\n    ipv4: /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,\n    ipv4Cidr: /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,\n    /**\n     * Unused\n     */\n    ipv6: /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,\n    ipv6Cidr: /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,\n    base64: /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,\n    base64url: /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,\n    nanoid: /^[a-zA-Z0-9_-]{21}$/,\n    jwt: /^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,\n};\nexport function parseStringDef(def, refs) {\n    const res = {\n        type: \"string\",\n    };\n    if (def.checks) {\n        for (const check of def.checks) {\n            switch (check.kind) {\n                case \"min\":\n                    setResponseValueAndErrors(res, \"minLength\", typeof res.minLength === \"number\"\n                        ? Math.max(res.minLength, check.value)\n                        : check.value, check.message, refs);\n                    break;\n                case \"max\":\n                    setResponseValueAndErrors(res, \"maxLength\", typeof res.maxLength === \"number\"\n                        ? Math.min(res.maxLength, check.value)\n                        : check.value, check.message, refs);\n                    break;\n                case \"email\":\n                    switch (refs.emailStrategy) {\n                        case \"format:email\":\n                            addFormat(res, \"email\", check.message, refs);\n                            break;\n                        case \"format:idn-email\":\n                            addFormat(res, \"idn-email\", check.message, refs);\n                            break;\n                        case \"pattern:zod\":\n                            addPattern(res, zodPatterns.email, check.message, refs);\n                            break;\n                    }\n                    break;\n                case \"url\":\n                    addFormat(res, \"uri\", check.message, refs);\n                    break;\n                case \"uuid\":\n                    addFormat(res, \"uuid\", check.message, refs);\n                    break;\n                case \"regex\":\n                    addPattern(res, check.regex, check.message, refs);\n                    break;\n                case \"cuid\":\n                    addPattern(res, zodPatterns.cuid, check.message, refs);\n                    break;\n                case \"cuid2\":\n                    addPattern(res, zodPatterns.cuid2, check.message, refs);\n                    break;\n                case \"startsWith\":\n                    addPattern(res, RegExp(`^${escapeLiteralCheckValue(check.value, refs)}`), check.message, refs);\n                    break;\n                case \"endsWith\":\n                    addPattern(res, RegExp(`${escapeLiteralCheckValue(check.value, refs)}$`), check.message, refs);\n                    break;\n                case \"datetime\":\n                    addFormat(res, \"date-time\", check.message, refs);\n                    break;\n                case \"date\":\n                    addFormat(res, \"date\", check.message, refs);\n                    break;\n                case \"time\":\n                    addFormat(res, \"time\", check.message, refs);\n                    break;\n                case \"duration\":\n                    addFormat(res, \"duration\", check.message, refs);\n                    break;\n                case \"length\":\n                    setResponseValueAndErrors(res, \"minLength\", typeof res.minLength === \"number\"\n                        ? Math.max(res.minLength, check.value)\n                        : check.value, check.message, refs);\n                    setResponseValueAndErrors(res, \"maxLength\", typeof res.maxLength === \"number\"\n                        ? Math.min(res.maxLength, check.value)\n                        : check.value, check.message, refs);\n                    break;\n                case \"includes\": {\n                    addPattern(res, RegExp(escapeLiteralCheckValue(check.value, refs)), check.message, refs);\n                    break;\n                }\n                case \"ip\": {\n                    if (check.version !== \"v6\") {\n                        addFormat(res, \"ipv4\", check.message, refs);\n                    }\n                    if (check.version !== \"v4\") {\n                        addFormat(res, \"ipv6\", check.message, refs);\n                    }\n                    break;\n                }\n                case \"base64url\":\n                    addPattern(res, zodPatterns.base64url, check.message, refs);\n                    break;\n                case \"jwt\":\n                    addPattern(res, zodPatterns.jwt, check.message, refs);\n                    break;\n                case \"cidr\": {\n                    if (check.version !== \"v6\") {\n                        addPattern(res, zodPatterns.ipv4Cidr, check.message, refs);\n                    }\n                    if (check.version !== \"v4\") {\n                        addPattern(res, zodPatterns.ipv6Cidr, check.message, refs);\n                    }\n                    break;\n                }\n                case \"emoji\":\n                    addPattern(res, zodPatterns.emoji(), check.message, refs);\n                    break;\n                case \"ulid\": {\n                    addPattern(res, zodPatterns.ulid, check.message, refs);\n                    break;\n                }\n                case \"base64\": {\n                    switch (refs.base64Strategy) {\n                        case \"format:binary\": {\n                            addFormat(res, \"binary\", check.message, refs);\n                            break;\n                        }\n                        case \"contentEncoding:base64\": {\n                            setResponseValueAndErrors(res, \"contentEncoding\", \"base64\", check.message, refs);\n                            break;\n                        }\n                        case \"pattern:zod\": {\n                            addPattern(res, zodPatterns.base64, check.message, refs);\n                            break;\n                        }\n                    }\n                    break;\n                }\n                case \"nanoid\": {\n                    addPattern(res, zodPatterns.nanoid, check.message, refs);\n                }\n                case \"toLowerCase\":\n                case \"toUpperCase\":\n                case \"trim\":\n                    break;\n                default:\n                    ((_) => { })(check);\n            }\n        }\n    }\n    return res;\n}\nfunction escapeLiteralCheckValue(literal, refs) {\n    return refs.patternStrategy === \"escape\"\n        ? escapeNonAlphaNumeric(literal)\n        : literal;\n}\nconst ALPHA_NUMERIC = new Set(\"ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789\");\nfunction escapeNonAlphaNumeric(source) {\n    let result = \"\";\n    for (let i = 0; i < source.length; i++) {\n        if (!ALPHA_NUMERIC.has(source[i])) {\n            result += \"\\\\\";\n        }\n        result += source[i];\n    }\n    return result;\n}\n// Adds a \"format\" keyword to the schema. If a format exists, both formats will be joined in an allOf-node, along with subsequent ones.\nfunction addFormat(schema, value, message, refs) {\n    if (schema.format || schema.anyOf?.some((x) => x.format)) {\n        if (!schema.anyOf) {\n            schema.anyOf = [];\n        }\n        if (schema.format) {\n            schema.anyOf.push({\n                format: schema.format,\n                ...(schema.errorMessage &&\n                    refs.errorMessages && {\n                    errorMessage: { format: schema.errorMessage.format },\n                }),\n            });\n            delete schema.format;\n            if (schema.errorMessage) {\n                delete schema.errorMessage.format;\n                if (Object.keys(schema.errorMessage).length === 0) {\n                    delete schema.errorMessage;\n                }\n            }\n        }\n        schema.anyOf.push({\n            format: value,\n            ...(message &&\n                refs.errorMessages && { errorMessage: { format: message } }),\n        });\n    }\n    else {\n        setResponseValueAndErrors(schema, \"format\", value, message, refs);\n    }\n}\n// Adds a \"pattern\" keyword to the schema. If a pattern exists, both patterns will be joined in an allOf-node, along with subsequent ones.\nfunction addPattern(schema, regex, message, refs) {\n    if (schema.pattern || schema.allOf?.some((x) => x.pattern)) {\n        if (!schema.allOf) {\n            schema.allOf = [];\n        }\n        if (schema.pattern) {\n            schema.allOf.push({\n                pattern: schema.pattern,\n                ...(schema.errorMessage &&\n                    refs.errorMessages && {\n                    errorMessage: { pattern: schema.errorMessage.pattern },\n                }),\n            });\n            delete schema.pattern;\n            if (schema.errorMessage) {\n                delete schema.errorMessage.pattern;\n                if (Object.keys(schema.errorMessage).length === 0) {\n                    delete schema.errorMessage;\n                }\n            }\n        }\n        schema.allOf.push({\n            pattern: stringifyRegExpWithFlags(regex, refs),\n            ...(message &&\n                refs.errorMessages && { errorMessage: { pattern: message } }),\n        });\n    }\n    else {\n        setResponseValueAndErrors(schema, \"pattern\", stringifyRegExpWithFlags(regex, refs), message, refs);\n    }\n}\n// Mutate z.string.regex() in a best attempt to accommodate for regex flags when applyRegexFlags is true\nfunction stringifyRegExpWithFlags(regex, refs) {\n    if (!refs.applyRegexFlags || !regex.flags) {\n        return regex.source;\n    }\n    // Currently handled flags\n    const flags = {\n        i: regex.flags.includes(\"i\"),\n        m: regex.flags.includes(\"m\"),\n        s: regex.flags.includes(\"s\"), // `.` matches newlines\n    };\n    // The general principle here is to step through each character, one at a time, applying mutations as flags require. We keep track when the current character is escaped, and when it's inside a group /like [this]/ or (also) a range like /[a-z]/. The following is fairly brittle imperative code; edit at your peril!\n    const source = flags.i ? regex.source.toLowerCase() : regex.source;\n    let pattern = \"\";\n    let isEscaped = false;\n    let inCharGroup = false;\n    let inCharRange = false;\n    for (let i = 0; i < source.length; i++) {\n        if (isEscaped) {\n            pattern += source[i];\n            isEscaped = false;\n            continue;\n        }\n        if (flags.i) {\n            if (inCharGroup) {\n                if (source[i].match(/[a-z]/)) {\n                    if (inCharRange) {\n                        pattern += source[i];\n                        pattern += `${source[i - 2]}-${source[i]}`.toUpperCase();\n                        inCharRange = false;\n                    }\n                    else if (source[i + 1] === \"-\" && source[i + 2]?.match(/[a-z]/)) {\n                        pattern += source[i];\n                        inCharRange = true;\n                    }\n                    else {\n                        pattern += `${source[i]}${source[i].toUpperCase()}`;\n                    }\n                    continue;\n                }\n            }\n            else if (source[i].match(/[a-z]/)) {\n                pattern += `[${source[i]}${source[i].toUpperCase()}]`;\n                continue;\n            }\n        }\n        if (flags.m) {\n            if (source[i] === \"^\") {\n                pattern += `(^|(?<=[\\r\\n]))`;\n                continue;\n            }\n            else if (source[i] === \"$\") {\n                pattern += `($|(?=[\\r\\n]))`;\n                continue;\n            }\n        }\n        if (flags.s && source[i] === \".\") {\n            pattern += inCharGroup ? `${source[i]}\\r\\n` : `[${source[i]}\\r\\n]`;\n            continue;\n        }\n        pattern += source[i];\n        if (source[i] === \"\\\\\") {\n            isEscaped = true;\n        }\n        else if (inCharGroup && source[i] === \"]\") {\n            inCharGroup = false;\n        }\n        else if (!inCharGroup && source[i] === \"[\") {\n            inCharGroup = true;\n        }\n    }\n    try {\n        new RegExp(pattern);\n    }\n    catch {\n        console.warn(`Could not convert regex pattern at ${refs.currentPath.join(\"/\")} to a flag-independent form! Falling back to the flag-ignorant source`);\n        return regex.source;\n    }\n    return pattern;\n}\n",null,null,null,null,null,null,null,null,null,"let crypto;\ncrypto =\n    globalThis.crypto?.webcrypto ?? // Node.js [18-16] REPL\n        globalThis.crypto ?? // Node.js >18\n        import(\"node:crypto\").then(m => m.webcrypto); // Node.js <18 Non-REPL\n/**\n * Creates an array of length `size` of random bytes\n * @param size\n * @returns Array of random ints (0 to 255)\n */\nasync function getRandomValues(size) {\n    return (await crypto).getRandomValues(new Uint8Array(size));\n}\n/** Generate cryptographically strong random string\n * @param size The desired length of the string\n * @returns The random string\n */\nasync function random(size) {\n    const mask = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~\";\n    const evenDistCutoff = Math.pow(2, 8) - Math.pow(2, 8) % mask.length;\n    let result = \"\";\n    while (result.length < size) {\n        const randomBytes = await getRandomValues(size - result.length);\n        for (const randomByte of randomBytes) {\n            if (randomByte < evenDistCutoff) {\n                result += mask[randomByte % mask.length];\n            }\n        }\n    }\n    return result;\n}\n/** Generate a PKCE challenge verifier\n * @param length Length of the verifier\n * @returns A random verifier `length` characters long\n */\nasync function generateVerifier(length) {\n    return await random(length);\n}\n/** Generate a PKCE code challenge from a code verifier\n * @param code_verifier\n * @returns The base64 url encoded code challenge\n */\nexport async function generateChallenge(code_verifier) {\n    const buffer = await (await crypto).subtle.digest(\"SHA-256\", new TextEncoder().encode(code_verifier));\n    // Generate base64url string\n    // btoa is deprecated in Node.js but is used here for web browser compatibility\n    // (which has no good replacement yet, see also https://github.com/whatwg/html/issues/6811)\n    return btoa(String.fromCharCode(...new Uint8Array(buffer)))\n        .replace(/\\//g, '_')\n        .replace(/\\+/g, '-')\n        .replace(/=/g, '');\n}\n/** Generate a PKCE challenge pair\n * @param length Length of the verifer (between 43-128). Defaults to 43.\n * @returns PKCE challenge pair\n */\nexport default async function pkceChallenge(length) {\n    if (!length)\n        length = 43;\n    if (length < 43 || length > 128) {\n        throw `Expected a length between 43 and 128. Received ${length}.`;\n    }\n    const verifier = await generateVerifier(length);\n    const challenge = await generateChallenge(verifier);\n    return {\n        code_verifier: verifier,\n        code_challenge: challenge,\n    };\n}\n/** Verify that a code_verifier produces the expected code challenge\n * @param code_verifier\n * @param expectedChallenge The code challenge to verify\n * @returns True if challenges are equal. False otherwise.\n */\nexport async function verifyChallenge(code_verifier, expectedChallenge) {\n    const actualChallenge = await generateChallenge(code_verifier);\n    return actualChallenge === expectedChallenge;\n}\n",null,null,null,null,"/**\n * The type of error that occurred.\n * @public\n */\nexport type ErrorType = 'invalid-retry' | 'unknown-field'\n\n/**\n * Error thrown when encountering an issue during parsing.\n *\n * @public\n */\nexport class ParseError extends Error {\n  /**\n   * The type of error that occurred.\n   */\n  type: ErrorType\n\n  /**\n   * In the case of an unknown field encountered in the stream, this will be the field name.\n   */\n  field?: string | undefined\n\n  /**\n   * In the case of an unknown field encountered in the stream, this will be the value of the field.\n   */\n  value?: string | undefined\n\n  /**\n   * The line that caused the error, if available.\n   */\n  line?: string | undefined\n\n  constructor(\n    message: string,\n    options: {type: ErrorType; field?: string; value?: string; line?: string},\n  ) {\n    super(message)\n    this.name = 'ParseError'\n    this.type = options.type\n    this.field = options.field\n    this.value = options.value\n    this.line = options.line\n  }\n}\n","/**\n * EventSource/Server-Sent Events parser\n * @see https://html.spec.whatwg.org/multipage/server-sent-events.html\n */\nimport {ParseError} from './errors.ts'\nimport type {EventSourceParser, ParserCallbacks} from './types.ts'\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction noop(_arg: unknown) {\n  // intentional noop\n}\n\n/**\n * Creates a new EventSource parser.\n *\n * @param callbacks - Callbacks to invoke on different parsing events:\n *   - `onEvent` when a new event is parsed\n *   - `onError` when an error occurs\n *   - `onRetry` when a new reconnection interval has been sent from the server\n *   - `onComment` when a comment is encountered in the stream\n *\n * @returns A new EventSource parser, with `parse` and `reset` methods.\n * @public\n */\nexport function createParser(callbacks: ParserCallbacks): EventSourceParser {\n  if (typeof callbacks === 'function') {\n    throw new TypeError(\n      '`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?',\n    )\n  }\n\n  const {onEvent = noop, onError = noop, onRetry = noop, onComment} = callbacks\n\n  let incompleteLine = ''\n\n  let isFirstChunk = true\n  let id: string | undefined\n  let data = ''\n  let eventType = ''\n\n  function feed(newChunk: string) {\n    // Strip any UTF8 byte order mark (BOM) at the start of the stream\n    const chunk = isFirstChunk ? newChunk.replace(/^\\xEF\\xBB\\xBF/, '') : newChunk\n\n    // If there was a previous incomplete line, append it to the new chunk,\n    // so we may process it together as a new (hopefully complete) chunk.\n    const [complete, incomplete] = splitLines(`${incompleteLine}${chunk}`)\n\n    for (const line of complete) {\n      parseLine(line)\n    }\n\n    incompleteLine = incomplete\n    isFirstChunk = false\n  }\n\n  function parseLine(line: string) {\n    // If the line is empty (a blank line), dispatch the event\n    if (line === '') {\n      dispatchEvent()\n      return\n    }\n\n    // If the line starts with a U+003A COLON character (:), ignore the line.\n    if (line.startsWith(':')) {\n      if (onComment) {\n        onComment(line.slice(line.startsWith(': ') ? 2 : 1))\n      }\n      return\n    }\n\n    // If the line contains a U+003A COLON character (:)\n    const fieldSeparatorIndex = line.indexOf(':')\n    if (fieldSeparatorIndex !== -1) {\n      // Collect the characters on the line before the first U+003A COLON character (:),\n      // and let `field` be that string.\n      const field = line.slice(0, fieldSeparatorIndex)\n\n      // Collect the characters on the line after the first U+003A COLON character (:),\n      // and let `value` be that string. If value starts with a U+0020 SPACE character,\n      // remove it from value.\n      const offset = line[fieldSeparatorIndex + 1] === ' ' ? 2 : 1\n      const value = line.slice(fieldSeparatorIndex + offset)\n\n      processField(field, value, line)\n      return\n    }\n\n    // Otherwise, the string is not empty but does not contain a U+003A COLON character (:)\n    // Process the field using the whole line as the field name, and an empty string as the field value.\n    //  This is according to spec. That means that a line that has the value `data` will result in\n    // a newline being added to the current `data` buffer, for instance.\n    processField(line, '', line)\n  }\n\n  function processField(field: string, value: string, line: string) {\n    // Field names must be compared literally, with no case folding performed.\n    switch (field) {\n      case 'event':\n        // Set the `event type` buffer to field value\n        eventType = value\n        break\n      case 'data':\n        // Append the field value to the `data` buffer, then append a single U+000A LINE FEED(LF)\n        // character to the `data` buffer.\n        data = `${data}${value}\\n`\n        break\n      case 'id':\n        // If the field value does not contain U+0000 NULL, then set the `ID` buffer to\n        // the field value. Otherwise, ignore the field.\n        id = value.includes('\\0') ? undefined : value\n        break\n      case 'retry':\n        // If the field value consists of only ASCII digits, then interpret the field value as an\n        // integer in base ten, and set the event stream's reconnection time to that integer.\n        // Otherwise, ignore the field.\n        if (/^\\d+$/.test(value)) {\n          onRetry(parseInt(value, 10))\n        } else {\n          onError(\n            new ParseError(`Invalid \\`retry\\` value: \"${value}\"`, {\n              type: 'invalid-retry',\n              value,\n              line,\n            }),\n          )\n        }\n        break\n      default:\n        // Otherwise, the field is ignored.\n        onError(\n          new ParseError(\n            `Unknown field \"${field.length > 20 ? `${field.slice(0, 20)}` : field}\"`,\n            {type: 'unknown-field', field, value, line},\n          ),\n        )\n        break\n    }\n  }\n\n  function dispatchEvent() {\n    const shouldDispatch = data.length > 0\n    if (shouldDispatch) {\n      onEvent({\n        id,\n        event: eventType || undefined,\n        // If the data buffer's last character is a U+000A LINE FEED (LF) character,\n        // then remove the last character from the data buffer.\n        data: data.endsWith('\\n') ? data.slice(0, -1) : data,\n      })\n    }\n\n    // Reset for the next event\n    id = undefined\n    data = ''\n    eventType = ''\n  }\n\n  function reset(options: {consume?: boolean} = {}) {\n    if (incompleteLine && options.consume) {\n      parseLine(incompleteLine)\n    }\n\n    isFirstChunk = true\n    id = undefined\n    data = ''\n    eventType = ''\n    incompleteLine = ''\n  }\n\n  return {feed, reset}\n}\n\n/**\n * For the given `chunk`, split it into lines according to spec, and return any remaining incomplete line.\n *\n * @param chunk - The chunk to split into lines\n * @returns A tuple containing an array of complete lines, and any remaining incomplete line\n * @internal\n */\nfunction splitLines(chunk: string): [complete: Array<string>, incomplete: string] {\n  /**\n   * According to the spec, a line is terminated by either:\n   * - U+000D CARRIAGE RETURN U+000A LINE FEED (CRLF) character pair\n   * - a single U+000A LINE FEED(LF) character not preceded by a U+000D CARRIAGE RETURN(CR) character\n   * - a single U+000D CARRIAGE RETURN(CR) character not followed by a U+000A LINE FEED(LF) character\n   */\n  const lines: Array<string> = []\n  let incompleteLine = ''\n  let searchIndex = 0\n\n  while (searchIndex < chunk.length) {\n    // Find next line terminator\n    const crIndex = chunk.indexOf('\\r', searchIndex)\n    const lfIndex = chunk.indexOf('\\n', searchIndex)\n\n    // Determine line end\n    let lineEnd = -1\n    if (crIndex !== -1 && lfIndex !== -1) {\n      // CRLF case\n      lineEnd = Math.min(crIndex, lfIndex)\n    } else if (crIndex !== -1) {\n      // CR at the end of a chunk might be part of a CRLF sequence that spans chunks,\n      // so we shouldn't treat it as a line terminator (yet)\n      if (crIndex === chunk.length - 1) {\n        lineEnd = -1\n      } else {\n        lineEnd = crIndex\n      }\n    } else if (lfIndex !== -1) {\n      lineEnd = lfIndex\n    }\n\n    // Extract line if terminator found\n    if (lineEnd === -1) {\n      // No terminator found, rest is incomplete\n      incompleteLine = chunk.slice(searchIndex)\n      break\n    } else {\n      const line = chunk.slice(searchIndex, lineEnd)\n      lines.push(line)\n\n      // Move past line terminator\n      searchIndex = lineEnd + 1\n      if (chunk[searchIndex - 1] === '\\r' && chunk[searchIndex] === '\\n') {\n        searchIndex++\n      }\n    }\n  }\n\n  return [lines, incompleteLine]\n}\n","import {createParser} from './parse.ts'\nimport type {EventSourceMessage, EventSourceParser} from './types.ts'\n\n/**\n * Options for the EventSourceParserStream.\n *\n * @public\n */\nexport interface StreamOptions {\n  /**\n   * Behavior when a parsing error occurs.\n   *\n   * - A custom function can be provided to handle the error.\n   * - `'terminate'` will error the stream and stop parsing.\n   * - Any other value will ignore the error and continue parsing.\n   *\n   * @defaultValue `undefined`\n   */\n  onError?: ('terminate' | ((error: Error) => void)) | undefined\n\n  /**\n   * Callback for when a reconnection interval is sent from the server.\n   *\n   * @param retry - The number of milliseconds to wait before reconnecting.\n   */\n  onRetry?: ((retry: number) => void) | undefined\n\n  /**\n   * Callback for when a comment is encountered in the stream.\n   *\n   * @param comment - The comment encountered in the stream.\n   */\n  onComment?: ((comment: string) => void) | undefined\n}\n\n/**\n * A TransformStream that ingests a stream of strings and produces a stream of `EventSourceMessage`.\n *\n * @example Basic usage\n * ```\n * const eventStream =\n *   response.body\n *     .pipeThrough(new TextDecoderStream())\n *     .pipeThrough(new EventSourceParserStream())\n * ```\n *\n * @example Terminate stream on parsing errors\n * ```\n * const eventStream =\n *  response.body\n *   .pipeThrough(new TextDecoderStream())\n *   .pipeThrough(new EventSourceParserStream({terminateOnError: true}))\n * ```\n *\n * @public\n */\nexport class EventSourceParserStream extends TransformStream<string, EventSourceMessage> {\n  constructor({onError, onRetry, onComment}: StreamOptions = {}) {\n    let parser!: EventSourceParser\n\n    super({\n      start(controller) {\n        parser = createParser({\n          onEvent: (event) => {\n            controller.enqueue(event)\n          },\n          onError(error) {\n            if (onError === 'terminate') {\n              controller.error(error)\n            } else if (typeof onError === 'function') {\n              onError(error)\n            }\n\n            // Ignore by default\n          },\n          onRetry,\n          onComment,\n        })\n      },\n      transform(chunk) {\n        parser.feed(chunk)\n      },\n    })\n  }\n}\n\nexport {type ErrorType, ParseError} from './errors.ts'\nexport type {EventSourceMessage} from './types.ts'\n",null,"/**\n * MCP Error Classes\n *\n * Error hierarchy for MCP-related failures.\n */\n\n/**\n * Base error for all MCP-related errors\n */\nexport class MCPError extends Error {\n  constructor(\n    message: string,\n    public readonly serverName?: string,\n    public readonly cause?: Error\n  ) {\n    super(message);\n    this.name = 'MCPError';\n    if (cause) {\n      this.stack = `${this.stack}\\nCaused by: ${cause.stack}`;\n    }\n  }\n}\n\n/**\n * Connection-related errors (failed to connect, disconnected unexpectedly)\n */\nexport class MCPConnectionError extends MCPError {\n  constructor(message: string, serverName?: string, cause?: Error) {\n    super(message, serverName, cause);\n    this.name = 'MCPConnectionError';\n  }\n}\n\n/**\n * Timeout errors (request timeout, connection timeout)\n */\nexport class MCPTimeoutError extends MCPError {\n  constructor(\n    message: string,\n    public readonly timeoutMs: number,\n    serverName?: string,\n    cause?: Error\n  ) {\n    super(message, serverName, cause);\n    this.name = 'MCPTimeoutError';\n  }\n}\n\n/**\n * Protocol-level errors (invalid message, unsupported capability)\n */\nexport class MCPProtocolError extends MCPError {\n  constructor(message: string, serverName?: string, cause?: Error) {\n    super(message, serverName, cause);\n    this.name = 'MCPProtocolError';\n  }\n}\n\n/**\n * Tool execution errors (tool not found, tool execution failed)\n */\nexport class MCPToolError extends MCPError {\n  constructor(\n    message: string,\n    public readonly toolName: string,\n    serverName?: string,\n    cause?: Error\n  ) {\n    super(message, serverName, cause);\n    this.name = 'MCPToolError';\n  }\n}\n\n/**\n * Resource-related errors (resource not found, subscription failed)\n */\nexport class MCPResourceError extends MCPError {\n  constructor(\n    message: string,\n    public readonly resourceUri: string,\n    serverName?: string,\n    cause?: Error\n  ) {\n    super(message, serverName, cause);\n    this.name = 'MCPResourceError';\n  }\n}\n","/**\n * MCP Configuration Types\n *\n * Defines configuration structures for MCP servers and global library configuration.\n */\n\n/**\n * Transport type for MCP communication\n */\nexport type MCPTransportType = 'stdio' | 'http' | 'https';\n\n/**\n * Stdio transport configuration\n */\nexport interface StdioTransportConfig {\n  /** Command to execute (e.g., 'npx', 'node') */\n  command: string;\n  /** Command arguments */\n  args?: string[];\n  /** Environment variables */\n  env?: Record<string, string>;\n  /** Working directory for the process */\n  cwd?: string;\n}\n\n/**\n * HTTP/HTTPS transport configuration (StreamableHTTP)\n */\nexport interface HTTPTransportConfig {\n  /** HTTP(S) endpoint URL */\n  url: string;\n  /** Authentication token (supports ${ENV_VAR} interpolation) */\n  token?: string;\n  /** Additional HTTP headers */\n  headers?: Record<string, string>;\n  /** Request timeout in milliseconds */\n  timeoutMs?: number;\n  /** Session ID for reconnection */\n  sessionId?: string;\n  /** Reconnection options */\n  reconnection?: {\n    /** Max reconnection delay in ms (default: 30000) */\n    maxReconnectionDelay?: number;\n    /** Initial reconnection delay in ms (default: 1000) */\n    initialReconnectionDelay?: number;\n    /** Reconnection delay growth factor (default: 1.5) */\n    reconnectionDelayGrowFactor?: number;\n    /** Max retry attempts (default: 2) */\n    maxRetries?: number;\n  };\n}\n\n/**\n * Transport configuration union type\n */\nexport type TransportConfig = StdioTransportConfig | HTTPTransportConfig;\n\n/**\n * MCP server configuration\n */\nexport interface MCPServerConfig {\n  /** Unique identifier for the server */\n  name: string;\n  /** Human-readable display name */\n  displayName?: string;\n  /** Server description */\n  description?: string;\n  /** Transport type */\n  transport: MCPTransportType;\n  /** Transport-specific configuration */\n  transportConfig: TransportConfig;\n  /** Auto-connect on startup (default: false) */\n  autoConnect?: boolean;\n  /** Auto-reconnect on failure (default: true) */\n  autoReconnect?: boolean;\n  /** Reconnect interval in milliseconds (default: 5000) */\n  reconnectIntervalMs?: number;\n  /** Maximum reconnect attempts (default: 10) */\n  maxReconnectAttempts?: number;\n  /** Request timeout in milliseconds (default: 30000) */\n  requestTimeoutMs?: number;\n  /** Health check interval in milliseconds (default: 60000) */\n  healthCheckIntervalMs?: number;\n  /** Tool namespace prefix (default: 'mcp:{name}') */\n  toolNamespace?: string;\n  /** Permission configuration for tools from this server */\n  permissions?: {\n    /** Default permission scope */\n    defaultScope?: 'once' | 'session' | 'always' | 'never';\n    /** Default risk level */\n    defaultRiskLevel?: 'low' | 'medium' | 'high' | 'critical';\n  };\n  /**\n   * Map environment variable keys to connector names for runtime auth resolution.\n   * When connecting, the connector's token will be injected into the env var.\n   * Example: { 'GITHUB_PERSONAL_ACCESS_TOKEN': 'my-github-connector' }\n   */\n  connectorBindings?: Record<string, string>;\n}\n\n/**\n * MCP global configuration\n */\nexport interface MCPConfiguration {\n  /** List of MCP servers */\n  servers: MCPServerConfig[];\n  /** Default settings for all servers */\n  defaults?: {\n    /** Default auto-connect (default: false) */\n    autoConnect?: boolean;\n    /** Default auto-reconnect (default: true) */\n    autoReconnect?: boolean;\n    /** Default reconnect interval in milliseconds (default: 5000) */\n    reconnectIntervalMs?: number;\n    /** Default maximum reconnect attempts (default: 10) */\n    maxReconnectAttempts?: number;\n    /** Default request timeout in milliseconds (default: 30000) */\n    requestTimeoutMs?: number;\n    /** Default health check interval in milliseconds (default: 60000) */\n    healthCheckIntervalMs?: number;\n  };\n}\n\n/**\n * Global library configuration\n */\nexport interface OneRingAIConfig {\n  /** Configuration schema version */\n  version?: string;\n  /** MCP configuration */\n  mcp?: MCPConfiguration;\n  /** Tools configuration */\n  tools?: {\n    /** Permission defaults for all tools */\n    permissions?: {\n      defaultScope?: 'once' | 'session' | 'always' | 'never';\n      defaultRiskLevel?: 'low' | 'medium' | 'high' | 'critical';\n    };\n  };\n  /** Session configuration */\n  session?: {\n    /** Storage type ('memory' or 'file') */\n    storage?: 'memory' | 'file';\n    /** Storage-specific options */\n    storageOptions?: Record<string, unknown>;\n    /** Auto-save enabled (default: false) */\n    autoSave?: boolean;\n    /** Auto-save interval in milliseconds (default: 30000) */\n    autoSaveIntervalMs?: number;\n  };\n  /** Context management configuration */\n  context?: {\n    /** Maximum context tokens (default: 128000) */\n    maxContextTokens?: number;\n    /** Context strategy ('proactive' | 'aggressive' | 'lazy' | 'rolling-window' | 'adaptive') */\n    strategy?: string;\n    /** Strategy-specific options */\n    strategyOptions?: Record<string, unknown>;\n  };\n}\n\n/**\n * Apply defaults to server config\n */\nexport function applyServerDefaults(\n  config: MCPServerConfig,\n  defaults?: MCPConfiguration['defaults']\n): Required<Omit<MCPServerConfig, 'displayName' | 'description' | 'permissions' | 'toolNamespace' | 'connectorBindings'>> & {\n  displayName?: string;\n  description?: string;\n  permissions?: MCPServerConfig['permissions'];\n  toolNamespace: string;\n  connectorBindings?: Record<string, string>;\n} {\n  return {\n    name: config.name,\n    displayName: config.displayName,\n    description: config.description,\n    transport: config.transport,\n    transportConfig: config.transportConfig,\n    autoConnect: config.autoConnect ?? defaults?.autoConnect ?? false,\n    autoReconnect: config.autoReconnect ?? defaults?.autoReconnect ?? true,\n    reconnectIntervalMs: config.reconnectIntervalMs ?? defaults?.reconnectIntervalMs ?? 5000,\n    maxReconnectAttempts: config.maxReconnectAttempts ?? defaults?.maxReconnectAttempts ?? 10,\n    requestTimeoutMs: config.requestTimeoutMs ?? defaults?.requestTimeoutMs ?? 30000,\n    healthCheckIntervalMs: config.healthCheckIntervalMs ?? defaults?.healthCheckIntervalMs ?? 60000,\n    toolNamespace: config.toolNamespace ?? `mcp:${config.name}`,\n    permissions: config.permissions,\n    connectorBindings: config.connectorBindings,\n  };\n}\n","/**\n * MCP Tool Adapter\n *\n * Converts MCP tools to ToolFunction interface for use with ToolManager.\n */\n\nimport type { ToolFunction } from '../../../domain/entities/Tool.js';\nimport type { MCPTool, MCPToolResult } from '../../../domain/entities/MCPTypes.js';\nimport type { IMCPClient } from '../../../domain/interfaces/IMCPClient.js';\nimport { MCPToolError } from '../../../domain/errors/MCPError.js';\nimport { sanitizeToolName } from '../../../utils/sanitize.js';\n\n/**\n * Convert an MCP tool to a ToolFunction\n */\nexport function createMCPToolAdapter(\n  tool: MCPTool,\n  client: IMCPClient,\n  namespace: string\n): ToolFunction {\n  // Sanitize the full name for API compatibility (OpenAI pattern: ^[a-zA-Z0-9_-]+$)\n  const fullName = sanitizeToolName(`${namespace}:${tool.name}`);\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: fullName,\n        description: tool.description || `MCP tool '${tool.name}' from server '${client.name}'`,\n        parameters: tool.inputSchema,\n      },\n    },\n\n    async execute(args: Record<string, unknown>): Promise<MCPToolResult | string> {\n      try {\n        const result = await client.callTool(tool.name, args);\n\n        // If the result is a simple text response, return just the text\n        if (result.content?.length === 1 && result.content[0]?.type === 'text') {\n          return result.content[0].text ?? '';\n        }\n\n        // Otherwise return the full result for complex responses\n        return result;\n      } catch (error) {\n        if (error instanceof MCPToolError) {\n          throw error;\n        }\n        throw new MCPToolError(\n          `Failed to execute MCP tool '${tool.name}'`,\n          tool.name,\n          client.name,\n          error as Error\n        );\n      }\n    },\n\n    describeCall(args: Record<string, unknown>): string {\n      // Try common argument names for human-readable description\n      const commonKeys = [\n        'file_path',\n        'path',\n        'uri',\n        'url',\n        'query',\n        'message',\n        'name',\n        'id',\n        'key',\n      ];\n\n      for (const key of commonKeys) {\n        if (key in args && typeof args[key] === 'string') {\n          return args[key] as string;\n        }\n      }\n\n      // Fallback to first string value\n      for (const value of Object.values(args)) {\n        if (typeof value === 'string' && value.length > 0) {\n          return value.length > 60 ? `${value.substring(0, 60)}...` : value;\n        }\n      }\n\n      // Final fallback\n      return tool.name;\n    },\n  };\n}\n\n/**\n * Convert all tools from an MCP client to ToolFunctions\n */\nexport function createMCPToolAdapters(\n  tools: MCPTool[],\n  client: IMCPClient,\n  namespace: string\n): ToolFunction[] {\n  return tools.map((tool) => createMCPToolAdapter(tool, client, namespace));\n}\n","/**\n * MCP Client Implementation\n *\n * Wrapper around @modelcontextprotocol/sdk Client with lifecycle management,\n * auto-reconnect, and integration with ToolManager.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { Client } from '@modelcontextprotocol/sdk/client/index.js';\nimport { StdioClientTransport } from '@modelcontextprotocol/sdk/client/stdio.js';\nimport { StreamableHTTPClientTransport } from '@modelcontextprotocol/sdk/client/streamableHttp.js';\nimport {\n  ListToolsResultSchema,\n  CallToolResultSchema,\n  ListResourcesResultSchema,\n  ReadResourceResultSchema,\n  ListPromptsResultSchema,\n  GetPromptResultSchema,\n} from '@modelcontextprotocol/sdk/types.js';\nimport type { Transport } from '@modelcontextprotocol/sdk/shared/transport.js';\nimport type { IMCPClient, MCPClientConnectionState } from '../../domain/interfaces/IMCPClient.js';\nimport type {\n  MCPTool,\n  MCPToolResult,\n  MCPResource,\n  MCPResourceContent,\n  MCPPrompt,\n  MCPPromptResult,\n  MCPServerCapabilities,\n  MCPClientState,\n} from '../../domain/entities/MCPTypes.js';\nimport type {\n  MCPServerConfig,\n  MCPConfiguration,\n  StdioTransportConfig,\n  HTTPTransportConfig,\n} from '../../domain/entities/MCPConfig.js';\nimport type { ToolManager } from '../ToolManager.js';\nimport {\n  MCPError,\n  MCPConnectionError,\n  MCPToolError,\n} from '../../domain/errors/MCPError.js';\nimport { applyServerDefaults } from '../../domain/entities/MCPConfig.js';\nimport { createMCPToolAdapters } from '../../infrastructure/mcp/adapters/MCPToolAdapter.js';\nimport { IDisposable } from '../../domain/interfaces/IDisposable.js';\n\n/**\n * MCP Client class\n */\nexport class MCPClient extends EventEmitter implements IMCPClient, IDisposable {\n  public readonly name: string;\n  private readonly config: ReturnType<typeof applyServerDefaults>;\n  private client: Client | null = null;\n  private transport: Transport | null = null;\n  private _state: MCPClientConnectionState = 'disconnected';\n  private _capabilities?: MCPServerCapabilities;\n  private _tools: MCPTool[] = [];\n  private reconnectAttempts = 0;\n  private reconnectTimer?: NodeJS.Timeout;\n  private healthCheckTimer?: NodeJS.Timeout;\n  private subscribedResources = new Set<string>();\n  private registeredToolNames = new Set<string>();\n  private _isDestroyed = false;\n\n  constructor(config: MCPServerConfig, defaults?: MCPConfiguration['defaults']) {\n    super();\n    this.name = config.name;\n    this.config = applyServerDefaults(config, defaults);\n  }\n\n  // Getters\n\n  get state(): MCPClientConnectionState {\n    return this._state;\n  }\n\n  get capabilities(): MCPServerCapabilities | undefined {\n    return this._capabilities;\n  }\n\n  get tools(): MCPTool[] {\n    return this._tools;\n  }\n\n  // Lifecycle methods\n\n  async connect(): Promise<void> {\n    if (this._state === 'connected' || this._state === 'connecting') {\n      return;\n    }\n\n    this._state = 'connecting';\n    this.emit('connecting');\n\n    try {\n      // Create transport based on config\n      this.transport = this.createTransport();\n\n      // Create SDK client\n      this.client = new Client(\n        {\n          name: '@everworker/oneringai',\n          version: '0.2.0',\n        },\n        {\n          capabilities: {\n            // Request all capabilities (empty object means we support all)\n          },\n        }\n      );\n\n      // Connect\n      await this.client.connect(this.transport);\n\n      // Get server capabilities - the SDK exposes this after connection\n      // The actual capabilities are negotiated during connection\n      this._capabilities = {} as MCPServerCapabilities;\n\n      // Mark as connected before refreshing tools (so ensureConnected() doesn't throw)\n      this._state = 'connected';\n      this.reconnectAttempts = 0;\n\n      // List available tools\n      await this.refreshTools();\n\n      this.emit('connected');\n\n      // Start health check\n      this.startHealthCheck();\n    } catch (error) {\n      // Clean up partially created resources\n      this.stopHealthCheck(); // In case error occurred after startHealthCheck()\n\n      if (this.client) {\n        try {\n          await this.client.close();\n        } catch {\n          // Ignore close errors during cleanup\n        }\n        this.client = null;\n      }\n      this.transport = null;\n      this._tools = [];\n      this._capabilities = undefined;\n\n      this._state = 'failed';\n      const mcpError = new MCPConnectionError(\n        `Failed to connect to MCP server '${this.name}'`,\n        this.name,\n        error as Error\n      );\n      this.emit('failed', mcpError);\n      this.emit('error', mcpError);\n\n      // Auto-reconnect if enabled\n      if (this.config.autoReconnect) {\n        this.scheduleReconnect();\n      } else {\n        throw mcpError;\n      }\n    }\n  }\n\n  async disconnect(): Promise<void> {\n    this.stopHealthCheck();\n    this.stopReconnect();\n\n    if (this.client && this.transport) {\n      try {\n        await this.client.close();\n      } catch (error) {\n        // Ignore close errors\n      }\n    }\n\n    this.client = null;\n    this.transport = null;\n    this._state = 'disconnected';\n    this._tools = [];\n    this.emit('disconnected');\n  }\n\n  async reconnect(): Promise<void> {\n    await this.disconnect();\n    await this.connect();\n  }\n\n  isConnected(): boolean {\n    return this._state === 'connected';\n  }\n\n  async ping(): Promise<boolean> {\n    if (!this.client || !this.isConnected()) {\n      return false;\n    }\n\n    try {\n      await this.client.ping();\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  // Tool methods\n\n  async listTools(): Promise<MCPTool[]> {\n    this.ensureConnected();\n\n    try {\n      const response = await this.client!.request({ method: 'tools/list' }, ListToolsResultSchema);\n\n      this._tools = response.tools.map((tool) => ({\n        name: tool.name,\n        description: tool.description,\n        inputSchema: tool.inputSchema as MCPTool['inputSchema'],\n      }));\n\n      return this._tools;\n    } catch (error) {\n      throw new MCPError(`Failed to list tools from server '${this.name}'`, this.name, error as Error);\n    }\n  }\n\n  async callTool(name: string, args: Record<string, unknown>): Promise<MCPToolResult> {\n    this.ensureConnected();\n\n    this.emit('tool:called', name, args);\n\n    try {\n      const response = await this.client!.request(\n        {\n          method: 'tools/call',\n          params: {\n            name,\n            arguments: args,\n          },\n        },\n        CallToolResultSchema\n      );\n\n      const result: MCPToolResult = {\n        content: response.content.map((item) => ({\n          type: item.type as 'text' | 'image' | 'resource',\n          text: 'text' in item ? item.text : undefined,\n          data: 'data' in item ? item.data : undefined,\n          mimeType: 'mimeType' in item ? item.mimeType : undefined,\n          uri: 'uri' in item ? item.uri : undefined,\n        })),\n        isError: response.isError,\n      };\n\n      this.emit('tool:result', name, result);\n\n      if (result.isError) {\n        const errorText = result.content.find((c) => c.type === 'text')?.text || 'Unknown error';\n        throw new MCPToolError(errorText, name, this.name);\n      }\n\n      return result;\n    } catch (error) {\n      if (error instanceof MCPToolError) {\n        throw error;\n      }\n      throw new MCPToolError(\n        `Failed to call tool '${name}' on server '${this.name}'`,\n        name,\n        this.name,\n        error as Error\n      );\n    }\n  }\n\n  registerTools(toolManager: ToolManager): void {\n    this.registerToolsSelective(toolManager);\n  }\n\n  /**\n   * Register specific tools with a ToolManager (selective registration)\n   * @param toolManager - ToolManager to register with\n   * @param toolNames - Optional array of tool names to register (original MCP names, not namespaced).\n   *                    If not provided, registers all tools.\n   */\n  registerToolsSelective(toolManager: ToolManager, toolNames?: string[]): void {\n    if (this._tools.length === 0) {\n      return;\n    }\n\n    // Filter tools if specific names provided\n    const toolsToRegister = toolNames\n      ? this._tools.filter(t => toolNames.includes(t.name))\n      : this._tools;\n\n    if (toolsToRegister.length === 0) {\n      return;\n    }\n\n    // Convert MCP tools to ToolFunctions\n    const toolFunctions = createMCPToolAdapters(toolsToRegister, this, this.config.toolNamespace);\n\n    // Register each tool with the ToolManager\n    for (const toolFn of toolFunctions) {\n      const toolName = toolFn.definition.function.name;\n\n      toolManager.register(toolFn, {\n        namespace: this.config.toolNamespace,\n        enabled: true,\n        permission: this.config.permissions\n          ? {\n              scope: this.config.permissions.defaultScope,\n              riskLevel: this.config.permissions.defaultRiskLevel,\n            }\n          : undefined,\n      });\n\n      this.registeredToolNames.add(toolName);\n    }\n  }\n\n  unregisterTools(toolManager: ToolManager): void {\n    for (const toolName of this.registeredToolNames) {\n      toolManager.unregister(toolName);\n    }\n    this.registeredToolNames.clear();\n  }\n\n  // Resource methods\n\n  async listResources(): Promise<MCPResource[]> {\n    this.ensureConnected();\n\n    try {\n      const response = await this.client!.request({ method: 'resources/list' }, ListResourcesResultSchema);\n\n      return response.resources.map((resource) => ({\n        uri: resource.uri,\n        name: resource.name,\n        description: resource.description,\n        mimeType: resource.mimeType,\n      }));\n    } catch (error) {\n      throw new MCPError(\n        `Failed to list resources from server '${this.name}'`,\n        this.name,\n        error as Error\n      );\n    }\n  }\n\n  async readResource(uri: string): Promise<MCPResourceContent> {\n    this.ensureConnected();\n\n    try {\n      const response = await this.client!.request(\n        {\n          method: 'resources/read',\n          params: { uri },\n        },\n        ReadResourceResultSchema\n      );\n\n      const content = response.contents?.[0];\n      if (!content) {\n        throw new MCPError(`No content returned for resource '${uri}'`, this.name);\n      }\n\n      return {\n        uri: content.uri,\n        mimeType: content.mimeType,\n        text: 'text' in content ? content.text : undefined,\n        blob: 'blob' in content ? content.blob : undefined,\n      };\n    } catch (error) {\n      throw new MCPError(\n        `Failed to read resource '${uri}' from server '${this.name}'`,\n        this.name,\n        error as Error\n      );\n    }\n  }\n\n  async subscribeResource(uri: string): Promise<void> {\n    this.ensureConnected();\n\n    if (!this._capabilities?.resources?.subscribe) {\n      throw new MCPError(`Server '${this.name}' does not support resource subscriptions`, this.name);\n    }\n\n    try {\n      // Subscribe method typically doesn't return structured data\n      await this.client!.request(\n        {\n          method: 'resources/subscribe',\n          params: { uri },\n        },\n        {} as any // No specific schema for subscription acknowledgment\n      );\n\n      this.subscribedResources.add(uri);\n    } catch (error) {\n      throw new MCPError(\n        `Failed to subscribe to resource '${uri}' on server '${this.name}'`,\n        this.name,\n        error as Error\n      );\n    }\n  }\n\n  async unsubscribeResource(uri: string): Promise<void> {\n    this.ensureConnected();\n\n    try {\n      // Unsubscribe method typically doesn't return structured data\n      await this.client!.request(\n        {\n          method: 'resources/unsubscribe',\n          params: { uri },\n        },\n        {} as any // No specific schema for unsubscribe acknowledgment\n      );\n\n      this.subscribedResources.delete(uri);\n    } catch (error) {\n      throw new MCPError(\n        `Failed to unsubscribe from resource '${uri}' on server '${this.name}'`,\n        this.name,\n        error as Error\n      );\n    }\n  }\n\n  // Prompt methods\n\n  async listPrompts(): Promise<MCPPrompt[]> {\n    this.ensureConnected();\n\n    try {\n      const response = await this.client!.request({ method: 'prompts/list' }, ListPromptsResultSchema);\n\n      return response.prompts.map((prompt) => ({\n        name: prompt.name,\n        description: prompt.description,\n        arguments: prompt.arguments,\n      }));\n    } catch (error) {\n      throw new MCPError(`Failed to list prompts from server '${this.name}'`, this.name, error as Error);\n    }\n  }\n\n  async getPrompt(name: string, args?: Record<string, unknown>): Promise<MCPPromptResult> {\n    this.ensureConnected();\n\n    try {\n      const response = await this.client!.request(\n        {\n          method: 'prompts/get',\n          params: {\n            name,\n            arguments: args,\n          },\n        },\n        GetPromptResultSchema\n      );\n\n      return {\n        description: response.description,\n        messages: response.messages.map((msg) => ({\n          role: msg.role as 'user' | 'assistant',\n          content: {\n            type: msg.content.type as 'text' | 'image' | 'resource',\n            text: 'text' in msg.content ? msg.content.text : undefined,\n            data: 'data' in msg.content ? msg.content.data : undefined,\n            mimeType: 'mimeType' in msg.content ? msg.content.mimeType : undefined,\n            uri: 'uri' in msg.content ? msg.content.uri : undefined,\n          },\n        })),\n      };\n    } catch (error) {\n      throw new MCPError(\n        `Failed to get prompt '${name}' from server '${this.name}'`,\n        this.name,\n        error as Error\n      );\n    }\n  }\n\n  // State management\n\n  getState(): MCPClientState {\n    return {\n      name: this.name,\n      state: this._state,\n      capabilities: this._capabilities,\n      subscribedResources: Array.from(this.subscribedResources),\n      lastConnectedAt: this._state === 'connected' ? Date.now() : undefined,\n      connectionAttempts: this.reconnectAttempts,\n    };\n  }\n\n  loadState(state: MCPClientState): void {\n    this.subscribedResources = new Set(state.subscribedResources);\n    this.reconnectAttempts = state.connectionAttempts;\n  }\n\n  /**\n   * Check if the MCPClient instance has been destroyed\n   */\n  get isDestroyed(): boolean {\n    return this._isDestroyed;\n  }\n\n  destroy(): void {\n    if (this._isDestroyed) return;\n    this._isDestroyed = true;\n    this.stopHealthCheck();\n    this.stopReconnect();\n    if (this.client) {\n      this.client.close().catch(() => {});\n      this.client = null;\n    }\n    this.transport = null;\n    this._tools = [];\n    this._capabilities = undefined;\n    this._state = 'disconnected';\n    this.subscribedResources.clear();\n    this.registeredToolNames.clear();\n    this.removeAllListeners();\n  }\n\n  // Private helper methods\n\n  private createTransport(): Transport {\n    const { transport, transportConfig } = this.config;\n\n    if (transport === 'stdio') {\n      const stdioConfig = transportConfig as StdioTransportConfig;\n      return new StdioClientTransport({\n        command: stdioConfig.command,\n        args: stdioConfig.args,\n        env: stdioConfig.env as Record<string, string> | undefined,\n      });\n    }\n\n    if (transport === 'http' || transport === 'https') {\n      const httpConfig = transportConfig as HTTPTransportConfig;\n\n      // Build headers\n      const headers: Record<string, string> = { ...httpConfig.headers };\n      if (httpConfig.token) {\n        headers['Authorization'] = `Bearer ${httpConfig.token}`;\n      }\n\n      return new StreamableHTTPClientTransport(new URL(httpConfig.url), {\n        sessionId: httpConfig.sessionId,\n        requestInit: {\n          headers,\n          ...(httpConfig.timeoutMs && { signal: AbortSignal.timeout(httpConfig.timeoutMs) }),\n        },\n        reconnectionOptions: httpConfig.reconnection\n          ? {\n              maxReconnectionDelay: httpConfig.reconnection.maxReconnectionDelay ?? 30000,\n              initialReconnectionDelay: httpConfig.reconnection.initialReconnectionDelay ?? 1000,\n              reconnectionDelayGrowFactor: httpConfig.reconnection.reconnectionDelayGrowFactor ?? 1.5,\n              maxRetries: httpConfig.reconnection.maxRetries ?? 2,\n            }\n          : undefined,\n      });\n    }\n\n    throw new MCPError(`Transport '${transport}' not supported`, this.name);\n  }\n\n  private ensureConnected(): void {\n    if (!this.client || !this.isConnected()) {\n      throw new MCPConnectionError(`MCP server '${this.name}' is not connected`, this.name);\n    }\n  }\n\n  private async refreshTools(): Promise<void> {\n    try {\n      await this.listTools();\n    } catch (error) {\n      // Log but don't fail\n      this.emit('error', error);\n    }\n  }\n\n  private startHealthCheck(): void {\n    if (this.config.healthCheckIntervalMs <= 0) {\n      return;\n    }\n\n    this.healthCheckTimer = setInterval(async () => {\n      const alive = await this.ping();\n      if (!alive && this._state === 'connected') {\n        this.emit('error', new MCPConnectionError(`Health check failed for server '${this.name}'`, this.name));\n        if (this.config.autoReconnect) {\n          await this.reconnect();\n        }\n      }\n    }, this.config.healthCheckIntervalMs);\n  }\n\n  private stopHealthCheck(): void {\n    if (this.healthCheckTimer) {\n      clearInterval(this.healthCheckTimer);\n      this.healthCheckTimer = undefined;\n    }\n  }\n\n  private scheduleReconnect(): void {\n    if (this.reconnectAttempts >= this.config.maxReconnectAttempts) {\n      this.emit('error', new MCPConnectionError(`Max reconnect attempts reached for server '${this.name}'`, this.name));\n      return;\n    }\n\n    this.reconnectAttempts++;\n    this._state = 'reconnecting';\n    this.emit('reconnecting', this.reconnectAttempts);\n\n    // Exponential backoff: 5s, 10s, 20s, 40s, ...\n    const delay = this.config.reconnectIntervalMs * Math.pow(2, this.reconnectAttempts - 1);\n\n    this.reconnectTimer = setTimeout(async () => {\n      try {\n        await this.connect();\n      } catch (error) {\n        // connect() will handle retry\n      }\n    }, delay);\n  }\n\n  private stopReconnect(): void {\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = undefined;\n    }\n  }\n}\n","/**\n * MCP Registry\n *\n * Static registry for managing MCP client connections.\n * Follows the same pattern as Connector registry.\n */\n\nimport { MCPClient } from './MCPClient.js';\nimport type { IMCPClient } from '../../domain/interfaces/IMCPClient.js';\nimport type { MCPServerConfig, MCPConfiguration, OneRingAIConfig } from '../../domain/entities/MCPConfig.js';\nimport { MCPError } from '../../domain/errors/MCPError.js';\nimport { promises as fs } from 'fs';\nimport { resolve } from 'path';\n\n/**\n * MCP Registry - static registry for MCP clients\n */\nexport class MCPRegistry {\n  private static clients = new Map<string, IMCPClient>();\n\n  /**\n   * Create and register an MCP client\n   */\n  static create(config: MCPServerConfig, defaults?: MCPConfiguration['defaults']): IMCPClient {\n    if (this.clients.has(config.name)) {\n      throw new MCPError(`MCP server '${config.name}' is already registered`);\n    }\n\n    const client = new MCPClient(config, defaults);\n    this.clients.set(config.name, client);\n\n    return client;\n  }\n\n  /**\n   * Get a registered MCP client\n   */\n  static get(name: string): IMCPClient {\n    const client = this.clients.get(name);\n    if (!client) {\n      throw new MCPError(`MCP server '${name}' not found in registry`);\n    }\n    return client;\n  }\n\n  /**\n   * Check if an MCP client is registered\n   */\n  static has(name: string): boolean {\n    return this.clients.has(name);\n  }\n\n  /**\n   * List all registered MCP client names\n   */\n  static list(): string[] {\n    return Array.from(this.clients.keys());\n  }\n\n  /**\n   * Get info about a registered MCP client\n   */\n  static getInfo(name: string): {\n    name: string;\n    state: string;\n    connected: boolean;\n    toolCount: number;\n  } {\n    const client = this.get(name);\n    return {\n      name: client.name,\n      state: client.state,\n      connected: client.isConnected(),\n      toolCount: client.tools.length,\n    };\n  }\n\n  /**\n   * Get info about all registered MCP clients\n   */\n  static getAllInfo(): Array<{\n    name: string;\n    state: string;\n    connected: boolean;\n    toolCount: number;\n  }> {\n    return Array.from(this.clients.keys()).map((name) => this.getInfo(name));\n  }\n\n  /**\n   * Create multiple clients from MCP configuration\n   */\n  static createFromConfig(config: MCPConfiguration): IMCPClient[] {\n    const clients: IMCPClient[] = [];\n\n    for (const serverConfig of config.servers) {\n      const client = this.create(serverConfig, config.defaults);\n      clients.push(client);\n    }\n\n    return clients;\n  }\n\n  /**\n   * Load MCP configuration from file and create clients\n   */\n  static async loadFromConfigFile(path: string): Promise<IMCPClient[]> {\n    try {\n      const configPath = resolve(path);\n      const content = await fs.readFile(configPath, 'utf-8');\n      const config: OneRingAIConfig = JSON.parse(content);\n\n      if (!config.mcp) {\n        throw new MCPError('Configuration file does not contain MCP section');\n      }\n\n      // Apply environment variable interpolation\n      const interpolatedConfig = this.interpolateEnvVars(config.mcp);\n\n      return this.createFromConfig(interpolatedConfig);\n    } catch (error) {\n      if (error instanceof MCPError) {\n        throw error;\n      }\n      throw new MCPError(`Failed to load MCP configuration from '${path}'`, undefined, error as Error);\n    }\n  }\n\n  /**\n   * Connect all servers with autoConnect enabled\n   */\n  static async connectAll(): Promise<void> {\n    const connectPromises: Promise<void>[] = [];\n\n    for (const client of this.clients.values()) {\n      if (!client.isConnected()) {\n        connectPromises.push(client.connect());\n      }\n    }\n\n    await Promise.all(connectPromises);\n  }\n\n  /**\n   * Disconnect all servers\n   */\n  static async disconnectAll(): Promise<void> {\n    const disconnectPromises: Promise<void>[] = [];\n\n    for (const client of this.clients.values()) {\n      if (client.isConnected()) {\n        disconnectPromises.push(client.disconnect());\n      }\n    }\n\n    await Promise.all(disconnectPromises);\n  }\n\n  /**\n   * Remove and destroy a specific client from the registry\n   * @param name - Name of the MCP server to remove\n   * @returns true if the server was found and removed, false otherwise\n   */\n  static remove(name: string): boolean {\n    const client = this.clients.get(name);\n    if (!client) {\n      return false;\n    }\n    client.destroy();\n    this.clients.delete(name);\n    return true;\n  }\n\n  /**\n   * Destroy all clients and clear registry\n   */\n  static destroyAll(): void {\n    for (const client of this.clients.values()) {\n      client.destroy();\n    }\n    this.clients.clear();\n  }\n\n  /**\n   * Clear the registry (for testing)\n   */\n  static clear(): void {\n    this.destroyAll();\n  }\n\n  /**\n   * Interpolate environment variables in configuration\n   * Replaces ${ENV_VAR} with process.env.ENV_VAR\n   */\n  private static interpolateEnvVars(config: MCPConfiguration): MCPConfiguration {\n    const jsonString = JSON.stringify(config);\n    const interpolated = jsonString.replace(/\\$\\{([^}]+)\\}/g, (_match, envVar) => {\n      const value = process.env[envVar];\n      if (value === undefined) {\n        throw new MCPError(`Environment variable '${envVar}' is not set`);\n      }\n      return value;\n    });\n\n    return JSON.parse(interpolated);\n  }\n}\n","/**\n * TextToSpeech capability class\n * Provides high-level API for text-to-speech synthesis\n */\n\nimport { Connector } from './Connector.js';\nimport { createTTSProvider } from './createAudioProvider.js';\nimport type { ITextToSpeechProvider, TTSOptions, TTSResponse } from '../domain/interfaces/IAudioProvider.js';\nimport type { AudioFormat } from '../domain/types/SharedTypes.js';\nimport { getTTSModelInfo, getTTSModelsByVendor, type ITTSModelDescription, type IVoiceInfo } from '../domain/entities/TTSModel.js';\nimport * as fs from 'fs/promises';\n\n/**\n * Configuration for TextToSpeech capability\n */\nexport interface TextToSpeechConfig {\n  /** Connector name or instance */\n  connector: string | Connector;\n\n  /** Default model to use */\n  model?: string;\n\n  /** Default voice to use */\n  voice?: string;\n\n  /** Default audio format */\n  format?: AudioFormat;\n\n  /** Default speed (0.25 to 4.0) */\n  speed?: number;\n}\n\n/**\n * TextToSpeech capability class\n * Provides text-to-speech synthesis with model introspection\n *\n * @example\n * ```typescript\n * const tts = TextToSpeech.create({\n *   connector: 'openai',\n *   model: 'tts-1-hd',\n *   voice: 'nova',\n * });\n *\n * const audio = await tts.synthesize('Hello, world!');\n * await tts.toFile('Hello', './output.mp3');\n * ```\n */\nexport class TextToSpeech {\n  private provider: ITextToSpeechProvider;\n  private config: TextToSpeechConfig;\n\n  /**\n   * Create a new TextToSpeech instance\n   */\n  static create(config: TextToSpeechConfig): TextToSpeech {\n    return new TextToSpeech(config);\n  }\n\n  private constructor(config: TextToSpeechConfig) {\n    const connector = typeof config.connector === 'string'\n      ? Connector.get(config.connector)\n      : config.connector;\n\n    this.provider = createTTSProvider(connector);\n    this.config = config;\n  }\n\n  // ======================== Synthesis Methods ========================\n\n  /**\n   * Synthesize speech from text\n   *\n   * @param text - Text to synthesize\n   * @param options - Optional synthesis parameters\n   * @returns Audio data and metadata\n   */\n  async synthesize(\n    text: string,\n    options?: Partial<Omit<TTSOptions, 'model' | 'input'>>\n  ): Promise<TTSResponse> {\n    const fullOptions: TTSOptions = {\n      model: this.config.model ?? this.getDefaultModel(),\n      input: text,\n      voice: options?.voice ?? this.config.voice ?? this.getDefaultVoice(),\n      format: options?.format ?? this.config.format,\n      speed: options?.speed ?? this.config.speed,\n      vendorOptions: options?.vendorOptions,\n    };\n\n    return this.provider.synthesize(fullOptions);\n  }\n\n  /**\n   * Synthesize speech and save to file\n   *\n   * @param text - Text to synthesize\n   * @param filePath - Output file path\n   * @param options - Optional synthesis parameters\n   */\n  async toFile(\n    text: string,\n    filePath: string,\n    options?: Partial<Omit<TTSOptions, 'model' | 'input'>>\n  ): Promise<void> {\n    const response = await this.synthesize(text, options);\n    await fs.writeFile(filePath, response.audio);\n  }\n\n  // ======================== Introspection Methods ========================\n\n  /**\n   * Get model information for current or specified model\n   */\n  getModelInfo(model?: string): ITTSModelDescription {\n    const targetModel = model ?? this.config.model ?? this.getDefaultModel();\n    const info = getTTSModelInfo(targetModel);\n\n    if (!info) {\n      throw new Error(`Unknown TTS model: ${targetModel}`);\n    }\n\n    return info;\n  }\n\n  /**\n   * Get model capabilities\n   */\n  getModelCapabilities(model?: string) {\n    return this.getModelInfo(model).capabilities;\n  }\n\n  /**\n   * List all available voices for current model\n   * For dynamic voice providers (e.g., ElevenLabs), fetches from API\n   * For static providers (e.g., OpenAI), returns from registry\n   */\n  async listVoices(model?: string): Promise<IVoiceInfo[]> {\n    // Try to fetch from provider API first\n    if (this.provider.listVoices) {\n      return this.provider.listVoices();\n    }\n\n    // Fall back to static list from registry\n    const caps = this.getModelCapabilities(model);\n    return caps.voices;\n  }\n\n  /**\n   * List all available models for this provider's vendor\n   */\n  listAvailableModels(): ITTSModelDescription[] {\n    const vendor = this.provider.vendor;\n    if (!vendor) {\n      return [];\n    }\n    return getTTSModelsByVendor(vendor as any);\n  }\n\n  /**\n   * Check if a specific feature is supported by the model\n   */\n  supportsFeature(\n    feature: keyof ITTSModelDescription['capabilities']['features'],\n    model?: string\n  ): boolean {\n    const caps = this.getModelCapabilities(model);\n    return Boolean(caps.features[feature]);\n  }\n\n  /**\n   * Get supported audio formats for the model\n   */\n  getSupportedFormats(model?: string): readonly AudioFormat[] | AudioFormat[] {\n    return this.getModelCapabilities(model).formats;\n  }\n\n  /**\n   * Get supported languages for the model\n   */\n  getSupportedLanguages(model?: string): readonly string[] | string[] {\n    return this.getModelCapabilities(model).languages;\n  }\n\n  /**\n   * Check if speed control is supported\n   */\n  supportsSpeedControl(model?: string): boolean {\n    return this.getModelCapabilities(model).speed.supported;\n  }\n\n  // ======================== Configuration Methods ========================\n\n  /**\n   * Update default model\n   */\n  setModel(model: string): void {\n    this.config.model = model;\n  }\n\n  /**\n   * Update default voice\n   */\n  setVoice(voice: string): void {\n    this.config.voice = voice;\n  }\n\n  /**\n   * Update default format\n   */\n  setFormat(format: AudioFormat): void {\n    this.config.format = format;\n  }\n\n  /**\n   * Update default speed\n   */\n  setSpeed(speed: number): void {\n    this.config.speed = speed;\n  }\n\n  // ======================== Private Methods ========================\n\n  /**\n   * Get default model (first active model for vendor)\n   */\n  private getDefaultModel(): string {\n    const models = this.listAvailableModels();\n    const firstModel = models[0];\n    if (!firstModel) {\n      throw new Error('No TTS models available for this provider');\n    }\n    return firstModel.name;\n  }\n\n  /**\n   * Get default voice (first or default-marked voice)\n   */\n  private getDefaultVoice(): string {\n    const caps = this.getModelInfo().capabilities;\n    const defaultVoice = caps.voices.find((v) => v.isDefault);\n    return defaultVoice?.id ?? caps.voices[0]?.id ?? 'alloy';\n  }\n}\n","/**\n * Base media provider with common functionality for Image, Audio, and Video providers\n * Provides circuit breaker, logging, and metrics similar to BaseTextProvider\n */\n\nimport { BaseProvider } from './BaseProvider.js';\nimport type { IProvider } from '../../../domain/interfaces/IProvider.js';\nimport { CircuitBreaker, DEFAULT_CIRCUIT_BREAKER_CONFIG } from '../../resilience/CircuitBreaker.js';\nimport { logger, FrameworkLogger } from '../../observability/Logger.js';\nimport { metrics } from '../../observability/Metrics.js';\n\n/**\n * Base class for all media providers (Image, Audio, Video)\n * Follows the same patterns as BaseTextProvider for consistency\n */\nexport abstract class BaseMediaProvider extends BaseProvider implements IProvider {\n  protected circuitBreaker?: CircuitBreaker;\n  protected logger: FrameworkLogger;\n  private _isObservabilityInitialized = false;\n\n  constructor(config: any) {\n    super(config);\n\n    // Initialize with default logger (will be updated with provider name on first use)\n    this.logger = logger.child({\n      component: 'MediaProvider',\n      provider: 'unknown',\n    });\n\n    // Circuit breaker created lazily on first use\n  }\n\n  /**\n   * Auto-initialize observability on first use (lazy initialization)\n   * This is called automatically by executeWithCircuitBreaker()\n   * @internal\n   */\n  private ensureObservabilityInitialized(): void {\n    if (this._isObservabilityInitialized) {\n      return;\n    }\n\n    const providerName = this.name || 'unknown';\n\n    // Create circuit breaker with provider name\n    const cbConfig = (this.config as any).circuitBreaker || DEFAULT_CIRCUIT_BREAKER_CONFIG;\n    this.circuitBreaker = new CircuitBreaker(\n      `media-provider:${providerName}`,\n      cbConfig\n    );\n\n    // Update logger with provider name\n    this.logger = logger.child({\n      component: 'MediaProvider',\n      provider: providerName,\n    });\n\n    // Forward circuit breaker events to metrics\n    this.circuitBreaker.on('opened', (data) => {\n      this.logger.warn(data, 'Circuit breaker opened');\n      metrics.increment('circuit_breaker.opened', 1, {\n        breaker: data.name,\n        provider: providerName,\n      });\n    });\n\n    this.circuitBreaker.on('closed', (data) => {\n      this.logger.info(data, 'Circuit breaker closed');\n      metrics.increment('circuit_breaker.closed', 1, {\n        breaker: data.name,\n        provider: providerName,\n      });\n    });\n\n    this._isObservabilityInitialized = true;\n  }\n\n  /**\n   * Execute operation with circuit breaker protection\n   * Automatically records metrics and handles errors\n   *\n   * @param operation - The async operation to execute\n   * @param operationName - Name of the operation for metrics (e.g., 'image.generate', 'audio.synthesize')\n   * @param metadata - Additional metadata to log/record\n   */\n  protected async executeWithCircuitBreaker<TResult>(\n    operation: () => Promise<TResult>,\n    operationName: string,\n    metadata?: Record<string, unknown>\n  ): Promise<TResult> {\n    // Auto-initialize observability on first use\n    this.ensureObservabilityInitialized();\n\n    const startTime = Date.now();\n    const metricLabels = {\n      provider: this.name,\n      operation: operationName,\n      ...metadata,\n    };\n\n    try {\n      // Execute through circuit breaker\n      const result = await this.circuitBreaker!.execute(operation);\n\n      // Record success metrics\n      const duration = Date.now() - startTime;\n      metrics.histogram(`${operationName}.duration`, duration, metricLabels);\n      metrics.increment(`${operationName}.success`, 1, metricLabels);\n\n      this.logger.debug(\n        { operation: operationName, duration, ...metadata },\n        'Operation completed successfully'\n      );\n\n      return result;\n    } catch (error) {\n      // Record error metrics\n      const duration = Date.now() - startTime;\n      metrics.increment(`${operationName}.error`, 1, {\n        ...metricLabels,\n        error: error instanceof Error ? error.name : 'unknown',\n      });\n\n      this.logger.error(\n        {\n          operation: operationName,\n          duration,\n          error: error instanceof Error ? error.message : String(error),\n          ...metadata,\n        },\n        'Operation failed'\n      );\n\n      throw error;\n    }\n  }\n\n  /**\n   * Log operation start with context\n   * Useful for logging before async operations\n   */\n  protected logOperationStart(operation: string, context: Record<string, unknown>): void {\n    this.ensureObservabilityInitialized();\n    this.logger.info({ operation, ...context }, `${operation} started`);\n  }\n\n  /**\n   * Log operation completion with context\n   */\n  protected logOperationComplete(operation: string, context: Record<string, unknown>): void {\n    this.ensureObservabilityInitialized();\n    this.logger.info({ operation, ...context }, `${operation} completed`);\n  }\n}\n","/**\n * Shared voice definitions and language constants\n * Eliminates duplication across TTS model registries\n */\n\n/**\n * Voice information structure\n * Used consistently across all TTS providers\n */\nexport interface IVoiceInfo {\n  id: string;\n  name: string;\n  language: string;\n  gender: 'male' | 'female' | 'neutral';\n  style?: string;\n  previewUrl?: string;\n  isDefault?: boolean;\n  accent?: string;\n  age?: 'child' | 'young' | 'adult' | 'senior';\n}\n\n// =============================================================================\n// Voice Definitions\n// =============================================================================\n\n/**\n * OpenAI TTS voices (shared across tts-1, tts-1-hd, gpt-4o-mini-tts)\n * Source: https://platform.openai.com/docs/guides/text-to-speech\n * Note: 'multi' language means the voice supports multiple languages\n * Last verified: 2026-01-24\n */\nexport const OPENAI_VOICES: IVoiceInfo[] = [\n  { id: 'alloy', name: 'Alloy', language: 'multi', gender: 'neutral', isDefault: true },\n  { id: 'ash', name: 'Ash', language: 'multi', gender: 'male' },\n  { id: 'ballad', name: 'Ballad', language: 'multi', gender: 'male' },\n  { id: 'coral', name: 'Coral', language: 'multi', gender: 'female' },\n  { id: 'echo', name: 'Echo', language: 'multi', gender: 'male' },\n  { id: 'fable', name: 'Fable', language: 'multi', gender: 'neutral', accent: 'british' },\n  { id: 'nova', name: 'Nova', language: 'multi', gender: 'female' },\n  { id: 'onyx', name: 'Onyx', language: 'multi', gender: 'male' },\n  { id: 'sage', name: 'Sage', language: 'multi', gender: 'female' },\n  { id: 'shimmer', name: 'Shimmer', language: 'multi', gender: 'female' },\n  { id: 'verse', name: 'Verse', language: 'multi', gender: 'neutral' },\n  { id: 'marin', name: 'Marin', language: 'multi', gender: 'female' },\n  { id: 'cedar', name: 'Cedar', language: 'multi', gender: 'male' },\n];\n\n/**\n * Google Gemini TTS voices (30 total)\n * Source: https://ai.google.dev/gemini-api/docs/speech-generation\n * Last verified: 2026-01-25\n */\nexport const GEMINI_VOICES: IVoiceInfo[] = [\n  // Default voice\n  { id: 'Kore', name: 'Kore', language: 'multi', gender: 'female', isDefault: true },\n  // Primary voices\n  { id: 'Puck', name: 'Puck', language: 'multi', gender: 'neutral' },\n  { id: 'Charon', name: 'Charon', language: 'multi', gender: 'male' },\n  { id: 'Fenrir', name: 'Fenrir', language: 'multi', gender: 'male' },\n  { id: 'Zephyr', name: 'Zephyr', language: 'multi', gender: 'neutral' },\n  { id: 'Leda', name: 'Leda', language: 'multi', gender: 'female' },\n  { id: 'Orus', name: 'Orus', language: 'multi', gender: 'male' },\n  { id: 'Aoede', name: 'Aoede', language: 'multi', gender: 'female' },\n  // Extended voices (celestial/astronomical naming)\n  { id: 'Callirrhoe', name: 'Callirrhoe', language: 'multi', gender: 'female' },\n  { id: 'Autonoe', name: 'Autonoe', language: 'multi', gender: 'female' },\n  { id: 'Enceladus', name: 'Enceladus', language: 'multi', gender: 'male' },\n  { id: 'Iapetus', name: 'Iapetus', language: 'multi', gender: 'male' },\n  { id: 'Umbriel', name: 'Umbriel', language: 'multi', gender: 'neutral' },\n  { id: 'Algieba', name: 'Algieba', language: 'multi', gender: 'male' },\n  { id: 'Despina', name: 'Despina', language: 'multi', gender: 'female' },\n  { id: 'Erinome', name: 'Erinome', language: 'multi', gender: 'female' },\n  { id: 'Algenib', name: 'Algenib', language: 'multi', gender: 'male' },\n  { id: 'Rasalgethi', name: 'Rasalgethi', language: 'multi', gender: 'male' },\n  { id: 'Laomedeia', name: 'Laomedeia', language: 'multi', gender: 'female' },\n  { id: 'Achernar', name: 'Achernar', language: 'multi', gender: 'male' },\n  { id: 'Alnilam', name: 'Alnilam', language: 'multi', gender: 'male' },\n  { id: 'Schedar', name: 'Schedar', language: 'multi', gender: 'female' },\n  { id: 'Gacrux', name: 'Gacrux', language: 'multi', gender: 'male' },\n  { id: 'Pulcherrima', name: 'Pulcherrima', language: 'multi', gender: 'female' },\n  { id: 'Achird', name: 'Achird', language: 'multi', gender: 'male' },\n  { id: 'Zubenelgenubi', name: 'Zubenelgenubi', language: 'multi', gender: 'male' },\n  { id: 'Vindemiatrix', name: 'Vindemiatrix', language: 'multi', gender: 'female' },\n  { id: 'Sadachbia', name: 'Sadachbia', language: 'multi', gender: 'male' },\n  { id: 'Sadaltager', name: 'Sadaltager', language: 'multi', gender: 'male' },\n  { id: 'Sulafat', name: 'Sulafat', language: 'multi', gender: 'female' },\n];\n\n/**\n * Google Gemini TTS supported languages (24)\n * Source: https://ai.google.dev/gemini-api/docs/speech-generation\n */\nexport const GEMINI_TTS_LANGUAGES = [\n  'ar-EG',  // Arabic (Egyptian)\n  'bn',     // Bengali\n  'de-DE',  // German (Germany)\n  'en-US',  // English (US)\n  'en-IN',  // English (India)\n  'es',     // Spanish\n  'fr-FR',  // French (France)\n  'hi',     // Hindi\n  'id',     // Indonesian\n  'it',     // Italian\n  'ja',     // Japanese\n  'ko',     // Korean\n  'mr',     // Marathi\n  'nl',     // Dutch\n  'pl',     // Polish\n  'pt-BR',  // Portuguese (Brazil)\n  'ro',     // Romanian\n  'ru',     // Russian\n  'ta',     // Tamil\n  'te',     // Telugu\n  'th',     // Thai\n  'tr',     // Turkish\n  'uk',     // Ukrainian\n  'vi',     // Vietnamese\n] as const;\n\n// =============================================================================\n// Language Constants\n// =============================================================================\n\n/**\n * Common language codes (ISO-639-1) supported by multiple vendors\n * Centralized to avoid duplication in model registries\n */\nexport const COMMON_LANGUAGES = {\n  /**\n   * Languages supported by OpenAI TTS models (50+)\n   * Source: https://platform.openai.com/docs/guides/text-to-speech\n   */\n  OPENAI_TTS: [\n    'en', 'es', 'fr', 'de', 'it', 'pt', 'pl', 'ru', 'ja', 'ko', 'zh', 'ar', 'hi',\n    'nl', 'sv', 'tr', 'af', 'hy', 'az', 'be', 'bs', 'bg', 'ca', 'hr', 'cs', 'da',\n    'et', 'fi', 'gl', 'el', 'he', 'hu', 'is', 'id', 'lv', 'lt', 'mk', 'ms', 'mi',\n    'ne', 'no', 'fa', 'ro', 'sr', 'sk', 'sl', 'sw', 'tl', 'ta', 'th', 'uk', 'ur',\n    'vi', 'cy',\n  ] as const,\n\n  /**\n   * Core languages supported by most vendors\n   */\n  CORE: ['en', 'es', 'fr', 'de', 'it', 'pt', 'ja', 'ko', 'zh', 'ru', 'ar', 'hi'] as const,\n\n  /**\n   * ElevenLabs supported languages\n   * Source: https://elevenlabs.io/docs\n   */\n  ELEVENLABS: [\n    'en', 'es', 'fr', 'de', 'it', 'pt', 'pl', 'ru', 'ja', 'ko', 'zh', 'ar', 'hi',\n    'nl', 'sv', 'tr', 'cs', 'da', 'fi', 'el', 'he', 'hu', 'id', 'ms', 'no', 'ro',\n    'sk', 'th', 'uk', 'vi',\n  ] as const,\n\n  /**\n   * AssemblyAI Universal model languages\n   * Source: https://www.assemblyai.com/docs\n   */\n  ASSEMBLYAI: [\n    'en', 'es', 'fr', 'de', 'it', 'pt', 'nl', 'ja', 'ko', 'zh',\n    'ru', 'ar', 'hi', 'pl', 'tr', 'uk', 'vi',\n  ] as const,\n} as const;\n\n// =============================================================================\n// Audio Format Constants\n// =============================================================================\n\n/**\n * Common audio formats by use case\n */\nexport const AUDIO_FORMATS = {\n  /**\n   * OpenAI TTS output formats\n   * Source: https://platform.openai.com/docs/guides/text-to-speech\n   */\n  OPENAI_TTS: ['mp3', 'opus', 'aac', 'flac', 'wav', 'pcm'] as const,\n\n  /**\n   * ElevenLabs output formats\n   */\n  ELEVENLABS: ['mp3', 'pcm', 'ogg', 'wav'] as const,\n\n  /**\n   * Google TTS output formats\n   */\n  GOOGLE_TTS: ['mp3', 'wav', 'ogg'] as const,\n\n  /**\n   * Common STT input formats (widely supported)\n   */\n  STT_INPUT: ['mp3', 'mp4', 'mpeg', 'mpga', 'm4a', 'wav', 'webm', 'flac', 'ogg'] as const,\n} as const;\n","/**\n * OpenAI Text-to-Speech provider\n * Supports: tts-1, tts-1-hd, gpt-4o-mini-tts\n */\n\nimport OpenAI from 'openai';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type { ITextToSpeechProvider, TTSOptions, TTSResponse } from '../../../domain/interfaces/IAudioProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { OpenAIMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport type { IVoiceInfo } from '../../../domain/entities/SharedVoices.js';\nimport { OPENAI_VOICES } from '../../../domain/entities/SharedVoices.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\nexport class OpenAITTSProvider extends BaseMediaProvider implements ITextToSpeechProvider {\n  readonly name: string = 'openai-tts';\n  readonly vendor = 'openai' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: false,\n    videos: false,\n    audio: true,\n    features: {\n      textToSpeech: true,\n    },\n  };\n\n  private client: OpenAI;\n\n  constructor(config: OpenAIMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.client = new OpenAI({\n      apiKey: config.auth.apiKey,\n      baseURL: config.baseURL,\n      organization: config.organization,\n      timeout: config.timeout ?? 60000,\n      maxRetries: config.maxRetries ?? 2,\n    });\n  }\n\n  /**\n   * Synthesize speech from text\n   */\n  async synthesize(options: TTSOptions): Promise<TTSResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          // Map semantic format to OpenAI format\n          const format = this.mapFormat(options.format);\n\n          // Build request parameters\n          const requestParams: OpenAI.Audio.SpeechCreateParams = {\n            model: options.model,\n            input: options.input,\n            voice: options.voice as OpenAI.Audio.SpeechCreateParams['voice'],\n            response_format: format,\n            speed: options.speed,\n          };\n\n          // Add instruction steering if available (gpt-4o-mini-tts)\n          if (options.vendorOptions?.instructions) {\n            (requestParams as any).instructions = options.vendorOptions.instructions;\n          }\n\n          this.logOperationStart('tts.synthesize', {\n            model: options.model,\n            voice: options.voice,\n            inputLength: options.input.length,\n          });\n\n          const response = await this.client.audio.speech.create(requestParams);\n\n          // Convert response to Buffer\n          const arrayBuffer = await response.arrayBuffer();\n          const audio = Buffer.from(arrayBuffer);\n\n          this.logOperationComplete('tts.synthesize', {\n            model: options.model,\n            audioSize: audio.length,\n          });\n\n          return {\n            audio,\n            format: options.format || 'mp3',\n            charactersUsed: options.input.length,\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error; // TypeScript needs this\n        }\n      },\n      'tts.synthesize',\n      { model: options.model, voice: options.voice }\n    );\n  }\n\n  /**\n   * List available voices (returns static list for OpenAI)\n   */\n  async listVoices(): Promise<IVoiceInfo[]> {\n    return OPENAI_VOICES;\n  }\n\n  /**\n   * Map semantic audio format to OpenAI format\n   */\n  private mapFormat(\n    format?: string\n  ): OpenAI.Audio.SpeechCreateParams['response_format'] {\n    switch (format) {\n      case 'mp3':\n        return 'mp3';\n      case 'opus':\n        return 'opus';\n      case 'aac':\n        return 'aac';\n      case 'flac':\n        return 'flac';\n      case 'wav':\n        return 'wav';\n      case 'pcm':\n        return 'pcm';\n      default:\n        return 'mp3';\n    }\n  }\n\n  /**\n   * Handle OpenAI API errors\n   */\n  private handleError(error: any): never {\n    if (error instanceof OpenAI.APIError) {\n      const status = error.status;\n      const message = error.message || 'Unknown OpenAI API error';\n\n      if (status === 401) {\n        throw new ProviderAuthError('openai', 'Invalid API key');\n      }\n\n      if (status === 429) {\n        throw new ProviderRateLimitError('openai');\n      }\n\n      if (status === 400) {\n        throw new ProviderError('openai', `Bad request: ${message}`);\n      }\n\n      throw new ProviderError('openai', message);\n    }\n\n    throw error;\n  }\n}\n","/**\n * OpenAI Speech-to-Text provider\n * Supports: whisper-1, gpt-4o-transcribe, gpt-4o-transcribe-diarize\n */\n\nimport OpenAI from 'openai';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type { ISpeechToTextProvider, STTOptions, STTResponse, STTOutputFormat } from '../../../domain/interfaces/IAudioProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { OpenAIMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\nimport * as fs from 'fs';\n\nexport class OpenAISTTProvider extends BaseMediaProvider implements ISpeechToTextProvider {\n  readonly name: string = 'openai-stt';\n  readonly vendor = 'openai' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: false,\n    videos: false,\n    audio: true,\n    features: {\n      speechToText: true,\n    },\n  };\n\n  private client: OpenAI;\n\n  constructor(config: OpenAIMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.client = new OpenAI({\n      apiKey: config.auth.apiKey,\n      baseURL: config.baseURL,\n      organization: config.organization,\n      timeout: config.timeout ?? 120000, // 2 minutes for audio processing\n      maxRetries: config.maxRetries ?? 2,\n    });\n  }\n\n  /**\n   * Transcribe audio to text\n   */\n  async transcribe(options: STTOptions): Promise<STTResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('stt.transcribe', {\n            model: options.model,\n            language: options.language,\n            format: options.outputFormat,\n          });\n\n          // Prepare audio file\n          const audioFile = await this.prepareAudioFile(options.audio);\n\n          // Build request parameters\n          const requestParams: Partial<OpenAI.Audio.TranscriptionCreateParams> = {\n            model: options.model,\n            file: audioFile,\n            language: options.language,\n            prompt: options.prompt,\n            temperature: options.temperature,\n          };\n\n          // Map output format\n          if (options.outputFormat) {\n            requestParams.response_format = this.mapOutputFormat(options.outputFormat);\n          } else if (options.includeTimestamps) {\n            requestParams.response_format = 'verbose_json';\n          }\n\n          // Add timestamp granularity if needed\n          if (options.includeTimestamps && options.timestampGranularity) {\n            requestParams.timestamp_granularities = [options.timestampGranularity];\n          }\n\n          // Add diarization options if using diarize model\n          if (options.model.includes('diarize') && options.vendorOptions?.max_speakers) {\n            (requestParams as any).max_speakers = options.vendorOptions.max_speakers;\n          }\n\n          const response: any = await this.client.audio.transcriptions.create(\n            requestParams as any\n          );\n\n          this.logOperationComplete('stt.transcribe', {\n            model: options.model,\n            textLength: typeof response === 'string' ? response.length : response.text?.length || 0,\n          });\n\n          return this.convertResponse(response);\n        } catch (error: any) {\n          this.handleError(error);\n          throw error; // TypeScript needs this\n        }\n      },\n      'stt.transcribe',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Translate audio to English text\n   */\n  async translate(options: STTOptions): Promise<STTResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('stt.translate', {\n            model: options.model,\n          });\n\n          const audioFile = await this.prepareAudioFile(options.audio);\n\n          const requestParams: Partial<OpenAI.Audio.TranslationCreateParams> = {\n            model: options.model,\n            file: audioFile,\n            prompt: options.prompt,\n            temperature: options.temperature,\n          };\n\n          if (options.outputFormat) {\n            // Translation API has more restricted response_format options\n            requestParams.response_format = this.mapOutputFormat(options.outputFormat) as\n              | 'text'\n              | 'json'\n              | 'srt'\n              | 'vtt'\n              | 'verbose_json';\n          }\n\n          const response: any = await this.client.audio.translations.create(\n            requestParams as any\n          );\n\n          this.logOperationComplete('stt.translate', {\n            model: options.model,\n            textLength: typeof response === 'string' ? response.length : response.text?.length || 0,\n          });\n\n          return this.convertResponse(response);\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'stt.translate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Prepare audio file for API request\n   * Handles both Buffer and file path inputs\n   */\n  private async prepareAudioFile(audio: Buffer | string): Promise<any> {\n    if (Buffer.isBuffer(audio)) {\n      // Convert Buffer to File-like object that OpenAI SDK expects\n      return new File([new Uint8Array(audio)], 'audio.wav', { type: 'audio/wav' });\n    } else if (typeof audio === 'string') {\n      // File path - create ReadStream\n      return fs.createReadStream(audio);\n    } else {\n      throw new Error('Invalid audio input: must be Buffer or file path');\n    }\n  }\n\n  /**\n   * Map semantic output format to OpenAI format\n   */\n  private mapOutputFormat(format: STTOutputFormat): OpenAI.Audio.AudioResponseFormat {\n    switch (format) {\n      case 'json':\n        return 'json';\n      case 'text':\n        return 'text';\n      case 'srt':\n        return 'srt';\n      case 'vtt':\n        return 'vtt';\n      case 'verbose_json':\n        return 'verbose_json';\n      default:\n        return 'json';\n    }\n  }\n\n  /**\n   * Convert OpenAI response to our standard format\n   */\n  private convertResponse(response: OpenAI.Audio.Transcription | string): STTResponse {\n    // Handle simple string response\n    if (typeof response === 'string') {\n      return { text: response };\n    }\n\n    // Cast to access extended properties\n    const extResponse = response as any;\n\n    // Handle JSON response\n    const result: STTResponse = {\n      text: response.text,\n      language: extResponse.language,\n      durationSeconds: extResponse.duration,\n    };\n\n    // Add word timestamps if available\n    if ((response as any).words) {\n      result.words = (response as any).words.map((w: any) => ({\n        word: w.word,\n        start: w.start,\n        end: w.end,\n      }));\n    }\n\n    // Add segment timestamps if available\n    if ((response as any).segments) {\n      result.segments = (response as any).segments.map((s: any) => ({\n        id: s.id,\n        text: s.text,\n        start: s.start,\n        end: s.end,\n        tokens: s.tokens,\n      }));\n    }\n\n    return result;\n  }\n\n  /**\n   * Handle OpenAI API errors\n   */\n  private handleError(error: any): never {\n    if (error instanceof OpenAI.APIError) {\n      const status = error.status;\n      const message = error.message || 'Unknown OpenAI API error';\n\n      if (status === 401) {\n        throw new ProviderAuthError('openai', 'Invalid API key');\n      }\n\n      if (status === 429) {\n        throw new ProviderRateLimitError('openai');\n      }\n\n      if (status === 400) {\n        throw new ProviderError('openai', `Bad request: ${message}`);\n      }\n\n      if (status === 413) {\n        throw new ProviderError('openai', 'Audio file too large (max 25MB)');\n      }\n\n      throw new ProviderError('openai', message);\n    }\n\n    throw error;\n  }\n}\n","/**\n * Google Gemini Text-to-Speech provider\n * Supports: gemini-2.5-flash-preview-tts, gemini-2.5-pro-preview-tts\n */\n\nimport { GoogleGenAI } from '@google/genai';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type { ITextToSpeechProvider, TTSOptions, TTSResponse } from '../../../domain/interfaces/IAudioProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { GoogleConfig } from '../../../domain/types/ProviderConfig.js';\nimport type { IVoiceInfo } from '../../../domain/entities/SharedVoices.js';\nimport { GEMINI_VOICES } from '../../../domain/entities/SharedVoices.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\nexport class GoogleTTSProvider extends BaseMediaProvider implements ITextToSpeechProvider {\n  readonly name: string = 'google-tts';\n  readonly vendor = 'google' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: false,\n    videos: false,\n    audio: true,\n    features: {\n      textToSpeech: true,\n    },\n  };\n\n  private client: GoogleGenAI;\n\n  constructor(config: GoogleConfig) {\n    super(config);\n\n    this.client = new GoogleGenAI({\n      apiKey: config.apiKey,\n    });\n  }\n\n  /**\n   * Synthesize speech from text using Gemini TTS\n   */\n  async synthesize(options: TTSOptions): Promise<TTSResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('tts.synthesize', {\n            model: options.model,\n            voice: options.voice,\n            inputLength: options.input.length,\n          });\n\n          // Build the request with speech config\n          const result = await this.client.models.generateContent({\n            model: options.model,\n            contents: [\n              {\n                parts: [{ text: options.input }],\n              },\n            ],\n            config: {\n              responseModalities: ['AUDIO'],\n              speechConfig: {\n                voiceConfig: {\n                  prebuiltVoiceConfig: {\n                    voiceName: options.voice || 'Kore',\n                  },\n                },\n              },\n            },\n          });\n\n          // Extract audio data from response\n          const audioData = this.extractAudioData(result);\n\n          if (!audioData) {\n            throw new ProviderError('google', 'No audio data in response');\n          }\n\n          this.logOperationComplete('tts.synthesize', {\n            model: options.model,\n            audioSize: audioData.length,\n          });\n\n          return {\n            audio: audioData,\n            format: 'wav', // Gemini outputs PCM 24kHz 16-bit, we convert to WAV\n            charactersUsed: options.input.length,\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error; // TypeScript needs this\n        }\n      },\n      'tts.synthesize',\n      { model: options.model, voice: options.voice }\n    );\n  }\n\n  /**\n   * List available voices (returns static list for Google)\n   */\n  async listVoices(): Promise<IVoiceInfo[]> {\n    return GEMINI_VOICES;\n  }\n\n  /**\n   * Extract audio data from Gemini response\n   * Gemini returns raw PCM data (24kHz, 16-bit, mono), we wrap it in WAV format\n   */\n  private extractAudioData(result: any): Buffer | null {\n    const candidates = result.candidates;\n    if (!candidates || candidates.length === 0) {\n      return null;\n    }\n\n    const content = candidates[0]?.content;\n    if (!content?.parts || content.parts.length === 0) {\n      return null;\n    }\n\n    // Find the audio part\n    for (const part of content.parts) {\n      if (part.inlineData?.data) {\n        // Decode base64 audio data\n        const rawPcm = Buffer.from(part.inlineData.data, 'base64');\n\n        // Wrap PCM in WAV format\n        return this.pcmToWav(rawPcm, 24000, 1, 16);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Convert raw PCM data to WAV format\n   * @param pcmData - Raw PCM data buffer\n   * @param sampleRate - Sample rate in Hz (default 24000 for Gemini)\n   * @param channels - Number of channels (default 1 for mono)\n   * @param bitsPerSample - Bits per sample (default 16)\n   */\n  private pcmToWav(\n    pcmData: Buffer,\n    sampleRate: number = 24000,\n    channels: number = 1,\n    bitsPerSample: number = 16\n  ): Buffer {\n    const byteRate = (sampleRate * channels * bitsPerSample) / 8;\n    const blockAlign = (channels * bitsPerSample) / 8;\n    const dataSize = pcmData.length;\n    const headerSize = 44;\n    const fileSize = headerSize + dataSize;\n\n    const header = Buffer.alloc(headerSize);\n\n    // RIFF header\n    header.write('RIFF', 0);\n    header.writeUInt32LE(fileSize - 8, 4); // File size - 8\n    header.write('WAVE', 8);\n\n    // fmt sub-chunk\n    header.write('fmt ', 12);\n    header.writeUInt32LE(16, 16); // Sub-chunk size (16 for PCM)\n    header.writeUInt16LE(1, 20); // Audio format (1 = PCM)\n    header.writeUInt16LE(channels, 22); // Number of channels\n    header.writeUInt32LE(sampleRate, 24); // Sample rate\n    header.writeUInt32LE(byteRate, 28); // Byte rate\n    header.writeUInt16LE(blockAlign, 32); // Block align\n    header.writeUInt16LE(bitsPerSample, 34); // Bits per sample\n\n    // data sub-chunk\n    header.write('data', 36);\n    header.writeUInt32LE(dataSize, 40); // Data size\n\n    return Buffer.concat([header, pcmData]);\n  }\n\n  /**\n   * Handle Google API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown Google API error';\n    const status = error.status || error.code;\n\n    if (status === 401 || message.includes('API key not valid')) {\n      throw new ProviderAuthError('google', 'Invalid API key');\n    }\n\n    if (status === 429 || message.includes('Resource exhausted')) {\n      throw new ProviderRateLimitError('google', message);\n    }\n\n    if (status === 400) {\n      throw new ProviderError('google', `Bad request: ${message}`);\n    }\n\n    throw new ProviderError('google', message);\n  }\n}\n","/**\n * Factory functions for creating audio providers (TTS and STT)\n */\n\nimport { Connector } from './Connector.js';\nimport type { ITextToSpeechProvider } from '../domain/interfaces/IAudioProvider.js';\nimport type { ISpeechToTextProvider } from '../domain/interfaces/IAudioProvider.js';\nimport { Vendor } from './Vendor.js';\nimport { OpenAITTSProvider } from '../infrastructure/providers/openai/OpenAITTSProvider.js';\nimport { OpenAISTTProvider } from '../infrastructure/providers/openai/OpenAISTTProvider.js';\nimport { GoogleTTSProvider } from '../infrastructure/providers/google/GoogleTTSProvider.js';\nimport type { OpenAIMediaConfig, GoogleConfig } from '../domain/types/ProviderConfig.js';\n\n/**\n * Create a Text-to-Speech provider from a connector\n */\nexport function createTTSProvider(connector: Connector): ITextToSpeechProvider {\n  const vendor = connector.vendor;\n\n  switch (vendor) {\n    case Vendor.OpenAI:\n      return new OpenAITTSProvider(extractOpenAIConfig(connector));\n\n    case Vendor.Google:\n      return new GoogleTTSProvider(extractGoogleConfig(connector));\n\n    default:\n      throw new Error(\n        `No TTS provider available for vendor: ${vendor}. ` +\n        `Supported vendors: ${Vendor.OpenAI}, ${Vendor.Google}`\n      );\n  }\n}\n\n/**\n * Create a Speech-to-Text provider from a connector\n */\nexport function createSTTProvider(connector: Connector): ISpeechToTextProvider {\n  const vendor = connector.vendor;\n\n  switch (vendor) {\n    case Vendor.OpenAI:\n      return new OpenAISTTProvider(extractOpenAIConfig(connector));\n\n    case Vendor.Groq:\n      // TODO: Implement GroqSTTProvider (Whisper on Groq)\n      throw new Error(`Groq STT provider not yet implemented`);\n\n    case Vendor.Google:\n      // TODO: Implement GoogleSTTProvider\n      throw new Error(`Google STT provider not yet implemented`);\n\n    default:\n      throw new Error(\n        `No STT provider available for vendor: ${vendor}. ` +\n        `Supported vendors: ${Vendor.OpenAI}, ${Vendor.Groq}`\n      );\n  }\n}\n\n/**\n * Extract OpenAI configuration from connector\n */\nfunction extractOpenAIConfig(connector: Connector): OpenAIMediaConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('OpenAI requires API key authentication');\n  }\n\n  const options = connector.getOptions();\n\n  return {\n    auth: {\n      type: 'api_key',\n      apiKey: auth.apiKey,\n    },\n    baseURL: connector.baseURL,\n    organization: options.organization as string | undefined,\n    timeout: options.timeout as number | undefined,\n    maxRetries: options.maxRetries as number | undefined,\n  };\n}\n\n/**\n * Extract Google configuration from connector\n */\nfunction extractGoogleConfig(connector: Connector): GoogleConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('Google requires API key authentication');\n  }\n\n  return {\n    apiKey: auth.apiKey,\n  };\n}\n","/**\n * Generic utilities for model registries\n * Eliminates code duplication across Image, TTS, STT, and Video registries\n */\n\nimport type { Vendor as VendorType } from '../../core/Vendor.js';\nimport type { IBaseModelDescription } from '../types/SharedTypes.js';\n\n/**\n * Creates standard helper functions for any model registry\n * This eliminates the need to write the same helper functions for each registry\n *\n * @example\n * ```typescript\n * const helpers = createRegistryHelpers(IMAGE_MODEL_REGISTRY);\n * export const getImageModelInfo = helpers.getInfo;\n * export const getImageModelsByVendor = helpers.getByVendor;\n * export const getActiveImageModels = helpers.getActive;\n * ```\n */\nexport function createRegistryHelpers<T extends IBaseModelDescription>(\n  registry: Record<string, T>\n) {\n  return {\n    /**\n     * Get model information by name\n     */\n    getInfo: (modelName: string): T | undefined => {\n      return registry[modelName];\n    },\n\n    /**\n     * Get all active models for a specific vendor\n     */\n    getByVendor: (vendor: VendorType): T[] => {\n      return Object.values(registry).filter(\n        (model) => model.provider === vendor && model.isActive\n      );\n    },\n\n    /**\n     * Get all currently active models (across all vendors)\n     */\n    getActive: (): T[] => {\n      return Object.values(registry).filter((model) => model.isActive);\n    },\n\n    /**\n     * Get all models (including inactive/deprecated)\n     */\n    getAll: (): T[] => {\n      return Object.values(registry);\n    },\n\n    /**\n     * Check if model exists in registry\n     */\n    has: (modelName: string): boolean => {\n      return modelName in registry;\n    },\n  };\n}\n\n/**\n * Creates feature-based filter for registries with capabilities\n * Used to find models that support specific features\n *\n * @example\n * ```typescript\n * const filter = createCapabilityFilter(IMAGE_MODEL_REGISTRY);\n * const modelsWithInpainting = filter.withFeature('inputModes').filter(\n *   m => m.capabilities.inputModes.inpainting\n * );\n * ```\n */\nexport function createCapabilityFilter<\n  T extends IBaseModelDescription & { capabilities: Record<string, unknown> }\n>(registry: Record<string, T>) {\n  return {\n    /**\n     * Get models that have a specific capability feature\n     * @param feature - The capability feature to filter by\n     * @param value - Optional specific value to match (if undefined, just checks truthy)\n     */\n    withFeature: <K extends keyof T['capabilities']>(\n      feature: K,\n      value?: T['capabilities'][K]\n    ): T[] => {\n      return Object.values(registry).filter((model) => {\n        if (!model.isActive) return false;\n\n        const capValue = (model.capabilities as Record<string, unknown>)[feature as string];\n\n        // If specific value provided, match exactly\n        if (value !== undefined) {\n          return capValue === value;\n        }\n\n        // Otherwise check if feature exists and is truthy\n        return Array.isArray(capValue) ? capValue.length > 0 : Boolean(capValue);\n      });\n    },\n  };\n}\n","/**\n * Text-to-Speech model registry with comprehensive metadata\n */\n\nimport { Vendor } from '../../core/Vendor.js';\nimport type { IBaseModelDescription, AudioFormat, VendorOptionSchema } from '../types/SharedTypes.js';\nimport { createRegistryHelpers } from './RegistryUtils.js';\nimport { OPENAI_VOICES, GEMINI_VOICES, GEMINI_TTS_LANGUAGES, COMMON_LANGUAGES, AUDIO_FORMATS, type IVoiceInfo } from './SharedVoices.js';\n\n// Re-export IVoiceInfo for public API\nexport type { IVoiceInfo } from './SharedVoices.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * TTS model capabilities\n */\nexport interface TTSModelCapabilities {\n  /** Available voices (empty array means fetch dynamically via API) */\n  voices: IVoiceInfo[];\n\n  /** Supported output formats */\n  formats: readonly AudioFormat[] | AudioFormat[];\n\n  /** Supported languages (ISO-639-1 codes) */\n  languages: readonly string[] | string[];\n\n  /** Speed control support */\n  speed: {\n    supported: boolean;\n    min?: number;\n    max?: number;\n    default?: number;\n  };\n\n  /** Feature support flags */\n  features: {\n    /** Real-time streaming support */\n    streaming: boolean;\n    /** SSML markup support */\n    ssml: boolean;\n    /** Emotion/style control */\n    emotions: boolean;\n    /** Custom voice cloning */\n    voiceCloning: boolean;\n    /** Word-level timestamps */\n    wordTimestamps: boolean;\n    /** Instruction steering (prompt-based style control) */\n    instructionSteering?: boolean;\n  };\n\n  /** Model limits */\n  limits: {\n    /** Maximum input length in characters */\n    maxInputLength: number;\n    /** Rate limit (requests per minute) */\n    maxRequestsPerMinute?: number;\n  };\n\n  /** Vendor-specific options schema */\n  vendorOptions?: Record<string, VendorOptionSchema>;\n}\n\n/**\n * TTS model pricing\n */\nexport interface TTSModelPricing {\n  /** Cost per 1,000 characters */\n  per1kCharacters: number;\n  currency: 'USD';\n}\n\n/**\n * Complete TTS model description\n */\nexport interface ITTSModelDescription extends IBaseModelDescription {\n  capabilities: TTSModelCapabilities;\n  pricing?: TTSModelPricing;\n}\n\n// =============================================================================\n// Model Constants\n// =============================================================================\n\nexport const TTS_MODELS = {\n  [Vendor.OpenAI]: {\n    /** NEW: Instruction-steerable TTS with emotional control */\n    GPT_4O_MINI_TTS: 'gpt-4o-mini-tts',\n    /** Fast, low-latency TTS */\n    TTS_1: 'tts-1',\n    /** High-definition TTS */\n    TTS_1_HD: 'tts-1-hd',\n  },\n  [Vendor.Google]: {\n    /** Gemini 2.5 Flash TTS (optimized for low latency) */\n    GEMINI_2_5_FLASH_TTS: 'gemini-2.5-flash-preview-tts',\n    /** Gemini 2.5 Pro TTS (optimized for quality) */\n    GEMINI_2_5_PRO_TTS: 'gemini-2.5-pro-preview-tts',\n  },\n} as const;\n\n// =============================================================================\n// Shared Capability Presets (DRY)\n// =============================================================================\n\n/**\n * Base OpenAI TTS capabilities (shared across models)\n */\nconst OPENAI_TTS_BASE: Omit<TTSModelCapabilities, 'features' | 'limits'> = {\n  voices: OPENAI_VOICES,\n  formats: AUDIO_FORMATS.OPENAI_TTS,\n  languages: COMMON_LANGUAGES.OPENAI_TTS,\n  speed: { supported: true, min: 0.25, max: 4.0, default: 1.0 },\n};\n\n// =============================================================================\n// Registry\n// =============================================================================\n\n/**\n * Complete TTS model registry\n * Last full audit: January 2026\n */\nexport const TTS_MODEL_REGISTRY: Record<string, ITTSModelDescription> = {\n  // ======================== OpenAI ========================\n\n  'gpt-4o-mini-tts': {\n    name: 'gpt-4o-mini-tts',\n    displayName: 'GPT-4o Mini TTS',\n    provider: Vendor.OpenAI,\n    description: 'Instruction-steerable TTS with emotional control via prompts',\n    isActive: true,\n    releaseDate: '2025-03-01',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/text-to-speech',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...OPENAI_TTS_BASE,\n      features: {\n        streaming: false, // Not implementing streaming in v1\n        ssml: false,\n        emotions: true, // Via instruction steering\n        voiceCloning: true,\n        wordTimestamps: false,\n        instructionSteering: true,\n      },\n      limits: { maxInputLength: 2000 },\n      vendorOptions: {\n        instructions: {\n          type: 'string',\n          description: 'Natural language instructions for voice style (e.g., \"speak like a calm meditation guide\")',\n        },\n      },\n    },\n    pricing: { per1kCharacters: 0.015, currency: 'USD' },\n  },\n\n  'tts-1': {\n    name: 'tts-1',\n    displayName: 'TTS-1',\n    provider: Vendor.OpenAI,\n    description: 'Fast, low-latency text-to-speech optimized for real-time use',\n    isActive: true,\n    releaseDate: '2023-11-06',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/text-to-speech',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...OPENAI_TTS_BASE,\n      features: {\n        streaming: false, // Not implementing streaming in v1\n        ssml: false,\n        emotions: false,\n        voiceCloning: false,\n        wordTimestamps: false,\n      },\n      limits: { maxInputLength: 4096 },\n    },\n    pricing: { per1kCharacters: 0.015, currency: 'USD' },\n  },\n\n  'tts-1-hd': {\n    name: 'tts-1-hd',\n    displayName: 'TTS-1 HD',\n    provider: Vendor.OpenAI,\n    description: 'High-definition text-to-speech with improved audio quality',\n    isActive: true,\n    releaseDate: '2023-11-06',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/text-to-speech',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...OPENAI_TTS_BASE,\n      features: {\n        streaming: false, // Not implementing streaming in v1\n        ssml: false,\n        emotions: false,\n        voiceCloning: false,\n        wordTimestamps: false,\n      },\n      limits: { maxInputLength: 4096 },\n    },\n    pricing: { per1kCharacters: 0.030, currency: 'USD' },\n  },\n\n  // ======================== Google ========================\n\n  'gemini-2.5-flash-preview-tts': {\n    name: 'gemini-2.5-flash-preview-tts',\n    displayName: 'Gemini 2.5 Flash TTS',\n    provider: Vendor.Google,\n    description: 'Google Gemini 2.5 Flash TTS - optimized for low latency',\n    isActive: true,\n    releaseDate: '2025-01-01',\n    sources: {\n      documentation: 'https://ai.google.dev/gemini-api/docs/speech-generation',\n      pricing: 'https://ai.google.dev/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      voices: GEMINI_VOICES,\n      formats: ['wav'] as const, // PCM output, 24kHz 16-bit mono\n      languages: [...GEMINI_TTS_LANGUAGES],\n      speed: { supported: false }, // Speed not directly configurable\n      features: {\n        streaming: false, // Not implementing streaming in v1\n        ssml: false,\n        emotions: true, // Supports affective dialogue\n        voiceCloning: false,\n        wordTimestamps: false,\n      },\n      limits: { maxInputLength: 32000 }, // 32k tokens\n    },\n  },\n\n  'gemini-2.5-pro-preview-tts': {\n    name: 'gemini-2.5-pro-preview-tts',\n    displayName: 'Gemini 2.5 Pro TTS',\n    provider: Vendor.Google,\n    description: 'Google Gemini 2.5 Pro TTS - optimized for quality',\n    isActive: true,\n    releaseDate: '2025-01-01',\n    sources: {\n      documentation: 'https://ai.google.dev/gemini-api/docs/speech-generation',\n      pricing: 'https://ai.google.dev/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      voices: GEMINI_VOICES,\n      formats: ['wav'] as const, // PCM output, 24kHz 16-bit mono\n      languages: [...GEMINI_TTS_LANGUAGES],\n      speed: { supported: false }, // Speed not directly configurable\n      features: {\n        streaming: false, // Not implementing streaming in v1\n        ssml: false,\n        emotions: true, // Supports affective dialogue\n        voiceCloning: false,\n        wordTimestamps: false,\n      },\n      limits: { maxInputLength: 32000 }, // 32k tokens\n    },\n  },\n};\n\n// =============================================================================\n// Helper Functions (using shared utilities)\n// =============================================================================\n\nconst helpers = createRegistryHelpers(TTS_MODEL_REGISTRY);\n\nexport const getTTSModelInfo = helpers.getInfo;\nexport const getTTSModelsByVendor = helpers.getByVendor;\nexport const getActiveTTSModels = helpers.getActive;\n\n/**\n * Get TTS models that support a specific feature\n */\nexport function getTTSModelsWithFeature(\n  feature: keyof ITTSModelDescription['capabilities']['features']\n): ITTSModelDescription[] {\n  return Object.values(TTS_MODEL_REGISTRY).filter(\n    (model) => model.isActive && model.capabilities.features[feature]\n  );\n}\n\n/**\n * Calculate estimated cost for TTS\n */\nexport function calculateTTSCost(modelName: string, characterCount: number): number | null {\n  const model = getTTSModelInfo(modelName);\n  if (!model?.pricing) return null;\n  return (characterCount / 1000) * model.pricing.per1kCharacters;\n}\n","/**\n * SpeechToText capability class\n * Provides high-level API for speech-to-text transcription\n */\n\nimport { Connector } from './Connector.js';\nimport { createSTTProvider } from './createAudioProvider.js';\nimport type { ISpeechToTextProvider, STTOptions, STTResponse } from '../domain/interfaces/IAudioProvider.js';\nimport { getSTTModelInfo, getSTTModelsByVendor, type ISTTModelDescription } from '../domain/entities/STTModel.js';\nimport * as fs from 'fs/promises';\n\n/**\n * Configuration for SpeechToText capability\n */\nexport interface SpeechToTextConfig {\n  /** Connector name or instance */\n  connector: string | Connector;\n\n  /** Default model to use */\n  model?: string;\n\n  /** Default language (ISO-639-1 code) */\n  language?: string;\n\n  /** Default temperature for sampling */\n  temperature?: number;\n}\n\n/**\n * SpeechToText capability class\n * Provides speech-to-text transcription with model introspection\n *\n * @example\n * ```typescript\n * const stt = SpeechToText.create({\n *   connector: 'openai',\n *   model: 'whisper-1',\n * });\n *\n * const result = await stt.transcribe(audioBuffer);\n * console.log(result.text);\n *\n * const detailed = await stt.transcribeWithTimestamps(audioBuffer, 'word');\n * console.log(detailed.words);\n * ```\n */\nexport class SpeechToText {\n  private provider: ISpeechToTextProvider;\n  private config: SpeechToTextConfig;\n\n  /**\n   * Create a new SpeechToText instance\n   */\n  static create(config: SpeechToTextConfig): SpeechToText {\n    return new SpeechToText(config);\n  }\n\n  private constructor(config: SpeechToTextConfig) {\n    const connector = typeof config.connector === 'string'\n      ? Connector.get(config.connector)\n      : config.connector;\n\n    this.provider = createSTTProvider(connector);\n    this.config = config;\n  }\n\n  // ======================== Transcription Methods ========================\n\n  /**\n   * Transcribe audio to text\n   *\n   * @param audio - Audio data as Buffer or file path\n   * @param options - Optional transcription parameters\n   * @returns Transcription result with text and metadata\n   */\n  async transcribe(\n    audio: Buffer | string,\n    options?: Partial<Omit<STTOptions, 'model' | 'audio'>>\n  ): Promise<STTResponse> {\n    const fullOptions: STTOptions = {\n      model: this.config.model ?? this.getDefaultModel(),\n      audio,\n      language: options?.language ?? this.config.language,\n      outputFormat: options?.outputFormat,\n      includeTimestamps: options?.includeTimestamps,\n      timestampGranularity: options?.timestampGranularity,\n      prompt: options?.prompt,\n      temperature: options?.temperature ?? this.config.temperature,\n      vendorOptions: options?.vendorOptions,\n    };\n\n    return this.provider.transcribe(fullOptions);\n  }\n\n  /**\n   * Transcribe audio file by path\n   *\n   * @param filePath - Path to audio file\n   * @param options - Optional transcription parameters\n   */\n  async transcribeFile(\n    filePath: string,\n    options?: Partial<Omit<STTOptions, 'model' | 'audio'>>\n  ): Promise<STTResponse> {\n    const audio = await fs.readFile(filePath);\n    return this.transcribe(audio, options);\n  }\n\n  /**\n   * Transcribe audio with word or segment timestamps\n   *\n   * @param audio - Audio data as Buffer or file path\n   * @param granularity - Timestamp granularity ('word' or 'segment')\n   * @param options - Optional transcription parameters\n   */\n  async transcribeWithTimestamps(\n    audio: Buffer | string,\n    granularity: 'word' | 'segment' = 'segment',\n    options?: Partial<Omit<STTOptions, 'model' | 'audio' | 'includeTimestamps' | 'timestampGranularity'>>\n  ): Promise<STTResponse> {\n    return this.transcribe(audio, {\n      ...options,\n      outputFormat: 'verbose_json',\n      includeTimestamps: true,\n      timestampGranularity: granularity,\n    });\n  }\n\n  /**\n   * Translate audio to English text\n   * Note: Only supported by some models (e.g., Whisper)\n   *\n   * @param audio - Audio data as Buffer or file path\n   * @param options - Optional transcription parameters\n   */\n  async translate(\n    audio: Buffer | string,\n    options?: Partial<Omit<STTOptions, 'model' | 'audio'>>\n  ): Promise<STTResponse> {\n    if (!this.provider.translate) {\n      throw new Error('Translation not supported by this provider');\n    }\n\n    const fullOptions: STTOptions = {\n      model: this.config.model ?? this.getDefaultModel(),\n      audio,\n      outputFormat: options?.outputFormat,\n      prompt: options?.prompt,\n      temperature: options?.temperature ?? this.config.temperature,\n      vendorOptions: options?.vendorOptions,\n    };\n\n    return this.provider.translate(fullOptions);\n  }\n\n  // ======================== Introspection Methods ========================\n\n  /**\n   * Get model information for current or specified model\n   */\n  getModelInfo(model?: string): ISTTModelDescription {\n    const targetModel = model ?? this.config.model ?? this.getDefaultModel();\n    const info = getSTTModelInfo(targetModel);\n\n    if (!info) {\n      throw new Error(`Unknown STT model: ${targetModel}`);\n    }\n\n    return info;\n  }\n\n  /**\n   * Get model capabilities\n   */\n  getModelCapabilities(model?: string) {\n    return this.getModelInfo(model).capabilities;\n  }\n\n  /**\n   * List all available models for this provider's vendor\n   */\n  listAvailableModels(): ISTTModelDescription[] {\n    const vendor = this.provider.vendor;\n    if (!vendor) {\n      return [];\n    }\n    return getSTTModelsByVendor(vendor as any);\n  }\n\n  /**\n   * Check if a specific feature is supported by the model\n   */\n  supportsFeature(\n    feature: keyof ISTTModelDescription['capabilities']['features'],\n    model?: string\n  ): boolean {\n    const caps = this.getModelCapabilities(model);\n    return Boolean(caps.features[feature]);\n  }\n\n  /**\n   * Get supported input audio formats\n   */\n  getSupportedInputFormats(model?: string): readonly string[] | string[] {\n    return this.getModelCapabilities(model).inputFormats;\n  }\n\n  /**\n   * Get supported output formats\n   */\n  getSupportedOutputFormats(model?: string): readonly string[] {\n    return this.getModelCapabilities(model).outputFormats;\n  }\n\n  /**\n   * Get supported languages (empty array = auto-detect all)\n   */\n  getSupportedLanguages(model?: string): readonly string[] {\n    return this.getModelCapabilities(model).languages;\n  }\n\n  /**\n   * Check if timestamps are supported\n   */\n  supportsTimestamps(model?: string): boolean {\n    return this.getModelCapabilities(model).timestamps.supported;\n  }\n\n  /**\n   * Check if translation is supported\n   */\n  supportsTranslation(model?: string): boolean {\n    return this.supportsFeature('translation', model);\n  }\n\n  /**\n   * Check if speaker diarization is supported\n   */\n  supportsDiarization(model?: string): boolean {\n    return this.supportsFeature('diarization', model);\n  }\n\n  /**\n   * Get timestamp granularities supported\n   */\n  getTimestampGranularities(model?: string): ('word' | 'segment')[] | undefined {\n    return this.getModelCapabilities(model).timestamps.granularities;\n  }\n\n  // ======================== Configuration Methods ========================\n\n  /**\n   * Update default model\n   */\n  setModel(model: string): void {\n    this.config.model = model;\n  }\n\n  /**\n   * Update default language\n   */\n  setLanguage(language: string): void {\n    this.config.language = language;\n  }\n\n  /**\n   * Update default temperature\n   */\n  setTemperature(temperature: number): void {\n    this.config.temperature = temperature;\n  }\n\n  // ======================== Private Methods ========================\n\n  /**\n   * Get default model (first active model for vendor)\n   */\n  private getDefaultModel(): string {\n    const models = this.listAvailableModels();\n    const firstModel = models[0];\n    if (!firstModel) {\n      throw new Error('No STT models available for this provider');\n    }\n    return firstModel.name;\n  }\n}\n","/**\n * Speech-to-Text model registry with comprehensive metadata\n */\n\nimport { Vendor } from '../../core/Vendor.js';\nimport type { IBaseModelDescription, VendorOptionSchema } from '../types/SharedTypes.js';\nimport { createRegistryHelpers } from './RegistryUtils.js';\nimport { AUDIO_FORMATS } from './SharedVoices.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * STT output format types\n */\nexport type STTOutputFormat = 'json' | 'text' | 'srt' | 'vtt' | 'verbose_json';\n\n/**\n * STT model capabilities\n */\nexport interface STTModelCapabilities {\n  /** Supported input audio formats */\n  inputFormats: readonly string[] | string[];\n\n  /** Supported output formats */\n  outputFormats: STTOutputFormat[];\n\n  /** Supported languages (empty = auto-detect all) */\n  languages: string[];\n\n  /** Timestamp support */\n  timestamps: {\n    supported: boolean;\n    granularities?: ('word' | 'segment')[];\n  };\n\n  /** Feature support flags */\n  features: {\n    /** Translation to English */\n    translation: boolean;\n    /** Speaker identification */\n    diarization: boolean;\n    /** Real-time streaming (not implemented in v1) */\n    streaming: boolean;\n    /** Automatic punctuation */\n    punctuation: boolean;\n    /** Profanity filtering */\n    profanityFilter: boolean;\n  };\n\n  /** Model limits */\n  limits: {\n    /** Maximum file size in MB */\n    maxFileSizeMB: number;\n    /** Maximum duration in seconds */\n    maxDurationSeconds?: number;\n  };\n\n  /** Vendor-specific options schema */\n  vendorOptions?: Record<string, VendorOptionSchema>;\n}\n\n/**\n * STT model pricing\n */\nexport interface STTModelPricing {\n  /** Cost per minute of audio */\n  perMinute: number;\n  currency: 'USD';\n}\n\n/**\n * Complete STT model description\n */\nexport interface ISTTModelDescription extends IBaseModelDescription {\n  capabilities: STTModelCapabilities;\n  pricing?: STTModelPricing;\n}\n\n// =============================================================================\n// Model Constants\n// =============================================================================\n\nexport const STT_MODELS = {\n  [Vendor.OpenAI]: {\n    /** NEW: GPT-4o based transcription */\n    GPT_4O_TRANSCRIBE: 'gpt-4o-transcribe',\n    /** NEW: GPT-4o with speaker diarization */\n    GPT_4O_TRANSCRIBE_DIARIZE: 'gpt-4o-transcribe-diarize',\n    /** Classic Whisper */\n    WHISPER_1: 'whisper-1',\n  },\n  [Vendor.Groq]: {\n    /** Ultra-fast Whisper on Groq LPUs */\n    WHISPER_LARGE_V3: 'whisper-large-v3',\n    /** Faster English-only variant */\n    DISTIL_WHISPER: 'distil-whisper-large-v3-en',\n  },\n} as const;\n\n// =============================================================================\n// Shared Capability Presets (DRY)\n// =============================================================================\n\n/**\n * Base Whisper capabilities (shared across OpenAI/Groq models)\n */\nconst WHISPER_BASE_CAPABILITIES: Omit<STTModelCapabilities, 'features' | 'limits'> = {\n  inputFormats: AUDIO_FORMATS.STT_INPUT,\n  outputFormats: ['json', 'text', 'srt', 'vtt', 'verbose_json'],\n  languages: [], // Auto-detect, 50+ languages\n  timestamps: { supported: true, granularities: ['word', 'segment'] },\n};\n\n// =============================================================================\n// Registry\n// =============================================================================\n\n/**\n * Complete STT model registry\n * Last full audit: January 2026\n */\nexport const STT_MODEL_REGISTRY: Record<string, ISTTModelDescription> = {\n  // ======================== OpenAI ========================\n\n  'gpt-4o-transcribe': {\n    name: 'gpt-4o-transcribe',\n    displayName: 'GPT-4o Transcribe',\n    provider: Vendor.OpenAI,\n    description: 'GPT-4o based transcription with superior accuracy and context understanding',\n    isActive: true,\n    releaseDate: '2025-04-01',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/speech-to-text',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...WHISPER_BASE_CAPABILITIES,\n      features: {\n        translation: true,\n        diarization: false,\n        streaming: false, // Not implementing streaming in v1\n        punctuation: true,\n        profanityFilter: false,\n      },\n      limits: { maxFileSizeMB: 25, maxDurationSeconds: 7200 },\n    },\n    pricing: { perMinute: 0.006, currency: 'USD' },\n  },\n\n  'gpt-4o-transcribe-diarize': {\n    name: 'gpt-4o-transcribe-diarize',\n    displayName: 'GPT-4o Transcribe + Diarization',\n    provider: Vendor.OpenAI,\n    description: 'GPT-4o transcription with speaker identification',\n    isActive: true,\n    releaseDate: '2025-04-01',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/speech-to-text',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...WHISPER_BASE_CAPABILITIES,\n      outputFormats: ['json', 'verbose_json'],\n      features: {\n        translation: true,\n        diarization: true, // Built-in speaker identification\n        streaming: false,\n        punctuation: true,\n        profanityFilter: false,\n      },\n      limits: { maxFileSizeMB: 25, maxDurationSeconds: 7200 },\n      vendorOptions: {\n        max_speakers: {\n          type: 'number',\n          description: 'Maximum number of speakers to detect',\n          min: 2,\n          max: 10,\n          default: 4,\n        },\n      },\n    },\n    pricing: { perMinute: 0.012, currency: 'USD' }, // 2x for diarization\n  },\n\n  'whisper-1': {\n    name: 'whisper-1',\n    displayName: 'Whisper',\n    provider: Vendor.OpenAI,\n    description: \"OpenAI's general-purpose speech recognition model\",\n    isActive: true,\n    releaseDate: '2023-03-01',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/speech-to-text',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...WHISPER_BASE_CAPABILITIES,\n      inputFormats: ['mp3', 'mp4', 'mpeg', 'mpga', 'm4a', 'wav', 'webm'],\n      features: {\n        translation: true,\n        diarization: false,\n        streaming: false,\n        punctuation: true,\n        profanityFilter: false,\n      },\n      limits: { maxFileSizeMB: 25 },\n    },\n    pricing: { perMinute: 0.006, currency: 'USD' },\n  },\n\n  // ======================== Groq ========================\n\n  'whisper-large-v3': {\n    name: 'whisper-large-v3',\n    displayName: 'Whisper Large v3 (Groq)',\n    provider: Vendor.Groq,\n    description: 'Ultra-fast Whisper on Groq LPUs - 12x cheaper than OpenAI',\n    isActive: true,\n    releaseDate: '2024-04-01',\n    sources: {\n      documentation: 'https://console.groq.com/docs/speech-text',\n      pricing: 'https://groq.com/pricing/',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      ...WHISPER_BASE_CAPABILITIES,\n      timestamps: { supported: true, granularities: ['segment'] },\n      outputFormats: ['json', 'text', 'verbose_json'],\n      features: {\n        translation: true,\n        diarization: false,\n        streaming: false,\n        punctuation: true,\n        profanityFilter: false,\n      },\n      limits: { maxFileSizeMB: 25 },\n    },\n    pricing: { perMinute: 0.0005, currency: 'USD' }, // 12x cheaper!\n  },\n\n  'distil-whisper-large-v3-en': {\n    name: 'distil-whisper-large-v3-en',\n    displayName: 'Distil Whisper (Groq)',\n    provider: Vendor.Groq,\n    description: 'Faster English-only Whisper variant on Groq',\n    isActive: true,\n    releaseDate: '2024-04-01',\n    sources: {\n      documentation: 'https://console.groq.com/docs/speech-text',\n      pricing: 'https://groq.com/pricing/',\n      lastVerified: '2026-01-24',\n    },\n    capabilities: {\n      inputFormats: AUDIO_FORMATS.STT_INPUT,\n      outputFormats: ['json', 'text', 'verbose_json'],\n      languages: ['en'], // English only\n      timestamps: { supported: true, granularities: ['segment'] },\n      features: {\n        translation: false,\n        diarization: false,\n        streaming: false,\n        punctuation: true,\n        profanityFilter: false,\n      },\n      limits: { maxFileSizeMB: 25 },\n    },\n    pricing: { perMinute: 0.00033, currency: 'USD' },\n  },\n};\n\n// =============================================================================\n// Helper Functions (using shared utilities)\n// =============================================================================\n\nconst helpers = createRegistryHelpers(STT_MODEL_REGISTRY);\n\nexport const getSTTModelInfo = helpers.getInfo;\nexport const getSTTModelsByVendor = helpers.getByVendor;\nexport const getActiveSTTModels = helpers.getActive;\n\n/**\n * Get STT models that support a specific feature\n */\nexport function getSTTModelsWithFeature(\n  feature: keyof ISTTModelDescription['capabilities']['features']\n): ISTTModelDescription[] {\n  return Object.values(STT_MODEL_REGISTRY).filter(\n    (model) => model.isActive && model.capabilities.features[feature]\n  );\n}\n\n/**\n * Calculate estimated cost for STT\n */\nexport function calculateSTTCost(modelName: string, durationSeconds: number): number | null {\n  const model = getSTTModelInfo(modelName);\n  if (!model?.pricing) return null;\n  return (durationSeconds / 60) * model.pricing.perMinute;\n}\n","/**\n * OpenAI Image Generation provider\n * Supports: gpt-image-1, dall-e-3, dall-e-2\n */\n\nimport OpenAI from 'openai';\nimport * as fs from 'fs';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type {\n  IImageProvider,\n  ImageGenerateOptions,\n  ImageEditOptions,\n  ImageVariationOptions,\n  ImageResponse,\n} from '../../../domain/interfaces/IImageProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { OpenAIMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\nexport class OpenAIImageProvider extends BaseMediaProvider implements IImageProvider {\n  readonly name: string = 'openai-image';\n  readonly vendor = 'openai' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: true,\n    videos: false,\n    audio: false,\n    features: {\n      imageGeneration: true,\n      imageEditing: true,\n    },\n  };\n\n  private client: OpenAI;\n\n  constructor(config: OpenAIMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.client = new OpenAI({\n      apiKey: config.auth.apiKey,\n      baseURL: config.baseURL,\n      organization: config.organization,\n      timeout: config.timeout,\n      maxRetries: config.maxRetries,\n    });\n  }\n\n  /**\n   * Generate images from a text prompt\n   */\n  async generateImage(options: ImageGenerateOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.generate', {\n            model: options.model,\n            size: options.size,\n            quality: options.quality,\n            n: options.n,\n          });\n\n          // gpt-image-1 doesn't support response_format parameter\n          const isGptImage = options.model === 'gpt-image-1';\n\n          const params: any = {\n            model: options.model,\n            prompt: options.prompt,\n            size: options.size as any,\n            quality: options.quality,\n            style: options.style,\n            n: options.n || 1,\n          };\n\n          // Only add response_format for models that support it\n          if (!isGptImage) {\n            params.response_format = options.response_format || 'b64_json';\n          }\n\n          const response = await this.client.images.generate(params);\n\n          const data = response.data || [];\n\n          this.logOperationComplete('image.generate', {\n            model: options.model,\n            imagesGenerated: data.length,\n          });\n\n          return {\n            created: response.created,\n            data: data.map((img) => ({\n              url: img.url,\n              b64_json: img.b64_json,\n              revised_prompt: img.revised_prompt,\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error; // TypeScript needs this\n        }\n      },\n      'image.generate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Edit an existing image with a prompt\n   * Supported by: gpt-image-1, dall-e-2\n   */\n  async editImage(options: ImageEditOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.edit', {\n            model: options.model,\n            size: options.size,\n            n: options.n,\n          });\n\n          // Prepare the image - handle both Buffer and file path\n          const image = this.prepareImageInput(options.image);\n          const mask = options.mask ? this.prepareImageInput(options.mask) : undefined;\n\n          // gpt-image-1 doesn't support response_format parameter\n          const isGptImage = options.model === 'gpt-image-1';\n\n          const params: any = {\n            model: options.model,\n            image,\n            prompt: options.prompt,\n            mask,\n            size: options.size as any,\n            n: options.n || 1,\n          };\n\n          // Only add response_format for models that support it\n          if (!isGptImage) {\n            params.response_format = options.response_format || 'b64_json';\n          }\n\n          const response = await this.client.images.edit(params);\n\n          const data = response.data || [];\n\n          this.logOperationComplete('image.edit', {\n            model: options.model,\n            imagesGenerated: data.length,\n          });\n\n          return {\n            created: response.created,\n            data: data.map((img) => ({\n              url: img.url,\n              b64_json: img.b64_json,\n              revised_prompt: img.revised_prompt,\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'image.edit',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Create variations of an existing image\n   * Supported by: dall-e-2 only\n   */\n  async createVariation(options: ImageVariationOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.variation', {\n            model: options.model,\n            size: options.size,\n            n: options.n,\n          });\n\n          // Prepare the image\n          const image = this.prepareImageInput(options.image);\n\n          const response = await this.client.images.createVariation({\n            model: options.model,\n            image,\n            size: options.size as any,\n            n: options.n || 1,\n            response_format: options.response_format || 'b64_json',\n          });\n\n          const data = response.data || [];\n\n          this.logOperationComplete('image.variation', {\n            model: options.model,\n            imagesGenerated: data.length,\n          });\n\n          return {\n            created: response.created,\n            data: data.map((img) => ({\n              url: img.url,\n              b64_json: img.b64_json,\n              revised_prompt: img.revised_prompt,\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'image.variation',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * List available image models\n   */\n  async listModels(): Promise<string[]> {\n    return ['gpt-image-1', 'dall-e-3', 'dall-e-2'];\n  }\n\n  /**\n   * Prepare image input (Buffer or file path) for OpenAI API\n   */\n  private prepareImageInput(image: Buffer | string): any {\n    if (Buffer.isBuffer(image)) {\n      // OpenAI accepts File objects, we create a blob-like structure\n      return new File([new Uint8Array(image)], 'image.png', { type: 'image/png' });\n    }\n\n    // It's a file path - create a readable stream\n    return fs.createReadStream(image);\n  }\n\n  /**\n   * Handle OpenAI API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown OpenAI API error';\n    const status = error.status;\n\n    if (status === 401) {\n      throw new ProviderAuthError('openai', 'Invalid API key');\n    }\n\n    if (status === 429) {\n      throw new ProviderRateLimitError('openai', message);\n    }\n\n    if (status === 400) {\n      // Check for specific image-related errors\n      if (message.includes('safety system')) {\n        throw new ProviderError('openai', `Content policy violation: ${message}`);\n      }\n      throw new ProviderError('openai', `Bad request: ${message}`);\n    }\n\n    throw new ProviderError('openai', message);\n  }\n}\n","/**\n * Google Imagen Image Generation provider\n * Supports: imagen-3.0-generate-002, imagen-3.0-fast-generate-001, imagen-3.0-capability-001\n */\n\nimport { GoogleGenAI } from '@google/genai';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type {\n  IImageProvider,\n  ImageGenerateOptions,\n  ImageEditOptions,\n  ImageResponse,\n} from '../../../domain/interfaces/IImageProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { GoogleConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\n/**\n * Extended options for Google image generation\n */\nexport interface GoogleImageGenerateOptions extends ImageGenerateOptions {\n  /** Negative prompt - what to avoid */\n  negativePrompt?: string;\n  /** Aspect ratio (1:1, 3:4, 4:3, 9:16, 16:9) */\n  aspectRatio?: '1:1' | '3:4' | '4:3' | '9:16' | '16:9';\n  /** Random seed for reproducible generation */\n  seed?: number;\n  /** Output MIME type */\n  outputMimeType?: 'image/png' | 'image/jpeg';\n  /** Include safety filter reason in response */\n  includeRaiReason?: boolean;\n}\n\nexport class GoogleImageProvider extends BaseMediaProvider implements IImageProvider {\n  readonly name: string = 'google-image';\n  readonly vendor = 'google' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: true,\n    videos: false,\n    audio: false,\n    features: {\n      imageGeneration: true,\n      imageEditing: true,\n    },\n  };\n\n  private client: GoogleGenAI;\n\n  constructor(config: GoogleConfig) {\n    super(config);\n\n    this.client = new GoogleGenAI({\n      apiKey: config.apiKey,\n    });\n  }\n\n  /**\n   * Generate images from a text prompt using Google Imagen\n   */\n  async generateImage(options: ImageGenerateOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.generate', {\n            model: options.model,\n            n: options.n,\n          });\n\n          const googleOptions = options as GoogleImageGenerateOptions;\n\n          const response = await this.client.models.generateImages({\n            model: options.model,\n            prompt: options.prompt,\n            config: {\n              numberOfImages: options.n || 1,\n              negativePrompt: googleOptions.negativePrompt,\n              aspectRatio: googleOptions.aspectRatio,\n              seed: googleOptions.seed,\n              outputMimeType: googleOptions.outputMimeType,\n              includeRaiReason: googleOptions.includeRaiReason,\n            },\n          });\n\n          const images = response.generatedImages || [];\n\n          this.logOperationComplete('image.generate', {\n            model: options.model,\n            imagesGenerated: images.length,\n          });\n\n          return {\n            created: Math.floor(Date.now() / 1000),\n            data: images.map((img: any) => ({\n              b64_json: img.image?.imageBytes,\n              // Google doesn't provide URLs, only base64\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'image.generate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Edit an existing image using Imagen capability model\n   * Uses imagen-3.0-capability-001\n   */\n  async editImage(options: ImageEditOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.edit', {\n            model: options.model,\n            n: options.n,\n          });\n\n          // Prepare the reference image\n          const referenceImage = await this.prepareReferenceImage(options.image);\n\n          const response = await this.client.models.editImage({\n            model: options.model || 'imagen-3.0-capability-001',\n            prompt: options.prompt,\n            referenceImages: [referenceImage],\n            config: {\n              numberOfImages: options.n || 1,\n            },\n          });\n\n          const images = response.generatedImages || [];\n\n          this.logOperationComplete('image.edit', {\n            model: options.model,\n            imagesGenerated: images.length,\n          });\n\n          return {\n            created: Math.floor(Date.now() / 1000),\n            data: images.map((img: any) => ({\n              b64_json: img.image?.imageBytes,\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'image.edit',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * List available image models\n   */\n  async listModels(): Promise<string[]> {\n    return [\n      'imagen-4.0-generate-001',\n      'imagen-4.0-ultra-generate-001',\n      'imagen-4.0-fast-generate-001',\n    ];\n  }\n\n  /**\n   * Prepare a reference image for Google's editImage API\n   */\n  private async prepareReferenceImage(image: Buffer | string): Promise<any> {\n    let imageBytes: string;\n\n    if (Buffer.isBuffer(image)) {\n      imageBytes = image.toString('base64');\n    } else {\n      // It's a file path - read and convert\n      const fs = await import('fs');\n      const buffer = fs.readFileSync(image);\n      imageBytes = buffer.toString('base64');\n    }\n\n    // Return a subject reference image structure\n    return {\n      referenceImage: {\n        image: {\n          imageBytes,\n        },\n      },\n      referenceType: 'REFERENCE_TYPE_SUBJECT',\n    };\n  }\n\n  /**\n   * Handle Google API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown Google API error';\n    const status = error.status || error.code;\n\n    if (status === 401 || message.includes('API key not valid')) {\n      throw new ProviderAuthError('google', 'Invalid API key');\n    }\n\n    if (status === 429 || message.includes('Resource exhausted')) {\n      throw new ProviderRateLimitError('google', message);\n    }\n\n    if (status === 400) {\n      // Check for safety-related errors\n      if (\n        message.includes('SAFETY') ||\n        message.includes('blocked') ||\n        message.includes('Responsible AI')\n      ) {\n        throw new ProviderError('google', `Content policy violation: ${message}`);\n      }\n      throw new ProviderError('google', `Bad request: ${message}`);\n    }\n\n    throw new ProviderError('google', message);\n  }\n}\n","/**\n * Grok (xAI) Image Generation Provider\n * Uses OpenAI-compatible API at api.x.ai\n * Supports: grok-imagine-image\n */\n\nimport OpenAI from 'openai';\nimport * as fs from 'fs';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type {\n  IImageProvider,\n  ImageGenerateOptions,\n  ImageEditOptions,\n  ImageResponse,\n} from '../../../domain/interfaces/IImageProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { GrokMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\nconst GROK_API_BASE_URL = 'https://api.x.ai/v1';\n\nexport class GrokImageProvider extends BaseMediaProvider implements IImageProvider {\n  readonly name: string = 'grok-image';\n  readonly vendor = 'grok' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: true,\n    videos: false,\n    audio: false,\n    features: {\n      imageGeneration: true,\n      imageEditing: true,\n    },\n  };\n\n  private client: OpenAI;\n\n  constructor(config: GrokMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.client = new OpenAI({\n      apiKey: config.auth.apiKey,\n      baseURL: config.baseURL || GROK_API_BASE_URL,\n      timeout: config.timeout,\n      maxRetries: config.maxRetries,\n    });\n  }\n\n  /**\n   * Generate images from a text prompt\n   */\n  async generateImage(options: ImageGenerateOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.generate', {\n            model: options.model,\n            size: options.size,\n            quality: options.quality,\n            n: options.n,\n          });\n\n          // xAI API uses aspect_ratio instead of size, and doesn't support quality\n          const params: any = {\n            model: options.model || 'grok-imagine-image',\n            prompt: options.prompt,\n            n: options.n || 1,\n            response_format: options.response_format || 'b64_json',\n          };\n\n          // Add aspect_ratio if provided (xAI uses aspect_ratio, not size)\n          if (options.aspectRatio) {\n            params.aspect_ratio = options.aspectRatio;\n          }\n\n          const response = await this.client.images.generate(params);\n\n          const data = response.data || [];\n\n          this.logOperationComplete('image.generate', {\n            model: options.model,\n            imagesGenerated: data.length,\n          });\n\n          return {\n            created: response.created,\n            data: data.map((img) => ({\n              url: img.url,\n              b64_json: img.b64_json,\n              revised_prompt: img.revised_prompt,\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'image.generate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Edit an existing image with a prompt\n   */\n  async editImage(options: ImageEditOptions): Promise<ImageResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('image.edit', {\n            model: options.model,\n            size: options.size,\n            n: options.n,\n          });\n\n          // Prepare the image - handle both Buffer and file path\n          const image = this.prepareImageInput(options.image);\n          const mask = options.mask ? this.prepareImageInput(options.mask) : undefined;\n\n          const params: any = {\n            model: options.model || 'grok-imagine-image',\n            image,\n            prompt: options.prompt,\n            mask,\n            size: options.size as any,\n            n: options.n || 1,\n            response_format: options.response_format || 'b64_json',\n          };\n\n          const response = await this.client.images.edit(params);\n\n          const data = response.data || [];\n\n          this.logOperationComplete('image.edit', {\n            model: options.model,\n            imagesGenerated: data.length,\n          });\n\n          return {\n            created: response.created,\n            data: data.map((img) => ({\n              url: img.url,\n              b64_json: img.b64_json,\n              revised_prompt: img.revised_prompt,\n            })),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'image.edit',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * List available image models\n   */\n  async listModels(): Promise<string[]> {\n    return ['grok-imagine-image'];\n  }\n\n  /**\n   * Prepare image input (Buffer or file path) for API\n   */\n  private prepareImageInput(image: Buffer | string): any {\n    if (Buffer.isBuffer(image)) {\n      return new File([new Uint8Array(image)], 'image.png', { type: 'image/png' });\n    }\n\n    // It's a file path - create a readable stream\n    return fs.createReadStream(image);\n  }\n\n  /**\n   * Handle API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown Grok API error';\n    const status = error.status;\n\n    if (status === 401) {\n      throw new ProviderAuthError('grok', 'Invalid API key');\n    }\n\n    if (status === 429) {\n      throw new ProviderRateLimitError('grok', message);\n    }\n\n    if (status === 400) {\n      if (message.includes('safety') || message.includes('policy')) {\n        throw new ProviderError('grok', `Content policy violation: ${message}`);\n      }\n      throw new ProviderError('grok', `Bad request: ${message}`);\n    }\n\n    throw new ProviderError('grok', message);\n  }\n}\n","/**\n * Factory functions for creating image providers\n */\n\nimport { Connector } from './Connector.js';\nimport type { IImageProvider } from '../domain/interfaces/IImageProvider.js';\nimport { Vendor } from './Vendor.js';\nimport { OpenAIImageProvider } from '../infrastructure/providers/openai/OpenAIImageProvider.js';\nimport { GoogleImageProvider } from '../infrastructure/providers/google/GoogleImageProvider.js';\nimport { GrokImageProvider } from '../infrastructure/providers/grok/GrokImageProvider.js';\nimport type { OpenAIMediaConfig, GoogleConfig, GrokMediaConfig } from '../domain/types/ProviderConfig.js';\n\n/**\n * Create an Image Generation provider from a connector\n */\nexport function createImageProvider(connector: Connector): IImageProvider {\n  const vendor = connector.vendor;\n\n  switch (vendor) {\n    case Vendor.OpenAI:\n      return new OpenAIImageProvider(extractOpenAIConfig(connector));\n\n    case Vendor.Google:\n      return new GoogleImageProvider(extractGoogleConfig(connector));\n\n    case Vendor.Grok:\n      return new GrokImageProvider(extractGrokConfig(connector));\n\n    default:\n      throw new Error(\n        `No Image provider available for vendor: ${vendor}. ` +\n        `Supported vendors: ${Vendor.OpenAI}, ${Vendor.Google}, ${Vendor.Grok}`\n      );\n  }\n}\n\n/**\n * Extract OpenAI configuration from connector\n */\nfunction extractOpenAIConfig(connector: Connector): OpenAIMediaConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('OpenAI requires API key authentication');\n  }\n\n  const options = connector.getOptions();\n\n  return {\n    auth: {\n      type: 'api_key',\n      apiKey: auth.apiKey,\n    },\n    baseURL: connector.baseURL,\n    organization: options.organization as string | undefined,\n    timeout: options.timeout as number | undefined,\n    maxRetries: options.maxRetries as number | undefined,\n  };\n}\n\n/**\n * Extract Google configuration from connector\n */\nfunction extractGoogleConfig(connector: Connector): GoogleConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('Google requires API key authentication');\n  }\n\n  return {\n    apiKey: auth.apiKey,\n  };\n}\n\n/**\n * Extract Grok configuration from connector\n */\nfunction extractGrokConfig(connector: Connector): GrokMediaConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('Grok requires API key authentication');\n  }\n\n  const options = connector.getOptions();\n\n  return {\n    auth: {\n      type: 'api_key',\n      apiKey: auth.apiKey,\n    },\n    baseURL: connector.baseURL,\n    timeout: options.timeout as number | undefined,\n    maxRetries: options.maxRetries as number | undefined,\n  };\n}\n","/**\n * LoggingPlugin\n *\n * A tool execution plugin that logs tool execution start, completion, and errors.\n * Useful for debugging and observability.\n *\n * @module tool-execution\n */\n\nimport type {\n  IToolExecutionPlugin,\n  PluginExecutionContext,\n  BeforeExecuteResult,\n} from '../types.js';\nimport { logger as frameworkLogger, type FrameworkLogger } from '../../../infrastructure/observability/Logger.js';\n\n/**\n * Configuration options for LoggingPlugin\n */\nexport interface LoggingPluginOptions {\n  /**\n   * Log level for start/complete messages.\n   * Default: 'debug'\n   */\n  level?: 'trace' | 'debug' | 'info' | 'warn' | 'error';\n\n  /**\n   * Log level for error messages.\n   * Default: 'error'\n   */\n  errorLevel?: 'warn' | 'error';\n\n  /**\n   * Whether to include tool arguments in logs.\n   * Set to false for tools with sensitive data.\n   * Default: true\n   */\n  logArgs?: boolean;\n\n  /**\n   * Whether to include result summary in completion logs.\n   * Default: true\n   */\n  logResult?: boolean;\n\n  /**\n   * Maximum length for argument/result strings in logs.\n   * Default: 200\n   */\n  maxLogLength?: number;\n\n  /**\n   * Custom logger instance. If not provided, uses framework logger.\n   */\n  logger?: FrameworkLogger;\n\n  /**\n   * Component name for the logger.\n   * Default: 'ToolExecution'\n   */\n  component?: string;\n}\n\n/**\n * LoggingPlugin - Logs tool execution lifecycle events.\n *\n * @example\n * ```typescript\n * const pipeline = new ToolExecutionPipeline();\n * pipeline.use(new LoggingPlugin());\n * // Or with custom options:\n * pipeline.use(new LoggingPlugin({\n *   level: 'info',\n *   logArgs: false, // Don't log potentially sensitive args\n * }));\n * ```\n */\nexport class LoggingPlugin implements IToolExecutionPlugin {\n  readonly name = 'logging';\n  readonly priority = 5; // Run very early to capture full execution\n\n  private logger: FrameworkLogger;\n  private level: 'trace' | 'debug' | 'info' | 'warn' | 'error';\n  private errorLevel: 'warn' | 'error';\n  private logArgs: boolean;\n  private logResult: boolean;\n  private maxLogLength: number;\n\n  constructor(options: LoggingPluginOptions = {}) {\n    const baseLogger = options.logger ?? frameworkLogger;\n    this.logger = baseLogger.child({ component: options.component ?? 'ToolExecution' });\n    this.level = options.level ?? 'debug';\n    this.errorLevel = options.errorLevel ?? 'error';\n    this.logArgs = options.logArgs ?? true;\n    this.logResult = options.logResult ?? true;\n    this.maxLogLength = options.maxLogLength ?? 200;\n  }\n\n  async beforeExecute(ctx: PluginExecutionContext): Promise<BeforeExecuteResult> {\n    const logData: Record<string, unknown> = {\n      executionId: ctx.executionId,\n      tool: ctx.toolName,\n    };\n\n    if (this.logArgs) {\n      logData.args = this.summarize(ctx.args);\n    }\n\n    this.log(this.level, logData, `Tool ${ctx.toolName} starting`);\n  }\n\n  async afterExecute(ctx: PluginExecutionContext, result: unknown): Promise<unknown> {\n    const duration = Date.now() - ctx.startTime;\n\n    const logData: Record<string, unknown> = {\n      executionId: ctx.executionId,\n      tool: ctx.toolName,\n      durationMs: duration,\n    };\n\n    if (this.logResult) {\n      logData.result = this.summarize(result);\n    }\n\n    this.log(this.level, logData, `Tool ${ctx.toolName} completed in ${duration}ms`);\n\n    return result;\n  }\n\n  async onError(ctx: PluginExecutionContext, error: Error): Promise<unknown> {\n    const duration = Date.now() - ctx.startTime;\n\n    const logData: Record<string, unknown> = {\n      executionId: ctx.executionId,\n      tool: ctx.toolName,\n      durationMs: duration,\n      error: error.message,\n      errorName: error.name,\n    };\n\n    this.log(this.errorLevel, logData, `Tool ${ctx.toolName} failed after ${duration}ms: ${error.message}`);\n\n    // Don't recover, let error propagate\n    return undefined;\n  }\n\n  /**\n   * Log a message at the specified level.\n   */\n  private log(level: string, data: Record<string, unknown>, message: string): void {\n    switch (level) {\n      case 'trace':\n        this.logger.trace(data, message);\n        break;\n      case 'debug':\n        this.logger.debug(data, message);\n        break;\n      case 'info':\n        this.logger.info(data, message);\n        break;\n      case 'warn':\n        this.logger.warn(data, message);\n        break;\n      case 'error':\n        this.logger.error(data, message);\n        break;\n    }\n  }\n\n  /**\n   * Summarize a value for logging, truncating if necessary.\n   */\n  private summarize(value: unknown): unknown {\n    if (value === null || value === undefined) {\n      return value;\n    }\n\n    if (typeof value === 'string') {\n      return value.length > this.maxLogLength\n        ? value.slice(0, this.maxLogLength) + '...'\n        : value;\n    }\n\n    if (typeof value !== 'object') {\n      return value;\n    }\n\n    // For objects, provide a summary\n    if (Array.isArray(value)) {\n      return { type: 'array', length: value.length };\n    }\n\n    const obj = value as Record<string, unknown>;\n\n    // Handle common result patterns\n    if ('success' in obj) {\n      const summary: Record<string, unknown> = { success: obj.success };\n      if ('error' in obj) summary.error = obj.error;\n      if ('count' in obj) summary.count = obj.count;\n      if ('results' in obj && Array.isArray(obj.results)) {\n        summary.resultCount = obj.results.length;\n      }\n      return summary;\n    }\n\n    // Generic object summary\n    const keys = Object.keys(obj);\n    return { type: 'object', keys: keys.slice(0, 5), keyCount: keys.length };\n  }\n}\n","/**\n * ErrorHandler - Centralized error handling for agents\n *\n * Provides consistent error handling, logging, and retry logic across all agent types.\n * This is an opt-in utility that agents can use for standardized error management.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { logger, FrameworkLogger } from '../infrastructure/observability/Logger.js';\nimport { metrics } from '../infrastructure/observability/Metrics.js';\n\n/**\n * Context information for error handling\n */\nexport interface ErrorContext {\n  /** Type of agent */\n  agentType: 'agent' | 'task-agent' | 'universal-agent';\n\n  /** Optional agent identifier */\n  agentId?: string;\n\n  /** Operation that failed */\n  operation: string;\n\n  /** Input that caused the error (optional, for debugging) */\n  input?: unknown;\n\n  /** Additional metadata */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Configuration for ErrorHandler\n */\nexport interface ErrorHandlerConfig {\n  /** Log errors to console/logger. Default: true */\n  logErrors?: boolean;\n\n  /** Include stack traces in logs. Default: true in development, false in production */\n  includeStackTrace?: boolean;\n\n  /** Custom error transformer */\n  transformError?: (error: Error, context: ErrorContext) => Error;\n\n  /** Error codes/messages that should be retried */\n  retryablePatterns?: string[];\n\n  /** Maximum retry attempts. Default: 3 */\n  maxRetries?: number;\n\n  /** Base delay for exponential backoff in ms. Default: 100 */\n  baseRetryDelayMs?: number;\n\n  /** Maximum retry delay in ms. Default: 5000 */\n  maxRetryDelayMs?: number;\n}\n\n/**\n * Events emitted by ErrorHandler\n */\nexport interface ErrorHandlerEvents {\n  /** Emitted when an error is handled */\n  error: { error: Error; context: ErrorContext; recoverable: boolean };\n\n  /** Emitted when retrying after an error */\n  'error:retrying': { error: Error; context: ErrorContext; attempt: number; delayMs: number };\n\n  /** Emitted when an error is fatal (no recovery possible) */\n  'error:fatal': { error: Error; context: ErrorContext };\n}\n\n/**\n * Default retryable error patterns\n */\nconst DEFAULT_RETRYABLE_PATTERNS = [\n  'ECONNRESET',\n  'ECONNREFUSED',\n  'ETIMEDOUT',\n  'ENOTFOUND',\n  'EAI_AGAIN',\n  'rate limit',\n  'Rate limit',\n  '429',\n  '500',\n  '502',\n  '503',\n  '504',\n  'timeout',\n  'Timeout',\n];\n\n/**\n * Centralized error handling for all agent types.\n *\n * Features:\n * - Consistent error logging with context\n * - Automatic retry with exponential backoff\n * - Error classification (recoverable vs fatal)\n * - Metrics collection\n * - Event emission for monitoring\n *\n * @example\n * ```typescript\n * const errorHandler = new ErrorHandler({\n *   maxRetries: 3,\n *   logErrors: true,\n * });\n *\n * // Handle an error\n * errorHandler.handle(error, {\n *   agentType: 'agent',\n *   operation: 'run',\n * });\n *\n * // Execute with retry\n * const result = await errorHandler.executeWithRetry(\n *   () => riskyOperation(),\n *   { agentType: 'agent', operation: 'riskyOperation' }\n * );\n * ```\n */\nexport class ErrorHandler extends EventEmitter<ErrorHandlerEvents> {\n  private config: Required<ErrorHandlerConfig>;\n  private logger: FrameworkLogger;\n\n  constructor(config: ErrorHandlerConfig = {}) {\n    super();\n\n    const isProduction = process.env.NODE_ENV === 'production';\n\n    this.config = {\n      logErrors: config.logErrors ?? true,\n      includeStackTrace: config.includeStackTrace ?? !isProduction,\n      transformError: config.transformError ?? ((e) => e),\n      retryablePatterns: config.retryablePatterns ?? DEFAULT_RETRYABLE_PATTERNS,\n      maxRetries: config.maxRetries ?? 3,\n      baseRetryDelayMs: config.baseRetryDelayMs ?? 100,\n      maxRetryDelayMs: config.maxRetryDelayMs ?? 5000,\n    };\n\n    this.logger = logger.child({ component: 'ErrorHandler' });\n  }\n\n  /**\n   * Handle an error with context.\n   * Logs the error, emits events, and records metrics.\n   *\n   * @param error - The error to handle\n   * @param context - Context information about where/how the error occurred\n   */\n  handle(error: Error, context: ErrorContext): void {\n    const transformed = this.config.transformError(error, context);\n    const recoverable = this.isRecoverable(transformed);\n\n    // Log the error\n    if (this.config.logErrors) {\n      this.logError(transformed, context, recoverable);\n    }\n\n    // Record metrics\n    this.recordMetrics(transformed, context, recoverable);\n\n    // Emit events\n    this.emit('error', { error: transformed, context, recoverable });\n\n    if (!recoverable) {\n      this.emit('error:fatal', { error: transformed, context });\n    }\n  }\n\n  /**\n   * Execute a function with automatic retry on retryable errors.\n   *\n   * @param fn - The function to execute\n   * @param context - Context for error handling\n   * @returns The result of the function\n   * @throws The last error if all retries are exhausted\n   */\n  async executeWithRetry<T>(\n    fn: () => Promise<T>,\n    context: ErrorContext\n  ): Promise<T> {\n    let lastError: Error | undefined;\n\n    for (let attempt = 1; attempt <= this.config.maxRetries; attempt++) {\n      try {\n        return await fn();\n      } catch (error) {\n        lastError = error as Error;\n\n        // Check if we should retry\n        const isLastAttempt = attempt === this.config.maxRetries;\n        const shouldRetry = !isLastAttempt && this.isRetryable(lastError);\n\n        if (!shouldRetry) {\n          this.handle(lastError, context);\n          throw lastError;\n        }\n\n        // Calculate delay with exponential backoff and jitter\n        const delay = this.calculateRetryDelay(attempt);\n\n        // Emit retrying event\n        this.emit('error:retrying', {\n          error: lastError,\n          context,\n          attempt,\n          delayMs: delay,\n        });\n\n        // Log retry\n        if (this.config.logErrors) {\n          this.logger.warn(\n            {\n              error: lastError.message,\n              attempt,\n              maxAttempts: this.config.maxRetries,\n              delayMs: delay,\n              ...this.contextToLogFields(context),\n            },\n            `Retrying after error (attempt ${attempt}/${this.config.maxRetries})`\n          );\n        }\n\n        // Wait before retrying\n        await this.delay(delay);\n      }\n    }\n\n    // Should never reach here, but TypeScript needs this\n    throw lastError;\n  }\n\n  /**\n   * Wrap a function with error handling (no retry).\n   * Useful for wrapping methods that already have their own retry logic.\n   *\n   * @param fn - The function to wrap\n   * @param contextFactory - Factory to create context from function arguments\n   * @returns A wrapped function with error handling\n   */\n  wrap<TArgs extends unknown[], TResult>(\n    fn: (...args: TArgs) => Promise<TResult>,\n    contextFactory: (...args: TArgs) => ErrorContext\n  ): (...args: TArgs) => Promise<TResult> {\n    return async (...args: TArgs): Promise<TResult> => {\n      try {\n        return await fn(...args);\n      } catch (error) {\n        this.handle(error as Error, contextFactory(...args));\n        throw error;\n      }\n    };\n  }\n\n  /**\n   * Check if an error is recoverable (can be retried or handled gracefully).\n   */\n  isRecoverable(error: Error): boolean {\n    // Network errors are often recoverable\n    if (this.isRetryable(error)) {\n      return true;\n    }\n\n    // Check for specific recoverable error types\n    const recoverableTypes = [\n      'RateLimitError',\n      'TimeoutError',\n      'NetworkError',\n      'ConnectionError',\n    ];\n\n    return recoverableTypes.some(\n      (type) => error.name === type || error.constructor.name === type\n    );\n  }\n\n  /**\n   * Check if an error should be retried.\n   */\n  isRetryable(error: Error): boolean {\n    const errorString = `${error.name} ${error.message}`;\n    return this.config.retryablePatterns.some((pattern) =>\n      errorString.includes(pattern)\n    );\n  }\n\n  /**\n   * Add a retryable pattern.\n   */\n  addRetryablePattern(pattern: string): void {\n    if (!this.config.retryablePatterns.includes(pattern)) {\n      this.config.retryablePatterns.push(pattern);\n    }\n  }\n\n  /**\n   * Remove a retryable pattern.\n   */\n  removeRetryablePattern(pattern: string): void {\n    const index = this.config.retryablePatterns.indexOf(pattern);\n    if (index !== -1) {\n      this.config.retryablePatterns.splice(index, 1);\n    }\n  }\n\n  /**\n   * Get current configuration (read-only).\n   */\n  getConfig(): Readonly<Required<ErrorHandlerConfig>> {\n    return { ...this.config };\n  }\n\n  // ===== Private Helpers =====\n\n  private logError(error: Error, context: ErrorContext, recoverable: boolean): void {\n    const level = recoverable ? 'warn' : 'error';\n    const logData = {\n      error: error.message,\n      errorName: error.name,\n      recoverable,\n      ...this.contextToLogFields(context),\n    };\n\n    if (this.config.includeStackTrace && error.stack) {\n      (logData as any).stack = error.stack;\n    }\n\n    this.logger[level](logData, `Error in ${context.operation}`);\n  }\n\n  private contextToLogFields(context: ErrorContext): Record<string, unknown> {\n    return {\n      agentType: context.agentType,\n      agentId: context.agentId,\n      operation: context.operation,\n      ...(context.metadata || {}),\n    };\n  }\n\n  private recordMetrics(error: Error, context: ErrorContext, recoverable: boolean): void {\n    metrics.increment('error.handled', 1, {\n      agentType: context.agentType,\n      operation: context.operation,\n      errorType: error.name,\n      recoverable: String(recoverable),\n    });\n  }\n\n  private calculateRetryDelay(attempt: number): number {\n    // Exponential backoff: base * 2^(attempt-1)\n    const exponentialDelay = this.config.baseRetryDelayMs * Math.pow(2, attempt - 1);\n\n    // Add jitter (20%)\n    const jitter = exponentialDelay * (0.8 + Math.random() * 0.4);\n\n    // Cap at max delay\n    return Math.min(jitter, this.config.maxRetryDelayMs);\n  }\n\n  private delay(ms: number): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n\n/**\n * Global error handler instance.\n * Can be used as a singleton for consistent error handling across the application.\n */\nexport const globalErrorHandler = new ErrorHandler();\n\nexport default ErrorHandler;\n","/**\n * ImageGeneration - High-level image generation capability\n *\n * Provides a unified interface for generating images across multiple vendors.\n *\n * @example\n * ```typescript\n * import { ImageGeneration, Connector, Vendor } from '@everworker/oneringai';\n *\n * Connector.create({\n *   name: 'openai',\n *   vendor: Vendor.OpenAI,\n *   auth: { type: 'api_key', apiKey: process.env.OPENAI_API_KEY! },\n * });\n *\n * const imageGen = ImageGeneration.create({ connector: 'openai' });\n *\n * const result = await imageGen.generate({\n *   prompt: 'A futuristic city at sunset',\n *   model: 'dall-e-3',\n *   size: '1024x1024',\n *   quality: 'hd',\n * });\n *\n * // Get base64 data\n * console.log(result.data[0].b64_json);\n * ```\n */\n\nimport { Connector } from '../../core/Connector.js';\nimport { createImageProvider } from '../../core/createImageProvider.js';\nimport type {\n  IImageProvider,\n  ImageGenerateOptions,\n  ImageEditOptions,\n  ImageVariationOptions,\n  ImageResponse,\n} from '../../domain/interfaces/IImageProvider.js';\nimport { IMAGE_MODELS, getImageModelInfo } from '../../domain/entities/ImageModel.js';\nimport { Vendor } from '../../core/Vendor.js';\n\n/**\n * Options for creating an ImageGeneration instance\n */\nexport interface ImageGenerationCreateOptions {\n  /** Connector name or instance */\n  connector: string | Connector;\n}\n\n/**\n * Simplified options for quick generation\n */\nexport interface SimpleGenerateOptions {\n  /** Text prompt describing the image */\n  prompt: string;\n  /** Model to use (defaults to vendor's best model) */\n  model?: string;\n  /** Image size */\n  size?: string;\n  /** Quality setting */\n  quality?: 'standard' | 'hd';\n  /** Style setting (DALL-E 3 only) */\n  style?: 'vivid' | 'natural';\n  /** Number of images to generate */\n  n?: number;\n  /** Response format */\n  response_format?: 'url' | 'b64_json';\n}\n\n/**\n * ImageGeneration capability class\n */\nexport class ImageGeneration {\n  private provider: IImageProvider;\n  private connector: Connector;\n  private defaultModel: string;\n\n  private constructor(connector: Connector) {\n    this.connector = connector;\n    this.provider = createImageProvider(connector);\n    this.defaultModel = this.getDefaultModel();\n  }\n\n  /**\n   * Create an ImageGeneration instance\n   */\n  static create(options: ImageGenerationCreateOptions): ImageGeneration {\n    const connector =\n      typeof options.connector === 'string'\n        ? Connector.get(options.connector)\n        : options.connector;\n\n    if (!connector) {\n      throw new Error(`Connector not found: ${options.connector}`);\n    }\n\n    return new ImageGeneration(connector);\n  }\n\n  /**\n   * Generate images from a text prompt\n   */\n  async generate(options: SimpleGenerateOptions): Promise<ImageResponse> {\n    const fullOptions: ImageGenerateOptions = {\n      model: options.model || this.defaultModel,\n      prompt: options.prompt,\n      size: options.size,\n      quality: options.quality,\n      style: options.style,\n      n: options.n,\n      response_format: options.response_format || 'b64_json',\n    };\n\n    return this.provider.generateImage(fullOptions);\n  }\n\n  /**\n   * Edit an existing image\n   * Note: Not all models/vendors support this\n   */\n  async edit(options: ImageEditOptions): Promise<ImageResponse> {\n    if (!this.provider.editImage) {\n      throw new Error(`Image editing not supported by ${this.provider.name}`);\n    }\n\n    const fullOptions: ImageEditOptions = {\n      ...options,\n      model: options.model || this.getEditModel(),\n    };\n\n    return this.provider.editImage(fullOptions);\n  }\n\n  /**\n   * Create variations of an existing image\n   * Note: Only DALL-E 2 supports this\n   */\n  async createVariation(options: ImageVariationOptions): Promise<ImageResponse> {\n    if (!this.provider.createVariation) {\n      throw new Error(`Image variations not supported by ${this.provider.name}`);\n    }\n\n    const fullOptions: ImageVariationOptions = {\n      ...options,\n      model: options.model || 'dall-e-2', // Only DALL-E 2 supports variations\n    };\n\n    return this.provider.createVariation(fullOptions);\n  }\n\n  /**\n   * List available models for this provider\n   */\n  async listModels(): Promise<string[]> {\n    if (this.provider.listModels) {\n      return this.provider.listModels();\n    }\n\n    // Fallback to registry\n    const vendor = this.connector.vendor;\n    if (vendor && IMAGE_MODELS[vendor as keyof typeof IMAGE_MODELS]) {\n      return Object.values(IMAGE_MODELS[vendor as keyof typeof IMAGE_MODELS]);\n    }\n\n    return [];\n  }\n\n  /**\n   * Get information about a specific model\n   */\n  getModelInfo(modelName: string) {\n    return getImageModelInfo(modelName);\n  }\n\n  /**\n   * Get the underlying provider\n   */\n  getProvider(): IImageProvider {\n    return this.provider;\n  }\n\n  /**\n   * Get the current connector\n   */\n  getConnector(): Connector {\n    return this.connector;\n  }\n\n  /**\n   * Get the default model for this vendor\n   */\n  private getDefaultModel(): string {\n    const vendor = this.connector.vendor;\n\n    switch (vendor) {\n      case Vendor.OpenAI:\n        return IMAGE_MODELS[Vendor.OpenAI].DALL_E_3;\n      case Vendor.Google:\n        return IMAGE_MODELS[Vendor.Google].IMAGEN_4_GENERATE;\n      case Vendor.Grok:\n        return IMAGE_MODELS[Vendor.Grok].GROK_IMAGINE_IMAGE;\n      default:\n        throw new Error(`No default image model for vendor: ${vendor}`);\n    }\n  }\n\n  /**\n   * Get the default edit model for this vendor\n   */\n  private getEditModel(): string {\n    const vendor = this.connector.vendor;\n\n    switch (vendor) {\n      case Vendor.OpenAI:\n        return IMAGE_MODELS[Vendor.OpenAI].GPT_IMAGE_1;\n      case Vendor.Google:\n        // Imagen 4 doesn't have a separate editing model yet\n        return IMAGE_MODELS[Vendor.Google].IMAGEN_4_GENERATE;\n      case Vendor.Grok:\n        // grok-imagine-image supports editing\n        return IMAGE_MODELS[Vendor.Grok].GROK_IMAGINE_IMAGE;\n      default:\n        throw new Error(`No edit model for vendor: ${vendor}`);\n    }\n  }\n}\n","/**\n * Image generation model registry with comprehensive metadata\n */\n\nimport { Vendor } from '../../core/Vendor.js';\nimport type { IBaseModelDescription, VendorOptionSchema } from '../types/SharedTypes.js';\nimport { createRegistryHelpers } from './RegistryUtils.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Supported image sizes by model\n */\nexport type ImageSize =\n  | '256x256'\n  | '512x512'\n  | '1024x1024'\n  | '1024x1536'\n  | '1536x1024'\n  | '1792x1024'\n  | '1024x1792'\n  | 'auto';\n\n/**\n * Supported aspect ratios\n */\nexport type AspectRatio = '1:1' | '3:4' | '4:3' | '9:16' | '16:9' | '3:2' | '2:3';\n\n/**\n * Image model capabilities\n */\nexport interface ImageModelCapabilities {\n  /** Supported image sizes */\n  sizes: readonly ImageSize[];\n\n  /** Supported aspect ratios (Google) */\n  aspectRatios?: readonly AspectRatio[];\n\n  /** Maximum number of images per request */\n  maxImagesPerRequest: number;\n\n  /** Supported output formats */\n  outputFormats: readonly string[];\n\n  /** Feature support flags */\n  features: {\n    /** Text-to-image generation */\n    generation: boolean;\n    /** Image editing/inpainting */\n    editing: boolean;\n    /** Image variations */\n    variations: boolean;\n    /** Style control */\n    styleControl: boolean;\n    /** Quality control (standard/hd) */\n    qualityControl: boolean;\n    /** Transparent backgrounds */\n    transparency: boolean;\n    /** Prompt revision/enhancement */\n    promptRevision: boolean;\n  };\n\n  /** Model limits */\n  limits: {\n    /** Maximum prompt length in characters */\n    maxPromptLength: number;\n    /** Rate limit (requests per minute) */\n    maxRequestsPerMinute?: number;\n  };\n\n  /** Vendor-specific options schema */\n  vendorOptions?: Record<string, VendorOptionSchema>;\n}\n\n/**\n * Image model pricing\n */\nexport interface ImageModelPricing {\n  /** Cost per image at standard quality */\n  perImageStandard?: number;\n  /** Cost per image at HD quality */\n  perImageHD?: number;\n  /** Cost per image (flat rate) */\n  perImage?: number;\n  currency: 'USD';\n}\n\n/**\n * Complete image model description\n */\nexport interface IImageModelDescription extends IBaseModelDescription {\n  capabilities: ImageModelCapabilities;\n  pricing?: ImageModelPricing;\n}\n\n// =============================================================================\n// Model Constants\n// =============================================================================\n\nexport const IMAGE_MODELS = {\n  [Vendor.OpenAI]: {\n    /** GPT-Image-1: Latest OpenAI image model with best quality */\n    GPT_IMAGE_1: 'gpt-image-1',\n    /** DALL-E 3: High quality image generation */\n    DALL_E_3: 'dall-e-3',\n    /** DALL-E 2: Fast, supports editing and variations */\n    DALL_E_2: 'dall-e-2',\n  },\n  [Vendor.Google]: {\n    /** Imagen 4.0: Latest Google image generation model */\n    IMAGEN_4_GENERATE: 'imagen-4.0-generate-001',\n    /** Imagen 4.0 Ultra: Highest quality */\n    IMAGEN_4_ULTRA: 'imagen-4.0-ultra-generate-001',\n    /** Imagen 4.0 Fast: Optimized for speed */\n    IMAGEN_4_FAST: 'imagen-4.0-fast-generate-001',\n  },\n  [Vendor.Grok]: {\n    /** Grok Imagine Image: xAI image generation with editing support */\n    GROK_IMAGINE_IMAGE: 'grok-imagine-image',\n    /** Grok 2 Image: xAI image generation (text-only input) */\n    GROK_2_IMAGE_1212: 'grok-2-image-1212',\n  },\n} as const;\n\n// =============================================================================\n// Registry\n// =============================================================================\n\n/**\n * Complete image model registry\n * Last full audit: January 2026\n */\nexport const IMAGE_MODEL_REGISTRY: Record<string, IImageModelDescription> = {\n  // ======================== OpenAI ========================\n\n  'gpt-image-1': {\n    name: 'gpt-image-1',\n    displayName: 'GPT-Image-1',\n    provider: Vendor.OpenAI,\n    description: 'OpenAI latest image generation model with best quality and features',\n    isActive: true,\n    releaseDate: '2025-04-01',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/images',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      sizes: ['1024x1024', '1024x1536', '1536x1024', 'auto'],\n      maxImagesPerRequest: 10,\n      outputFormats: ['png', 'webp', 'jpeg'],\n      features: {\n        generation: true,\n        editing: true,\n        variations: false,\n        styleControl: false,\n        qualityControl: true,\n        transparency: true,\n        promptRevision: false,\n      },\n      limits: { maxPromptLength: 32000 },\n      vendorOptions: {\n        quality: {\n          type: 'enum',\n          label: 'Quality',\n          description: 'Image quality level',\n          enum: ['auto', 'low', 'medium', 'high'],\n          default: 'auto',\n          controlType: 'select',\n        },\n        background: {\n          type: 'enum',\n          label: 'Background',\n          description: 'Background transparency',\n          enum: ['auto', 'transparent', 'opaque'],\n          default: 'auto',\n          controlType: 'select',\n        },\n        output_format: {\n          type: 'enum',\n          label: 'Output Format',\n          description: 'Image file format',\n          enum: ['png', 'jpeg', 'webp'],\n          default: 'png',\n          controlType: 'select',\n        },\n        output_compression: {\n          type: 'number',\n          label: 'Compression',\n          description: 'Compression level for JPEG/WebP (0-100)',\n          min: 0,\n          max: 100,\n          default: 75,\n          controlType: 'slider',\n        },\n        moderation: {\n          type: 'enum',\n          label: 'Moderation',\n          description: 'Content moderation strictness',\n          enum: ['auto', 'low'],\n          default: 'auto',\n          controlType: 'radio',\n        },\n      },\n    },\n    pricing: {\n      perImageStandard: 0.011,\n      perImageHD: 0.042,\n      currency: 'USD',\n    },\n  },\n\n  'dall-e-3': {\n    name: 'dall-e-3',\n    displayName: 'DALL-E 3',\n    provider: Vendor.OpenAI,\n    description: 'High quality image generation with prompt revision',\n    isActive: true,\n    releaseDate: '2023-11-06',\n    deprecationDate: '2026-05-12',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/images',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      sizes: ['1024x1024', '1024x1792', '1792x1024'],\n      maxImagesPerRequest: 1,\n      outputFormats: ['png', 'url'],\n      features: {\n        generation: true,\n        editing: false,\n        variations: false,\n        styleControl: true,\n        qualityControl: true,\n        transparency: false,\n        promptRevision: true,\n      },\n      limits: { maxPromptLength: 4000 },\n      vendorOptions: {\n        quality: {\n          type: 'enum',\n          label: 'Quality',\n          description: 'Image quality: standard or HD',\n          enum: ['standard', 'hd'],\n          default: 'standard',\n          controlType: 'radio',\n        },\n        style: {\n          type: 'enum',\n          label: 'Style',\n          description: 'Image style: vivid (hyper-real) or natural',\n          enum: ['vivid', 'natural'],\n          default: 'vivid',\n          controlType: 'radio',\n        },\n      },\n    },\n    pricing: {\n      perImageStandard: 0.040,\n      perImageHD: 0.080,\n      currency: 'USD',\n    },\n  },\n\n  'dall-e-2': {\n    name: 'dall-e-2',\n    displayName: 'DALL-E 2',\n    provider: Vendor.OpenAI,\n    description: 'Fast image generation with editing and variation support',\n    isActive: true,\n    releaseDate: '2022-11-03',\n    deprecationDate: '2026-05-12',\n    sources: {\n      documentation: 'https://platform.openai.com/docs/guides/images',\n      pricing: 'https://openai.com/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      sizes: ['256x256', '512x512', '1024x1024'],\n      maxImagesPerRequest: 10,\n      outputFormats: ['png', 'url'],\n      features: {\n        generation: true,\n        editing: true,\n        variations: true,\n        styleControl: false,\n        qualityControl: false,\n        transparency: false,\n        promptRevision: false,\n      },\n      limits: { maxPromptLength: 1000 },\n      vendorOptions: {},\n    },\n    pricing: {\n      perImage: 0.020,\n      currency: 'USD',\n    },\n  },\n\n  // ======================== Google ========================\n\n  'imagen-4.0-generate-001': {\n    name: 'imagen-4.0-generate-001',\n    displayName: 'Imagen 4.0 Generate',\n    provider: Vendor.Google,\n    description: 'Google Imagen 4.0 - standard quality image generation',\n    isActive: true,\n    releaseDate: '2025-06-01',\n    sources: {\n      documentation: 'https://ai.google.dev/gemini-api/docs/imagen',\n      pricing: 'https://ai.google.dev/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      sizes: ['1024x1024'],\n      aspectRatios: ['1:1', '3:4', '4:3', '9:16', '16:9'],\n      maxImagesPerRequest: 4,\n      outputFormats: ['png', 'jpeg'],\n      features: {\n        generation: true,\n        editing: false,\n        variations: false,\n        styleControl: false,\n        qualityControl: false,\n        transparency: false,\n        promptRevision: false,\n      },\n      limits: { maxPromptLength: 480 },\n      vendorOptions: {\n        aspectRatio: {\n          type: 'enum',\n          label: 'Aspect Ratio',\n          description: 'Output image proportions',\n          enum: ['1:1', '3:4', '4:3', '16:9', '9:16'],\n          default: '1:1',\n          controlType: 'select',\n        },\n        sampleImageSize: {\n          type: 'enum',\n          label: 'Resolution',\n          description: 'Output image resolution',\n          enum: ['1K', '2K'],\n          default: '1K',\n          controlType: 'radio',\n        },\n        outputMimeType: {\n          type: 'enum',\n          label: 'Output Format',\n          description: 'Image file format',\n          enum: ['image/png', 'image/jpeg'],\n          default: 'image/png',\n          controlType: 'select',\n        },\n        negativePrompt: {\n          type: 'string',\n          label: 'Negative Prompt',\n          description: 'Elements to avoid in the generated image',\n          controlType: 'textarea',\n        },\n        personGeneration: {\n          type: 'enum',\n          label: 'Person Generation',\n          description: 'Controls whether people can appear in images',\n          enum: ['dont_allow', 'allow_adult', 'allow_all'],\n          default: 'allow_adult',\n          controlType: 'select',\n        },\n        safetyFilterLevel: {\n          type: 'enum',\n          label: 'Safety Filter',\n          description: 'Content safety filtering threshold',\n          enum: ['block_none', 'block_only_high', 'block_medium_and_above', 'block_low_and_above'],\n          default: 'block_medium_and_above',\n          controlType: 'select',\n        },\n        enhancePrompt: {\n          type: 'boolean',\n          label: 'Enhance Prompt',\n          description: 'Use LLM-based prompt rewriting for better quality',\n          default: true,\n          controlType: 'checkbox',\n        },\n        seed: {\n          type: 'number',\n          label: 'Seed',\n          description: 'Random seed for reproducible generation (1-2147483647)',\n          min: 1,\n          max: 2147483647,\n          controlType: 'text',\n        },\n        addWatermark: {\n          type: 'boolean',\n          label: 'Add Watermark',\n          description: 'Add invisible SynthID watermark',\n          default: true,\n          controlType: 'checkbox',\n        },\n        language: {\n          type: 'enum',\n          label: 'Prompt Language',\n          description: 'Language of the input prompt',\n          enum: ['auto', 'en', 'zh', 'zh-CN', 'zh-TW', 'hi', 'ja', 'ko', 'pt', 'es'],\n          default: 'en',\n          controlType: 'select',\n        },\n      },\n    },\n    pricing: {\n      perImage: 0.04,\n      currency: 'USD',\n    },\n  },\n\n  'imagen-4.0-ultra-generate-001': {\n    name: 'imagen-4.0-ultra-generate-001',\n    displayName: 'Imagen 4.0 Ultra',\n    provider: Vendor.Google,\n    description: 'Google Imagen 4.0 Ultra - highest quality image generation',\n    isActive: true,\n    releaseDate: '2025-06-01',\n    sources: {\n      documentation: 'https://ai.google.dev/gemini-api/docs/imagen',\n      pricing: 'https://ai.google.dev/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      sizes: ['1024x1024'],\n      aspectRatios: ['1:1', '3:4', '4:3', '9:16', '16:9'],\n      maxImagesPerRequest: 4,\n      outputFormats: ['png', 'jpeg'],\n      features: {\n        generation: true,\n        editing: false,\n        variations: false,\n        styleControl: false,\n        qualityControl: true,\n        transparency: false,\n        promptRevision: false,\n      },\n      limits: { maxPromptLength: 480 },\n      vendorOptions: {\n        aspectRatio: {\n          type: 'enum',\n          label: 'Aspect Ratio',\n          description: 'Output image proportions',\n          enum: ['1:1', '3:4', '4:3', '16:9', '9:16'],\n          default: '1:1',\n          controlType: 'select',\n        },\n        sampleImageSize: {\n          type: 'enum',\n          label: 'Resolution',\n          description: 'Output image resolution',\n          enum: ['1K', '2K'],\n          default: '1K',\n          controlType: 'radio',\n        },\n        outputMimeType: {\n          type: 'enum',\n          label: 'Output Format',\n          description: 'Image file format',\n          enum: ['image/png', 'image/jpeg'],\n          default: 'image/png',\n          controlType: 'select',\n        },\n        negativePrompt: {\n          type: 'string',\n          label: 'Negative Prompt',\n          description: 'Elements to avoid in the generated image',\n          controlType: 'textarea',\n        },\n        personGeneration: {\n          type: 'enum',\n          label: 'Person Generation',\n          description: 'Controls whether people can appear in images',\n          enum: ['dont_allow', 'allow_adult', 'allow_all'],\n          default: 'allow_adult',\n          controlType: 'select',\n        },\n        safetyFilterLevel: {\n          type: 'enum',\n          label: 'Safety Filter',\n          description: 'Content safety filtering threshold',\n          enum: ['block_none', 'block_only_high', 'block_medium_and_above', 'block_low_and_above'],\n          default: 'block_medium_and_above',\n          controlType: 'select',\n        },\n        enhancePrompt: {\n          type: 'boolean',\n          label: 'Enhance Prompt',\n          description: 'Use LLM-based prompt rewriting for better quality',\n          default: true,\n          controlType: 'checkbox',\n        },\n        seed: {\n          type: 'number',\n          label: 'Seed',\n          description: 'Random seed for reproducible generation (1-2147483647)',\n          min: 1,\n          max: 2147483647,\n          controlType: 'text',\n        },\n        addWatermark: {\n          type: 'boolean',\n          label: 'Add Watermark',\n          description: 'Add invisible SynthID watermark',\n          default: true,\n          controlType: 'checkbox',\n        },\n        language: {\n          type: 'enum',\n          label: 'Prompt Language',\n          description: 'Language of the input prompt',\n          enum: ['auto', 'en', 'zh', 'zh-CN', 'zh-TW', 'hi', 'ja', 'ko', 'pt', 'es'],\n          default: 'en',\n          controlType: 'select',\n        },\n      },\n    },\n    pricing: {\n      perImage: 0.08,\n      currency: 'USD',\n    },\n  },\n\n  'imagen-4.0-fast-generate-001': {\n    name: 'imagen-4.0-fast-generate-001',\n    displayName: 'Imagen 4.0 Fast',\n    provider: Vendor.Google,\n    description: 'Google Imagen 4.0 Fast - optimized for speed',\n    isActive: true,\n    releaseDate: '2025-06-01',\n    sources: {\n      documentation: 'https://ai.google.dev/gemini-api/docs/imagen',\n      pricing: 'https://ai.google.dev/pricing',\n      lastVerified: '2026-01-25',\n    },\n    capabilities: {\n      sizes: ['1024x1024'],\n      aspectRatios: ['1:1', '3:4', '4:3', '9:16', '16:9'],\n      maxImagesPerRequest: 4,\n      outputFormats: ['png', 'jpeg'],\n      features: {\n        generation: true,\n        editing: false,\n        variations: false,\n        styleControl: false,\n        qualityControl: false,\n        transparency: false,\n        promptRevision: false,\n      },\n      limits: { maxPromptLength: 480 },\n      vendorOptions: {\n        aspectRatio: {\n          type: 'enum',\n          label: 'Aspect Ratio',\n          description: 'Output image proportions',\n          enum: ['1:1', '3:4', '4:3', '16:9', '9:16'],\n          default: '1:1',\n          controlType: 'select',\n        },\n        sampleImageSize: {\n          type: 'enum',\n          label: 'Resolution',\n          description: 'Output image resolution',\n          enum: ['1K', '2K'],\n          default: '1K',\n          controlType: 'radio',\n        },\n        outputMimeType: {\n          type: 'enum',\n          label: 'Output Format',\n          description: 'Image file format',\n          enum: ['image/png', 'image/jpeg'],\n          default: 'image/png',\n          controlType: 'select',\n        },\n        negativePrompt: {\n          type: 'string',\n          label: 'Negative Prompt',\n          description: 'Elements to avoid in the generated image',\n          controlType: 'textarea',\n        },\n        personGeneration: {\n          type: 'enum',\n          label: 'Person Generation',\n          description: 'Controls whether people can appear in images',\n          enum: ['dont_allow', 'allow_adult', 'allow_all'],\n          default: 'allow_adult',\n          controlType: 'select',\n        },\n        safetyFilterLevel: {\n          type: 'enum',\n          label: 'Safety Filter',\n          description: 'Content safety filtering threshold',\n          enum: ['block_none', 'block_only_high', 'block_medium_and_above', 'block_low_and_above'],\n          default: 'block_medium_and_above',\n          controlType: 'select',\n        },\n        enhancePrompt: {\n          type: 'boolean',\n          label: 'Enhance Prompt',\n          description: 'Use LLM-based prompt rewriting for better quality',\n          default: true,\n          controlType: 'checkbox',\n        },\n        seed: {\n          type: 'number',\n          label: 'Seed',\n          description: 'Random seed for reproducible generation (1-2147483647)',\n          min: 1,\n          max: 2147483647,\n          controlType: 'text',\n        },\n        addWatermark: {\n          type: 'boolean',\n          label: 'Add Watermark',\n          description: 'Add invisible SynthID watermark',\n          default: true,\n          controlType: 'checkbox',\n        },\n        language: {\n          type: 'enum',\n          label: 'Prompt Language',\n          description: 'Language of the input prompt',\n          enum: ['auto', 'en', 'zh', 'zh-CN', 'zh-TW', 'hi', 'ja', 'ko', 'pt', 'es'],\n          default: 'en',\n          controlType: 'select',\n        },\n      },\n    },\n    pricing: {\n      perImage: 0.02,\n      currency: 'USD',\n    },\n  },\n\n  // ======================== xAI Grok ========================\n\n  'grok-imagine-image': {\n    name: 'grok-imagine-image',\n    displayName: 'Grok Imagine Image',\n    provider: Vendor.Grok,\n    description: 'xAI Grok Imagine image generation with aspect ratio control and editing support',\n    isActive: true,\n    releaseDate: '2025-01-01',\n    sources: {\n      documentation: 'https://docs.x.ai/docs/guides/image-generation',\n      pricing: 'https://docs.x.ai/docs/models',\n      lastVerified: '2026-02-01',\n    },\n    capabilities: {\n      sizes: ['1024x1024'],\n      aspectRatios: ['1:1', '4:3', '3:4', '16:9', '9:16', '3:2', '2:3'],\n      maxImagesPerRequest: 10,\n      outputFormats: ['png', 'jpeg'],\n      features: {\n        generation: true,\n        editing: true,\n        variations: false,\n        styleControl: false,\n        qualityControl: false, // quality not supported by xAI API\n        transparency: false,\n        promptRevision: true,\n      },\n      limits: { maxPromptLength: 4096 },\n      vendorOptions: {\n        n: {\n          type: 'number',\n          label: 'Number of Images',\n          description: 'Number of images to generate (1-10)',\n          min: 1,\n          max: 10,\n          default: 1,\n          controlType: 'slider',\n        },\n        response_format: {\n          type: 'enum',\n          label: 'Response Format',\n          description: 'Format of the returned image',\n          enum: ['url', 'b64_json'],\n          default: 'url',\n          controlType: 'radio',\n        },\n      },\n    },\n    pricing: {\n      perImage: 0.02,\n      currency: 'USD',\n    },\n  },\n\n  'grok-2-image-1212': {\n    name: 'grok-2-image-1212',\n    displayName: 'Grok 2 Image',\n    provider: Vendor.Grok,\n    description: 'xAI Grok 2 image generation (text-only input, no editing)',\n    isActive: true,\n    releaseDate: '2024-12-12',\n    sources: {\n      documentation: 'https://docs.x.ai/docs/guides/image-generation',\n      pricing: 'https://docs.x.ai/docs/models',\n      lastVerified: '2026-02-01',\n    },\n    capabilities: {\n      sizes: ['1024x1024'],\n      aspectRatios: ['1:1', '4:3', '3:4', '16:9', '9:16', '3:2', '2:3'],\n      maxImagesPerRequest: 10,\n      outputFormats: ['png', 'jpeg'],\n      features: {\n        generation: true,\n        editing: false,\n        variations: false,\n        styleControl: false,\n        qualityControl: false, // quality not supported by xAI API\n        transparency: false,\n        promptRevision: false,\n      },\n      limits: { maxPromptLength: 4096 },\n      vendorOptions: {\n        n: {\n          type: 'number',\n          label: 'Number of Images',\n          description: 'Number of images to generate (1-10)',\n          min: 1,\n          max: 10,\n          default: 1,\n          controlType: 'slider',\n        },\n        response_format: {\n          type: 'enum',\n          label: 'Response Format',\n          description: 'Format of the returned image',\n          enum: ['url', 'b64_json'],\n          default: 'url',\n          controlType: 'radio',\n        },\n      },\n    },\n    pricing: {\n      perImage: 0.07,\n      currency: 'USD',\n    },\n  },\n};\n\n// =============================================================================\n// Helper Functions (using shared utilities)\n// =============================================================================\n\nconst helpers = createRegistryHelpers(IMAGE_MODEL_REGISTRY);\n\nexport const getImageModelInfo = helpers.getInfo;\nexport const getImageModelsByVendor = helpers.getByVendor;\nexport const getActiveImageModels = helpers.getActive;\n\n/**\n * Get image models that support a specific feature\n */\nexport function getImageModelsWithFeature(\n  feature: keyof IImageModelDescription['capabilities']['features']\n): IImageModelDescription[] {\n  return Object.values(IMAGE_MODEL_REGISTRY).filter(\n    (model) => model.isActive && model.capabilities.features[feature]\n  );\n}\n\n/**\n * Calculate estimated cost for image generation\n */\nexport function calculateImageCost(\n  modelName: string,\n  imageCount: number,\n  quality: 'standard' | 'hd' = 'standard'\n): number | null {\n  const model = getImageModelInfo(modelName);\n  if (!model?.pricing) return null;\n\n  if (model.pricing.perImage) {\n    return imageCount * model.pricing.perImage;\n  }\n\n  const pricePerImage =\n    quality === 'hd' ? model.pricing.perImageHD : model.pricing.perImageStandard;\n\n  if (!pricePerImage) return null;\n  return imageCount * pricePerImage;\n}\n","/**\n * VideoGeneration - High-level video generation capability\n *\n * Provides a unified interface for generating videos across multiple vendors.\n * Supports text-to-video, image-to-video, and video extension.\n *\n * @example\n * ```typescript\n * import { VideoGeneration, Connector, Vendor } from '@everworker/oneringai';\n *\n * Connector.create({\n *   name: 'openai',\n *   vendor: Vendor.OpenAI,\n *   auth: { type: 'api_key', apiKey: process.env.OPENAI_API_KEY! },\n * });\n *\n * const videoGen = VideoGeneration.create({ connector: 'openai' });\n *\n * // Start video generation\n * const job = await videoGen.generate({\n *   prompt: 'A cinematic shot of a sunrise over mountains',\n *   duration: 8,\n *   resolution: '1280x720',\n * });\n *\n * // Wait for completion\n * const result = await videoGen.waitForCompletion(job.jobId);\n *\n * // Download the video\n * const videoBuffer = await videoGen.download(job.jobId);\n * ```\n */\n\nimport { Connector } from '../../core/Connector.js';\nimport { createVideoProvider } from '../../core/createVideoProvider.js';\nimport type {\n  IVideoProvider,\n  VideoGenerateOptions,\n  VideoExtendOptions,\n  VideoResponse,\n} from '../../domain/interfaces/IVideoProvider.js';\nimport { VIDEO_MODELS, getVideoModelInfo } from '../../domain/entities/VideoModel.js';\nimport { Vendor } from '../../core/Vendor.js';\nimport { ProviderError } from '../../domain/errors/AIErrors.js';\n\n/**\n * Options for creating a VideoGeneration instance\n */\nexport interface VideoGenerationCreateOptions {\n  /** Connector name or instance */\n  connector: string | Connector;\n}\n\n/**\n * Simplified options for quick generation\n */\nexport interface SimpleVideoGenerateOptions {\n  /** Text prompt describing the video */\n  prompt: string;\n  /** Model to use (defaults to vendor's best model) */\n  model?: string;\n  /** Duration in seconds */\n  duration?: number;\n  /** Output resolution (e.g., '1280x720', '1920x1080') */\n  resolution?: string;\n  /** Aspect ratio (alternative to resolution) */\n  aspectRatio?: '16:9' | '9:16' | '1:1' | '4:3' | '3:4';\n  /** Reference image for image-to-video */\n  image?: Buffer | string;\n  /** Seed for reproducibility */\n  seed?: number;\n  /** Vendor-specific options */\n  vendorOptions?: Record<string, unknown>;\n}\n\n/**\n * VideoGeneration capability class\n */\nexport class VideoGeneration {\n  private provider: IVideoProvider;\n  private connector: Connector;\n  private defaultModel: string;\n\n  private constructor(connector: Connector) {\n    this.connector = connector;\n    this.provider = createVideoProvider(connector);\n    this.defaultModel = this.getDefaultModel();\n  }\n\n  /**\n   * Create a VideoGeneration instance\n   */\n  static create(options: VideoGenerationCreateOptions): VideoGeneration {\n    const connector =\n      typeof options.connector === 'string'\n        ? Connector.get(options.connector)\n        : options.connector;\n\n    if (!connector) {\n      throw new Error(`Connector not found: ${options.connector}`);\n    }\n\n    return new VideoGeneration(connector);\n  }\n\n  /**\n   * Generate a video from a text prompt\n   * Returns a job that can be polled for completion\n   */\n  async generate(options: SimpleVideoGenerateOptions): Promise<VideoResponse> {\n    const fullOptions: VideoGenerateOptions = {\n      model: options.model || this.defaultModel,\n      prompt: options.prompt,\n      duration: options.duration,\n      resolution: options.resolution,\n      aspectRatio: options.aspectRatio,\n      image: options.image,\n      seed: options.seed,\n      vendorOptions: options.vendorOptions,\n    };\n\n    return this.provider.generateVideo(fullOptions);\n  }\n\n  /**\n   * Get the status of a video generation job\n   */\n  async getStatus(jobId: string): Promise<VideoResponse> {\n    return this.provider.getVideoStatus(jobId);\n  }\n\n  /**\n   * Wait for a video generation job to complete\n   */\n  async waitForCompletion(jobId: string, timeoutMs: number = 600000): Promise<VideoResponse> {\n    const startTime = Date.now();\n    const pollInterval = 10000; // 10 seconds\n\n    while (Date.now() - startTime < timeoutMs) {\n      const status = await this.provider.getVideoStatus(jobId);\n\n      if (status.status === 'completed') {\n        return status;\n      }\n\n      if (status.status === 'failed') {\n        throw new ProviderError(\n          this.connector.vendor || 'unknown',\n          `Video generation failed: ${status.error || 'Unknown error'}`\n        );\n      }\n\n      // Wait before next poll\n      await new Promise((resolve) => setTimeout(resolve, pollInterval));\n    }\n\n    throw new ProviderError(\n      this.connector.vendor || 'unknown',\n      `Video generation timed out after ${timeoutMs}ms`\n    );\n  }\n\n  /**\n   * Download a completed video\n   */\n  async download(jobId: string): Promise<Buffer> {\n    if (!this.provider.downloadVideo) {\n      throw new Error(`Video download not supported by ${this.provider.name}`);\n    }\n\n    return this.provider.downloadVideo(jobId);\n  }\n\n  /**\n   * Generate and wait for completion in one call\n   */\n  async generateAndWait(\n    options: SimpleVideoGenerateOptions,\n    timeoutMs: number = 600000\n  ): Promise<VideoResponse> {\n    const job = await this.generate(options);\n    return this.waitForCompletion(job.jobId, timeoutMs);\n  }\n\n  /**\n   * Extend an existing video\n   * Note: Not all models/vendors support this\n   */\n  async extend(options: VideoExtendOptions): Promise<VideoResponse> {\n    if (!this.provider.extendVideo) {\n      throw new Error(`Video extension not supported by ${this.provider.name}`);\n    }\n\n    const fullOptions: VideoExtendOptions = {\n      ...options,\n      model: options.model || this.getExtendModel(),\n    };\n\n    return this.provider.extendVideo(fullOptions);\n  }\n\n  /**\n   * Cancel a pending video generation job\n   */\n  async cancel(jobId: string): Promise<boolean> {\n    if (!this.provider.cancelJob) {\n      throw new Error(`Job cancellation not supported by ${this.provider.name}`);\n    }\n\n    return this.provider.cancelJob(jobId);\n  }\n\n  /**\n   * List available models for this provider\n   */\n  async listModels(): Promise<string[]> {\n    if (this.provider.listModels) {\n      return this.provider.listModels();\n    }\n\n    // Fallback to registry\n    const vendor = this.connector.vendor;\n    if (vendor && VIDEO_MODELS[vendor as keyof typeof VIDEO_MODELS]) {\n      return Object.values(VIDEO_MODELS[vendor as keyof typeof VIDEO_MODELS]);\n    }\n\n    return [];\n  }\n\n  /**\n   * Get information about a specific model\n   */\n  getModelInfo(modelName: string) {\n    return getVideoModelInfo(modelName);\n  }\n\n  /**\n   * Get the underlying provider\n   */\n  getProvider(): IVideoProvider {\n    return this.provider;\n  }\n\n  /**\n   * Get the current connector\n   */\n  getConnector(): Connector {\n    return this.connector;\n  }\n\n  /**\n   * Get the default model for this vendor\n   */\n  private getDefaultModel(): string {\n    const vendor = this.connector.vendor;\n\n    switch (vendor) {\n      case Vendor.OpenAI:\n        return VIDEO_MODELS[Vendor.OpenAI].SORA_2;\n      case Vendor.Google:\n        return VIDEO_MODELS[Vendor.Google].VEO_3_1;\n      case Vendor.Grok:\n        return VIDEO_MODELS[Vendor.Grok].GROK_IMAGINE_VIDEO;\n      default:\n        throw new Error(`No default video model for vendor: ${vendor}`);\n    }\n  }\n\n  /**\n   * Get the model that supports video extension\n   */\n  private getExtendModel(): string {\n    const vendor = this.connector.vendor;\n\n    switch (vendor) {\n      case Vendor.OpenAI:\n        return VIDEO_MODELS[Vendor.OpenAI].SORA_2;\n      case Vendor.Google:\n        return VIDEO_MODELS[Vendor.Google].VEO_3_1;\n      default:\n        throw new Error(`No extend model for vendor: ${vendor}`);\n    }\n  }\n}\n","/**\n * OpenAI Sora Video Generation Provider\n * Supports: sora-2, sora-2-pro\n */\n\nimport OpenAI from 'openai';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type {\n  IVideoProvider,\n  VideoGenerateOptions,\n  VideoExtendOptions,\n  VideoResponse,\n} from '../../../domain/interfaces/IVideoProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { OpenAIMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\nexport class OpenAISoraProvider extends BaseMediaProvider implements IVideoProvider {\n  readonly name: string = 'openai-video';\n  readonly vendor = 'openai' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: false,\n    videos: true,\n    audio: false,\n    features: {\n      videoGeneration: true,\n      imageToVideo: true,\n      videoExtension: true,\n    },\n  };\n\n  private client: OpenAI;\n\n  constructor(config: OpenAIMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.client = new OpenAI({\n      apiKey: config.auth.apiKey,\n      baseURL: config.baseURL,\n      organization: config.organization,\n      timeout: config.timeout,\n      maxRetries: config.maxRetries,\n    });\n  }\n\n  /**\n   * Generate a video from a text prompt\n   */\n  async generateVideo(options: VideoGenerateOptions): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.generate', {\n            model: options.model,\n            duration: options.duration,\n            resolution: options.resolution,\n          });\n\n          const model = (options.model || 'sora-2') as\n            | 'sora-2'\n            | 'sora-2-pro'\n            | 'sora-2-2025-10-06'\n            | 'sora-2-pro-2025-10-06'\n            | 'sora-2-2025-12-08';\n\n          // Map duration to SDK's seconds parameter (string: '4', '8', '12')\n          const seconds = this.durationToSeconds(options.duration || 4);\n\n          // Build request parameters matching OpenAI SDK 6.x VideoCreateParams\n          const params: {\n            prompt: string;\n            model?: typeof model;\n            seconds?: '4' | '8' | '12';\n            size?: '720x1280' | '1280x720' | '1024x1792' | '1792x1024';\n            input_reference?: any;\n          } = {\n            prompt: options.prompt,\n            model,\n            seconds,\n          };\n\n          // Map resolution to SDK's size parameter\n          if (options.resolution) {\n            params.size = this.resolutionToSize(options.resolution);\n          } else if (options.aspectRatio) {\n            params.size = this.aspectRatioToSize(options.aspectRatio);\n          }\n\n          // Add image for image-to-video (input_reference)\n          if (options.image) {\n            params.input_reference = await this.prepareImageInput(options.image);\n          }\n\n          // Call the OpenAI Videos API\n          const response = await this.client.videos.create(params);\n\n          this.logOperationComplete('video.generate', {\n            model,\n            jobId: response.id,\n            status: response.status,\n          });\n\n          return this.mapResponse(response);\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.generate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Get the status of a video generation job\n   */\n  async getVideoStatus(jobId: string): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.status', { jobId });\n\n          const response = await this.client.videos.retrieve(jobId);\n\n          this.logOperationComplete('video.status', {\n            jobId,\n            status: response.status,\n            progress: response.progress,\n          });\n\n          return this.mapResponse(response);\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.status',\n      { jobId }\n    );\n  }\n\n  /**\n   * Download a completed video\n   */\n  async downloadVideo(jobId: string): Promise<Buffer> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.download', { jobId });\n\n          // First check status\n          const statusResponse = await this.getVideoStatus(jobId);\n          if (statusResponse.status !== 'completed') {\n            throw new ProviderError('openai', `Video not ready. Status: ${statusResponse.status}`);\n          }\n\n          // Use the SDK's downloadContent method\n          const response = await this.client.videos.downloadContent(jobId, { variant: 'video' });\n\n          // Convert Response to Buffer\n          const arrayBuffer = await response.arrayBuffer();\n          const buffer = Buffer.from(arrayBuffer);\n\n          this.logOperationComplete('video.download', {\n            jobId,\n            size: buffer.length,\n          });\n\n          return buffer;\n        } catch (error: any) {\n          if (error instanceof ProviderError) throw error;\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.download',\n      { jobId }\n    );\n  }\n\n  /**\n   * Extend/remix an existing video\n   * Note: OpenAI SDK uses 'remix' instead of 'extend'\n   */\n  async extendVideo(options: VideoExtendOptions): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.extend', {\n            model: options.model,\n            extendDuration: options.extendDuration,\n            direction: options.direction,\n          });\n\n          // Get the video ID - for remix, we need a video ID not buffer\n          let videoId: string;\n          if (typeof options.video === 'string' && !options.video.startsWith('http')) {\n            // Assume it's a video ID\n            videoId = options.video;\n          } else {\n            throw new ProviderError(\n              'openai',\n              'Video extension requires a video ID. Upload the video first or provide the job ID.'\n            );\n          }\n\n          // Use the remix endpoint with a prompt\n          const prompt = options.prompt || 'Extend this video seamlessly';\n          const response = await this.client.videos.remix(videoId, { prompt });\n\n          this.logOperationComplete('video.extend', {\n            jobId: response.id,\n            status: response.status,\n          });\n\n          return this.mapResponse(response);\n        } catch (error: any) {\n          if (error instanceof ProviderError) throw error;\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.extend',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * List available video models\n   */\n  async listModels(): Promise<string[]> {\n    return ['sora-2', 'sora-2-pro'];\n  }\n\n  /**\n   * Cancel/delete a pending job\n   */\n  async cancelJob(jobId: string): Promise<boolean> {\n    try {\n      const response = await this.client.videos.delete(jobId);\n      return response.deleted;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Map OpenAI SDK Video response to our VideoResponse format\n   */\n  private mapResponse(response: OpenAI.Videos.Video): VideoResponse {\n    const result: VideoResponse = {\n      jobId: response.id,\n      status: this.mapStatus(response.status),\n      created: response.created_at,\n      progress: response.progress,\n    };\n\n    // Video completed - SDK doesn't have video URL directly,\n    // use downloadContent to get the actual video\n    if (response.status === 'completed') {\n      result.video = {\n        duration: this.secondsStringToNumber(response.seconds),\n        resolution: response.size,\n        format: 'mp4',\n      };\n    }\n\n    if (response.status === 'failed' && response.error) {\n      result.error = response.error.message || 'Video generation failed';\n    }\n\n    return result;\n  }\n\n  /**\n   * Map OpenAI status to our status type\n   */\n  private mapStatus(status: string): 'pending' | 'processing' | 'completed' | 'failed' {\n    switch (status) {\n      case 'queued':\n      case 'pending':\n        return 'pending';\n      case 'in_progress':\n      case 'processing':\n        return 'processing';\n      case 'completed':\n      case 'succeeded':\n        return 'completed';\n      case 'failed':\n      case 'cancelled':\n        return 'failed';\n      default:\n        return 'pending';\n    }\n  }\n\n  /**\n   * Convert duration number to SDK's seconds string format\n   */\n  private durationToSeconds(duration: number): '4' | '8' | '12' {\n    if (duration <= 4) return '4';\n    if (duration <= 8) return '8';\n    return '12';\n  }\n\n  /**\n   * Convert seconds string back to number\n   */\n  private secondsStringToNumber(seconds: string): number {\n    return parseInt(seconds, 10) || 4;\n  }\n\n  /**\n   * Map resolution string to SDK's size format\n   */\n  private resolutionToSize(resolution: string): '720x1280' | '1280x720' | '1024x1792' | '1792x1024' {\n    const validSizes = ['720x1280', '1280x720', '1024x1792', '1792x1024'] as const;\n    if (validSizes.includes(resolution as any)) {\n      return resolution as '720x1280' | '1280x720' | '1024x1792' | '1792x1024';\n    }\n    // Default to portrait\n    return '720x1280';\n  }\n\n  /**\n   * Map aspect ratio to SDK's size format\n   */\n  private aspectRatioToSize(aspectRatio: string): '720x1280' | '1280x720' | '1024x1792' | '1792x1024' {\n    const map: Record<string, '720x1280' | '1280x720' | '1024x1792' | '1792x1024'> = {\n      '16:9': '1280x720',\n      '9:16': '720x1280',\n      '9:16-tall': '1024x1792',\n      '16:9-tall': '1792x1024',\n    };\n    return map[aspectRatio] || '720x1280';\n  }\n\n  /**\n   * Prepare image input for API (input_reference)\n   */\n  private async prepareImageInput(image: Buffer | string): Promise<any> {\n    if (Buffer.isBuffer(image)) {\n      // Create a File-like object from buffer\n      return new File([new Uint8Array(image)], 'input.png', { type: 'image/png' });\n    }\n\n    // If it's a file path, read it\n    if (!image.startsWith('http')) {\n      const fs = await import('fs');\n      const data = fs.readFileSync(image);\n      return new File([new Uint8Array(data)], 'input.png', { type: 'image/png' });\n    }\n\n    // For URLs, fetch and convert to File\n    const response = await fetch(image);\n    const arrayBuffer = await response.arrayBuffer();\n    return new File([new Uint8Array(arrayBuffer)], 'input.png', { type: 'image/png' });\n  }\n\n  /**\n   * Handle OpenAI API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown OpenAI API error';\n    const status = error.status;\n\n    if (status === 401) {\n      throw new ProviderAuthError('openai', 'Invalid API key');\n    }\n\n    if (status === 429) {\n      throw new ProviderRateLimitError('openai', message);\n    }\n\n    if (status === 400) {\n      if (message.includes('safety') || message.includes('policy')) {\n        throw new ProviderError('openai', `Content policy violation: ${message}`);\n      }\n      throw new ProviderError('openai', `Bad request: ${message}`);\n    }\n\n    throw new ProviderError('openai', message);\n  }\n}\n","/**\n * Google Veo Video Generation Provider\n * Supports: veo-2.0, veo-3.0, veo-3.0-fast, veo-3.1\n */\n\nimport { GoogleGenAI } from '@google/genai';\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type {\n  IVideoProvider,\n  VideoGenerateOptions,\n  VideoExtendOptions,\n  VideoResponse,\n  VideoStatus,\n} from '../../../domain/interfaces/IVideoProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { GoogleMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\n/**\n * Google Veo-specific options\n */\nexport interface GoogleVeoOptions {\n  /** Negative prompt (what to avoid) */\n  negativePrompt?: string;\n  /** Last frame image for interpolation */\n  lastFrame?: Buffer | string;\n  /** Person generation mode */\n  personGeneration?: 'dont_allow' | 'allow_adult' | 'allow_all';\n  /** Safety filter level */\n  safetyFilterLevel?: 'block_low_and_above' | 'block_medium_and_above' | 'block_only_high';\n}\n\nexport class GoogleVeoProvider extends BaseMediaProvider implements IVideoProvider {\n  readonly name: string = 'google-video';\n  readonly vendor = 'google' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: false,\n    videos: true,\n    audio: false,\n    features: {\n      videoGeneration: true,\n      imageToVideo: true,\n      videoExtension: true,\n    },\n  };\n\n  private client: GoogleGenAI;\n  private pendingOperations: Map<string, any> = new Map();\n\n  constructor(config: GoogleMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.client = new GoogleGenAI({\n      apiKey: config.auth.apiKey,\n    });\n  }\n\n  /**\n   * Generate a video from a text prompt\n   */\n  async generateVideo(options: VideoGenerateOptions): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.generate', {\n            model: options.model,\n            duration: options.duration,\n            resolution: options.resolution,\n          });\n\n          const model = options.model || 'veo-3.1-generate-preview';\n          const googleOptions = (options.vendorOptions || {}) as GoogleVeoOptions;\n\n          // Build config\n          const config: any = {};\n\n          // Aspect ratio\n          if (options.aspectRatio) {\n            config.aspectRatio = options.aspectRatio;\n          }\n\n          // Resolution\n          if (options.resolution) {\n            config.resolution = options.resolution;\n          }\n\n          // Duration - must be a number, not string\n          if (options.duration) {\n            config.durationSeconds = options.duration;\n          }\n\n          // Seed\n          if (options.seed !== undefined) {\n            config.seed = options.seed;\n          }\n\n          // Negative prompt\n          if (googleOptions.negativePrompt) {\n            config.negativePrompt = googleOptions.negativePrompt;\n          }\n\n          // Person generation setting\n          if (googleOptions.personGeneration) {\n            config.personGeneration = googleOptions.personGeneration;\n          }\n\n          // Safety filter level\n          if (googleOptions.safetyFilterLevel) {\n            config.safetyFilterLevel = googleOptions.safetyFilterLevel;\n          }\n\n          // Build request\n          const request: any = {\n            model,\n            prompt: options.prompt,\n            config,\n          };\n\n          // Add image for image-to-video\n          if (options.image) {\n            request.image = await this.prepareImageInput(options.image);\n          }\n\n          // Add last frame if specified\n          if (googleOptions.lastFrame) {\n            request.lastFrame = await this.prepareImageInput(googleOptions.lastFrame);\n          }\n\n          // Start video generation (returns an operation)\n          const operation = await (this.client.models as any).generateVideos(request);\n\n          // Store operation for polling\n          const jobId = this.extractJobId(operation);\n          this.pendingOperations.set(jobId, operation);\n\n          this.logOperationComplete('video.generate', {\n            model,\n            jobId,\n            status: 'pending',\n          });\n\n          return {\n            jobId,\n            status: 'pending',\n            created: Math.floor(Date.now() / 1000),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.generate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Get the status of a video generation job\n   */\n  async getVideoStatus(jobId: string): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.status', { jobId });\n\n          // Get stored operation\n          let operation = this.pendingOperations.get(jobId);\n\n          if (!operation) {\n            // Try to retrieve by operation name\n            try {\n              operation = await (this.client as any).operations.getVideosOperation({\n                operation: { name: jobId },\n              });\n            } catch {\n              throw new ProviderError('google', `Video job not found: ${jobId}`);\n            }\n          }\n\n          // Poll for status update\n          operation = await (this.client as any).operations.getVideosOperation({\n            operation,\n          });\n\n          // Update stored operation\n          this.pendingOperations.set(jobId, operation);\n\n          const response = this.mapResponse(jobId, operation);\n\n          this.logOperationComplete('video.status', {\n            jobId,\n            status: response.status,\n          });\n\n          // Note: Don't clean up here - downloadVideo() needs the operation\n          // Cleanup happens in downloadVideo() after successful download\n\n          return response;\n        } catch (error: any) {\n          if (error instanceof ProviderError) throw error;\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.status',\n      { jobId }\n    );\n  }\n\n  /**\n   * Download a completed video\n   */\n  async downloadVideo(jobId: string): Promise<Buffer> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.download', { jobId });\n\n          // Get status to ensure completion\n          const status = await this.getVideoStatus(jobId);\n          if (status.status !== 'completed') {\n            throw new ProviderError('google', `Video not ready. Status: ${status.status}`);\n          }\n\n          // Get the operation\n          const operation = this.pendingOperations.get(jobId);\n          if (!operation?.response?.generatedVideos?.[0]?.video) {\n            throw new ProviderError('google', 'No video available for download');\n          }\n\n          const video = operation.response.generatedVideos[0].video;\n          let buffer: Buffer;\n\n          // Option 1: Check if videoBytes is available directly (base64)\n          if (video.videoBytes) {\n            buffer = Buffer.from(video.videoBytes, 'base64');\n          }\n          // Option 2: Use files.download() with a temp file\n          else if (video.uri) {\n            const fs = await import('fs/promises');\n            const os = await import('os');\n            const path = await import('path');\n\n            // Create temp file path\n            const tempDir = os.tmpdir();\n            const tempFile = path.join(tempDir, `veo-${Date.now()}.mp4`);\n\n            try {\n              // Download to temp file using SDK\n              await this.client.files.download({\n                file: { video }, // Pass as GeneratedVideo\n                downloadPath: tempFile,\n              });\n\n              // Read temp file into buffer\n              buffer = await fs.readFile(tempFile);\n\n              // Clean up temp file\n              await fs.unlink(tempFile).catch(() => {});\n            } catch (downloadError: any) {\n              // Clean up temp file on error\n              await fs.unlink(tempFile).catch(() => {});\n              throw new ProviderError(\n                'google',\n                `Failed to download video: ${downloadError.message}`\n              );\n            }\n          } else {\n            throw new ProviderError(\n              'google',\n              'No videoBytes or uri available for download'\n            );\n          }\n\n          this.logOperationComplete('video.download', {\n            jobId,\n            size: buffer.length,\n          });\n\n          // Clean up after successful download\n          this.pendingOperations.delete(jobId);\n\n          return buffer;\n        } catch (error: any) {\n          if (error instanceof ProviderError) throw error;\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.download',\n      { jobId }\n    );\n  }\n\n  /**\n   * Extend an existing video (Veo 3.1 supports this)\n   */\n  async extendVideo(options: VideoExtendOptions): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.extend', {\n            model: options.model,\n            extendDuration: options.extendDuration,\n          });\n\n          const model = options.model || 'veo-3.1-generate-preview';\n\n          // Video extension in Veo is done by providing the last frame\n          // of the existing video and generating a continuation\n          const request: any = {\n            model,\n            prompt: options.prompt || 'Continue the video seamlessly',\n            config: {\n              durationSeconds: String(options.extendDuration),\n            },\n          };\n\n          // Extract last frame from video or use video as input\n          if (Buffer.isBuffer(options.video)) {\n            // For buffer input, we'd need to extract the last frame\n            // This is a simplified implementation\n            request.image = {\n              imageBytes: options.video.toString('base64'),\n            };\n          } else {\n            request.video = { uri: options.video };\n          }\n\n          const operation = await (this.client.models as any).generateVideos(request);\n\n          const jobId = this.extractJobId(operation);\n          this.pendingOperations.set(jobId, operation);\n\n          this.logOperationComplete('video.extend', {\n            jobId,\n            status: 'pending',\n          });\n\n          return {\n            jobId,\n            status: 'pending',\n            created: Math.floor(Date.now() / 1000),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.extend',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * List available video models\n   */\n  async listModels(): Promise<string[]> {\n    return [\n      'veo-2.0-generate-001',\n      'veo-3.1-fast-generate-preview',\n      'veo-3.1-generate-preview',\n    ];\n  }\n\n  /**\n   * Wait for video completion with polling\n   */\n  async waitForCompletion(jobId: string, timeoutMs: number = 600000): Promise<VideoResponse> {\n    const startTime = Date.now();\n    const pollInterval = 10000; // 10 seconds\n\n    while (Date.now() - startTime < timeoutMs) {\n      const status = await this.getVideoStatus(jobId);\n\n      if (status.status === 'completed' || status.status === 'failed') {\n        return status;\n      }\n\n      // Wait before next poll\n      await new Promise((resolve) => setTimeout(resolve, pollInterval));\n    }\n\n    throw new ProviderError('google', `Video generation timed out after ${timeoutMs}ms`);\n  }\n\n  /**\n   * Extract job ID from operation\n   */\n  private extractJobId(operation: any): string {\n    if (operation.name) {\n      return operation.name;\n    }\n    // Generate a unique ID if not available\n    return `veo-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Prepare image input for API\n   */\n  private async prepareImageInput(image: Buffer | string): Promise<any> {\n    if (Buffer.isBuffer(image)) {\n      return {\n        imageBytes: image.toString('base64'),\n      };\n    }\n\n    // Check if it's a URL or file path\n    if (image.startsWith('http://') || image.startsWith('https://')) {\n      return { imageUri: image };\n    }\n\n    // Read from file path\n    const fs = await import('fs/promises');\n    const data = await fs.readFile(image);\n    return {\n      imageBytes: data.toString('base64'),\n    };\n  }\n\n  /**\n   * Map operation to VideoResponse\n   */\n  private mapResponse(jobId: string, operation: any): VideoResponse {\n    const result: VideoResponse = {\n      jobId,\n      status: this.mapStatus(operation),\n      created: Math.floor(Date.now() / 1000),\n    };\n\n    if (operation.done && operation.response?.generatedVideos?.[0]) {\n      const video = operation.response.generatedVideos[0];\n      result.video = {\n        duration: video.video?.duration,\n        format: 'mp4',\n      };\n\n      // URL may be available through the file reference\n      if (video.video?.uri) {\n        result.video.url = video.video.uri;\n      }\n    }\n\n    if (operation.error) {\n      result.error = operation.error.message || 'Video generation failed';\n      result.status = 'failed';\n    }\n\n    return result;\n  }\n\n  /**\n   * Map operation status to our status type\n   */\n  private mapStatus(operation: any): VideoStatus {\n    if (operation.error) {\n      return 'failed';\n    }\n    if (operation.done) {\n      return 'completed';\n    }\n    if (operation.metadata?.state === 'ACTIVE' || operation.metadata?.state === 'PROCESSING') {\n      return 'processing';\n    }\n    return 'pending';\n  }\n\n  /**\n   * Handle Google API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown Google API error';\n    const status = error.status || error.code;\n\n    if (status === 401 || status === 403 || message.includes('API key')) {\n      throw new ProviderAuthError('google', 'Invalid API key');\n    }\n\n    if (status === 429 || message.includes('quota') || message.includes('rate')) {\n      throw new ProviderRateLimitError('google', message);\n    }\n\n    if (status === 400) {\n      if (message.includes('safety') || message.includes('blocked')) {\n        throw new ProviderError('google', `Content policy violation: ${message}`);\n      }\n      throw new ProviderError('google', `Bad request: ${message}`);\n    }\n\n    throw new ProviderError('google', message);\n  }\n}\n","/**\n * Grok (xAI) Imagine Video Generation Provider\n * Implements async job-based video generation via direct HTTP calls\n * Based on xAI API Reference: https://docs.x.ai/docs/api-reference#video-generation\n * Supports: grok-imagine-video\n */\n\nimport { BaseMediaProvider } from '../base/BaseMediaProvider.js';\nimport type {\n  IVideoProvider,\n  VideoGenerateOptions,\n  VideoResponse,\n} from '../../../domain/interfaces/IVideoProvider.js';\nimport type { ProviderCapabilities } from '../../../domain/interfaces/IProvider.js';\nimport type { GrokMediaConfig } from '../../../domain/types/ProviderConfig.js';\nimport {\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\n\nconst GROK_API_BASE_URL = 'https://api.x.ai/v1';\n\n/**\n * xAI video generation request (POST /v1/videos/generations)\n * Based on actual API spec\n */\ninterface GrokVideoRequest {\n  prompt: string;\n  model?: string | null;\n  duration?: number | null; // Range: 1-15, default: 6\n  aspect_ratio?: string | null;\n  resolution?: string | null;\n  size?: string | null;\n  image?: { url: string; detail?: string | null } | null;\n  output?: { upload_url: string } | null;\n  user?: string | null;\n}\n\n/**\n * xAI video generation response (POST /v1/videos/generations)\n */\ninterface GrokVideoCreateResponse {\n  request_id: string;\n}\n\n/**\n * xAI video status response (GET /v1/videos/{request_id})\n *\n * When pending: { status: 'pending' }\n * When complete: { video: { url, duration, respect_moderation }, model: string }\n * (no 'status' field when complete - presence of 'video' indicates completion)\n */\ninterface GrokVideoStatusResponse {\n  // Only present when job is still pending\n  status?: 'pending';\n  // Present when job is complete\n  model?: string;\n  video?: {\n    url: string;\n    duration: number;\n    respect_moderation: boolean;\n  };\n}\n\nexport class GrokImagineProvider extends BaseMediaProvider implements IVideoProvider {\n  readonly name: string = 'grok-video';\n  readonly vendor = 'grok' as const;\n  readonly capabilities: ProviderCapabilities = {\n    text: false,\n    images: false,\n    videos: true,\n    audio: false,\n    features: {\n      videoGeneration: true,\n      imageToVideo: true,\n    },\n  };\n\n  private apiKey: string;\n  private baseURL: string;\n  private timeout: number;\n\n  constructor(config: GrokMediaConfig) {\n    super({ apiKey: config.auth.apiKey, ...config });\n\n    this.apiKey = config.auth.apiKey;\n    this.baseURL = config.baseURL || GROK_API_BASE_URL;\n    this.timeout = config.timeout || 60000;\n  }\n\n  /**\n   * Generate a video from a text prompt\n   */\n  async generateVideo(options: VideoGenerateOptions): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.generate', {\n            model: options.model,\n            duration: options.duration,\n            resolution: options.resolution,\n            aspectRatio: options.aspectRatio,\n          });\n\n          const request: GrokVideoRequest = {\n            prompt: options.prompt,\n            model: options.model || 'grok-imagine-video',\n            duration: options.duration || 6,\n          };\n\n          // Handle aspect ratio\n          if (options.aspectRatio) {\n            request.aspect_ratio = options.aspectRatio;\n          }\n\n          // Handle resolution\n          if (options.resolution) {\n            request.resolution = options.resolution;\n          }\n\n          // Handle image-to-video - xAI expects { url: \"...\" } object\n          if (options.image) {\n            const imageUrl = await this.prepareImageUrl(options.image);\n            request.image = { url: imageUrl };\n          }\n\n          const response = await this.makeRequest<GrokVideoCreateResponse>(\n            'POST',\n            '/videos/generations',\n            request\n          );\n\n          this.logOperationComplete('video.generate', {\n            model: options.model,\n            jobId: response.request_id,\n          });\n\n          // Initial response only has request_id - return as pending job\n          return {\n            jobId: response.request_id,\n            status: 'pending' as const,\n            created: Date.now(),\n          };\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.generate',\n      { model: options.model }\n    );\n  }\n\n  /**\n   * Get the status of a video generation job\n   */\n  async getVideoStatus(jobId: string): Promise<VideoResponse> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.status', { jobId });\n\n          const response = await this.makeRequest<GrokVideoStatusResponse>(\n            'GET',\n            `/videos/${jobId}`\n          );\n\n          this.logOperationComplete('video.status', {\n            jobId,\n            status: response.video ? 'done' : response.status || 'pending',\n            hasVideo: !!response.video?.url,\n          });\n\n          return this.mapStatusResponse(response, jobId);\n        } catch (error: any) {\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.status',\n      { jobId }\n    );\n  }\n\n  /**\n   * Download a completed video\n   */\n  async downloadVideo(jobId: string): Promise<Buffer> {\n    return this.executeWithCircuitBreaker(\n      async () => {\n        try {\n          this.logOperationStart('video.download', { jobId });\n\n          // First check status\n          const statusResponse = await this.getVideoStatus(jobId);\n          if (statusResponse.status !== 'completed') {\n            throw new ProviderError('grok', `Video not ready. Status: ${statusResponse.status}`);\n          }\n\n          if (!statusResponse.video?.url) {\n            throw new ProviderError('grok', 'No video URL available');\n          }\n\n          // Download the video\n          const response = await fetch(statusResponse.video.url);\n          if (!response.ok) {\n            throw new ProviderError('grok', `Failed to download video: ${response.statusText}`);\n          }\n\n          const arrayBuffer = await response.arrayBuffer();\n          const buffer = Buffer.from(arrayBuffer);\n\n          this.logOperationComplete('video.download', {\n            jobId,\n            size: buffer.length,\n          });\n\n          return buffer;\n        } catch (error: any) {\n          if (error instanceof ProviderError) throw error;\n          this.handleError(error);\n          throw error;\n        }\n      },\n      'video.download',\n      { jobId }\n    );\n  }\n\n  /**\n   * List available video models\n   */\n  async listModels(): Promise<string[]> {\n    return ['grok-imagine-video'];\n  }\n\n  /**\n   * Cancel a pending video generation job\n   */\n  async cancelJob(jobId: string): Promise<boolean> {\n    try {\n      await this.makeRequest('DELETE', `/videos/${jobId}`);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Make HTTP request to xAI API\n   */\n  private async makeRequest<T>(\n    method: string,\n    endpoint: string,\n    body?: any\n  ): Promise<T> {\n    const url = `${this.baseURL}${endpoint}`;\n\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n\n    try {\n      const headers: Record<string, string> = {\n        'Authorization': `Bearer ${this.apiKey}`,\n        'Accept': 'application/json',\n      };\n\n      // Only add Content-Type for requests with body\n      if (body) {\n        headers['Content-Type'] = 'application/json';\n      }\n\n      const response = await fetch(url, {\n        method,\n        headers,\n        body: body ? JSON.stringify(body) : undefined,\n        signal: controller.signal,\n      });\n\n      clearTimeout(timeoutId);\n\n      if (!response.ok) {\n        const errorBody = await response.json().catch(() => ({}));\n        // xAI may return error in different formats\n        const errorMessage = errorBody.error?.message || errorBody.message || errorBody.detail || JSON.stringify(errorBody) || `HTTP ${response.status}`;\n        const error = new Error(errorMessage);\n        (error as any).status = response.status;\n        (error as any).body = errorBody;\n        throw error;\n      }\n\n      return response.json();\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n\n  /**\n   * Map xAI status response to our VideoResponse format\n   *\n   * xAI API response format:\n   * - Pending: { status: 'pending' }\n   * - Complete: { video: { url, duration, respect_moderation }, model: string }\n   *   (no 'status' field when complete)\n   */\n  private mapStatusResponse(response: GrokVideoStatusResponse, jobId: string): VideoResponse {\n    // Map xAI status to our status\n    let status: 'pending' | 'processing' | 'completed' | 'failed';\n\n    // Presence of video object indicates completion\n    if (response.video) {\n      // Check if moderation blocked the video\n      if (response.video.respect_moderation === false) {\n        status = 'failed';\n      } else if (response.video.url) {\n        status = 'completed';\n      } else {\n        status = 'failed';\n      }\n    } else {\n      // No video = still processing\n      status = 'processing';\n    }\n\n    const result: VideoResponse = {\n      jobId,\n      status,\n      created: Date.now(),\n    };\n\n    // Add video data if completed\n    if (status === 'completed' && response.video) {\n      result.video = {\n        url: response.video.url,\n        duration: response.video.duration,\n        format: 'mp4',\n      };\n    }\n\n    // Add error if moderation blocked\n    if (response.video?.respect_moderation === false) {\n      result.error = 'Video blocked by content moderation';\n    }\n\n    return result;\n  }\n\n  /**\n   * Prepare image URL for image-to-video\n   * xAI expects image.url - can be http(s) URL or data URL\n   */\n  private async prepareImageUrl(image: Buffer | string): Promise<string> {\n    // If it's a Buffer, convert to data URL\n    if (Buffer.isBuffer(image)) {\n      const base64 = image.toString('base64');\n      return `data:image/png;base64,${base64}`;\n    }\n\n    // If it's already a URL (http or data URL), use as-is\n    if (image.startsWith('http') || image.startsWith('data:')) {\n      return image;\n    }\n\n    // If it's a file path, read and convert to data URL\n    const fs = await import('fs');\n    const data = fs.readFileSync(image);\n    const base64 = data.toString('base64');\n    // Try to detect image type from extension\n    const ext = image.split('.').pop()?.toLowerCase() || 'png';\n    const mimeType = ext === 'jpg' || ext === 'jpeg' ? 'image/jpeg' : `image/${ext}`;\n    return `data:${mimeType};base64,${base64}`;\n  }\n\n  /**\n   * Handle API errors\n   */\n  private handleError(error: any): never {\n    const message = error.message || 'Unknown Grok API error';\n    const status = error.status;\n\n    if (status === 401) {\n      throw new ProviderAuthError('grok', 'Invalid API key');\n    }\n\n    if (status === 429) {\n      throw new ProviderRateLimitError('grok', message);\n    }\n\n    if (status === 400) {\n      if (message.includes('safety') || message.includes('policy') || message.includes('moderation')) {\n        throw new ProviderError('grok', `Content policy violation: ${message}`);\n      }\n      throw new ProviderError('grok', `Bad request: ${message}`);\n    }\n\n    if (status === 422) {\n      throw new ProviderError('grok', `Validation error: ${message}`);\n    }\n\n    if (status === 404) {\n      throw new ProviderError('grok', `Not found: ${message}`);\n    }\n\n    throw new ProviderError('grok', message);\n  }\n}\n","/**\n * Factory for creating video providers from connectors\n */\n\nimport { Connector } from './Connector.js';\nimport { Vendor } from './Vendor.js';\nimport type { IVideoProvider } from '../domain/interfaces/IVideoProvider.js';\nimport type { OpenAIMediaConfig, GoogleMediaConfig, GrokMediaConfig } from '../domain/types/ProviderConfig.js';\nimport { OpenAISoraProvider } from '../infrastructure/providers/openai/OpenAISoraProvider.js';\nimport { GoogleVeoProvider } from '../infrastructure/providers/google/GoogleVeoProvider.js';\nimport { GrokImagineProvider } from '../infrastructure/providers/grok/GrokImagineProvider.js';\n/**\n * Create a video provider from a connector\n */\nexport function createVideoProvider(connector: Connector): IVideoProvider {\n  const vendor = connector.vendor;\n\n  switch (vendor) {\n    case Vendor.OpenAI:\n      return new OpenAISoraProvider(extractOpenAIConfig(connector));\n\n    case Vendor.Google:\n      return new GoogleVeoProvider(extractGoogleConfig(connector));\n\n    case Vendor.Grok:\n      return new GrokImagineProvider(extractGrokConfig(connector));\n\n    default:\n      throw new Error(\n        `Video generation not supported for vendor: ${vendor}. ` +\n          `Supported vendors: ${Vendor.OpenAI}, ${Vendor.Google}, ${Vendor.Grok}`\n      );\n  }\n}\n\n/**\n * Extract OpenAI configuration from connector\n */\nfunction extractOpenAIConfig(connector: Connector): OpenAIMediaConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('OpenAI requires API key authentication');\n  }\n\n  const options = connector.getOptions();\n\n  return {\n    auth: {\n      type: 'api_key',\n      apiKey: auth.apiKey,\n    },\n    baseURL: connector.baseURL,\n    organization: options.organization as string | undefined,\n    timeout: options.timeout as number | undefined,\n    maxRetries: options.maxRetries as number | undefined,\n  };\n}\n\n/**\n * Extract Google configuration from connector\n */\nfunction extractGoogleConfig(connector: Connector): GoogleMediaConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('Google requires API key authentication');\n  }\n\n  const options = connector.getOptions();\n\n  return {\n    auth: {\n      type: 'api_key',\n      apiKey: auth.apiKey,\n    },\n    timeout: options.timeout as number | undefined,\n    maxRetries: options.maxRetries as number | undefined,\n  };\n}\n\n/**\n * Extract Grok configuration from connector\n */\nfunction extractGrokConfig(connector: Connector): GrokMediaConfig {\n  const auth = connector.config.auth;\n\n  if (auth.type !== 'api_key') {\n    throw new Error('Grok requires API key authentication');\n  }\n\n  const options = connector.getOptions();\n\n  return {\n    auth: {\n      type: 'api_key',\n      apiKey: auth.apiKey,\n    },\n    baseURL: connector.baseURL,\n    timeout: options.timeout as number | undefined,\n    maxRetries: options.maxRetries as number | undefined,\n  };\n}\n","/**\n * Video Model Registry\n *\n * Comprehensive registry of video generation models with capabilities and pricing.\n * Models are organized by vendor and include detailed capability information.\n */\n\nimport { Vendor } from '../../core/Vendor.js';\nimport type { ISourceLinks, IBaseModelDescription } from '../types/SharedTypes.js';\nimport { createRegistryHelpers } from './RegistryUtils.js';\n\n/**\n * Video model capabilities\n */\nexport interface VideoModelCapabilities {\n  /** Supported durations in seconds */\n  durations: number[];\n  /** Supported resolutions (e.g., '720p', '1080p', '720x1280') */\n  resolutions: string[];\n  /** Supported aspect ratios (e.g., '16:9', '9:16') - for vendors that use this instead of resolution */\n  aspectRatios?: string[];\n  /** Maximum frames per second */\n  maxFps: number;\n  /** Whether the model supports audio generation */\n  audio: boolean;\n  /** Whether the model supports image-to-video */\n  imageToVideo: boolean;\n  /** Whether the model supports video extension */\n  videoExtension: boolean;\n  /** Whether the model supports first/last frame specification */\n  frameControl: boolean;\n  /** Additional features */\n  features: {\n    /** Supports upscaling output */\n    upscaling: boolean;\n    /** Supports style/mood control */\n    styleControl: boolean;\n    /** Supports negative prompts */\n    negativePrompt: boolean;\n    /** Supports seed for reproducibility */\n    seed: boolean;\n  };\n}\n\n/**\n * Video model pricing\n */\nexport interface VideoModelPricing {\n  /** Cost per second of generated video */\n  perSecond: number;\n  /** Currency */\n  currency: string;\n}\n\n/**\n * Video model description\n */\nexport interface IVideoModelDescription extends IBaseModelDescription {\n  capabilities: VideoModelCapabilities;\n  pricing?: VideoModelPricing;\n}\n\n/**\n * Video model registry type\n */\ntype VideoModelRegistry = Record<string, IVideoModelDescription>;\n\n/**\n * Model constants organized by vendor\n */\nexport const VIDEO_MODELS = {\n  [Vendor.OpenAI]: {\n    SORA_2: 'sora-2',\n    SORA_2_PRO: 'sora-2-pro',\n  },\n  [Vendor.Google]: {\n    // Gemini API (ai.google.dev) model names - use with API key\n    VEO_2: 'veo-2.0-generate-001',\n    VEO_3_1_FAST: 'veo-3.1-fast-generate-preview',\n    VEO_3_1: 'veo-3.1-generate-preview',\n  },\n  [Vendor.Grok]: {\n    // xAI Grok Imagine video generation\n    GROK_IMAGINE_VIDEO: 'grok-imagine-video',\n  },\n} as const;\n\n/**\n * Common sources for model information\n */\nconst OPENAI_SOURCES: ISourceLinks = {\n  documentation: 'https://platform.openai.com/docs/guides/video-generation',\n  apiReference: 'https://platform.openai.com/docs/api-reference/videos',\n  lastVerified: '2026-01-25',\n};\n\nconst GOOGLE_SOURCES: ISourceLinks = {\n  documentation: 'https://docs.cloud.google.com/vertex-ai/generative-ai/docs/video/overview',\n  apiReference: 'https://docs.cloud.google.com/vertex-ai/generative-ai/docs/model-reference/veo-video-generation',\n  lastVerified: '2026-01-25',\n};\n\nconst GROK_SOURCES: ISourceLinks = {\n  documentation: 'https://docs.x.ai/docs/guides/video-generations',\n  apiReference: 'https://docs.x.ai/api',\n  lastVerified: '2026-01-31',\n};\n\n/**\n * Video Model Registry\n */\nexport const VIDEO_MODEL_REGISTRY: VideoModelRegistry = {\n  // ============================================================================\n  // OpenAI Sora Models\n  // ============================================================================\n\n  'sora-2': {\n    name: 'sora-2',\n    displayName: 'Sora 2',\n    provider: Vendor.OpenAI,\n    isActive: true,\n    sources: OPENAI_SOURCES,\n    capabilities: {\n      durations: [4, 8, 12],\n      resolutions: ['720x1280', '1280x720', '1024x1792', '1792x1024'],\n      maxFps: 30,\n      audio: true,\n      imageToVideo: true,\n      videoExtension: true,\n      frameControl: false,\n      features: {\n        upscaling: false,\n        styleControl: false,\n        negativePrompt: false,\n        seed: true,\n      },\n    },\n    pricing: {\n      perSecond: 0.15,\n      currency: 'USD',\n    },\n  },\n\n  'sora-2-pro': {\n    name: 'sora-2-pro',\n    displayName: 'Sora 2 Pro',\n    provider: Vendor.OpenAI,\n    isActive: true,\n    sources: OPENAI_SOURCES,\n    capabilities: {\n      durations: [4, 8, 12],\n      resolutions: ['720x1280', '1280x720', '1024x1792', '1792x1024', '1920x1080', '1080x1920'],\n      maxFps: 30,\n      audio: true,\n      imageToVideo: true,\n      videoExtension: true,\n      frameControl: true,\n      features: {\n        upscaling: true,\n        styleControl: true,\n        negativePrompt: false,\n        seed: true,\n      },\n    },\n    pricing: {\n      perSecond: 0.40,\n      currency: 'USD',\n    },\n  },\n\n  // ============================================================================\n  // Google Veo Models\n  // ============================================================================\n\n  'veo-2.0-generate-001': {\n    name: 'veo-2.0-generate-001',\n    displayName: 'Veo 2.0',\n    provider: Vendor.Google,\n    isActive: true,\n    sources: GOOGLE_SOURCES,\n    capabilities: {\n      durations: [5, 6, 7, 8],\n      resolutions: [], // Veo 2.0 uses aspectRatio only, no resolution control\n      aspectRatios: ['16:9', '9:16'],\n      maxFps: 24,\n      audio: false,\n      imageToVideo: true,\n      videoExtension: false,\n      frameControl: true,\n      features: {\n        upscaling: false,\n        styleControl: false,\n        negativePrompt: true,\n        seed: true,\n      },\n    },\n    pricing: {\n      perSecond: 0.03,\n      currency: 'USD',\n    },\n  },\n\n  'veo-3.1-fast-generate-preview': {\n    name: 'veo-3.1-fast-generate-preview',\n    displayName: 'Veo 3.1 Fast',\n    provider: Vendor.Google,\n    isActive: true,\n    sources: GOOGLE_SOURCES,\n    capabilities: {\n      durations: [4, 6, 8],\n      resolutions: ['720p'], // Fast model only supports 720p\n      aspectRatios: ['16:9', '9:16'],\n      maxFps: 24,\n      audio: true,\n      imageToVideo: true,\n      videoExtension: false,\n      frameControl: false,\n      features: {\n        upscaling: false,\n        styleControl: false,\n        negativePrompt: true,\n        seed: true,\n      },\n    },\n    pricing: {\n      perSecond: 0.75,\n      currency: 'USD',\n    },\n  },\n\n  'veo-3.1-generate-preview': {\n    name: 'veo-3.1-generate-preview',\n    displayName: 'Veo 3.1',\n    provider: Vendor.Google,\n    isActive: true,\n    sources: GOOGLE_SOURCES,\n    capabilities: {\n      durations: [4, 6, 8],\n      resolutions: ['720p', '1080p', '4k'], // 1080p and 4k require 8s duration\n      aspectRatios: ['16:9', '9:16'],\n      maxFps: 30,\n      audio: true,\n      imageToVideo: true,\n      videoExtension: true,\n      frameControl: true,\n      features: {\n        upscaling: true,\n        styleControl: true,\n        negativePrompt: true,\n        seed: true,\n      },\n    },\n    pricing: {\n      perSecond: 0.75,\n      currency: 'USD',\n    },\n  },\n\n  // ============================================================================\n  // xAI Grok Imagine Models\n  // ============================================================================\n\n  'grok-imagine-video': {\n    name: 'grok-imagine-video',\n    displayName: 'Grok Imagine Video',\n    provider: Vendor.Grok,\n    isActive: true,\n    sources: GROK_SOURCES,\n    capabilities: {\n      durations: [1, 5, 8, 10, 15],\n      resolutions: ['480p', '720p'],\n      aspectRatios: ['16:9', '4:3', '1:1', '9:16', '3:4', '3:2', '2:3'],\n      maxFps: 24,\n      audio: true,\n      imageToVideo: true,\n      videoExtension: false,\n      frameControl: false,\n      features: {\n        upscaling: false,\n        styleControl: false,\n        negativePrompt: false,\n        seed: true,\n      },\n    },\n    pricing: {\n      perSecond: 0.05,\n      currency: 'USD',\n    },\n  },\n};\n\n// Create helper functions using the registry utility\nconst helpers = createRegistryHelpers<IVideoModelDescription>(VIDEO_MODEL_REGISTRY);\n\n/**\n * Get model information by name\n */\nexport const getVideoModelInfo = helpers.getInfo;\n\n/**\n * Get all models for a specific vendor\n */\nexport const getVideoModelsByVendor = helpers.getByVendor;\n\n/**\n * Get all currently active models\n */\nexport const getActiveVideoModels = helpers.getActive;\n\n/**\n * Get models with a specific feature\n */\nexport function getVideoModelsWithFeature(feature: keyof VideoModelCapabilities['features']): IVideoModelDescription[] {\n  return Object.values(VIDEO_MODEL_REGISTRY).filter(\n    (model) => model.isActive && model.capabilities.features[feature]\n  );\n}\n\n/**\n * Get models that support audio\n */\nexport function getVideoModelsWithAudio(): IVideoModelDescription[] {\n  return Object.values(VIDEO_MODEL_REGISTRY).filter((model) => model.isActive && model.capabilities.audio);\n}\n\n/**\n * Calculate video generation cost\n */\nexport function calculateVideoCost(modelName: string, durationSeconds: number): number | null {\n  const model = VIDEO_MODEL_REGISTRY[modelName];\n  if (!model || !model.pricing) {\n    return null;\n  }\n\n  return model.pricing.perSecond * durationSeconds;\n}\n","/**\n * SearchProvider - Unified search interface with connector support\n *\n * Provides a consistent API for web search across multiple vendors.\n * Uses Connector-First architecture for authentication.\n */\n\nimport { Connector } from '../../core/Connector.js';\nimport { SerperProvider } from './providers/SerperProvider.js';\nimport { BraveProvider } from './providers/BraveProvider.js';\nimport { TavilyProvider } from './providers/TavilyProvider.js';\nimport { RapidAPIProvider } from './providers/RapidAPIProvider.js';\n\n/**\n * Search result interface\n */\nexport interface SearchResult {\n  /** Page title */\n  title: string;\n  /** Direct URL to the page */\n  url: string;\n  /** Short description/excerpt */\n  snippet: string;\n  /** Search ranking position */\n  position: number;\n}\n\n/**\n * Search options\n */\nexport interface SearchOptions {\n  /** Number of results to return (default: 10, max provider-specific) */\n  numResults?: number;\n  /** Language code (e.g., 'en', 'fr') */\n  language?: string;\n  /** Country/region code (e.g., 'us', 'gb') */\n  country?: string;\n  /** Time range filter (e.g., 'day', 'week', 'month', 'year') */\n  timeRange?: string;\n  /** Vendor-specific options */\n  vendorOptions?: Record<string, any>;\n}\n\n/**\n * Search response\n */\nexport interface SearchResponse {\n  /** Whether the search succeeded */\n  success: boolean;\n  /** Search query */\n  query: string;\n  /** Provider name */\n  provider: string;\n  /** Search results */\n  results: SearchResult[];\n  /** Number of results */\n  count: number;\n  /** Error message if failed */\n  error?: string;\n}\n\n/**\n * Base SearchProvider interface\n */\nexport interface ISearchProvider {\n  /** Provider name */\n  readonly name: string;\n\n  /** Connector used for authentication */\n  readonly connector: Connector;\n\n  /**\n   * Search the web\n   * @param query - Search query string\n   * @param options - Search options\n   */\n  search(query: string, options?: SearchOptions): Promise<SearchResponse>;\n}\n\n/**\n * SearchProvider factory configuration\n */\nexport interface SearchProviderConfig {\n  /** Connector name or instance */\n  connector: string | Connector;\n}\n\n/**\n * SearchProvider factory\n */\nexport class SearchProvider {\n  /**\n   * Create a search provider from a connector\n   * @param config - Provider configuration\n   * @returns Search provider instance\n   */\n  static create(config: SearchProviderConfig): ISearchProvider {\n    // Get connector\n    const connector =\n      typeof config.connector === 'string'\n        ? Connector.get(config.connector)\n        : config.connector;\n\n    if (!connector) {\n      throw new Error(\n        `Connector not found: ${typeof config.connector === 'string' ? config.connector : 'unknown'}`\n      );\n    }\n\n    // Detect provider from serviceType or baseURL\n    const serviceType = connector.serviceType;\n\n    // Map service type to provider\n    switch (serviceType) {\n      case 'serper':\n        return new SerperProvider(connector);\n\n      case 'brave-search':\n        return new BraveProvider(connector);\n\n      case 'tavily':\n        return new TavilyProvider(connector);\n\n      case 'rapidapi-search':\n        return new RapidAPIProvider(connector);\n\n      default:\n        throw new Error(\n          `Unknown search service type: ${serviceType}. Supported: serper, brave-search, tavily, rapidapi-search`\n        );\n    }\n  }\n}\n","/**\n * Shared types for Connector-based capabilities\n *\n * This module provides common types and utilities that can be reused\n * across all capabilities that use the Connector-First architecture.\n */\n\nimport type { ConnectorFetchOptions } from '../../core/Connector.js';\nimport type { Connector } from '../../core/Connector.js';\n\n// ============ Base Provider Types ============\n\n/**\n * Base configuration for all capability providers\n */\nexport interface BaseProviderConfig {\n  /** Connector name or instance */\n  connector: string | Connector;\n}\n\n/**\n * Base response for all capability providers\n */\nexport interface BaseProviderResponse {\n  /** Whether the operation succeeded */\n  success: boolean;\n  /** Provider name */\n  provider: string;\n  /** Error message if failed */\n  error?: string;\n}\n\n/**\n * Base interface for all capability providers\n */\nexport interface ICapabilityProvider {\n  /** Provider name */\n  readonly name: string;\n  /** Connector used for authentication */\n  readonly connector: Connector;\n}\n\n// ============ Extended Fetch Options ============\n\n/**\n * Extended fetch options with JSON body and query params support\n * Usable by any capability that makes HTTP requests via Connector\n */\nexport interface ExtendedFetchOptions extends Omit<ConnectorFetchOptions, 'body'> {\n  /** JSON body (will be stringified automatically) */\n  body?: Record<string, any>;\n  /** Query parameters (will be appended to URL automatically) */\n  queryParams?: Record<string, string | number | boolean>;\n}\n\n// ============ Utilities ============\n\n/**\n * Build query string from params\n * @param params - Key-value pairs to convert to query string\n * @returns URL-encoded query string (without leading ?)\n */\nexport function buildQueryString(params: Record<string, string | number | boolean>): string {\n  const searchParams = new URLSearchParams();\n  for (const [key, value] of Object.entries(params)) {\n    if (value !== undefined && value !== null) {\n      searchParams.append(key, String(value));\n    }\n  }\n  return searchParams.toString();\n}\n\n/**\n * Convert ExtendedFetchOptions to standard ConnectorFetchOptions\n * Handles body stringification and query param building\n *\n * @param options - Extended options with body/queryParams\n * @returns Standard ConnectorFetchOptions ready for Connector.fetch()\n */\nexport function toConnectorOptions(options: ExtendedFetchOptions): ConnectorFetchOptions {\n  const { body, queryParams, ...rest } = options;\n\n  const connectorOptions: ConnectorFetchOptions = {\n    ...rest,\n  };\n\n  // Stringify body if present\n  if (body) {\n    connectorOptions.body = JSON.stringify(body);\n    // Ensure Content-Type is set\n    connectorOptions.headers = {\n      'Content-Type': 'application/json',\n      ...rest.headers,\n    };\n  }\n\n  return connectorOptions;\n}\n\n/**\n * Build endpoint URL with query parameters\n * @param endpoint - Base endpoint path\n * @param queryParams - Query parameters to append\n * @returns Endpoint with query string\n */\nexport function buildEndpointWithQuery(\n  endpoint: string,\n  queryParams?: Record<string, string | number | boolean>\n): string {\n  if (!queryParams || Object.keys(queryParams).length === 0) {\n    return endpoint;\n  }\n  const queryString = buildQueryString(queryParams);\n  const separator = endpoint.includes('?') ? '&' : '?';\n  return `${endpoint}${separator}${queryString}`;\n}\n\n// ============ Provider Factory Helper ============\n\n/**\n * Resolve connector from config (name or instance)\n * Shared logic for all provider factories\n *\n * @param connectorOrName - Connector name string or Connector instance\n * @returns Resolved Connector instance\n * @throws Error if connector not found\n */\nexport function resolveConnector(connectorOrName: string | Connector): Connector {\n  // Import dynamically to avoid circular deps\n  const { Connector: ConnectorClass } = require('../../core/Connector.js');\n\n  if (typeof connectorOrName === 'string') {\n    return ConnectorClass.get(connectorOrName);\n  }\n  return connectorOrName;\n}\n\n// ============ Service Type Auto-Detection ============\n\n/**\n * Find a connector by supported service types\n * Used by tools to auto-detect available external API connectors\n *\n * This is the GENERIC utility for all external API-dependent tools.\n * Tools define which service types they support, this function finds\n * the first available connector matching any of those types.\n *\n * @param serviceTypes - Array of supported service types in order of preference\n * @returns Connector if found, null otherwise\n *\n * @example\n * ```typescript\n * // In web_search tool\n * const SEARCH_SERVICE_TYPES = ['serper', 'brave-search', 'tavily', 'rapidapi-search'];\n * const connector = findConnectorByServiceTypes(SEARCH_SERVICE_TYPES);\n *\n * // In web_scrape tool\n * const SCRAPE_SERVICE_TYPES = ['zenrows', 'jina-reader', 'firecrawl', 'scrapingbee'];\n * const connector = findConnectorByServiceTypes(SCRAPE_SERVICE_TYPES);\n * ```\n */\nexport function findConnectorByServiceTypes(serviceTypes: string[]): Connector | null {\n  // Import dynamically to avoid circular deps\n  const { Connector: ConnectorClass } = require('../../core/Connector.js');\n\n  const allConnectors = ConnectorClass.list() as string[];\n\n  // Try each service type in order of preference\n  for (const serviceType of serviceTypes) {\n    for (const name of allConnectors) {\n      try {\n        const connector = ConnectorClass.get(name);\n        if (connector?.serviceType === serviceType) {\n          return connector;\n        }\n      } catch {\n        // Ignore errors, continue searching\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * List all available connectors for given service types\n * Useful for tools that want to show what's available or support fallback chains\n *\n * @param serviceTypes - Array of supported service types\n * @returns Array of connector names that match any of the service types\n */\nexport function listConnectorsByServiceTypes(serviceTypes: string[]): string[] {\n  const { Connector: ConnectorClass } = require('../../core/Connector.js');\n\n  const allConnectors = ConnectorClass.list() as string[];\n  const matching: string[] = [];\n\n  for (const name of allConnectors) {\n    try {\n      const connector = ConnectorClass.get(name);\n      if (connector?.serviceType && serviceTypes.includes(connector.serviceType)) {\n        matching.push(name);\n      }\n    } catch {\n      // Ignore errors\n    }\n  }\n\n  return matching;\n}\n","/**\n * Serper.dev Search Provider\n * Google search results via Serper.dev API\n */\n\nimport type { Connector } from '../../../core/Connector.js';\nimport type {\n  ISearchProvider,\n  SearchResult,\n  SearchOptions,\n  SearchResponse,\n} from '../SearchProvider.js';\nimport { toConnectorOptions } from '../types.js';\n\nexport class SerperProvider implements ISearchProvider {\n  readonly name = 'serper';\n\n  constructor(readonly connector: Connector) {}\n\n  async search(query: string, options: SearchOptions = {}): Promise<SearchResponse> {\n    const numResults = Math.min(options.numResults || 10, 100);\n\n    try {\n      const fetchOptions = toConnectorOptions({\n        method: 'POST',\n        body: {\n          q: query,\n          num: numResults,\n          ...(options.country && { gl: options.country }),\n          ...(options.language && { hl: options.language }),\n          ...options.vendorOptions,\n        },\n      });\n\n      const response = await this.connector.fetchJSON<any>('/search', fetchOptions);\n\n      if (!response.organic || !Array.isArray(response.organic)) {\n        throw new Error('Invalid response from Serper API');\n      }\n\n      const results: SearchResult[] = response.organic\n        .slice(0, numResults)\n        .map((result: any, index: number) => ({\n          title: result.title || 'Untitled',\n          url: result.link || '',\n          snippet: result.snippet || '',\n          position: index + 1,\n        }));\n\n      return {\n        success: true,\n        query,\n        provider: this.name,\n        results,\n        count: results.length,\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        query,\n        provider: this.name,\n        results: [],\n        count: 0,\n        error: error.message || 'Unknown error',\n      };\n    }\n  }\n}\n","/**\n * Brave Search Provider\n * Independent search index (privacy-focused)\n */\n\nimport type { Connector } from '../../../core/Connector.js';\nimport type {\n  ISearchProvider,\n  SearchResult,\n  SearchOptions,\n  SearchResponse,\n} from '../SearchProvider.js';\nimport { buildQueryString } from '../types.js';\n\nexport class BraveProvider implements ISearchProvider {\n  readonly name = 'brave';\n\n  constructor(readonly connector: Connector) {}\n\n  async search(query: string, options: SearchOptions = {}): Promise<SearchResponse> {\n    const numResults = Math.min(options.numResults || 10, 20);\n\n    try {\n      const queryParams: Record<string, string | number | boolean> = {\n        q: query,\n        count: numResults,\n        ...(options.country && { country: options.country }),\n        ...(options.language && { search_lang: options.language }),\n        ...options.vendorOptions,\n      };\n\n      const queryString = buildQueryString(queryParams);\n      const response = await this.connector.fetchJSON<any>(`/web/search?${queryString}`, {\n        method: 'GET',\n      });\n\n      if (!response.web?.results || !Array.isArray(response.web.results)) {\n        throw new Error('Invalid response from Brave API');\n      }\n\n      const results: SearchResult[] = response.web.results\n        .slice(0, numResults)\n        .map((result: any, index: number) => ({\n          title: result.title || 'Untitled',\n          url: result.url || '',\n          snippet: result.description || '',\n          position: index + 1,\n        }));\n\n      return {\n        success: true,\n        query,\n        provider: this.name,\n        results,\n        count: results.length,\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        query,\n        provider: this.name,\n        results: [],\n        count: 0,\n        error: error.message || 'Unknown error',\n      };\n    }\n  }\n}\n","/**\n * Tavily AI Search Provider\n * AI-optimized search results with summaries\n */\n\nimport type { Connector } from '../../../core/Connector.js';\nimport type {\n  ISearchProvider,\n  SearchResult,\n  SearchOptions,\n  SearchResponse,\n} from '../SearchProvider.js';\nimport { toConnectorOptions } from '../types.js';\n\nexport class TavilyProvider implements ISearchProvider {\n  readonly name = 'tavily';\n\n  constructor(readonly connector: Connector) {}\n\n  async search(query: string, options: SearchOptions = {}): Promise<SearchResponse> {\n    const numResults = Math.min(options.numResults || 10, 20);\n\n    try {\n      // Tavily requires API key in body\n      const auth = this.connector.config.auth;\n      const apiKey = auth.type === 'api_key' ? auth.apiKey : '';\n\n      const fetchOptions = toConnectorOptions({\n        method: 'POST',\n        body: {\n          api_key: apiKey,\n          query,\n          max_results: numResults,\n          search_depth: options.vendorOptions?.search_depth || 'basic',\n          include_answer: options.vendorOptions?.include_answer || false,\n          include_raw_content: options.vendorOptions?.include_raw_content || false,\n          ...options.vendorOptions,\n        },\n      });\n\n      const response = await this.connector.fetchJSON<any>('/search', fetchOptions);\n\n      if (!response.results || !Array.isArray(response.results)) {\n        throw new Error('Invalid response from Tavily API');\n      }\n\n      const results: SearchResult[] = response.results\n        .slice(0, numResults)\n        .map((result: any, index: number) => ({\n          title: result.title || 'Untitled',\n          url: result.url || '',\n          snippet: result.content || '',\n          position: index + 1,\n        }));\n\n      return {\n        success: true,\n        query,\n        provider: this.name,\n        results,\n        count: results.length,\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        query,\n        provider: this.name,\n        results: [],\n        count: 0,\n        error: error.message || 'Unknown error',\n      };\n    }\n  }\n}\n","/**\n * RapidAPI Real-Time Web Search Provider\n * Real-time web search via RapidAPI\n */\n\nimport type { Connector } from '../../../core/Connector.js';\nimport type {\n  ISearchProvider,\n  SearchResult,\n  SearchOptions,\n  SearchResponse,\n} from '../SearchProvider.js';\nimport { buildQueryString } from '../types.js';\nimport { logger } from '../../../infrastructure/observability/Logger.js';\n\nconst rapidapiLogger = logger.child({ component: 'RapidAPIProvider' });\n\nexport class RapidAPIProvider implements ISearchProvider {\n  readonly name = 'rapidapi';\n\n  constructor(readonly connector: Connector) {}\n\n  async search(query: string, options: SearchOptions = {}): Promise<SearchResponse> {\n    const numResults = Math.min(options.numResults || 10, 100);\n    rapidapiLogger.debug({ query, numResults, options }, 'RapidAPI search started');\n\n    try {\n      // Build query params\n      const queryParams: Record<string, string | number | boolean> = {\n        q: query,\n        num: numResults,\n        start: 0,\n        fetch_ai_overviews: false,\n        deduplicate: false,\n        return_organic_result_video_thumbnail: false,\n        nfpr: 0,\n        ...(options.country && { gl: options.country }),\n        ...(options.language && { hl: options.language }),\n        ...options.vendorOptions,\n      };\n\n      // Extract host from connector's baseURL for X-RapidAPI-Host header\n      const baseURL = this.connector.baseURL;\n      const host = baseURL ? new URL(baseURL).host : 'real-time-web-search.p.rapidapi.com';\n      rapidapiLogger.debug({ baseURL, host }, 'Using RapidAPI host');\n\n      // Get API key from connector's auth config\n      let apiKey = '';\n      try {\n        apiKey = this.connector.getApiKey();\n        rapidapiLogger.debug({ hasApiKey: !!apiKey, keyLength: apiKey?.length }, 'Got API key');\n      } catch (e: any) {\n        rapidapiLogger.error({ error: e.message }, 'Failed to get API key');\n        throw new Error('RapidAPI provider requires API key authentication');\n      }\n\n      const queryString = buildQueryString(queryParams);\n      const requestUrl = `/search?${queryString}`;\n      rapidapiLogger.debug({ requestUrl, method: 'GET' }, 'Making RapidAPI request');\n\n      const response = await this.connector.fetchJSON<any>(requestUrl, {\n        method: 'GET',\n        headers: {\n          'X-RapidAPI-Key': apiKey,\n          'X-RapidAPI-Host': host,\n        },\n      });\n\n      rapidapiLogger.debug({\n        hasResponse: !!response,\n        hasData: !!response?.data,\n        dataKeys: response?.data ? Object.keys(response.data) : [],\n        hasOrganicResults: !!(response?.data?.organic_results || response?.data?.organic),\n        organicResultsCount: (response?.data?.organic_results || response?.data?.organic || []).length,\n      }, 'RapidAPI response received');\n\n      // RapidAPI returns data in different formats, handle all variations\n      const organicResults =\n        response.data?.organic_results ||\n        response.data?.organic ||\n        response.organic_results ||\n        response.organic ||\n        [];\n\n      if (!Array.isArray(organicResults)) {\n        rapidapiLogger.error({\n          responseType: typeof organicResults,\n          response: JSON.stringify(response).slice(0, 500),\n        }, 'Invalid response format - organic is not an array');\n        throw new Error('Invalid response from RapidAPI Search');\n      }\n\n      const results: SearchResult[] = organicResults\n        .slice(0, numResults)\n        .map((result: any, index: number) => ({\n          title: result.title || 'Untitled',\n          url: result.link || result.url || '',\n          snippet: result.snippet || result.description || '',\n          position: index + 1,\n        }));\n\n      rapidapiLogger.debug({\n        success: true,\n        resultCount: results.length,\n        firstTitle: results[0]?.title,\n      }, 'RapidAPI search completed successfully');\n\n      return {\n        success: true,\n        query,\n        provider: this.name,\n        results,\n        count: results.length,\n      };\n    } catch (error: any) {\n      rapidapiLogger.error({\n        error: error.message,\n        stack: error.stack,\n      }, 'RapidAPI search failed');\n      return {\n        success: false,\n        query,\n        provider: this.name,\n        results: [],\n        count: 0,\n        error: error.message || 'Unknown error',\n      };\n    }\n  }\n}\n","/**\n * ScrapeProvider - Unified web scraping interface with connector support\n *\n * Provides a consistent API for web scraping across multiple vendors.\n * Uses Connector-First architecture for authentication.\n *\n * This is the surface API - actual scraping is delegated to vendor-specific\n * providers based on the Connector's serviceType.\n *\n * DESIGN PATTERN:\n * - IScrapeProvider: Interface all providers implement\n * - ScrapeProvider.create(): Factory that returns the right provider\n * - ScrapeProvider.createWithFallback(): Factory with fallback chain\n *\n * FALLBACK STRATEGY:\n * The webScrape tool uses this provider with a fallback chain:\n * 1. Try native fetch (webFetch) - fastest, free\n * 2. Try external API provider - handles bot protection, SPAs, etc.\n */\n\nimport { Connector } from '../../core/Connector.js';\nimport { resolveConnector, type BaseProviderResponse } from '../shared/index.js';\n\n// ============ Result Types ============\n\n/**\n * Scraped content result\n */\nexport interface ScrapeResult {\n  /** Page title */\n  title: string;\n  /** Extracted text content (cleaned) */\n  content: string;\n  /** Raw HTML (if available) */\n  html?: string;\n  /** Markdown version (if provider supports it) */\n  markdown?: string;\n  /** Metadata extracted from the page */\n  metadata?: {\n    description?: string;\n    author?: string;\n    publishedDate?: string;\n    siteName?: string;\n    favicon?: string;\n    ogImage?: string;\n    [key: string]: any;\n  };\n  /** Screenshot as base64 (if requested and supported) */\n  screenshot?: string;\n  /** Links found on the page */\n  links?: Array<{ url: string; text: string }>;\n}\n\n/**\n * Scrape options\n */\nexport interface ScrapeOptions {\n  /** Timeout in milliseconds (default: 30000) */\n  timeout?: number;\n  /** Whether to wait for JavaScript to render (if supported) */\n  waitForJS?: boolean;\n  /** CSS selector to wait for before scraping */\n  waitForSelector?: string;\n  /** Whether to include raw HTML in response */\n  includeHtml?: boolean;\n  /** Whether to convert to markdown (if supported) */\n  includeMarkdown?: boolean;\n  /** Whether to extract links */\n  includeLinks?: boolean;\n  /** Whether to take a screenshot (if supported) */\n  includeScreenshot?: boolean;\n  /** Custom headers to send */\n  headers?: Record<string, string>;\n  /** Vendor-specific options */\n  vendorOptions?: Record<string, any>;\n}\n\n/**\n * Scrape response\n */\nexport interface ScrapeResponse extends BaseProviderResponse {\n  /** The URL that was scraped */\n  url: string;\n  /** Final URL after redirects */\n  finalUrl?: string;\n  /** Scraped content */\n  result?: ScrapeResult;\n  /** HTTP status code */\n  statusCode?: number;\n  /** Time taken in milliseconds */\n  durationMs?: number;\n  /** Whether the content required JavaScript rendering */\n  requiredJS?: boolean;\n  /** Suggested fallback if this provider failed */\n  suggestedFallback?: string;\n}\n\n// ============ Provider Interface ============\n\n/**\n * Base ScrapeProvider interface\n * All scraping providers must implement this interface\n */\nexport interface IScrapeProvider {\n  /** Provider name (e.g., 'jina', 'firecrawl', 'scrapingbee') */\n  readonly name: string;\n\n  /** Connector used for authentication */\n  readonly connector: Connector;\n\n  /**\n   * Scrape a URL and extract content\n   * @param url - URL to scrape\n   * @param options - Scrape options\n   * @returns Scrape response with content or error\n   */\n  scrape(url: string, options?: ScrapeOptions): Promise<ScrapeResponse>;\n\n  /**\n   * Check if this provider supports a specific feature\n   * @param feature - Feature name\n   */\n  supportsFeature?(feature: ScrapeFeature): boolean;\n}\n\n/**\n * Features that scrape providers may support\n */\nexport type ScrapeFeature =\n  | 'javascript'      // Can render JavaScript\n  | 'markdown'        // Can convert to markdown\n  | 'screenshot'      // Can take screenshots\n  | 'links'           // Can extract links\n  | 'metadata'        // Can extract metadata\n  | 'proxy'           // Uses proxy rotation\n  | 'stealth'         // Has anti-bot detection bypass\n  | 'pdf'             // Can scrape PDFs\n  | 'dynamic';        // Can handle dynamic content\n\n// ============ Provider Registry ============\n\n/**\n * Provider constructor type\n */\ntype ProviderConstructor = new (connector: Connector) => IScrapeProvider;\n\n/**\n * Registry of service types to provider constructors\n * Providers register themselves here\n */\nconst providerRegistry = new Map<string, ProviderConstructor>();\n\n/**\n * Register a scrape provider for a service type\n * Called by provider implementations to register themselves\n *\n * @param serviceType - Service type (e.g., 'jina', 'firecrawl')\n * @param providerClass - Provider constructor\n */\nexport function registerScrapeProvider(\n  serviceType: string,\n  providerClass: ProviderConstructor\n): void {\n  providerRegistry.set(serviceType, providerClass);\n}\n\n/**\n * Get registered service types\n */\nexport function getRegisteredScrapeProviders(): string[] {\n  return Array.from(providerRegistry.keys());\n}\n\n// ============ Factory Configuration ============\n\n/**\n * ScrapeProvider factory configuration\n */\nexport interface ScrapeProviderConfig {\n  /** Connector name or instance */\n  connector: string | Connector;\n}\n\n/**\n * Fallback chain configuration\n */\nexport interface ScrapeProviderFallbackConfig {\n  /** Primary connector to try first */\n  primary: string | Connector;\n  /** Fallback connectors to try in order */\n  fallbacks?: Array<string | Connector>;\n  /** Whether to try native fetch before API providers */\n  tryNativeFirst?: boolean;\n}\n\n// ============ Factory Class ============\n\n/**\n * ScrapeProvider factory\n *\n * Creates the appropriate provider based on Connector's serviceType.\n * Use createWithFallback() for automatic fallback on failure.\n */\nexport class ScrapeProvider {\n  /**\n   * Create a scrape provider from a connector\n   *\n   * @param config - Provider configuration\n   * @returns Scrape provider instance\n   * @throws Error if connector not found or service type not supported\n   *\n   * @example\n   * ```typescript\n   * const scraper = ScrapeProvider.create({ connector: 'jina-main' });\n   * const result = await scraper.scrape('https://example.com');\n   * ```\n   */\n  static create(config: ScrapeProviderConfig): IScrapeProvider {\n    const connector = resolveConnector(config.connector);\n    const serviceType = connector.serviceType;\n\n    if (!serviceType) {\n      throw new Error(\n        `Connector '${connector.name}' has no serviceType. ` +\n        `Set serviceType when creating the connector.`\n      );\n    }\n\n    const ProviderClass = providerRegistry.get(serviceType);\n\n    if (!ProviderClass) {\n      const registered = getRegisteredScrapeProviders();\n      throw new Error(\n        `No scrape provider registered for service type '${serviceType}'. ` +\n        `Registered providers: ${registered.length > 0 ? registered.join(', ') : 'none'}. ` +\n        `Make sure to import the provider module.`\n      );\n    }\n\n    return new ProviderClass(connector);\n  }\n\n  /**\n   * Check if a service type has a registered provider\n   */\n  static hasProvider(serviceType: string): boolean {\n    return providerRegistry.has(serviceType);\n  }\n\n  /**\n   * List all registered provider service types\n   */\n  static listProviders(): string[] {\n    return getRegisteredScrapeProviders();\n  }\n\n  /**\n   * Create a scrape provider with fallback chain\n   *\n   * Returns a provider that will try each connector in order until one succeeds.\n   *\n   * @param config - Fallback configuration\n   * @returns Scrape provider with fallback support\n   *\n   * @example\n   * ```typescript\n   * const scraper = ScrapeProvider.createWithFallback({\n   *   primary: 'jina-main',\n   *   fallbacks: ['firecrawl-backup', 'scrapingbee'],\n   * });\n   * // Will try jina first, then firecrawl, then scrapingbee\n   * const result = await scraper.scrape('https://example.com');\n   * ```\n   */\n  static createWithFallback(config: ScrapeProviderFallbackConfig): IScrapeProvider {\n    const providers: IScrapeProvider[] = [];\n\n    // Add primary\n    providers.push(ScrapeProvider.create({ connector: config.primary }));\n\n    // Add fallbacks\n    if (config.fallbacks) {\n      for (const fallback of config.fallbacks) {\n        try {\n          providers.push(ScrapeProvider.create({ connector: fallback }));\n        } catch {\n          // Skip invalid connectors in fallback chain\n        }\n      }\n    }\n\n    return new FallbackScrapeProvider(providers);\n  }\n}\n\n// ============ Fallback Provider ============\n\n/**\n * Internal provider that implements fallback chain\n */\nclass FallbackScrapeProvider implements IScrapeProvider {\n  readonly name = 'fallback';\n  readonly connector: Connector;\n\n  constructor(private providers: IScrapeProvider[]) {\n    if (providers.length === 0) {\n      throw new Error('At least one provider required for fallback chain');\n    }\n    // Use first provider's connector as the \"main\" one\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    this.connector = providers[0]!.connector;\n  }\n\n  async scrape(url: string, options?: ScrapeOptions): Promise<ScrapeResponse> {\n    let lastError: string | undefined;\n    const attemptedProviders: string[] = [];\n\n    for (const provider of this.providers) {\n      attemptedProviders.push(provider.name);\n\n      try {\n        const result = await provider.scrape(url, options);\n\n        if (result.success) {\n          return {\n            ...result,\n            provider: `fallback(${provider.name})`,\n          };\n        }\n\n        lastError = result.error;\n      } catch (error: any) {\n        lastError = error.message;\n      }\n    }\n\n    return {\n      success: false,\n      url,\n      provider: 'fallback',\n      error: `All providers failed. Tried: ${attemptedProviders.join(' -> ')}. Last error: ${lastError}`,\n    };\n  }\n\n  supportsFeature(feature: ScrapeFeature): boolean {\n    // Returns true if ANY provider supports the feature\n    return this.providers.some(p => p.supportsFeature?.(feature));\n  }\n}\n","/**\n * ZenRows Scrape Provider\n *\n * Enterprise-grade web scraping with:\n * - JavaScript rendering\n * - Premium proxy rotation (residential IPs)\n * - Anti-bot bypass (pretends to be human)\n * - CAPTCHA solving\n * - Markdown conversion\n * - Screenshot capture\n *\n * @see https://docs.zenrows.com/universal-scraper-api/api-reference\n */\n\nimport type { Connector } from '../../../core/Connector.js';\nimport type {\n  IScrapeProvider,\n  ScrapeOptions,\n  ScrapeResponse,\n  ScrapeResult,\n  ScrapeFeature,\n} from '../ScrapeProvider.js';\nimport { registerScrapeProvider } from '../ScrapeProvider.js';\nimport { buildQueryString } from '../../shared/index.js';\n\n/**\n * ZenRows-specific options\n */\nexport interface ZenRowsOptions {\n  /** Enable JavaScript rendering (5x cost) */\n  jsRender?: boolean;\n  /** Use premium proxies / residential IPs (10x cost) */\n  premiumProxy?: boolean;\n  /** Wait time in ms before returning content (max 30000) */\n  wait?: number;\n  /** CSS selector to wait for before returning */\n  waitFor?: string;\n  /** Enable auto-parsing of structured data */\n  autoparse?: boolean;\n  /** CSS selectors to extract (JSON output) */\n  cssExtractor?: string;\n  /** Output format: 'html' or 'markdown' */\n  outputFormat?: 'html' | 'markdown';\n  /** Take a screenshot (returns base64) */\n  screenshot?: boolean;\n  /** Screenshot full page (vs viewport only) */\n  screenshotFullpage?: boolean;\n  /** Block specific resources: 'image', 'media', 'font', 'stylesheet' */\n  blockResources?: string;\n  /** Custom headers as JSON string */\n  customHeaders?: boolean;\n  /** Session ID for sticky sessions */\n  sessionId?: number;\n  /** Device type: 'desktop' or 'mobile' */\n  device?: 'desktop' | 'mobile';\n  /** Original status code passthrough */\n  originalStatus?: boolean;\n  /** Proxy country (e.g., 'us', 'gb') */\n  proxyCountry?: string;\n  /** JavaScript instructions to execute */\n  jsInstructions?: string;\n}\n\n/**\n * ZenRows API response headers\n */\ninterface ZenRowsHeaders {\n  'zr-final-url'?: string;\n  'zr-status'?: string;\n  'zr-cost'?: string;\n  'content-type'?: string;\n}\n\nexport class ZenRowsProvider implements IScrapeProvider {\n  readonly name = 'zenrows';\n\n  constructor(readonly connector: Connector) {}\n\n  /**\n   * Scrape a URL using ZenRows API\n   *\n   * By default, enables JS rendering and premium proxies for guaranteed results.\n   */\n  async scrape(url: string, options: ScrapeOptions = {}): Promise<ScrapeResponse> {\n    const startTime = Date.now();\n\n    try {\n      // Get API key from connector auth\n      const apiKey = this.getApiKey();\n\n      // Build ZenRows-specific options\n      const zenrowsOpts = options.vendorOptions as ZenRowsOptions | undefined;\n\n      // Build query parameters\n      const queryParams: Record<string, string | number | boolean> = {\n        url: url,\n        apikey: apiKey,\n        // Default to JS rendering and premium proxy for guaranteed results\n        js_render: zenrowsOpts?.jsRender ?? true,\n        premium_proxy: zenrowsOpts?.premiumProxy ?? true,\n      };\n\n      // Add optional parameters\n      if (options.waitForSelector || zenrowsOpts?.waitFor) {\n        queryParams.wait_for = options.waitForSelector || zenrowsOpts?.waitFor || '';\n      }\n\n      if (zenrowsOpts?.wait) {\n        queryParams.wait = zenrowsOpts.wait;\n      }\n\n      if (options.includeMarkdown || zenrowsOpts?.outputFormat === 'markdown') {\n        queryParams.response_type = 'markdown';\n      }\n\n      if (options.includeScreenshot || zenrowsOpts?.screenshot) {\n        queryParams.screenshot = true;\n        if (zenrowsOpts?.screenshotFullpage) {\n          queryParams.screenshot_fullpage = true;\n        }\n      }\n\n      if (zenrowsOpts?.autoparse) {\n        queryParams.autoparse = true;\n      }\n\n      if (zenrowsOpts?.cssExtractor) {\n        queryParams.css_extractor = zenrowsOpts.cssExtractor;\n      }\n\n      if (zenrowsOpts?.blockResources) {\n        queryParams.block_resources = zenrowsOpts.blockResources;\n      }\n\n      if (zenrowsOpts?.sessionId) {\n        queryParams.session_id = zenrowsOpts.sessionId;\n      }\n\n      if (zenrowsOpts?.device) {\n        queryParams.device = zenrowsOpts.device;\n      }\n\n      if (zenrowsOpts?.originalStatus) {\n        queryParams.original_status = true;\n      }\n\n      if (zenrowsOpts?.proxyCountry) {\n        queryParams.proxy_country = zenrowsOpts.proxyCountry;\n      }\n\n      if (zenrowsOpts?.jsInstructions) {\n        queryParams.js_instructions = zenrowsOpts.jsInstructions;\n      }\n\n      // Add custom headers if provided\n      if (options.headers && zenrowsOpts?.customHeaders !== false) {\n        queryParams.custom_headers = true;\n      }\n\n      // Build full URL with query params\n      const endpoint = `/?${buildQueryString(queryParams)}`;\n\n      // Make request\n      const response = await this.connector.fetch(endpoint, {\n        method: 'GET',\n        headers: options.headers,\n        timeout: options.timeout || 60000, // ZenRows can take longer with JS rendering\n      });\n\n      // Parse headers\n      const headers = Object.fromEntries(response.headers.entries()) as ZenRowsHeaders;\n      const finalUrl = headers['zr-final-url'] || url;\n      const statusCode = parseInt(headers['zr-status'] || '200', 10);\n\n      // Check for errors\n      if (!response.ok) {\n        const errorText = await response.text();\n        return {\n          success: false,\n          url,\n          provider: this.name,\n          error: `ZenRows API error (${response.status}): ${errorText}`,\n          statusCode: response.status,\n          durationMs: Date.now() - startTime,\n        };\n      }\n\n      // Parse response based on content type\n      const contentType = headers['content-type'] || '';\n      const isMarkdown = queryParams.response_type === 'markdown';\n      const isScreenshot = queryParams.screenshot;\n\n      let result: ScrapeResult;\n\n      if (isScreenshot && !isMarkdown) {\n        // Screenshot response is base64 encoded\n        const base64 = await response.text();\n        result = {\n          title: '',\n          content: '',\n          screenshot: base64,\n        };\n      } else {\n        const content = await response.text();\n\n        // Extract title from content if HTML\n        let title = '';\n        if (!isMarkdown && contentType.includes('text/html')) {\n          const titleMatch = content.match(/<title[^>]*>([^<]+)<\\/title>/i);\n          title = titleMatch?.[1]?.trim() ?? '';\n        } else if (isMarkdown) {\n          // Try to extract title from first heading\n          const headingMatch = content.match(/^#\\s+(.+)$/m);\n          title = headingMatch?.[1]?.trim() ?? '';\n        }\n\n        result = {\n          title,\n          content: isMarkdown ? content : this.extractText(content),\n          html: options.includeHtml && !isMarkdown ? content : undefined,\n          markdown: isMarkdown ? content : undefined,\n        };\n\n        // Extract links if requested\n        if (options.includeLinks && !isMarkdown) {\n          result.links = this.extractLinks(content, finalUrl);\n        }\n\n        // Extract metadata from HTML\n        if (!isMarkdown) {\n          result.metadata = this.extractMetadata(content);\n        }\n      }\n\n      return {\n        success: true,\n        url,\n        finalUrl,\n        provider: this.name,\n        result,\n        statusCode,\n        durationMs: Date.now() - startTime,\n        requiredJS: queryParams.js_render === true,\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        url,\n        provider: this.name,\n        error: error.message || 'Unknown error',\n        durationMs: Date.now() - startTime,\n      };\n    }\n  }\n\n  /**\n   * Check if this provider supports a feature\n   */\n  supportsFeature(feature: ScrapeFeature): boolean {\n    const supported: ScrapeFeature[] = [\n      'javascript',\n      'markdown',\n      'screenshot',\n      'links',\n      'metadata',\n      'proxy',\n      'stealth',\n      'dynamic',\n    ];\n    return supported.includes(feature);\n  }\n\n  /**\n   * Get API key from connector\n   */\n  private getApiKey(): string {\n    return this.connector.getApiKey();\n  }\n\n  /**\n   * Extract text content from HTML\n   */\n  private extractText(html: string): string {\n    // Remove script and style tags\n    let text = html.replace(/<script[^>]*>[\\s\\S]*?<\\/script>/gi, '');\n    text = text.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, '');\n\n    // Remove HTML tags\n    text = text.replace(/<[^>]+>/g, ' ');\n\n    // Decode HTML entities\n    text = text\n      .replace(/&nbsp;/g, ' ')\n      .replace(/&amp;/g, '&')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&quot;/g, '\"')\n      .replace(/&#39;/g, \"'\");\n\n    // Normalize whitespace\n    text = text.replace(/\\s+/g, ' ').trim();\n\n    return text;\n  }\n\n  /**\n   * Extract links from HTML\n   */\n  private extractLinks(html: string, baseUrl: string): Array<{ url: string; text: string }> {\n    const links: Array<{ url: string; text: string }> = [];\n    const linkRegex = /<a[^>]+href=[\"']([^\"']+)[\"'][^>]*>([^<]*)<\\/a>/gi;\n    let match;\n\n    while ((match = linkRegex.exec(html)) !== null) {\n      try {\n        const href = match[1];\n        const text = match[2]?.trim() ?? '';\n\n        // Skip if href is missing\n        if (!href) continue;\n\n        // Resolve relative URLs\n        const absoluteUrl = new URL(href, baseUrl).href;\n\n        // Skip javascript: and mailto: links\n        if (!absoluteUrl.startsWith('javascript:') && !absoluteUrl.startsWith('mailto:')) {\n          links.push({ url: absoluteUrl, text: text || absoluteUrl });\n        }\n      } catch {\n        // Skip invalid URLs\n      }\n    }\n\n    return links;\n  }\n\n  /**\n   * Extract metadata from HTML\n   */\n  private extractMetadata(\n    html: string\n  ): ScrapeResult['metadata'] {\n    const metadata: ScrapeResult['metadata'] = {};\n\n    // Extract meta tags\n    const metaRegex = /<meta[^>]+(?:name|property)=[\"']([^\"']+)[\"'][^>]+content=[\"']([^\"']+)[\"']/gi;\n    let match;\n\n    while ((match = metaRegex.exec(html)) !== null) {\n      const name = match[1]?.toLowerCase();\n      const content = match[2];\n\n      // Skip if no name or content\n      if (!name || !content) continue;\n\n      if (name === 'description' || name === 'og:description') {\n        metadata.description = metadata.description || content;\n      } else if (name === 'author') {\n        metadata.author = content;\n      } else if (name === 'og:site_name') {\n        metadata.siteName = content;\n      } else if (name === 'og:image') {\n        metadata.ogImage = content;\n      } else if (name === 'article:published_time') {\n        metadata.publishedDate = content;\n      }\n    }\n\n    // Extract favicon\n    const faviconMatch = html.match(/<link[^>]+rel=[\"'](?:shortcut )?icon[\"'][^>]+href=[\"']([^\"']+)[\"']/i);\n    if (faviconMatch) {\n      metadata.favicon = faviconMatch[1];\n    }\n\n    return Object.keys(metadata).length > 0 ? metadata : undefined;\n  }\n}\n\n// Self-register when imported\nregisterScrapeProvider('zenrows', ZenRowsProvider);\n","/**\n * Document Reader\n *\n * Universal file-to-LLM-content converter.\n * Reads arbitrary formats and produces DocumentPiece arrays.\n */\n\nimport { readFile as fsReadFile } from 'node:fs/promises';\nimport { DOCUMENT_DEFAULTS } from '../../core/constants.js';\nimport { DocumentReadError, UnsupportedFormatError } from '../../domain/errors/AIErrors.js';\nimport { FormatDetector } from './FormatDetector.js';\nimport type {\n  DocumentSource,\n  DocumentResult,\n  DocumentReadOptions,\n  DocumentReaderConfig,\n  DocumentPiece,\n  DocumentImagePiece,\n  DocumentMetadata,\n  DocumentFamily,\n  IFormatHandler,\n  IDocumentTransformer,\n  TransformerContext,\n  ImageFilterOptions,\n} from './types.js';\n\n/**\n * Main document reader class.\n *\n * @example\n * ```typescript\n * const reader = DocumentReader.create();\n * const result = await reader.read('/path/to/doc.pdf');\n * console.log(result.pieces); // DocumentPiece[]\n * ```\n */\nexport class DocumentReader {\n  private handlers: Map<DocumentFamily, IFormatHandler>;\n  private config: DocumentReaderConfig;\n\n  private constructor(config: DocumentReaderConfig = {}) {\n    this.config = config;\n    this.handlers = config.handlers ? new Map(config.handlers) : new Map();\n  }\n\n  /**\n   * Create a new DocumentReader instance\n   */\n  static create(config: DocumentReaderConfig = {}): DocumentReader {\n    const reader = new DocumentReader(config);\n    reader.registerDefaultHandlers();\n    return reader;\n  }\n\n  /**\n   * Register all default format handlers (lazy-loaded)\n   */\n  private registerDefaultHandlers(): void {\n    // Import default handlers on first use (they self-register)\n    // Handlers are loaded lazily in getHandler() to avoid loading unused deps\n  }\n\n  /**\n   * Register a custom format handler\n   */\n  registerHandler(family: DocumentFamily, handler: IFormatHandler): void {\n    this.handlers.set(family, handler);\n  }\n\n  /**\n   * Read a document from any source\n   */\n  async read(\n    source: DocumentSource | string,\n    options: DocumentReadOptions = {}\n  ): Promise<DocumentResult> {\n    const startTime = Date.now();\n    const warnings: string[] = [];\n\n    // Merge with default options\n    const mergedOptions: DocumentReadOptions = {\n      ...this.config.defaults,\n      ...options,\n      formatOptions: {\n        ...this.config.defaults?.formatOptions,\n        ...options.formatOptions,\n      },\n      imageFilter: {\n        ...this.config.defaults?.imageFilter,\n        ...options.imageFilter,\n      },\n    };\n\n    try {\n      // 1. Resolve source to buffer + filename\n      const { buffer, filename } = await this.resolveSource(\n        typeof source === 'string' ? this.parseStringSource(source) : source\n      );\n\n      // 2. Detect format\n      const detection = FormatDetector.detect(filename, buffer);\n\n      // 3. Get handler for format family\n      const handler = await this.getHandler(detection.family);\n      if (!handler) {\n        throw new UnsupportedFormatError(detection.format, detection.family);\n      }\n\n      // 4. Run handler\n      let pieces = await handler.handle(buffer, filename, detection.format, mergedOptions);\n\n      // 5. Filter images\n      if (mergedOptions.extractImages !== false) {\n        pieces = this.filterImages(pieces, mergedOptions.imageFilter);\n      } else {\n        // Remove all image pieces if extractImages is false\n        pieces = pieces.filter((p) => p.type !== 'image');\n      }\n\n      // 6. Run transformer pipeline\n      const transformerContext: TransformerContext = {\n        filename,\n        format: detection.format,\n        family: detection.family,\n        options: mergedOptions,\n      };\n      pieces = await this.runTransformers(pieces, transformerContext, mergedOptions);\n\n      // 7. Assemble result\n      const metadata = this.assembleMetadata(pieces, filename, detection, startTime);\n\n      return {\n        success: true,\n        pieces,\n        metadata,\n        warnings,\n      };\n    } catch (error) {\n      if (error instanceof DocumentReadError || error instanceof UnsupportedFormatError) {\n        throw error;\n      }\n      throw new DocumentReadError(\n        typeof source === 'string' ? source : ('path' in source ? source.path : ('filename' in source ? source.filename : 'unknown')),\n        error instanceof Error ? error.message : String(error),\n        error instanceof Error ? error : undefined\n      );\n    }\n  }\n\n  /**\n   * Parse a string source (auto-detect path vs URL)\n   */\n  private parseStringSource(source: string): DocumentSource {\n    if (source.startsWith('http://') || source.startsWith('https://')) {\n      return { type: 'url', url: source };\n    }\n    return { type: 'file', path: source };\n  }\n\n  /**\n   * Resolve any source to a buffer and filename\n   */\n  private async resolveSource(\n    source: DocumentSource\n  ): Promise<{ buffer: Buffer; filename: string }> {\n    switch (source.type) {\n      case 'file': {\n        const buffer = await fsReadFile(source.path);\n        const filename = source.path.split('/').pop() || source.path;\n        return { buffer, filename };\n      }\n\n      case 'url': {\n        const maxSize = this.config.maxDownloadSizeBytes ?? DOCUMENT_DEFAULTS.MAX_DOWNLOAD_SIZE_BYTES;\n        const timeout = this.config.downloadTimeoutMs ?? DOCUMENT_DEFAULTS.DOWNLOAD_TIMEOUT_MS;\n\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n        try {\n          const response = await fetch(source.url, {\n            headers: {\n              ...source.headers,\n              'User-Agent': 'OneRingAI-DocumentReader/1.0',\n            },\n            signal: controller.signal,\n          });\n          clearTimeout(timeoutId);\n\n          if (!response.ok) {\n            throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n          }\n\n          const contentLength = response.headers.get('content-length');\n          if (contentLength && parseInt(contentLength, 10) > maxSize) {\n            throw new Error(`File too large: ${contentLength} bytes (max: ${maxSize})`);\n          }\n\n          const arrayBuffer = await response.arrayBuffer();\n          if (arrayBuffer.byteLength > maxSize) {\n            throw new Error(`Downloaded file too large: ${arrayBuffer.byteLength} bytes (max: ${maxSize})`);\n          }\n\n          const filename = this.extractFilenameFromURL(source.url, response);\n          return { buffer: Buffer.from(arrayBuffer), filename };\n        } catch (error: any) {\n          clearTimeout(timeoutId);\n          if (error.name === 'AbortError') {\n            throw new Error(`Download timed out after ${timeout}ms`);\n          }\n          throw error;\n        }\n      }\n\n      case 'buffer': {\n        const buffer = Buffer.isBuffer(source.buffer)\n          ? source.buffer\n          : Buffer.from(source.buffer);\n        return { buffer, filename: source.filename };\n      }\n\n      case 'blob': {\n        const arrayBuffer = await source.blob.arrayBuffer();\n        return { buffer: Buffer.from(arrayBuffer), filename: source.filename };\n      }\n    }\n  }\n\n  /**\n   * Extract filename from URL and response headers\n   */\n  private extractFilenameFromURL(url: string, response: Response): string {\n    // Try Content-Disposition header\n    const disposition = response.headers.get('content-disposition');\n    if (disposition) {\n      const match = disposition.match(/filename[^;=\\n]*=(['\"]?)([^'\"\\n;]*)\\1/);\n      if (match?.[2]) return match[2];\n    }\n\n    // Fall back to URL path\n    try {\n      const pathname = new URL(url).pathname;\n      const basename = pathname.split('/').pop();\n      if (basename && basename.includes('.')) return basename;\n    } catch {\n      // ignore\n    }\n\n    return 'document';\n  }\n\n  /**\n   * Get the handler for a format family, loading defaults lazily\n   */\n  private async getHandler(family: DocumentFamily): Promise<IFormatHandler | null> {\n    // Check custom handlers first\n    if (this.handlers.has(family)) {\n      return this.handlers.get(family)!;\n    }\n\n    // Lazy-load default handlers\n    try {\n      const { getDefaultHandlers } = await import('./handlers/index.js');\n      const defaults = getDefaultHandlers();\n      const handler = defaults.get(family);\n      if (handler) {\n        this.handlers.set(family, handler);\n        return handler;\n      }\n    } catch {\n      // Handler module not available\n    }\n\n    return null;\n  }\n\n  /**\n   * Filter images based on options\n   */\n  private filterImages(\n    pieces: DocumentPiece[],\n    filterOptions?: ImageFilterOptions\n  ): DocumentPiece[] {\n    const minWidth = filterOptions?.minWidth ?? DOCUMENT_DEFAULTS.IMAGE_FILTER.MIN_WIDTH;\n    const minHeight = filterOptions?.minHeight ?? DOCUMENT_DEFAULTS.IMAGE_FILTER.MIN_HEIGHT;\n    const minSizeBytes = filterOptions?.minSizeBytes ?? DOCUMENT_DEFAULTS.IMAGE_FILTER.MIN_SIZE_BYTES;\n    const maxImages = filterOptions?.maxImages ?? DOCUMENT_DEFAULTS.MAX_EXTRACTED_IMAGES;\n    const excludePatterns = filterOptions?.excludePatterns ?? [];\n\n    let imageCount = 0;\n\n    return pieces.filter((piece) => {\n      if (piece.type !== 'image') return true;\n\n      const img = piece as DocumentImagePiece;\n\n      // Size checks\n      if (img.width !== undefined && img.width < minWidth) return false;\n      if (img.height !== undefined && img.height < minHeight) return false;\n      if (img.metadata.sizeBytes < minSizeBytes) return false;\n\n      // Pattern exclusions\n      const label = img.metadata.label || '';\n      if (excludePatterns.some((p) => p.test(label))) return false;\n\n      // Max images\n      imageCount++;\n      if (imageCount > maxImages) return false;\n\n      return true;\n    });\n  }\n\n  /**\n   * Run the transformer pipeline\n   */\n  private async runTransformers(\n    pieces: DocumentPiece[],\n    context: TransformerContext,\n    options: DocumentReadOptions\n  ): Promise<DocumentPiece[]> {\n    const transformers: IDocumentTransformer[] = [];\n\n    // Add built-in transformers unless skipped\n    if (!options.skipDefaultTransformers) {\n      try {\n        const { getDefaultTransformers } = await import('./transformers/index.js');\n        transformers.push(...getDefaultTransformers());\n      } catch {\n        // Transformers module not available\n      }\n    }\n\n    // Add user-provided transformers\n    if (options.transformers) {\n      transformers.push(...options.transformers);\n    }\n\n    // Sort by priority (lower first)\n    transformers.sort((a, b) => (a.priority ?? 100) - (b.priority ?? 100));\n\n    // Run pipeline\n    let result = pieces;\n    for (const transformer of transformers) {\n      // Check if transformer applies to this format\n      if (\n        transformer.appliesTo.length === 0 ||\n        transformer.appliesTo.includes(context.format)\n      ) {\n        result = await transformer.transform(result, context);\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Assemble metadata from pieces\n   */\n  private assembleMetadata(\n    pieces: DocumentPiece[],\n    filename: string,\n    detection: { format: any; family: any; mimeType: string },\n    startTime: number\n  ): DocumentMetadata {\n    const textPieces = pieces.filter((p) => p.type === 'text');\n    const imagePieces = pieces.filter((p) => p.type === 'image');\n\n    const totalSizeBytes = pieces.reduce((sum, p) => sum + p.metadata.sizeBytes, 0);\n    const estimatedTokens = pieces.reduce((sum, p) => sum + p.metadata.estimatedTokens, 0);\n\n    return {\n      filename,\n      format: detection.format,\n      family: detection.family,\n      mimeType: detection.mimeType,\n      totalPieces: pieces.length,\n      totalTextPieces: textPieces.length,\n      totalImagePieces: imagePieces.length,\n      totalSizeBytes,\n      estimatedTokens,\n      processingTimeMs: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * Merge text pieces into a single markdown string\n */\nexport function mergeTextPieces(pieces: DocumentPiece[]): string {\n  return pieces\n    .filter((p): p is import('./types.js').DocumentTextPiece => p.type === 'text')\n    .map((p) => p.content)\n    .join('\\n\\n');\n}\n","/**\n * Format Detector\n *\n * Detects document format from filename extension and optional magic bytes.\n */\n\nimport type { DocumentFormat, DocumentFamily, FormatDetectionResult } from './types.js';\n\n// Extension  format mapping\nconst EXTENSION_MAP: Record<string, { format: DocumentFormat; family: DocumentFamily; mimeType: string }> = {\n  // Office\n  '.docx': { format: 'docx', family: 'office', mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' },\n  '.pptx': { format: 'pptx', family: 'office', mimeType: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' },\n  '.odt': { format: 'odt', family: 'office', mimeType: 'application/vnd.oasis.opendocument.text' },\n  '.odp': { format: 'odp', family: 'office', mimeType: 'application/vnd.oasis.opendocument.presentation' },\n  '.ods': { format: 'ods', family: 'office', mimeType: 'application/vnd.oasis.opendocument.spreadsheet' },\n  '.rtf': { format: 'rtf', family: 'office', mimeType: 'application/rtf' },\n  // Spreadsheet\n  '.xlsx': { format: 'xlsx', family: 'spreadsheet', mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' },\n  '.csv': { format: 'csv', family: 'spreadsheet', mimeType: 'text/csv' },\n  // PDF\n  '.pdf': { format: 'pdf', family: 'pdf', mimeType: 'application/pdf' },\n  // HTML\n  '.html': { format: 'html', family: 'html', mimeType: 'text/html' },\n  '.htm': { format: 'html', family: 'html', mimeType: 'text/html' },\n  // Text\n  '.txt': { format: 'txt', family: 'text', mimeType: 'text/plain' },\n  '.md': { format: 'md', family: 'text', mimeType: 'text/markdown' },\n  '.json': { format: 'json', family: 'text', mimeType: 'application/json' },\n  '.xml': { format: 'xml', family: 'text', mimeType: 'application/xml' },\n  '.yaml': { format: 'yaml', family: 'text', mimeType: 'application/yaml' },\n  '.yml': { format: 'yml', family: 'text', mimeType: 'application/yaml' },\n  // Image\n  '.png': { format: 'png', family: 'image', mimeType: 'image/png' },\n  '.jpg': { format: 'jpg', family: 'image', mimeType: 'image/jpeg' },\n  '.jpeg': { format: 'jpeg', family: 'image', mimeType: 'image/jpeg' },\n  '.gif': { format: 'gif', family: 'image', mimeType: 'image/gif' },\n  '.webp': { format: 'webp', family: 'image', mimeType: 'image/webp' },\n  '.svg': { format: 'svg', family: 'image', mimeType: 'image/svg+xml' },\n};\n\n// MIME type  format mapping (for Content-Type detection)\nconst MIME_MAP: Record<string, { format: DocumentFormat; family: DocumentFamily }> = {\n  'application/pdf': { format: 'pdf', family: 'pdf' },\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': { format: 'docx', family: 'office' },\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation': { format: 'pptx', family: 'office' },\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': { format: 'xlsx', family: 'spreadsheet' },\n  'application/vnd.oasis.opendocument.text': { format: 'odt', family: 'office' },\n  'application/vnd.oasis.opendocument.presentation': { format: 'odp', family: 'office' },\n  'application/vnd.oasis.opendocument.spreadsheet': { format: 'ods', family: 'office' },\n  'application/rtf': { format: 'rtf', family: 'office' },\n  'text/rtf': { format: 'rtf', family: 'office' },\n  'text/csv': { format: 'csv', family: 'spreadsheet' },\n  'application/csv': { format: 'csv', family: 'spreadsheet' },\n};\n\n// Binary formats that readFile shouldn't try to read as UTF-8\nconst BINARY_DOCUMENT_EXTENSIONS = new Set([\n  '.docx', '.pptx', '.xlsx',\n  '.odt', '.odp', '.ods',\n  '.pdf',\n  '.png', '.jpg', '.jpeg', '.gif', '.webp',\n]);\n\n/**\n * Static utility for detecting document formats\n */\nexport class FormatDetector {\n  /**\n   * Detect format from filename and optional buffer\n   */\n  static detect(filename: string, _buffer?: Buffer | Uint8Array): FormatDetectionResult {\n    const ext = FormatDetector.getExtension(filename);\n    const entry = EXTENSION_MAP[ext];\n\n    if (!entry) {\n      // Default to text for unknown extensions\n      return {\n        format: 'txt',\n        family: 'text',\n        mimeType: 'text/plain',\n        confidence: 'low',\n      };\n    }\n\n    return {\n      format: entry.format,\n      family: entry.family,\n      mimeType: entry.mimeType,\n      confidence: 'high',\n    };\n  }\n\n  /**\n   * Check if an extension is a supported document format\n   * Used by readFile to detect when to use DocumentReader\n   */\n  static isDocumentFormat(ext: string): boolean {\n    const normalizedExt = ext.startsWith('.') ? ext.toLowerCase() : `.${ext.toLowerCase()}`;\n    return normalizedExt in EXTENSION_MAP;\n  }\n\n  /**\n   * Check if an extension is a binary document format\n   * (i.e., cannot be read as UTF-8)\n   */\n  static isBinaryDocumentFormat(ext: string): boolean {\n    const normalizedExt = ext.startsWith('.') ? ext.toLowerCase() : `.${ext.toLowerCase()}`;\n    return BINARY_DOCUMENT_EXTENSIONS.has(normalizedExt);\n  }\n\n  /**\n   * Check if a Content-Type header indicates a document format\n   * Used by webFetch to detect downloadable documents\n   */\n  static isDocumentMimeType(contentType: string): boolean {\n    // Extract MIME type before parameters (e.g., charset)\n    const mime = (contentType.split(';')[0] ?? '').trim().toLowerCase();\n    return mime in MIME_MAP;\n  }\n\n  /**\n   * Detect format from Content-Type header\n   */\n  static detectFromMimeType(contentType: string): FormatDetectionResult | null {\n    const mime = (contentType.split(';')[0] ?? '').trim().toLowerCase();\n    const entry = MIME_MAP[mime];\n    if (!entry) return null;\n\n    const extEntry = Object.values(EXTENSION_MAP).find(\n      (e) => e.format === entry.format\n    );\n\n    return {\n      format: entry.format,\n      family: entry.family,\n      mimeType: extEntry?.mimeType || mime,\n      confidence: 'high',\n    };\n  }\n\n  /**\n   * Get all supported document extensions\n   */\n  static getSupportedExtensions(): string[] {\n    return Object.keys(EXTENSION_MAP);\n  }\n\n  /**\n   * Get the normalized extension from a filename\n   */\n  static getExtension(filename: string): string {\n    const lastDot = filename.lastIndexOf('.');\n    if (lastDot === -1 || lastDot === filename.length - 1) return '';\n    return filename.slice(lastDot).toLowerCase();\n  }\n}\n","/**\n * Document Reader Capability\n *\n * Universal file-to-LLM-content converter.\n * Reads arbitrary formats (Office, PDF, spreadsheets, HTML, text, images)\n * and produces arrays of DocumentPiece objects.\n */\n\n// Core\nexport { DocumentReader, mergeTextPieces } from './DocumentReader.js';\nexport { FormatDetector } from './FormatDetector.js';\n\n// Types\nexport type {\n  DocumentFormat,\n  DocumentFamily,\n  DocumentPiece,\n  DocumentTextPiece,\n  DocumentImagePiece,\n  PieceMetadata,\n  DocumentResult,\n  DocumentMetadata,\n  DocumentSource,\n  FileSource,\n  URLSource,\n  BufferSource,\n  BlobSource,\n  DocumentReadOptions,\n  DocumentReaderConfig,\n  ImageFilterOptions,\n  ExcelFormatOptions,\n  PDFFormatOptions,\n  HTMLFormatOptions,\n  OfficeFormatOptions,\n  IDocumentTransformer,\n  IFormatHandler,\n  TransformerContext,\n  FormatDetectionResult,\n  DocumentToContentOptions,\n} from './types.js';\n\n// Handlers\nexport {\n  TextHandler,\n  ImageHandler,\n  HTMLHandler,\n  OfficeHandler,\n  ExcelHandler,\n  PDFHandler,\n  getDefaultHandlers,\n} from './handlers/index.js';\n\n// Transformers\nexport {\n  documentHeaderTransformer,\n  tableFormattingTransformer,\n  truncationTransformer,\n  getDefaultTransformers,\n} from './transformers/index.js';\n","/**\n * Document Content Bridge\n *\n * Converts DocumentResult  Content[] for LLM consumption.\n * Provides readDocumentAsContent() as a one-call convenience.\n */\n\nimport { ContentType } from '../domain/entities/Content.js';\nimport type { Content, InputTextContent, InputImageContent } from '../domain/entities/Content.js';\nimport { DocumentReader } from '../capabilities/documents/DocumentReader.js';\nimport type {\n  DocumentResult,\n  DocumentSource,\n  DocumentReadOptions,\n  DocumentToContentOptions,\n} from '../capabilities/documents/types.js';\n\n/**\n * Convert a DocumentResult to Content[] for LLM input.\n *\n * - Text pieces  InputTextContent\n * - Image pieces  InputImageContent (with data URI)\n * - Adjacent text pieces merged by default\n * - Additional image filtering applied\n */\nexport function documentToContent(\n  result: DocumentResult,\n  options: DocumentToContentOptions = {}\n): Content[] {\n  const {\n    imageDetail = 'auto',\n    imageFilter,\n    maxImages = 20,\n    mergeAdjacentText = true,\n  } = options;\n\n  const minWidth = imageFilter?.minWidth ?? 0;\n  const minHeight = imageFilter?.minHeight ?? 0;\n  const minSizeBytes = imageFilter?.minSizeBytes ?? 0;\n  const excludePatterns = imageFilter?.excludePatterns ?? [];\n\n  const contents: Content[] = [];\n  let imageCount = 0;\n  let pendingText: string[] = [];\n\n  const flushText = () => {\n    if (pendingText.length > 0) {\n      const text: InputTextContent = {\n        type: ContentType.INPUT_TEXT,\n        text: pendingText.join('\\n\\n'),\n      };\n      contents.push(text);\n      pendingText = [];\n    }\n  };\n\n  for (const piece of result.pieces) {\n    if (piece.type === 'text') {\n      if (mergeAdjacentText) {\n        pendingText.push(piece.content);\n      } else {\n        const text: InputTextContent = {\n          type: ContentType.INPUT_TEXT,\n          text: piece.content,\n        };\n        contents.push(text);\n      }\n    } else if (piece.type === 'image') {\n      // Apply image filtering\n      if (piece.width !== undefined && piece.width < minWidth) continue;\n      if (piece.height !== undefined && piece.height < minHeight) continue;\n      if (piece.metadata.sizeBytes < minSizeBytes) continue;\n\n      const label = piece.metadata.label || '';\n      if (excludePatterns.some((p) => p.test(label))) continue;\n\n      imageCount++;\n      if (imageCount > maxImages) continue;\n\n      // Flush pending text before inserting image\n      flushText();\n\n      const imageContent: InputImageContent = {\n        type: ContentType.INPUT_IMAGE_URL,\n        image_url: {\n          url: `data:${piece.mimeType};base64,${piece.base64}`,\n          detail: imageDetail,\n        },\n      };\n      contents.push(imageContent);\n    }\n  }\n\n  // Flush remaining text\n  flushText();\n\n  return contents;\n}\n\n/**\n * One-call convenience: read a document and convert to Content[] for LLM input.\n *\n * @example\n * ```typescript\n * const content = await readDocumentAsContent('/path/to/doc.pdf', {\n *   imageFilter: { minWidth: 100, minHeight: 100 },\n *   imageDetail: 'auto',\n * });\n *\n * agent.run([\n *   { type: 'input_text', text: 'Analyze this document:' },\n *   ...content,\n * ]);\n * ```\n */\nexport async function readDocumentAsContent(\n  source: DocumentSource | string,\n  options: DocumentReadOptions & DocumentToContentOptions = {}\n): Promise<Content[]> {\n  // Split options into read options and content options\n  const {\n    imageDetail,\n    maxImages,\n    mergeAdjacentText,\n    // imageFilter is shared between both\n    ...readOptions\n  } = options;\n\n  const contentOptions: DocumentToContentOptions = {\n    imageDetail,\n    imageFilter: options.imageFilter,\n    maxImages,\n    mergeAdjacentText,\n  };\n\n  const reader = DocumentReader.create();\n  const result = await reader.read(source, readOptions);\n\n  if (!result.success) {\n    // Return error as text content\n    return [\n      {\n        type: ContentType.INPUT_TEXT,\n        text: `[Document read error: ${result.error || 'Unknown error'}]`,\n      },\n    ];\n  }\n\n  return documentToContent(result, contentOptions);\n}\n","/**\n * IContextStorage - Storage interface for AgentContext persistence\n *\n * Provides persistence operations for AgentContext sessions.\n * Implementations can use filesystem, database, cloud storage, etc.\n *\n * This follows Clean Architecture - the interface is in domain layer,\n * implementations are in infrastructure layer.\n */\n\nimport type { InputItem } from '../entities/Message.js';\n\n/**\n * Serialized context state for persistence.\n * This is the canonical definition - core layer re-exports this type.\n */\nexport interface SerializedContextState {\n  /** Conversation history */\n  conversation: InputItem[];\n  /** Plugin states (keyed by plugin name) */\n  pluginStates: Record<string, unknown>;\n  /** System prompt */\n  systemPrompt?: string;\n  /** Metadata */\n  metadata: {\n    savedAt: number;\n    agentId?: string;\n    userId?: string;\n    model: string;\n  };\n  /** Agent-specific state (for TaskAgent, UniversalAgent, etc.) */\n  agentState?: Record<string, unknown>;\n}\n\n\n/**\n * Session summary for listing (lightweight, no full state)\n */\nexport interface ContextSessionSummary {\n  /** Session identifier */\n  sessionId: string;\n\n  /** When the session was created */\n  createdAt: Date;\n\n  /** When the session was last saved */\n  lastSavedAt: Date;\n\n  /** Number of messages in history */\n  messageCount: number;\n\n  /** Number of memory entries */\n  memoryEntryCount: number;\n\n  /** Optional metadata */\n  metadata?: ContextSessionMetadata;\n}\n\n/**\n * Session metadata (stored with session)\n */\nexport interface ContextSessionMetadata {\n  /** Human-readable title */\n  title?: string;\n\n  /** Auto-generated or user-provided description */\n  description?: string;\n\n  /** Tags for filtering */\n  tags?: string[];\n\n  /** Custom key-value data */\n  [key: string]: unknown;\n}\n\n/**\n * Full session state wrapper (includes metadata)\n */\nexport interface StoredContextSession {\n  /** Format version for migration support */\n  version: number;\n\n  /** Session identifier */\n  sessionId: string;\n\n  /** When the session was created */\n  createdAt: string; // ISO string\n\n  /** When the session was last saved */\n  lastSavedAt: string; // ISO string\n\n  /** The serialized AgentContext state */\n  state: SerializedContextState;\n\n  /** Session metadata */\n  metadata: ContextSessionMetadata;\n}\n\n/**\n * Current format version for stored sessions\n */\nexport const CONTEXT_SESSION_FORMAT_VERSION = 1;\n\n/**\n * Storage interface for AgentContext persistence\n *\n * Implementations:\n * - FileContextStorage: File-based storage at ~/.oneringai/agents/<agentId>/sessions/\n * - (Future) RedisContextStorage, PostgresContextStorage, S3ContextStorage, etc.\n */\nexport interface IContextStorage {\n  /**\n   * Save context state to a session\n   *\n   * @param sessionId - Unique session identifier\n   * @param state - Serialized AgentContext state\n   * @param metadata - Optional session metadata\n   */\n  save(\n    sessionId: string,\n    state: SerializedContextState,\n    metadata?: ContextSessionMetadata\n  ): Promise<void>;\n\n  /**\n   * Load context state from a session\n   *\n   * @param sessionId - Session identifier to load\n   * @returns The stored session, or null if not found\n   */\n  load(sessionId: string): Promise<StoredContextSession | null>;\n\n  /**\n   * Delete a session\n   *\n   * @param sessionId - Session identifier to delete\n   */\n  delete(sessionId: string): Promise<void>;\n\n  /**\n   * Check if a session exists\n   *\n   * @param sessionId - Session identifier to check\n   */\n  exists(sessionId: string): Promise<boolean>;\n\n  /**\n   * List all sessions (summaries only, not full state)\n   *\n   * @param options - Optional filtering and pagination\n   * @returns Array of session summaries, sorted by lastSavedAt descending\n   */\n  list(options?: ContextStorageListOptions): Promise<ContextSessionSummary[]>;\n\n  /**\n   * Update session metadata without loading full state\n   *\n   * @param sessionId - Session identifier\n   * @param metadata - Metadata to merge (existing keys preserved unless overwritten)\n   */\n  updateMetadata?(\n    sessionId: string,\n    metadata: Partial<ContextSessionMetadata>\n  ): Promise<void>;\n\n  /**\n   * Get the storage path (for display/debugging)\n   * @deprecated Use getLocation() instead - getPath() assumes filesystem storage\n   */\n  getPath(): string;\n\n  /**\n   * Get a human-readable storage location string (for display/debugging).\n   * Examples: file path, MongoDB URI, Redis key prefix, S3 bucket, etc.\n   * Falls back to getPath() if not implemented.\n   */\n  getLocation?(): string;\n}\n\n/**\n * Options for listing sessions\n */\nexport interface ContextStorageListOptions {\n  /** Filter by tags (any match) */\n  tags?: string[];\n\n  /** Filter by creation date range */\n  createdAfter?: Date;\n  createdBefore?: Date;\n\n  /** Filter by last saved date range */\n  savedAfter?: Date;\n  savedBefore?: Date;\n\n  /** Maximum number of results */\n  limit?: number;\n\n  /** Offset for pagination */\n  offset?: number;\n}\n","/**\n * IAgentDefinitionStorage - Storage interface for Agent configuration persistence\n *\n * Provides persistence operations for agent definitions (configuration, model, system prompt, etc.).\n * This allows agents to be instantiated from stored configurations.\n *\n * This follows Clean Architecture - the interface is in domain layer,\n * implementations are in infrastructure layer.\n */\n\nimport type { ContextFeatures } from '../../core/context-nextgen/types.js';\n\n/**\n * Agent type identifier\n */\nexport type StoredAgentType = 'agent' | 'task-agent' | 'universal-agent' | 'research-agent' | string;\n\n/**\n * Stored agent definition - everything needed to recreate an agent\n */\nexport interface StoredAgentDefinition {\n  /** Format version for migration support */\n  version: number;\n\n  /** Unique agent identifier */\n  agentId: string;\n\n  /** Human-readable agent name */\n  name: string;\n\n  /** Agent type */\n  agentType: StoredAgentType;\n\n  /** When the definition was created */\n  createdAt: string; // ISO string\n\n  /** When the definition was last updated */\n  updatedAt: string; // ISO string\n\n  /** Connector configuration */\n  connector: {\n    /** Connector name (must be registered at runtime) */\n    name: string;\n    /** Model to use */\n    model: string;\n  };\n\n  /** System prompt */\n  systemPrompt?: string;\n\n  /** Instructions */\n  instructions?: string;\n\n  /** Feature configuration */\n  features?: ContextFeatures;\n\n  /** Agent metadata */\n  metadata?: AgentDefinitionMetadata;\n\n  /** Agent-type-specific configuration */\n  typeConfig?: Record<string, unknown>;\n}\n\n/**\n * Agent definition metadata\n */\nexport interface AgentDefinitionMetadata {\n  /** Description of what this agent does */\n  description?: string;\n\n  /** Tags for categorization */\n  tags?: string[];\n\n  /** Author/creator */\n  author?: string;\n\n  /** Custom key-value data */\n  [key: string]: unknown;\n}\n\n/**\n * Agent definition summary for listing\n */\nexport interface AgentDefinitionSummary {\n  /** Agent identifier */\n  agentId: string;\n\n  /** Agent name */\n  name: string;\n\n  /** Agent type */\n  agentType: StoredAgentType;\n\n  /** Model being used */\n  model: string;\n\n  /** When created */\n  createdAt: Date;\n\n  /** When last updated */\n  updatedAt: Date;\n\n  /** Optional metadata */\n  metadata?: AgentDefinitionMetadata;\n}\n\n/**\n * Current format version for stored agent definitions\n */\nexport const AGENT_DEFINITION_FORMAT_VERSION = 1;\n\n/**\n * Storage interface for agent definitions\n *\n * Implementations:\n * - FileAgentDefinitionStorage: File-based storage at ~/.oneringai/agents/<agentId>/\n * - (Future) DatabaseAgentDefinitionStorage, etc.\n */\nexport interface IAgentDefinitionStorage {\n  /**\n   * Save an agent definition\n   *\n   * @param definition - The agent definition to save\n   */\n  save(definition: StoredAgentDefinition): Promise<void>;\n\n  /**\n   * Load an agent definition\n   *\n   * @param agentId - Agent identifier to load\n   * @returns The stored definition, or null if not found\n   */\n  load(agentId: string): Promise<StoredAgentDefinition | null>;\n\n  /**\n   * Delete an agent definition\n   *\n   * @param agentId - Agent identifier to delete\n   */\n  delete(agentId: string): Promise<void>;\n\n  /**\n   * Check if an agent definition exists\n   *\n   * @param agentId - Agent identifier to check\n   */\n  exists(agentId: string): Promise<boolean>;\n\n  /**\n   * List all agent definitions (summaries only)\n   *\n   * @param options - Optional filtering\n   * @returns Array of agent summaries, sorted by updatedAt descending\n   */\n  list(options?: AgentDefinitionListOptions): Promise<AgentDefinitionSummary[]>;\n\n  /**\n   * Update agent definition metadata without loading full definition\n   *\n   * @param agentId - Agent identifier\n   * @param metadata - Metadata to merge\n   */\n  updateMetadata?(\n    agentId: string,\n    metadata: Partial<AgentDefinitionMetadata>\n  ): Promise<void>;\n\n  /**\n   * Get the storage path/location (for display/debugging)\n   */\n  getPath(): string;\n}\n\n/**\n * Options for listing agent definitions\n */\nexport interface AgentDefinitionListOptions {\n  /** Filter by agent type */\n  agentType?: StoredAgentType;\n\n  /** Filter by tags (any match) */\n  tags?: string[];\n\n  /** Maximum number of results */\n  limit?: number;\n\n  /** Offset for pagination */\n  offset?: number;\n}\n","/**\n * WorkingMemory class - manages indexed working memory for TaskAgent\n *\n * This is a GENERIC implementation that works across all agent types:\n * - Basic Agent: Uses staticPriorityCalculator with simple scopes\n * - TaskAgent: Uses taskAwarePriorityCalculator with task-aware scopes\n * - UniversalAgent: Can switch calculators based on mode\n *\n * The PriorityCalculator strategy pattern allows different agents to have\n * different eviction behaviors without changing the core WorkingMemory logic.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { IMemoryStorage } from '../../domain/interfaces/IMemoryStorage.js';\nimport { WorkingMemoryAccess } from '../../domain/interfaces/IToolContext.js';\nimport { IDisposable } from '../../domain/interfaces/IDisposable.js';\nimport type {\n  MemoryIndex,\n  MemoryScope,\n  MemoryPriority,\n  MemoryEntry,\n  MemoryEntryInput,\n  WorkingMemoryConfig,\n  PriorityCalculator,\n  PriorityContext,\n  StaleEntryInfo,\n  TaskStatusForMemory,\n} from '../../domain/entities/Memory.js';\nimport {\n  DEFAULT_MEMORY_CONFIG,\n  staticPriorityCalculator,\n  MEMORY_PRIORITY_VALUES,\n  isSimpleScope,\n  isTaskAwareScope,\n  detectStaleEntries,\n  createMemoryEntry,\n  formatSizeHuman,\n  formatMemoryIndex,\n  isTerminalMemoryStatus,\n  TIER_PRIORITIES,\n  TIER_KEY_PREFIXES,\n  getTierFromKey,\n  addTierPrefix,\n} from '../../domain/entities/Memory.js';\nimport type { MemoryTier, HierarchyMetadata } from '../../domain/entities/Memory.js';\n\n/**\n * Serialized memory state for persistence\n */\nexport interface SerializedMemory {\n  /** Memory format version */\n  version: number;\n  /** Serialized memory entries */\n  entries: SerializedMemoryEntry[];\n}\n\n/**\n * Serialized memory entry\n */\nexport interface SerializedMemoryEntry {\n  key: string;\n  description: string;\n  value: unknown;\n  scope: MemoryScope;\n  sizeBytes: number;\n  basePriority?: MemoryPriority;\n  pinned?: boolean;\n}\n\n/**\n * Eviction strategy type\n */\nexport type EvictionStrategy = 'lru' | 'size';\n\n/**\n * Entry with computed effective priority\n */\ninterface EntryWithPriority {\n  entry: MemoryEntry;\n  effectivePriority: MemoryPriority;\n}\n\nexport interface WorkingMemoryEvents {\n  stored: { key: string; description: string; scope: MemoryScope };\n  retrieved: { key: string };\n  deleted: { key: string };\n  evicted: { keys: string[]; reason: 'lru' | 'size' | 'task_completed' };\n  limit_warning: { utilizationPercent: number };\n  stale_entries: { entries: StaleEntryInfo[] };\n}\n\n/**\n * WorkingMemory manages the agent's indexed working memory.\n *\n * Features:\n * - Store/retrieve with descriptions for index\n * - Scoped memory (simple or task-aware)\n * - Priority-based eviction (respects pinned, priority, then LRU)\n * - Pluggable priority calculation via PriorityCalculator strategy\n * - Task completion detection and stale entry notification\n * - Event emission for monitoring\n */\nexport class WorkingMemory extends EventEmitter<WorkingMemoryEvents> implements IDisposable {\n  private storage: IMemoryStorage;\n  private config: WorkingMemoryConfig;\n  private priorityCalculator: PriorityCalculator;\n  private priorityContext: PriorityContext;\n  private _isDestroyed = false;\n\n  /**\n   * Create a WorkingMemory instance\n   *\n   * @param storage - Storage backend for memory entries\n   * @param config - Memory configuration (limits, etc.)\n   * @param priorityCalculator - Strategy for computing effective priority (default: static)\n   */\n  constructor(\n    storage: IMemoryStorage,\n    config: WorkingMemoryConfig = DEFAULT_MEMORY_CONFIG,\n    priorityCalculator: PriorityCalculator = staticPriorityCalculator\n  ) {\n    super();\n    this.storage = storage;\n    this.config = config;\n    this.priorityCalculator = priorityCalculator;\n    this.priorityContext = {};\n  }\n\n  /**\n   * Set the priority calculator (for switching strategies at runtime)\n   */\n  setPriorityCalculator(calculator: PriorityCalculator): void {\n    this.priorityCalculator = calculator;\n  }\n\n  /**\n   * Update priority context (e.g., task states for TaskAgent)\n   */\n  setPriorityContext(context: PriorityContext): void {\n    this.priorityContext = context;\n  }\n\n  /**\n   * Get the current priority context\n   */\n  getPriorityContext(): PriorityContext {\n    return this.priorityContext;\n  }\n\n  /**\n   * Compute effective priority for an entry using the current calculator\n   */\n  private computeEffectivePriority(entry: MemoryEntry): MemoryPriority {\n    return this.priorityCalculator(entry, this.priorityContext);\n  }\n\n  /**\n   * Get all entries with their computed effective priorities\n   * This is a performance optimization to avoid repeated getAll() + map() calls\n   */\n  private async getEntriesWithPriority(): Promise<EntryWithPriority[]> {\n    const entries = await this.storage.getAll();\n    return entries.map((entry) => ({\n      entry,\n      effectivePriority: this.computeEffectivePriority(entry),\n    }));\n  }\n\n  /**\n   * Get evictable entries sorted by eviction priority\n   * Filters out pinned and critical entries, sorts by priority then by strategy\n   */\n  private getEvictableEntries(\n    entriesWithPriority: EntryWithPriority[],\n    strategy: EvictionStrategy\n  ): EntryWithPriority[] {\n    return entriesWithPriority\n      .filter(({ entry, effectivePriority }) => {\n        // Never evict pinned\n        if (entry.pinned) return false;\n        // Never evict critical priority\n        if (effectivePriority === 'critical') return false;\n        return true;\n      })\n      .sort((a, b) => {\n        // Sort by priority first (lowest priority = evicted first)\n        const priorityDiff =\n          MEMORY_PRIORITY_VALUES[a.effectivePriority] -\n          MEMORY_PRIORITY_VALUES[b.effectivePriority];\n        if (priorityDiff !== 0) return priorityDiff;\n\n        // Then by strategy\n        if (strategy === 'lru') {\n          return a.entry.lastAccessedAt - b.entry.lastAccessedAt;\n        } else {\n          // size: largest first\n          return b.entry.sizeBytes - a.entry.sizeBytes;\n        }\n      });\n  }\n\n  /**\n   * Store a value in working memory\n   *\n   * @param key - Unique key for the entry\n   * @param description - Short description for the index (max 150 chars)\n   * @param value - The data to store\n   * @param options - Optional scope, priority, and pinned settings\n   */\n  async store(\n    key: string,\n    description: string,\n    value: unknown,\n    options?: {\n      scope?: MemoryScope;\n      priority?: MemoryPriority;\n      pinned?: boolean;\n    }\n  ): Promise<void> {\n    const input: MemoryEntryInput = {\n      key,\n      description,\n      value,\n      scope: options?.scope ?? 'session',\n      priority: options?.priority,\n      pinned: options?.pinned,\n    };\n\n    // Validate and create entry\n    const entry = createMemoryEntry(input, this.config);\n\n    // Check size limit\n    const currentSize = await this.storage.getTotalSize();\n    const existing = await this.storage.get(key);\n    const existingSize = existing?.sizeBytes ?? 0;\n    const newTotalSize = currentSize - existingSize + entry.sizeBytes;\n\n    const limit = this.getLimit();\n\n    if (newTotalSize > limit) {\n      throw new Error(`Memory limit exceeded: ${newTotalSize} bytes > ${limit} bytes`);\n    }\n\n    // Check soft limit warning\n    const utilization = (newTotalSize / limit) * 100;\n    if (utilization > this.config.softLimitPercent) {\n      this.emit('limit_warning', { utilizationPercent: utilization });\n    }\n\n    // Store entry\n    await this.storage.set(key, entry);\n\n    this.emit('stored', { key, description, scope: entry.scope });\n\n    // Auto-evict if entry count exceeds limit\n    await this.enforceEntryCountLimit();\n  }\n\n  /**\n   * Enforce the maxIndexEntries limit by evicting excess entries\n   * Only evicts if entry count exceeds the configured limit\n   */\n  private async enforceEntryCountLimit(): Promise<void> {\n    const maxEntries = this.getMaxIndexEntries();\n    if (!maxEntries) return; // No limit configured\n\n    const entries = await this.storage.getAll();\n    const excessCount = entries.length - maxEntries;\n\n    if (excessCount > 0) {\n      const evictedKeys = await this.evict(excessCount, 'lru');\n      if (evictedKeys.length > 0) {\n        // Note: evict() already emits 'evicted' event\n      }\n    }\n  }\n\n  /**\n   * Get the configured max index entries limit\n   */\n  getMaxIndexEntries(): number | undefined {\n    return this.config.maxIndexEntries;\n  }\n\n  /**\n   * Store a value scoped to specific tasks\n   * Convenience method for task-aware memory\n   */\n  async storeForTasks(\n    key: string,\n    description: string,\n    value: unknown,\n    taskIds: string[],\n    options?: { priority?: MemoryPriority; pinned?: boolean }\n  ): Promise<void> {\n    await this.store(key, description, value, {\n      scope: { type: 'task', taskIds },\n      priority: options?.priority,\n      pinned: options?.pinned,\n    });\n  }\n\n  /**\n   * Store a value scoped to the entire plan\n   * Convenience method for plan-scoped memory\n   */\n  async storeForPlan(\n    key: string,\n    description: string,\n    value: unknown,\n    options?: { priority?: MemoryPriority; pinned?: boolean }\n  ): Promise<void> {\n    await this.store(key, description, value, {\n      scope: { type: 'plan' },\n      priority: options?.priority,\n      pinned: options?.pinned,\n    });\n  }\n\n  /**\n   * Retrieve a value from working memory\n   *\n   * Note: Access stats update is not strictly atomic. Under very high concurrency,\n   * accessCount may be slightly inaccurate. This is acceptable for memory management\n   * purposes where exact counts are not critical.\n   */\n  async retrieve(key: string): Promise<unknown> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      return undefined;\n    }\n\n    // Capture value before async operations to reduce race window\n    const value = entry.value;\n\n    // Update access stats - do this in background to not block retrieval\n    // Re-fetch to minimize race condition window\n    const freshEntry = await this.storage.get(key);\n    if (freshEntry) {\n      freshEntry.lastAccessedAt = Date.now();\n      freshEntry.accessCount += 1;\n      await this.storage.set(key, freshEntry);\n    }\n\n    this.emit('retrieved', { key });\n\n    return value;\n  }\n\n  /**\n   * Retrieve multiple values\n   */\n  async retrieveMany(keys: string[]): Promise<Record<string, unknown>> {\n    const result: Record<string, unknown> = {};\n\n    for (const key of keys) {\n      const value = await this.retrieve(key);\n      if (value !== undefined) {\n        result[key] = value;\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Delete a value from working memory\n   */\n  async delete(key: string): Promise<void> {\n    await this.storage.delete(key);\n    this.emit('deleted', { key });\n  }\n\n  /**\n   * Check if key exists\n   */\n  async has(key: string): Promise<boolean> {\n    return this.storage.has(key);\n  }\n\n  /**\n   * Promote an entry to persistent scope\n   * Works with both simple and task-aware scopes\n   */\n  async persist(key: string): Promise<void> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    // Check if already persistent\n    const isPersistent = isSimpleScope(entry.scope)\n      ? entry.scope === 'persistent'\n      : isTaskAwareScope(entry.scope) && entry.scope.type === 'persistent';\n\n    if (!isPersistent) {\n      entry.scope = { type: 'persistent' };\n      await this.storage.set(key, entry);\n    }\n  }\n\n  /**\n   * Pin an entry (never evicted)\n   */\n  async pin(key: string): Promise<void> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    if (!entry.pinned) {\n      entry.pinned = true;\n      entry.basePriority = 'critical';\n      await this.storage.set(key, entry);\n    }\n  }\n\n  /**\n   * Unpin an entry\n   */\n  async unpin(key: string, newPriority: MemoryPriority = 'normal'): Promise<void> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    if (entry.pinned) {\n      entry.pinned = false;\n      entry.basePriority = newPriority;\n      await this.storage.set(key, entry);\n    }\n  }\n\n  /**\n   * Set the base priority of an entry\n   */\n  async setPriority(key: string, priority: MemoryPriority): Promise<void> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    entry.basePriority = priority;\n    await this.storage.set(key, entry);\n  }\n\n  /**\n   * Update the scope of an entry without re-storing the value\n   */\n  async updateScope(key: string, scope: MemoryScope): Promise<void> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    entry.scope = scope;\n    await this.storage.set(key, entry);\n  }\n\n  /**\n   * Add task IDs to an existing task-scoped entry\n   * If entry is not task-scoped, converts it to task-scoped\n   */\n  async addTasksToScope(key: string, taskIds: string[]): Promise<void> {\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    if (isTaskAwareScope(entry.scope) && entry.scope.type === 'task') {\n      // Merge task IDs, removing duplicates\n      const existingIds = new Set(entry.scope.taskIds);\n      for (const id of taskIds) {\n        existingIds.add(id);\n      }\n      entry.scope = { type: 'task', taskIds: Array.from(existingIds) };\n    } else {\n      // Convert to task-scoped\n      entry.scope = { type: 'task', taskIds };\n    }\n\n    await this.storage.set(key, entry);\n  }\n\n  /**\n   * Clear all entries of a specific scope\n   */\n  async clearScope(scope: MemoryScope): Promise<void> {\n    await this.storage.clearScope(scope);\n  }\n\n  /**\n   * Clear all entries\n   */\n  async clear(): Promise<void> {\n    await this.storage.clear();\n  }\n\n  /**\n   * Get memory index with computed effective priorities\n   * Respects maxIndexEntries limit for context display\n   */\n  async getIndex(): Promise<MemoryIndex> {\n    const entriesWithPriority = await this.getEntriesWithPriority();\n    const totalSizeBytes = await this.storage.getTotalSize();\n    const limitBytes = this.getLimit();\n    const totalEntryCount = entriesWithPriority.length;\n\n    // Sort by: pinned first, then by priority (critical > high > normal > low), then by LRU\n    const sortedEntries = [...entriesWithPriority].sort((a, b) => {\n      // Pinned first\n      if (a.entry.pinned && !b.entry.pinned) return -1;\n      if (!a.entry.pinned && b.entry.pinned) return 1;\n\n      // Then by effective priority (higher priority first)\n      const priorityDiff =\n        MEMORY_PRIORITY_VALUES[b.effectivePriority] -\n        MEMORY_PRIORITY_VALUES[a.effectivePriority];\n      if (priorityDiff !== 0) return priorityDiff;\n\n      // Then by last access time (most recent first)\n      return b.entry.lastAccessedAt - a.entry.lastAccessedAt;\n    });\n\n    // Apply maxIndexEntries limit for context display (keeps highest priority entries)\n    const maxEntries = this.config.maxIndexEntries;\n    const displayEntries = maxEntries ? sortedEntries.slice(0, maxEntries) : sortedEntries;\n    const omittedCount = sortedEntries.length - displayEntries.length;\n\n    const indexEntries = displayEntries.map(({ entry, effectivePriority }) => ({\n      key: entry.key,\n      description: entry.description,\n      size: formatSizeHuman(entry.sizeBytes),\n      scope: entry.scope,\n      effectivePriority,\n      pinned: entry.pinned,\n    }));\n\n    return {\n      entries: indexEntries,\n      totalSizeBytes,\n      totalSizeHuman: formatSizeHuman(totalSizeBytes),\n      limitBytes,\n      limitHuman: formatSizeHuman(limitBytes),\n      utilizationPercent: (totalSizeBytes / limitBytes) * 100,\n      totalEntryCount,\n      omittedCount,\n    };\n  }\n\n  /**\n   * Format index for context injection\n   */\n  async formatIndex(): Promise<string> {\n    const index = await this.getIndex();\n    return formatMemoryIndex(index);\n  }\n\n  /**\n   * Evict entries using specified strategy\n   *\n   * Eviction order:\n   * 1. Never evict pinned entries\n   * 2. Evict low priority first, then normal, then high (never critical)\n   * 3. Within same priority, use strategy (LRU or largest size)\n   *\n   * @param count - Number of entries to evict\n   * @param strategy - Eviction strategy ('lru' or 'size')\n   * @returns Keys of evicted entries\n   */\n  async evict(count: number, strategy: EvictionStrategy = 'lru'): Promise<string[]> {\n    const entriesWithPriority = await this.getEntriesWithPriority();\n    const evictable = this.getEvictableEntries(entriesWithPriority, strategy);\n\n    const toEvict = evictable.slice(0, count);\n    const evictedKeys: string[] = [];\n\n    for (const { entry } of toEvict) {\n      await this.storage.delete(entry.key);\n      evictedKeys.push(entry.key);\n    }\n\n    if (evictedKeys.length > 0) {\n      this.emit('evicted', { keys: evictedKeys, reason: strategy });\n    }\n\n    return evictedKeys;\n  }\n\n  /**\n   * Evict entries using priority-aware LRU algorithm\n   * @deprecated Use evict(count, 'lru') instead\n   */\n  async evictLRU(count: number): Promise<string[]> {\n    return this.evict(count, 'lru');\n  }\n\n  /**\n   * Evict largest entries first (priority-aware)\n   * @deprecated Use evict(count, 'size') instead\n   */\n  async evictBySize(count: number): Promise<string[]> {\n    return this.evict(count, 'size');\n  }\n\n  /**\n   * Handle task completion - detect and notify about stale entries\n   *\n   * Call this when a task completes to:\n   * 1. Update priority context with new task state\n   * 2. Detect entries that became stale\n   * 3. Emit event to notify LLM about stale entries\n   *\n   * @param taskId - The completed task ID\n   * @param taskStates - Current task states map\n   * @returns Information about stale entries\n   */\n  async onTaskComplete(\n    taskId: string,\n    taskStates: Map<string, TaskStatusForMemory>\n  ): Promise<StaleEntryInfo[]> {\n    // Update priority context\n    this.priorityContext.taskStates = taskStates;\n\n    // Get all entries\n    const entries = await this.storage.getAll();\n\n    // Detect stale entries\n    const staleEntries = detectStaleEntries(entries, taskId, taskStates);\n\n    // Emit event if there are stale entries\n    if (staleEntries.length > 0) {\n      this.emit('stale_entries', { entries: staleEntries });\n    }\n\n    return staleEntries;\n  }\n\n  /**\n   * Evict entries for completed tasks\n   *\n   * Removes entries that were scoped only to completed tasks.\n   * Use after onTaskComplete() if you want automatic cleanup.\n   *\n   * @param taskStates - Current task states map\n   * @returns Keys of evicted entries\n   */\n  async evictCompletedTaskEntries(\n    taskStates: Map<string, TaskStatusForMemory>\n  ): Promise<string[]> {\n    const entries = await this.storage.getAll();\n    const evictedKeys: string[] = [];\n\n    for (const entry of entries) {\n      // Skip pinned\n      if (entry.pinned) continue;\n\n      // Only check task-scoped entries\n      if (!isTaskAwareScope(entry.scope) || entry.scope.type !== 'task') continue;\n\n      // Check if ALL tasks for this entry are terminal\n      const allTerminal = entry.scope.taskIds.every((taskId) => {\n        const status = taskStates.get(taskId);\n        return status ? isTerminalMemoryStatus(status) : false;\n      });\n\n      if (allTerminal) {\n        await this.storage.delete(entry.key);\n        evictedKeys.push(entry.key);\n      }\n    }\n\n    if (evictedKeys.length > 0) {\n      this.emit('evicted', { keys: evictedKeys, reason: 'task_completed' });\n    }\n\n    return evictedKeys;\n  }\n\n  /**\n   * Get limited memory access for tools\n   *\n   * This provides a simplified interface for tools to interact with memory\n   * without exposing the full WorkingMemory API.\n   */\n  getAccess(): WorkingMemoryAccess {\n    return {\n      get: async (key: string) => this.retrieve(key),\n      set: async (key: string, description: string, value: unknown, options?: {\n        scope?: MemoryScope;\n        priority?: MemoryPriority;\n        pinned?: boolean;\n      }) => this.store(key, description, value, options),\n      delete: async (key: string) => this.delete(key),\n      has: async (key: string) => this.has(key),\n      list: async () => {\n        const index = await this.getIndex();\n        return index.entries.map((e) => ({\n          key: e.key,\n          description: e.description,\n          effectivePriority: e.effectivePriority,\n          pinned: e.pinned,\n        }));\n      },\n    };\n  }\n\n  // ============================================================================\n  // HIERARCHICAL MEMORY HELPERS\n  // ============================================================================\n\n  /**\n   * Store raw data (low priority, first to be evicted)\n   *\n   * Use this for original/unprocessed data that should be summarized.\n   * Raw data is automatically evicted first when memory pressure is high.\n   *\n   * @param key - Key without tier prefix (prefix is added automatically)\n   * @param description - Brief description for the index\n   * @param value - The raw data to store\n   * @param options - Optional scope and task IDs\n   */\n  async storeRaw(\n    key: string,\n    description: string,\n    value: unknown,\n    options?: { taskIds?: string[]; scope?: MemoryScope }\n  ): Promise<void> {\n    const fullKey = addTierPrefix(key, 'raw');\n    const scope = options?.taskIds\n      ? { type: 'task' as const, taskIds: options.taskIds }\n      : options?.scope ?? 'session';\n\n    await this.store(fullKey, description, value, {\n      scope,\n      priority: TIER_PRIORITIES.raw,\n    });\n  }\n\n  /**\n   * Store a summary derived from raw data (normal priority)\n   *\n   * Use this for processed/summarized data that extracts key information.\n   * Links back to source data for cleanup tracking.\n   *\n   * @param key - Key without tier prefix (prefix is added automatically)\n   * @param description - Brief description for the index\n   * @param value - The summary data\n   * @param derivedFrom - Key(s) this summary was derived from\n   * @param options - Optional scope and task IDs\n   */\n  async storeSummary(\n    key: string,\n    description: string,\n    value: unknown,\n    derivedFrom: string | string[],\n    options?: { taskIds?: string[]; scope?: MemoryScope }\n  ): Promise<void> {\n    const fullKey = addTierPrefix(key, 'summary');\n    const sourceKeys = Array.isArray(derivedFrom) ? derivedFrom : [derivedFrom];\n    const scope = options?.taskIds\n      ? { type: 'task' as const, taskIds: options.taskIds }\n      : options?.scope ?? { type: 'plan' as const };\n\n    await this.store(fullKey, description, value, {\n      scope,\n      priority: TIER_PRIORITIES.summary,\n    });\n\n    // Update source entries with derivedTo reference (best effort)\n    for (const sourceKey of sourceKeys) {\n      try {\n        const sourceEntry = await this.storage.get(sourceKey);\n        if (sourceEntry) {\n          const metadata = (sourceEntry.value as Record<string, unknown>)?.metadata as HierarchyMetadata | undefined;\n          const existingDerivedTo = metadata?.derivedTo ?? [];\n          if (!existingDerivedTo.includes(fullKey)) {\n            // We can't easily update metadata without re-storing the value\n            // This is a limitation - we track derivedFrom on the child instead\n          }\n        }\n      } catch {\n        // Ignore errors updating source - it may have been evicted\n      }\n    }\n  }\n\n  /**\n   * Store final findings (high priority, kept longest)\n   *\n   * Use this for conclusions, insights, or final results that should be preserved.\n   * These are the last to be evicted and typically span the entire plan.\n   *\n   * @param key - Key without tier prefix (prefix is added automatically)\n   * @param description - Brief description for the index\n   * @param value - The findings data\n   * @param derivedFrom - Optional key(s) these findings were derived from\n   * @param options - Optional scope, task IDs, and pinned flag\n   */\n  async storeFindings(\n    key: string,\n    description: string,\n    value: unknown,\n    _derivedFrom?: string | string[],\n    options?: { taskIds?: string[]; scope?: MemoryScope; pinned?: boolean }\n  ): Promise<void> {\n    const fullKey = addTierPrefix(key, 'findings');\n    const scope = options?.scope ?? { type: 'plan' as const };\n\n    // Note: _derivedFrom is available for future metadata tracking if needed\n    await this.store(fullKey, description, value, {\n      scope,\n      priority: TIER_PRIORITIES.findings,\n      pinned: options?.pinned,\n    });\n  }\n\n  /**\n   * Clean up raw data after summary/findings are created\n   *\n   * Call this after creating summaries to free up memory used by raw data.\n   * Only deletes entries in the 'raw' tier.\n   *\n   * @param derivedFromKeys - Keys to delete (typically from derivedFrom metadata)\n   * @returns Number of entries deleted\n   */\n  async cleanupRawData(derivedFromKeys: string[]): Promise<number> {\n    let deletedCount = 0;\n\n    for (const key of derivedFromKeys) {\n      // Only delete if it's actually a raw tier entry\n      const tier = getTierFromKey(key);\n      if (tier === 'raw') {\n        const exists = await this.has(key);\n        if (exists) {\n          await this.delete(key);\n          deletedCount++;\n        }\n      }\n    }\n\n    return deletedCount;\n  }\n\n  /**\n   * Get all entries by tier\n   *\n   * @param tier - The tier to filter by\n   * @returns Array of entries in that tier\n   */\n  async getByTier(tier: MemoryTier): Promise<MemoryEntry[]> {\n    const entries = await this.storage.getAll();\n    const prefix = TIER_KEY_PREFIXES[tier];\n    return entries.filter((e) => e.key.startsWith(prefix));\n  }\n\n  /**\n   * Promote an entry to a higher tier\n   *\n   * Changes the key prefix and updates priority.\n   * Use this when raw data becomes more valuable (e.g., frequently accessed).\n   *\n   * @param key - Current key (with tier prefix)\n   * @param toTier - Target tier to promote to\n   * @returns New key with updated prefix\n   */\n  async promote(key: string, toTier: MemoryTier): Promise<string> {\n    const currentTier = getTierFromKey(key);\n    if (currentTier === toTier) {\n      return key; // Already in target tier\n    }\n\n    const entry = await this.storage.get(key);\n    if (!entry) {\n      throw new Error(`Key \"${key}\" not found in memory`);\n    }\n\n    // Create new entry with new tier\n    const newKey = addTierPrefix(key, toTier);\n    const newPriority = TIER_PRIORITIES[toTier];\n\n    // Store with new key and priority\n    await this.store(newKey, entry.description, entry.value, {\n      scope: entry.scope,\n      priority: newPriority,\n      pinned: entry.pinned,\n    });\n\n    // Delete old entry\n    await this.delete(key);\n\n    return newKey;\n  }\n\n  /**\n   * Get tier statistics\n   *\n   * @returns Count and size by tier\n   */\n  async getTierStats(): Promise<Record<MemoryTier, { count: number; sizeBytes: number }>> {\n    const entries = await this.storage.getAll();\n    const stats: Record<MemoryTier, { count: number; sizeBytes: number }> = {\n      raw: { count: 0, sizeBytes: 0 },\n      summary: { count: 0, sizeBytes: 0 },\n      findings: { count: 0, sizeBytes: 0 },\n    };\n\n    for (const entry of entries) {\n      const tier = getTierFromKey(entry.key);\n      if (tier) {\n        stats[tier].count++;\n        stats[tier].sizeBytes += entry.sizeBytes;\n      }\n    }\n\n    return stats;\n  }\n\n  /**\n   * Get statistics about memory usage\n   */\n  async getStats(): Promise<{\n    totalEntries: number;\n    totalSizeBytes: number;\n    utilizationPercent: number;\n    byPriority: Record<MemoryPriority, number>;\n    pinnedCount: number;\n  }> {\n    const entriesWithPriority = await this.getEntriesWithPriority();\n    const totalSizeBytes = await this.storage.getTotalSize();\n    const limit = this.getLimit();\n\n    const byPriority: Record<MemoryPriority, number> = {\n      critical: 0,\n      high: 0,\n      normal: 0,\n      low: 0,\n    };\n\n    let pinnedCount = 0;\n\n    for (const { entry, effectivePriority } of entriesWithPriority) {\n      byPriority[effectivePriority]++;\n      if (entry.pinned) pinnedCount++;\n    }\n\n    return {\n      totalEntries: entriesWithPriority.length,\n      totalSizeBytes,\n      utilizationPercent: (totalSizeBytes / limit) * 100,\n      byPriority,\n      pinnedCount,\n    };\n  }\n\n  /**\n   * Get the configured memory limit\n   */\n  getLimit(): number {\n    return this.config.maxSizeBytes ?? 25 * 1024 * 1024; // Default 25MB\n  }\n\n  /**\n   * Check if the WorkingMemory instance has been destroyed\n   */\n  get isDestroyed(): boolean {\n    return this._isDestroyed;\n  }\n\n  /**\n   * Destroy the WorkingMemory instance\n   * Removes all event listeners and clears internal state\n   */\n  destroy(): void {\n    if (this._isDestroyed) return;\n    this._isDestroyed = true;\n    this.removeAllListeners();\n    this.priorityContext = {};\n  }\n\n  // ============================================================================\n  // Serialization (for session persistence)\n  // ============================================================================\n\n  /**\n   * Serialize all memory entries for persistence\n   *\n   * Returns a serializable representation of all memory entries\n   * that can be saved to storage and restored later.\n   *\n   * @returns Serialized memory state\n   */\n  async serialize(): Promise<SerializedMemory> {\n    const entries = await this.storage.getAll();\n\n    const serializedEntries: SerializedMemoryEntry[] = entries.map((entry) => ({\n      key: entry.key,\n      description: entry.description,\n      value: entry.value,\n      scope: entry.scope,\n      sizeBytes: entry.sizeBytes,\n      basePriority: entry.basePriority,\n      pinned: entry.pinned,\n      // Note: createdAt, lastAccessedAt, accessCount are not persisted\n      // They will be reset on restore (entries start fresh)\n    }));\n\n    return {\n      version: 1,\n      entries: serializedEntries,\n    };\n  }\n\n  /**\n   * Restore memory entries from serialized state\n   *\n   * Clears existing memory and repopulates from the serialized state.\n   * Timestamps are reset to current time.\n   *\n   * @param state - Previously serialized memory state\n   */\n  async restore(state: SerializedMemory): Promise<void> {\n    // Validate version\n    if (state.version !== 1) {\n      throw new Error(`Unsupported memory serialization version: ${state.version}`);\n    }\n\n    // Clear existing entries\n    await this.storage.clear();\n\n    // Restore each entry\n    const now = Date.now();\n    for (const entry of state.entries) {\n      const fullEntry: MemoryEntry = {\n        key: entry.key,\n        description: entry.description,\n        value: entry.value,\n        scope: entry.scope,\n        sizeBytes: entry.sizeBytes,\n        basePriority: entry.basePriority ?? 'normal',\n        pinned: entry.pinned ?? false,\n        createdAt: now,\n        lastAccessedAt: now,\n        accessCount: 0,\n      };\n\n      await this.storage.set(entry.key, fullEntry);\n    }\n  }\n}\n\nexport type { WorkingMemoryConfig, PriorityCalculator, PriorityContext, StaleEntryInfo, MemoryTier, HierarchyMetadata };\nexport {\n  DEFAULT_MEMORY_CONFIG,\n  staticPriorityCalculator,\n  MEMORY_PRIORITY_VALUES,\n  TIER_PRIORITIES,\n  TIER_KEY_PREFIXES,\n  getTierFromKey,\n  addTierPrefix,\n};\n","/**\n * ExternalDependencyHandler - handles external dependencies\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { Task } from '../../domain/entities/Task.js';\nimport { ToolFunction } from '../../domain/entities/Tool.js';\nimport { calculateBackoff, BackoffConfig } from '../../infrastructure/resilience/BackoffStrategy.js';\n\nexport interface ExternalDependencyEvents {\n  'webhook:received': { webhookId: string; data: unknown };\n  'poll:success': { taskId: string; data: unknown };\n  'poll:timeout': { taskId: string };\n  'scheduled:triggered': { taskId: string };\n  'manual:completed': { taskId: string; data: unknown };\n}\n\n/**\n * Handles external task dependencies\n */\nexport class ExternalDependencyHandler extends EventEmitter<ExternalDependencyEvents> {\n  private activePolls = new Map<string, NodeJS.Timeout>();\n  private activeScheduled = new Map<string, NodeJS.Timeout>();\n  private cancelledPolls = new Set<string>(); // Track cancelled polls\n  private tools: Map<string, ToolFunction>;\n\n  constructor(tools: ToolFunction[] = []) {\n    super();\n    this.tools = new Map(tools.map((t) => [t.definition.function.name, t]));\n  }\n\n  /**\n   * Start handling a task's external dependency\n   */\n  async startWaiting(task: Task): Promise<void> {\n    if (!task.externalDependency) {\n      return;\n    }\n\n    const dep = task.externalDependency;\n\n    switch (dep.type) {\n      case 'webhook':\n        // Webhooks are passive - just wait for triggerWebhook() to be called\n        break;\n\n      case 'poll':\n        this.startPolling(task);\n        break;\n\n      case 'scheduled':\n        this.scheduleTask(task);\n        break;\n\n      case 'manual':\n        // Manual tasks wait for completeManually() to be called\n        break;\n    }\n  }\n\n  /**\n   * Stop waiting on a task's external dependency\n   */\n  stopWaiting(task: Task): void {\n    if (!task.externalDependency) {\n      return;\n    }\n\n    // Mark poll as cancelled (for async loop to check)\n    this.cancelledPolls.add(task.id);\n\n    // Clear any active polling timer (now using setTimeout with backoff)\n    const pollTimer = this.activePolls.get(task.id);\n    if (pollTimer) {\n      clearTimeout(pollTimer);\n      this.activePolls.delete(task.id);\n    }\n\n    const scheduleTimer = this.activeScheduled.get(task.id);\n    if (scheduleTimer) {\n      clearTimeout(scheduleTimer);\n      this.activeScheduled.delete(task.id);\n    }\n  }\n\n  /**\n   * Trigger a webhook\n   */\n  async triggerWebhook(webhookId: string, data: unknown): Promise<void> {\n    this.emit('webhook:received', { webhookId, data });\n  }\n\n  /**\n   * Complete a manual task\n   */\n  async completeManual(taskId: string, data: unknown): Promise<void> {\n    this.emit('manual:completed', { taskId, data });\n  }\n\n  /**\n   * Start polling for a task with exponential backoff\n   */\n  private startPolling(task: Task): void {\n    const dep = task.externalDependency!;\n    const pollConfig = dep.pollConfig!;\n\n    // Configure backoff: start at configured interval, cap at 4x initial\n    const backoffConfig: BackoffConfig = {\n      strategy: 'exponential',\n      initialDelayMs: pollConfig.intervalMs,\n      maxDelayMs: pollConfig.intervalMs * 4, // Cap at 4x initial interval\n      jitter: true,\n      jitterFactor: 0.1, // 10% jitter to prevent thundering herd\n    };\n\n    // Clear any previous cancellation flag\n    this.cancelledPolls.delete(task.id);\n\n    // Use async IIFE for the polling loop with backoff\n    (async () => {\n      let attempts = 0;\n\n      while (attempts < pollConfig.maxAttempts) {\n        // Check if cancelled before each attempt\n        if (this.cancelledPolls.has(task.id)) {\n          this.cancelledPolls.delete(task.id);\n          return;\n        }\n\n        attempts++;\n\n        try {\n          // Get the tool\n          const tool = this.tools.get(pollConfig.toolName);\n          if (!tool) {\n            console.error(`Poll tool ${pollConfig.toolName} not found`);\n            return;\n          }\n\n          // Execute the tool\n          const result = await tool.execute(pollConfig.toolArgs);\n\n          // Check if result indicates completion\n          // For simplicity, any truthy result means complete\n          if (result) {\n            this.emit('poll:success', { taskId: task.id, data: result });\n            return; // Success - exit loop\n          }\n        } catch (error) {\n          console.error(`Poll error for task ${task.id}:`, error);\n        }\n\n        // Check if more attempts remain\n        if (attempts >= pollConfig.maxAttempts) {\n          this.emit('poll:timeout', { taskId: task.id });\n          return;\n        }\n\n        // Wait with backoff before next attempt\n        const delay = calculateBackoff(attempts, backoffConfig);\n        await new Promise<void>((resolve) => {\n          const timer = setTimeout(resolve, delay);\n          // Store timer for cancellation\n          this.activePolls.set(task.id, timer);\n        });\n\n        // Check if cancelled after wait\n        if (this.cancelledPolls.has(task.id)) {\n          this.cancelledPolls.delete(task.id);\n          return;\n        }\n      }\n    })();\n  }\n\n  /**\n   * Schedule a task to trigger at a specific time\n   */\n  private scheduleTask(task: Task): void {\n    const dep = task.externalDependency!;\n    const scheduledAt = dep.scheduledAt!;\n\n    const delay = scheduledAt - Date.now();\n\n    if (delay <= 0) {\n      // Already past scheduled time, trigger immediately\n      this.emit('scheduled:triggered', { taskId: task.id });\n      return;\n    }\n\n    const timer = setTimeout(() => {\n      this.emit('scheduled:triggered', { taskId: task.id });\n      this.activeScheduled.delete(task.id);\n    }, delay);\n\n    this.activeScheduled.set(task.id, timer);\n  }\n\n  /**\n   * Cleanup all active dependencies\n   */\n  cleanup(): void {\n    // Mark all active polls as cancelled\n    for (const taskId of this.activePolls.keys()) {\n      this.cancelledPolls.add(taskId);\n    }\n\n    // Clear all polling timers (now using setTimeout with backoff)\n    for (const timer of this.activePolls.values()) {\n      clearTimeout(timer);\n    }\n    this.activePolls.clear();\n\n    // Clear scheduled timers\n    for (const timer of this.activeScheduled.values()) {\n      clearTimeout(timer);\n    }\n    this.activeScheduled.clear();\n  }\n\n  /**\n   * Update available tools\n   */\n  updateTools(tools: ToolFunction[]): void {\n    this.tools = new Map(tools.map((t) => [t.definition.function.name, t]));\n  }\n}\n","/**\n * CheckpointManager - manages agent state checkpointing\n */\n\nimport { AgentState } from '../../domain/entities/AgentState.js';\nimport { IAgentStorage } from '../../infrastructure/storage/InMemoryStorage.js';\n\nexport interface CheckpointStrategy {\n  /** Checkpoint after every N tool calls */\n  afterToolCalls?: number;\n\n  /** Checkpoint after every N LLM calls */\n  afterLLMCalls?: number;\n\n  /** Checkpoint on time interval */\n  intervalMs?: number;\n\n  /** Always checkpoint before external wait */\n  beforeExternalWait: boolean;\n\n  /** Checkpoint mode */\n  mode: 'sync' | 'async';\n}\n\nexport const DEFAULT_CHECKPOINT_STRATEGY: CheckpointStrategy = {\n  afterToolCalls: 1,\n  afterLLMCalls: 1,\n  intervalMs: 30000, // 30 seconds\n  beforeExternalWait: true,\n  mode: 'async',\n};\n\n/**\n * Manages state checkpointing for persistence and recovery\n */\nexport class CheckpointManager {\n  private storage: IAgentStorage;\n  private strategy: CheckpointStrategy;\n  private toolCallsSinceCheckpoint = 0;\n  private llmCallsSinceCheckpoint = 0;\n  private intervalTimer?: NodeJS.Timeout;\n  private pendingCheckpoints = new Set<Promise<void>>();\n  private currentState: AgentState | null = null;\n\n  constructor(storage: IAgentStorage, strategy: CheckpointStrategy = DEFAULT_CHECKPOINT_STRATEGY) {\n    this.storage = storage;\n    this.strategy = strategy;\n\n    // Start interval timer if configured\n    if (this.strategy.intervalMs) {\n      this.intervalTimer = setInterval(() => {\n        this.checkIntervalCheckpoint();\n      }, this.strategy.intervalMs);\n    }\n  }\n\n  /**\n   * Set the current agent state (for interval checkpointing)\n   */\n  setCurrentState(state: AgentState): void {\n    this.currentState = state;\n  }\n\n  /**\n   * Record a tool call (may trigger checkpoint)\n   */\n  async onToolCall(state: AgentState): Promise<void> {\n    this.toolCallsSinceCheckpoint++;\n\n    if (this.strategy.afterToolCalls && this.toolCallsSinceCheckpoint >= this.strategy.afterToolCalls) {\n      await this.checkpoint(state, 'tool_calls');\n    }\n  }\n\n  /**\n   * Record an LLM call (may trigger checkpoint)\n   */\n  async onLLMCall(state: AgentState): Promise<void> {\n    this.llmCallsSinceCheckpoint++;\n\n    if (this.strategy.afterLLMCalls && this.llmCallsSinceCheckpoint >= this.strategy.afterLLMCalls) {\n      await this.checkpoint(state, 'llm_calls');\n    }\n  }\n\n  /**\n   * Force a checkpoint\n   */\n  async checkpoint(state: AgentState, reason: string): Promise<void> {\n    const checkpointPromise = this.doCheckpoint(state, reason);\n\n    if (this.strategy.mode === 'sync') {\n      await checkpointPromise;\n    } else {\n      // Async mode - don't block, but track the promise\n      this.pendingCheckpoints.add(checkpointPromise);\n      checkpointPromise.finally(() => {\n        this.pendingCheckpoints.delete(checkpointPromise);\n      });\n    }\n  }\n\n  /**\n   * Perform the actual checkpoint\n   */\n  private async doCheckpoint(state: AgentState, _reason: string): Promise<void> {\n    try {\n      // Save agent state\n      await this.storage.agent.save(state);\n\n      // Save plan\n      await this.storage.plan.savePlan(state.plan);\n\n      // Reset counters\n      this.toolCallsSinceCheckpoint = 0;\n      this.llmCallsSinceCheckpoint = 0;\n    } catch (error) {\n      console.error(`Checkpoint failed (${_reason}):`, error);\n      // Don't throw - checkpointing is best-effort\n    }\n  }\n\n  /**\n   * Check if interval-based checkpoint is needed\n   */\n  private checkIntervalCheckpoint(): void {\n    if (this.currentState) {\n      // Trigger interval checkpoint\n      this.checkpoint(this.currentState, 'interval');\n    }\n  }\n\n  /**\n   * Wait for all pending checkpoints to complete\n   */\n  async flush(): Promise<void> {\n    await Promise.all(Array.from(this.pendingCheckpoints));\n  }\n\n  /**\n   * Cleanup resources\n   */\n  async cleanup(): Promise<void> {\n    if (this.intervalTimer) {\n      clearInterval(this.intervalTimer);\n    }\n\n    // Wait for all pending checkpoints to complete\n    await this.flush();\n  }\n}\n","/**\n * PlanningAgent - AI-driven plan generation\n *\n * Separates planning phase from execution phase.\n * Analyzes goals and generates task graphs with dependencies.\n */\n\nimport { Agent } from '../../core/Agent.js';\nimport { Connector } from '../../core/Connector.js';\nimport { ToolFunction } from '../../domain/entities/Tool.js';\nimport { Plan, TaskInput, TaskValidation, createPlan } from '../../domain/entities/Task.js';\n\n/**\n * PlanningAgent configuration\n */\nexport interface PlanningAgentConfig {\n  /** Connector for LLM access */\n  connector: string | Connector;\n\n  /** Model to use for planning (can be different/cheaper than execution) */\n  model: string;\n\n  /** Max planning iterations */\n  maxPlanningIterations?: number;\n\n  /** Temperature for planning (lower = more deterministic) */\n  planningTemperature?: number;\n\n  /** Tools available for the plan (used to inform planning) */\n  availableTools?: ToolFunction[];\n}\n\n/**\n * Generated plan with metadata\n */\nexport interface GeneratedPlan {\n  plan: Plan;\n  reasoning: string;\n  estimated_duration?: string;\n  complexity?: 'low' | 'medium' | 'high';\n}\n\n/**\n * Planning system prompt\n */\nconst PLANNING_SYSTEM_PROMPT = `You are an AI planning agent. Your job is to analyze goals and break them down into structured, executable task plans.\n\n**Your Role:**\n1. Analyze the user's goal and context\n2. Break down the goal into logical, atomic tasks\n3. Identify dependencies between tasks\n4. Define completion criteria for each task (how we know the task is done)\n5. Structure tasks for optimal execution (parallel where possible)\n6. Use the planning tools to create the plan\n\n**Planning Principles:**\n- Each task should have a single, clear responsibility\n- Tasks should be atomic (can't be broken down further meaningfully)\n- Dependencies should be explicit (use dependsOn)\n- Parallel tasks should be marked as such (execution.parallel)\n- Task names should be descriptive snake_case (e.g., \"fetch_user_data\")\n- Descriptions should be clear and actionable\n\n**Completion Criteria Guidelines:**\nEach task should have clear, natural language completion criteria that describe how to verify the task is complete. These criteria should be:\n- Specific and measurable (e.g., \"response contains at least 5 items\")\n- Flexible, not rigid (avoid exact JSON schemas or exact string matches)\n- Focused on outcomes, not implementation (e.g., \"user data is stored in memory\" not \"memory_store was called\")\n\nExamples of good completion criteria:\n- \"The response contains weather data for the requested location\"\n- \"At least 3 relevant search results were found\"\n- \"The user's email address has been validated and stored\"\n- \"The file was created with content matching the user's request\"\n\nExamples of bad completion criteria (too rigid):\n- \"Response matches exact JSON format {temp: number, city: string}\"\n- \"Output contains exactly the string 'SUCCESS'\"\n- \"Function returned status code 200\"\n\n**Available Planning Tools:**\n- create_task: Add a task to the plan with completion criteria\n- finalize_plan: Complete the planning phase\n\nAlways start by analyzing the goal, then create tasks one by one, building dependencies as you go.`;\n\n/**\n * PlanningAgent class\n */\nexport class PlanningAgent {\n  private agent: Agent;\n  private config: PlanningAgentConfig;\n  private currentTasks: TaskInput[] = [];\n  private planningComplete = false;\n\n  private constructor(config: PlanningAgentConfig) {\n    this.config = config;\n\n    // Create planning tools bound to this instance\n    const planningTools = this.createBoundPlanningTools();\n\n    // Create base Agent with planning configuration\n    this.agent = Agent.create({\n      connector: config.connector,\n      model: config.model,\n      tools: planningTools,\n      instructions: PLANNING_SYSTEM_PROMPT,\n      temperature: config.planningTemperature ?? 0.3, // Lower temp for more structured output\n      maxIterations: config.maxPlanningIterations ?? 20,\n    });\n  }\n\n  /**\n   * Create a new PlanningAgent\n   */\n  static create(config: PlanningAgentConfig): PlanningAgent {\n    return new PlanningAgent(config);\n  }\n\n  /**\n   * Create planning tools bound to this PlanningAgent instance\n   */\n  private createBoundPlanningTools(): ToolFunction[] {\n    return [\n      {\n        definition: {\n          type: 'function',\n          function: {\n            name: 'create_task',\n            description: 'Create a new task in the plan with name, description, completion criteria, and optional dependencies',\n            parameters: {\n              type: 'object',\n              properties: {\n                name: {\n                  type: 'string',\n                  description: 'Task name in snake_case (e.g., \"fetch_user_data\")',\n                },\n                description: {\n                  type: 'string',\n                  description: 'Clear, actionable description of what this task does',\n                },\n                completion_criteria: {\n                  type: 'array',\n                  items: { type: 'string' },\n                  description: 'Array of natural language criteria to verify task completion (e.g., \"response contains weather data\", \"at least 3 results found\")',\n                },\n                depends_on: {\n                  type: 'array',\n                  items: { type: 'string' },\n                  description: 'Array of task names this task depends on (optional)',\n                },\n                parallel: {\n                  type: 'boolean',\n                  description: 'Whether this task can run in parallel with others (default: false)',\n                },\n                expected_output: {\n                  type: 'string',\n                  description: 'Description of expected output (optional)',\n                },\n                required_memory_keys: {\n                  type: 'array',\n                  items: { type: 'string' },\n                  description: 'Memory keys that must exist after task completion (optional)',\n                },\n                min_completion_score: {\n                  type: 'number',\n                  description: 'Minimum completion score (0-100) to consider task complete (default: 80)',\n                },\n              },\n              required: ['name', 'description'],\n            },\n          },\n        },\n        execute: async (args: Record<string, unknown>) => {\n          const name = args.name as string;\n          const description = args.description as string;\n          const completionCriteria = args.completion_criteria as string[] | undefined;\n          const dependsOn = args.depends_on as string[] | undefined;\n          const parallel = args.parallel as boolean | undefined;\n          const expectedOutput = args.expected_output as string | undefined;\n          const requiredMemoryKeys = args.required_memory_keys as string[] | undefined;\n          const minCompletionScore = args.min_completion_score as number | undefined;\n\n          // Build validation config if criteria provided\n          let validation: TaskValidation | undefined;\n          if (completionCriteria || requiredMemoryKeys || minCompletionScore) {\n            validation = {\n              completionCriteria,\n              requiredMemoryKeys,\n              minCompletionScore: minCompletionScore ?? 80,\n              requireUserApproval: 'uncertain', // Default: ask user in uncertain cases\n              mode: 'warn', // Default: warn but complete\n            };\n          }\n\n          // Actually add the task to the plan\n          this.addTask({\n            name,\n            description,\n            dependsOn,\n            execution: parallel ? { parallel: true } : undefined,\n            expectedOutput,\n            validation,\n          });\n\n          return {\n            success: true,\n            message: `Task '${name}' created${completionCriteria ? ` with ${completionCriteria.length} completion criteria` : ''}`,\n            taskCount: this.currentTasks.length,\n          };\n        },\n        idempotency: {\n          safe: false,\n        },\n      },\n      {\n        definition: {\n          type: 'function',\n          function: {\n            name: 'finalize_plan',\n            description: 'Mark the planning phase as complete. Call this when all tasks have been created and the plan is ready.',\n            parameters: {\n              type: 'object',\n              properties: {},\n            },\n          },\n        },\n        execute: async () => {\n          this.finalizePlanning();\n          return {\n            success: true,\n            message: 'Plan finalized and ready for execution',\n            totalTasks: this.currentTasks.length,\n          };\n        },\n        idempotency: {\n          safe: false,\n        },\n      },\n    ];\n  }\n\n  /**\n   * Generate a plan from a goal\n   */\n  async generatePlan(input: {\n    goal: string;\n    context?: string;\n    constraints?: string[];\n  }): Promise<GeneratedPlan> {\n    // Reset state\n    this.currentTasks = [];\n    this.planningComplete = false;\n\n    // Build planning prompt\n    const prompt = this.buildPlanningPrompt(input);\n\n    // Use the agent to generate the plan\n    const response = await this.agent.run(prompt);\n\n    // If planning wasn't finalized through tools, finalize manually\n    if (!this.planningComplete && this.currentTasks.length > 0) {\n      this.planningComplete = true;\n    }\n\n    // Create the plan\n    const plan = createPlan({\n      goal: input.goal,\n      context: input.context,\n      tasks: this.currentTasks,\n      allowDynamicTasks: false, // Plans are static by default\n    });\n\n    return {\n      plan,\n      reasoning: response.output_text || 'Plan generated',\n      complexity: this.estimateComplexity(this.currentTasks),\n    };\n  }\n\n  /**\n   * Validate and refine an existing plan\n   */\n  async refinePlan(plan: Plan, feedback: string): Promise<GeneratedPlan> {\n    // Load existing tasks\n    this.currentTasks = plan.tasks.map((task) => ({\n      name: task.name,\n      description: task.description,\n      dependsOn: task.dependsOn,\n      expectedOutput: task.expectedOutput,\n      condition: task.condition,\n      execution: task.execution,\n      externalDependency: task.externalDependency,\n      maxAttempts: task.maxAttempts,\n    }));\n\n    this.planningComplete = false;\n\n    // Build refinement prompt\n    const prompt = `I have an existing plan that needs refinement based on feedback.\n\n**Current Plan Goal:** ${plan.goal}\n**Current Plan Context:** ${plan.context || 'None'}\n\n**Current Tasks:**\n${this.currentTasks.map((t, i) => `${i + 1}. ${t.name}: ${t.description}${t.dependsOn?.length ? ` (depends on: ${t.dependsOn.join(', ')})` : ''}`).join('\\n')}\n\n**Feedback:** ${feedback}\n\nPlease refine the plan based on this feedback. You can:\n- Add new tasks\n- Modify existing task descriptions\n- Change dependencies\n- Remove unnecessary tasks\n- Adjust parallel execution\n\nUse the planning tools to make changes, then finalize when complete.`;\n\n    const response = await this.agent.run(prompt);\n\n    // Create refined plan\n    const refinedPlan = createPlan({\n      goal: plan.goal,\n      context: plan.context,\n      tasks: this.currentTasks,\n      allowDynamicTasks: false,\n    });\n\n    return {\n      plan: refinedPlan,\n      reasoning: response.output_text || 'Plan refined',\n      complexity: this.estimateComplexity(this.currentTasks),\n    };\n  }\n\n  /**\n   * Build planning prompt from input\n   */\n  private buildPlanningPrompt(input: {\n    goal: string;\n    context?: string;\n    constraints?: string[];\n  }): string {\n    const parts: string[] = [];\n\n    parts.push('Please create an execution plan for the following goal:\\n');\n    parts.push(`**Goal:** ${input.goal}\\n`);\n\n    if (input.context) {\n      parts.push(`**Context:** ${input.context}\\n`);\n    }\n\n    if (input.constraints && input.constraints.length > 0) {\n      parts.push('\\n**Constraints:**');\n      input.constraints.forEach((c) => parts.push(`- ${c}`));\n      parts.push('');\n    }\n\n    if (this.config.availableTools && this.config.availableTools.length > 0) {\n      parts.push('\\n**Available Tools for Execution:**');\n      this.config.availableTools.forEach((tool) => {\n        parts.push(`- ${tool.definition.function.name}: ${tool.definition.function.description}`);\n      });\n      parts.push('');\n    }\n\n    parts.push('\\nAnalyze this goal and create a structured plan with clear tasks and dependencies.');\n    parts.push('Use the planning tools to build the plan step by step.');\n\n    return parts.join('\\n');\n  }\n\n  /**\n   * Estimate plan complexity\n   */\n  private estimateComplexity(tasks: TaskInput[]): 'low' | 'medium' | 'high' {\n    const taskCount = tasks.length;\n    const hasDependencies = tasks.some((t) => t.dependsOn && t.dependsOn.length > 0);\n    const hasConditionals = tasks.some((t) => t.condition);\n    const hasExternalDeps = tasks.some((t) => t.externalDependency);\n\n    if (taskCount <= 3 && !hasDependencies && !hasConditionals && !hasExternalDeps) {\n      return 'low';\n    }\n\n    if (taskCount <= 10 && !hasConditionals && !hasExternalDeps) {\n      return 'medium';\n    }\n\n    return 'high';\n  }\n\n  /**\n   * Get current tasks (for tool access)\n   */\n  getCurrentTasks(): TaskInput[] {\n    return [...this.currentTasks];\n  }\n\n  /**\n   * Add task (called by planning tools)\n   */\n  addTask(task: TaskInput): void {\n    this.currentTasks.push(task);\n  }\n\n  /**\n   * Update task (called by planning tools)\n   */\n  updateTask(name: string, updates: Partial<TaskInput>): void {\n    const task = this.currentTasks.find((t) => t.name === name);\n    if (task) {\n      Object.assign(task, updates);\n    }\n  }\n\n  /**\n   * Remove task (called by planning tools)\n   */\n  removeTask(name: string): void {\n    const index = this.currentTasks.findIndex((t) => t.name === name);\n    if (index >= 0) {\n      this.currentTasks.splice(index, 1);\n    }\n  }\n\n  /**\n   * Mark planning as complete\n   */\n  finalizePlanning(): void {\n    this.planningComplete = true;\n  }\n}\n\n/**\n * Simple plan generation without tools (fallback)\n */\nexport async function generateSimplePlan(\n  goal: string,\n  context?: string\n): Promise<Plan> {\n  // Fallback: create a simple single-task plan\n  return createPlan({\n    goal,\n    context,\n    tasks: [\n      {\n        name: 'execute_goal',\n        description: `Execute the goal: ${goal}`,\n      },\n    ],\n    allowDynamicTasks: true, // Allow agent to modify plan\n  });\n}\n","/**\n * Core types for context management system\n */\n\n/**\n * Context component that can be compacted\n */\nexport interface IContextComponent {\n  /** Unique name for this component */\n  name: string;\n\n  /** The actual content (string or structured data) */\n  content: string | unknown;\n\n  /** Priority for compaction (higher = compact first) */\n  priority: number;\n\n  /** Whether this component can be compacted */\n  compactable: boolean;\n\n  /** Additional metadata for compaction strategies */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Context budget information\n */\nexport interface ContextBudget {\n  /** Total available tokens */\n  total: number;\n\n  /** Reserved tokens for response */\n  reserved: number;\n\n  /** Currently used tokens */\n  used: number;\n\n  /** Available tokens remaining */\n  available: number;\n\n  /** Utilization percentage (used / (total - reserved)) */\n  utilizationPercent: number;\n\n  /** Budget status */\n  status: 'ok' | 'warning' | 'critical';\n\n  /** Token breakdown by component */\n  breakdown: Record<string, number>;\n}\n\n/**\n * Context preparation result\n */\nexport interface PreparedContext {\n  /** Prepared components */\n  components: IContextComponent[];\n\n  /** Current budget */\n  budget: ContextBudget;\n\n  /** Whether compaction occurred */\n  compacted: boolean;\n\n  /** Compaction log if compacted */\n  compactionLog?: string[];\n}\n\n/**\n * Context manager configuration\n */\nexport interface ContextManagerConfig {\n  /** Maximum context tokens for the model */\n  maxContextTokens: number;\n\n  /** Threshold to trigger compaction (0.0 - 1.0) */\n  compactionThreshold: number;\n\n  /** Hard limit - must compact before this (0.0 - 1.0) */\n  hardLimit: number;\n\n  /** Reserve space for response (0.0 - 1.0) */\n  responseReserve: number;\n\n  /** Token estimator to use */\n  estimator: 'approximate' | 'tiktoken' | ITokenEstimator;\n\n  /** Enable automatic compaction */\n  autoCompact: boolean;\n\n  /** Strategy to use */\n  strategy?: 'proactive' | 'aggressive' | 'lazy' | 'rolling-window' | 'adaptive' | IContextStrategy;\n\n  /** Strategy-specific options */\n  strategyOptions?: Record<string, unknown>;\n}\n\n/**\n * Default configuration\n */\nexport const DEFAULT_CONTEXT_CONFIG: ContextManagerConfig = {\n  maxContextTokens: 128000,\n  compactionThreshold: 0.75,\n  hardLimit: 0.9,\n  responseReserve: 0.15,\n  estimator: 'approximate',\n  autoCompact: true,\n  strategy: 'proactive',\n  strategyOptions: {},\n};\n\n// Note: IContextProvider interface deleted - was designed for ContextManager class\n// AgentContext is now THE ONLY context manager and provides components directly\n\n/**\n * Content type for more accurate token estimation\n * Named differently from TokenContentType in Content.ts to avoid conflicts\n */\nexport type TokenContentType = 'code' | 'prose' | 'mixed';\n\n/**\n * Abstract interface for token estimation\n */\nexport interface ITokenEstimator {\n  /**\n   * Estimate token count for text\n   *\n   * @param text - The text to estimate\n   * @param contentType - Type of content for more accurate estimation:\n   *   - 'code': Code is typically denser (~3 chars/token)\n   *   - 'prose': Natural language text (~4 chars/token)\n   *   - 'mixed': Mix of code and prose (~3.5 chars/token)\n   */\n  estimateTokens(text: string, contentType?: TokenContentType): number;\n\n  /**\n   * Estimate tokens for structured data\n   */\n  estimateDataTokens(data: unknown, contentType?: TokenContentType): number;\n\n  /**\n   * Estimate tokens for an image.\n   * @param width - Image width in pixels (if known)\n   * @param height - Image height in pixels (if known)\n   * @param detail - Image detail level: 'low', 'high', or 'auto'\n   */\n  estimateImageTokens?(width?: number, height?: number, detail?: string): number;\n}\n\n/**\n * Hook context for beforeCompaction callback\n */\nexport interface CompactionHookContext {\n  /** Agent identifier (if available) */\n  agentId?: string;\n  /** Current context budget info */\n  currentBudget: ContextBudget;\n  /** Compaction strategy being used */\n  strategy: string;\n  /** Current context components (read-only summaries) */\n  components: ReadonlyArray<{\n    name: string;\n    priority: number;\n    compactable: boolean;\n  }>;\n  /** Estimated tokens to be freed */\n  estimatedTokensToFree: number;\n}\n\n/**\n * Hooks for context management events\n */\nexport interface ContextManagerHooks {\n  /**\n   * Called before compaction occurs.\n   * Use this to save important data before it gets compacted.\n   * This is the last chance to preserve critical information.\n   */\n  beforeCompaction?: (context: CompactionHookContext) => Promise<void>;\n}\n\n/**\n * Abstract interface for compaction strategies\n */\nexport interface IContextCompactor {\n  /** Compactor name */\n  readonly name: string;\n\n  /** Priority order (lower = run first) */\n  readonly priority: number;\n\n  /**\n   * Check if this compactor can handle the component\n   */\n  canCompact(component: IContextComponent): boolean;\n\n  /**\n   * Compact the component to target size\n   */\n  compact(component: IContextComponent, targetTokens: number): Promise<IContextComponent>;\n\n  /**\n   * Estimate savings from compaction\n   */\n  estimateSavings(component: IContextComponent): number;\n}\n\n/**\n * Context management strategy - defines the overall approach to managing context\n */\nexport interface IContextStrategy {\n  /** Strategy name */\n  readonly name: string;\n\n  /**\n   * Decide if compaction is needed based on current budget\n   */\n  shouldCompact(budget: ContextBudget, config: ContextManagerConfig): boolean;\n\n  /**\n   * Execute compaction using available compactors\n   */\n  compact(\n    components: IContextComponent[],\n    budget: ContextBudget,\n    compactors: IContextCompactor[],\n    estimator: ITokenEstimator\n  ): Promise<{\n    components: IContextComponent[];\n    log: string[];\n    tokensFreed: number;\n  }>;\n\n  /**\n   * Optional: Prepare components before budget calculation\n   * Use this for strategies that pre-process context (e.g., rolling window)\n   */\n  prepareComponents?(components: IContextComponent[]): Promise<IContextComponent[]>;\n\n  /**\n   * Optional: Post-process after compaction\n   * Use this for strategies that need cleanup or optimization\n   */\n  postProcess?(\n    components: IContextComponent[],\n    budget: ContextBudget\n  ): Promise<IContextComponent[]>;\n\n  /**\n   * Optional: Get strategy-specific metrics\n   */\n  getMetrics?(): Record<string, unknown>;\n}\n","/**\n * Truncate Compactor\n *\n * Truncates content to target size by:\n * - For strings: Cut to character limit\n * - For arrays: Keep most recent items\n */\n\nimport type { IContextCompactor, IContextComponent, ITokenEstimator } from '../../../core/context/types.js';\n\nexport class TruncateCompactor implements IContextCompactor {\n  readonly name = 'truncate';\n  readonly priority = 10;\n\n  constructor(private estimator: ITokenEstimator) {}\n\n  canCompact(component: IContextComponent): boolean {\n    return (\n      component.compactable &&\n      (component.metadata?.strategy === 'truncate' || component.metadata?.truncatable === true)\n    );\n  }\n\n  async compact(component: IContextComponent, targetTokens: number): Promise<IContextComponent> {\n    if (typeof component.content === 'string') {\n      return this.truncateString(component, targetTokens);\n    }\n\n    if (Array.isArray(component.content)) {\n      return this.truncateArray(component, targetTokens);\n    }\n\n    // Can't truncate other types\n    return component;\n  }\n\n  estimateSavings(component: IContextComponent): number {\n    const current = this.estimator.estimateDataTokens(component.content);\n    return Math.floor(current * 0.5); // Estimate 50% reduction\n  }\n\n  private truncateString(component: IContextComponent, targetTokens: number): IContextComponent {\n    const content = component.content as string;\n    const currentTokens = this.estimator.estimateTokens(content);\n\n    if (currentTokens <= targetTokens) {\n      return component;\n    }\n\n    // Calculate character limit\n    const targetChars = targetTokens * 4; // ~4 chars per token\n    const truncated = content.substring(0, targetChars) + '\\n[truncated...]';\n\n    return {\n      ...component,\n      content: truncated,\n      metadata: {\n        ...component.metadata,\n        truncated: true,\n        originalLength: content.length,\n        truncatedLength: truncated.length,\n      },\n    };\n  }\n\n  private truncateArray(component: IContextComponent, targetTokens: number): IContextComponent {\n    const content = component.content as unknown[];\n    let tokens = 0;\n    const kept: unknown[] = [];\n\n    // Keep most recent items that fit within target\n    for (let i = content.length - 1; i >= 0; i--) {\n      const item = content[i];\n      const itemTokens = this.estimator.estimateDataTokens(item);\n\n      if (tokens + itemTokens > targetTokens && kept.length > 0) {\n        break;\n      }\n\n      kept.unshift(item);\n      tokens += itemTokens;\n    }\n\n    const droppedLength = content.length - kept.length;\n\n    // Only mark as truncated if we actually dropped items\n    if (droppedLength === 0) {\n      return component;\n    }\n\n    return {\n      ...component,\n      content: kept,\n      metadata: {\n        ...component.metadata,\n        truncated: true,\n        originalLength: content.length,\n        keptLength: kept.length,\n        droppedLength,\n      },\n    };\n  }\n}\n","/**\n * Summarize Compactor\n *\n * Uses LLM to create intelligent summaries of context components before compaction.\n * This preserves the semantic meaning of content while reducing token count.\n *\n * Supports different summarization strategies based on content type:\n * - Conversation history: Preserves decisions, facts, and preferences\n * - Tool outputs (search/scrape): Preserves key findings, sources, and data\n */\n\nimport type {\n  IContextCompactor,\n  IContextComponent,\n  ITokenEstimator,\n} from '../../../core/context/types.js';\nimport type { ITextProvider } from '../../../domain/interfaces/ITextProvider.js';\n\n/**\n * Configuration for the SummarizeCompactor\n */\nexport interface SummarizeCompactorConfig {\n  /** Text provider for LLM-based summarization */\n  textProvider: ITextProvider;\n\n  /** Model to use for summarization (optional - uses provider default) */\n  model?: string;\n\n  /** Maximum tokens for the summary (default: 500) */\n  maxSummaryTokens?: number;\n\n  /** Preserve markdown structure like headings and lists (default: true) */\n  preserveStructure?: boolean;\n\n  /** Fall back to truncation if LLM summarization fails (default: true) */\n  fallbackToTruncate?: boolean;\n\n  /** Temperature for summarization (default: 0.3 for deterministic output) */\n  temperature?: number;\n}\n\n/**\n * Content type hint for selecting appropriate summarization prompt\n */\nexport type SummarizeContentType =\n  | 'conversation'\n  | 'tool_output'\n  | 'search_results'\n  | 'scrape_results'\n  | 'generic';\n\n/**\n * Summarization prompts for different content types\n */\nconst SUMMARIZATION_PROMPTS: Record<SummarizeContentType, string> = {\n  conversation: `Summarize this conversation history, preserving:\n- Key decisions made by the user or assistant\n- Important facts and data discovered\n- User preferences expressed\n- Unresolved questions or pending items\n- Any errors or issues encountered\n\nFocus on information that would be needed to continue the conversation coherently.\nBe concise but preserve critical context.`,\n\n  tool_output: `Summarize these tool outputs, preserving:\n- Key results and findings from each tool call\n- Important data values (numbers, dates, names, IDs)\n- Error messages or warnings\n- Status information\n- Dependencies or relationships between results\n\nPrioritize factual data over explanatory text.`,\n\n  search_results: `Summarize these search results, preserving:\n- Key findings relevant to the task\n- Source URLs and their main points (keep URLs intact)\n- Factual data (numbers, dates, names, statistics)\n- Contradictions or disagreements between sources\n- Credibility indicators (official sources, recent dates)\n\nFormat as a bulleted list organized by topic or source.`,\n\n  scrape_results: `Summarize this scraped web content, preserving:\n- Main topic and key points\n- Factual data (numbers, dates, names, prices, specifications)\n- Important quotes or statements\n- Source attribution (keep the URL)\n- Any structured data (tables, lists)\n\nDiscard navigation elements, ads, and boilerplate text.`,\n\n  generic: `Summarize this content, preserving:\n- Main points and key information\n- Important data and facts\n- Relationships and dependencies\n- Actionable items\n\nBe concise while retaining critical information.`,\n};\n\n/**\n * SummarizeCompactor - LLM-based context compaction\n *\n * Uses AI to intelligently summarize content, preserving semantic meaning\n * while significantly reducing token count.\n */\nexport class SummarizeCompactor implements IContextCompactor {\n  readonly name = 'summarize';\n  readonly priority = 5; // Run before truncate (10)\n\n  private config: Required<SummarizeCompactorConfig>;\n  private estimator: ITokenEstimator;\n\n  constructor(estimator: ITokenEstimator, config: SummarizeCompactorConfig) {\n    this.estimator = estimator;\n    this.config = {\n      textProvider: config.textProvider,\n      model: config.model ?? '',\n      maxSummaryTokens: config.maxSummaryTokens ?? 500,\n      preserveStructure: config.preserveStructure ?? true,\n      fallbackToTruncate: config.fallbackToTruncate ?? true,\n      temperature: config.temperature ?? 0.3,\n    };\n  }\n\n  /**\n   * Check if this compactor can handle the component\n   */\n  canCompact(component: IContextComponent): boolean {\n    return (\n      component.compactable && component.metadata?.strategy === 'summarize'\n    );\n  }\n\n  /**\n   * Compact the component by summarizing its content\n   */\n  async compact(\n    component: IContextComponent,\n    targetTokens: number\n  ): Promise<IContextComponent> {\n    // Stringify content for processing\n    const contentStr = this.stringifyContent(component.content);\n    const currentTokens = this.estimator.estimateTokens(contentStr);\n\n    // If already small enough, return unchanged\n    if (currentTokens <= targetTokens) {\n      return component;\n    }\n\n    // Determine content type from metadata or component name\n    const contentType = this.detectContentType(component);\n\n    try {\n      // Attempt LLM summarization\n      const summary = await this.summarize(contentStr, contentType, targetTokens);\n\n      // Verify we achieved meaningful reduction\n      const summaryTokens = this.estimator.estimateTokens(summary);\n      if (summaryTokens >= currentTokens * 0.9) {\n        // Less than 10% reduction - fallback to truncation if enabled\n        if (this.config.fallbackToTruncate) {\n          return this.truncateFallback(component, contentStr, targetTokens);\n        }\n      }\n\n      return {\n        ...component,\n        content: summary,\n        metadata: {\n          ...component.metadata,\n          summarized: true,\n          summarizedFrom: currentTokens,\n          summarizedTo: summaryTokens,\n          reductionPercent: Math.round(\n            ((currentTokens - summaryTokens) / currentTokens) * 100\n          ),\n          contentType,\n        },\n      };\n    } catch (error) {\n      // LLM failed - use fallback if configured\n      if (this.config.fallbackToTruncate) {\n        console.warn(\n          `SummarizeCompactor: LLM summarization failed for ${component.name}, falling back to truncation:`,\n          error instanceof Error ? error.message : String(error)\n        );\n        return this.truncateFallback(component, contentStr, targetTokens);\n      }\n\n      // Re-throw if no fallback\n      throw error;\n    }\n  }\n\n  /**\n   * Estimate how many tokens could be saved by summarization\n   */\n  estimateSavings(component: IContextComponent): number {\n    const current = this.estimator.estimateDataTokens(component.content);\n    // Summarization typically achieves 70-85% reduction\n    return Math.floor(current * 0.8);\n  }\n\n  /**\n   * Perform LLM-based summarization\n   */\n  private async summarize(\n    content: string,\n    contentType: SummarizeContentType,\n    targetTokens: number\n  ): Promise<string> {\n    const systemPrompt = SUMMARIZATION_PROMPTS[contentType];\n    const maxSummaryTokens = Math.min(targetTokens, this.config.maxSummaryTokens);\n\n    const structureInstructions = this.config.preserveStructure\n      ? '\\n\\nPreserve formatting structure (headings, bullet points, numbered lists) where appropriate.'\n      : '';\n\n    const prompt = `${systemPrompt}${structureInstructions}\n\nTarget summary length: approximately ${maxSummaryTokens} tokens (${maxSummaryTokens * 4} characters).\n\nContent to summarize:\n---\n${content}\n---\n\nProvide the summary:`;\n\n    const response = await this.config.textProvider.generate({\n      model: this.config.model || 'gpt-4o-mini', // Use a fast, cheap model for summarization\n      input: prompt,\n      temperature: this.config.temperature,\n      max_output_tokens: maxSummaryTokens + 100, // Allow some buffer\n    });\n\n    return response.output_text || content;\n  }\n\n  /**\n   * Fallback to simple truncation when LLM fails\n   */\n  private truncateFallback(\n    component: IContextComponent,\n    contentStr: string,\n    targetTokens: number\n  ): IContextComponent {\n    const targetChars = targetTokens * 4; // ~4 chars per token\n    const truncated =\n      contentStr.substring(0, targetChars) +\n      '\\n\\n[... content truncated due to context limits ...]';\n\n    return {\n      ...component,\n      content: truncated,\n      metadata: {\n        ...component.metadata,\n        truncated: true,\n        truncatedFrom: contentStr.length,\n        truncatedTo: truncated.length,\n        summarizationFailed: true,\n      },\n    };\n  }\n\n  /**\n   * Detect content type from component metadata or name\n   */\n  private detectContentType(component: IContextComponent): SummarizeContentType {\n    // Check metadata first\n    if (component.metadata?.contentType) {\n      return component.metadata.contentType as SummarizeContentType;\n    }\n\n    // Infer from component name\n    const name = component.name.toLowerCase();\n\n    if (\n      name.includes('conversation') ||\n      name.includes('history') ||\n      name.includes('messages')\n    ) {\n      return 'conversation';\n    }\n\n    if (name.includes('search')) {\n      return 'search_results';\n    }\n\n    if (name.includes('scrape') || name.includes('fetch')) {\n      return 'scrape_results';\n    }\n\n    if (name.includes('tool') || name.includes('output')) {\n      return 'tool_output';\n    }\n\n    return 'generic';\n  }\n\n  /**\n   * Convert content to string for processing\n   */\n  private stringifyContent(content: unknown): string {\n    if (typeof content === 'string') {\n      return content;\n    }\n\n    if (Array.isArray(content)) {\n      // Handle message arrays (conversation history)\n      return content\n        .map((item) => {\n          if (typeof item === 'string') return item;\n          if (item && typeof item === 'object') {\n            // Handle message objects with role/content\n            if ('role' in item && 'content' in item) {\n              return `[${item.role}]: ${item.content}`;\n            }\n            // Handle tool output objects\n            if ('tool' in item && 'output' in item) {\n              return `[${item.tool}]: ${JSON.stringify(item.output)}`;\n            }\n          }\n          return JSON.stringify(item);\n        })\n        .join('\\n\\n');\n    }\n\n    // Default to JSON serialization\n    return JSON.stringify(content, null, 2);\n  }\n}\n","/**\n * Memory Eviction Compactor\n *\n * Evicts LRU entries from memory index\n * Works with memory components that have eviction metadata\n */\n\nimport type { IContextCompactor, IContextComponent, ITokenEstimator } from '../../../core/context/types.js';\n\nexport class MemoryEvictionCompactor implements IContextCompactor {\n  readonly name = 'memory-eviction';\n  readonly priority = 8;\n\n  constructor(private estimator: ITokenEstimator) {}\n\n  canCompact(component: IContextComponent): boolean {\n    return (\n      component.compactable &&\n      (component.metadata?.strategy === 'evict' || component.name === 'memory_index')\n    );\n  }\n\n  async compact(component: IContextComponent, targetTokens: number): Promise<IContextComponent> {\n    // If memory component has eviction callback, use it\n    if (component.metadata?.evict && typeof component.metadata.evict === 'function') {\n      const currentTokens = this.estimator.estimateDataTokens(component.content);\n      const tokensToFree = Math.max(0, currentTokens - targetTokens);\n\n      // Estimate how many entries to evict\n      const avgEntrySize = component.metadata.avgEntrySize as number || 100;\n      const entriesToEvict = Math.ceil(tokensToFree / avgEntrySize);\n\n      if (entriesToEvict > 0) {\n        // Call eviction callback\n        await (component.metadata.evict as (count: number) => Promise<void>)(entriesToEvict);\n\n        // Get updated content\n        if (component.metadata.getUpdatedContent && typeof component.metadata.getUpdatedContent === 'function') {\n          const updatedContent = await (component.metadata.getUpdatedContent as () => Promise<unknown>)();\n\n          return {\n            ...component,\n            content: updatedContent,\n            metadata: {\n              ...component.metadata,\n              evicted: true,\n              evictedCount: entriesToEvict,\n            },\n          };\n        }\n      }\n    }\n\n    // If no eviction mechanism, just return unchanged\n    return component;\n  }\n\n  estimateSavings(component: IContextComponent): number {\n    // Estimate based on average entry size\n    const avgEntrySize = component.metadata?.avgEntrySize as number || 100;\n    return avgEntrySize * 2; // Conservative estimate: evict 2 entries\n  }\n}\n","/**\n * Approximate Token Estimator\n *\n * Uses content-type aware heuristics:\n * - Code: ~3 chars/token (more symbols, shorter words)\n * - Prose: ~4 chars/token (natural language)\n * - Mixed: ~3.5 chars/token\n *\n * Fast and good enough for most use cases.\n */\n\nimport type { ITokenEstimator, TokenContentType } from '../../../core/context/types.js';\n\nexport class ApproximateTokenEstimator implements ITokenEstimator {\n  /**\n   * Estimate tokens for text with content-type awareness\n   *\n   * @param text - The text to estimate tokens for\n   * @param contentType - Type of content:\n   *   - 'code': Code is typically denser (~3 chars/token)\n   *   - 'prose': Natural language text (~4 chars/token)\n   *   - 'mixed': Mix of code and prose (~3.5 chars/token)\n   */\n  estimateTokens(text: string, contentType: TokenContentType = 'mixed'): number {\n    if (!text || text.length === 0) {\n      return 0;\n    }\n\n    // Content-type aware estimation\n    const charsPerToken = contentType === 'code' ? 3 : contentType === 'prose' ? 4 : 3.5;\n    return Math.ceil(text.length / charsPerToken);\n  }\n\n  /**\n   * Estimate tokens for structured data (always uses 'mixed' estimation)\n   */\n  estimateDataTokens(data: unknown, contentType: TokenContentType = 'mixed'): number {\n    if (data === null || data === undefined) {\n      return 1;\n    }\n\n    // Serialize and estimate\n    try {\n      const serialized = JSON.stringify(data);\n      return this.estimateTokens(serialized, contentType);\n    } catch {\n      // If serialization fails, return a conservative estimate\n      return 100;\n    }\n  }\n\n  /**\n   * Estimate tokens for an image using tile-based model (matches OpenAI pricing).\n   *\n   * - detail='low': 85 tokens\n   * - detail='high' with known dimensions: 85 + 170 per 512512 tile\n   * - Unknown dimensions: 1000 tokens (conservative default)\n   */\n  estimateImageTokens(width?: number, height?: number, detail?: string): number {\n    if (detail === 'low') return 85;\n\n    if (width && height) {\n      const tiles = Math.ceil(width / 512) * Math.ceil(height / 512);\n      return 85 + 170 * tiles;\n    }\n\n    return 1000;\n  }\n}\n","/**\n * Token estimators\n */\n\nimport type { ITokenEstimator } from '../../../core/context/types.js';\nimport { ApproximateTokenEstimator } from './ApproximateEstimator.js';\n\n/**\n * Create token estimator from name\n */\nexport function createEstimator(name: string): ITokenEstimator {\n  switch (name) {\n    case 'approximate':\n      return new ApproximateTokenEstimator();\n    case 'tiktoken':\n      // TODO: Implement tiktoken-based estimator when needed\n      throw new Error('Tiktoken estimator not yet implemented. Use \"approximate\" for now.');\n    default:\n      throw new Error(`Unknown token estimator: ${name}`);\n  }\n}\n\nexport { ApproximateTokenEstimator };\n","/**\n * IHistoryManager - Interface for conversation history management\n *\n * Follows the same pattern as IMemoryStorage for pluggable implementations.\n * Users can implement this interface to use Redis, PostgreSQL, file storage, etc.\n */\n\nimport { EventEmitter } from 'eventemitter3';\n\n/**\n * A single message in conversation history\n */\nexport interface HistoryMessage {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: number;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Events emitted by IHistoryManager implementations\n */\nexport interface HistoryManagerEvents {\n  'message:added': { message: HistoryMessage };\n  'message:removed': { messageId: string };\n  'history:cleared': { reason?: string };\n  'history:compacted': { removedCount: number; strategy: string };\n  'history:restored': { messageCount: number };\n}\n\n/**\n * Configuration for history management\n */\nexport interface IHistoryManagerConfig {\n  /** Maximum messages to keep (for sliding window) */\n  maxMessages?: number;\n\n  /** Maximum tokens to keep (estimated) */\n  maxTokens?: number;\n\n  /** Compaction strategy when limits are reached */\n  compactionStrategy?: 'truncate' | 'summarize' | 'sliding-window';\n\n  /** Number of recent messages to always preserve */\n  preserveRecentCount?: number;\n}\n\n/**\n * Serialized history state for persistence\n */\nexport interface SerializedHistoryState {\n  version: number;\n  messages: HistoryMessage[];\n  summaries?: Array<{ content: string; coversCount: number; timestamp: number }>;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Interface for history storage backends\n * Implement this to use custom storage (Redis, PostgreSQL, file, etc.)\n */\nexport interface IHistoryStorage {\n  /**\n   * Store a message\n   */\n  addMessage(message: HistoryMessage): Promise<void>;\n\n  /**\n   * Get all messages\n   */\n  getMessages(): Promise<HistoryMessage[]>;\n\n  /**\n   * Get recent N messages\n   */\n  getRecentMessages(count: number): Promise<HistoryMessage[]>;\n\n  /**\n   * Remove a message by ID\n   */\n  removeMessage(id: string): Promise<void>;\n\n  /**\n   * Remove messages older than timestamp\n   */\n  removeOlderThan(timestamp: number): Promise<number>;\n\n  /**\n   * Clear all messages\n   */\n  clear(): Promise<void>;\n\n  /**\n   * Get message count\n   */\n  getCount(): Promise<number>;\n\n  /**\n   * Get serialized state for session persistence\n   */\n  getState(): Promise<SerializedHistoryState>;\n\n  /**\n   * Restore from serialized state\n   */\n  restoreState(state: SerializedHistoryState): Promise<void>;\n}\n\n/**\n * Interface for history manager\n * Manages conversation history with compaction and persistence support\n */\nexport interface IHistoryManager extends EventEmitter<HistoryManagerEvents> {\n  /**\n   * Add a message to history\n   */\n  addMessage(role: 'user' | 'assistant' | 'system', content: string, metadata?: Record<string, unknown>): Promise<HistoryMessage>;\n\n  /**\n   * Get all messages (may include summaries as system messages)\n   */\n  getMessages(): Promise<HistoryMessage[]>;\n\n  /**\n   * Get recent messages only\n   */\n  getRecentMessages(count?: number): Promise<HistoryMessage[]>;\n\n  /**\n   * Get formatted history for LLM context\n   */\n  formatForContext(options?: { maxTokens?: number; includeMetadata?: boolean }): Promise<string>;\n\n  /**\n   * Compact history (apply compaction strategy)\n   */\n  compact(): Promise<void>;\n\n  /**\n   * Clear all history\n   */\n  clear(): Promise<void>;\n\n  /**\n   * Get message count\n   */\n  getMessageCount(): Promise<number>;\n\n  /**\n   * Get state for session persistence\n   */\n  getState(): Promise<SerializedHistoryState>;\n\n  /**\n   * Restore from saved state\n   */\n  restoreState(state: SerializedHistoryState): Promise<void>;\n\n  /**\n   * Get current configuration\n   */\n  getConfig(): IHistoryManagerConfig;\n}\n\n/**\n * Default configuration\n */\nexport const DEFAULT_HISTORY_MANAGER_CONFIG: Required<IHistoryManagerConfig> = {\n  maxMessages: 50,\n  maxTokens: 32000,\n  compactionStrategy: 'sliding-window',\n  preserveRecentCount: 10,\n};\n","/**\n * InMemoryHistoryStorage - In-memory implementation of IHistoryStorage\n *\n * Default storage backend for conversation history.\n * For production, users can implement IHistoryStorage with Redis, PostgreSQL, etc.\n */\n\nimport type {\n  IHistoryStorage,\n  HistoryMessage,\n  SerializedHistoryState,\n} from '../../domain/interfaces/IHistoryManager.js';\n\n/**\n * In-memory history storage implementation\n */\nexport class InMemoryHistoryStorage implements IHistoryStorage {\n  private messages: HistoryMessage[] = [];\n  private summaries: Array<{ content: string; coversCount: number; timestamp: number }> = [];\n\n  async addMessage(message: HistoryMessage): Promise<void> {\n    this.messages.push(message);\n  }\n\n  async getMessages(): Promise<HistoryMessage[]> {\n    return [...this.messages];\n  }\n\n  async getRecentMessages(count: number): Promise<HistoryMessage[]> {\n    return this.messages.slice(-count);\n  }\n\n  async removeMessage(id: string): Promise<void> {\n    const index = this.messages.findIndex(m => m.id === id);\n    if (index >= 0) {\n      this.messages.splice(index, 1);\n    }\n  }\n\n  async removeOlderThan(timestamp: number): Promise<number> {\n    const originalLength = this.messages.length;\n    this.messages = this.messages.filter(m => m.timestamp >= timestamp);\n    return originalLength - this.messages.length;\n  }\n\n  async clear(): Promise<void> {\n    this.messages = [];\n    this.summaries = [];\n  }\n\n  async getCount(): Promise<number> {\n    return this.messages.length;\n  }\n\n  async getState(): Promise<SerializedHistoryState> {\n    return {\n      version: 1,\n      messages: [...this.messages],\n      summaries: [...this.summaries],\n    };\n  }\n\n  async restoreState(state: SerializedHistoryState): Promise<void> {\n    this.messages = [...state.messages];\n    this.summaries = state.summaries ? [...state.summaries] : [];\n  }\n}\n","/**\n * Routine Execution Record  persisted record for tracking/history.\n *\n * Unlike RoutineExecution (runtime state with live Plan), this is a\n * storage-agnostic snapshot meant for persistence and querying.\n * Timestamps are `number` (epoch ms), no framework dependencies.\n */\n\nimport type { RoutineExecutionStatus, RoutineDefinition } from './Routine.js';\n\n// ============================================================================\n// Step Types\n// ============================================================================\n\nexport type RoutineStepType =\n  | 'task.started'\n  | 'task.completed'\n  | 'task.failed'\n  | 'task.validation'\n  | 'tool.call'\n  | 'tool.start'\n  | 'llm.start'\n  | 'llm.complete'\n  | 'iteration.complete'\n  | 'execution.error'\n  | 'control_flow.started'\n  | 'control_flow.completed';\n\nexport interface RoutineExecutionStep {\n  timestamp: number;\n  taskName: string;\n  type: RoutineStepType;\n  data?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Task Snapshot\n// ============================================================================\n\nexport interface RoutineTaskResult {\n  success: boolean;\n  output?: string;\n  error?: string;\n  validationScore?: number;\n  validationExplanation?: string;\n}\n\nexport interface RoutineTaskSnapshot {\n  taskId: string;\n  name: string;\n  description: string;\n  status: 'pending' | 'blocked' | 'in_progress' | 'completed' | 'failed' | 'skipped' | 'cancelled';\n  attempts: number;\n  maxAttempts: number;\n  result?: RoutineTaskResult;\n  startedAt?: number;\n  completedAt?: number;\n  controlFlowType?: 'map' | 'fold' | 'until';\n}\n\n// ============================================================================\n// Execution Record\n// ============================================================================\n\nexport interface RoutineExecutionRecord {\n  executionId: string;\n  routineId: string;\n  routineName: string;\n  status: RoutineExecutionStatus;\n  progress: number;\n  tasks: RoutineTaskSnapshot[];\n  steps: RoutineExecutionStep[];\n  taskCount: number;\n  connectorName: string;\n  model: string;\n  error?: string;\n  startedAt?: number;\n  completedAt?: number;\n  lastActivityAt?: number;\n  trigger?: {\n    type: 'schedule' | 'event' | 'manual';\n    source?: string;\n    event?: string;\n    payload?: unknown;\n  };\n  metadata?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Factory Functions\n// ============================================================================\n\n/**\n * Create initial task snapshots from a routine definition.\n */\nexport function createTaskSnapshots(definition: RoutineDefinition): RoutineTaskSnapshot[] {\n  return definition.tasks.map((task) => ({\n    taskId: task.id ?? task.name,\n    name: task.name,\n    description: task.description,\n    status: 'pending' as const,\n    attempts: 0,\n    maxAttempts: task.maxAttempts ?? 3,\n    controlFlowType: task.controlFlow?.type as RoutineTaskSnapshot['controlFlowType'],\n  }));\n}\n\n/**\n * Create an initial RoutineExecutionRecord from a definition.\n * Status is set to 'running' with empty steps.\n */\nexport function createRoutineExecutionRecord(\n  definition: RoutineDefinition,\n  connectorName: string,\n  model: string,\n  trigger?: RoutineExecutionRecord['trigger'],\n): RoutineExecutionRecord {\n  const now = Date.now();\n  const executionId = `rexec-${now}-${Math.random().toString(36).substr(2, 9)}`;\n\n  return {\n    executionId,\n    routineId: definition.id,\n    routineName: definition.name,\n    status: 'running',\n    progress: 0,\n    tasks: createTaskSnapshots(definition),\n    steps: [],\n    taskCount: definition.tasks.length,\n    connectorName,\n    model,\n    startedAt: now,\n    lastActivityAt: now,\n    trigger: trigger ?? { type: 'manual' },\n  };\n}\n","/**\n * FileContextStorage - File-based storage for AgentContext session persistence\n *\n * Stores context sessions as JSON files on disk.\n * Path: ~/.oneringai/agents/<agentId>/sessions/<sessionId>.json\n * Windows: %APPDATA%/oneringai/agents/<agentId>/sessions/<sessionId>.json\n *\n * Features:\n * - Cross-platform path handling\n * - Safe session ID sanitization\n * - Atomic file operations (write to temp, then rename)\n * - Automatic directory creation\n * - Index file for fast listing\n */\n\nimport { promises as fs } from 'fs';\nimport { join } from 'path';\nimport { homedir } from 'os';\nimport type {\n  IContextStorage,\n  StoredContextSession,\n  ContextSessionSummary,\n  ContextSessionMetadata,\n  ContextStorageListOptions,\n  SerializedContextState,\n} from '../../domain/interfaces/IContextStorage.js';\nimport { CONTEXT_SESSION_FORMAT_VERSION } from '../../domain/interfaces/IContextStorage.js';\n\n/**\n * Configuration for FileContextStorage\n */\nexport interface FileContextStorageConfig {\n  /** Agent ID (used to create unique storage path) */\n  agentId: string;\n  /** Override the base directory (default: ~/.oneringai/agents) */\n  baseDirectory?: string;\n  /** Pretty-print JSON (default: true for debugging, false in production) */\n  prettyPrint?: boolean;\n}\n\n/**\n * Index entry for fast listing\n */\ninterface SessionIndexEntry {\n  sessionId: string;\n  createdAt: string;\n  lastSavedAt: string;\n  messageCount: number;\n  memoryEntryCount: number;\n  metadata: ContextSessionMetadata;\n}\n\n/**\n * Index file structure\n */\ninterface SessionIndex {\n  version: number;\n  agentId: string;\n  sessions: SessionIndexEntry[];\n  lastUpdated: string;\n}\n\n/**\n * Get the default base directory for agent storage\n * Uses ~/.oneringai/agents on Unix-like systems\n * Uses %APPDATA%/oneringai/agents on Windows\n */\nfunction getDefaultBaseDirectory(): string {\n  const platform = process.platform;\n\n  if (platform === 'win32') {\n    // Windows: Use APPDATA if available, otherwise fall back to home\n    const appData = process.env.APPDATA || process.env.LOCALAPPDATA;\n    if (appData) {\n      return join(appData, 'oneringai', 'agents');\n    }\n  }\n\n  // Unix-like (Linux, macOS) and fallback: Use home directory\n  return join(homedir(), '.oneringai', 'agents');\n}\n\n/**\n * Sanitize ID for use as a directory/file name\n * Removes or replaces characters that are not safe for filenames\n */\nfunction sanitizeId(id: string): string {\n  return id\n    .replace(/[^a-zA-Z0-9_-]/g, '_')  // Replace unsafe chars with underscore\n    .replace(/_+/g, '_')               // Collapse multiple underscores\n    .replace(/^_|_$/g, '')             // Remove leading/trailing underscores\n    .toLowerCase()                      // Normalize to lowercase\n    || 'default';                       // Fallback if empty\n}\n\n/**\n * Current format version (imported from interface)\n */\nconst FORMAT_VERSION = CONTEXT_SESSION_FORMAT_VERSION;\n\n/**\n * File-based storage for AgentContext session persistence\n */\nexport class FileContextStorage implements IContextStorage {\n  private readonly agentId: string;\n  private readonly sessionsDirectory: string;\n  private readonly indexPath: string;\n  private readonly prettyPrint: boolean;\n  private index: SessionIndex | null = null;\n\n  constructor(config: FileContextStorageConfig) {\n    this.agentId = config.agentId;\n    const sanitizedAgentId = sanitizeId(config.agentId);\n    const baseDir = config.baseDirectory ?? getDefaultBaseDirectory();\n    this.prettyPrint = config.prettyPrint ?? true;\n\n    // Sessions are stored in: <baseDir>/<agentId>/sessions/\n    this.sessionsDirectory = join(baseDir, sanitizedAgentId, 'sessions');\n    this.indexPath = join(this.sessionsDirectory, '_index.json');\n  }\n\n  /**\n   * Save context state to a session file\n   */\n  async save(\n    sessionId: string,\n    state: SerializedContextState,\n    metadata?: ContextSessionMetadata\n  ): Promise<void> {\n    await this.ensureDirectory();\n\n    const now = new Date().toISOString();\n    const sanitizedSessionId = sanitizeId(sessionId);\n    const filePath = this.getFilePath(sanitizedSessionId);\n\n    // Check if session exists to preserve createdAt\n    let createdAt = now;\n    const existing = await this.loadRaw(sanitizedSessionId);\n    if (existing) {\n      createdAt = existing.createdAt;\n    }\n\n    // Build stored session\n    const storedSession: StoredContextSession = {\n      version: FORMAT_VERSION,\n      sessionId,\n      createdAt,\n      lastSavedAt: now,\n      state,\n      metadata: metadata ?? {},\n    };\n\n    // Write atomically: write to temp file, then rename\n    const data = this.prettyPrint\n      ? JSON.stringify(storedSession, null, 2)\n      : JSON.stringify(storedSession);\n\n    const tempPath = `${filePath}.tmp`;\n    try {\n      await fs.writeFile(tempPath, data, 'utf-8');\n      await fs.rename(tempPath, filePath);\n    } catch (error) {\n      // Clean up temp file if rename failed\n      try {\n        await fs.unlink(tempPath);\n      } catch {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n\n    // Update index\n    await this.updateIndex(storedSession);\n  }\n\n  /**\n   * Load context state from a session file\n   */\n  async load(sessionId: string): Promise<StoredContextSession | null> {\n    const sanitizedSessionId = sanitizeId(sessionId);\n    return this.loadRaw(sanitizedSessionId);\n  }\n\n  /**\n   * Delete a session\n   */\n  async delete(sessionId: string): Promise<void> {\n    const sanitizedSessionId = sanitizeId(sessionId);\n    const filePath = this.getFilePath(sanitizedSessionId);\n\n    try {\n      await fs.unlink(filePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n      // Ignore if file doesn't exist\n    }\n\n    // Remove from index\n    await this.removeFromIndex(sessionId);\n  }\n\n  /**\n   * Check if a session exists\n   */\n  async exists(sessionId: string): Promise<boolean> {\n    const sanitizedSessionId = sanitizeId(sessionId);\n    const filePath = this.getFilePath(sanitizedSessionId);\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * List all sessions (summaries only)\n   */\n  async list(options?: ContextStorageListOptions): Promise<ContextSessionSummary[]> {\n    const index = await this.loadIndex();\n    let entries = [...index.sessions];\n\n    // Apply filters\n    if (options?.tags && options.tags.length > 0) {\n      entries = entries.filter(e => {\n        const entryTags = e.metadata.tags ?? [];\n        return options.tags!.some(t => entryTags.includes(t));\n      });\n    }\n\n    if (options?.createdAfter) {\n      const after = options.createdAfter.getTime();\n      entries = entries.filter(e => new Date(e.createdAt).getTime() >= after);\n    }\n\n    if (options?.createdBefore) {\n      const before = options.createdBefore.getTime();\n      entries = entries.filter(e => new Date(e.createdAt).getTime() <= before);\n    }\n\n    if (options?.savedAfter) {\n      const after = options.savedAfter.getTime();\n      entries = entries.filter(e => new Date(e.lastSavedAt).getTime() >= after);\n    }\n\n    if (options?.savedBefore) {\n      const before = options.savedBefore.getTime();\n      entries = entries.filter(e => new Date(e.lastSavedAt).getTime() <= before);\n    }\n\n    // Sort by lastSavedAt descending (most recent first)\n    entries.sort((a, b) =>\n      new Date(b.lastSavedAt).getTime() - new Date(a.lastSavedAt).getTime()\n    );\n\n    // Apply pagination\n    if (options?.offset) {\n      entries = entries.slice(options.offset);\n    }\n    if (options?.limit) {\n      entries = entries.slice(0, options.limit);\n    }\n\n    // Convert to summaries\n    return entries.map(e => ({\n      sessionId: e.sessionId,\n      createdAt: new Date(e.createdAt),\n      lastSavedAt: new Date(e.lastSavedAt),\n      messageCount: e.messageCount,\n      memoryEntryCount: e.memoryEntryCount,\n      metadata: e.metadata,\n    }));\n  }\n\n  /**\n   * Update session metadata without loading full state\n   */\n  async updateMetadata(\n    sessionId: string,\n    metadata: Partial<ContextSessionMetadata>\n  ): Promise<void> {\n    const stored = await this.load(sessionId);\n    if (!stored) {\n      throw new Error(`Session '${sessionId}' not found`);\n    }\n\n    // Merge metadata\n    stored.metadata = { ...stored.metadata, ...metadata };\n    stored.lastSavedAt = new Date().toISOString();\n\n    // Save back\n    const sanitizedSessionId = sanitizeId(sessionId);\n    const filePath = this.getFilePath(sanitizedSessionId);\n    const data = this.prettyPrint\n      ? JSON.stringify(stored, null, 2)\n      : JSON.stringify(stored);\n\n    await fs.writeFile(filePath, data, 'utf-8');\n\n    // Update index\n    await this.updateIndex(stored);\n  }\n\n  /**\n   * Get the storage path (for display/debugging)\n   * @deprecated Use getLocation() instead\n   */\n  getPath(): string {\n    return this.sessionsDirectory;\n  }\n\n  /**\n   * Get a human-readable storage location string (for display/debugging)\n   */\n  getLocation(): string {\n    return this.sessionsDirectory;\n  }\n\n  /**\n   * Get the agent ID\n   */\n  getAgentId(): string {\n    return this.agentId;\n  }\n\n  /**\n   * Rebuild the index by scanning all session files\n   * Useful for recovery or migration\n   */\n  async rebuildIndex(): Promise<void> {\n    await this.ensureDirectory();\n\n    const files = await fs.readdir(this.sessionsDirectory);\n    const sessionFiles = files.filter(f => f.endsWith('.json') && !f.startsWith('_'));\n\n    const entries: SessionIndexEntry[] = [];\n\n    for (const file of sessionFiles) {\n      try {\n        const filePath = join(this.sessionsDirectory, file);\n        const data = await fs.readFile(filePath, 'utf-8');\n        const stored = JSON.parse(data) as StoredContextSession;\n        entries.push(this.storedToIndexEntry(stored));\n      } catch {\n        // Skip invalid files\n      }\n    }\n\n    this.index = {\n      version: 1,\n      agentId: this.agentId,\n      sessions: entries,\n      lastUpdated: new Date().toISOString(),\n    };\n\n    await this.saveIndex();\n  }\n\n  // ==========================================================================\n  // Private Helpers\n  // ==========================================================================\n\n  private getFilePath(sanitizedSessionId: string): string {\n    return join(this.sessionsDirectory, `${sanitizedSessionId}.json`);\n  }\n\n  private async ensureDirectory(): Promise<void> {\n    try {\n      await fs.mkdir(this.sessionsDirectory, { recursive: true });\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        throw error;\n      }\n    }\n  }\n\n  private async loadRaw(sanitizedSessionId: string): Promise<StoredContextSession | null> {\n    const filePath = this.getFilePath(sanitizedSessionId);\n\n    try {\n      const data = await fs.readFile(filePath, 'utf-8');\n      return JSON.parse(data) as StoredContextSession;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return null;\n      }\n      // Handle corrupted JSON files gracefully\n      if (error instanceof SyntaxError) {\n        console.warn(`Corrupted session file: ${filePath}`);\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  private async loadIndex(): Promise<SessionIndex> {\n    if (this.index) {\n      return this.index;\n    }\n\n    try {\n      const data = await fs.readFile(this.indexPath, 'utf-8');\n      this.index = JSON.parse(data) as SessionIndex;\n      return this.index;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        // No index yet, create empty one\n        this.index = {\n          version: 1,\n          agentId: this.agentId,\n          sessions: [],\n          lastUpdated: new Date().toISOString(),\n        };\n        return this.index;\n      }\n      throw error;\n    }\n  }\n\n  private async saveIndex(): Promise<void> {\n    if (!this.index) return;\n\n    await this.ensureDirectory();\n    this.index.lastUpdated = new Date().toISOString();\n    const data = this.prettyPrint\n      ? JSON.stringify(this.index, null, 2)\n      : JSON.stringify(this.index);\n\n    await fs.writeFile(this.indexPath, data, 'utf-8');\n  }\n\n  private async updateIndex(stored: StoredContextSession): Promise<void> {\n    const index = await this.loadIndex();\n    const entry = this.storedToIndexEntry(stored);\n\n    const existingIdx = index.sessions.findIndex(e => e.sessionId === stored.sessionId);\n    if (existingIdx >= 0) {\n      index.sessions[existingIdx] = entry;\n    } else {\n      index.sessions.push(entry);\n    }\n\n    await this.saveIndex();\n  }\n\n  private async removeFromIndex(sessionId: string): Promise<void> {\n    const index = await this.loadIndex();\n    index.sessions = index.sessions.filter(e => e.sessionId !== sessionId);\n    await this.saveIndex();\n  }\n\n  private storedToIndexEntry(stored: StoredContextSession): SessionIndexEntry {\n    // NextGen state structure:\n    // - conversation: InputItem[] (the history)\n    // - pluginStates.workingMemory: { entries: [...] }\n    const workingMemoryState = stored.state.pluginStates?.workingMemory as\n      | { entries?: unknown[] }\n      | undefined;\n\n    return {\n      sessionId: stored.sessionId,\n      createdAt: stored.createdAt,\n      lastSavedAt: stored.lastSavedAt,\n      messageCount: stored.state.conversation?.length ?? 0,\n      memoryEntryCount: workingMemoryState?.entries?.length ?? 0,\n      metadata: stored.metadata,\n    };\n  }\n}\n\n/**\n * Create a FileContextStorage for the given agent\n *\n * @param agentId - Agent ID\n * @param options - Optional configuration\n * @returns FileContextStorage instance\n *\n * @example\n * ```typescript\n * const storage = createFileContextStorage('my-agent');\n * const ctx = AgentContext.create({\n *   model: 'gpt-4',\n *   storage,\n * });\n *\n * // Save session\n * await ctx.save('session-001', { title: 'My Session' });\n *\n * // Load session\n * await ctx.load('session-001');\n * ```\n */\nexport function createFileContextStorage(\n  agentId: string,\n  options?: Omit<FileContextStorageConfig, 'agentId'>\n): FileContextStorage {\n  return new FileContextStorage({ agentId, ...options });\n}\n","/**\n * FileAgentDefinitionStorage - File-based storage for agent definitions\n *\n * Stores agent definitions as JSON files on disk.\n * Path: ~/.oneringai/agents/<agentId>/definition.json\n * Windows: %APPDATA%/oneringai/agents/<agentId>/definition.json\n *\n * Features:\n * - Cross-platform path handling\n * - Safe agent ID sanitization\n * - Atomic file operations\n * - Automatic directory creation\n * - Index file for fast listing\n */\n\nimport { promises as fs } from 'fs';\nimport { join } from 'path';\nimport { homedir } from 'os';\nimport type {\n  IAgentDefinitionStorage,\n  StoredAgentDefinition,\n  AgentDefinitionSummary,\n  AgentDefinitionMetadata,\n  AgentDefinitionListOptions,\n} from '../../domain/interfaces/IAgentDefinitionStorage.js';\nimport { AGENT_DEFINITION_FORMAT_VERSION } from '../../domain/interfaces/IAgentDefinitionStorage.js';\n\n/**\n * Configuration for FileAgentDefinitionStorage\n */\nexport interface FileAgentDefinitionStorageConfig {\n  /** Override the base directory (default: ~/.oneringai/agents) */\n  baseDirectory?: string;\n  /** Pretty-print JSON (default: true) */\n  prettyPrint?: boolean;\n}\n\n/**\n * Index entry for fast listing\n */\ninterface DefinitionIndexEntry {\n  agentId: string;\n  name: string;\n  agentType: string;\n  model: string;\n  createdAt: string;\n  updatedAt: string;\n  metadata?: AgentDefinitionMetadata;\n}\n\n/**\n * Index file structure\n */\ninterface DefinitionIndex {\n  version: number;\n  agents: DefinitionIndexEntry[];\n  lastUpdated: string;\n}\n\n/**\n * Get the default base directory for agent storage\n */\nfunction getDefaultBaseDirectory(): string {\n  const platform = process.platform;\n\n  if (platform === 'win32') {\n    const appData = process.env.APPDATA || process.env.LOCALAPPDATA;\n    if (appData) {\n      return join(appData, 'oneringai', 'agents');\n    }\n  }\n\n  return join(homedir(), '.oneringai', 'agents');\n}\n\n/**\n * Sanitize agent ID for use as a directory name\n */\nfunction sanitizeAgentId(agentId: string): string {\n  return agentId\n    .replace(/[^a-zA-Z0-9_-]/g, '_')\n    .replace(/_+/g, '_')\n    .replace(/^_|_$/g, '')\n    .toLowerCase()\n    || 'default';\n}\n\n/**\n * File-based storage for agent definitions\n */\nexport class FileAgentDefinitionStorage implements IAgentDefinitionStorage {\n  private readonly baseDirectory: string;\n  private readonly indexPath: string;\n  private readonly prettyPrint: boolean;\n  private index: DefinitionIndex | null = null;\n\n  constructor(config: FileAgentDefinitionStorageConfig = {}) {\n    this.baseDirectory = config.baseDirectory ?? getDefaultBaseDirectory();\n    this.prettyPrint = config.prettyPrint ?? true;\n    this.indexPath = join(this.baseDirectory, '_agents_index.json');\n  }\n\n  /**\n   * Save an agent definition\n   */\n  async save(definition: StoredAgentDefinition): Promise<void> {\n    const sanitizedId = sanitizeAgentId(definition.agentId);\n    const agentDir = join(this.baseDirectory, sanitizedId);\n    const filePath = join(agentDir, 'definition.json');\n\n    // Ensure directory exists\n    await this.ensureDirectory(agentDir);\n\n    // Update timestamps\n    const now = new Date().toISOString();\n    if (!definition.createdAt) {\n      // Check if existing definition exists to preserve createdAt\n      const existing = await this.loadRaw(sanitizedId);\n      definition.createdAt = existing?.createdAt ?? now;\n    }\n    definition.updatedAt = now;\n    definition.version = AGENT_DEFINITION_FORMAT_VERSION;\n\n    // Write atomically\n    const data = this.prettyPrint\n      ? JSON.stringify(definition, null, 2)\n      : JSON.stringify(definition);\n\n    const tempPath = `${filePath}.tmp`;\n    try {\n      await fs.writeFile(tempPath, data, 'utf-8');\n      await fs.rename(tempPath, filePath);\n    } catch (error) {\n      try {\n        await fs.unlink(tempPath);\n      } catch {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n\n    // Update index\n    await this.updateIndex(definition);\n  }\n\n  /**\n   * Load an agent definition\n   */\n  async load(agentId: string): Promise<StoredAgentDefinition | null> {\n    const sanitizedId = sanitizeAgentId(agentId);\n    return this.loadRaw(sanitizedId);\n  }\n\n  /**\n   * Delete an agent definition\n   */\n  async delete(agentId: string): Promise<void> {\n    const sanitizedId = sanitizeAgentId(agentId);\n    const agentDir = join(this.baseDirectory, sanitizedId);\n    const filePath = join(agentDir, 'definition.json');\n\n    try {\n      await fs.unlink(filePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n\n    // Remove from index\n    await this.removeFromIndex(agentId);\n  }\n\n  /**\n   * Check if an agent definition exists\n   */\n  async exists(agentId: string): Promise<boolean> {\n    const sanitizedId = sanitizeAgentId(agentId);\n    const filePath = join(this.baseDirectory, sanitizedId, 'definition.json');\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * List all agent definitions\n   */\n  async list(options?: AgentDefinitionListOptions): Promise<AgentDefinitionSummary[]> {\n    const index = await this.loadIndex();\n    let entries = [...index.agents];\n\n    // Apply filters\n    if (options?.agentType) {\n      entries = entries.filter(e => e.agentType === options.agentType);\n    }\n\n    if (options?.tags && options.tags.length > 0) {\n      entries = entries.filter(e => {\n        const entryTags = e.metadata?.tags ?? [];\n        return options.tags!.some(t => entryTags.includes(t));\n      });\n    }\n\n    // Sort by updatedAt descending\n    entries.sort((a, b) =>\n      new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime()\n    );\n\n    // Apply pagination\n    if (options?.offset) {\n      entries = entries.slice(options.offset);\n    }\n    if (options?.limit) {\n      entries = entries.slice(0, options.limit);\n    }\n\n    // Convert to summaries\n    return entries.map(e => ({\n      agentId: e.agentId,\n      name: e.name,\n      agentType: e.agentType,\n      model: e.model,\n      createdAt: new Date(e.createdAt),\n      updatedAt: new Date(e.updatedAt),\n      metadata: e.metadata,\n    }));\n  }\n\n  /**\n   * Update metadata without loading full definition\n   */\n  async updateMetadata(\n    agentId: string,\n    metadata: Partial<AgentDefinitionMetadata>\n  ): Promise<void> {\n    const definition = await this.load(agentId);\n    if (!definition) {\n      throw new Error(`Agent '${agentId}' not found`);\n    }\n\n    definition.metadata = { ...definition.metadata, ...metadata };\n    await this.save(definition);\n  }\n\n  /**\n   * Get storage path\n   */\n  getPath(): string {\n    return this.baseDirectory;\n  }\n\n  /**\n   * Rebuild the index by scanning all agent directories\n   */\n  async rebuildIndex(): Promise<void> {\n    await this.ensureDirectory(this.baseDirectory);\n\n    const entries = await fs.readdir(this.baseDirectory, { withFileTypes: true });\n    const agentDirs = entries.filter(e => e.isDirectory() && !e.name.startsWith('_'));\n\n    const indexEntries: DefinitionIndexEntry[] = [];\n\n    for (const dir of agentDirs) {\n      try {\n        const filePath = join(this.baseDirectory, dir.name, 'definition.json');\n        const data = await fs.readFile(filePath, 'utf-8');\n        const definition = JSON.parse(data) as StoredAgentDefinition;\n        indexEntries.push(this.definitionToIndexEntry(definition));\n      } catch {\n        // Skip invalid directories\n      }\n    }\n\n    this.index = {\n      version: 1,\n      agents: indexEntries,\n      lastUpdated: new Date().toISOString(),\n    };\n\n    await this.saveIndex();\n  }\n\n  // ==========================================================================\n  // Private Helpers\n  // ==========================================================================\n\n  private async ensureDirectory(dir: string): Promise<void> {\n    try {\n      await fs.mkdir(dir, { recursive: true });\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        throw error;\n      }\n    }\n  }\n\n  private async loadRaw(sanitizedId: string): Promise<StoredAgentDefinition | null> {\n    const filePath = join(this.baseDirectory, sanitizedId, 'definition.json');\n\n    try {\n      const data = await fs.readFile(filePath, 'utf-8');\n      return JSON.parse(data) as StoredAgentDefinition;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return null;\n      }\n      if (error instanceof SyntaxError) {\n        console.warn(`Corrupted agent definition: ${filePath}`);\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  private async loadIndex(): Promise<DefinitionIndex> {\n    if (this.index) {\n      return this.index;\n    }\n\n    try {\n      const data = await fs.readFile(this.indexPath, 'utf-8');\n      this.index = JSON.parse(data) as DefinitionIndex;\n      return this.index;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        this.index = {\n          version: 1,\n          agents: [],\n          lastUpdated: new Date().toISOString(),\n        };\n        return this.index;\n      }\n      throw error;\n    }\n  }\n\n  private async saveIndex(): Promise<void> {\n    if (!this.index) return;\n\n    await this.ensureDirectory(this.baseDirectory);\n    this.index.lastUpdated = new Date().toISOString();\n    const data = this.prettyPrint\n      ? JSON.stringify(this.index, null, 2)\n      : JSON.stringify(this.index);\n\n    await fs.writeFile(this.indexPath, data, 'utf-8');\n  }\n\n  private async updateIndex(definition: StoredAgentDefinition): Promise<void> {\n    const index = await this.loadIndex();\n    const entry = this.definitionToIndexEntry(definition);\n\n    const existingIdx = index.agents.findIndex(e => e.agentId === definition.agentId);\n    if (existingIdx >= 0) {\n      index.agents[existingIdx] = entry;\n    } else {\n      index.agents.push(entry);\n    }\n\n    await this.saveIndex();\n  }\n\n  private async removeFromIndex(agentId: string): Promise<void> {\n    const index = await this.loadIndex();\n    index.agents = index.agents.filter(e => e.agentId !== agentId);\n    await this.saveIndex();\n  }\n\n  private definitionToIndexEntry(definition: StoredAgentDefinition): DefinitionIndexEntry {\n    return {\n      agentId: definition.agentId,\n      name: definition.name,\n      agentType: definition.agentType,\n      model: definition.connector.model,\n      createdAt: definition.createdAt,\n      updatedAt: definition.updatedAt,\n      metadata: definition.metadata,\n    };\n  }\n}\n\n/**\n * Create a FileAgentDefinitionStorage with default configuration\n */\nexport function createFileAgentDefinitionStorage(\n  config?: FileAgentDefinitionStorageConfig\n): FileAgentDefinitionStorage {\n  return new FileAgentDefinitionStorage(config);\n}\n","/**\n * FileMediaStorage - File-based media storage implementation\n *\n * Saves generated media to a configurable directory on the local filesystem.\n * Default output directory: `os.tmpdir()/oneringai-media/`\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\nimport * as os from 'os';\nimport * as crypto from 'crypto';\nimport type {\n  IMediaStorage,\n  MediaStorageMetadata,\n  MediaStorageResult,\n  MediaStorageEntry,\n  MediaStorageListOptions,\n} from '../../domain/interfaces/IMediaStorage.js';\n\nconst MIME_TYPES: Record<string, string> = {\n  png: 'image/png',\n  jpeg: 'image/jpeg',\n  jpg: 'image/jpeg',\n  webp: 'image/webp',\n  gif: 'image/gif',\n  mp4: 'video/mp4',\n  webm: 'video/webm',\n  mp3: 'audio/mpeg',\n  wav: 'audio/wav',\n  opus: 'audio/opus',\n  ogg: 'audio/ogg',\n  aac: 'audio/aac',\n  flac: 'audio/flac',\n  pcm: 'audio/pcm',\n};\n\n/**\n * Media type prefixes used in generated filenames\n */\nconst MEDIA_TYPE_PREFIXES = ['image', 'video', 'audio'] as const;\n\nexport interface FileMediaStorageConfig {\n  /** Directory to store media files. Defaults to `os.tmpdir()/oneringai-media/` */\n  outputDir?: string;\n}\n\nexport class FileMediaStorage implements IMediaStorage {\n  private outputDir: string;\n  private initialized = false;\n\n  constructor(config?: FileMediaStorageConfig) {\n    this.outputDir = config?.outputDir ?? path.join(os.tmpdir(), 'oneringai-media');\n  }\n\n  async save(data: Buffer, metadata: MediaStorageMetadata): Promise<MediaStorageResult> {\n    const dir = metadata.userId\n      ? path.join(this.outputDir, metadata.userId)\n      : this.outputDir;\n    await fs.mkdir(dir, { recursive: true });\n\n    const filename = metadata.suggestedFilename ?? this.generateFilename(metadata);\n    const filePath = path.join(dir, filename);\n    await fs.writeFile(filePath, data);\n\n    const format = metadata.format.toLowerCase();\n    const mimeType = MIME_TYPES[format] ?? 'application/octet-stream';\n\n    return {\n      location: filePath,\n      mimeType,\n      size: data.length,\n    };\n  }\n\n  async read(location: string): Promise<Buffer | null> {\n    try {\n      return await fs.readFile(location);\n    } catch (err: any) {\n      if (err.code === 'ENOENT') {\n        return null;\n      }\n      throw err;\n    }\n  }\n\n  async delete(location: string): Promise<void> {\n    try {\n      await fs.unlink(location);\n    } catch (err: any) {\n      if (err.code === 'ENOENT') {\n        return;\n      }\n      throw err;\n    }\n  }\n\n  async exists(location: string): Promise<boolean> {\n    try {\n      await fs.access(location);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  async list(options?: MediaStorageListOptions): Promise<MediaStorageEntry[]> {\n    await this.ensureDir();\n\n    let entries: MediaStorageEntry[] = [];\n\n    const files = await fs.readdir(this.outputDir);\n    for (const file of files) {\n      const filePath = path.join(this.outputDir, file);\n      try {\n        const stat = await fs.stat(filePath);\n        if (!stat.isFile()) continue;\n\n        const ext = path.extname(file).slice(1).toLowerCase();\n        const mimeType = MIME_TYPES[ext] ?? 'application/octet-stream';\n\n        // Detect media type from filename prefix (image_*, video_*, audio_*)\n        let type: 'image' | 'video' | 'audio' | undefined;\n        for (const prefix of MEDIA_TYPE_PREFIXES) {\n          if (file.startsWith(`${prefix}_`)) {\n            type = prefix;\n            break;\n          }\n        }\n\n        entries.push({\n          location: filePath,\n          mimeType,\n          size: stat.size,\n          type,\n          createdAt: stat.birthtime,\n        });\n      } catch {\n        // Skip files we can't stat\n      }\n    }\n\n    // Filter by type\n    if (options?.type) {\n      entries = entries.filter((e) => e.type === options.type);\n    }\n\n    // Sort by creation time descending\n    entries.sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime());\n\n    // Pagination\n    const offset = options?.offset ?? 0;\n    const limit = options?.limit ?? entries.length;\n    return entries.slice(offset, offset + limit);\n  }\n\n  getPath(): string {\n    return this.outputDir;\n  }\n\n  private generateFilename(metadata: MediaStorageMetadata): string {\n    const timestamp = Date.now();\n    const random = crypto.randomBytes(4).toString('hex');\n    const indexSuffix = metadata.index != null ? `_${metadata.index}` : '';\n    return `${metadata.type}_${timestamp}_${random}${indexSuffix}.${metadata.format}`;\n  }\n\n  private async ensureDir(): Promise<void> {\n    if (!this.initialized) {\n      await fs.mkdir(this.outputDir, { recursive: true });\n      this.initialized = true;\n    }\n  }\n}\n\n/**\n * Factory function for creating FileMediaStorage instances\n */\nexport function createFileMediaStorage(config?: FileMediaStorageConfig): FileMediaStorage {\n  return new FileMediaStorage(config);\n}\n","/**\n * FileCustomToolStorage - File-based storage for custom tool definitions\n *\n * Stores custom tools as JSON files on disk with per-user isolation.\n * Path: ~/.oneringai/users/<userId>/custom-tools/<sanitized-name>.json\n *\n * Features:\n * - Per-user isolation (multi-tenant safe)\n * - Cross-platform path handling\n * - Safe name sanitization\n * - Atomic file operations (write to .tmp then rename)\n * - Per-user index file for fast listing\n * - Search support (case-insensitive substring on name + description)\n */\n\nimport { promises as fs } from 'fs';\nimport { join } from 'path';\nimport { homedir } from 'os';\nimport type { ICustomToolStorage, CustomToolListOptions } from '../../domain/interfaces/ICustomToolStorage.js';\nimport type { CustomToolDefinition, CustomToolSummary } from '../../domain/entities/CustomToolDefinition.js';\n\n/**\n * Configuration for FileCustomToolStorage\n */\nexport interface FileCustomToolStorageConfig {\n  /** Override the base directory (default: ~/.oneringai/users) */\n  baseDirectory?: string;\n  /** Pretty-print JSON (default: true) */\n  prettyPrint?: boolean;\n}\n\n/**\n * Index entry for fast listing\n */\ninterface CustomToolIndexEntry {\n  name: string;\n  displayName?: string;\n  description: string;\n  createdAt: string;\n  updatedAt: string;\n  tags?: string[];\n  category?: string;\n}\n\n/**\n * Index file structure\n */\ninterface CustomToolIndex {\n  version: number;\n  tools: CustomToolIndexEntry[];\n  lastUpdated: string;\n}\n\n/**\n * Get the default base directory for custom tool storage\n */\nfunction getDefaultBaseDirectory(): string {\n  const platform = process.platform;\n\n  if (platform === 'win32') {\n    const appData = process.env.APPDATA || process.env.LOCALAPPDATA;\n    if (appData) {\n      return join(appData, 'oneringai', 'users');\n    }\n  }\n\n  return join(homedir(), '.oneringai', 'users');\n}\n\n/**\n * Default user ID when none is provided\n */\nconst DEFAULT_USER_ID = 'default';\n\n/**\n * Sanitize user ID for use as a directory name\n * Removes or replaces characters that are not safe for filenames\n */\nfunction sanitizeUserId(userId: string | undefined): string {\n  if (!userId) {\n    return DEFAULT_USER_ID;\n  }\n  return userId\n    .replace(/[^a-zA-Z0-9_-]/g, '_')\n    .replace(/_+/g, '_')\n    .replace(/^_|_$/g, '')\n    .toLowerCase()\n    || DEFAULT_USER_ID;\n}\n\n/**\n * Sanitize tool name for use as a filename\n */\nfunction sanitizeName(name: string): string {\n  return name\n    .replace(/[^a-zA-Z0-9_-]/g, '_')\n    .replace(/_+/g, '_')\n    .replace(/^_|_$/g, '')\n    .toLowerCase()\n    || 'default';\n}\n\n/**\n * File-based storage for custom tool definitions\n *\n * Single instance handles all users. UserId is passed to each method.\n */\nexport class FileCustomToolStorage implements ICustomToolStorage {\n  private readonly baseDirectory: string;\n  private readonly prettyPrint: boolean;\n\n  constructor(config: FileCustomToolStorageConfig = {}) {\n    this.baseDirectory = config.baseDirectory ?? getDefaultBaseDirectory();\n    this.prettyPrint = config.prettyPrint ?? true;\n  }\n\n  /**\n   * Get the directory path for a specific user's custom tools\n   */\n  private getUserDirectory(userId: string | undefined): string {\n    const sanitizedId = sanitizeUserId(userId);\n    return join(this.baseDirectory, sanitizedId, 'custom-tools');\n  }\n\n  /**\n   * Get the index file path for a specific user\n   */\n  private getUserIndexPath(userId: string | undefined): string {\n    return join(this.getUserDirectory(userId), '_index.json');\n  }\n\n  /**\n   * Get the tool file path for a specific user\n   */\n  private getToolPath(userId: string | undefined, sanitizedName: string): string {\n    return join(this.getUserDirectory(userId), `${sanitizedName}.json`);\n  }\n\n  /**\n   * Save a custom tool definition\n   */\n  async save(userId: string | undefined, definition: CustomToolDefinition): Promise<void> {\n    const directory = this.getUserDirectory(userId);\n    const sanitized = sanitizeName(definition.name);\n    const filePath = this.getToolPath(userId, sanitized);\n\n    // Ensure directory exists\n    await this.ensureDirectory(directory);\n\n    // Write atomically\n    const data = this.prettyPrint\n      ? JSON.stringify(definition, null, 2)\n      : JSON.stringify(definition);\n\n    const tempPath = `${filePath}.tmp`;\n    try {\n      await fs.writeFile(tempPath, data, 'utf-8');\n      await fs.rename(tempPath, filePath);\n    } catch (error) {\n      try {\n        await fs.unlink(tempPath);\n      } catch {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n\n    // Update index\n    await this.updateIndex(userId, definition);\n  }\n\n  /**\n   * Load a custom tool definition by name\n   */\n  async load(userId: string | undefined, name: string): Promise<CustomToolDefinition | null> {\n    const sanitized = sanitizeName(name);\n    const filePath = this.getToolPath(userId, sanitized);\n\n    try {\n      const data = await fs.readFile(filePath, 'utf-8');\n      return JSON.parse(data) as CustomToolDefinition;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return null;\n      }\n      if (error instanceof SyntaxError) {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Delete a custom tool definition\n   */\n  async delete(userId: string | undefined, name: string): Promise<void> {\n    const sanitized = sanitizeName(name);\n    const filePath = this.getToolPath(userId, sanitized);\n\n    try {\n      await fs.unlink(filePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n\n    // Remove from index\n    await this.removeFromIndex(userId, name);\n  }\n\n  /**\n   * Check if a custom tool exists\n   */\n  async exists(userId: string | undefined, name: string): Promise<boolean> {\n    const sanitized = sanitizeName(name);\n    const filePath = this.getToolPath(userId, sanitized);\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * List custom tools (summaries only)\n   */\n  async list(userId: string | undefined, options?: CustomToolListOptions): Promise<CustomToolSummary[]> {\n    const index = await this.loadIndex(userId);\n    let entries = [...index.tools];\n\n    // Apply tag filter\n    if (options?.tags && options.tags.length > 0) {\n      entries = entries.filter(e => {\n        const entryTags = e.tags ?? [];\n        return options.tags!.some(t => entryTags.includes(t));\n      });\n    }\n\n    // Apply category filter\n    if (options?.category) {\n      entries = entries.filter(e => e.category === options.category);\n    }\n\n    // Apply search filter (case-insensitive substring match on name + description)\n    if (options?.search) {\n      const searchLower = options.search.toLowerCase();\n      entries = entries.filter(e =>\n        e.name.toLowerCase().includes(searchLower) ||\n        e.description.toLowerCase().includes(searchLower)\n      );\n    }\n\n    // Sort by updatedAt descending\n    entries.sort((a, b) =>\n      new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime()\n    );\n\n    // Apply pagination\n    if (options?.offset) {\n      entries = entries.slice(options.offset);\n    }\n    if (options?.limit) {\n      entries = entries.slice(0, options.limit);\n    }\n\n    // Convert to summaries\n    return entries.map(e => ({\n      name: e.name,\n      displayName: e.displayName,\n      description: e.description,\n      createdAt: e.createdAt,\n      updatedAt: e.updatedAt,\n      metadata: {\n        tags: e.tags,\n        category: e.category,\n      },\n    }));\n  }\n\n  /**\n   * Update metadata without loading full definition\n   */\n  async updateMetadata(userId: string | undefined, name: string, metadata: Record<string, unknown>): Promise<void> {\n    const definition = await this.load(userId, name);\n    if (!definition) {\n      throw new Error(`Custom tool '${name}' not found`);\n    }\n\n    definition.metadata = { ...definition.metadata, ...metadata };\n    definition.updatedAt = new Date().toISOString();\n    await this.save(userId, definition);\n  }\n\n  /**\n   * Get storage path for a specific user\n   */\n  getPath(userId: string | undefined): string {\n    return this.getUserDirectory(userId);\n  }\n\n  // ==========================================================================\n  // Private Helpers\n  // ==========================================================================\n\n  private async ensureDirectory(dir: string): Promise<void> {\n    try {\n      await fs.mkdir(dir, { recursive: true });\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        throw error;\n      }\n    }\n  }\n\n  private async loadIndex(userId: string | undefined): Promise<CustomToolIndex> {\n    const indexPath = this.getUserIndexPath(userId);\n\n    try {\n      const data = await fs.readFile(indexPath, 'utf-8');\n      return JSON.parse(data) as CustomToolIndex;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return {\n          version: 1,\n          tools: [],\n          lastUpdated: new Date().toISOString(),\n        };\n      }\n      throw error;\n    }\n  }\n\n  private async saveIndex(userId: string | undefined, index: CustomToolIndex): Promise<void> {\n    const directory = this.getUserDirectory(userId);\n    const indexPath = this.getUserIndexPath(userId);\n\n    await this.ensureDirectory(directory);\n    index.lastUpdated = new Date().toISOString();\n    const data = this.prettyPrint\n      ? JSON.stringify(index, null, 2)\n      : JSON.stringify(index);\n\n    await fs.writeFile(indexPath, data, 'utf-8');\n  }\n\n  private async updateIndex(userId: string | undefined, definition: CustomToolDefinition): Promise<void> {\n    const index = await this.loadIndex(userId);\n    const entry = this.definitionToIndexEntry(definition);\n\n    const existingIdx = index.tools.findIndex(e => e.name === definition.name);\n    if (existingIdx >= 0) {\n      index.tools[existingIdx] = entry;\n    } else {\n      index.tools.push(entry);\n    }\n\n    await this.saveIndex(userId, index);\n  }\n\n  private async removeFromIndex(userId: string | undefined, name: string): Promise<void> {\n    const index = await this.loadIndex(userId);\n    index.tools = index.tools.filter(e => e.name !== name);\n    await this.saveIndex(userId, index);\n  }\n\n  private definitionToIndexEntry(definition: CustomToolDefinition): CustomToolIndexEntry {\n    return {\n      name: definition.name,\n      displayName: definition.displayName,\n      description: definition.description,\n      createdAt: definition.createdAt,\n      updatedAt: definition.updatedAt,\n      tags: definition.metadata?.tags,\n      category: definition.metadata?.category,\n    };\n  }\n}\n\n/**\n * Create a FileCustomToolStorage with default configuration\n */\nexport function createFileCustomToolStorage(\n  config?: FileCustomToolStorageConfig\n): FileCustomToolStorage {\n  return new FileCustomToolStorage(config);\n}\n","/**\n * FileRoutineDefinitionStorage - File-based storage for routine definitions.\n *\n * Stores routines as JSON files on disk with per-user isolation.\n * Path: ~/.oneringai/users/<userId>/routines/<sanitized-id>.json\n *\n * Features:\n * - Per-user isolation (multi-tenant safe)\n * - Cross-platform path handling\n * - Safe ID sanitization\n * - Atomic file operations (write to .tmp then rename)\n * - Per-user index file for fast listing/filtering\n * - Index auto-rebuild if missing\n */\n\nimport { promises as fs } from 'fs';\nimport { join } from 'path';\nimport { homedir } from 'os';\nimport type { IRoutineDefinitionStorage } from '../../domain/interfaces/IRoutineDefinitionStorage.js';\nimport type { RoutineDefinition } from '../../domain/entities/Routine.js';\n\n/**\n * Configuration for FileRoutineDefinitionStorage\n */\nexport interface FileRoutineDefinitionStorageConfig {\n  /** Override the base directory (default: ~/.oneringai/users) */\n  baseDirectory?: string;\n  /** Pretty-print JSON (default: true) */\n  prettyPrint?: boolean;\n}\n\n/**\n * Index entry for fast listing without loading full files\n */\ninterface RoutineIndexEntry {\n  id: string;\n  name: string;\n  description: string;\n  tags?: string[];\n  author?: string;\n  updatedAt: string;\n}\n\n/**\n * Index file structure\n */\ninterface RoutineIndex {\n  version: number;\n  routines: RoutineIndexEntry[];\n  lastUpdated: string;\n}\n\n/**\n * Stored file wrapper\n */\ninterface StoredRoutine {\n  version: number;\n  definition: RoutineDefinition;\n}\n\nconst STORAGE_VERSION = 1;\nconst DEFAULT_USER_ID = 'default';\n\n/**\n * Get the default base directory\n */\nfunction getDefaultBaseDirectory(): string {\n  const platform = process.platform;\n\n  if (platform === 'win32') {\n    const appData = process.env.APPDATA || process.env.LOCALAPPDATA;\n    if (appData) {\n      return join(appData, 'oneringai', 'users');\n    }\n  }\n\n  return join(homedir(), '.oneringai', 'users');\n}\n\n/**\n * Sanitize user ID for use as a directory name\n */\nfunction sanitizeUserId(userId: string | undefined): string {\n  if (!userId) {\n    return DEFAULT_USER_ID;\n  }\n  return userId\n    .replace(/[^a-zA-Z0-9_-]/g, '_')\n    .replace(/_+/g, '_')\n    .replace(/^_|_$/g, '')\n    .toLowerCase()\n    || DEFAULT_USER_ID;\n}\n\n/**\n * Sanitize routine ID for use as a filename\n */\nfunction sanitizeId(id: string): string {\n  return id\n    .replace(/[^a-zA-Z0-9_-]/g, '_')\n    .replace(/_+/g, '_')\n    .replace(/^_|_$/g, '')\n    .toLowerCase()\n    || 'default';\n}\n\n/**\n * File-based storage for routine definitions.\n *\n * Single instance handles all users. UserId is passed to each method.\n */\nexport class FileRoutineDefinitionStorage implements IRoutineDefinitionStorage {\n  private readonly baseDirectory: string;\n  private readonly prettyPrint: boolean;\n\n  constructor(config: FileRoutineDefinitionStorageConfig = {}) {\n    this.baseDirectory = config.baseDirectory ?? getDefaultBaseDirectory();\n    this.prettyPrint = config.prettyPrint ?? true;\n  }\n\n  private getUserDirectory(userId: string | undefined): string {\n    const sanitizedId = sanitizeUserId(userId);\n    return join(this.baseDirectory, sanitizedId, 'routines');\n  }\n\n  private getIndexPath(userId: string | undefined): string {\n    return join(this.getUserDirectory(userId), '_index.json');\n  }\n\n  private getRoutinePath(userId: string | undefined, sanitizedId: string): string {\n    return join(this.getUserDirectory(userId), `${sanitizedId}.json`);\n  }\n\n  async save(userId: string | undefined, definition: RoutineDefinition): Promise<void> {\n    const directory = this.getUserDirectory(userId);\n    const sanitized = sanitizeId(definition.id);\n    const filePath = this.getRoutinePath(userId, sanitized);\n\n    await this.ensureDirectory(directory);\n\n    const stored: StoredRoutine = { version: STORAGE_VERSION, definition };\n    const data = this.prettyPrint\n      ? JSON.stringify(stored, null, 2)\n      : JSON.stringify(stored);\n\n    const tempPath = `${filePath}.tmp`;\n    try {\n      await fs.writeFile(tempPath, data, 'utf-8');\n      await fs.rename(tempPath, filePath);\n    } catch (error) {\n      try {\n        await fs.unlink(tempPath);\n      } catch {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n\n    await this.updateIndex(userId, definition);\n  }\n\n  async load(userId: string | undefined, id: string): Promise<RoutineDefinition | null> {\n    const sanitized = sanitizeId(id);\n    const filePath = this.getRoutinePath(userId, sanitized);\n\n    try {\n      const data = await fs.readFile(filePath, 'utf-8');\n      const stored = JSON.parse(data) as StoredRoutine;\n      return stored.definition;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return null;\n      }\n      if (error instanceof SyntaxError) {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  async delete(userId: string | undefined, id: string): Promise<void> {\n    const sanitized = sanitizeId(id);\n    const filePath = this.getRoutinePath(userId, sanitized);\n\n    try {\n      await fs.unlink(filePath);\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n\n    await this.removeFromIndex(userId, id);\n  }\n\n  async exists(userId: string | undefined, id: string): Promise<boolean> {\n    const sanitized = sanitizeId(id);\n    const filePath = this.getRoutinePath(userId, sanitized);\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  async list(userId: string | undefined, options?: {\n    tags?: string[];\n    search?: string;\n    limit?: number;\n    offset?: number;\n  }): Promise<RoutineDefinition[]> {\n    const index = await this.loadIndex(userId);\n    let entries = [...index.routines];\n\n    // Apply tag filter\n    if (options?.tags && options.tags.length > 0) {\n      entries = entries.filter(e => {\n        const entryTags = e.tags ?? [];\n        return options.tags!.some(t => entryTags.includes(t));\n      });\n    }\n\n    // Apply search filter (case-insensitive substring match on name + description)\n    if (options?.search) {\n      const searchLower = options.search.toLowerCase();\n      entries = entries.filter(e =>\n        e.name.toLowerCase().includes(searchLower) ||\n        e.description.toLowerCase().includes(searchLower)\n      );\n    }\n\n    // Sort by updatedAt descending\n    entries.sort((a, b) =>\n      new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime()\n    );\n\n    // Apply pagination\n    if (options?.offset) {\n      entries = entries.slice(options.offset);\n    }\n    if (options?.limit) {\n      entries = entries.slice(0, options.limit);\n    }\n\n    // Load full definitions for filtered entries\n    const results: RoutineDefinition[] = [];\n    for (const entry of entries) {\n      const def = await this.load(userId, entry.id);\n      if (def) {\n        results.push(def);\n      }\n    }\n\n    return results;\n  }\n\n  getPath(userId: string | undefined): string {\n    return this.getUserDirectory(userId);\n  }\n\n  // ==========================================================================\n  // Private Helpers\n  // ==========================================================================\n\n  private async ensureDirectory(dir: string): Promise<void> {\n    try {\n      await fs.mkdir(dir, { recursive: true });\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code !== 'EEXIST') {\n        throw error;\n      }\n    }\n  }\n\n  private async loadIndex(userId: string | undefined): Promise<RoutineIndex> {\n    const indexPath = this.getIndexPath(userId);\n\n    try {\n      const data = await fs.readFile(indexPath, 'utf-8');\n      return JSON.parse(data) as RoutineIndex;\n    } catch (error: unknown) {\n      if (error instanceof Error && 'code' in error && (error as NodeJS.ErrnoException).code === 'ENOENT') {\n        // Try to rebuild index from existing files\n        return await this.rebuildIndex(userId);\n      }\n      throw error;\n    }\n  }\n\n  private async saveIndex(userId: string | undefined, index: RoutineIndex): Promise<void> {\n    const directory = this.getUserDirectory(userId);\n    const indexPath = this.getIndexPath(userId);\n\n    await this.ensureDirectory(directory);\n    index.lastUpdated = new Date().toISOString();\n    const data = this.prettyPrint\n      ? JSON.stringify(index, null, 2)\n      : JSON.stringify(index);\n\n    await fs.writeFile(indexPath, data, 'utf-8');\n  }\n\n  private async updateIndex(userId: string | undefined, definition: RoutineDefinition): Promise<void> {\n    const index = await this.loadIndex(userId);\n    const entry = this.definitionToIndexEntry(definition);\n\n    const existingIdx = index.routines.findIndex(e => e.id === definition.id);\n    if (existingIdx >= 0) {\n      index.routines[existingIdx] = entry;\n    } else {\n      index.routines.push(entry);\n    }\n\n    await this.saveIndex(userId, index);\n  }\n\n  private async removeFromIndex(userId: string | undefined, id: string): Promise<void> {\n    const index = await this.loadIndex(userId);\n    index.routines = index.routines.filter(e => e.id !== id);\n    await this.saveIndex(userId, index);\n  }\n\n  private definitionToIndexEntry(definition: RoutineDefinition): RoutineIndexEntry {\n    return {\n      id: definition.id,\n      name: definition.name,\n      description: definition.description,\n      tags: definition.tags,\n      author: definition.author,\n      updatedAt: definition.updatedAt,\n    };\n  }\n\n  /**\n   * Rebuild index by scanning directory for .json files (excluding _index.json).\n   * Returns empty index if directory doesn't exist.\n   */\n  private async rebuildIndex(userId: string | undefined): Promise<RoutineIndex> {\n    const directory = this.getUserDirectory(userId);\n    const index: RoutineIndex = {\n      version: 1,\n      routines: [],\n      lastUpdated: new Date().toISOString(),\n    };\n\n    let files: string[];\n    try {\n      files = await fs.readdir(directory);\n    } catch {\n      return index;\n    }\n\n    for (const file of files) {\n      if (!file.endsWith('.json') || file === '_index.json') continue;\n\n      try {\n        const data = await fs.readFile(join(directory, file), 'utf-8');\n        const stored = JSON.parse(data) as StoredRoutine;\n        if (stored.definition) {\n          index.routines.push(this.definitionToIndexEntry(stored.definition));\n        }\n      } catch {\n        // Skip corrupt files\n      }\n    }\n\n    // Persist rebuilt index\n    if (index.routines.length > 0) {\n      await this.saveIndex(userId, index);\n    }\n\n    return index;\n  }\n}\n\n/**\n * Create a FileRoutineDefinitionStorage with default configuration\n */\nexport function createFileRoutineDefinitionStorage(\n  config?: FileRoutineDefinitionStorageConfig\n): FileRoutineDefinitionStorage {\n  return new FileRoutineDefinitionStorage(config);\n}\n","/**\n * CustomToolDefinition - Entity for user-created custom tools\n *\n * Defines the structure for tools created by agents at runtime,\n * persisted to disk, and hydrated back into executable ToolFunctions.\n */\n\n/**\n * Current format version for stored custom tool definitions\n */\nexport const CUSTOM_TOOL_DEFINITION_VERSION = 1;\n\n/**\n * Test case for a custom tool\n */\nexport interface CustomToolTestCase {\n  /** Human-readable label for this test case */\n  label: string;\n  /** Input to pass to the tool */\n  input: unknown;\n  /** Expected output (for validation) */\n  expectedOutput?: unknown;\n  /** Result from last test run */\n  lastResult?: unknown;\n  /** Error from last test run */\n  lastError?: string;\n}\n\n/**\n * Metadata for a custom tool\n */\nexport interface CustomToolMetadata {\n  /** Tags for categorization and search */\n  tags?: string[];\n  /** Category grouping */\n  category?: string;\n  /** Author/creator identifier */\n  author?: string;\n  /** The prompt that was used to generate this tool */\n  generationPrompt?: string;\n  /** Test cases for validation */\n  testCases?: CustomToolTestCase[];\n  /** Whether this tool requires a connector to function */\n  requiresConnector?: boolean;\n  /** Connector names this tool uses */\n  connectorNames?: string[];\n  /** Extensible metadata */\n  [key: string]: unknown;\n}\n\n/**\n * Full custom tool definition - everything needed to hydrate into a ToolFunction\n */\nexport interface CustomToolDefinition {\n  /** Format version for migration support */\n  version: number;\n  /** Unique tool name (must match /^[a-z][a-z0-9_]*$/) */\n  name: string;\n  /** Human-readable display name */\n  displayName?: string;\n  /** Description of what the tool does */\n  description: string;\n  /** JSON Schema for input parameters */\n  inputSchema: Record<string, unknown>;\n  /** JSON Schema for output (documentation only) */\n  outputSchema?: Record<string, unknown>;\n  /** JavaScript code to execute in VM sandbox */\n  code: string;\n  /** When the definition was created */\n  createdAt: string;\n  /** When the definition was last updated */\n  updatedAt: string;\n  /** Optional metadata */\n  metadata?: CustomToolMetadata;\n}\n\n/**\n * Lightweight summary of a custom tool (no code) - used for listing\n */\nexport interface CustomToolSummary {\n  /** Tool name */\n  name: string;\n  /** Human-readable display name */\n  displayName?: string;\n  /** Description */\n  description: string;\n  /** When created */\n  createdAt: string;\n  /** When last updated */\n  updatedAt: string;\n  /** Optional metadata */\n  metadata?: CustomToolMetadata;\n}\n","/**\n * Stream helper utilities for consuming and processing streaming events\n */\n\nimport {\n  StreamEvent,\n  StreamEventType,\n  isOutputTextDelta,\n  isReasoningDelta,\n} from '../../domain/entities/StreamEvent.js';\nimport { StreamState } from '../../domain/entities/StreamState.js';\nimport { LLMResponse, OutputItem } from '../../domain/entities/Response.js';\nimport { MessageRole } from '../../domain/entities/Message.js';\nimport { ContentType } from '../../domain/entities/Content.js';\n\n/**\n * Helper class for consuming and processing streams\n */\nexport class StreamHelpers {\n  /**\n   * Collect complete response from stream\n   * Accumulates all events and reconstructs final LLMResponse\n   */\n  static async collectResponse(\n    stream: AsyncIterableIterator<StreamEvent>\n  ): Promise<LLMResponse> {\n    let state: StreamState | null = null;\n\n    for await (const event of stream) {\n      // Initialize state on first event\n      if (!state && event.type === StreamEventType.RESPONSE_CREATED) {\n        state = new StreamState(event.response_id, event.model, event.created_at);\n      }\n\n      if (!state) continue;\n\n      // Update state from events\n      this.updateStateFromEvent(state, event);\n    }\n\n    if (!state) {\n      throw new Error('No stream events received');\n    }\n\n    return this.reconstructLLMResponse(state);\n  }\n\n  /**\n   * Get only text deltas from stream (for simple text streaming)\n   * Filters out all other event types\n   */\n  static async *textOnly(\n    stream: AsyncIterableIterator<StreamEvent>\n  ): AsyncIterableIterator<string> {\n    for await (const event of stream) {\n      if (isOutputTextDelta(event)) {\n        yield event.delta;\n      }\n    }\n  }\n\n  /**\n   * Filter stream events by type\n   */\n  static async *filterByType<T extends StreamEvent>(\n    stream: AsyncIterableIterator<StreamEvent>,\n    eventType: StreamEventType\n  ): AsyncIterableIterator<T> {\n    for await (const event of stream) {\n      if (event.type === eventType) {\n        yield event as T;\n      }\n    }\n  }\n\n  /**\n   * Accumulate text from stream into a single string\n   */\n  static async accumulateText(\n    stream: AsyncIterableIterator<StreamEvent>\n  ): Promise<string> {\n    const chunks: string[] = [];\n\n    for await (const event of stream) {\n      if (isOutputTextDelta(event)) {\n        chunks.push(event.delta);\n      }\n    }\n\n    return chunks.join('');\n  }\n\n  /**\n   * Get only reasoning/thinking deltas from stream\n   * Filters out all other event types\n   */\n  static async *thinkingOnly(\n    stream: AsyncIterableIterator<StreamEvent>\n  ): AsyncIterableIterator<string> {\n    for await (const event of stream) {\n      if (isReasoningDelta(event)) {\n        yield event.delta;\n      }\n    }\n  }\n\n  /**\n   * Get both text and thinking deltas from stream\n   * Yields tagged objects so consumers can distinguish them\n   */\n  static async *textAndThinking(\n    stream: AsyncIterableIterator<StreamEvent>\n  ): AsyncIterableIterator<{ type: 'text' | 'thinking'; delta: string }> {\n    for await (const event of stream) {\n      if (isOutputTextDelta(event)) {\n        yield { type: 'text', delta: event.delta };\n      } else if (isReasoningDelta(event)) {\n        yield { type: 'thinking', delta: event.delta };\n      }\n    }\n  }\n\n  /**\n   * Accumulate all thinking/reasoning content from stream into a single string\n   */\n  static async accumulateThinking(\n    stream: AsyncIterableIterator<StreamEvent>\n  ): Promise<string> {\n    const chunks: string[] = [];\n\n    for await (const event of stream) {\n      if (isReasoningDelta(event)) {\n        chunks.push(event.delta);\n      }\n    }\n\n    return chunks.join('');\n  }\n\n  /**\n   * Buffer stream events into batches\n   */\n  static async *bufferEvents(\n    stream: AsyncIterableIterator<StreamEvent>,\n    batchSize: number\n  ): AsyncIterableIterator<StreamEvent[]> {\n    let buffer: StreamEvent[] = [];\n\n    for await (const event of stream) {\n      buffer.push(event);\n\n      if (buffer.length >= batchSize) {\n        yield buffer;\n        buffer = [];\n      }\n    }\n\n    // Yield remaining events\n    if (buffer.length > 0) {\n      yield buffer;\n    }\n  }\n\n  /**\n   * Tap into stream without consuming it\n   * Useful for logging or side effects\n   */\n  static async *tap(\n    stream: AsyncIterableIterator<StreamEvent>,\n    callback: (event: StreamEvent) => void | Promise<void>\n  ): AsyncIterableIterator<StreamEvent> {\n    for await (const event of stream) {\n      await callback(event);\n      yield event;\n    }\n  }\n\n  /**\n   * Take first N events from stream\n   */\n  static async *take(\n    stream: AsyncIterableIterator<StreamEvent>,\n    count: number\n  ): AsyncIterableIterator<StreamEvent> {\n    let taken = 0;\n\n    for await (const event of stream) {\n      if (taken >= count) break;\n      yield event;\n      taken++;\n    }\n  }\n\n  /**\n   * Skip first N events from stream\n   */\n  static async *skip(\n    stream: AsyncIterableIterator<StreamEvent>,\n    count: number\n  ): AsyncIterableIterator<StreamEvent> {\n    let skipped = 0;\n\n    for await (const event of stream) {\n      if (skipped < count) {\n        skipped++;\n        continue;\n      }\n      yield event;\n    }\n  }\n\n  /**\n   * Update StreamState from event\n   * @private\n   */\n  private static updateStateFromEvent(state: StreamState, event: StreamEvent): void {\n    switch (event.type) {\n      case StreamEventType.OUTPUT_TEXT_DELTA:\n        state.accumulateTextDelta(event.item_id, event.delta);\n        break;\n\n      case StreamEventType.REASONING_DELTA:\n        state.accumulateReasoningDelta(event.item_id, event.delta);\n        break;\n\n      case StreamEventType.REASONING_DONE:\n        // Reasoning done - no specific state update needed (already accumulated via deltas)\n        break;\n\n      case StreamEventType.TOOL_CALL_START:\n        state.startToolCall(event.tool_call_id, event.tool_name);\n        break;\n\n      case StreamEventType.TOOL_CALL_ARGUMENTS_DELTA:\n        state.accumulateToolArguments(event.tool_call_id, event.delta);\n        break;\n\n      case StreamEventType.TOOL_CALL_ARGUMENTS_DONE:\n        state.completeToolCall(event.tool_call_id);\n        break;\n\n      case StreamEventType.TOOL_EXECUTION_DONE:\n        state.setToolResult(event.tool_call_id, event.result);\n        break;\n\n      case StreamEventType.ITERATION_COMPLETE:\n        state.incrementIteration();\n        break;\n\n      case StreamEventType.RESPONSE_COMPLETE:\n        // Debug: Log usage when received\n        if (process.env.DEBUG_STREAMING) {\n          console.error('[DEBUG] RESPONSE_COMPLETE event:', event.usage);\n        }\n        state.updateUsage(event.usage);\n        state.markComplete(event.status);\n        break;\n    }\n  }\n\n  /**\n   * Reconstruct LLMResponse from StreamState\n   * @private\n   */\n  private static reconstructLLMResponse(state: StreamState): LLMResponse {\n    const output: OutputItem[] = [];\n    const contentParts: any[] = [];\n\n    // Add reasoning/thinking content if accumulated\n    let thinkingText: string | undefined;\n    if (state.hasReasoning()) {\n      const reasoning = state.getAllReasoning();\n      if (reasoning) {\n        thinkingText = reasoning;\n        contentParts.push({\n          type: ContentType.THINKING,\n          thinking: reasoning,\n          persistInHistory: false, // Vendor-agnostic default; caller can adjust\n        });\n      }\n    }\n\n    // Add text content\n    if (state.hasText()) {\n      const textContent = state.getAllText();\n      if (textContent) {\n        contentParts.push({\n          type: ContentType.OUTPUT_TEXT,\n          text: textContent,\n        });\n      }\n    }\n\n    // Build message from accumulated content parts\n    if (contentParts.length > 0) {\n      output.push({\n        type: 'message' as const,\n        role: MessageRole.ASSISTANT,\n        content: contentParts,\n      });\n    }\n\n    // Add tool calls to output\n    const toolCalls = state.getCompletedToolCalls();\n    if (toolCalls.length > 0) {\n      // Tool calls should be part of assistant message content\n      const toolUseContent = toolCalls.map((tc) => ({\n        type: ContentType.TOOL_USE as const,\n        id: tc.id,\n        name: tc.function.name,\n        arguments: tc.function.arguments,\n      }));\n\n      const firstOutput = output[0];\n      if (firstOutput && firstOutput.type === 'message') {\n        // Append to existing message\n        firstOutput.content.push(...toolUseContent);\n      } else {\n        // Create new message with tool calls\n        output.push({\n          type: 'message' as const,\n          role: MessageRole.ASSISTANT,\n          content: toolUseContent,\n        });\n      }\n    }\n\n    // Extract output text\n    const outputText = this.extractOutputText(output);\n\n    return {\n      id: state.responseId,\n      object: 'response',\n      created_at: state.createdAt,\n      status: state.status,\n      model: state.model,\n      output,\n      output_text: outputText,\n      thinking: thinkingText,\n      usage: state.usage,\n    };\n  }\n\n  /**\n   * Extract text from output items\n   * @private\n   */\n  private static extractOutputText(output: OutputItem[]): string {\n    const texts: string[] = [];\n\n    for (const item of output) {\n      if (item.type === 'message') {\n        for (const content of item.content) {\n          if (content.type === ContentType.OUTPUT_TEXT) {\n            texts.push(content.text);\n          }\n        }\n      }\n    }\n\n    return texts.join(' ').trim();\n  }\n}\n","/**\n * Unified error mapper for all providers\n * Converts provider-specific errors to our standard error types\n */\n\nimport {\n  AIError,\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderContextLengthError,\n  ProviderError,\n} from '../../../domain/errors/AIErrors.js';\nimport { resolveMaxContextTokens } from './ModelCapabilityResolver.js';\n\nexport interface ProviderErrorContext {\n  providerName: string;\n  maxContextTokens?: number;\n  model?: string;\n}\n\n/**\n * Maps provider-specific errors to our unified error types\n */\nexport class ProviderErrorMapper {\n  /**\n   * Map any provider error to our standard error types\n   */\n  static mapError(error: any, context: ProviderErrorContext): AIError {\n    const { providerName, maxContextTokens, model } = context;\n    const effectiveMaxTokens = model\n      ? resolveMaxContextTokens(model, maxContextTokens ?? 128000)\n      : (maxContextTokens ?? 128000);\n\n    // Already our error type - return as-is\n    if (error instanceof AIError) {\n      return error;\n    }\n\n    // Extract error details\n    const status = error.status || error.statusCode || error.code;\n    const message = error.message || String(error);\n    const messageLower = message.toLowerCase();\n\n    // Auth errors (401, 403, or message indicators)\n    if (\n      status === 401 ||\n      status === 403 ||\n      messageLower.includes('api key') ||\n      messageLower.includes('api_key') ||\n      messageLower.includes('authentication') ||\n      messageLower.includes('unauthorized') ||\n      messageLower.includes('invalid key') ||\n      messageLower.includes('permission denied')\n    ) {\n      return new ProviderAuthError(providerName, message);\n    }\n\n    // Rate limit errors (429 or message indicators)\n    if (\n      status === 429 ||\n      messageLower.includes('rate limit') ||\n      messageLower.includes('rate_limit') ||\n      messageLower.includes('too many requests') ||\n      messageLower.includes('resource exhausted') ||\n      messageLower.includes('quota exceeded')\n    ) {\n      const retryAfter = this.extractRetryAfter(error);\n      return new ProviderRateLimitError(providerName, retryAfter);\n    }\n\n    // Context length errors (413 or message indicators)\n    if (\n      status === 413 ||\n      error.code === 'context_length_exceeded' ||\n      messageLower.includes('context length') ||\n      messageLower.includes('context_length') ||\n      messageLower.includes('token limit') ||\n      messageLower.includes('too long') ||\n      messageLower.includes('maximum context') ||\n      messageLower.includes('max_tokens') ||\n      messageLower.includes('prompt is too long')\n    ) {\n      return new ProviderContextLengthError(providerName, effectiveMaxTokens);\n    }\n\n    // Generic provider error for everything else\n    return new ProviderError(providerName, message, status, error);\n  }\n\n  /**\n   * Extract retry-after value from error headers or body\n   */\n  private static extractRetryAfter(error: any): number | undefined {\n    // Check headers (common for HTTP responses)\n    const retryAfterHeader =\n      error.headers?.['retry-after'] ||\n      error.headers?.['Retry-After'] ||\n      error.headers?.get?.('retry-after');\n\n    if (retryAfterHeader) {\n      const seconds = parseInt(retryAfterHeader, 10);\n      if (!isNaN(seconds)) {\n        return seconds * 1000; // Convert to milliseconds\n      }\n    }\n\n    // Check error body for retry info\n    if (error.retryAfter) {\n      return typeof error.retryAfter === 'number'\n        ? error.retryAfter\n        : parseInt(error.retryAfter, 10) * 1000;\n    }\n\n    // Check for Google-style error details\n    if (error.errorDetails) {\n      for (const detail of error.errorDetails) {\n        if (detail.retryDelay) {\n          // Parse duration string like \"60s\"\n          const match = detail.retryDelay.match(/(\\d+)s/);\n          if (match) {\n            return parseInt(match[1], 10) * 1000;\n          }\n        }\n      }\n    }\n\n    return undefined;\n  }\n}\n","/**\n * @everworker/oneringai - Unified AI agent library\n *\n * Connector-First Architecture: Simple, DRY, Powerful\n *\n * @example\n * ```typescript\n * import { Connector, Agent, Vendor } from '@everworker/oneringai';\n *\n * // Create connector (can have multiple per vendor!)\n * Connector.create({\n *   name: 'openai-main',\n *   vendor: Vendor.OpenAI,\n *   auth: { type: 'api_key', apiKey: process.env.OPENAI_API_KEY! }\n * });\n *\n * // Create agent from connector\n * const agent = Agent.create({\n *   connector: 'openai-main',\n *   model: 'gpt-4',\n *   tools: [myTool]\n * });\n *\n * // Run the agent\n * const response = await agent.run('Hello!');\n * ```\n */\n\n// ============ Core API (Primary) ============\nexport { Connector, ScopedConnectorRegistry, StorageRegistry, ToolCatalogRegistry, Agent, Vendor, VENDORS, isVendor, createProvider, getVendorDefaultBaseURL } from './core/index.js';\nexport type { StorageConfig, StorageContext, ToolCategoryDefinition, CatalogToolEntry, ToolCategoryScope } from './core/index.js';\nexport type { AgentConfig, AgentSessionConfig } from './core/index.js';\n\n// AgentContextNextGen - Clean, Simple Context Management\nexport {\n  AgentContextNextGen,\n  DEFAULT_FEATURES,\n  DEFAULT_CONFIG,\n  BasePluginNextGen,\n  simpleTokenEstimator,\n  WorkingMemoryPluginNextGen,\n  InContextMemoryPluginNextGen,\n  PersistentInstructionsPluginNextGen,\n  UserInfoPluginNextGen,\n  ToolCatalogPluginNextGen,\n  // Compaction strategies\n  DefaultCompactionStrategy,\n  // Strategy Registry\n  StrategyRegistry,\n} from './core/index.js';\nexport type {\n  AuthIdentity,\n  AgentContextNextGenConfig,\n  ContextFeatures,\n  ContextEvents,\n  SerializedContextState,\n  DirectCallOptions,\n  IContextPluginNextGen,\n  ITokenEstimator,\n  ContextBudget,\n  PreparedContext,\n  OversizedInputResult,\n  PluginConfigs,\n  // IContextStorage exported from domain/interfaces below\n  WorkingMemoryPluginConfig,\n  SerializedWorkingMemoryState,\n  EvictionStrategy as NextGenEvictionStrategy,\n  InContextMemoryConfig,\n  InContextEntry,\n  InContextPriority,\n  SerializedInContextMemoryState,\n  PersistentInstructionsConfig,\n  SerializedPersistentInstructionsState,\n  InstructionEntry,\n  UserInfoPluginConfig,\n  SerializedUserInfoState,\n  ToolCatalogPluginConfig,\n  // Compaction strategy types\n  ICompactionStrategy,\n  CompactionContext,\n  CompactionResult,\n  ConsolidationResult,\n  DefaultCompactionStrategyConfig,\n  // Strategy Registry types\n  StrategyInfo,\n  StrategyRegistryEntry,\n  // Snapshot types (for \"Look Inside\" UIs)\n  IContextSnapshot,\n  IPluginSnapshot,\n  IToolSnapshot,\n  IViewContextData,\n  IViewContextComponent,\n} from './core/index.js';\nexport { formatPluginDisplayName } from './core/index.js';\n\n// Audio Capabilities\nexport { TextToSpeech, SpeechToText } from './core/index.js';\nexport type { TextToSpeechConfig, SpeechToTextConfig } from './core/index.js';\n\n// Image Capabilities\nexport { ImageGeneration } from './capabilities/images/index.js';\nexport type { ImageGenerationCreateOptions, SimpleGenerateOptions } from './capabilities/images/index.js';\nexport { createImageProvider } from './core/index.js';\n\n// Video Capabilities\nexport { VideoGeneration } from './capabilities/video/index.js';\nexport type {\n  VideoGenerationCreateOptions,\n  SimpleVideoGenerateOptions,\n} from './capabilities/video/index.js';\nexport { createVideoProvider } from './core/createVideoProvider.js';\n\n// Search Capabilities (NEW - Connector-based web search)\nexport { SearchProvider } from './capabilities/search/index.js';\nexport type {\n  ISearchProvider,\n  SearchResult,\n  SearchOptions,\n  SearchResponse,\n  SearchProviderConfig,\n} from './capabilities/search/index.js';\nexport { SerperProvider, BraveProvider, TavilyProvider, RapidAPIProvider } from './capabilities/search/index.js';\n\n// Scrape Capabilities (Connector-based web scraping)\nexport { ScrapeProvider, registerScrapeProvider, getRegisteredScrapeProviders } from './capabilities/scrape/index.js';\nexport type {\n  IScrapeProvider,\n  ScrapeResult,\n  ScrapeOptions,\n  ScrapeResponse,\n  ScrapeFeature,\n  ScrapeProviderConfig,\n  ScrapeProviderFallbackConfig,\n} from './capabilities/scrape/index.js';\n\n// Document Reader Capability\nexport { DocumentReader, FormatDetector, mergeTextPieces } from './capabilities/documents/index.js';\nexport type {\n  DocumentFormat,\n  DocumentFamily,\n  DocumentPiece,\n  DocumentTextPiece,\n  DocumentImagePiece,\n  PieceMetadata,\n  DocumentResult,\n  DocumentMetadata,\n  DocumentSource,\n  DocumentReadOptions,\n  DocumentReaderConfig,\n  ImageFilterOptions,\n  IDocumentTransformer,\n  IFormatHandler,\n  FormatDetectionResult,\n  DocumentToContentOptions,\n} from './capabilities/documents/index.js';\nexport { documentToContent, readDocumentAsContent } from './utils/documentContentBridge.js';\n\n// Shared Capability Utilities\nexport {\n  buildQueryString,\n  toConnectorOptions,\n  buildEndpointWithQuery,\n  resolveConnector,\n  // Service type auto-detection (for external API-dependent tools)\n  findConnectorByServiceTypes,\n  listConnectorsByServiceTypes,\n  type BaseProviderConfig,\n  type BaseProviderResponse,\n  type ICapabilityProvider,\n  type ExtendedFetchOptions,\n} from './capabilities/shared/index.js';\n\n// Tool Management (Unified - handles registration, execution, and circuit breakers)\nexport { ToolManager } from './core/index.js';\nexport type {\n  ToolOptions,\n  ToolCondition,\n  ToolSelectionContext,\n  ToolRegistration,\n  ToolMetadata,\n  ToolManagerStats,\n  ToolManagerConfig,\n  SerializedToolState,\n  ToolManagerEvent,\n  ToolSource,\n} from './core/index.js';\n// Note: CircuitBreakerConfig, CircuitState are exported from infrastructure/resilience\n\n// Tool Execution Plugin System\nexport {\n  ToolExecutionPipeline,\n  LoggingPlugin,\n} from './core/index.js';\nexport type {\n  PluginExecutionContext,\n  BeforeExecuteResult,\n  IToolExecutionPlugin,\n  IToolExecutionPipeline,\n  ToolExecutionPipelineOptions,\n  LoggingPluginOptions,\n} from './core/index.js';\n\n// Tool Permissions (NEW)\nexport { ToolPermissionManager } from './core/permissions/index.js';\nexport type {\n  PermissionScope,\n  RiskLevel,\n  ToolPermissionConfig,\n  ApprovalCacheEntry,\n  SerializedApprovalState,\n  SerializedApprovalEntry,\n  PermissionCheckResult,\n  ApprovalDecision,\n  AgentPermissionsConfig,\n  PermissionCheckContext,\n  PermissionManagerEvent,\n} from './core/permissions/index.js';\nexport { APPROVAL_STATE_VERSION, DEFAULT_PERMISSION_CONFIG, DEFAULT_ALLOWLIST } from './core/permissions/index.js';\nexport type { DefaultAllowlistedTool } from './core/permissions/index.js';\n\n// Context Storage (Session Persistence via AgentContext)\nexport type {\n  IContextStorage,\n  StoredContextSession,\n  ContextSessionSummary,\n  ContextSessionMetadata,\n  ContextStorageListOptions,\n} from './domain/interfaces/IContextStorage.js';\nexport { CONTEXT_SESSION_FORMAT_VERSION } from './domain/interfaces/IContextStorage.js';\n\n// Agent Definition Storage (Agent Configuration Persistence)\nexport type {\n  IAgentDefinitionStorage,\n  StoredAgentDefinition,\n  StoredAgentType,\n  AgentDefinitionMetadata,\n  AgentDefinitionSummary,\n  AgentDefinitionListOptions,\n} from './domain/interfaces/IAgentDefinitionStorage.js';\nexport { AGENT_DEFINITION_FORMAT_VERSION } from './domain/interfaces/IAgentDefinitionStorage.js';\n\n// Media Storage (Multimedia Tool Outputs)\nexport type {\n  IMediaStorage,\n  MediaStorageMetadata,\n  MediaStorageResult,\n  MediaStorageEntry,\n  MediaStorageListOptions,\n} from './domain/interfaces/IMediaStorage.js';\n\n// ============ Error Handling ============\nexport { ErrorHandler, globalErrorHandler } from './core/index.js';\nexport type {\n  ErrorContext,\n  ErrorHandlerConfig,\n  ErrorHandlerEvents,\n} from './core/index.js';\n\n// ============ TaskAgent Utilities (TaskAgent class removed) ============\nexport {\n  WorkingMemory,\n  ExternalDependencyHandler,\n  CheckpointManager,\n  PlanningAgent,\n  generateSimplePlan,\n  DEFAULT_CHECKPOINT_STRATEGY,\n} from './capabilities/taskAgent/index.js';\nexport type {\n  WorkingMemoryEvents,\n  EvictionStrategy,\n  ExternalDependencyEvents,\n  CheckpointStrategy,\n  PlanningAgentConfig,\n  GeneratedPlan,\n} from './capabilities/taskAgent/index.js';\n\n// ============ Research Types (ResearchAgent class removed) ============\nexport type {\n  IResearchSource,\n  SourceResult,\n  SearchResponse as ResearchSearchResponse,\n  FetchedContent,\n  SearchOptions as ResearchSearchOptions,\n  FetchOptions as ResearchFetchOptions,\n  SourceCapabilities,\n  ResearchFinding,\n  ResearchPlan,\n  ResearchQuery,\n  ResearchResult,\n  ResearchProgress,\n} from './capabilities/researchAgent/index.js';\n\n// ============ Context Management (Legacy types for strategy compatibility) ============\n// Note: ContextManager class deleted - AgentContext is THE ONLY context manager\n// ContextBudget, PreparedContext, ITokenEstimator exported above from NextGen\nexport type {\n  IContextComponent,\n  ContextManagerConfig,\n  IContextCompactor,\n  IContextStrategy,\n  TokenContentType,\n} from './core/context/types.js';\nexport { DEFAULT_CONTEXT_CONFIG } from './core/context/types.js';\n\n// Context Infrastructure\nexport {\n  TruncateCompactor,\n  SummarizeCompactor,\n  MemoryEvictionCompactor,\n  ApproximateTokenEstimator,\n  createEstimator,\n} from './infrastructure/context/index.js';\n\n// ============ Conversation History Management ============\n// Note: ConversationHistoryManager class deleted - AgentContext manages history directly\nexport type {\n  IHistoryManager,\n  IHistoryStorage,\n  HistoryMessage,\n  IHistoryManagerConfig,\n  HistoryManagerEvents,\n  SerializedHistoryState,\n} from './core/history/index.js';\nexport { DEFAULT_HISTORY_MANAGER_CONFIG } from './core/history/index.js';\nexport { InMemoryHistoryStorage } from './infrastructure/storage/InMemoryHistoryStorage.js';\n\n// Task & Plan Entities\nexport type {\n  Task,\n  TaskInput,\n  TaskStatus,\n  TaskCondition,\n  TaskExecution,\n  TaskValidation,\n  TaskValidationResult,\n  ExternalDependency,\n  Plan,\n  PlanInput,\n  PlanStatus,\n  PlanConcurrency,\n  TaskControlFlow,\n  TaskMapFlow,\n  TaskFoldFlow,\n  TaskUntilFlow,\n  TaskSourceRef,\n  ControlFlowSource,\n  SubRoutineSpec,\n} from './domain/entities/Task.js';\n\n// Task & Plan Utilities\nexport {\n  createTask,\n  createPlan,\n  detectDependencyCycle,\n  canTaskExecute,\n  getNextExecutableTasks,\n  evaluateCondition,\n  updateTaskStatus,\n  isTaskBlocked,\n  getTaskDependencies,\n  resolveDependencies,\n  isTerminalStatus,\n  TERMINAL_TASK_STATUSES,\n} from './domain/entities/Task.js';\n\n// Routine Entities\nexport type {\n  RoutineDefinition,\n  RoutineDefinitionInput,\n  RoutineExecutionStatus,\n  RoutineExecution,\n  RoutineParameter,\n} from './domain/entities/Routine.js';\n\nexport {\n  createRoutineDefinition,\n  createRoutineExecution,\n  getRoutineProgress,\n} from './domain/entities/Routine.js';\n\n// Routine Execution Records (persisted history)\nexport type {\n  RoutineStepType,\n  RoutineExecutionStep,\n  RoutineTaskResult,\n  RoutineTaskSnapshot,\n  RoutineExecutionRecord,\n} from './domain/entities/RoutineExecutionRecord.js';\n\nexport {\n  createRoutineExecutionRecord,\n  createTaskSnapshots,\n} from './domain/entities/RoutineExecutionRecord.js';\n\n// Routine Runner\nexport { executeRoutine } from './core/routineRunner.js';\nexport type { ExecuteRoutineOptions, ValidationContext } from './core/routineRunner.js';\n\n// Execution Recorder\nexport { createExecutionRecorder } from './core/createExecutionRecorder.js';\nexport type { ExecutionRecorderOptions, ExecutionRecorder } from './core/createExecutionRecorder.js';\n\n// Routine Control Flow\nexport { resolveTemplates, ROUTINE_KEYS, resolveFlowSource } from './core/routineControlFlow.js';\nexport type { ControlFlowResult } from './core/routineControlFlow.js';\n\n// Memory Entities\nexport type {\n  MemoryEntry,\n  MemoryEntryInput,\n  MemoryIndex,\n  MemoryIndexEntry,\n  MemoryScope,\n  MemoryPriority,\n  TaskAwareScope,\n  SimpleScope,\n  TaskStatusForMemory,\n  WorkingMemoryConfig,\n} from './domain/entities/Memory.js';\nexport {\n  DEFAULT_MEMORY_CONFIG,\n  forTasks,\n  forPlan,\n  scopeEquals,\n  scopeMatches,\n  isSimpleScope,\n  isTaskAwareScope,\n  isTerminalMemoryStatus,\n  calculateEntrySize,\n  MEMORY_PRIORITY_VALUES,\n} from './domain/entities/Memory.js';\n\n// Agent State\nexport type {\n  AgentState,\n  AgentStatus,\n  AgentConfig as TaskAgentStateConfig,\n  ConversationMessage,\n  AgentMetrics,\n} from './domain/entities/AgentState.js';\n\n// Storage Interfaces\nexport type { IMemoryStorage } from './domain/interfaces/IMemoryStorage.js';\nexport type { IPlanStorage } from './domain/interfaces/IPlanStorage.js';\nexport type { IAgentStateStorage } from './domain/interfaces/IAgentStateStorage.js';\nexport { createAgentStorage } from './infrastructure/storage/index.js';\nexport type { IAgentStorage } from './infrastructure/storage/InMemoryStorage.js';\nexport { InMemoryStorage, InMemoryPlanStorage, InMemoryAgentStateStorage } from './infrastructure/storage/index.js';\n\n// Context Storage Implementations (for AgentContext session persistence)\nexport { FileContextStorage, createFileContextStorage } from './infrastructure/storage/index.js';\nexport type { FileContextStorageConfig } from './infrastructure/storage/index.js';\n\n// Agent Definition Storage Implementations (for agent configuration persistence)\nexport { FileAgentDefinitionStorage, createFileAgentDefinitionStorage } from './infrastructure/storage/index.js';\nexport type { FileAgentDefinitionStorageConfig } from './infrastructure/storage/index.js';\n\n// Custom Tool Storage\nexport type {\n  ICustomToolStorage,\n  CustomToolListOptions,\n} from './domain/interfaces/ICustomToolStorage.js';\nexport { CUSTOM_TOOL_DEFINITION_VERSION } from './domain/entities/CustomToolDefinition.js';\nexport type {\n  CustomToolDefinition,\n  CustomToolSummary,\n  CustomToolTestCase,\n  CustomToolMetadata,\n} from './domain/entities/CustomToolDefinition.js';\nexport { FileCustomToolStorage, createFileCustomToolStorage } from './infrastructure/storage/index.js';\nexport type { FileCustomToolStorageConfig } from './infrastructure/storage/index.js';\n\n// Tool Context (ToolContext is the canonical interface for tool execution context)\nexport type { ToolContext, ToolContext as TaskToolContext, WorkingMemoryAccess } from './domain/interfaces/IToolContext.js';\n\n// ============ Domain Types ============\n\n// Content\nexport { ContentType } from './domain/entities/Content.js';\nexport type {\n  Content,\n  InputTextContent,\n  InputImageContent,\n  OutputTextContent,\n  ToolUseContent,\n  ToolResultContent,\n  ThinkingContent,\n} from './domain/entities/Content.js';\n\n// Messages\nexport { MessageRole } from './domain/entities/Message.js';\nexport type {\n  Message,\n  InputItem,\n  OutputItem,\n  CompactionItem,\n  ReasoningItem,\n} from './domain/entities/Message.js';\n\n// Tools\nexport {\n  ToolCallState,\n  defaultDescribeCall,\n  getToolCallDescription,\n} from './domain/entities/Tool.js';\nexport type {\n  Tool,\n  FunctionToolDefinition,\n  BuiltInTool,\n  ToolFunction,\n  ToolCall,\n  ToolResult,\n  ToolExecutionContext,\n  JSONSchema,\n} from './domain/entities/Tool.js';\n\n// Response\nexport type { LLMResponse, AgentResponse } from './domain/entities/Response.js';\n\n// Connector types\nexport type {\n  ConnectorConfig,\n  ConnectorAuth,\n  OAuthConnectorAuth,\n  APIKeyConnectorAuth,\n  JWTConnectorAuth,\n} from './domain/entities/Connector.js';\n\n// Model Registry\nexport type { ILLMDescription } from './domain/entities/Model.js';\nexport {\n  LLM_MODELS,\n  MODEL_REGISTRY,\n  getModelInfo,\n  getModelsByVendor,\n  getActiveModels,\n  calculateCost,\n} from './domain/entities/Model.js';\n\n// Audio Model Registries\nexport type { ITTSModelDescription, TTSModelCapabilities } from './domain/entities/TTSModel.js';\nexport type { ISTTModelDescription, STTModelCapabilities } from './domain/entities/STTModel.js';\nexport type { IVoiceInfo } from './domain/entities/SharedVoices.js';\nexport {\n  TTS_MODELS,\n  TTS_MODEL_REGISTRY,\n  getTTSModelInfo,\n  getTTSModelsByVendor,\n  getActiveTTSModels,\n  getTTSModelsWithFeature,\n  calculateTTSCost,\n} from './domain/entities/TTSModel.js';\nexport {\n  STT_MODELS,\n  STT_MODEL_REGISTRY,\n  getSTTModelInfo,\n  getSTTModelsByVendor,\n  getActiveSTTModels,\n  getSTTModelsWithFeature,\n  calculateSTTCost,\n} from './domain/entities/STTModel.js';\n\n// Image Model Registry\nexport type { IImageModelDescription, ImageModelCapabilities, ImageModelPricing } from './domain/entities/ImageModel.js';\nexport {\n  IMAGE_MODELS,\n  IMAGE_MODEL_REGISTRY,\n  getImageModelInfo,\n  getImageModelsByVendor,\n  getActiveImageModels,\n  getImageModelsWithFeature,\n  calculateImageCost,\n} from './domain/entities/ImageModel.js';\n\n// Video Model Registry\nexport type { IVideoModelDescription, VideoModelCapabilities, VideoModelPricing } from './domain/entities/VideoModel.js';\nexport {\n  VIDEO_MODELS,\n  VIDEO_MODEL_REGISTRY,\n  getVideoModelInfo,\n  getVideoModelsByVendor,\n  getActiveVideoModels,\n  getVideoModelsWithFeature,\n  getVideoModelsWithAudio,\n  calculateVideoCost,\n} from './domain/entities/VideoModel.js';\n\n// ============ Streaming ============\nexport { StreamEventType } from './domain/entities/StreamEvent.js';\nexport type {\n  StreamEvent,\n  ResponseCreatedEvent,\n  ResponseInProgressEvent,\n  OutputTextDeltaEvent,\n  OutputTextDoneEvent,\n  ReasoningDeltaEvent,\n  ReasoningDoneEvent,\n  ToolCallStartEvent,\n  ToolCallArgumentsDeltaEvent,\n  ToolCallArgumentsDoneEvent,\n  ToolExecutionStartEvent,\n  ToolExecutionDoneEvent,\n  IterationCompleteEvent,\n  ResponseCompleteEvent,\n  ErrorEvent,\n} from './domain/entities/StreamEvent.js';\nexport {\n  isStreamEvent,\n  isOutputTextDelta,\n  isReasoningDelta,\n  isReasoningDone,\n  isToolCallStart,\n  isToolCallArgumentsDelta,\n  isToolCallArgumentsDone,\n  isResponseComplete,\n  isErrorEvent,\n} from './domain/entities/StreamEvent.js';\nexport { StreamState } from './domain/entities/StreamState.js';\nexport { StreamHelpers } from './capabilities/agents/StreamHelpers.js';\n\n// ============ Hooks & Events (Enterprise) ============\nexport { ExecutionContext, HookManager } from './capabilities/agents/index.js';\nexport type {\n  // New canonical names\n  AgentEvents,\n  AgentEventName,\n  ExecutionConfig,\n  // Legacy names for backward compatibility\n  AgenticLoopEvents,\n  AgenticLoopEventName,\n  // Hook types\n  HookConfig,\n  HookName,\n  Hook,\n  ModifyingHook,\n  BeforeToolContext,\n  AfterToolContext,\n  ApproveToolContext,\n  ToolModification,\n  ApprovalResult,\n  HistoryMode,\n  ExecutionMetrics,\n  AuditEntry,\n} from './capabilities/agents/index.js';\n\n// ============ Errors ============\nexport {\n  AIError,\n  ProviderNotFoundError,\n  ProviderAuthError,\n  ProviderRateLimitError,\n  ProviderContextLengthError,\n  ToolExecutionError,\n  ToolTimeoutError,\n  ToolNotFoundError,\n  ModelNotSupportedError,\n  InvalidConfigError,\n  InvalidToolArgumentsError,\n  ProviderError,\n  // TaskAgent errors\n  DependencyCycleError,\n  TaskTimeoutError,\n  TaskValidationError,\n  ParallelTasksError,\n  // Context management errors\n  ContextOverflowError,\n} from './domain/errors/AIErrors.js';\nexport type { TaskFailure, ContextOverflowBudget } from './domain/errors/AIErrors.js';\n\n// ============ Interfaces (for extensibility) ============\nexport type { IProvider, ProviderCapabilities } from './domain/interfaces/IProvider.js';\nexport type { ITextProvider, TextGenerateOptions, ModelCapabilities } from './domain/interfaces/ITextProvider.js';\nexport type { IToolExecutor } from './domain/interfaces/IToolExecutor.js';\nexport type { IDisposable, IAsyncDisposable } from './domain/interfaces/IDisposable.js';\nexport { assertNotDestroyed } from './domain/interfaces/IDisposable.js';\n\n// Connector Registry & Access Control\nexport type { IConnectorRegistry } from './domain/interfaces/IConnectorRegistry.js';\nexport type { IConnectorAccessPolicy, ConnectorAccessContext } from './domain/interfaces/IConnectorAccessPolicy.js';\n\n// Audio Interfaces\nexport type {\n  ITextToSpeechProvider,\n  ISpeechToTextProvider,\n  TTSOptions,\n  TTSResponse,\n  STTOptions,\n  STTResponse,\n  STTOutputFormat,\n  WordTimestamp,\n  SegmentTimestamp,\n} from './domain/interfaces/IAudioProvider.js';\n\n// Image Interfaces\nexport type {\n  IImageProvider,\n  ImageGenerateOptions,\n  ImageEditOptions,\n  ImageVariationOptions,\n  ImageResponse,\n} from './domain/interfaces/IImageProvider.js';\n\n// Video Interfaces\nexport type {\n  IVideoProvider,\n  VideoGenerateOptions,\n  VideoExtendOptions,\n  VideoResponse,\n  VideoJob,\n  VideoStatus,\n} from './domain/interfaces/IVideoProvider.js';\n\n// Base classes for custom providers\nexport { BaseProvider } from './infrastructure/providers/base/BaseProvider.js';\nexport { BaseTextProvider } from './infrastructure/providers/base/BaseTextProvider.js';\nexport { BaseMediaProvider } from './infrastructure/providers/base/BaseMediaProvider.js';\nexport { ProviderErrorMapper } from './infrastructure/providers/base/ProviderErrorMapper.js';\nexport { resolveModelCapabilities, resolveMaxContextTokens } from './infrastructure/providers/base/ModelCapabilityResolver.js';\n\n// Shared types for multi-modal\nexport type {\n  AspectRatio,\n  QualityLevel,\n  AudioFormat,\n  OutputFormat,\n  ISourceLinks,\n  VendorOptionSchema,\n  IBaseModelDescription,\n} from './domain/types/SharedTypes.js';\n\n// ============ External Services & Connector Tools ============\n// Services constants for well-known external services\nexport {\n  Services,\n  SERVICE_DEFINITIONS,\n  SERVICE_URL_PATTERNS,\n  SERVICE_INFO,\n  detectServiceFromURL,\n  getServiceInfo,\n  getServiceDefinition,\n  getServicesByCategory,\n  getAllServiceIds,\n  isKnownService,\n} from './domain/entities/Services.js';\nexport type { ServiceType, ServiceInfo, ServiceDefinition, ServiceCategory } from './domain/entities/Services.js';\n\n// Connector resilience defaults\nexport {\n  DEFAULT_CONNECTOR_TIMEOUT,\n  DEFAULT_MAX_RETRIES,\n  DEFAULT_RETRYABLE_STATUSES,\n  DEFAULT_BASE_DELAY_MS,\n  DEFAULT_MAX_DELAY_MS,\n} from './core/Connector.js';\nexport type { ConnectorFetchOptions } from './core/Connector.js';\n\n// ConnectorTools framework for vendor-dependent tools\nexport {\n  ConnectorTools,\n} from './tools/connector/index.js';\nexport type {\n  ServiceToolFactory,\n  GenericAPIToolOptions,\n  GenericAPICallArgs,\n  GenericAPICallResult,\n  ConnectorToolsOptions,\n} from './tools/connector/index.js';\n\n// ============ OAuth & Storage (for external APIs) ============\nexport { OAuthManager, MemoryStorage, FileStorage } from './connectors/index.js';\nexport { generateEncryptionKey, authenticatedFetch, createAuthenticatedFetch, generateWebAPITool } from './connectors/index.js';\nexport type { OAuthConfig, OAuthFlow, ITokenStorage, FileStorageConfig, StoredToken } from './connectors/index.js';\n\n// ConnectorConfig storage (persistent connector configs with encryption)\nexport {\n  ConnectorConfigStore,\n  MemoryConnectorStorage,\n  FileConnectorStorage,\n  CONNECTOR_CONFIG_VERSION,\n} from './connectors/index.js';\nexport type {\n  IConnectorConfigStorage,\n  StoredConnectorConfig,\n  FileConnectorStorageConfig,\n} from './connectors/index.js';\n\n// ============ Vendor Templates (Pre-configured auth for 40+ services) ============\nexport {\n  // Helpers\n  createConnectorFromTemplate,\n  getConnectorTools,\n  getVendorTemplate,\n  getVendorAuthTemplate,\n  getAllVendorTemplates,\n  listVendorIds,\n  listVendors,\n  listVendorsByCategory,\n  listVendorsByAuthType,\n  getVendorInfo,\n  getCredentialsSetupURL,\n  getDocsURL,\n  buildAuthConfig,\n  // All templates array\n  allVendorTemplates,\n  // Logo utilities\n  getVendorLogo,\n  getVendorLogoSvg,\n  getVendorColor,\n  getVendorLogoCdnUrl,\n  hasVendorLogo,\n  getAllVendorLogos,\n  listVendorsWithLogos,\n  VENDOR_ICON_MAP,\n  SIMPLE_ICONS_CDN,\n} from './connectors/index.js';\n\nexport type {\n  VendorTemplate,\n  AuthTemplate,\n  AuthTemplateField,\n  VendorRegistryEntry,\n  TemplateCredentials,\n  CreateConnectorOptions,\n  VendorInfo,\n  VendorLogo,\n  SimpleIcon,\n} from './connectors/index.js';\n\n// ============ Resilience & Observability (Phase 3) ============\nexport { CircuitBreaker, CircuitOpenError } from './infrastructure/resilience/index.js';\nexport type {\n  CircuitState,\n  CircuitBreakerConfig,\n  CircuitBreakerMetrics,\n  CircuitBreakerEvents,\n} from './infrastructure/resilience/index.js';\nexport { DEFAULT_CIRCUIT_BREAKER_CONFIG } from './infrastructure/resilience/index.js';\n\nexport {\n  calculateBackoff,\n  addJitter,\n  backoffWait,\n  backoffSequence,\n  retryWithBackoff,\n} from './infrastructure/resilience/index.js';\nexport type { BackoffConfig, BackoffStrategyType } from './infrastructure/resilience/index.js';\nexport { DEFAULT_BACKOFF_CONFIG } from './infrastructure/resilience/index.js';\n\nexport { TokenBucketRateLimiter, RateLimitError } from './infrastructure/resilience/index.js';\nexport type { RateLimiterConfig, RateLimiterMetrics } from './infrastructure/resilience/index.js';\nexport { DEFAULT_RATE_LIMITER_CONFIG } from './infrastructure/resilience/index.js';\n\nexport { FrameworkLogger, logger } from './infrastructure/observability/index.js';\nexport type { LogLevel, LoggerConfig, LogEntry } from './infrastructure/observability/index.js';\n\nexport {\n  NoOpMetrics,\n  ConsoleMetrics,\n  InMemoryMetrics,\n  createMetricsCollector,\n  metrics,\n  setMetricsCollector,\n} from './infrastructure/observability/index.js';\nexport type { MetricsCollector, MetricTags, MetricsCollectorType } from './infrastructure/observability/index.js';\n\n// ============ Utilities ============\nexport { MessageBuilder, createTextMessage, createMessageWithImages } from './utils/messageBuilder.js';\nexport { readClipboardImage, hasClipboardImage } from './utils/clipboardImage.js';\nexport type { ClipboardImageResult } from './utils/clipboardImage.js';\nexport { extractJSON, extractJSONField, extractNumber } from './utils/jsonExtractor.js';\nexport type { JSONExtractionResult } from './utils/jsonExtractor.js';\nexport { sanitizeToolName } from './utils/sanitize.js';\n\n// ============ Pre-built Tools ============\nexport * as tools from './tools/index.js';\nexport { createExecuteJavaScriptTool } from './tools/code/executeJavaScript.js';\n\n// Custom tool generation system (meta-tools + hydration)\nexport {\n  // Default instances (auto-registered via tool registry)\n  customToolDraft,\n  customToolTest,\n  customToolSave,\n  customToolList,\n  customToolLoad,\n  customToolDelete,\n  // Factory functions (for custom storage backends)\n  createCustomToolMetaTools,\n  createCustomToolDraft,\n  createCustomToolTest,\n  createCustomToolSave,\n  createCustomToolList,\n  createCustomToolLoad,\n  createCustomToolDelete,\n  // Hydration\n  hydrateCustomTool,\n} from './tools/custom-tools/index.js';\n\nexport type {\n  CustomToolMetaToolsOptions,\n  HydrateOptions,\n} from './tools/custom-tools/index.js';\n\n// Filesystem tools (factory functions and types)\nexport {\n  readFile,\n  writeFile,\n  editFile,\n  glob,\n  grep,\n  listDirectory,\n  createReadFileTool,\n  createWriteFileTool,\n  createEditFileTool,\n  createGlobTool,\n  createGrepTool,\n  createListDirectoryTool,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n  isExcludedExtension,\n  developerTools,\n} from './tools/index.js';\n\nexport type {\n  FilesystemToolConfig,\n  ReadFileResult,\n  WriteFileResult,\n  EditFileResult,\n  GlobResult,\n  GrepResult,\n  GrepMatch,\n} from './tools/index.js';\n\n// Shell tools (factory functions and types)\nexport {\n  bash,\n  createBashTool,\n  getBackgroundOutput,\n  killBackgroundProcess,\n  DEFAULT_SHELL_CONFIG,\n  isBlockedCommand,\n} from './tools/index.js';\n\nexport type {\n  ShellToolConfig,\n  BashResult,\n} from './tools/index.js';\n\n// Tool Registry (auto-generated)\nexport {\n  toolRegistry,\n  getAllBuiltInTools,\n  getToolRegistry,\n  getToolsByCategory,\n  getToolByName,\n  getToolsRequiringConnector,\n  getToolCategories,\n} from './tools/index.js';\n\nexport type {\n  ToolCategory,\n  ToolRegistryEntry,\n} from './tools/index.js';\n\n// Unified Tool Registry (built-in + connector tools)\nexport { ToolRegistry, type ConnectorToolEntry } from './tools/index.js';\n\n// Multimedia tools (auto-registered with ConnectorTools for AI vendors)\nexport {\n  setMediaStorage,\n  getMediaStorage,\n  createImageGenerationTool,\n  createVideoTools,\n  createTextToSpeechTool,\n  createSpeechToTextTool,\n} from './tools/index.js';\n\n// Media storage infrastructure\nexport { FileMediaStorage, createFileMediaStorage } from './infrastructure/storage/index.js';\nexport type { FileMediaStorageConfig } from './infrastructure/storage/index.js';\n\n// Deprecated multimedia aliases (backward compat - remove in next major version)\nexport {\n  FileMediaOutputHandler,\n  setMediaOutputHandler,\n  getMediaOutputHandler,\n} from './tools/index.js';\n\nexport type {\n  IMediaOutputHandler,\n  MediaOutputMetadata,\n  MediaOutputResult,\n} from './tools/index.js';\n\n// GitHub connector tools (auto-registered with ConnectorTools for GitHub service)\nexport {\n  createSearchFilesTool,\n  createSearchCodeTool,\n  createGitHubReadFileTool,\n  createGetPRTool,\n  createPRFilesTool,\n  createPRCommentsTool,\n  createCreatePRTool,\n  parseRepository,\n  resolveRepository,\n} from './tools/index.js';\n\nexport type {\n  GitHubRepository,\n  GitHubSearchFilesResult,\n  GitHubSearchCodeResult,\n  GitHubReadFileResult,\n  GitHubGetPRResult,\n  GitHubPRFilesResult,\n  GitHubPRCommentsResult,\n  GitHubPRCommentEntry,\n  GitHubCreatePRResult,\n} from './tools/index.js';\n\n// Microsoft Graph connector tools (auto-registered with ConnectorTools for Microsoft service)\nexport {\n  createDraftEmailTool,\n  createSendEmailTool,\n  createMeetingTool,\n  createEditMeetingTool,\n  createGetMeetingTranscriptTool,\n  createFindMeetingSlotsTool,\n  createMicrosoftReadFileTool,\n  createMicrosoftListFilesTool,\n  createMicrosoftSearchFilesTool,\n  getUserPathPrefix,\n  microsoftFetch,\n  formatRecipients,\n  formatAttendees,\n  normalizeEmails,\n  isTeamsMeetingUrl,\n  resolveMeetingId,\n  encodeSharingUrl,\n  isWebUrl,\n  isMicrosoftFileUrl,\n  getDrivePrefix,\n  resolveFileEndpoints,\n  formatFileSize,\n} from './tools/index.js';\n\nexport type {\n  MicrosoftDraftEmailResult,\n  MicrosoftSendEmailResult,\n  MicrosoftCreateMeetingResult,\n  MicrosoftEditMeetingResult,\n  MicrosoftGetTranscriptResult,\n  MicrosoftFindSlotsResult,\n  MeetingSlotSuggestion,\n  MicrosoftReadFileResult,\n  MicrosoftListFilesResult,\n  MicrosoftSearchFilesResult,\n  GraphDriveItem,\n} from './tools/index.js';\n\n// Desktop automation tools (requires @nut-tree-fork/nut-js peer dependency)\nexport {\n  desktopScreenshot,\n  desktopMouseMove,\n  desktopMouseClick,\n  desktopMouseDrag,\n  desktopMouseScroll,\n  desktopGetCursor,\n  desktopKeyboardType,\n  desktopKeyboardKey,\n  desktopGetScreenSize,\n  desktopWindowList,\n  desktopWindowFocus,\n  desktopTools,\n  createDesktopScreenshotTool,\n  createDesktopMouseMoveTool,\n  createDesktopMouseClickTool,\n  createDesktopMouseDragTool,\n  createDesktopMouseScrollTool,\n  createDesktopGetCursorTool,\n  createDesktopKeyboardTypeTool,\n  createDesktopKeyboardKeyTool,\n  createDesktopGetScreenSizeTool,\n  createDesktopWindowListTool,\n  createDesktopWindowFocusTool,\n  NutTreeDriver,\n  parseKeyCombo,\n  getDesktopDriver,\n  resetDefaultDriver,\n  DEFAULT_DESKTOP_CONFIG,\n  DESKTOP_TOOL_NAMES,\n} from './tools/index.js';\n\nexport type {\n  IDesktopDriver,\n  DesktopToolConfig,\n  DesktopPoint,\n  DesktopScreenSize,\n  DesktopScreenshot,\n  DesktopWindow,\n  MouseButton,\n  DesktopToolName,\n  DesktopScreenshotArgs,\n  DesktopScreenshotResult,\n  DesktopMouseMoveArgs,\n  DesktopMouseMoveResult,\n  DesktopMouseClickArgs,\n  DesktopMouseClickResult,\n  DesktopMouseDragArgs,\n  DesktopMouseDragResult,\n  DesktopMouseScrollArgs,\n  DesktopMouseScrollResult,\n  DesktopGetCursorResult,\n  DesktopKeyboardTypeArgs,\n  DesktopKeyboardTypeResult,\n  DesktopKeyboardKeyArgs,\n  DesktopKeyboardKeyResult,\n  DesktopGetScreenSizeResult,\n  DesktopWindowListResult,\n  DesktopWindowFocusArgs,\n  DesktopWindowFocusResult,\n} from './tools/index.js';\n\n// ============ Built-in Agents ============\nexport { ProviderConfigAgent } from './agents/index.js';\nexport type { ConnectorConfigResult } from './agents/index.js';\n\n\n// ============ MCP (Model Context Protocol) ============\nexport { MCPClient, MCPRegistry } from './core/mcp/index.js';\nexport type {\n  IMCPClient,\n  MCPClientConnectionState,\n  MCPTool,\n  MCPToolResult,\n  MCPResource,\n  MCPResourceContent,\n  MCPPrompt,\n  MCPPromptResult,\n  MCPServerCapabilities,\n  MCPClientState,\n  MCPServerConfig,\n  MCPConfiguration,\n  MCPTransportType,\n  StdioTransportConfig,\n  HTTPTransportConfig,\n  TransportConfig,\n} from './core/mcp/index.js';\nexport {\n  MCPError,\n  MCPConnectionError,\n  MCPTimeoutError,\n  MCPProtocolError,\n  MCPToolError,\n  MCPResourceError,\n} from './core/mcp/index.js';\n\n// PersistentInstructions Storage\nexport { FilePersistentInstructionsStorage } from './infrastructure/storage/index.js';\nexport type { FilePersistentInstructionsStorageConfig } from './infrastructure/storage/index.js';\nexport type { IPersistentInstructionsStorage } from './domain/interfaces/IPersistentInstructionsStorage.js';\n\n// UserInfo Storage\nexport { FileUserInfoStorage } from './infrastructure/storage/index.js';\nexport type { FileUserInfoStorageConfig } from './infrastructure/storage/index.js';\nexport type { IUserInfoStorage, UserInfoEntry } from './domain/interfaces/IUserInfoStorage.js';\n\n// RoutineDefinition Storage\nexport type { IRoutineDefinitionStorage } from './domain/interfaces/IRoutineDefinitionStorage.js';\nexport { FileRoutineDefinitionStorage, createFileRoutineDefinitionStorage } from './infrastructure/storage/index.js';\nexport type { FileRoutineDefinitionStorageConfig } from './infrastructure/storage/index.js';\n\n// RoutineExecution Storage\nexport type { IRoutineExecutionStorage } from './domain/interfaces/IRoutineExecutionStorage.js';\n\n// Scheduling & Triggers\nexport type { IScheduler, ScheduleHandle, ScheduleSpec } from './domain/interfaces/IScheduler.js';\nexport { SimpleScheduler } from './infrastructure/scheduling/SimpleScheduler.js';\nexport { EventEmitterTrigger } from './infrastructure/triggers/EventEmitterTrigger.js';\n\n","/**\n * Connector Tools Framework\n *\n * This module provides the infrastructure for vendor-dependent tools.\n * Tools are thin wrappers around Connector.fetch() for specific operations.\n *\n * Usage:\n * ```typescript\n * import { ConnectorTools, Services } from '@everworker/oneringai';\n *\n * // Get generic API tool for any connector\n * const apiTool = ConnectorTools.genericAPI('my-connector');\n *\n * // Get all tools (generic + service-specific if registered)\n * const tools = ConnectorTools.for('slack');\n *\n * // Register custom service tools\n * ConnectorTools.registerService('my-service', (connector) => [\n *   createMyCustomTool(connector),\n * ]);\n * ```\n */\n\nexport {\n  ConnectorTools,\n  type ServiceToolFactory,\n  type GenericAPIToolOptions,\n  type GenericAPICallArgs,\n  type GenericAPICallResult,\n  type ConnectorToolsOptions,\n} from './ConnectorTools.js';\n","/**\n * OAuth 2.0 Authentication for Connectors\n */\n\nexport { OAuthManager } from './OAuthManager.js';\n\nexport type {\n  OAuthConfig,\n  OAuthFlow,\n  TokenResponse,\n  StoredToken,\n} from './types.js';\n","/**\n * Connectors - OAuth and authentication utilities\n *\n * Provides OAuth 2.0 infrastructure for authenticated API access.\n * Use Connector.create() from '@everworker/oneringai' for connector registration.\n *\n * Supports:\n * - OAuth 2.0 (Authorization Code + PKCE, Client Credentials, JWT Bearer)\n * - API Keys\n * - JWT Bearer tokens\n */\n\n// OAuth manager\nexport {\n  OAuthManager,\n} from './oauth/index.js';\n\nexport type {\n  OAuthConfig,\n  OAuthFlow,\n  TokenResponse,\n  StoredToken,\n} from './oauth/types.js';\n\nexport type { ITokenStorage } from './oauth/domain/ITokenStorage.js';\n\n// Storage implementations\nexport { MemoryStorage } from './oauth/infrastructure/storage/MemoryStorage.js';\nexport { FileStorage } from './oauth/infrastructure/storage/FileStorage.js';\nexport type { FileStorageConfig } from './oauth/infrastructure/storage/FileStorage.js';\n\n// Utilities\nexport { authenticatedFetch, createAuthenticatedFetch } from './authenticatedFetch.js';\nexport { generateWebAPITool } from './toolGenerator.js';\n\n// OAuth utilities (for advanced users)\nexport { generatePKCE, generateState } from './oauth/utils/pkce.js';\nexport { encrypt, decrypt, generateEncryptionKey } from './oauth/utils/encryption.js';\n\n// ConnectorConfig storage (for persistent connector configs)\nexport {\n  ConnectorConfigStore,\n  MemoryConnectorStorage,\n  FileConnectorStorage,\n  CONNECTOR_CONFIG_VERSION,\n} from './storage/index.js';\nexport type {\n  IConnectorConfigStorage,\n  StoredConnectorConfig,\n  FileConnectorStorageConfig,\n} from './storage/index.js';\n\n// ============ Vendor Templates ============\n// Pre-configured auth templates for 40+ common services\nexport {\n  // Helpers\n  createConnectorFromTemplate,\n  getConnectorTools,\n  getVendorTemplate,\n  getVendorAuthTemplate,\n  getAllVendorTemplates,\n  listVendorIds,\n  listVendors,\n  listVendorsByCategory,\n  listVendorsByAuthType,\n  getVendorInfo,\n  getCredentialsSetupURL,\n  getDocsURL,\n  buildAuthConfig,\n  // All templates array\n  allVendorTemplates,\n  // Logo utilities\n  getVendorLogo,\n  getVendorLogoSvg,\n  getVendorColor,\n  getVendorLogoCdnUrl,\n  hasVendorLogo,\n  getAllVendorLogos,\n  listVendorsWithLogos,\n  VENDOR_ICON_MAP,\n  SIMPLE_ICONS_CDN,\n} from './vendors/index.js';\n\nexport type {\n  VendorTemplate,\n  AuthTemplate,\n  AuthTemplateField,\n  VendorRegistryEntry,\n  TemplateCredentials,\n  CreateConnectorOptions,\n  VendorInfo,\n  VendorLogo,\n  SimpleIcon,\n} from './vendors/index.js';\n","/**\n * File-based token storage\n * Tokens are encrypted and stored in individual files with restrictive permissions\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\nimport * as crypto from 'crypto';\nimport { ITokenStorage, StoredToken } from '../../domain/ITokenStorage.js';\nimport { encrypt, decrypt } from '../../utils/encryption.js';\n\n/** Internal format stored on disk  includes the storage key for enumeration */\ninterface StoredTokenWithKey extends StoredToken {\n  _storageKey?: string;\n}\n\nexport interface FileStorageConfig {\n  directory: string; // Directory to store token files\n  encryptionKey: string; // Encryption key (REQUIRED - do not use auto-generated key!)\n}\n\nexport class FileStorage implements ITokenStorage {\n  private directory: string;\n  private encryptionKey: string;\n\n  constructor(config: FileStorageConfig) {\n    if (!config.encryptionKey) {\n      throw new Error(\n        'FileStorage requires an encryption key. Set OAUTH_ENCRYPTION_KEY in environment or provide config.encryptionKey'\n      );\n    }\n\n    this.directory = config.directory;\n    this.encryptionKey = config.encryptionKey;\n\n    // Ensure directory exists (async, don't block constructor)\n    this.ensureDirectory().catch((error) => {\n      console.error('Failed to create token directory:', error);\n    });\n  }\n\n  private async ensureDirectory(): Promise<void> {\n    try {\n      await fs.mkdir(this.directory, { recursive: true });\n      // Set directory permissions (owner only)\n      await fs.chmod(this.directory, 0o700);\n    } catch (error) {\n      // Directory might already exist, that's okay\n    }\n  }\n\n  /**\n   * Get file path for a token key (hashed for security)\n   */\n  private getFilePath(key: string): string {\n    // Hash the key for filename (prevents exposing sensitive key names)\n    const hash = crypto.createHash('sha256').update(key).digest('hex');\n    return path.join(this.directory, `${hash}.token`);\n  }\n\n  async storeToken(key: string, token: StoredToken): Promise<void> {\n    await this.ensureDirectory();\n\n    const filePath = this.getFilePath(key);\n    // Store the key inside the encrypted payload for enumeration via listKeys()\n    const tokenWithKey: StoredTokenWithKey = { ...token, _storageKey: key };\n    const plaintext = JSON.stringify(tokenWithKey);\n    const encrypted = encrypt(plaintext, this.encryptionKey);\n\n    // Write encrypted token to file\n    await fs.writeFile(filePath, encrypted, 'utf8');\n\n    // Set restrictive permissions (owner read/write only)\n    await fs.chmod(filePath, 0o600);\n  }\n\n  async getToken(key: string): Promise<StoredToken | null> {\n    const filePath = this.getFilePath(key);\n\n    try {\n      const encrypted = await fs.readFile(filePath, 'utf8');\n      const decrypted = decrypt(encrypted, this.encryptionKey);\n      const parsed = JSON.parse(decrypted) as StoredTokenWithKey;\n      // Strip internal _storageKey before returning\n      const { _storageKey, ...token } = parsed;\n      return token as StoredToken;\n    } catch (error: any) {\n      if (error.code === 'ENOENT') {\n        // File doesn't exist\n        return null;\n      }\n\n      console.error('Failed to read/decrypt token file:', error);\n\n      // Remove corrupted file\n      try {\n        await fs.unlink(filePath);\n      } catch {\n        // Ignore unlink errors\n      }\n\n      return null;\n    }\n  }\n\n  async deleteToken(key: string): Promise<void> {\n    const filePath = this.getFilePath(key);\n\n    try {\n      await fs.unlink(filePath);\n    } catch (error: any) {\n      if (error.code !== 'ENOENT') {\n        throw error;\n      }\n      // File doesn't exist, that's okay\n    }\n  }\n\n  async hasToken(key: string): Promise<boolean> {\n    const filePath = this.getFilePath(key);\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * List all storage keys by decrypting each token file and reading _storageKey.\n   * Falls back to returning hashed filenames for tokens stored before multi-account support.\n   */\n  async listKeys(): Promise<string[]> {\n    try {\n      const files = await fs.readdir(this.directory);\n      const tokenFiles = files.filter((f) => f.endsWith('.token'));\n\n      const keys: string[] = [];\n      for (const file of tokenFiles) {\n        try {\n          const filePath = path.join(this.directory, file);\n          const encrypted = await fs.readFile(filePath, 'utf8');\n          const decrypted = decrypt(encrypted, this.encryptionKey);\n          const parsed = JSON.parse(decrypted) as StoredTokenWithKey;\n          if (parsed._storageKey) {\n            keys.push(parsed._storageKey);\n          }\n          // Skip tokens without _storageKey (legacy, pre-multi-account)\n        } catch {\n          // Skip corrupted/unreadable files\n        }\n      }\n\n      return keys;\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * List all token keys (for debugging)\n   */\n  async listTokens(): Promise<string[]> {\n    try {\n      const files = await fs.readdir(this.directory);\n      return files.filter((f) => f.endsWith('.token')).map((f) => f.replace('.token', ''));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Clear all tokens\n   */\n  async clearAll(): Promise<void> {\n    try {\n      const files = await fs.readdir(this.directory);\n      const tokenFiles = files.filter((f) => f.endsWith('.token'));\n\n      await Promise.all(\n        tokenFiles.map((f) => fs.unlink(path.join(this.directory, f)).catch(() => {}))\n      );\n    } catch {\n      // Directory doesn't exist or can't read, that's okay\n    }\n  }\n}\n","/**\n * Authenticated Fetch - Drop-in replacement for fetch() with connector-based authentication\n *\n * Supports all auth schemes configured on connectors:\n * - Bearer tokens (OAuth, JWT)\n * - Bot tokens (Discord)\n * - Basic auth (Twilio, Zendesk)\n * - Custom headers (e.g., X-Shopify-Access-Token)\n */\n\nimport { Connector } from '../core/Connector.js';\n\n/**\n * Fetch with automatic authentication using connector's configured auth scheme\n *\n * Same API as standard fetch(), but with additional authProvider and optional userId/accountId parameters.\n * Authentication is handled automatically based on the connector's configuration:\n * - Bearer tokens (GitHub, Slack, Stripe)\n * - Bot tokens (Discord)\n * - Basic auth (Twilio, Zendesk)\n * - Custom headers (e.g., X-Shopify-Access-Token)\n *\n * @param url - URL to fetch (string or URL object). Can be relative if connector has baseURL.\n * @param options - Standard fetch options (DO NOT set Authorization header - it's added automatically)\n * @param authProvider - Name of registered connector (e.g., 'github', 'slack')\n * @param userId - Optional user identifier for multi-user support (omit for single-user mode)\n * @param accountId - Optional account alias for multi-account OAuth (e.g., 'work', 'personal')\n * @returns Promise<Response> - Same as standard fetch\n *\n * @example Single-user mode:\n * ```typescript\n * const response = await authenticatedFetch(\n *   'https://graph.microsoft.com/v1.0/me',\n *   { method: 'GET' },\n *   'microsoft'\n * );\n * const data = await response.json();\n * ```\n *\n * @example Multi-account mode:\n * ```typescript\n * const response = await authenticatedFetch(\n *   'https://graph.microsoft.com/v1.0/me',\n *   { method: 'GET' },\n *   'microsoft',\n *   'alice',\n *   'work'  // Use Alice's work Microsoft account\n * );\n * ```\n */\nexport async function authenticatedFetch(\n  url: string | URL,\n  options: RequestInit | undefined,\n  authProvider: string,\n  userId?: string,\n  accountId?: string\n): Promise<Response> {\n  const connector = Connector.get(authProvider);\n\n  // Delegate to connector.fetch() which handles all auth schemes correctly:\n  // - OAuth/JWT: Authorization: Bearer <token>\n  // - API Key: Uses configured headerName and headerPrefix\n  //   (e.g., \"Authorization: Bot <token>\" or \"X-Shopify-Access-Token: <token>\")\n  // Also provides: retry logic, timeout handling, circuit breaker protection\n  return connector.fetch(url.toString(), options, userId, accountId);\n}\n\n/**\n * Create an authenticated fetch function bound to a specific connector and optionally a user/account\n *\n * Useful for creating reusable fetch functions for a specific API and/or user.\n * Uses connector's configured auth scheme (Bearer, Bot, Basic, custom headers).\n *\n * @param authProvider - Name of registered connector\n * @param userId - Optional user identifier to bind to (omit for single-user mode)\n * @param accountId - Optional account alias for multi-account OAuth (e.g., 'work', 'personal')\n * @returns Fetch function bound to that connector (and user/account)\n *\n * @example Single-user mode:\n * ```typescript\n * const msftFetch = createAuthenticatedFetch('microsoft');\n *\n * // Use like normal fetch (auth automatic)\n * const me = await msftFetch('https://graph.microsoft.com/v1.0/me');\n * const emails = await msftFetch('https://graph.microsoft.com/v1.0/me/messages');\n * ```\n *\n * @example Multi-account mode:\n * ```typescript\n * // Create fetch for Alice's work Microsoft account\n * const workFetch = createAuthenticatedFetch('microsoft', 'alice', 'work');\n * const personalFetch = createAuthenticatedFetch('microsoft', 'alice', 'personal');\n *\n * const workEmails = await workFetch('/me/messages');\n * const personalEmails = await personalFetch('/me/messages');\n * ```\n */\nexport function createAuthenticatedFetch(\n  authProvider: string,\n  userId?: string,\n  accountId?: string\n): (url: string | URL, options?: RequestInit) => Promise<Response> {\n  // Validate connector exists at creation time\n  const connector = Connector.get(authProvider);\n\n  return async (url: string | URL, options?: RequestInit) => {\n    // Delegate to connector.fetch() for proper auth handling\n    return connector.fetch(url.toString(), options, userId, accountId);\n  };\n}\n","/**\n * Tool Generator - Auto-generate tools for registered connectors\n */\n\nimport { ToolFunction } from '../domain/entities/Tool.js';\nimport { Connector } from '../core/Connector.js';\nimport { authenticatedFetch } from './authenticatedFetch.js';\n\ninterface APIRequestArgs {\n  authProvider: string;\n  url: string;\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n  body?: any;\n  headers?: Record<string, string>;\n}\n\ninterface APIRequestResult {\n  success: boolean;\n  status: number;\n  statusText: string;\n  data: any;\n  error?: string;\n}\n\n/**\n * Generate a universal API request tool for all registered OAuth providers\n *\n * This tool allows the AI agent to make authenticated requests to any registered API.\n * The tool description is dynamically generated based on registered providers.\n *\n * @returns ToolFunction that can call any registered OAuth API\n */\nexport function generateWebAPITool(): ToolFunction<APIRequestArgs, APIRequestResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'api_request',\n        description: `Make authenticated HTTP request to any registered OAuth API.\n\nThis tool automatically handles OAuth authentication for registered providers.\n\nREGISTERED PROVIDERS:\n${Connector.getDescriptionsForTools()}\n\nHOW TO USE:\n1. Choose the appropriate authProvider based on which API you need to access\n2. Provide the URL (full URL or path relative to provider's baseURL)\n3. Specify the HTTP method (GET, POST, etc.)\n4. For POST/PUT/PATCH, include the request body\n\nEXAMPLES:\nRead Microsoft emails:\n{\n  authProvider: \"microsoft\",\n  url: \"/v1.0/me/messages\",\n  method: \"GET\"\n}\n\nList GitHub repositories:\n{\n  authProvider: \"github\",\n  url: \"/user/repos\",\n  method: \"GET\"\n}\n\nCreate Salesforce account:\n{\n  authProvider: \"salesforce\",\n  url: \"/services/data/v57.0/sobjects/Account\",\n  method: \"POST\",\n  body: { Name: \"Acme Corp\", Industry: \"Technology\" }\n}`,\n\n        parameters: {\n          type: 'object',\n          properties: {\n            authProvider: {\n              type: 'string',\n              enum: Connector.list(),\n              description:\n                'Which connector to use for authentication. Choose based on the API you need to access.',\n            },\n            url: {\n              type: 'string',\n              description:\n                'URL to request. Can be full URL (https://...) or path relative to provider baseURL (e.g., \"/v1.0/me\")',\n            },\n            method: {\n              type: 'string',\n              enum: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],\n              description: 'HTTP method (default: GET)',\n            },\n            body: {\n              description:\n                'Request body for POST/PUT/PATCH requests. Will be JSON-stringified automatically.',\n            },\n            headers: {\n              type: 'object',\n              description:\n                'Additional headers to include. Authorization header is added automatically.',\n            },\n          },\n          required: ['authProvider', 'url'],\n        },\n      },\n      blocking: true,\n      timeout: 30000,\n    },\n\n    execute: async (args: APIRequestArgs): Promise<APIRequestResult> => {\n      try {\n        // Get connector info\n        const connector = Connector.get(args.authProvider);\n\n        // Build full URL\n        const fullUrl = args.url.startsWith('http')\n          ? args.url\n          : `${connector.baseURL}${args.url}`;\n\n        // Prepare request options\n        const requestOptions: RequestInit = {\n          method: args.method || 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            ...args.headers,\n          },\n        };\n\n        // Add body for POST/PUT/PATCH\n        if (args.body && (args.method === 'POST' || args.method === 'PUT' || args.method === 'PATCH')) {\n          requestOptions.body = JSON.stringify(args.body);\n        }\n\n        // Make authenticated request\n        const response = await authenticatedFetch(fullUrl, requestOptions, args.authProvider);\n\n        // Get response data\n        const contentType = response.headers.get('content-type') || '';\n        let data: any;\n\n        if (contentType.includes('application/json')) {\n          data = await response.json();\n        } else {\n          data = await response.text();\n        }\n\n        return {\n          success: response.ok,\n          status: response.status,\n          statusText: response.statusText,\n          data,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          status: 0,\n          statusText: 'Error',\n          data: null,\n          error: (error as Error).message,\n        };\n      }\n    },\n  };\n}\n","/**\n * ConnectorConfig Storage Interface (Clean Architecture - Domain Layer)\n *\n * Defines the contract for storing and retrieving ConnectorConfig objects.\n * Storage implementations do NOT handle encryption - that's done by ConnectorConfigStore.\n */\n\nimport type { ConnectorConfig } from '../entities/Connector.js';\n\n/**\n * Wrapper for stored connector configuration with metadata\n */\nexport interface StoredConnectorConfig {\n  /** The connector configuration (may contain encrypted fields) */\n  config: ConnectorConfig;\n\n  /** Timestamp when the config was first stored */\n  createdAt: number;\n\n  /** Timestamp when the config was last updated */\n  updatedAt: number;\n\n  /** Schema version for future migrations */\n  version: number;\n}\n\n/**\n * Storage interface for ConnectorConfig persistence\n *\n * Implementations should:\n * - Store data as-is (encryption is handled by ConnectorConfigStore)\n * - Use appropriate file permissions for file-based storage\n * - Hash names for filenames to prevent enumeration attacks\n */\nexport interface IConnectorConfigStorage {\n  /**\n   * Save a connector configuration\n   *\n   * @param name - Unique identifier for this connector\n   * @param stored - The stored config with metadata\n   */\n  save(name: string, stored: StoredConnectorConfig): Promise<void>;\n\n  /**\n   * Retrieve a connector configuration by name\n   *\n   * @param name - Unique identifier for the connector\n   * @returns The stored config or null if not found\n   */\n  get(name: string): Promise<StoredConnectorConfig | null>;\n\n  /**\n   * Delete a connector configuration\n   *\n   * @param name - Unique identifier for the connector\n   * @returns True if deleted, false if not found\n   */\n  delete(name: string): Promise<boolean>;\n\n  /**\n   * Check if a connector configuration exists\n   *\n   * @param name - Unique identifier for the connector\n   * @returns True if exists\n   */\n  has(name: string): Promise<boolean>;\n\n  /**\n   * List all connector names\n   *\n   * @returns Array of connector names\n   */\n  list(): Promise<string[]>;\n\n  /**\n   * Get all stored connector configurations\n   *\n   * @returns Array of all stored configs\n   */\n  listAll(): Promise<StoredConnectorConfig[]>;\n}\n\n/** Current schema version */\nexport const CONNECTOR_CONFIG_VERSION = 1;\n","/**\n * ConnectorConfigStore - Domain service for storing ConnectorConfig with encryption\n *\n * Handles encryption/decryption of sensitive fields uniformly,\n * regardless of which storage backend is used.\n */\n\nimport type { ConnectorConfig, ConnectorAuth } from '../../domain/entities/Connector.js';\nimport type {\n  IConnectorConfigStorage,\n  StoredConnectorConfig,\n} from '../../domain/interfaces/IConnectorConfigStorage.js';\nimport { CONNECTOR_CONFIG_VERSION } from '../../domain/interfaces/IConnectorConfigStorage.js';\nimport { encrypt, decrypt } from '../oauth/utils/encryption.js';\nimport { StorageRegistry } from '../../core/StorageRegistry.js';\n\n/** Prefix for encrypted values */\nconst ENCRYPTED_PREFIX = '$ENC$:';\n\n/**\n * ConnectorConfigStore - manages connector configs with automatic encryption\n *\n * Usage:\n * ```typescript\n * const storage = new MemoryConnectorStorage();\n * const store = new ConnectorConfigStore(storage, process.env.ENCRYPTION_KEY!);\n *\n * await store.save('openai', { auth: { type: 'api_key', apiKey: 'sk-xxx' } });\n * const config = await store.get('openai'); // apiKey is decrypted\n * ```\n */\nexport class ConnectorConfigStore {\n  constructor(\n    private storage: IConnectorConfigStorage,\n    private encryptionKey: string\n  ) {\n    if (!encryptionKey || encryptionKey.length < 16) {\n      throw new Error(\n        'ConnectorConfigStore requires an encryption key of at least 16 characters'\n      );\n    }\n  }\n\n  /**\n   * Factory that resolves storage from StorageRegistry when no explicit storage is provided.\n   *\n   * @param encryptionKey - Encryption key for secrets (required, min 16 chars)\n   * @param storage - Optional explicit storage backend (overrides registry)\n   * @returns ConnectorConfigStore instance\n   * @throws Error if no storage available (neither explicit nor in registry)\n   */\n  static create(encryptionKey: string, storage?: IConnectorConfigStorage): ConnectorConfigStore {\n    if (storage) {\n      return new ConnectorConfigStore(storage, encryptionKey);\n    }\n\n    const registryStorage = StorageRegistry.get('connectorConfig');\n    if (!registryStorage) {\n      throw new Error(\n        'No storage provided and no connectorConfig configured in StorageRegistry. ' +\n        'Pass storage explicitly or call StorageRegistry.set(\\'connectorConfig\\', storage) first.'\n      );\n    }\n    return new ConnectorConfigStore(registryStorage, encryptionKey);\n  }\n\n  /**\n   * Save a connector configuration (secrets are encrypted automatically)\n   *\n   * @param name - Unique identifier for this connector\n   * @param config - The connector configuration\n   */\n  async save(name: string, config: ConnectorConfig): Promise<void> {\n    if (!name || name.trim().length === 0) {\n      throw new Error('Connector name is required');\n    }\n\n    const existing = await this.storage.get(name);\n    const now = Date.now();\n\n    const encryptedConfig = this.encryptSecrets(config);\n\n    const stored: StoredConnectorConfig = {\n      config: { ...encryptedConfig, name },\n      createdAt: existing?.createdAt ?? now,\n      updatedAt: now,\n      version: CONNECTOR_CONFIG_VERSION,\n    };\n\n    await this.storage.save(name, stored);\n  }\n\n  /**\n   * Retrieve a connector configuration (secrets are decrypted automatically)\n   *\n   * @param name - Unique identifier for the connector\n   * @returns The decrypted config or null if not found\n   */\n  async get(name: string): Promise<ConnectorConfig | null> {\n    const stored = await this.storage.get(name);\n    if (!stored) {\n      return null;\n    }\n\n    return this.decryptSecrets(stored.config);\n  }\n\n  /**\n   * Delete a connector configuration\n   *\n   * @param name - Unique identifier for the connector\n   * @returns True if deleted, false if not found\n   */\n  async delete(name: string): Promise<boolean> {\n    return this.storage.delete(name);\n  }\n\n  /**\n   * Check if a connector configuration exists\n   *\n   * @param name - Unique identifier for the connector\n   * @returns True if exists\n   */\n  async has(name: string): Promise<boolean> {\n    return this.storage.has(name);\n  }\n\n  /**\n   * List all connector names\n   *\n   * @returns Array of connector names\n   */\n  async list(): Promise<string[]> {\n    return this.storage.list();\n  }\n\n  /**\n   * Get all connector configurations (secrets are decrypted automatically)\n   *\n   * @returns Array of decrypted configs\n   */\n  async listAll(): Promise<ConnectorConfig[]> {\n    const stored = await this.storage.listAll();\n    return stored.map((s) => this.decryptSecrets(s.config));\n  }\n\n  /**\n   * Get stored metadata for a connector\n   *\n   * @param name - Unique identifier for the connector\n   * @returns Metadata (createdAt, updatedAt, version) or null\n   */\n  async getMetadata(\n    name: string\n  ): Promise<{ createdAt: number; updatedAt: number; version: number } | null> {\n    const stored = await this.storage.get(name);\n    if (!stored) {\n      return null;\n    }\n    return {\n      createdAt: stored.createdAt,\n      updatedAt: stored.updatedAt,\n      version: stored.version,\n    };\n  }\n\n  // ============ Encryption Helpers ============\n\n  /**\n   * Encrypt sensitive fields in a ConnectorConfig\n   * Fields encrypted: apiKey, clientSecret, privateKey\n   */\n  private encryptSecrets(config: ConnectorConfig): ConnectorConfig {\n    const result = { ...config };\n\n    if (result.auth) {\n      result.auth = this.encryptAuthSecrets(result.auth);\n    }\n\n    return result;\n  }\n\n  /**\n   * Decrypt sensitive fields in a ConnectorConfig\n   */\n  private decryptSecrets(config: ConnectorConfig): ConnectorConfig {\n    const result = { ...config };\n\n    if (result.auth) {\n      result.auth = this.decryptAuthSecrets(result.auth);\n    }\n\n    return result;\n  }\n\n  /**\n   * Encrypt secrets in ConnectorAuth based on auth type\n   */\n  private encryptAuthSecrets(auth: ConnectorAuth): ConnectorAuth {\n    const encryptedExtra = this.encryptExtra((auth as any).extra);\n\n    switch (auth.type) {\n      case 'api_key':\n        return {\n          ...auth,\n          apiKey: this.encryptValue(auth.apiKey),\n          ...(encryptedExtra ? { extra: encryptedExtra } : {}),\n        };\n\n      case 'oauth':\n        return {\n          ...auth,\n          clientSecret: auth.clientSecret\n            ? this.encryptValue(auth.clientSecret)\n            : undefined,\n          privateKey: auth.privateKey\n            ? this.encryptValue(auth.privateKey)\n            : undefined,\n          ...(encryptedExtra ? { extra: encryptedExtra } : {}),\n        };\n\n      case 'jwt':\n        return {\n          ...auth,\n          privateKey: this.encryptValue(auth.privateKey),\n          ...(encryptedExtra ? { extra: encryptedExtra } : {}),\n        };\n\n      default:\n        return auth;\n    }\n  }\n\n  /**\n   * Decrypt secrets in ConnectorAuth based on auth type\n   */\n  private decryptAuthSecrets(auth: ConnectorAuth): ConnectorAuth {\n    const decryptedExtra = this.decryptExtra((auth as any).extra);\n\n    switch (auth.type) {\n      case 'api_key':\n        return {\n          ...auth,\n          apiKey: this.decryptValue(auth.apiKey),\n          ...(decryptedExtra ? { extra: decryptedExtra } : {}),\n        };\n\n      case 'oauth':\n        return {\n          ...auth,\n          clientSecret: auth.clientSecret\n            ? this.decryptValue(auth.clientSecret)\n            : undefined,\n          privateKey: auth.privateKey\n            ? this.decryptValue(auth.privateKey)\n            : undefined,\n          ...(decryptedExtra ? { extra: decryptedExtra } : {}),\n        };\n\n      case 'jwt':\n        return {\n          ...auth,\n          privateKey: this.decryptValue(auth.privateKey),\n          ...(decryptedExtra ? { extra: decryptedExtra } : {}),\n        };\n\n      default:\n        return auth;\n    }\n  }\n\n  /**\n   * Encrypt all values in an extra Record (vendor-specific credentials)\n   */\n  private encryptExtra(\n    extra: Record<string, string> | undefined,\n  ): Record<string, string> | undefined {\n    if (!extra || Object.keys(extra).length === 0) return undefined;\n    const result: Record<string, string> = {};\n    for (const [key, value] of Object.entries(extra)) {\n      result[key] = this.encryptValue(value);\n    }\n    return result;\n  }\n\n  /**\n   * Decrypt all values in an extra Record (vendor-specific credentials)\n   */\n  private decryptExtra(\n    extra: Record<string, string> | undefined,\n  ): Record<string, string> | undefined {\n    if (!extra || Object.keys(extra).length === 0) return undefined;\n    const result: Record<string, string> = {};\n    for (const [key, value] of Object.entries(extra)) {\n      result[key] = this.decryptValue(value);\n    }\n    return result;\n  }\n\n  /**\n   * Encrypt a single value if not already encrypted\n   */\n  private encryptValue(value: string): string {\n    if (this.isEncrypted(value)) {\n      return value; // Already encrypted\n    }\n    const encrypted = encrypt(value, this.encryptionKey);\n    return `${ENCRYPTED_PREFIX}${encrypted}`;\n  }\n\n  /**\n   * Decrypt a single value if encrypted\n   */\n  private decryptValue(value: string): string {\n    if (!this.isEncrypted(value)) {\n      return value; // Not encrypted (legacy or plaintext)\n    }\n    const encryptedData = value.slice(ENCRYPTED_PREFIX.length);\n    return decrypt(encryptedData, this.encryptionKey);\n  }\n\n  /**\n   * Check if a value is encrypted (has the $ENC$: prefix)\n   */\n  private isEncrypted(value: string): boolean {\n    return value.startsWith(ENCRYPTED_PREFIX);\n  }\n}\n","/**\n * In-memory storage for ConnectorConfig\n *\n * Simple Map-based storage. No encryption logic here -\n * encryption is handled by ConnectorConfigStore.\n *\n * Useful for:\n * - Testing\n * - Short-lived processes\n * - Development\n *\n * Note: Data is lost when process exits.\n */\n\nimport type {\n  IConnectorConfigStorage,\n  StoredConnectorConfig,\n} from '../../domain/interfaces/IConnectorConfigStorage.js';\n\nexport class MemoryConnectorStorage implements IConnectorConfigStorage {\n  private configs: Map<string, StoredConnectorConfig> = new Map();\n\n  async save(name: string, stored: StoredConnectorConfig): Promise<void> {\n    // Deep clone to prevent external mutation\n    this.configs.set(name, JSON.parse(JSON.stringify(stored)));\n  }\n\n  async get(name: string): Promise<StoredConnectorConfig | null> {\n    const stored = this.configs.get(name);\n    if (!stored) {\n      return null;\n    }\n    // Return a copy to prevent external mutation\n    return JSON.parse(JSON.stringify(stored));\n  }\n\n  async delete(name: string): Promise<boolean> {\n    return this.configs.delete(name);\n  }\n\n  async has(name: string): Promise<boolean> {\n    return this.configs.has(name);\n  }\n\n  async list(): Promise<string[]> {\n    return Array.from(this.configs.keys());\n  }\n\n  async listAll(): Promise<StoredConnectorConfig[]> {\n    // Return copies to prevent external mutation\n    return Array.from(this.configs.values()).map((stored) =>\n      JSON.parse(JSON.stringify(stored))\n    );\n  }\n\n  /**\n   * Clear all stored configs (useful for testing)\n   */\n  clear(): void {\n    this.configs.clear();\n  }\n\n  /**\n   * Get the number of stored configs\n   */\n  size(): number {\n    return this.configs.size;\n  }\n}\n","/**\n * File-based storage for ConnectorConfig\n *\n * Stores each connector config as a JSON file with restrictive permissions.\n * No encryption logic here - encryption is handled by ConnectorConfigStore.\n *\n * File structure:\n * - {directory}/{hash}.connector.json - individual connector files\n * - {directory}/_index.json - maps hashes to names for list()\n */\n\nimport * as fs from 'fs/promises';\nimport * as path from 'path';\nimport * as crypto from 'crypto';\nimport type {\n  IConnectorConfigStorage,\n  StoredConnectorConfig,\n} from '../../domain/interfaces/IConnectorConfigStorage.js';\n\nexport interface FileConnectorStorageConfig {\n  /** Directory to store connector files */\n  directory: string;\n}\n\ninterface IndexFile {\n  /** Maps hash -> name for reverse lookup */\n  connectors: Record<string, string>;\n}\n\nexport class FileConnectorStorage implements IConnectorConfigStorage {\n  private directory: string;\n  private indexPath: string;\n  private initialized = false;\n\n  constructor(config: FileConnectorStorageConfig) {\n    if (!config.directory) {\n      throw new Error('FileConnectorStorage requires a directory path');\n    }\n    this.directory = config.directory;\n    this.indexPath = path.join(this.directory, '_index.json');\n  }\n\n  async save(name: string, stored: StoredConnectorConfig): Promise<void> {\n    await this.ensureDirectory();\n\n    const filePath = this.getFilePath(name);\n    const json = JSON.stringify(stored, null, 2);\n\n    // Write config file\n    await fs.writeFile(filePath, json, 'utf8');\n    await fs.chmod(filePath, 0o600); // Owner read/write only\n\n    // Update index\n    await this.updateIndex(name, 'add');\n  }\n\n  async get(name: string): Promise<StoredConnectorConfig | null> {\n    const filePath = this.getFilePath(name);\n\n    try {\n      const json = await fs.readFile(filePath, 'utf8');\n      return JSON.parse(json) as StoredConnectorConfig;\n    } catch (error: unknown) {\n      const err = error as NodeJS.ErrnoException;\n      if (err.code === 'ENOENT') {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  async delete(name: string): Promise<boolean> {\n    const filePath = this.getFilePath(name);\n\n    try {\n      await fs.unlink(filePath);\n      await this.updateIndex(name, 'remove');\n      return true;\n    } catch (error: unknown) {\n      const err = error as NodeJS.ErrnoException;\n      if (err.code === 'ENOENT') {\n        return false;\n      }\n      throw error;\n    }\n  }\n\n  async has(name: string): Promise<boolean> {\n    const filePath = this.getFilePath(name);\n\n    try {\n      await fs.access(filePath);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  async list(): Promise<string[]> {\n    const index = await this.loadIndex();\n    return Object.values(index.connectors);\n  }\n\n  async listAll(): Promise<StoredConnectorConfig[]> {\n    const names = await this.list();\n    const results: StoredConnectorConfig[] = [];\n\n    for (const name of names) {\n      const stored = await this.get(name);\n      if (stored) {\n        results.push(stored);\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Clear all stored configs (useful for testing)\n   */\n  async clear(): Promise<void> {\n    try {\n      const files = await fs.readdir(this.directory);\n      const connectorFiles = files.filter(\n        (f) => f.endsWith('.connector.json') || f === '_index.json'\n      );\n\n      await Promise.all(\n        connectorFiles.map((f) =>\n          fs.unlink(path.join(this.directory, f)).catch(() => {})\n        )\n      );\n    } catch {\n      // Directory doesn't exist, that's okay\n    }\n  }\n\n  // ============ Private Helpers ============\n\n  /**\n   * Get file path for a connector (hashed for security)\n   */\n  private getFilePath(name: string): string {\n    const hash = this.hashName(name);\n    return path.join(this.directory, `${hash}.connector.json`);\n  }\n\n  /**\n   * Hash connector name to prevent enumeration\n   */\n  private hashName(name: string): string {\n    return crypto.createHash('sha256').update(name).digest('hex').slice(0, 16);\n  }\n\n  /**\n   * Ensure storage directory exists with proper permissions\n   */\n  private async ensureDirectory(): Promise<void> {\n    if (this.initialized) return;\n\n    try {\n      await fs.mkdir(this.directory, { recursive: true });\n      await fs.chmod(this.directory, 0o700); // Owner only\n      this.initialized = true;\n    } catch {\n      // Directory might already exist\n      this.initialized = true;\n    }\n  }\n\n  /**\n   * Load the index file\n   */\n  private async loadIndex(): Promise<IndexFile> {\n    try {\n      const json = await fs.readFile(this.indexPath, 'utf8');\n      return JSON.parse(json) as IndexFile;\n    } catch {\n      return { connectors: {} };\n    }\n  }\n\n  /**\n   * Update the index file\n   */\n  private async updateIndex(\n    name: string,\n    action: 'add' | 'remove'\n  ): Promise<void> {\n    const index = await this.loadIndex();\n    const hash = this.hashName(name);\n\n    if (action === 'add') {\n      index.connectors[hash] = name;\n    } else {\n      delete index.connectors[hash];\n    }\n\n    const json = JSON.stringify(index, null, 2);\n    await fs.writeFile(this.indexPath, json, 'utf8');\n    await fs.chmod(this.indexPath, 0o600);\n  }\n}\n","/**\n * Vendor Templates - Helper Functions\n *\n * Functions for creating connectors from vendor templates.\n */\n\nimport { Connector } from '../../core/Connector.js';\nimport type { ConnectorAuth, ConnectorConfig } from '../../domain/entities/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport { ConnectorTools } from '../../tools/connector/ConnectorTools.js';\nimport type {\n  VendorTemplate,\n  AuthTemplate,\n  TemplateCredentials,\n  CreateConnectorOptions,\n} from './types.js';\n\n// Import will be replaced by generated registry\nlet vendorRegistry: Map<string, VendorTemplate> | null = null;\n\n/**\n * Initialize the vendor registry (called by generated registry file)\n */\nexport function initVendorRegistry(templates: VendorTemplate[]): void {\n  vendorRegistry = new Map(templates.map((t) => [t.id, t]));\n}\n\n/**\n * Get vendor template by ID\n */\nexport function getVendorTemplate(vendorId: string): VendorTemplate | undefined {\n  if (!vendorRegistry) {\n    throw new Error(\n      'Vendor registry not initialized. Make sure to import from @everworker/oneringai which auto-registers templates.'\n    );\n  }\n  return vendorRegistry.get(vendorId);\n}\n\n/**\n * Get all vendor templates\n */\nexport function getAllVendorTemplates(): VendorTemplate[] {\n  if (!vendorRegistry) {\n    throw new Error(\n      'Vendor registry not initialized. Make sure to import from @everworker/oneringai which auto-registers templates.'\n    );\n  }\n  return Array.from(vendorRegistry.values());\n}\n\n/**\n * Get auth template for a vendor\n */\nexport function getVendorAuthTemplate(\n  vendorId: string,\n  authId: string\n): AuthTemplate | undefined {\n  const template = getVendorTemplate(vendorId);\n  if (!template) return undefined;\n  return template.authTemplates.find((a) => a.id === authId);\n}\n\n/**\n * List all vendor IDs\n */\nexport function listVendorIds(): string[] {\n  if (!vendorRegistry) {\n    throw new Error(\n      'Vendor registry not initialized. Make sure to import from @everworker/oneringai which auto-registers templates.'\n    );\n  }\n  return Array.from(vendorRegistry.keys());\n}\n\n/**\n * Build ConnectorAuth from auth template and credentials\n */\nexport function buildAuthConfig(\n  authTemplate: AuthTemplate,\n  credentials: TemplateCredentials\n): ConnectorAuth {\n  const defaults = authTemplate.defaults;\n\n  if (authTemplate.type === 'api_key') {\n    if (!credentials.apiKey) {\n      throw new Error('API key is required for api_key auth');\n    }\n\n    // Collect vendor-specific extra fields (those in optionalFields that aren't standard api_key props)\n    const standardApiKeyFields = new Set(['apiKey', 'headerName', 'headerPrefix']);\n    const extra: Record<string, string> = {};\n    for (const field of authTemplate.optionalFields ?? []) {\n      if (!standardApiKeyFields.has(field) && credentials[field]) {\n        extra[field] = credentials[field]!;\n      }\n    }\n\n    return {\n      type: 'api_key',\n      apiKey: credentials.apiKey,\n      headerName: (defaults as { headerName?: string }).headerName ?? 'Authorization',\n      headerPrefix: (defaults as { headerPrefix?: string }).headerPrefix ?? 'Bearer',\n      ...(Object.keys(extra).length > 0 ? { extra } : {}),\n    };\n  }\n\n  // OAuth type\n  if (!authTemplate.flow) {\n    throw new Error(`OAuth flow not specified in auth template: ${authTemplate.id}`);\n  }\n\n  const oauthDefaults = defaults as Partial<ConnectorAuth & { type: 'oauth' }>;\n\n  // Build OAuth config based on flow type\n  const oauthConfig: ConnectorAuth & { type: 'oauth' } = {\n    type: 'oauth',\n    flow: authTemplate.flow,\n    clientId: credentials.clientId ?? '',\n    clientSecret: credentials.clientSecret,\n    tokenUrl: oauthDefaults.tokenUrl ?? '',\n    authorizationUrl: oauthDefaults.authorizationUrl,\n    redirectUri: credentials.redirectUri,\n    scope: credentials.scope ?? authTemplate.scopes?.join(' '),\n    usePKCE: oauthDefaults.usePKCE,\n    privateKey: credentials.privateKey,\n    privateKeyPath: credentials.privateKeyPath,\n    audience: credentials.audience ?? oauthDefaults.audience,\n    subject: credentials.subject ?? oauthDefaults.subject,\n  };\n\n  // Handle URL templates (e.g., {tenantId}, {installationId})\n  if (oauthConfig.tokenUrl && credentials.tenantId) {\n    oauthConfig.tokenUrl = oauthConfig.tokenUrl.replace('{tenantId}', credentials.tenantId);\n  }\n  if (oauthConfig.authorizationUrl && credentials.tenantId) {\n    oauthConfig.authorizationUrl = oauthConfig.authorizationUrl.replace(\n      '{tenantId}',\n      credentials.tenantId\n    );\n  }\n  if (oauthConfig.tokenUrl && credentials.installationId) {\n    oauthConfig.tokenUrl = oauthConfig.tokenUrl.replace(\n      '{installationId}',\n      credentials.installationId\n    );\n  }\n\n  // Remove undefined properties\n  const configAsUnknown = oauthConfig as unknown as Record<string, unknown>;\n  Object.keys(configAsUnknown).forEach((key) => {\n    if (configAsUnknown[key] === undefined) {\n      delete configAsUnknown[key];\n    }\n  });\n\n  return oauthConfig;\n}\n\n/**\n * Validate that all required fields are provided\n */\nfunction validateCredentials(\n  authTemplate: AuthTemplate,\n  credentials: TemplateCredentials\n): void {\n  const missing: string[] = [];\n\n  for (const field of authTemplate.requiredFields) {\n    if (!credentials[field]) {\n      missing.push(field);\n    }\n  }\n\n  if (missing.length > 0) {\n    throw new Error(\n      `Missing required credentials for ${authTemplate.name}: ${missing.join(', ')}`\n    );\n  }\n}\n\n/**\n * Create a Connector from a vendor template\n *\n * @param name - Unique connector name (e.g., 'my-github', 'github-work')\n * @param vendorId - Vendor ID (e.g., 'github', 'slack')\n * @param authTemplateId - Auth method ID (e.g., 'pat', 'oauth-user')\n * @param credentials - Credentials for the auth method\n * @param options - Optional configuration\n * @returns The created Connector\n *\n * @example\n * ```typescript\n * const connector = createConnectorFromTemplate(\n *   'my-github',\n *   'github',\n *   'pat',\n *   { apiKey: process.env.GITHUB_TOKEN }\n * );\n * ```\n */\nexport function createConnectorFromTemplate(\n  name: string,\n  vendorId: string,\n  authTemplateId: string,\n  credentials: TemplateCredentials,\n  options?: CreateConnectorOptions\n): Connector {\n  const template = getVendorTemplate(vendorId);\n  if (!template) {\n    const available = listVendorIds().slice(0, 10).join(', ');\n    throw new Error(\n      `Unknown vendor: ${vendorId}. Available vendors include: ${available}...`\n    );\n  }\n\n  const authTemplate = template.authTemplates.find((a) => a.id === authTemplateId);\n  if (!authTemplate) {\n    const available = template.authTemplates.map((a) => a.id).join(', ');\n    throw new Error(\n      `Unknown auth method '${authTemplateId}' for vendor '${vendorId}'. Available: ${available}`\n    );\n  }\n\n  // Validate required fields\n  validateCredentials(authTemplate, credentials);\n\n  // Build auth config from template defaults + credentials\n  const auth = buildAuthConfig(authTemplate, credentials);\n\n  // Build connector config\n  const config: ConnectorConfig & { name: string } = {\n    name,\n    serviceType: template.serviceType,\n    baseURL: options?.baseURL ?? template.baseURL,\n    auth,\n    displayName: options?.displayName ?? `${template.name} (${authTemplate.name})`,\n    description: options?.description ?? `${template.name} API connector using ${authTemplate.name}`,\n    documentation: template.docsURL,\n  };\n\n  if (options?.timeout !== undefined) {\n    config.timeout = options.timeout;\n  }\n\n  if (options?.logging) {\n    config.logging = { enabled: true };\n  }\n\n  return Connector.create(config);\n}\n\n/**\n * Get all tools for a connector (delegates to ConnectorTools)\n *\n * @param connectorName - Name of the connector\n * @returns Array of tools for the connector\n */\nexport function getConnectorTools(connectorName: string): ToolFunction[] {\n  return ConnectorTools.for(connectorName);\n}\n\n/**\n * Get vendor template information for display\n */\nexport interface VendorInfo {\n  id: string;\n  name: string;\n  category: string;\n  docsURL?: string;\n  credentialsSetupURL?: string;\n  authMethods: {\n    id: string;\n    name: string;\n    type: string;\n    description: string;\n    requiredFields: string[];\n    scopes?: string[];\n    scopeDescriptions?: Record<string, string>;\n  }[];\n}\n\n/**\n * Get vendor information suitable for display\n */\nexport function getVendorInfo(vendorId: string): VendorInfo | undefined {\n  const template = getVendorTemplate(vendorId);\n  if (!template) return undefined;\n\n  return {\n    id: template.id,\n    name: template.name,\n    category: template.category,\n    docsURL: template.docsURL,\n    credentialsSetupURL: template.credentialsSetupURL,\n    authMethods: template.authTemplates.map((a) => ({\n      id: a.id,\n      name: a.name,\n      type: a.type,\n      description: a.description,\n      requiredFields: a.requiredFields,\n      scopes: a.scopes,\n      scopeDescriptions: a.scopeDescriptions,\n    })),\n  };\n}\n\n/**\n * List all vendors with basic info\n */\nexport function listVendors(): VendorInfo[] {\n  return getAllVendorTemplates().map((t) => ({\n    id: t.id,\n    name: t.name,\n    category: t.category,\n    docsURL: t.docsURL,\n    credentialsSetupURL: t.credentialsSetupURL,\n    authMethods: t.authTemplates.map((a) => ({\n      id: a.id,\n      name: a.name,\n      type: a.type,\n      description: a.description,\n      requiredFields: a.requiredFields,\n      scopes: a.scopes,\n      scopeDescriptions: a.scopeDescriptions,\n    })),\n  }));\n}\n\n/**\n * List vendors by category\n */\nexport function listVendorsByCategory(category: string): VendorInfo[] {\n  return listVendors().filter((v) => v.category === category);\n}\n\n/**\n * List vendors that support a specific auth type\n */\nexport function listVendorsByAuthType(authType: 'api_key' | 'oauth'): VendorInfo[] {\n  return listVendors().filter((v) =>\n    v.authMethods.some((a) => a.type === authType)\n  );\n}\n\n/**\n * Get credentials setup URL for a vendor\n */\nexport function getCredentialsSetupURL(vendorId: string): string | undefined {\n  const template = getVendorTemplate(vendorId);\n  return template?.credentialsSetupURL;\n}\n\n/**\n * Get docs URL for a vendor\n */\nexport function getDocsURL(vendorId: string): string | undefined {\n  const template = getVendorTemplate(vendorId);\n  return template?.docsURL;\n}\n","/**\n * Microsoft Vendor Template (Unified)\n *\n * Single connector for all Microsoft services via Microsoft Graph API.\n * Includes access to: 365, Teams, OneDrive, Outlook, Azure AD, etc.\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const microsoftTemplate: VendorTemplate = {\n  id: 'microsoft',\n  name: 'Microsoft',\n  serviceType: 'microsoft',\n  baseURL: 'https://graph.microsoft.com/v1.0',\n  docsURL: 'https://learn.microsoft.com/en-us/graph/',\n  credentialsSetupURL: 'https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/ApplicationsListBlade',\n  category: 'major-vendors',\n  notes: 'Unified access to Microsoft 365, Teams, OneDrive, Outlook, Calendar via Microsoft Graph API',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth (Delegated Permissions)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'User signs in with Microsoft account. Best for accessing user data (mail, calendar, files). Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri', 'tenantId'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://login.microsoftonline.com/{tenantId}/oauth2/v2.0/authorize',\n        tokenUrl: 'https://login.microsoftonline.com/{tenantId}/oauth2/v2.0/token',\n        usePKCE: true,\n      },\n      scopes: [\n        'User.Read',\n        'Mail.Read',\n        'Mail.ReadWrite',\n        'Mail.Send',\n        'Calendars.ReadWrite',\n        'Contacts.Read',\n        'Contacts.ReadWrite',\n        'Files.ReadWrite',\n        'Sites.Read.All',\n        'Sites.ReadWrite.All',\n        'Notes.Read',\n        'Notes.ReadWrite',\n        'Tasks.ReadWrite',\n        'ChannelMessage.Send',\n        'Team.ReadBasic.All',\n        'Chat.ReadWrite',\n        'People.Read',\n        'Presence.Read',\n        'Directory.Read.All',\n        'BookingsAppointment.ReadWrite.All',\n        'offline_access',\n      ],\n      scopeDescriptions: {\n        'User.Read': 'Read your profile',\n        'Mail.Read': 'Read your email',\n        'Mail.ReadWrite': 'Read and write your email',\n        'Mail.Send': 'Send email on your behalf',\n        'Calendars.ReadWrite': 'Read and write your calendar',\n        'Contacts.Read': 'Read your contacts',\n        'Contacts.ReadWrite': 'Read and write your contacts',\n        'Files.ReadWrite': 'Read and write your files (OneDrive)',\n        'Sites.Read.All': 'Read SharePoint sites',\n        'Sites.ReadWrite.All': 'Read and write SharePoint sites',\n        'Notes.Read': 'Read your OneNote notebooks',\n        'Notes.ReadWrite': 'Read and write your OneNote notebooks',\n        'Tasks.ReadWrite': 'Read and write your tasks (To Do / Planner)',\n        'ChannelMessage.Send': 'Send messages in Teams channels',\n        'Team.ReadBasic.All': 'Read Teams basic info',\n        'Chat.ReadWrite': 'Read and write Teams chats',\n        'People.Read': 'Read your relevant people list',\n        'Presence.Read': 'Read user presence information',\n        'Directory.Read.All': 'Read directory data (Azure AD)',\n        'BookingsAppointment.ReadWrite.All': 'Manage Bookings appointments',\n        'offline_access': 'Maintain access (refresh token)',\n      },\n    },\n    {\n      id: 'client-credentials',\n      name: 'App-Only (Client Credentials)',\n      type: 'oauth',\n      flow: 'client_credentials',\n      description: 'App authenticates as itself - requires admin consent. Best for automation and background tasks',\n      requiredFields: ['clientId', 'clientSecret', 'tenantId'],\n      optionalFields: ['scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'client_credentials',\n        tokenUrl: 'https://login.microsoftonline.com/{tenantId}/oauth2/v2.0/token',\n      },\n      scopes: ['https://graph.microsoft.com/.default'],\n      scopeDescriptions: {\n        'https://graph.microsoft.com/.default': 'All permissions granted to the app registration',\n      },\n    },\n  ],\n};\n\n// Legacy exports for backward compatibility (all point to unified template)\nexport const microsoft365Template = microsoftTemplate;\nexport const microsoftTeamsTemplate = microsoftTemplate;\nexport const azureTemplate = microsoftTemplate;\nexport const onedriveTemplate = microsoftTemplate;\n","/**\n * Google Vendor Template (Unified)\n *\n * Single connector for all Google services via Google APIs.\n * Includes access to: Workspace (Drive, Docs, Sheets, Calendar), Gmail, GCP, etc.\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const googleTemplate: VendorTemplate = {\n  id: 'google',\n  name: 'Google',\n  serviceType: 'google',\n  baseURL: 'https://www.googleapis.com',\n  docsURL: 'https://developers.google.com/',\n  credentialsSetupURL: 'https://console.cloud.google.com/apis/credentials',\n  category: 'major-vendors',\n  notes: 'Unified access to Google Workspace (Drive, Docs, Sheets, Calendar), Gmail, and Cloud APIs',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Consent)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'User logs in with Google account. Best for accessing user data (Drive, Gmail, Calendar). Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://accounts.google.com/o/oauth2/v2/auth',\n        tokenUrl: 'https://oauth2.googleapis.com/token',\n        usePKCE: true,\n      },\n      scopes: [\n        'https://www.googleapis.com/auth/drive',\n        'https://www.googleapis.com/auth/calendar',\n        'https://www.googleapis.com/auth/gmail.readonly',\n        'https://www.googleapis.com/auth/gmail.send',\n        'https://www.googleapis.com/auth/spreadsheets',\n        'https://www.googleapis.com/auth/documents',\n        'https://www.googleapis.com/auth/contacts.readonly',\n        'https://www.googleapis.com/auth/tasks',\n        'https://www.googleapis.com/auth/admin.directory.user.readonly',\n      ],\n      scopeDescriptions: {\n        'https://www.googleapis.com/auth/drive': 'Read and write Google Drive files',\n        'https://www.googleapis.com/auth/calendar': 'Read and write Google Calendar',\n        'https://www.googleapis.com/auth/gmail.readonly': 'Read Gmail messages',\n        'https://www.googleapis.com/auth/gmail.send': 'Send Gmail messages',\n        'https://www.googleapis.com/auth/spreadsheets': 'Read and write Google Sheets',\n        'https://www.googleapis.com/auth/documents': 'Read and write Google Docs',\n        'https://www.googleapis.com/auth/contacts.readonly': 'Read Google Contacts',\n        'https://www.googleapis.com/auth/tasks': 'Read and write Google Tasks',\n        'https://www.googleapis.com/auth/admin.directory.user.readonly': 'Read user directory (Admin)',\n      },\n    },\n    {\n      id: 'service-account',\n      name: 'Service Account (JWT Bearer)',\n      type: 'oauth',\n      flow: 'jwt_bearer',\n      description: 'Server-to-server auth without user. Download JSON key from GCP Console. Can impersonate users with domain-wide delegation',\n      requiredFields: ['clientId', 'privateKey'],\n      optionalFields: ['scope', 'subject'],\n      defaults: {\n        type: 'oauth',\n        flow: 'jwt_bearer',\n        tokenUrl: 'https://oauth2.googleapis.com/token',\n        audience: 'https://oauth2.googleapis.com/token',\n      },\n      scopes: [\n        'https://www.googleapis.com/auth/cloud-platform',\n        'https://www.googleapis.com/auth/drive',\n      ],\n      scopeDescriptions: {\n        'https://www.googleapis.com/auth/cloud-platform': 'Full access to Google Cloud Platform',\n        'https://www.googleapis.com/auth/drive': 'Read and write Google Drive files',\n      },\n    },\n  ],\n};\n\n// Legacy exports for backward compatibility (all point to unified template)\nexport const googleWorkspaceTemplate = googleTemplate;\nexport const googleDriveTemplate = googleTemplate;\nexport const gcpTemplate = googleTemplate;\n","/**\n * Slack Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const slackTemplate: VendorTemplate = {\n  id: 'slack',\n  name: 'Slack',\n  serviceType: 'slack',\n  baseURL: 'https://slack.com/api',\n  docsURL: 'https://api.slack.com/methods',\n  credentialsSetupURL: 'https://api.slack.com/apps',\n  category: 'communication',\n\n  authTemplates: [\n    {\n      id: 'bot-token',\n      name: 'Bot Token',\n      type: 'api_key',\n      description: 'Internal workspace bot - get from OAuth & Permissions page of your Slack app. For Socket Mode bots, also provide appToken and signingSecret in extra fields.',\n      requiredFields: ['apiKey'],\n      optionalFields: ['appToken', 'signingSecret'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Token)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'Distributed app - users authorize via Slack OAuth. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope', 'userScope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://slack.com/oauth/v2/authorize',\n        tokenUrl: 'https://slack.com/api/oauth.v2.access',\n        usePKCE: true,\n      },\n      scopes: ['chat:write', 'channels:read', 'users:read', 'im:write', 'groups:read', 'files:read', 'files:write', 'reactions:read', 'reactions:write', 'team:read'],\n      scopeDescriptions: {\n        'chat:write': 'Send messages as the app',\n        'channels:read': 'View basic channel info',\n        'users:read': 'View people in the workspace',\n        'im:write': 'Send direct messages',\n        'groups:read': 'View basic private channel info',\n        'files:read': 'View files shared in channels',\n        'files:write': 'Upload and manage files',\n        'reactions:read': 'View emoji reactions',\n        'reactions:write': 'Add and remove emoji reactions',\n        'team:read': 'View workspace info',\n      },\n    },\n  ],\n};\n","/**\n * Discord Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const discordTemplate: VendorTemplate = {\n  id: 'discord',\n  name: 'Discord',\n  serviceType: 'discord',\n  baseURL: 'https://discord.com/api/v10',\n  docsURL: 'https://discord.com/developers/docs',\n  credentialsSetupURL: 'https://discord.com/developers/applications',\n  category: 'communication',\n\n  authTemplates: [\n    {\n      id: 'bot-token',\n      name: 'Bot Token',\n      type: 'api_key',\n      description: 'Bot token for Discord bots - get from Bot section of your application',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bot',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Token)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth2 for user authorization - users grant permissions to your app. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://discord.com/api/oauth2/authorize',\n        tokenUrl: 'https://discord.com/api/oauth2/token',\n        usePKCE: true,\n      },\n      scopes: ['identify', 'email', 'guilds', 'guilds.members.read', 'messages.read', 'bot', 'connections'],\n      scopeDescriptions: {\n        'identify': 'Access your username and avatar',\n        'email': 'Access your email address',\n        'guilds': 'View your server list',\n        'guilds.members.read': 'Read server member info',\n        'messages.read': 'Read messages in accessible channels',\n        'bot': 'Add a bot to your servers',\n        'connections': 'View your connected accounts',\n      },\n    },\n  ],\n};\n","/**\n * Telegram Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const telegramTemplate: VendorTemplate = {\n  id: 'telegram',\n  name: 'Telegram',\n  serviceType: 'telegram',\n  baseURL: 'https://api.telegram.org',\n  docsURL: 'https://core.telegram.org/bots/api',\n  credentialsSetupURL: 'https://t.me/BotFather',\n  category: 'communication',\n  notes: 'Telegram Bot API requires token to be part of URL path: /bot<token>/method',\n\n  authTemplates: [\n    {\n      id: 'bot-token',\n      name: 'Bot Token',\n      type: 'api_key',\n      description: 'Bot token from @BotFather - used in URL path, not header',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: '',\n      },\n    },\n  ],\n};\n","/**\n * X (Twitter) Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const twitterTemplate: VendorTemplate = {\n  id: 'twitter',\n  name: 'X (Twitter)',\n  serviceType: 'twitter',\n  baseURL: 'https://api.x.com/2',\n  docsURL: 'https://developer.x.com/en/docs/x-api',\n  credentialsSetupURL: 'https://developer.x.com/en/portal/dashboard',\n  category: 'communication',\n  notes: 'X (formerly Twitter) API v2. OAuth 2.0 with PKCE for user-context actions, Bearer Token for app-only access.',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth 2.0 (User Context)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'User authorizes via X login - required for posting tweets, managing likes/follows, and accessing private data. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://x.com/i/oauth2/authorize',\n        tokenUrl: 'https://api.x.com/2/oauth2/token',\n        usePKCE: true,\n      },\n      scopes: [\n        'tweet.read',\n        'tweet.write',\n        'tweet.moderate.write',\n        'users.read',\n        'follows.read',\n        'follows.write',\n        'like.read',\n        'like.write',\n        'bookmark.read',\n        'bookmark.write',\n        'list.read',\n        'list.write',\n        'block.read',\n        'block.write',\n        'mute.read',\n        'mute.write',\n        'space.read',\n        'dm.read',\n        'dm.write',\n        'offline.access',\n      ],\n      scopeDescriptions: {\n        'tweet.read': 'Read tweets and timelines',\n        'tweet.write': 'Post and delete tweets',\n        'tweet.moderate.write': 'Hide and unhide replies',\n        'users.read': 'Read user profile information',\n        'follows.read': 'Read following/followers lists',\n        'follows.write': 'Follow and unfollow users',\n        'like.read': 'Read liked tweets',\n        'like.write': 'Like and unlike tweets',\n        'bookmark.read': 'Read bookmarked tweets',\n        'bookmark.write': 'Bookmark and remove bookmarks',\n        'list.read': 'Read lists',\n        'list.write': 'Create, edit, and delete lists',\n        'block.read': 'Read blocked users',\n        'block.write': 'Block and unblock users',\n        'mute.read': 'Read muted users',\n        'mute.write': 'Mute and unmute users',\n        'space.read': 'Read Spaces information',\n        'dm.read': 'Read direct messages',\n        'dm.write': 'Send direct messages',\n        'offline.access': 'Stay connected (refresh token)',\n      },\n    },\n    {\n      id: 'bearer-token',\n      name: 'Bearer Token (App-Only)',\n      type: 'api_key',\n      description: 'App-only access using Bearer Token from developer portal. Can read public tweets, users, and spaces but cannot post or access private data.',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n  ],\n};\n","/**\n * GitHub Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const githubTemplate: VendorTemplate = {\n  id: 'github',\n  name: 'GitHub',\n  serviceType: 'github',\n  baseURL: 'https://api.github.com',\n  docsURL: 'https://docs.github.com/en/rest',\n  credentialsSetupURL: 'https://github.com/settings/developers',\n  category: 'development',\n\n  authTemplates: [\n    {\n      id: 'pat',\n      name: 'Personal Access Token',\n      type: 'api_key',\n      description: 'Simple token for personal use, scripts, or single-user apps. Create at Settings > Developer settings > Personal access tokens',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth App (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'User logs in via GitHub and grants permissions to your app. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://github.com/login/oauth/authorize',\n        tokenUrl: 'https://github.com/login/oauth/access_token',\n        usePKCE: true,\n      },\n      scopes: ['repo', 'read:user', 'user:email', 'read:org', 'workflow', 'gist', 'notifications', 'delete_repo', 'admin:org'],\n      scopeDescriptions: {\n        'repo': 'Full control of private repositories',\n        'read:user': 'Read user profile data',\n        'user:email': 'Access user email addresses',\n        'read:org': 'Read org and team membership',\n        'workflow': 'Update GitHub Actions workflows',\n        'gist': 'Create and manage gists',\n        'notifications': 'Access notifications',\n        'delete_repo': 'Delete repositories',\n        'admin:org': 'Full control of orgs and teams',\n      },\n    },\n    {\n      id: 'github-app',\n      name: 'GitHub App (Installation Token)',\n      type: 'oauth',\n      flow: 'jwt_bearer',\n      description: 'App authenticates as itself for org-wide automation. Requires App ID, private key, and installation ID',\n      requiredFields: ['appId', 'privateKey', 'installationId'],\n      defaults: {\n        type: 'oauth',\n        flow: 'jwt_bearer',\n        tokenUrl: 'https://api.github.com/app/installations/{installationId}/access_tokens',\n      },\n    },\n  ],\n};\n","/**\n * GitLab Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const gitlabTemplate: VendorTemplate = {\n  id: 'gitlab',\n  name: 'GitLab',\n  serviceType: 'gitlab',\n  baseURL: 'https://gitlab.com/api/v4',\n  docsURL: 'https://docs.gitlab.com/ee/api/',\n  credentialsSetupURL: 'https://gitlab.com/-/profile/personal_access_tokens',\n  category: 'development',\n  notes: 'For self-hosted GitLab, replace baseURL with your instance URL',\n\n  authTemplates: [\n    {\n      id: 'pat',\n      name: 'Personal Access Token',\n      type: 'api_key',\n      description: 'Personal access token for API access. Create at User Settings > Access Tokens',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'PRIVATE-TOKEN',\n        headerPrefix: '',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth2 application for user authorization. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://gitlab.com/oauth/authorize',\n        tokenUrl: 'https://gitlab.com/oauth/token',\n        usePKCE: true,\n      },\n      scopes: ['api', 'read_user', 'read_repository', 'write_repository'],\n      scopeDescriptions: {\n        'api': 'Full API access',\n        'read_user': 'Read user profile',\n        'read_repository': 'Read repository contents',\n        'write_repository': 'Write to repositories',\n      },\n    },\n  ],\n};\n","/**\n * Atlassian Vendor Templates (Jira, Confluence, Bitbucket, Trello)\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const jiraTemplate: VendorTemplate = {\n  id: 'jira',\n  name: 'Jira',\n  serviceType: 'jira',\n  baseURL: 'https://your-domain.atlassian.net/rest/api/3',\n  docsURL: 'https://developer.atlassian.com/cloud/jira/platform/rest/v3/',\n  credentialsSetupURL: 'https://id.atlassian.com/manage-profile/security/api-tokens',\n  category: 'development',\n  notes: 'Replace \"your-domain\" in baseURL with your Atlassian domain',\n\n  authTemplates: [\n    {\n      id: 'api-token',\n      name: 'API Token',\n      type: 'api_key',\n      description: 'API token with email for Basic Auth. Create at Atlassian Account > Security > API tokens',\n      requiredFields: ['apiKey', 'username'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Basic',\n      },\n    },\n    {\n      id: 'oauth-3lo',\n      name: 'OAuth 2.0 (3LO)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'Three-legged OAuth for user authorization. Create app at developer.atlassian.com. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://auth.atlassian.com/authorize',\n        tokenUrl: 'https://auth.atlassian.com/oauth/token',\n        usePKCE: true,\n      },\n      scopes: ['read:jira-work', 'write:jira-work', 'read:jira-user', 'manage:jira-project', 'manage:jira-configuration'],\n      scopeDescriptions: {\n        'read:jira-work': 'Read issues, projects, boards',\n        'write:jira-work': 'Create and update issues',\n        'read:jira-user': 'Read user information',\n        'manage:jira-project': 'Manage projects and components',\n        'manage:jira-configuration': 'Manage Jira settings',\n      },\n    },\n  ],\n};\n\nexport const confluenceTemplate: VendorTemplate = {\n  id: 'confluence',\n  name: 'Confluence',\n  serviceType: 'confluence',\n  baseURL: 'https://your-domain.atlassian.net/wiki/rest/api',\n  docsURL: 'https://developer.atlassian.com/cloud/confluence/rest/',\n  credentialsSetupURL: 'https://id.atlassian.com/manage-profile/security/api-tokens',\n  category: 'productivity',\n  notes: 'Replace \"your-domain\" in baseURL with your Atlassian domain',\n\n  authTemplates: [\n    {\n      id: 'api-token',\n      name: 'API Token',\n      type: 'api_key',\n      description: 'API token with email for Basic Auth. Create at Atlassian Account > Security > API tokens',\n      requiredFields: ['apiKey', 'username'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Basic',\n      },\n    },\n    {\n      id: 'oauth-3lo',\n      name: 'OAuth 2.0 (3LO)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'Three-legged OAuth for user authorization. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://auth.atlassian.com/authorize',\n        tokenUrl: 'https://auth.atlassian.com/oauth/token',\n        usePKCE: true,\n      },\n      scopes: ['read:confluence-content.all', 'write:confluence-content', 'read:confluence-space.summary', 'write:confluence-space', 'read:confluence-user'],\n      scopeDescriptions: {\n        'read:confluence-content.all': 'Read all pages and blog posts',\n        'write:confluence-content': 'Create and update pages',\n        'read:confluence-space.summary': 'Read space summaries',\n        'write:confluence-space': 'Create and manage spaces',\n        'read:confluence-user': 'Read user information',\n      },\n    },\n  ],\n};\n\nexport const bitbucketTemplate: VendorTemplate = {\n  id: 'bitbucket',\n  name: 'Bitbucket',\n  serviceType: 'bitbucket',\n  baseURL: 'https://api.bitbucket.org/2.0',\n  docsURL: 'https://developer.atlassian.com/cloud/bitbucket/rest/',\n  credentialsSetupURL: 'https://bitbucket.org/account/settings/app-passwords/',\n  category: 'development',\n\n  authTemplates: [\n    {\n      id: 'app-password',\n      name: 'App Password',\n      type: 'api_key',\n      description: 'App password with username for Basic Auth. Create at Personal Settings > App passwords',\n      requiredFields: ['apiKey', 'username'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Basic',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth Consumer',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth consumer for user authorization. Create at Workspace Settings > OAuth consumers. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://bitbucket.org/site/oauth2/authorize',\n        tokenUrl: 'https://bitbucket.org/site/oauth2/access_token',\n        usePKCE: true,\n      },\n      scopes: ['repository', 'repository:write', 'pullrequest', 'pullrequest:write', 'account', 'pipeline', 'wiki'],\n      scopeDescriptions: {\n        'repository': 'Read repositories',\n        'repository:write': 'Write to repositories',\n        'pullrequest': 'Read pull requests',\n        'pullrequest:write': 'Create and update pull requests',\n        'account': 'Read account information',\n        'pipeline': 'Access Pipelines (CI/CD)',\n        'wiki': 'Access repository wiki',\n      },\n    },\n  ],\n};\n\nexport const trelloTemplate: VendorTemplate = {\n  id: 'trello',\n  name: 'Trello',\n  serviceType: 'trello',\n  baseURL: 'https://api.trello.com/1',\n  docsURL: 'https://developer.atlassian.com/cloud/trello/rest/',\n  credentialsSetupURL: 'https://trello.com/power-ups/admin',\n  category: 'development',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key + Token',\n      type: 'api_key',\n      description: 'API key and token pair. Get key at trello.com/app-key, generate token from there',\n      requiredFields: ['apiKey'],\n      optionalFields: ['applicationKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'OAuth oauth_consumer_key=\"{apiKey}\", oauth_token=',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth 1.0a',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth 1.0a for user authorization (legacy). Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://trello.com/1/authorize',\n        tokenUrl: 'https://trello.com/1/OAuthGetAccessToken',\n        usePKCE: true,\n      },\n      scopes: ['read', 'write', 'account'],\n      scopeDescriptions: {\n        'read': 'Read boards, lists, and cards',\n        'write': 'Create and update boards, lists, and cards',\n        'account': 'Read member information',\n      },\n    },\n  ],\n};\n","/**\n * Linear Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const linearTemplate: VendorTemplate = {\n  id: 'linear',\n  name: 'Linear',\n  serviceType: 'linear',\n  baseURL: 'https://api.linear.app/graphql',\n  docsURL: 'https://developers.linear.app/docs',\n  credentialsSetupURL: 'https://linear.app/settings/api',\n  category: 'development',\n  notes: 'Linear uses GraphQL API. All requests go to the /graphql endpoint',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'Personal API Key',\n      type: 'api_key',\n      description: 'Personal API key for full access. Create at Settings > API',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: '',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth application for user authorization. Create at Settings > API > OAuth applications. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://linear.app/oauth/authorize',\n        tokenUrl: 'https://api.linear.app/oauth/token',\n        usePKCE: true,\n      },\n      scopes: ['read', 'write', 'issues:create', 'comments:create'],\n    },\n  ],\n};\n","/**\n * Asana Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const asanaTemplate: VendorTemplate = {\n  id: 'asana',\n  name: 'Asana',\n  serviceType: 'asana',\n  baseURL: 'https://app.asana.com/api/1.0',\n  docsURL: 'https://developers.asana.com/docs',\n  credentialsSetupURL: 'https://app.asana.com/0/developer-console',\n  category: 'development',\n\n  authTemplates: [\n    {\n      id: 'pat',\n      name: 'Personal Access Token',\n      type: 'api_key',\n      description: 'Personal access token for API access. Create at My Profile Settings > Apps > Developer Apps',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth application for user authorization. Create at developer console. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://app.asana.com/-/oauth_authorize',\n        tokenUrl: 'https://app.asana.com/-/oauth_token',\n        usePKCE: true,\n      },\n      scopes: ['default'],\n    },\n  ],\n};\n","/**\n * Notion Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const notionTemplate: VendorTemplate = {\n  id: 'notion',\n  name: 'Notion',\n  serviceType: 'notion',\n  baseURL: 'https://api.notion.com/v1',\n  docsURL: 'https://developers.notion.com/reference',\n  credentialsSetupURL: 'https://www.notion.so/my-integrations',\n  category: 'productivity',\n\n  authTemplates: [\n    {\n      id: 'internal-token',\n      name: 'Internal Integration Token',\n      type: 'api_key',\n      description: 'Internal integration token for workspace access. Create at notion.so/my-integrations',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'Public Integration (OAuth)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'Public integration for multi-workspace access. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://api.notion.com/v1/oauth/authorize',\n        tokenUrl: 'https://api.notion.com/v1/oauth/token',\n        usePKCE: true,\n      },\n    },\n  ],\n};\n","/**\n * Airtable Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const airtableTemplate: VendorTemplate = {\n  id: 'airtable',\n  name: 'Airtable',\n  serviceType: 'airtable',\n  baseURL: 'https://api.airtable.com/v0',\n  docsURL: 'https://airtable.com/developers/web/api',\n  credentialsSetupURL: 'https://airtable.com/create/tokens',\n  category: 'productivity',\n\n  authTemplates: [\n    {\n      id: 'pat',\n      name: 'Personal Access Token',\n      type: 'api_key',\n      description: 'Personal access token with scoped permissions. Create at airtable.com/create/tokens',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth integration for multi-user access. Register at airtable.com/create/oauth. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://airtable.com/oauth2/v1/authorize',\n        tokenUrl: 'https://airtable.com/oauth2/v1/token',\n        usePKCE: true,\n      },\n      scopes: ['data.records:read', 'data.records:write', 'schema.bases:read'],\n    },\n  ],\n};\n","/**\n * Salesforce Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const salesforceTemplate: VendorTemplate = {\n  id: 'salesforce',\n  name: 'Salesforce',\n  serviceType: 'salesforce',\n  baseURL: 'https://login.salesforce.com/services/data/v59.0',\n  docsURL: 'https://developer.salesforce.com/docs/apis',\n  credentialsSetupURL: 'https://login.salesforce.com/lightning/setup/ConnectedApplication/home',\n  category: 'crm',\n  notes: 'After OAuth, baseURL changes to instance URL (e.g., yourinstance.salesforce.com)',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'User logs in via Salesforce. Create Connected App in Setup. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://login.salesforce.com/services/oauth2/authorize',\n        tokenUrl: 'https://login.salesforce.com/services/oauth2/token',\n        usePKCE: true,\n      },\n      scopes: ['api', 'refresh_token', 'offline_access', 'chatter_api', 'wave_api', 'full'],\n      scopeDescriptions: {\n        'api': 'Access and manage your data',\n        'refresh_token': 'Maintain access with refresh tokens',\n        'offline_access': 'Access data while you are offline',\n        'chatter_api': 'Access Chatter feeds and posts',\n        'wave_api': 'Access Analytics (Wave) API',\n        'full': 'Full access to all data',\n      },\n    },\n    {\n      id: 'jwt-bearer',\n      name: 'JWT Bearer (Server-to-Server)',\n      type: 'oauth',\n      flow: 'jwt_bearer',\n      description: 'Automated server integration - requires certificate setup in Connected App',\n      requiredFields: ['clientId', 'privateKey', 'username'],\n      defaults: {\n        type: 'oauth',\n        flow: 'jwt_bearer',\n        tokenUrl: 'https://login.salesforce.com/services/oauth2/token',\n        audience: 'https://login.salesforce.com',\n      },\n    },\n  ],\n};\n","/**\n * HubSpot Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const hubspotTemplate: VendorTemplate = {\n  id: 'hubspot',\n  name: 'HubSpot',\n  serviceType: 'hubspot',\n  baseURL: 'https://api.hubapi.com',\n  docsURL: 'https://developers.hubspot.com/docs/api',\n  credentialsSetupURL: 'https://developers.hubspot.com/get-started',\n  category: 'crm',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'Private App Token',\n      type: 'api_key',\n      description: 'Private app access token. Create at Settings > Integrations > Private Apps',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'Public app OAuth for multi-portal access. Create app at developers.hubspot.com. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://app.hubspot.com/oauth/authorize',\n        tokenUrl: 'https://api.hubapi.com/oauth/v1/token',\n        usePKCE: true,\n      },\n      scopes: [\n        'crm.objects.contacts.read',\n        'crm.objects.contacts.write',\n        'crm.objects.companies.read',\n        'crm.objects.companies.write',\n        'crm.objects.deals.read',\n        'crm.objects.deals.write',\n        'tickets',\n        'e-commerce',\n      ],\n      scopeDescriptions: {\n        'crm.objects.contacts.read': 'Read contacts',\n        'crm.objects.contacts.write': 'Create and update contacts',\n        'crm.objects.companies.read': 'Read companies',\n        'crm.objects.companies.write': 'Create and update companies',\n        'crm.objects.deals.read': 'Read deals',\n        'crm.objects.deals.write': 'Create and update deals',\n        'tickets': 'Read and write support tickets',\n        'e-commerce': 'Access e-commerce data (products, line items)',\n      },\n    },\n    {\n      id: 'oauth-mcp',\n      name: 'MCP Auth App (OAuth 2.1)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'HubSpot MCP Auth app using OAuth 2.1 with PKCE. Scopes are auto-granted based on user permissions at install time. Create app at developers.hubspot.com under MCP Auth Apps.',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://mcp.hubspot.com/oauth/authorize/user',\n        tokenUrl: 'https://mcp.hubspot.com/oauth/v1/token',\n        usePKCE: true,\n      },\n    },\n  ],\n};\n","/**\n * Pipedrive Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const pipedriveTemplate: VendorTemplate = {\n  id: 'pipedrive',\n  name: 'Pipedrive',\n  serviceType: 'pipedrive',\n  baseURL: 'https://api.pipedrive.com/v1',\n  docsURL: 'https://developers.pipedrive.com/docs/api/v1',\n  credentialsSetupURL: 'https://app.pipedrive.com/settings/api',\n  category: 'crm',\n\n  authTemplates: [\n    {\n      id: 'api-token',\n      name: 'API Token',\n      type: 'api_key',\n      description: 'Personal API token. Find at Settings > Personal preferences > API',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (App Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth app for marketplace distribution. Create at developers.pipedrive.com. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://oauth.pipedrive.com/oauth/authorize',\n        tokenUrl: 'https://oauth.pipedrive.com/oauth/token',\n        usePKCE: true,\n      },\n    },\n  ],\n};\n","/**\n * Stripe Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const stripeTemplate: VendorTemplate = {\n  id: 'stripe',\n  name: 'Stripe',\n  serviceType: 'stripe',\n  baseURL: 'https://api.stripe.com/v1',\n  docsURL: 'https://stripe.com/docs/api',\n  credentialsSetupURL: 'https://dashboard.stripe.com/apikeys',\n  category: 'payments',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'Secret API Key',\n      type: 'api_key',\n      description: 'Secret API key for server-side requests. Get from Dashboard > Developers > API keys',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-connect',\n      name: 'OAuth (Stripe Connect)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'Stripe Connect for marketplace platforms. Requires Connect setup in dashboard. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://connect.stripe.com/oauth/authorize',\n        tokenUrl: 'https://connect.stripe.com/oauth/token',\n        usePKCE: true,\n      },\n      scopes: ['read_write'],\n    },\n  ],\n};\n","/**\n * PayPal Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const paypalTemplate: VendorTemplate = {\n  id: 'paypal',\n  name: 'PayPal',\n  serviceType: 'paypal',\n  baseURL: 'https://api-m.paypal.com/v2',\n  docsURL: 'https://developer.paypal.com/docs/api/',\n  credentialsSetupURL: 'https://developer.paypal.com/dashboard/applications',\n  category: 'payments',\n  notes: 'Use sandbox URL (api-m.sandbox.paypal.com) for testing',\n\n  authTemplates: [\n    {\n      id: 'oauth-client-credentials',\n      name: 'OAuth (Client Credentials)',\n      type: 'oauth',\n      flow: 'client_credentials',\n      description: 'App-level authentication. Create REST API app at developer.paypal.com',\n      requiredFields: ['clientId', 'clientSecret'],\n      defaults: {\n        type: 'oauth',\n        flow: 'client_credentials',\n        tokenUrl: 'https://api-m.paypal.com/v1/oauth2/token',\n      },\n    },\n  ],\n};\n","/**\n * QuickBooks Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const quickbooksTemplate: VendorTemplate = {\n  id: 'quickbooks',\n  name: 'QuickBooks',\n  serviceType: 'quickbooks',\n  baseURL: 'https://quickbooks.api.intuit.com/v3',\n  docsURL: 'https://developer.intuit.com/app/developer/qbo/docs/api/accounting/all-entities/account',\n  credentialsSetupURL: 'https://developer.intuit.com/app/developer/dashboard',\n  category: 'payments',\n  notes: 'Use sandbox URL (sandbox-quickbooks.api.intuit.com) for testing. Requires company/realm ID in API paths.',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description:\n        'Standard OAuth 2.0 flow for accessing QuickBooks on behalf of a user. Create an app at developer.intuit.com. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://appcenter.intuit.com/connect/oauth2',\n        tokenUrl: 'https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer',\n        usePKCE: true,\n      },\n      scopes: ['com.intuit.quickbooks.accounting', 'com.intuit.quickbooks.payment'],\n    },\n  ],\n};\n","/**\n * Ramp Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const rampTemplate: VendorTemplate = {\n  id: 'ramp',\n  name: 'Ramp',\n  serviceType: 'ramp',\n  baseURL: 'https://api.ramp.com/developer/v1',\n  docsURL: 'https://docs.ramp.com',\n  credentialsSetupURL: 'https://app.ramp.com/settings/developer',\n  category: 'payments',\n\n  authTemplates: [\n    {\n      id: 'oauth-client-credentials',\n      name: 'OAuth (Client Credentials)',\n      type: 'oauth',\n      flow: 'client_credentials',\n      description:\n        'App-level authentication using client credentials. Create an API application in Ramp developer settings',\n      requiredFields: ['clientId', 'clientSecret'],\n      defaults: {\n        type: 'oauth',\n        flow: 'client_credentials',\n        tokenUrl: 'https://api.ramp.com/developer/v1/token',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description:\n        'OAuth 2.0 authorization code flow for accessing Ramp on behalf of a user. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://app.ramp.com/v1/authorize',\n        tokenUrl: 'https://api.ramp.com/developer/v1/token',\n        usePKCE: true,\n      },\n      scopes: [\n        'transactions:read',\n        'users:read',\n        'users:write',\n        'cards:read',\n        'cards:write',\n        'departments:read',\n        'reimbursements:read',\n      ],\n    },\n  ],\n};\n","/**\n * AWS Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const awsTemplate: VendorTemplate = {\n  id: 'aws',\n  name: 'Amazon Web Services',\n  serviceType: 'aws',\n  baseURL: 'https://aws.amazon.com',\n  docsURL: 'https://docs.aws.amazon.com/',\n  credentialsSetupURL: 'https://console.aws.amazon.com/iam/home#/security_credentials',\n  category: 'cloud',\n  notes: 'AWS uses signature-based auth. baseURL varies by service (e.g., s3.amazonaws.com)',\n\n  authTemplates: [\n    {\n      id: 'access-key',\n      name: 'Access Key',\n      type: 'api_key',\n      description: 'IAM access key pair. Create at IAM > Users > Security credentials or root Security credentials',\n      requiredFields: ['accessKeyId', 'secretAccessKey'],\n      optionalFields: ['region'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'AWS4-HMAC-SHA256',\n      },\n    },\n  ],\n};\n","/**\n * Dropbox Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const dropboxTemplate: VendorTemplate = {\n  id: 'dropbox',\n  name: 'Dropbox',\n  serviceType: 'dropbox',\n  baseURL: 'https://api.dropboxapi.com/2',\n  docsURL: 'https://www.dropbox.com/developers/documentation',\n  credentialsSetupURL: 'https://www.dropbox.com/developers/apps',\n  category: 'storage',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth app for user authorization. Create app at dropbox.com/developers/apps. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://www.dropbox.com/oauth2/authorize',\n        tokenUrl: 'https://api.dropboxapi.com/oauth2/token',\n        usePKCE: true,\n      },\n      scopes: ['files.content.read', 'files.content.write', 'files.metadata.read', 'files.metadata.write', 'sharing.read', 'sharing.write', 'account_info.read'],\n      scopeDescriptions: {\n        'files.content.read': 'Read file contents',\n        'files.content.write': 'Upload and modify files',\n        'files.metadata.read': 'Read file and folder metadata',\n        'files.metadata.write': 'Modify file and folder metadata',\n        'sharing.read': 'View sharing settings',\n        'sharing.write': 'Manage sharing settings',\n        'account_info.read': 'Read account information',\n      },\n    },\n  ],\n};\n","/**\n * Box Vendor Template\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const boxTemplate: VendorTemplate = {\n  id: 'box',\n  name: 'Box',\n  serviceType: 'box',\n  baseURL: 'https://api.box.com/2.0',\n  docsURL: 'https://developer.box.com/reference/',\n  credentialsSetupURL: 'https://developer.box.com/console',\n  category: 'storage',\n\n  authTemplates: [\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth 2.0 for user authorization. Create app at developer.box.com/console. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://account.box.com/api/oauth2/authorize',\n        tokenUrl: 'https://api.box.com/oauth2/token',\n        usePKCE: true,\n      },\n      scopes: ['root_readwrite', 'manage_users', 'manage_groups', 'manage_enterprise'],\n      scopeDescriptions: {\n        'root_readwrite': 'Read and write all files and folders',\n        'manage_users': 'Manage enterprise users',\n        'manage_groups': 'Manage enterprise groups',\n        'manage_enterprise': 'Manage enterprise settings',\n      },\n    },\n    {\n      id: 'client-credentials',\n      name: 'Client Credentials (Server Auth)',\n      type: 'oauth',\n      flow: 'client_credentials',\n      description: 'Server-to-server auth with Client Credentials Grant. Enable in app settings',\n      requiredFields: ['clientId', 'clientSecret'],\n      optionalFields: ['subject'],\n      defaults: {\n        type: 'oauth',\n        flow: 'client_credentials',\n        tokenUrl: 'https://api.box.com/oauth2/token',\n      },\n    },\n  ],\n};\n","/**\n * Email Vendor Templates (SendGrid, Mailchimp, Postmark)\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const sendgridTemplate: VendorTemplate = {\n  id: 'sendgrid',\n  name: 'SendGrid',\n  serviceType: 'sendgrid',\n  baseURL: 'https://api.sendgrid.com/v3',\n  docsURL: 'https://docs.sendgrid.com/api-reference',\n  credentialsSetupURL: 'https://app.sendgrid.com/settings/api_keys',\n  category: 'email',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key',\n      type: 'api_key',\n      description: 'API key for SendGrid access. Create at Settings > API Keys',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n  ],\n};\n\nexport const mailchimpTemplate: VendorTemplate = {\n  id: 'mailchimp',\n  name: 'Mailchimp',\n  serviceType: 'mailchimp',\n  baseURL: 'https://server.api.mailchimp.com/3.0',\n  docsURL: 'https://mailchimp.com/developer/marketing/api/',\n  credentialsSetupURL: 'https://admin.mailchimp.com/account/api/',\n  category: 'email',\n  notes: 'Replace \"server\" in baseURL with your datacenter (e.g., us1, us2)',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key',\n      type: 'api_key',\n      description: 'API key for Mailchimp access. Create at Account > Extras > API keys',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth for multi-account access. Register app at mailchimp.com/developer. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://login.mailchimp.com/oauth2/authorize',\n        tokenUrl: 'https://login.mailchimp.com/oauth2/token',\n        usePKCE: true,\n      },\n    },\n  ],\n};\n\nexport const postmarkTemplate: VendorTemplate = {\n  id: 'postmark',\n  name: 'Postmark',\n  serviceType: 'postmark',\n  baseURL: 'https://api.postmarkapp.com',\n  docsURL: 'https://postmarkapp.com/developer',\n  credentialsSetupURL: 'https://account.postmarkapp.com/api_tokens',\n  category: 'email',\n\n  authTemplates: [\n    {\n      id: 'server-token',\n      name: 'Server API Token',\n      type: 'api_key',\n      description: 'Server API token for sending emails. Find in server settings',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'X-Postmark-Server-Token',\n        headerPrefix: '',\n      },\n    },\n    {\n      id: 'account-token',\n      name: 'Account API Token',\n      type: 'api_key',\n      description: 'Account API token for account management. Find in account settings',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'X-Postmark-Account-Token',\n        headerPrefix: '',\n      },\n    },\n  ],\n};\n","/**\n * Monitoring Vendor Templates (Datadog, PagerDuty, Sentry)\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const datadogTemplate: VendorTemplate = {\n  id: 'datadog',\n  name: 'Datadog',\n  serviceType: 'datadog',\n  baseURL: 'https://api.datadoghq.com/api/v2',\n  docsURL: 'https://docs.datadoghq.com/api/',\n  credentialsSetupURL: 'https://app.datadoghq.com/organization-settings/api-keys',\n  category: 'monitoring',\n  notes: 'Use region-specific URL (e.g., api.datadoghq.eu for EU)',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API & Application Keys',\n      type: 'api_key',\n      description: 'API key + Application key for full access. Get from Organization Settings',\n      requiredFields: ['apiKey', 'applicationKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'DD-API-KEY',\n        headerPrefix: '',\n      },\n    },\n  ],\n};\n\nexport const pagerdutyTemplate: VendorTemplate = {\n  id: 'pagerduty',\n  name: 'PagerDuty',\n  serviceType: 'pagerduty',\n  baseURL: 'https://api.pagerduty.com',\n  docsURL: 'https://developer.pagerduty.com/api-reference/',\n  credentialsSetupURL: 'https://support.pagerduty.com/main/docs/api-access-keys',\n  category: 'monitoring',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Token',\n      type: 'api_key',\n      description: 'REST API token. Create at User Settings > Create API Key or via Admin',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Token token=',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (App Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth app for multi-account access. Register at developer.pagerduty.com. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://app.pagerduty.com/oauth/authorize',\n        tokenUrl: 'https://app.pagerduty.com/oauth/token',\n        usePKCE: true,\n      },\n      scopes: ['read', 'write'],\n      scopeDescriptions: {\n        'read': 'Read incidents, services, and schedules',\n        'write': 'Create and update incidents and services',\n      },\n    },\n  ],\n};\n\nexport const sentryTemplate: VendorTemplate = {\n  id: 'sentry',\n  name: 'Sentry',\n  serviceType: 'sentry',\n  baseURL: 'https://sentry.io/api/0',\n  docsURL: 'https://docs.sentry.io/api/',\n  credentialsSetupURL: 'https://sentry.io/settings/account/api/auth-tokens/',\n  category: 'monitoring',\n\n  authTemplates: [\n    {\n      id: 'auth-token',\n      name: 'Auth Token',\n      type: 'api_key',\n      description: 'Authentication token. Create at User Settings > Auth Tokens',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (Integration)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth integration. Create at Organization Settings > Integrations. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://sentry.io/oauth/authorize/',\n        tokenUrl: 'https://sentry.io/oauth/token/',\n        usePKCE: true,\n      },\n      scopes: ['project:read', 'project:write', 'event:read', 'org:read', 'member:read'],\n      scopeDescriptions: {\n        'project:read': 'Read project settings',\n        'project:write': 'Manage project settings',\n        'event:read': 'Read error events and issues',\n        'org:read': 'Read organization info',\n        'member:read': 'Read org member info',\n      },\n    },\n  ],\n};\n","/**\n * Search Vendor Templates (Serper, Brave, Tavily, RapidAPI)\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const serperTemplate: VendorTemplate = {\n  id: 'serper',\n  name: 'Serper',\n  serviceType: 'serper',\n  baseURL: 'https://google.serper.dev',\n  docsURL: 'https://serper.dev/docs',\n  credentialsSetupURL: 'https://serper.dev/api-key',\n  category: 'search',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key',\n      type: 'api_key',\n      description: 'Serper API key for Google search. Get at serper.dev dashboard',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'X-API-KEY',\n        headerPrefix: '',\n      },\n    },\n  ],\n};\n\nexport const braveSearchTemplate: VendorTemplate = {\n  id: 'brave-search',\n  name: 'Brave Search',\n  serviceType: 'brave-search',\n  baseURL: 'https://api.search.brave.com/res/v1',\n  docsURL: 'https://brave.com/search/api/',\n  credentialsSetupURL: 'https://brave.com/search/api/',\n  category: 'search',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key',\n      type: 'api_key',\n      description: 'Brave Search API key. Sign up at brave.com/search/api',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'X-Subscription-Token',\n        headerPrefix: '',\n      },\n    },\n  ],\n};\n\nexport const tavilyTemplate: VendorTemplate = {\n  id: 'tavily',\n  name: 'Tavily',\n  serviceType: 'tavily',\n  baseURL: 'https://api.tavily.com',\n  docsURL: 'https://tavily.com/docs',\n  credentialsSetupURL: 'https://tavily.com/#api',\n  category: 'search',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key',\n      type: 'api_key',\n      description: 'Tavily API key for AI-optimized search. Get at tavily.com',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n  ],\n};\n\nexport const rapidapiSearchTemplate: VendorTemplate = {\n  id: 'rapidapi-search',\n  name: 'RapidAPI Web Search',\n  serviceType: 'rapidapi-search',\n  baseURL: 'https://real-time-web-search.p.rapidapi.com',\n  docsURL: 'https://rapidapi.com/letscrape-6bRBa3QguO5/api/real-time-web-search',\n  credentialsSetupURL: 'https://rapidapi.com/developer/dashboard',\n  category: 'search',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'RapidAPI Key',\n      type: 'api_key',\n      description: 'RapidAPI key for web search. Subscribe at rapidapi.com',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'X-RapidAPI-Key',\n        headerPrefix: '',\n      },\n    },\n  ],\n};\n","/**\n * Scrape Vendor Templates (ZenRows)\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const zenrowsTemplate: VendorTemplate = {\n  id: 'zenrows',\n  name: 'ZenRows',\n  serviceType: 'zenrows',\n  baseURL: 'https://api.zenrows.com/v1',\n  docsURL: 'https://docs.zenrows.com/universal-scraper-api/api-reference',\n  credentialsSetupURL: 'https://www.zenrows.com/register',\n  category: 'scrape',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'API Key',\n      type: 'api_key',\n      description: 'ZenRows API key for web scraping. Get at zenrows.com dashboard',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n  ],\n};\n","/**\n * Other Vendor Templates (Twilio, Zendesk, Intercom, Shopify)\n */\nimport type { VendorTemplate } from '../types.js';\n\nexport const twilioTemplate: VendorTemplate = {\n  id: 'twilio',\n  name: 'Twilio',\n  serviceType: 'twilio',\n  baseURL: 'https://api.twilio.com/2010-04-01',\n  docsURL: 'https://www.twilio.com/docs/usage/api',\n  credentialsSetupURL: 'https://console.twilio.com/us1/account/keys-credentials/api-keys',\n  category: 'other',\n\n  authTemplates: [\n    {\n      id: 'api-key',\n      name: 'Account SID + Auth Token',\n      type: 'api_key',\n      description: 'Account credentials for Basic Auth. Find at console.twilio.com',\n      requiredFields: ['apiKey', 'accountId'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Basic',\n      },\n    },\n    {\n      id: 'api-key-sid',\n      name: 'API Key + Secret',\n      type: 'api_key',\n      description: 'API key credentials (recommended). Create at Console > API Keys',\n      requiredFields: ['apiKey', 'applicationKey', 'accountId'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Basic',\n      },\n    },\n  ],\n};\n\nexport const zendeskTemplate: VendorTemplate = {\n  id: 'zendesk',\n  name: 'Zendesk',\n  serviceType: 'zendesk',\n  baseURL: 'https://your-subdomain.zendesk.com/api/v2',\n  docsURL: 'https://developer.zendesk.com/api-reference/',\n  credentialsSetupURL: 'https://support.zendesk.com/hc/en-us/articles/4408889192858',\n  category: 'other',\n  notes: 'Replace \"your-subdomain\" in baseURL with your Zendesk subdomain',\n\n  authTemplates: [\n    {\n      id: 'api-token',\n      name: 'API Token',\n      type: 'api_key',\n      description: 'API token with email/token for Basic Auth. Create at Admin > Channels > API',\n      requiredFields: ['apiKey', 'username'],\n      optionalFields: ['subdomain'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Basic',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (User Authorization)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth client for user authorization. Create at Admin > Channels > API > OAuth Clients. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri', 'subdomain'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://{subdomain}.zendesk.com/oauth/authorizations/new',\n        tokenUrl: 'https://{subdomain}.zendesk.com/oauth/tokens',\n        usePKCE: true,\n      },\n      scopes: ['read', 'write', 'tickets:read', 'tickets:write'],\n      scopeDescriptions: {\n        'read': 'Read all resources',\n        'write': 'Create and update resources',\n        'tickets:read': 'Read support tickets',\n        'tickets:write': 'Create and update tickets',\n      },\n    },\n  ],\n};\n\nexport const intercomTemplate: VendorTemplate = {\n  id: 'intercom',\n  name: 'Intercom',\n  serviceType: 'intercom',\n  baseURL: 'https://api.intercom.io',\n  docsURL: 'https://developers.intercom.com/docs/',\n  credentialsSetupURL: 'https://developers.intercom.com/docs/build-an-integration',\n  category: 'other',\n\n  authTemplates: [\n    {\n      id: 'access-token',\n      name: 'Access Token',\n      type: 'api_key',\n      description: 'Access token for API access. Create app at app.intercom.com/developers',\n      requiredFields: ['apiKey'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'Authorization',\n        headerPrefix: 'Bearer',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (App Installation)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth for Intercom app marketplace distribution. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri'],\n      optionalFields: ['clientSecret'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://app.intercom.com/oauth',\n        tokenUrl: 'https://api.intercom.io/auth/eagle/token',\n        usePKCE: true,\n      },\n    },\n  ],\n};\n\nexport const shopifyTemplate: VendorTemplate = {\n  id: 'shopify',\n  name: 'Shopify',\n  serviceType: 'shopify',\n  baseURL: 'https://your-store.myshopify.com/admin/api/2024-01',\n  docsURL: 'https://shopify.dev/docs/api',\n  credentialsSetupURL: 'https://partners.shopify.com/',\n  category: 'other',\n  notes: 'Replace \"your-store\" in baseURL with your store name',\n\n  authTemplates: [\n    {\n      id: 'access-token',\n      name: 'Admin API Access Token',\n      type: 'api_key',\n      description: 'Private app access token. Create custom app at your-store.myshopify.com/admin/apps',\n      requiredFields: ['apiKey'],\n      optionalFields: ['subdomain'],\n      defaults: {\n        type: 'api_key',\n        headerName: 'X-Shopify-Access-Token',\n        headerPrefix: '',\n      },\n    },\n    {\n      id: 'oauth-user',\n      name: 'OAuth (Public/Custom App)',\n      type: 'oauth',\n      flow: 'authorization_code',\n      description: 'OAuth for public apps or per-store custom apps. Create at partners.shopify.com. Provide clientSecret for web apps; omit for native/desktop apps (secured via PKCE).',\n      requiredFields: ['clientId', 'redirectUri', 'subdomain'],\n      optionalFields: ['clientSecret', 'scope'],\n      defaults: {\n        type: 'oauth',\n        flow: 'authorization_code',\n        authorizationUrl: 'https://{subdomain}.myshopify.com/admin/oauth/authorize',\n        tokenUrl: 'https://{subdomain}.myshopify.com/admin/oauth/access_token',\n        usePKCE: true,\n      },\n      scopes: ['read_products', 'write_products', 'read_orders', 'write_orders', 'read_customers', 'write_customers', 'read_inventory', 'write_inventory', 'read_fulfillments', 'write_fulfillments'],\n      scopeDescriptions: {\n        'read_products': 'Read products and collections',\n        'write_products': 'Create and update products',\n        'read_orders': 'Read orders and transactions',\n        'write_orders': 'Create and update orders',\n        'read_customers': 'Read customer information',\n        'write_customers': 'Create and update customers',\n        'read_inventory': 'Read inventory levels',\n        'write_inventory': 'Update inventory levels',\n        'read_fulfillments': 'Read fulfillment data',\n        'write_fulfillments': 'Create and update fulfillments',\n      },\n    },\n  ],\n};\n","/**\n * Vendor Templates - Re-export all templates\n *\n * This file exports all vendor templates for use by the registry generator\n * and for direct access.\n */\n\n// Major Vendors (unified)\nexport { microsoftTemplate } from './microsoft.js';\nexport { googleTemplate } from './google.js';\n\n// Communication\nexport { slackTemplate } from './slack.js';\nexport { discordTemplate } from './discord.js';\nexport { telegramTemplate } from './telegram.js';\nexport { twitterTemplate } from './twitter.js';\n\n// Development\nexport { githubTemplate } from './github.js';\nexport { gitlabTemplate } from './gitlab.js';\nexport { jiraTemplate, confluenceTemplate, bitbucketTemplate, trelloTemplate } from './atlassian.js';\nexport { linearTemplate } from './linear.js';\nexport { asanaTemplate } from './asana.js';\n\n// Productivity\nexport { notionTemplate } from './notion.js';\nexport { airtableTemplate } from './airtable.js';\n\n// CRM\nexport { salesforceTemplate } from './salesforce.js';\nexport { hubspotTemplate } from './hubspot.js';\nexport { pipedriveTemplate } from './pipedrive.js';\n\n// Payments\nexport { stripeTemplate } from './stripe.js';\nexport { paypalTemplate } from './paypal.js';\nexport { quickbooksTemplate } from './quickbooks.js';\nexport { rampTemplate } from './ramp.js';\n\n// Cloud\nexport { awsTemplate } from './aws.js';\n\n// Storage\nexport { dropboxTemplate } from './dropbox.js';\nexport { boxTemplate } from './box.js';\n\n// Email\nexport { sendgridTemplate, mailchimpTemplate, postmarkTemplate } from './email.js';\n\n// Monitoring\nexport { datadogTemplate, pagerdutyTemplate, sentryTemplate } from './monitoring.js';\n\n// Search\nexport {\n  serperTemplate,\n  braveSearchTemplate,\n  tavilyTemplate,\n  rapidapiSearchTemplate,\n} from './search.js';\n\n// Scrape\nexport { zenrowsTemplate } from './scrape.js';\n\n// Other\nexport { twilioTemplate, zendeskTemplate, intercomTemplate, shopifyTemplate } from './other.js';\n\n// Legacy exports (backward compatibility)\nexport {\n  microsoft365Template,\n  microsoftTeamsTemplate,\n  azureTemplate,\n  onedriveTemplate,\n} from './microsoft.js';\nexport { googleWorkspaceTemplate, googleDriveTemplate, gcpTemplate } from './google.js';\n\n/**\n * Array of all vendor templates\n * Used by the registry generator\n */\nimport { microsoftTemplate } from './microsoft.js';\nimport { googleTemplate } from './google.js';\nimport { slackTemplate } from './slack.js';\nimport { discordTemplate } from './discord.js';\nimport { telegramTemplate } from './telegram.js';\nimport { twitterTemplate } from './twitter.js';\nimport { githubTemplate } from './github.js';\nimport { gitlabTemplate } from './gitlab.js';\nimport { jiraTemplate, confluenceTemplate, bitbucketTemplate, trelloTemplate } from './atlassian.js';\nimport { linearTemplate } from './linear.js';\nimport { asanaTemplate } from './asana.js';\nimport { notionTemplate } from './notion.js';\nimport { airtableTemplate } from './airtable.js';\nimport { salesforceTemplate } from './salesforce.js';\nimport { hubspotTemplate } from './hubspot.js';\nimport { pipedriveTemplate } from './pipedrive.js';\nimport { stripeTemplate } from './stripe.js';\nimport { paypalTemplate } from './paypal.js';\nimport { quickbooksTemplate } from './quickbooks.js';\nimport { rampTemplate } from './ramp.js';\nimport { awsTemplate } from './aws.js';\nimport { dropboxTemplate } from './dropbox.js';\nimport { boxTemplate } from './box.js';\nimport { sendgridTemplate, mailchimpTemplate, postmarkTemplate } from './email.js';\nimport { datadogTemplate, pagerdutyTemplate, sentryTemplate } from './monitoring.js';\nimport {\n  serperTemplate,\n  braveSearchTemplate,\n  tavilyTemplate,\n  rapidapiSearchTemplate,\n} from './search.js';\nimport { zenrowsTemplate } from './scrape.js';\nimport { twilioTemplate, zendeskTemplate, intercomTemplate, shopifyTemplate } from './other.js';\nimport type { VendorTemplate } from '../types.js';\n\nexport const allVendorTemplates: VendorTemplate[] = [\n  // Major Vendors (first for visibility)\n  microsoftTemplate,\n  googleTemplate,\n\n  // Communication\n  slackTemplate,\n  discordTemplate,\n  telegramTemplate,\n  twitterTemplate,\n\n  // Development\n  githubTemplate,\n  gitlabTemplate,\n  bitbucketTemplate,\n  jiraTemplate,\n  linearTemplate,\n  asanaTemplate,\n  trelloTemplate,\n\n  // Productivity\n  notionTemplate,\n  airtableTemplate,\n  confluenceTemplate,\n\n  // CRM\n  salesforceTemplate,\n  hubspotTemplate,\n  pipedriveTemplate,\n\n  // Payments\n  stripeTemplate,\n  paypalTemplate,\n  quickbooksTemplate,\n  rampTemplate,\n\n  // Cloud\n  awsTemplate,\n\n  // Storage\n  dropboxTemplate,\n  boxTemplate,\n\n  // Email\n  sendgridTemplate,\n  mailchimpTemplate,\n  postmarkTemplate,\n\n  // Monitoring\n  datadogTemplate,\n  pagerdutyTemplate,\n  sentryTemplate,\n\n  // Search\n  serperTemplate,\n  braveSearchTemplate,\n  tavilyTemplate,\n  rapidapiSearchTemplate,\n\n  // Scrape\n  zenrowsTemplate,\n\n  // Other\n  twilioTemplate,\n  zendeskTemplate,\n  intercomTemplate,\n  shopifyTemplate,\n];\n","/**\n * Vendor Logo Utilities\n *\n * Provides access to vendor logos using the simple-icons package.\n * All icons are SVG format and can be customized with colors.\n */\n\nimport * as simpleIcons from 'simple-icons';\n\n/** Simple Icons icon data structure */\nexport interface SimpleIcon {\n  title: string;\n  slug: string;\n  svg: string;\n  path: string;\n  source: string;\n  hex: string;\n  guidelines?: string;\n  license?: {\n    type: string;\n    url?: string;\n  };\n}\n\n/** Mapping from our vendor IDs to Simple Icons slugs */\nexport const VENDOR_ICON_MAP: Record<string, string | null> = {\n  // Major Vendors (unified)\n  microsoft: 'microsoft',\n  google: 'google',\n\n  // Cloud\n  aws: 'amazonwebservices',\n  azure: 'microsoftazure',\n  gcp: 'googlecloud',\n\n  // Communication\n  discord: 'discord',\n  slack: 'slack',\n  telegram: 'telegram',\n  twitter: 'x',\n  'microsoft-teams': 'microsoftteams',\n\n  // CRM\n  salesforce: 'salesforce',\n  hubspot: 'hubspot',\n  pipedrive: 'pipedrive',\n\n  // Development\n  github: 'github',\n  gitlab: 'gitlab',\n  bitbucket: 'bitbucket',\n  jira: 'jira',\n  confluence: 'confluence',\n  trello: 'trello',\n  linear: 'linear',\n  asana: 'asana',\n\n  // Productivity\n  notion: 'notion',\n  airtable: 'airtable',\n  'google-workspace': 'google',\n  'google-drive': 'googledrive',\n  'microsoft-365': 'microsoft365',\n  onedrive: 'onedrive',\n\n  // Payments\n  stripe: 'stripe',\n  paypal: 'paypal',\n  quickbooks: 'quickbooks',\n  ramp: null, // No Simple Icon available\n\n  // Email\n  sendgrid: 'sendgrid',\n  mailchimp: 'mailchimp',\n  postmark: 'postmark',\n\n  // Storage\n  dropbox: 'dropbox',\n  box: 'box',\n\n  // Monitoring\n  datadog: 'datadog',\n  pagerduty: 'pagerduty',\n  sentry: 'sentry',\n\n  // Search\n  serper: null, // No Simple Icon available\n  'brave-search': 'brave',\n  tavily: null, // No Simple Icon available\n  rapidapi: 'rapidapi',\n\n  // Scrape\n  zenrows: null, // No Simple Icon available\n\n  // Other\n  twilio: 'twilio',\n  zendesk: 'zendesk',\n  intercom: 'intercom',\n  shopify: 'shopify',\n};\n\n/** Fallback placeholder configs for vendors without Simple Icons (or removed due to trademark) */\nconst FALLBACK_PLACEHOLDERS: Record<string, { color: string; letter: string }> = {\n  // Major Vendors (fallbacks in case Simple Icons doesn't work)\n  microsoft: { color: '#00A4EF', letter: 'M' },\n  google: { color: '#4285F4', letter: 'G' },\n\n  // Cloud (trademark removed from Simple Icons)\n  aws: { color: '#FF9900', letter: 'A' },\n  azure: { color: '#0078D4', letter: 'A' },\n\n  // Communication (trademark removed)\n  slack: { color: '#4A154B', letter: 'S' },\n  'microsoft-teams': { color: '#6264A7', letter: 'T' },\n  twitter: { color: '#000000', letter: 'X' },\n\n  // CRM (trademark removed)\n  salesforce: { color: '#00A1E0', letter: 'S' },\n  pipedrive: { color: '#1A1F26', letter: 'P' },\n\n  // Productivity (trademark removed)\n  'microsoft-365': { color: '#D83B01', letter: 'M' },\n  onedrive: { color: '#0078D4', letter: 'O' },\n\n  // Email (trademark removed)\n  sendgrid: { color: '#1A82E2', letter: 'S' },\n  postmark: { color: '#FFDE00', letter: 'P' },\n\n  // Payments (no Simple Icon available)\n  ramp: { color: '#F2C94C', letter: 'R' },\n\n  // Search (no Simple Icon available)\n  serper: { color: '#4A90A4', letter: 'S' },\n  tavily: { color: '#7C3AED', letter: 'T' },\n  rapidapi: { color: '#0055DA', letter: 'R' },\n\n  // Scrape (no Simple Icon available)\n  zenrows: { color: '#00D4AA', letter: 'Z' },\n\n  // Other (trademark removed)\n  twilio: { color: '#F22F46', letter: 'T' },\n};\n\n/**\n * Convert slug to Simple Icons key format (e.g., 'amazonwebservices' -> 'siAmazonwebservices')\n */\nfunction slugToKey(slug: string): string {\n  return `si${slug.charAt(0).toUpperCase()}${slug.slice(1)}`;\n}\n\n/**\n * Get the Simple Icon for a slug\n */\nfunction getSimpleIcon(slug: string): SimpleIcon | undefined {\n  const key = slugToKey(slug);\n  return (simpleIcons as Record<string, SimpleIcon>)[key];\n}\n\n/**\n * Generate a placeholder SVG for vendors without official icons\n */\nfunction generatePlaceholderSvg(letter: string, color: string): string {\n  return `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><rect width=\"24\" height=\"24\" rx=\"4\" fill=\"${color}\"/><text x=\"12\" y=\"17\" font-family=\"system-ui, sans-serif\" font-size=\"14\" font-weight=\"600\" fill=\"white\" text-anchor=\"middle\">${letter}</text></svg>`;\n}\n\n/**\n * Vendor logo information\n */\nexport interface VendorLogo {\n  /** Vendor ID */\n  vendorId: string;\n  /** SVG content */\n  svg: string;\n  /** Brand color (hex without #) */\n  hex: string;\n  /** Whether this is a placeholder (no official icon) */\n  isPlaceholder: boolean;\n  /** Simple Icons slug (if available) */\n  simpleIconsSlug?: string;\n}\n\n/**\n * Check if a vendor has a logo available\n */\nexport function hasVendorLogo(vendorId: string): boolean {\n  const slug = VENDOR_ICON_MAP[vendorId];\n  if (slug === undefined) {\n    return false;\n  }\n  // Check Simple Icons first, fall back to placeholder\n  if (slug !== null && getSimpleIcon(slug)) {\n    return true;\n  }\n  return vendorId in FALLBACK_PLACEHOLDERS;\n}\n\n/**\n * Get logo for a vendor\n *\n * @param vendorId - The vendor ID (e.g., 'github', 'slack')\n * @returns VendorLogo object or undefined if not available\n *\n * @example\n * ```typescript\n * const logo = getVendorLogo('github');\n * if (logo) {\n *   console.log(logo.svg);  // SVG content\n *   console.log(logo.hex);  // Brand color\n * }\n * ```\n */\nexport function getVendorLogo(vendorId: string): VendorLogo | undefined {\n  const slug = VENDOR_ICON_MAP[vendorId];\n\n  // Unknown vendor\n  if (slug === undefined) {\n    return undefined;\n  }\n\n  // Try Simple Icons first (if slug is not null)\n  if (slug !== null) {\n    const icon = getSimpleIcon(slug);\n    if (icon) {\n      return {\n        vendorId,\n        svg: icon.svg,\n        hex: icon.hex,\n        isPlaceholder: false,\n        simpleIconsSlug: slug,\n      };\n    }\n  }\n\n  // Fall back to placeholder (for trademark-removed icons or icons marked as null)\n  const fallback = FALLBACK_PLACEHOLDERS[vendorId];\n  if (fallback) {\n    return {\n      vendorId,\n      svg: generatePlaceholderSvg(fallback.letter, fallback.color),\n      hex: fallback.color.replace('#', ''),\n      isPlaceholder: true,\n    };\n  }\n\n  return undefined;\n}\n\n/**\n * Get SVG content for a vendor logo\n *\n * @param vendorId - The vendor ID\n * @param color - Optional color override (hex without #)\n * @returns SVG string or undefined\n */\nexport function getVendorLogoSvg(vendorId: string, color?: string): string | undefined {\n  const logo = getVendorLogo(vendorId);\n  if (!logo) return undefined;\n\n  if (color && !logo.isPlaceholder) {\n    // Replace fill color in SVG\n    return logo.svg.replace(/fill=\"[^\"]*\"/g, `fill=\"#${color}\"`);\n  }\n\n  return logo.svg;\n}\n\n/**\n * Get the brand color for a vendor\n *\n * @param vendorId - The vendor ID\n * @returns Hex color string (without #) or undefined\n */\nexport function getVendorColor(vendorId: string): string | undefined {\n  const logo = getVendorLogo(vendorId);\n  return logo?.hex;\n}\n\n/**\n * Get all available vendor logos\n *\n * @returns Map of vendor ID to VendorLogo\n */\nexport function getAllVendorLogos(): Map<string, VendorLogo> {\n  const logos = new Map<string, VendorLogo>();\n\n  for (const vendorId of Object.keys(VENDOR_ICON_MAP)) {\n    const logo = getVendorLogo(vendorId);\n    if (logo) {\n      logos.set(vendorId, logo);\n    }\n  }\n\n  return logos;\n}\n\n/**\n * List vendor IDs that have logos available\n */\nexport function listVendorsWithLogos(): string[] {\n  return Object.keys(VENDOR_ICON_MAP).filter(hasVendorLogo);\n}\n\n/**\n * CDN URL for Simple Icons (useful for web applications)\n */\nexport const SIMPLE_ICONS_CDN = 'https://cdn.simpleicons.org';\n\n/**\n * Get CDN URL for a vendor's logo\n *\n * @param vendorId - The vendor ID\n * @param color - Optional color (hex without #)\n * @returns CDN URL or undefined if vendor doesn't have a Simple Icons entry\n */\nexport function getVendorLogoCdnUrl(vendorId: string, color?: string): string | undefined {\n  const slug = VENDOR_ICON_MAP[vendorId];\n  if (!slug) return undefined;\n\n  if (color) {\n    return `${SIMPLE_ICONS_CDN}/${slug}/${color}`;\n  }\n  return `${SIMPLE_ICONS_CDN}/${slug}`;\n}\n","/**\n * Vendor Templates - Main Export\n *\n * Pre-configured authentication templates for 40+ common services.\n * Use createConnectorFromTemplate() for easy connector setup.\n *\n * @example\n * ```typescript\n * import {\n *   createConnectorFromTemplate,\n *   listVendors,\n *   getVendorTemplate,\n * } from '@everworker/oneringai';\n *\n * // List all available vendors\n * const vendors = listVendors();\n *\n * // Create a GitHub connector with PAT\n * const connector = createConnectorFromTemplate(\n *   'my-github',\n *   'github',\n *   'pat',\n *   { apiKey: process.env.GITHUB_TOKEN }\n * );\n *\n * // Get tools for the connector\n * const tools = getConnectorTools('my-github');\n * ```\n */\n\n// Types\nexport type {\n  VendorTemplate,\n  AuthTemplate,\n  AuthTemplateField,\n  VendorRegistryEntry,\n  TemplateCredentials,\n  CreateConnectorOptions,\n} from './types.js';\n\n// Helpers\nexport {\n  createConnectorFromTemplate,\n  getConnectorTools,\n  getVendorTemplate,\n  getVendorAuthTemplate,\n  getAllVendorTemplates,\n  listVendorIds,\n  listVendors,\n  listVendorsByCategory,\n  listVendorsByAuthType,\n  getVendorInfo,\n  getCredentialsSetupURL,\n  getDocsURL,\n  buildAuthConfig,\n  initVendorRegistry,\n} from './helpers.js';\nexport type { VendorInfo } from './helpers.js';\n\n// All templates\nexport { allVendorTemplates } from './templates/index.js';\n\n// Individual templates for direct access\nexport * from './templates/index.js';\n\n// Logo utilities\nexport {\n  getVendorLogo,\n  getVendorLogoSvg,\n  getVendorColor,\n  getVendorLogoCdnUrl,\n  hasVendorLogo,\n  getAllVendorLogos,\n  listVendorsWithLogos,\n  VENDOR_ICON_MAP,\n  SIMPLE_ICONS_CDN,\n} from './logos.js';\nexport type { VendorLogo, SimpleIcon } from './logos.js';\n\n// Auto-register templates on import\nimport { initVendorRegistry } from './helpers.js';\nimport { allVendorTemplates } from './templates/index.js';\n\n// Initialize registry with all templates\ninitVendorRegistry(allVendorTemplates);\n","/**\n * Resilience infrastructure exports\n */\n\nexport { CircuitBreaker, CircuitOpenError } from './CircuitBreaker.js';\nexport type {\n  CircuitState,\n  CircuitBreakerConfig,\n  CircuitBreakerMetrics,\n  CircuitBreakerEvents,\n} from './CircuitBreaker.js';\nexport { DEFAULT_CIRCUIT_BREAKER_CONFIG } from './CircuitBreaker.js';\n\nexport {\n  calculateBackoff,\n  addJitter,\n  backoffWait,\n  backoffSequence,\n  retryWithBackoff,\n} from './BackoffStrategy.js';\nexport type { BackoffConfig, BackoffStrategyType } from './BackoffStrategy.js';\nexport { DEFAULT_BACKOFF_CONFIG } from './BackoffStrategy.js';\n\nexport { TokenBucketRateLimiter, RateLimitError } from './RateLimiter.js';\nexport type { RateLimiterConfig, RateLimiterMetrics } from './RateLimiter.js';\nexport { DEFAULT_RATE_LIMITER_CONFIG } from './RateLimiter.js';\n","/**\n * Token bucket rate limiter for LLM calls\n *\n * Implements a sliding window rate limiter to prevent hitting provider rate limits\n * during intensive plan execution.\n */\n\nimport { AIError } from '../../domain/errors/AIErrors.js';\n\n/**\n * Error thrown when rate limit is exceeded and onLimit is 'throw'\n */\nexport class RateLimitError extends AIError {\n  constructor(\n    public readonly retryAfterMs: number,\n    message?: string\n  ) {\n    super(message ?? `Rate limited. Retry after ${retryAfterMs}ms`, 'RATE_LIMIT_ERROR', 429);\n    this.name = 'RateLimitError';\n    Object.setPrototypeOf(this, RateLimitError.prototype);\n  }\n}\n\n/**\n * Configuration for the rate limiter\n */\nexport interface RateLimiterConfig {\n  /** Max requests allowed in window */\n  maxRequests: number;\n\n  /** Time window in ms (default: 60000 = 1 minute) */\n  windowMs?: number;\n\n  /** What to do when rate limited */\n  onLimit: 'wait' | 'throw';\n\n  /** Max wait time in ms (for 'wait' mode, default: 60000) */\n  maxWaitMs?: number;\n}\n\n/**\n * Default rate limiter configuration\n */\nexport const DEFAULT_RATE_LIMITER_CONFIG: Required<RateLimiterConfig> = {\n  maxRequests: 60,\n  windowMs: 60000,\n  onLimit: 'wait',\n  maxWaitMs: 60000,\n};\n\n/**\n * Rate limiter metrics\n */\nexport interface RateLimiterMetrics {\n  /** Total requests made */\n  totalRequests: number;\n  /** Total requests throttled */\n  throttledRequests: number;\n  /** Total wait time in ms */\n  totalWaitMs: number;\n  /** Average wait time in ms */\n  avgWaitMs: number;\n}\n\n/**\n * Token bucket rate limiter implementation\n *\n * Uses a sliding window approach where tokens are refilled completely\n * when the time window expires.\n */\nexport class TokenBucketRateLimiter {\n  private tokens: number;\n  private lastRefill: number;\n  private readonly config: Required<RateLimiterConfig>;\n  private waitQueue: Array<{\n    resolve: () => void;\n    reject: (e: Error) => void;\n    timeout?: ReturnType<typeof setTimeout>;\n  }> = [];\n\n  // Metrics\n  private totalRequests = 0;\n  private throttledRequests = 0;\n  private totalWaitMs = 0;\n\n  constructor(config: Partial<RateLimiterConfig> = {}) {\n    this.config = {\n      maxRequests: config.maxRequests ?? DEFAULT_RATE_LIMITER_CONFIG.maxRequests,\n      windowMs: config.windowMs ?? DEFAULT_RATE_LIMITER_CONFIG.windowMs,\n      onLimit: config.onLimit ?? DEFAULT_RATE_LIMITER_CONFIG.onLimit,\n      maxWaitMs: config.maxWaitMs ?? DEFAULT_RATE_LIMITER_CONFIG.maxWaitMs,\n    };\n    this.tokens = this.config.maxRequests;\n    this.lastRefill = Date.now();\n  }\n\n  /**\n   * Acquire a token (request permission to make an LLM call)\n   * @returns Promise that resolves when token is acquired\n   * @throws RateLimitError if onLimit='throw' and no tokens available\n   */\n  async acquire(): Promise<void> {\n    this.totalRequests++;\n    this.refill();\n\n    if (this.tokens > 0) {\n      this.tokens--;\n      return;\n    }\n\n    // No tokens available\n    this.throttledRequests++;\n    const waitTime = this.getWaitTime();\n\n    if (this.config.onLimit === 'throw') {\n      throw new RateLimitError(waitTime);\n    }\n\n    // Wait mode\n    if (waitTime > this.config.maxWaitMs) {\n      throw new RateLimitError(\n        waitTime,\n        `Wait time ${waitTime}ms exceeds max ${this.config.maxWaitMs}ms`\n      );\n    }\n\n    const startWait = Date.now();\n    await this.waitForToken(waitTime);\n    this.totalWaitMs += Date.now() - startWait;\n  }\n\n  /**\n   * Try to acquire without waiting\n   * @returns true if acquired, false if rate limited\n   */\n  tryAcquire(): boolean {\n    this.totalRequests++;\n    this.refill();\n    if (this.tokens > 0) {\n      this.tokens--;\n      return true;\n    }\n    this.throttledRequests++;\n    return false;\n  }\n\n  /**\n   * Get current available tokens\n   */\n  getAvailableTokens(): number {\n    this.refill();\n    return this.tokens;\n  }\n\n  /**\n   * Get time until next token is available\n   */\n  getWaitTime(): number {\n    this.refill();\n    if (this.tokens > 0) return 0;\n\n    const elapsed = Date.now() - this.lastRefill;\n    return Math.max(0, this.config.windowMs - elapsed);\n  }\n\n  /**\n   * Get rate limiter metrics\n   */\n  getMetrics(): RateLimiterMetrics {\n    return {\n      totalRequests: this.totalRequests,\n      throttledRequests: this.throttledRequests,\n      totalWaitMs: this.totalWaitMs,\n      avgWaitMs: this.throttledRequests > 0 ? this.totalWaitMs / this.throttledRequests : 0,\n    };\n  }\n\n  /**\n   * Reset the rate limiter state\n   */\n  reset(): void {\n    this.tokens = this.config.maxRequests;\n    this.lastRefill = Date.now();\n\n    // Clear all waiting requests\n    for (const waiter of this.waitQueue) {\n      if (waiter.timeout) {\n        clearTimeout(waiter.timeout);\n      }\n    }\n    this.waitQueue = [];\n  }\n\n  /**\n   * Reset metrics\n   */\n  resetMetrics(): void {\n    this.totalRequests = 0;\n    this.throttledRequests = 0;\n    this.totalWaitMs = 0;\n  }\n\n  /**\n   * Get the current configuration\n   */\n  getConfig(): Required<RateLimiterConfig> {\n    return { ...this.config };\n  }\n\n  /**\n   * Refill tokens if window has expired\n   */\n  private refill(): void {\n    const now = Date.now();\n    const elapsed = now - this.lastRefill;\n\n    if (elapsed >= this.config.windowMs) {\n      // Full refill\n      this.tokens = this.config.maxRequests;\n      this.lastRefill = now;\n\n      // Process waiting requests\n      this.processWaitQueue();\n    }\n  }\n\n  /**\n   * Wait for a token to become available\n   */\n  private async waitForToken(waitTime: number): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        // Remove from queue\n        const index = this.waitQueue.findIndex((w) => w.timeout === timeout);\n        if (index !== -1) {\n          this.waitQueue.splice(index, 1);\n        }\n\n        // Try to acquire after wait\n        this.refill();\n        if (this.tokens > 0) {\n          this.tokens--;\n          resolve();\n        } else {\n          // Still no tokens, this shouldn't happen but handle gracefully\n          reject(new RateLimitError(this.getWaitTime(), 'Token still unavailable after wait'));\n        }\n      }, waitTime);\n\n      this.waitQueue.push({ resolve, reject, timeout });\n    });\n  }\n\n  /**\n   * Process waiting requests when tokens become available\n   */\n  private processWaitQueue(): void {\n    while (this.waitQueue.length > 0 && this.tokens > 0) {\n      const waiter = this.waitQueue.shift();\n      if (waiter) {\n        if (waiter.timeout) {\n          clearTimeout(waiter.timeout);\n        }\n        this.tokens--;\n        waiter.resolve();\n      }\n    }\n  }\n}\n","/**\n * Observability infrastructure exports\n */\n\nexport { FrameworkLogger, logger } from './Logger.js';\nexport type { LogLevel, LoggerConfig, LogEntry } from './Logger.js';\n\nexport {\n  NoOpMetrics,\n  ConsoleMetrics,\n  InMemoryMetrics,\n  createMetricsCollector,\n  metrics,\n  setMetricsCollector,\n} from './Metrics.js';\nexport type { MetricsCollector, MetricTags, MetricsCollectorType } from './Metrics.js';\n","/**\n * Message builder utilities for constructing complex inputs\n */\n\nimport { InputItem, MessageRole } from '../domain/entities/Message.js';\nimport {\n  ContentType,\n  InputTextContent,\n  InputImageContent,\n} from '../domain/entities/Content.js';\n\nexport class MessageBuilder {\n  private messages: InputItem[] = [];\n\n  /**\n   * Add a user text message\n   */\n  addUserMessage(text: string): this {\n    this.messages.push({\n      type: 'message',\n      role: MessageRole.USER,\n      content: [\n        {\n          type: ContentType.INPUT_TEXT,\n          text,\n        },\n      ],\n    });\n    return this;\n  }\n\n  /**\n   * Add a user message with text and images\n   */\n  addUserMessageWithImages(text: string, imageUrls: string[]): this {\n    const content: (InputTextContent | InputImageContent)[] = [\n      {\n        type: ContentType.INPUT_TEXT,\n        text,\n      },\n    ];\n\n    // Add images\n    for (const url of imageUrls) {\n      content.push({\n        type: ContentType.INPUT_IMAGE_URL,\n        image_url: {\n          url,\n          detail: 'auto', // Can be 'auto', 'low', or 'high'\n        },\n      });\n    }\n\n    this.messages.push({\n      type: 'message',\n      role: MessageRole.USER,\n      content,\n    });\n\n    return this;\n  }\n\n  /**\n   * Add an assistant message (for conversation history)\n   */\n  addAssistantMessage(text: string): this {\n    this.messages.push({\n      type: 'message',\n      role: MessageRole.ASSISTANT,\n      content: [\n        {\n          type: ContentType.OUTPUT_TEXT,\n          text,\n          annotations: [],\n        },\n      ],\n    });\n    return this;\n  }\n\n  /**\n   * Add a system/developer message\n   */\n  addDeveloperMessage(text: string): this {\n    this.messages.push({\n      type: 'message',\n      role: MessageRole.DEVELOPER,\n      content: [\n        {\n          type: ContentType.INPUT_TEXT,\n          text,\n        },\n      ],\n    });\n    return this;\n  }\n\n  /**\n   * Build and return the messages array\n   */\n  build(): InputItem[] {\n    return this.messages;\n  }\n\n  /**\n   * Clear all messages\n   */\n  clear(): this {\n    this.messages = [];\n    return this;\n  }\n\n  /**\n   * Get the current message count\n   */\n  count(): number {\n    return this.messages.length;\n  }\n}\n\n/**\n * Helper function to create a simple text message\n */\nexport function createTextMessage(text: string, role: MessageRole = MessageRole.USER): InputItem {\n  return {\n    type: 'message',\n    role,\n    content: [\n      {\n        type: ContentType.INPUT_TEXT,\n        text,\n      },\n    ],\n  };\n}\n\n/**\n * Helper function to create a message with images\n */\nexport function createMessageWithImages(\n  text: string,\n  imageUrls: string[],\n  role: MessageRole = MessageRole.USER\n): InputItem {\n  const content: (InputTextContent | InputImageContent)[] = [\n    {\n      type: ContentType.INPUT_TEXT,\n      text,\n    },\n  ];\n\n  for (const url of imageUrls) {\n    content.push({\n      type: ContentType.INPUT_IMAGE_URL,\n      image_url: {\n        url,\n        detail: 'auto',\n      },\n    });\n  }\n\n  return {\n    type: 'message',\n    role,\n    content,\n  };\n}\n","/**\n * Clipboard image utilities\n * Reads images from clipboard (supports Mac, Linux, Windows)\n */\n\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\nimport * as fs from 'fs';\nimport * as os from 'os';\nimport * as path from 'path';\n\nconst execAsync = promisify(exec);\n\n/**\n * Safely clean up a temp file, ignoring errors\n */\nfunction cleanupTempFile(filePath: string): void {\n  try {\n    if (fs.existsSync(filePath)) {\n      fs.unlinkSync(filePath);\n    }\n  } catch {\n    // Ignore cleanup errors - temp directory will eventually clean up\n  }\n}\n\nexport interface ClipboardImageResult {\n  success: boolean;\n  dataUri?: string;\n  error?: string;\n  format?: string;\n}\n\n/**\n * Read image from clipboard and convert to data URI\n */\nexport async function readClipboardImage(): Promise<ClipboardImageResult> {\n  const platform = os.platform();\n\n  try {\n    switch (platform) {\n      case 'darwin': // macOS\n        return await readClipboardImageMac();\n      case 'linux':\n        return await readClipboardImageLinux();\n      case 'win32':\n        return await readClipboardImageWindows();\n      default:\n        return {\n          success: false,\n          error: `Unsupported platform: ${platform}`,\n        };\n    }\n  } catch (error: any) {\n    return {\n      success: false,\n      error: error.message,\n    };\n  }\n}\n\n/**\n * Read clipboard image on macOS\n */\nasync function readClipboardImageMac(): Promise<ClipboardImageResult> {\n  const tempFile = path.join(os.tmpdir(), `clipboard-${Date.now()}.png`);\n\n  try {\n    // Try pngpaste first (brew install pngpaste)\n    try {\n      await execAsync(`pngpaste \"${tempFile}\"`);\n      return await convertFileToDataUri(tempFile);\n    } catch (pngpasteError) {\n      // pngpaste not installed, try osascript\n      const script = `\n        set theFile to (POSIX file \"${tempFile}\")\n        try\n          set theImage to the clipboard as class PNGf\n          set fileRef to open for access theFile with write permission\n          write theImage to fileRef\n          close access fileRef\n          return \"success\"\n        on error errMsg\n          try\n            close access theFile\n          end try\n          error errMsg\n        end try\n      `;\n\n      const { stdout } = await execAsync(`osascript -e '${script}'`);\n\n      if (stdout.includes('success') || fs.existsSync(tempFile)) {\n        return await convertFileToDataUri(tempFile);\n      }\n\n      return {\n        success: false,\n        error: 'No image found in clipboard. Try copying an image first (Cmd+C or screenshot with Cmd+Ctrl+Shift+4)',\n      };\n    }\n  } finally {\n    // Always clean up temp file\n    cleanupTempFile(tempFile);\n  }\n}\n\n/**\n * Read clipboard image on Linux\n */\nasync function readClipboardImageLinux(): Promise<ClipboardImageResult> {\n  const tempFile = path.join(os.tmpdir(), `clipboard-${Date.now()}.png`);\n\n  try {\n    // Try xclip\n    try {\n      await execAsync(`xclip -selection clipboard -t image/png -o > \"${tempFile}\"`);\n      if (fs.existsSync(tempFile) && fs.statSync(tempFile).size > 0) {\n        return await convertFileToDataUri(tempFile);\n      }\n    } catch {\n      // xclip not available or failed\n    }\n\n    // Try wl-paste (Wayland)\n    try {\n      await execAsync(`wl-paste -t image/png > \"${tempFile}\"`);\n      if (fs.existsSync(tempFile) && fs.statSync(tempFile).size > 0) {\n        return await convertFileToDataUri(tempFile);\n      }\n    } catch {\n      // wl-paste not available or failed\n    }\n\n    return {\n      success: false,\n      error: 'No image in clipboard. Install xclip (X11) or wl-clipboard (Wayland)',\n    };\n  } finally {\n    // Always clean up temp file\n    cleanupTempFile(tempFile);\n  }\n}\n\n/**\n * Read clipboard image on Windows\n */\nasync function readClipboardImageWindows(): Promise<ClipboardImageResult> {\n  const tempFile = path.join(os.tmpdir(), `clipboard-${Date.now()}.png`);\n\n  try {\n    // PowerShell script to save clipboard image\n    const psScript = `\n      Add-Type -AssemblyName System.Windows.Forms;\n      $clip = [System.Windows.Forms.Clipboard]::GetImage();\n      if ($clip -ne $null) {\n        $clip.Save('${tempFile.replace(/\\\\/g, '\\\\\\\\')}', [System.Drawing.Imaging.ImageFormat]::Png);\n        Write-Output 'success';\n      } else {\n        Write-Error 'No image in clipboard';\n      }\n    `;\n\n    await execAsync(`powershell -Command \"${psScript}\"`);\n\n    if (fs.existsSync(tempFile) && fs.statSync(tempFile).size > 0) {\n      return await convertFileToDataUri(tempFile);\n    }\n\n    return {\n      success: false,\n      error: 'No image found in clipboard',\n    };\n  } finally {\n    // Always clean up temp file\n    cleanupTempFile(tempFile);\n  }\n}\n\n/**\n * Convert image file to data URI\n * Note: Caller is responsible for temp file cleanup via finally block\n */\nasync function convertFileToDataUri(filePath: string): Promise<ClipboardImageResult> {\n  try {\n    const imageBuffer = fs.readFileSync(filePath);\n    const base64Image = imageBuffer.toString('base64');\n\n    // Detect format from file\n    const magic = imageBuffer.slice(0, 4).toString('hex');\n    let mimeType = 'image/png';\n\n    if (magic.startsWith('89504e47')) {\n      mimeType = 'image/png';\n    } else if (magic.startsWith('ffd8ff')) {\n      mimeType = 'image/jpeg';\n    } else if (magic.startsWith('47494638')) {\n      mimeType = 'image/gif';\n    } else if (magic.startsWith('52494646')) {\n      mimeType = 'image/webp';\n    }\n\n    const dataUri = `data:${mimeType};base64,${base64Image}`;\n\n    return {\n      success: true,\n      dataUri,\n      format: mimeType,\n    };\n  } catch (error: any) {\n    return {\n      success: false,\n      error: error.message,\n    };\n  }\n}\n\n/**\n * Check if clipboard contains an image (quick check)\n */\nexport async function hasClipboardImage(): Promise<boolean> {\n  const platform = os.platform();\n\n  try {\n    switch (platform) {\n      case 'darwin':\n        // Check if clipboard has image data\n        const { stdout } = await execAsync('osascript -e \"clipboard info\"');\n        return stdout.includes('class PNGf') || stdout.includes('public.png');\n\n      case 'linux':\n        // Try xclip\n        try {\n          await execAsync('xclip -selection clipboard -t TARGETS -o | grep -q image');\n          return true;\n        } catch {\n          return false;\n        }\n\n      case 'win32':\n        // PowerShell check\n        const psCheck = `\n          Add-Type -AssemblyName System.Windows.Forms;\n          if ([System.Windows.Forms.Clipboard]::GetImage() -ne $null) {\n            Write-Output 'true'\n          } else {\n            Write-Output 'false'\n          }\n        `;\n        const { stdout: result } = await execAsync(`powershell -Command \"${psCheck}\"`);\n        return result.trim() === 'true';\n\n      default:\n        return false;\n    }\n  } catch {\n    return false;\n  }\n}\n","/**\n * Pre-built tools for agents\n *\n * Import and use with your agents:\n *\n * ```typescript\n * import { tools } from '@everworker/oneringai';\n *\n * const agent = Agent.create({\n *   connector: 'openai',\n *   model: 'gpt-4',\n *   tools: [\n *     // Filesystem tools\n *     tools.readFile,\n *     tools.writeFile,\n *     tools.editFile,\n *     tools.glob,\n *     tools.grep,\n *     tools.listDirectory,\n *     // Shell tools\n *     tools.bash,\n *     // Web tools\n *     tools.webFetch,\n *   ]\n * });\n * ```\n */\n\n// ============================================================================\n// Filesystem Tools\n// ============================================================================\n\nexport {\n  // Tools\n  readFile,\n  writeFile,\n  editFile,\n  glob,\n  grep,\n  listDirectory,\n  // Factory functions\n  createReadFileTool,\n  createWriteFileTool,\n  createEditFileTool,\n  createGlobTool,\n  createGrepTool,\n  createListDirectoryTool,\n  // Types and utilities\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n  isExcludedExtension,\n  expandTilde,\n} from './filesystem/index.js';\n\nexport type {\n  FilesystemToolConfig,\n  ReadFileResult,\n  WriteFileResult,\n  EditFileResult,\n  GlobResult,\n  GrepResult,\n  GrepMatch,\n} from './filesystem/index.js';\n\n// ============================================================================\n// Shell Tools\n// ============================================================================\n\nexport {\n  // Tools\n  bash,\n  // Factory functions\n  createBashTool,\n  // Utilities\n  getBackgroundOutput,\n  killBackgroundProcess,\n  // Config\n  DEFAULT_SHELL_CONFIG,\n  isBlockedCommand,\n} from './shell/index.js';\n\nexport type {\n  ShellToolConfig,\n  BashResult,\n} from './shell/index.js';\n\n// ============================================================================\n// JSON Tools\n// ============================================================================\n\nexport { jsonManipulator } from './json/jsonManipulator.js';\n\n// ============================================================================\n// Web Tools\n// ============================================================================\n\nexport { webFetch, createWebSearchTool, createWebScrapeTool } from './web/index.js';\n\n// Re-export search result type from capabilities (canonical location)\nexport type { SearchResult } from './web/index.js';\n\n// ============================================================================\n// Code Execution Tools\n// ============================================================================\n\nexport { executeJavaScript, createExecuteJavaScriptTool, executeInVM } from './code/index.js';\n\n// ============================================================================\n// Connector Tools (Vendor-Dependent Tools Framework)\n// ============================================================================\n\nexport {\n  ConnectorTools,\n  type ServiceToolFactory,\n  type GenericAPIToolOptions,\n  type GenericAPICallArgs,\n  type GenericAPICallResult,\n} from './connector/index.js';\n\n// ============================================================================\n// Multimedia Tools (Auto-registered with ConnectorTools for AI vendors)\n// ============================================================================\n\n// Canonical exports\nexport {\n  setMediaStorage,\n  getMediaStorage,\n  createImageGenerationTool,\n  createVideoTools,\n  createTextToSpeechTool,\n  createSpeechToTextTool,\n} from './multimedia/index.js';\n\n// Deprecated aliases (backward compat - remove in next major version)\nexport {\n  FileMediaOutputHandler,\n  setMediaOutputHandler,\n  getMediaOutputHandler,\n} from './multimedia/index.js';\n\nexport type {\n  IMediaOutputHandler,\n  MediaOutputMetadata,\n  MediaOutputResult,\n} from './multimedia/index.js';\n\n// ============================================================================\n// GitHub Tools (Auto-registered with ConnectorTools for GitHub service)\n// ============================================================================\n\nexport {\n  // Tool factories\n  createSearchFilesTool,\n  createSearchCodeTool,\n  createGitHubReadFileTool,\n  createGetPRTool,\n  createPRFilesTool,\n  createPRCommentsTool,\n  createCreatePRTool,\n  // Utilities\n  parseRepository,\n  resolveRepository,\n} from './github/index.js';\n\nexport type {\n  GitHubRepository,\n  GitHubSearchFilesResult,\n  GitHubSearchCodeResult,\n  GitHubReadFileResult,\n  GitHubGetPRResult,\n  GitHubPRFilesResult,\n  GitHubPRCommentsResult,\n  GitHubPRCommentEntry,\n  GitHubCreatePRResult,\n} from './github/index.js';\n\n// ============================================================================\n// Microsoft Graph Tools (Auto-registered with ConnectorTools for Microsoft service)\n// ============================================================================\n\nexport {\n  // Tool factories\n  createDraftEmailTool,\n  createSendEmailTool,\n  createMeetingTool,\n  createEditMeetingTool,\n  createGetMeetingTranscriptTool,\n  createFindMeetingSlotsTool,\n  // Files (OneDrive / SharePoint)\n  createMicrosoftReadFileTool,\n  createMicrosoftListFilesTool,\n  createMicrosoftSearchFilesTool,\n  // Utilities\n  getUserPathPrefix,\n  microsoftFetch,\n  formatRecipients,\n  formatAttendees,\n  normalizeEmails,\n  isTeamsMeetingUrl,\n  resolveMeetingId,\n  encodeSharingUrl,\n  isWebUrl,\n  isMicrosoftFileUrl,\n  getDrivePrefix,\n  resolveFileEndpoints,\n  formatFileSize,\n} from './microsoft/index.js';\n\nexport type {\n  MicrosoftDraftEmailResult,\n  MicrosoftSendEmailResult,\n  MicrosoftCreateMeetingResult,\n  MicrosoftEditMeetingResult,\n  MicrosoftGetTranscriptResult,\n  MicrosoftFindSlotsResult,\n  MeetingSlotSuggestion,\n  MicrosoftReadFileResult,\n  MicrosoftListFilesResult,\n  MicrosoftSearchFilesResult,\n  GraphDriveItem,\n} from './microsoft/index.js';\n\n// ============================================================================\n// Desktop Automation Tools\n// ============================================================================\n\nexport {\n  // Tools\n  desktopScreenshot,\n  desktopMouseMove,\n  desktopMouseClick,\n  desktopMouseDrag,\n  desktopMouseScroll,\n  desktopGetCursor,\n  desktopKeyboardType,\n  desktopKeyboardKey,\n  desktopGetScreenSize,\n  desktopWindowList,\n  desktopWindowFocus,\n  desktopTools,\n  // Factory functions\n  createDesktopScreenshotTool,\n  createDesktopMouseMoveTool,\n  createDesktopMouseClickTool,\n  createDesktopMouseDragTool,\n  createDesktopMouseScrollTool,\n  createDesktopGetCursorTool,\n  createDesktopKeyboardTypeTool,\n  createDesktopKeyboardKeyTool,\n  createDesktopGetScreenSizeTool,\n  createDesktopWindowListTool,\n  createDesktopWindowFocusTool,\n  // Driver\n  NutTreeDriver,\n  parseKeyCombo,\n  getDesktopDriver,\n  resetDefaultDriver,\n  // Config\n  DEFAULT_DESKTOP_CONFIG,\n  DESKTOP_TOOL_NAMES,\n  applyHumanDelay,\n} from './desktop/index.js';\n\nexport type {\n  IDesktopDriver,\n  DesktopToolConfig,\n  DesktopPoint,\n  DesktopScreenSize,\n  DesktopScreenshot,\n  DesktopWindow,\n  MouseButton,\n  DesktopToolName,\n  DesktopScreenshotArgs,\n  DesktopScreenshotResult,\n  DesktopMouseMoveArgs,\n  DesktopMouseMoveResult,\n  DesktopMouseClickArgs,\n  DesktopMouseClickResult,\n  DesktopMouseDragArgs,\n  DesktopMouseDragResult,\n  DesktopMouseScrollArgs,\n  DesktopMouseScrollResult,\n  DesktopGetCursorResult,\n  DesktopKeyboardTypeArgs,\n  DesktopKeyboardTypeResult,\n  DesktopKeyboardKeyArgs,\n  DesktopKeyboardKeyResult,\n  DesktopGetScreenSizeResult,\n  DesktopWindowListResult,\n  DesktopWindowFocusArgs,\n  DesktopWindowFocusResult,\n} from './desktop/index.js';\n\n// ============================================================================\n// Document Reader (used by filesystem and web tools)\n// ============================================================================\n\nexport {\n  DocumentReader,\n  FormatDetector,\n  mergeTextPieces,\n} from '../capabilities/documents/index.js';\n\nexport type {\n  DocumentFormat,\n  DocumentFamily,\n  DocumentPiece,\n  DocumentTextPiece,\n  DocumentImagePiece,\n  DocumentResult,\n  DocumentMetadata,\n  DocumentSource,\n  DocumentReadOptions,\n  DocumentReaderConfig,\n  ImageFilterOptions,\n  IDocumentTransformer,\n  IFormatHandler,\n  FormatDetectionResult,\n  DocumentToContentOptions,\n} from '../capabilities/documents/index.js';\n\n// ============================================================================\n// Convenience: All Developer Tools Bundle\n// ============================================================================\n\nimport { readFile } from './filesystem/index.js';\nimport { writeFile } from './filesystem/index.js';\nimport { editFile } from './filesystem/index.js';\nimport { glob } from './filesystem/index.js';\nimport { grep } from './filesystem/index.js';\nimport { listDirectory } from './filesystem/index.js';\nimport { bash } from './shell/index.js';\n\n/**\n * A bundle of all developer tools commonly used for coding tasks.\n * Includes: readFile, writeFile, editFile, glob, grep, listDirectory, bash\n *\n * @example\n * ```typescript\n * import { tools } from '@everworker/oneringai';\n *\n * const agent = Agent.create({\n *   connector: 'openai',\n *   model: 'gpt-4',\n *   tools: tools.developerTools,\n * });\n * ```\n */\nexport const developerTools = [\n  readFile,\n  writeFile,\n  editFile,\n  glob,\n  grep,\n  listDirectory,\n  bash,\n];\n\n// ============================================================================\n// Tool Registry (Auto-Generated)\n// ============================================================================\n\nexport {\n  toolRegistry,\n  getAllBuiltInTools,\n  getToolRegistry,\n  getToolsByCategory,\n  getToolByName,\n  getToolsRequiringConnector,\n  getToolCategories,\n  type ToolCategory,\n  type ToolRegistryEntry,\n} from './registry.generated.js';\n\n// ============================================================================\n// Routine Tools\n// ============================================================================\n\nexport { generateRoutine, createGenerateRoutine } from './routines/index.js';\n\n// ============================================================================\n// Custom Tool Generation System\n// ============================================================================\n\nexport {\n  // Default instances\n  customToolDraft,\n  customToolTest,\n  customToolSave,\n  customToolList,\n  customToolLoad,\n  customToolDelete,\n  // Factory functions\n  createCustomToolMetaTools,\n  createCustomToolDraft,\n  createCustomToolTest,\n  createCustomToolSave,\n  createCustomToolList,\n  createCustomToolLoad,\n  createCustomToolDelete,\n  // Hydration\n  hydrateCustomTool,\n} from './custom-tools/index.js';\n\nexport type {\n  CustomToolMetaToolsOptions,\n  HydrateOptions,\n} from './custom-tools/index.js';\n\n// ============================================================================\n// Unified Tool Registry (Built-in + Connector Tools)\n// ============================================================================\n\nexport { ToolRegistry, type ConnectorToolEntry } from './ToolRegistry.js';\n","/**\n * Filesystem Tools - Shared Types\n *\n * Common types and configuration for filesystem operations.\n */\n\nimport { resolve, normalize, isAbsolute, sep } from 'node:path';\nimport { homedir } from 'node:os';\nimport type { DocumentReaderConfig } from '../../capabilities/documents/types.js';\n\n/**\n * Configuration for filesystem tools\n */\nexport interface FilesystemToolConfig {\n  /**\n   * Base working directory for all operations.\n   * All paths will be resolved relative to this directory.\n   * Defaults to process.cwd()\n   */\n  workingDirectory?: string;\n\n  /**\n   * Allowed directories for file operations.\n   * If specified, operations outside these directories will be blocked.\n   * Paths can be absolute or relative to workingDirectory.\n   */\n  allowedDirectories?: string[];\n\n  /**\n   * Blocked directories (e.g., node_modules, .git).\n   * Operations in these directories will be blocked.\n   */\n  blockedDirectories?: string[];\n\n  /**\n   * Maximum file size to read (in bytes).\n   * Default: 10MB\n   */\n  maxFileSize?: number;\n\n  /**\n   * Maximum number of results for glob/grep operations.\n   * Default: 1000\n   */\n  maxResults?: number;\n\n  /**\n   * Whether to follow symlinks.\n   * Default: false\n   */\n  followSymlinks?: boolean;\n\n  /**\n   * File extensions to exclude from search.\n   * Default: common binary extensions\n   */\n  excludeExtensions?: string[];\n\n  /**\n   * Document reader config for non-text file formats (PDF, DOCX, XLSX, etc.).\n   * When set, read_file will automatically convert binary document formats to markdown.\n   */\n  documentReaderConfig?: DocumentReaderConfig;\n}\n\n/**\n * Default configuration\n */\n/** FilesystemToolConfig with all base fields required (documentReaderConfig remains optional) */\nexport type FilesystemToolConfigDefaults = Required<Omit<FilesystemToolConfig, 'documentReaderConfig'>> & Pick<FilesystemToolConfig, 'documentReaderConfig'>;\n\nexport const DEFAULT_FILESYSTEM_CONFIG: FilesystemToolConfigDefaults = {\n  workingDirectory: process.cwd(),\n  allowedDirectories: [],\n  blockedDirectories: ['node_modules', '.git', '.svn', '.hg', '__pycache__', '.cache'],\n  maxFileSize: 10 * 1024 * 1024, // 10MB\n  maxResults: 1000,\n  followSymlinks: false,\n  excludeExtensions: [\n    '.exe', '.dll', '.so', '.dylib', '.bin', '.obj', '.o', '.a',\n    '.zip', '.tar', '.gz', '.bz2', '.7z', '.rar',\n    '.png', '.jpg', '.jpeg', '.gif', '.bmp', '.ico', '.svg', '.webp',\n    '.mp3', '.mp4', '.wav', '.avi', '.mov', '.mkv',\n    // Note: .pdf, .docx, .xlsx, .pptx are NOT excluded  DocumentReader handles them\n    '.doc', '.xls', '.ppt', // Legacy Office formats not yet supported\n    '.woff', '.woff2', '.ttf', '.eot', '.otf',\n  ],\n};\n\n/**\n * Result of a file read operation\n */\nexport interface ReadFileResult {\n  success: boolean;\n  content?: string;\n  lines?: number;\n  truncated?: boolean;\n  encoding?: string;\n  size?: number;\n  error?: string;\n  path?: string;\n}\n\n/**\n * Result of a file write operation\n */\nexport interface WriteFileResult {\n  success: boolean;\n  path?: string;\n  bytesWritten?: number;\n  created?: boolean;\n  error?: string;\n}\n\n/**\n * Result of a file edit operation\n */\nexport interface EditFileResult {\n  success: boolean;\n  path?: string;\n  replacements?: number;\n  error?: string;\n  diff?: string;\n}\n\n/**\n * Result of a glob operation\n */\nexport interface GlobResult {\n  success: boolean;\n  files?: string[];\n  count?: number;\n  truncated?: boolean;\n  error?: string;\n}\n\n/**\n * A single grep match\n */\nexport interface GrepMatch {\n  file: string;\n  line: number;\n  column?: number;\n  content: string;\n  context?: {\n    before: string[];\n    after: string[];\n  };\n}\n\n/**\n * Result of a grep operation\n */\nexport interface GrepResult {\n  success: boolean;\n  matches?: GrepMatch[];\n  filesSearched?: number;\n  filesMatched?: number;\n  totalMatches?: number;\n  truncated?: boolean;\n  error?: string;\n}\n\n/**\n * Normalize a path to use forward slashes (for consistent cross-platform behavior).\n * On Windows, path.relative() and path.resolve() return backslash-separated paths,\n * which breaks glob pattern matching and directory filtering.\n */\nexport function toForwardSlash(p: string): string {\n  return sep === '\\\\' ? p.replace(/\\\\/g, '/') : p;\n}\n\n/**\n * Validate and resolve a path within allowed boundaries\n */\nexport function validatePath(\n  inputPath: string,\n  config: FilesystemToolConfig = {}\n): { valid: boolean; resolvedPath: string; error?: string } {\n  const workingDir = config.workingDirectory || process.cwd();\n  const allowedDirs = config.allowedDirectories || [];\n  const blockedDirs = config.blockedDirectories || DEFAULT_FILESYSTEM_CONFIG.blockedDirectories;\n\n  // Expand tilde (~) to home directory\n  let expandedPath = inputPath;\n  if (inputPath.startsWith('~/')) {\n    expandedPath = resolve(homedir(), inputPath.slice(2));\n  } else if (inputPath === '~') {\n    expandedPath = homedir();\n  }\n\n  // Resolve the path\n  let resolvedPath: string;\n  if (isAbsolute(expandedPath)) {\n    resolvedPath = normalize(expandedPath);\n  } else {\n    resolvedPath = resolve(workingDir, expandedPath);\n  }\n\n  // Check blocked directories - check if any path segment matches a blocked directory name\n  // Use forward slashes for consistent matching across platforms\n  const normalizedResolved = toForwardSlash(resolvedPath);\n  const pathSegments = normalizedResolved.split('/').filter(Boolean);\n  for (const blocked of blockedDirs) {\n    // If blocked is a simple name (no slashes), check path segments\n    if (!blocked.includes('/')) {\n      if (pathSegments.includes(blocked)) {\n        return {\n          valid: false,\n          resolvedPath,\n          error: `Path is in blocked directory: ${blocked}`,\n        };\n      }\n    } else {\n      // If blocked is a path, resolve it and check prefix\n      const blockedPath = toForwardSlash(isAbsolute(blocked) ? blocked : resolve(workingDir, blocked));\n      if (normalizedResolved.startsWith(blockedPath + '/') || normalizedResolved === blockedPath) {\n        return {\n          valid: false,\n          resolvedPath,\n          error: `Path is in blocked directory: ${blocked}`,\n        };\n      }\n    }\n  }\n\n  // Check allowed directories (if specified)\n  if (allowedDirs.length > 0) {\n    let isAllowed = false;\n    for (const allowed of allowedDirs) {\n      const allowedPath = toForwardSlash(isAbsolute(allowed) ? allowed : resolve(workingDir, allowed));\n      if (normalizedResolved.startsWith(allowedPath + '/') || normalizedResolved === allowedPath) {\n        isAllowed = true;\n        break;\n      }\n    }\n    if (!isAllowed) {\n      return {\n        valid: false,\n        resolvedPath,\n        error: `Path is outside allowed directories`,\n      };\n    }\n  }\n\n  return { valid: true, resolvedPath };\n}\n\n/**\n * Expand tilde (~) to the user's home directory\n */\nexport function expandTilde(inputPath: string): string {\n  if (inputPath.startsWith('~/')) {\n    return resolve(homedir(), inputPath.slice(2));\n  } else if (inputPath === '~') {\n    return homedir();\n  }\n  return inputPath;\n}\n\n/**\n * Check if a file extension should be excluded\n */\nexport function isExcludedExtension(\n  filePath: string,\n  excludeExtensions: string[] = DEFAULT_FILESYSTEM_CONFIG.excludeExtensions\n): boolean {\n  const ext = filePath.toLowerCase().substring(filePath.lastIndexOf('.'));\n  return excludeExtensions.includes(ext);\n}\n","/**\n * Read File Tool\n *\n * Reads content from files on the local filesystem.\n * Supports text files with optional line range selection.\n *\n * Features:\n * - Read entire files or specific line ranges\n * - Automatic encoding detection\n * - Line number prefixing for easy reference\n * - Size limits to prevent memory issues\n * - Path validation for security\n */\n\nimport { readFile as fsReadFile, stat } from 'node:fs/promises';\nimport { existsSync } from 'node:fs';\nimport { extname } from 'node:path';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type FilesystemToolConfig,\n  type ReadFileResult,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n} from './types.js';\nimport { FormatDetector } from '../../capabilities/documents/FormatDetector.js';\nimport { DocumentReader, mergeTextPieces } from '../../capabilities/documents/DocumentReader.js';\n\n/**\n * Arguments for the read file tool\n */\nexport interface ReadFileArgs {\n  /** Absolute path to the file to read */\n  file_path: string;\n  /** Line number to start reading from (1-indexed). Only provide if the file is too large. */\n  offset?: number;\n  /** Number of lines to read. Only provide if the file is too large. */\n  limit?: number;\n}\n\n/**\n * Create a Read File tool with the given configuration\n */\nexport function createReadFileTool(config: FilesystemToolConfig = {}): ToolFunction<ReadFileArgs, ReadFileResult> {\n  const mergedConfig = { ...DEFAULT_FILESYSTEM_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'read_file',\n        description: `Read content from a file on the local filesystem. Supports text files AND binary document formats  PDF, DOCX, PPTX, XLSX, ODS, ODT, ODP, and images (PNG, JPG, GIF, WEBP) are automatically converted to markdown text.\n\nUSAGE:\n- The file_path parameter must be an absolute path, not a relative path\n- By default, reads up to 2000 lines starting from the beginning of the file\n- You can optionally specify a line offset and limit (especially handy for long files)\n- Any lines longer than 2000 characters will be truncated\n- Results are returned with line numbers starting at 1\n\nDOCUMENT SUPPORT:\n- PDF files: extracted as markdown text with per-page sections\n- Word documents (.docx): converted to markdown preserving headings, lists, tables\n- PowerPoint (.pptx): extracted slide-by-slide as markdown\n- Excel (.xlsx) / CSV / ODS: tables converted to markdown tables\n- OpenDocument (.odt, .odp, .ods): converted like their MS Office equivalents\n- Images (.png, .jpg, .gif, .webp): described as image metadata\n- Binary documents are auto-detected by extension  just pass the file path\n\nWHEN TO USE:\n- To read source code files before making edits\n- To understand file contents and structure\n- To read configuration files\n- To examine log files or data files\n- To read PDF, Word, Excel, PowerPoint, or other document files as text\n\nIMPORTANT:\n- Always read a file before attempting to edit it\n- Use offset/limit for very large files to read in chunks\n- The tool will return an error if the file doesn't exist\n- offset/limit are ignored for binary document formats (full document is always returned)\n\nEXAMPLES:\n- Read entire file: { \"file_path\": \"/path/to/file.ts\" }\n- Read lines 100-200: { \"file_path\": \"/path/to/file.ts\", \"offset\": 100, \"limit\": 100 }\n- Read a PDF: { \"file_path\": \"/path/to/report.pdf\" }\n- Read an Excel file: { \"file_path\": \"/path/to/data.xlsx\" }\n- Read a Word doc: { \"file_path\": \"/path/to/document.docx\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            file_path: {\n              type: 'string',\n              description: 'The absolute path to the file to read',\n            },\n            offset: {\n              type: 'number',\n              description: 'Line number to start reading from (1-indexed). Only provide if the file is too large to read at once.',\n            },\n            limit: {\n              type: 'number',\n              description: 'Number of lines to read. Only provide if the file is too large to read at once.',\n            },\n          },\n          required: ['file_path'],\n        },\n      },\n    },\n\n    describeCall: (args: ReadFileArgs): string => {\n      if (args.offset && args.limit) {\n        return `${args.file_path} [lines ${args.offset}-${args.offset + args.limit}]`;\n      }\n      return args.file_path;\n    },\n\n    execute: async (args: ReadFileArgs): Promise<ReadFileResult> => {\n      const { file_path, offset = 1, limit = 2000 } = args;\n\n      // Validate path\n      const validation = validatePath(file_path, mergedConfig);\n      if (!validation.valid) {\n        return {\n          success: false,\n          error: validation.error,\n          path: file_path,\n        };\n      }\n\n      const resolvedPath = validation.resolvedPath;\n\n      // Check if file exists\n      if (!existsSync(resolvedPath)) {\n        return {\n          success: false,\n          error: `File not found: ${file_path}`,\n          path: file_path,\n        };\n      }\n\n      try {\n        // Check file size\n        const stats = await stat(resolvedPath);\n        if (!stats.isFile()) {\n          return {\n            success: false,\n            error: `Path is not a file: ${file_path}. Use list_directory to explore directories.`,\n            path: file_path,\n          };\n        }\n\n        if (stats.size > mergedConfig.maxFileSize) {\n          return {\n            success: false,\n            error: `File is too large (${(stats.size / 1024 / 1024).toFixed(2)}MB). Maximum size is ${(mergedConfig.maxFileSize / 1024 / 1024).toFixed(2)}MB. Use offset and limit to read in chunks.`,\n            path: file_path,\n            size: stats.size,\n          };\n        }\n\n        // Check if this is a binary document format that needs DocumentReader\n        const ext = extname(resolvedPath).toLowerCase();\n        if (FormatDetector.isBinaryDocumentFormat(ext)) {\n          try {\n            const reader = DocumentReader.create(mergedConfig.documentReaderConfig);\n            const result = await reader.read(\n              { type: 'file', path: resolvedPath },\n              {\n                extractImages: false,\n                ...mergedConfig.documentReaderConfig?.defaults,\n              }\n            );\n\n            if (result.success) {\n              const content = mergeTextPieces(result.pieces);\n              return {\n                success: true,\n                content,\n                lines: content.split('\\n').length,\n                truncated: false,\n                encoding: 'document',\n                size: stats.size,\n                path: file_path,\n              };\n            }\n            // Fall through to UTF-8 attempt if document reader fails\n          } catch {\n            // Fall through to UTF-8 attempt\n          }\n        }\n\n        // Read file content\n        const content = await fsReadFile(resolvedPath, 'utf-8');\n        const allLines = content.split('\\n');\n        const totalLines = allLines.length;\n\n        // Apply offset and limit (offset is 1-indexed)\n        const startIndex = Math.max(0, offset - 1);\n        const endIndex = Math.min(totalLines, startIndex + limit);\n        const selectedLines = allLines.slice(startIndex, endIndex);\n\n        // Format with line numbers\n        const lineNumberWidth = String(endIndex).length;\n        const formattedLines = selectedLines.map((line, i) => {\n          const lineNum = startIndex + i + 1;\n          const paddedNum = String(lineNum).padStart(lineNumberWidth, ' ');\n          // Truncate very long lines\n          const truncatedLine = line.length > 2000 ? line.substring(0, 2000) + '...' : line;\n          return `${paddedNum}\\t${truncatedLine}`;\n        });\n\n        const truncated = endIndex < totalLines;\n        const result = formattedLines.join('\\n');\n\n        return {\n          success: true,\n          content: result,\n          lines: totalLines,\n          truncated,\n          encoding: 'utf-8',\n          size: stats.size,\n          path: file_path,\n        };\n      } catch (error) {\n        // Handle binary files or encoding issues\n        if (error instanceof Error && error.message.includes('encoding')) {\n          return {\n            success: false,\n            error: `File appears to be binary or uses an unsupported encoding: ${file_path}`,\n            path: file_path,\n          };\n        }\n\n        return {\n          success: false,\n          error: `Failed to read file: ${error instanceof Error ? error.message : String(error)}`,\n          path: file_path,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Default Read File tool instance\n */\nexport const readFile = createReadFileTool();\n","/**\n * Write File Tool\n *\n * Writes content to files on the local filesystem.\n * Can create new files or overwrite existing ones.\n *\n * Features:\n * - Create new files with content\n * - Overwrite existing files (with safety checks)\n * - Automatic directory creation\n * - Path validation for security\n */\n\nimport { writeFile as fsWriteFile, mkdir } from 'node:fs/promises';\nimport { existsSync } from 'node:fs';\nimport { dirname } from 'node:path';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type FilesystemToolConfig,\n  type WriteFileResult,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n} from './types.js';\n\n/**\n * Arguments for the write file tool\n */\nexport interface WriteFileArgs {\n  /** Absolute path to the file to write */\n  file_path: string;\n  /** Content to write to the file */\n  content: string;\n}\n\n/**\n * Create a Write File tool with the given configuration\n */\nexport function createWriteFileTool(config: FilesystemToolConfig = {}): ToolFunction<WriteFileArgs, WriteFileResult> {\n  const mergedConfig = { ...DEFAULT_FILESYSTEM_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'write_file',\n        description: `Write content to a file on the local filesystem.\n\nUSAGE:\n- This tool will overwrite the existing file if there is one at the provided path\n- If the file exists, you MUST use the read_file tool first to read its contents before writing\n- The file_path must be an absolute path, not a relative path\n- Parent directories will be created automatically if they don't exist\n\nWHEN TO USE:\n- To create new files\n- To completely replace file contents (after reading the original)\n- When the edit_file tool cannot handle the changes needed\n\nIMPORTANT:\n- ALWAYS prefer editing existing files over creating new ones\n- NEVER proactively create documentation files (*.md) or README files unless explicitly requested\n- If modifying an existing file, use edit_file instead for surgical changes\n- This tool will FAIL if you try to write to an existing file without reading it first\n\nEXAMPLES:\n- Create new file: { \"file_path\": \"/path/to/new-file.ts\", \"content\": \"export const x = 1;\" }\n- Rewrite file: { \"file_path\": \"/path/to/existing.ts\", \"content\": \"// new content...\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            file_path: {\n              type: 'string',\n              description: 'The absolute path to the file to write (must be absolute, not relative)',\n            },\n            content: {\n              type: 'string',\n              description: 'The content to write to the file',\n            },\n          },\n          required: ['file_path', 'content'],\n        },\n      },\n    },\n\n    describeCall: (args: WriteFileArgs): string => {\n      const size = args.content?.length || 0;\n      if (size > 1000) {\n        return `${args.file_path} (${Math.round(size / 1024)}KB)`;\n      }\n      return args.file_path;\n    },\n\n    execute: async (args: WriteFileArgs): Promise<WriteFileResult> => {\n      const { file_path, content } = args;\n\n      // Validate path\n      const validation = validatePath(file_path, mergedConfig);\n      if (!validation.valid) {\n        return {\n          success: false,\n          error: validation.error,\n          path: file_path,\n        };\n      }\n\n      const resolvedPath = validation.resolvedPath;\n      const fileExists = existsSync(resolvedPath);\n\n      try {\n        // Ensure parent directory exists\n        const parentDir = dirname(resolvedPath);\n        if (!existsSync(parentDir)) {\n          await mkdir(parentDir, { recursive: true });\n        }\n\n        // Write the file\n        await fsWriteFile(resolvedPath, content, 'utf-8');\n\n        return {\n          success: true,\n          path: file_path,\n          bytesWritten: Buffer.byteLength(content, 'utf-8'),\n          created: !fileExists,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to write file: ${error instanceof Error ? error.message : String(error)}`,\n          path: file_path,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Default Write File tool instance\n */\nexport const writeFile = createWriteFileTool();\n","/**\n * Edit File Tool\n *\n * Performs surgical edits to files using exact string replacement.\n * This is the preferred way to modify existing files.\n *\n * Features:\n * - Exact string matching for precise edits\n * - Preserves file formatting and indentation\n * - Supports replace_all for bulk changes\n * - Validates uniqueness of old_string\n * - Safe: only modifies what's specified\n */\n\nimport { readFile as fsReadFile, writeFile as fsWriteFile } from 'node:fs/promises';\nimport { existsSync } from 'node:fs';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type FilesystemToolConfig,\n  type EditFileResult,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n} from './types.js';\n\n/**\n * Arguments for the edit file tool\n */\nexport interface EditFileArgs {\n  /** Absolute path to the file to edit */\n  file_path: string;\n  /** The exact text to find and replace */\n  old_string: string;\n  /** The text to replace it with (must be different from old_string) */\n  new_string: string;\n  /** Replace all occurrences (default: false, which requires old_string to be unique) */\n  replace_all?: boolean;\n}\n\n/**\n * Create an Edit File tool with the given configuration\n */\nexport function createEditFileTool(config: FilesystemToolConfig = {}): ToolFunction<EditFileArgs, EditFileResult> {\n  const mergedConfig = { ...DEFAULT_FILESYSTEM_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'edit_file',\n        description: `Perform exact string replacements in files.\n\nUSAGE:\n- You MUST use read_file at least once before editing any file\n- The old_string must match EXACTLY what's in the file, including all whitespace and indentation\n- When editing text from read_file output, preserve the exact indentation as it appears AFTER the line number prefix\n- The line number prefix format is: spaces + line number + tab. Everything after that tab is the actual file content\n- NEVER include any part of the line number prefix in old_string or new_string\n\nIMPORTANT RULES:\n- ALWAYS prefer editing existing files over writing new ones\n- The edit will FAIL if old_string is not found in the file\n- The edit will FAIL if old_string appears more than once (unless replace_all is true)\n- Use replace_all: true when you want to rename variables, update imports, etc.\n- old_string and new_string must be different\n\nMATCHING TIPS:\n- Include enough surrounding context to make old_string unique\n- Copy the exact whitespace from the file (spaces vs tabs matter!)\n- For indented code, include the full indentation in old_string\n\nEXAMPLES:\n- Simple edit:\n  { \"file_path\": \"/path/to/file.ts\", \"old_string\": \"const x = 1;\", \"new_string\": \"const x = 2;\" }\n\n- Edit with context for uniqueness:\n  { \"file_path\": \"/path/to/file.ts\",\n    \"old_string\": \"function foo() {\\\\n  return 1;\\\\n}\",\n    \"new_string\": \"function foo() {\\\\n  return 2;\\\\n}\" }\n\n- Replace all occurrences:\n  { \"file_path\": \"/path/to/file.ts\", \"old_string\": \"oldName\", \"new_string\": \"newName\", \"replace_all\": true }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            file_path: {\n              type: 'string',\n              description: 'The absolute path to the file to modify',\n            },\n            old_string: {\n              type: 'string',\n              description: 'The exact text to find and replace',\n            },\n            new_string: {\n              type: 'string',\n              description: 'The text to replace it with (must be different from old_string)',\n            },\n            replace_all: {\n              type: 'boolean',\n              description: 'Replace all occurrences instead of requiring uniqueness (default: false)',\n            },\n          },\n          required: ['file_path', 'old_string', 'new_string'],\n        },\n      },\n    },\n\n    describeCall: (args: EditFileArgs): string => {\n      const mode = args.replace_all ? ' (replace all)' : '';\n      return `${args.file_path}${mode}`;\n    },\n\n    execute: async (args: EditFileArgs): Promise<EditFileResult> => {\n      const { file_path, old_string, new_string, replace_all = false } = args;\n\n      // Validate that old_string and new_string are different\n      if (old_string === new_string) {\n        return {\n          success: false,\n          error: 'old_string and new_string must be different',\n          path: file_path,\n        };\n      }\n\n      // Validate path\n      const validation = validatePath(file_path, mergedConfig);\n      if (!validation.valid) {\n        return {\n          success: false,\n          error: validation.error,\n          path: file_path,\n        };\n      }\n\n      const resolvedPath = validation.resolvedPath;\n\n      // Check if file exists\n      if (!existsSync(resolvedPath)) {\n        return {\n          success: false,\n          error: `File not found: ${file_path}`,\n          path: file_path,\n        };\n      }\n\n      try {\n        // Read current content\n        const content = await fsReadFile(resolvedPath, 'utf-8');\n\n        // Count occurrences\n        let occurrences = 0;\n        let searchIndex = 0;\n        while (true) {\n          const foundIndex = content.indexOf(old_string, searchIndex);\n          if (foundIndex === -1) break;\n          occurrences++;\n          searchIndex = foundIndex + 1;\n        }\n\n        // Validate occurrences\n        if (occurrences === 0) {\n          // Try to provide helpful feedback\n          const trimmedOld = old_string.trim();\n          const hasTrimmedMatch = content.includes(trimmedOld);\n\n          let errorMsg = `old_string not found in file. `;\n          if (hasTrimmedMatch && trimmedOld !== old_string) {\n            errorMsg += `A similar string was found but with different whitespace. Check your indentation matches exactly.`;\n          } else {\n            errorMsg += `Make sure you're copying the exact text from the file, including all whitespace.`;\n          }\n\n          return {\n            success: false,\n            error: errorMsg,\n            path: file_path,\n            replacements: 0,\n          };\n        }\n\n        if (occurrences > 1 && !replace_all) {\n          return {\n            success: false,\n            error: `old_string appears ${occurrences} times in the file. Either provide more context to make it unique, or set replace_all: true to replace all occurrences.`,\n            path: file_path,\n            replacements: 0,\n          };\n        }\n\n        // Perform replacement\n        let newContent: string;\n        if (replace_all) {\n          newContent = content.split(old_string).join(new_string);\n        } else {\n          newContent = content.replace(old_string, new_string);\n        }\n\n        // Write the modified content\n        await fsWriteFile(resolvedPath, newContent, 'utf-8');\n\n        // Generate simple diff preview\n        const diffPreview = generateDiffPreview(old_string, new_string);\n\n        return {\n          success: true,\n          path: file_path,\n          replacements: replace_all ? occurrences : 1,\n          diff: diffPreview,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to edit file: ${error instanceof Error ? error.message : String(error)}`,\n          path: file_path,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Generate a simple diff preview\n */\nfunction generateDiffPreview(oldStr: string, newStr: string): string {\n  const oldLines = oldStr.split('\\n');\n  const newLines = newStr.split('\\n');\n\n  const diff: string[] = [];\n  const maxLines = Math.max(oldLines.length, newLines.length);\n\n  // Show first few lines of old and new\n  const previewLines = Math.min(maxLines, 5);\n\n  diff.push('--- old');\n  for (let i = 0; i < Math.min(oldLines.length, previewLines); i++) {\n    diff.push(`- ${oldLines[i]}`);\n  }\n  if (oldLines.length > previewLines) {\n    diff.push(`  ... (${oldLines.length - previewLines} more lines)`);\n  }\n\n  diff.push('+++ new');\n  for (let i = 0; i < Math.min(newLines.length, previewLines); i++) {\n    diff.push(`+ ${newLines[i]}`);\n  }\n  if (newLines.length > previewLines) {\n    diff.push(`  ... (${newLines.length - previewLines} more lines)`);\n  }\n\n  return diff.join('\\n');\n}\n\n/**\n * Default Edit File tool instance\n */\nexport const editFile = createEditFileTool();\n","/**\n * Glob Tool\n *\n * Fast file pattern matching for finding files by name patterns.\n * Supports standard glob patterns like **\\/*.ts, src/**\\/*.tsx, etc.\n *\n * Features:\n * - Standard glob pattern syntax\n * - Recursive directory traversal\n * - Results sorted by modification time\n * - Configurable result limits\n * - Excludes common non-code directories by default\n */\n\nimport { readdir, stat } from 'node:fs/promises';\nimport { existsSync } from 'node:fs';\nimport { join, relative } from 'node:path';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type FilesystemToolConfig,\n  type FilesystemToolConfigDefaults,\n  type GlobResult,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n  toForwardSlash,\n} from './types.js';\n\n/**\n * Arguments for the glob tool\n */\nexport interface GlobArgs {\n  /** The glob pattern to match files against (e.g., \"**\\/*.ts\", \"src/**\\/*.tsx\") */\n  pattern: string;\n  /** The directory to search in. Defaults to current working directory. */\n  path?: string;\n}\n\n/**\n * Simple glob pattern matcher\n */\nfunction matchGlobPattern(pattern: string, filePath: string): boolean {\n  // Convert glob pattern to regex\n  let regexPattern = pattern\n    // Escape special regex characters except * and ?\n    .replace(/[.+^${}()|[\\]\\\\]/g, '\\\\$&')\n    // Convert ** to match any path\n    .replace(/\\*\\*/g, '{{GLOBSTAR}}')\n    // Convert * to match any characters except /\n    .replace(/\\*/g, '[^/]*')\n    // Convert ? to match single character\n    .replace(/\\?/g, '.')\n    // Restore **\n    .replace(/\\{\\{GLOBSTAR\\}\\}/g, '.*');\n\n  // Anchor the pattern\n  regexPattern = '^' + regexPattern + '$';\n\n  try {\n    const regex = new RegExp(regexPattern);\n    return regex.test(filePath);\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Recursively find files matching a pattern\n */\nasync function findFiles(\n  dir: string,\n  pattern: string,\n  baseDir: string,\n  config: FilesystemToolConfigDefaults,\n  results: { path: string; mtime: number }[] = [],\n  depth: number = 0\n): Promise<{ path: string; mtime: number }[]> {\n  // Prevent infinite recursion\n  if (depth > 50 || results.length >= config.maxResults) {\n    return results;\n  }\n\n  try {\n    const entries = await readdir(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      if (results.length >= config.maxResults) break;\n\n      const fullPath = join(dir, entry.name);\n      // Normalize to forward slashes for consistent cross-platform pattern matching\n      const relativePath = toForwardSlash(relative(baseDir, fullPath));\n\n      // Check if directory is blocked\n      if (entry.isDirectory()) {\n        const isBlocked = config.blockedDirectories.some(\n          blocked => entry.name === blocked || relativePath.includes(`/${blocked}/`) || relativePath.startsWith(`${blocked}/`)\n        );\n        if (isBlocked) continue;\n\n        // Recurse into subdirectories\n        await findFiles(fullPath, pattern, baseDir, config, results, depth + 1);\n      } else if (entry.isFile()) {\n        // Check if file matches pattern\n        if (matchGlobPattern(pattern, relativePath)) {\n          try {\n            const stats = await stat(fullPath);\n            results.push({\n              path: relativePath,\n              mtime: stats.mtimeMs,\n            });\n          } catch {\n            // Skip files we can't stat\n          }\n        }\n      }\n    }\n  } catch {\n    // Skip directories we can't read\n  }\n\n  return results;\n}\n\n/**\n * Create a Glob tool with the given configuration\n */\nexport function createGlobTool(config: FilesystemToolConfig = {}): ToolFunction<GlobArgs, GlobResult> {\n  const mergedConfig = { ...DEFAULT_FILESYSTEM_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'glob',\n        description: `Fast file pattern matching tool that finds files by name patterns.\n\nUSAGE:\n- Supports glob patterns like \"**/*.js\", \"src/**/*.ts\", \"*.{ts,tsx}\"\n- Returns matching file paths sorted by modification time (newest first)\n- Use this tool when you need to find files by name patterns\n\nPATTERN SYNTAX:\n- * matches any characters except /\n- ** matches any characters including /\n- ? matches a single character\n- {a,b} matches either a or b\n\nEXAMPLES:\n- Find all TypeScript files: { \"pattern\": \"**/*.ts\" }\n- Find files in src folder: { \"pattern\": \"src/**/*.{ts,tsx}\" }\n- Find test files: { \"pattern\": \"**/*.test.ts\" }\n- Find specific file type in path: { \"pattern\": \"src/components/**/*.tsx\", \"path\": \"/project\" }\n\nWHEN TO USE:\n- To find files by extension or name pattern\n- To explore project structure\n- To find related files (tests, types, etc.)\n- Before using grep when you know the file pattern`,\n        parameters: {\n          type: 'object',\n          properties: {\n            pattern: {\n              type: 'string',\n              description: 'The glob pattern to match files against (e.g., \"**/*.ts\", \"src/**/*.tsx\")',\n            },\n            path: {\n              type: 'string',\n              description: 'The directory to search in. If not specified, uses the current working directory. IMPORTANT: Omit this field to use the default directory.',\n            },\n          },\n          required: ['pattern'],\n        },\n      },\n    },\n\n    describeCall: (args: GlobArgs): string => {\n      if (args.path) {\n        return `${args.pattern} in ${args.path}`;\n      }\n      return args.pattern;\n    },\n\n    execute: async (args: GlobArgs): Promise<GlobResult> => {\n      const { pattern, path } = args;\n\n      // Determine search directory\n      const searchDir = path || mergedConfig.workingDirectory;\n\n      // Validate path\n      const validation = validatePath(searchDir, {\n        ...mergedConfig,\n        blockedDirectories: [], // Allow searching from any valid directory\n      });\n      if (!validation.valid) {\n        return {\n          success: false,\n          error: validation.error,\n        };\n      }\n\n      const resolvedDir = validation.resolvedPath;\n\n      // Check if directory exists\n      if (!existsSync(resolvedDir)) {\n        return {\n          success: false,\n          error: `Directory not found: ${searchDir}`,\n        };\n      }\n\n      try {\n        // Find matching files\n        const results = await findFiles(resolvedDir, pattern, resolvedDir, mergedConfig);\n\n        // Sort by modification time (newest first)\n        results.sort((a, b) => b.mtime - a.mtime);\n\n        // Check if we hit the limit\n        const truncated = results.length >= mergedConfig.maxResults;\n\n        return {\n          success: true,\n          files: results.map(r => r.path),\n          count: results.length,\n          truncated,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Glob search failed: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Default Glob tool instance\n */\nexport const glob = createGlobTool();\n","/**\n * Grep Tool\n *\n * Powerful search tool for finding content within files.\n * Supports regex patterns, file filtering, and context lines.\n *\n * Features:\n * - Full regex syntax support\n * - File type filtering\n * - Context lines (before/after match)\n * - Multiple output modes\n * - Case-insensitive search option\n */\n\nimport { readFile } from 'node:fs/promises';\nimport { readdir, stat } from 'node:fs/promises';\nimport { existsSync } from 'node:fs';\nimport { join, relative, extname } from 'node:path';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type FilesystemToolConfig,\n  type FilesystemToolConfigDefaults,\n  type GrepResult,\n  type GrepMatch,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n  isExcludedExtension,\n  toForwardSlash,\n} from './types.js';\n\n/**\n * Arguments for the grep tool\n */\nexport interface GrepArgs {\n  /** The regex pattern to search for in file contents */\n  pattern: string;\n  /** File or directory to search in. Defaults to current working directory. */\n  path?: string;\n  /** Glob pattern to filter files (e.g., \"*.ts\", \"*.{ts,tsx}\") */\n  glob?: string;\n  /** File type to search (e.g., \"ts\", \"js\", \"py\"). More efficient than glob for standard types. */\n  type?: string;\n  /** Output mode: \"content\" shows lines, \"files_with_matches\" shows only file paths, \"count\" shows match counts */\n  output_mode?: 'content' | 'files_with_matches' | 'count';\n  /** Case insensitive search */\n  case_insensitive?: boolean;\n  /** Number of context lines before match */\n  context_before?: number;\n  /** Number of context lines after match */\n  context_after?: number;\n  /** Limit output to first N results */\n  limit?: number;\n}\n\n/**\n * Map of common file types to extensions\n */\nconst FILE_TYPE_MAP: Record<string, string[]> = {\n  ts: ['.ts', '.tsx'],\n  js: ['.js', '.jsx', '.mjs', '.cjs'],\n  py: ['.py', '.pyi'],\n  java: ['.java'],\n  go: ['.go'],\n  rust: ['.rs'],\n  c: ['.c', '.h'],\n  cpp: ['.cpp', '.hpp', '.cc', '.hh', '.cxx', '.hxx'],\n  cs: ['.cs'],\n  rb: ['.rb'],\n  php: ['.php'],\n  swift: ['.swift'],\n  kotlin: ['.kt', '.kts'],\n  scala: ['.scala'],\n  html: ['.html', '.htm'],\n  css: ['.css', '.scss', '.sass', '.less'],\n  json: ['.json'],\n  yaml: ['.yaml', '.yml'],\n  xml: ['.xml'],\n  md: ['.md', '.markdown'],\n  sql: ['.sql'],\n  sh: ['.sh', '.bash', '.zsh'],\n};\n\n/**\n * Recursively find files to search\n */\nasync function findFilesToSearch(\n  dir: string,\n  baseDir: string,\n  config: FilesystemToolConfigDefaults,\n  globPattern?: string,\n  fileType?: string,\n  files: string[] = [],\n  depth: number = 0\n): Promise<string[]> {\n  if (depth > 50 || files.length >= config.maxResults * 10) {\n    return files;\n  }\n\n  try {\n    const entries = await readdir(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const fullPath = join(dir, entry.name);\n\n      if (entry.isDirectory()) {\n        // Check if directory is blocked\n        const isBlocked = config.blockedDirectories.some(\n          blocked => entry.name === blocked\n        );\n        if (isBlocked) continue;\n\n        await findFilesToSearch(fullPath, baseDir, config, globPattern, fileType, files, depth + 1);\n      } else if (entry.isFile()) {\n        // Skip binary/excluded files\n        if (isExcludedExtension(entry.name, config.excludeExtensions)) continue;\n\n        // Check file type filter\n        if (fileType) {\n          const extensions = FILE_TYPE_MAP[fileType.toLowerCase()];\n          if (extensions) {\n            const ext = extname(entry.name).toLowerCase();\n            if (!extensions.includes(ext)) continue;\n          }\n        }\n\n        // Check glob pattern (simple matching)\n        if (globPattern) {\n          const pattern = globPattern\n            .replace(/\\./g, '\\\\.')\n            .replace(/\\*/g, '.*')\n            .replace(/\\{([^}]+)\\}/g, (_, p) => `(${p.split(',').join('|')})`);\n          const regex = new RegExp(pattern + '$');\n          if (!regex.test(entry.name)) continue;\n        }\n\n        files.push(fullPath);\n      }\n    }\n  } catch {\n    // Skip directories we can't read\n  }\n\n  return files;\n}\n\n/**\n * Search a single file for matches\n */\nasync function searchFile(\n  filePath: string,\n  regex: RegExp,\n  contextBefore: number,\n  contextAfter: number\n): Promise<GrepMatch[]> {\n  const matches: GrepMatch[] = [];\n\n  try {\n    const content = await readFile(filePath, 'utf-8');\n    const lines = content.split('\\n');\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i] ?? '';\n      regex.lastIndex = 0; // Reset regex state\n\n      if (regex.test(line)) {\n        const match: GrepMatch = {\n          file: filePath,\n          line: i + 1,\n          content: line.length > 500 ? line.substring(0, 500) + '...' : line,\n        };\n\n        // Add context if requested\n        if (contextBefore > 0 || contextAfter > 0) {\n          match.context = {\n            before: lines.slice(Math.max(0, i - contextBefore), i).map(l => l.length > 200 ? l.substring(0, 200) + '...' : l),\n            after: lines.slice(i + 1, Math.min(lines.length, i + 1 + contextAfter)).map(l => l.length > 200 ? l.substring(0, 200) + '...' : l),\n          };\n        }\n\n        matches.push(match);\n      }\n    }\n  } catch {\n    // Skip files we can't read (binary, permission issues, etc.)\n  }\n\n  return matches;\n}\n\n/**\n * Create a Grep tool with the given configuration\n */\nexport function createGrepTool(config: FilesystemToolConfig = {}): ToolFunction<GrepArgs, GrepResult> {\n  const mergedConfig = { ...DEFAULT_FILESYSTEM_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'grep',\n        description: `A powerful search tool for finding content within files.\n\nUSAGE:\n- Search for patterns using full regex syntax (e.g., \"log.*Error\", \"function\\\\s+\\\\w+\")\n- Filter files with glob parameter (e.g., \"*.js\", \"**/*.tsx\") or type parameter (e.g., \"js\", \"py\")\n- Output modes: \"content\" shows matching lines, \"files_with_matches\" shows only file paths, \"count\" shows match counts\n\nPATTERN SYNTAX:\n- Uses JavaScript regex syntax (not grep)\n- Literal braces need escaping (use \\\\{ and \\\\} to find { and })\n- Common patterns:\n  - \"TODO\" - literal text\n  - \"function\\\\s+\\\\w+\" - function declarations\n  - \"import.*from\" - import statements\n  - \"\\\\bclass\\\\b\" - word boundary matching\n\nOUTPUT MODES:\n- \"content\" - Shows matching lines with line numbers (default)\n- \"files_with_matches\" - Shows only file paths that contain matches\n- \"count\" - Shows match counts per file\n\nEXAMPLES:\n- Find TODO comments: { \"pattern\": \"TODO|FIXME\", \"type\": \"ts\" }\n- Find function calls: { \"pattern\": \"fetchUser\\\\(\", \"glob\": \"*.ts\" }\n- Find imports: { \"pattern\": \"import.*react\", \"case_insensitive\": true }\n- List files with errors: { \"pattern\": \"error\", \"output_mode\": \"files_with_matches\" }\n- Count matches: { \"pattern\": \"console\\\\.log\", \"output_mode\": \"count\" }\n\nWHEN TO USE:\n- To find where something is defined or used\n- To search for patterns across multiple files\n- To find all occurrences of a term\n- Before making bulk changes`,\n        parameters: {\n          type: 'object',\n          properties: {\n            pattern: {\n              type: 'string',\n              description: 'The regex pattern to search for in file contents',\n            },\n            path: {\n              type: 'string',\n              description: 'File or directory to search in. Defaults to current working directory.',\n            },\n            glob: {\n              type: 'string',\n              description: 'Glob pattern to filter files (e.g., \"*.js\", \"*.{ts,tsx}\")',\n            },\n            type: {\n              type: 'string',\n              description: 'File type to search (e.g., \"ts\", \"js\", \"py\", \"java\", \"go\"). More efficient than glob.',\n            },\n            output_mode: {\n              type: 'string',\n              enum: ['content', 'files_with_matches', 'count'],\n              description: 'Output mode: \"content\" shows lines, \"files_with_matches\" shows paths, \"count\" shows counts. Default: \"files_with_matches\"',\n            },\n            case_insensitive: {\n              type: 'boolean',\n              description: 'Case insensitive search (default: false)',\n            },\n            context_before: {\n              type: 'number',\n              description: 'Number of lines to show before each match (requires output_mode: \"content\")',\n            },\n            context_after: {\n              type: 'number',\n              description: 'Number of lines to show after each match (requires output_mode: \"content\")',\n            },\n            limit: {\n              type: 'number',\n              description: 'Limit output to first N results. Default: unlimited.',\n            },\n          },\n          required: ['pattern'],\n        },\n      },\n    },\n\n    describeCall: (args: GrepArgs): string => {\n      const parts = [`\"${args.pattern}\"`];\n      if (args.glob) parts.push(`in ${args.glob}`);\n      else if (args.type) parts.push(`in *.${args.type}`);\n      if (args.path) parts.push(`(${args.path})`);\n      return parts.join(' ');\n    },\n\n    execute: async (args: GrepArgs): Promise<GrepResult> => {\n      const {\n        pattern,\n        path,\n        glob: globPattern,\n        type: fileType,\n        output_mode = 'files_with_matches',\n        case_insensitive = false,\n        context_before = 0,\n        context_after = 0,\n        limit,\n      } = args;\n\n      // Determine search directory/file\n      const searchPath = path || mergedConfig.workingDirectory;\n\n      // Validate path\n      const validation = validatePath(searchPath, {\n        ...mergedConfig,\n        blockedDirectories: [], // Allow grep from any valid directory\n      });\n      if (!validation.valid) {\n        return {\n          success: false,\n          error: validation.error,\n        };\n      }\n\n      const resolvedPath = validation.resolvedPath;\n\n      // Check if path exists\n      if (!existsSync(resolvedPath)) {\n        return {\n          success: false,\n          error: `Path not found: ${searchPath}`,\n        };\n      }\n\n      // Create regex\n      let regex: RegExp;\n      try {\n        regex = new RegExp(pattern, case_insensitive ? 'gi' : 'g');\n      } catch (error) {\n        return {\n          success: false,\n          error: `Invalid regex pattern: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n\n      try {\n        // Find files to search\n        const stats = await stat(resolvedPath);\n        let filesToSearch: string[];\n\n        if (stats.isFile()) {\n          filesToSearch = [resolvedPath];\n        } else {\n          filesToSearch = await findFilesToSearch(\n            resolvedPath,\n            resolvedPath,\n            mergedConfig,\n            globPattern,\n            fileType\n          );\n        }\n\n        // Search files\n        const allMatches: GrepMatch[] = [];\n        const fileMatchCounts: Map<string, number> = new Map();\n        let filesMatched = 0;\n\n        for (const file of filesToSearch) {\n          if (limit && allMatches.length >= limit) break;\n\n          const matches = await searchFile(\n            file,\n            regex,\n            output_mode === 'content' ? context_before : 0,\n            output_mode === 'content' ? context_after : 0\n          );\n\n          if (matches.length > 0) {\n            filesMatched++;\n            const relativePath = toForwardSlash(relative(resolvedPath, file)) || file;\n\n            // Update match data with relative paths\n            for (const match of matches) {\n              match.file = relativePath;\n            }\n\n            fileMatchCounts.set(relativePath, matches.length);\n\n            if (output_mode === 'content') {\n              const remaining = limit ? limit - allMatches.length : Infinity;\n              allMatches.push(...matches.slice(0, remaining));\n            } else {\n              // For files_with_matches and count, we just need to track files\n              const firstMatch = matches[0];\n              if (firstMatch) {\n                allMatches.push(firstMatch);\n              }\n            }\n          }\n        }\n\n        // Format output based on mode\n        let resultMatches: GrepMatch[];\n\n        switch (output_mode) {\n          case 'files_with_matches':\n            // Deduplicate to just file paths\n            const uniqueFiles = new Set(allMatches.map(m => m.file));\n            resultMatches = Array.from(uniqueFiles).map(file => ({\n              file,\n              line: 0,\n              content: '',\n            }));\n            break;\n\n          case 'count':\n            resultMatches = Array.from(fileMatchCounts.entries()).map(([file, count]) => ({\n              file,\n              line: count,\n              content: `${count} matches`,\n            }));\n            break;\n\n          case 'content':\n          default:\n            resultMatches = allMatches;\n        }\n\n        const totalMatches = Array.from(fileMatchCounts.values()).reduce((a, b) => a + b, 0);\n        const truncated = limit ? allMatches.length >= limit : totalMatches >= mergedConfig.maxResults;\n\n        return {\n          success: true,\n          matches: resultMatches,\n          filesSearched: filesToSearch.length,\n          filesMatched,\n          totalMatches,\n          truncated,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Grep search failed: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Default Grep tool instance\n */\nexport const grep = createGrepTool();\n","/**\n * List Directory Tool\n *\n * Lists contents of a directory on the local filesystem.\n * Shows files and directories with metadata.\n *\n * Features:\n * - Lists files and directories\n * - Shows file sizes and modification times\n * - Supports recursive listing\n * - Filters by type (files only, directories only)\n */\n\nimport { readdir, stat } from 'node:fs/promises';\nimport { existsSync } from 'node:fs';\nimport { join, relative } from 'node:path';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type FilesystemToolConfig,\n  type FilesystemToolConfigDefaults,\n  DEFAULT_FILESYSTEM_CONFIG,\n  validatePath,\n  toForwardSlash,\n} from './types.js';\n\n/**\n * Arguments for the list directory tool\n */\nexport interface ListDirectoryArgs {\n  /** Path to the directory to list */\n  path: string;\n  /** Whether to list recursively */\n  recursive?: boolean;\n  /** Filter: \"files\" for files only, \"directories\" for directories only */\n  filter?: 'files' | 'directories';\n  /** Maximum depth for recursive listing (default: 3) */\n  max_depth?: number;\n}\n\n/**\n * A single directory entry\n */\nexport interface DirectoryEntry {\n  name: string;\n  path: string;\n  type: 'file' | 'directory';\n  size?: number;\n  modified?: string;\n}\n\n/**\n * Result of a list directory operation\n */\nexport interface ListDirectoryResult {\n  success: boolean;\n  entries?: DirectoryEntry[];\n  count?: number;\n  truncated?: boolean;\n  error?: string;\n}\n\n/**\n * Recursively list directory contents\n */\nasync function listDir(\n  dir: string,\n  baseDir: string,\n  config: FilesystemToolConfigDefaults,\n  recursive: boolean,\n  filter?: 'files' | 'directories',\n  maxDepth: number = 3,\n  currentDepth: number = 0,\n  entries: DirectoryEntry[] = []\n): Promise<DirectoryEntry[]> {\n  if (currentDepth > maxDepth || entries.length >= config.maxResults) {\n    return entries;\n  }\n\n  try {\n    const dirEntries = await readdir(dir, { withFileTypes: true });\n\n    for (const entry of dirEntries) {\n      if (entries.length >= config.maxResults) break;\n\n      const fullPath = join(dir, entry.name);\n      const relativePath = toForwardSlash(relative(baseDir, fullPath));\n\n      // Check if directory is blocked\n      if (entry.isDirectory() && config.blockedDirectories.includes(entry.name)) {\n        continue;\n      }\n\n      const isFile = entry.isFile();\n      const isDir = entry.isDirectory();\n\n      // Apply filter\n      if (filter === 'files' && !isFile) {\n        if (isDir && recursive) {\n          await listDir(fullPath, baseDir, config, recursive, filter, maxDepth, currentDepth + 1, entries);\n        }\n        continue;\n      }\n      if (filter === 'directories' && !isDir) continue;\n\n      try {\n        const stats = await stat(fullPath);\n\n        const dirEntry: DirectoryEntry = {\n          name: entry.name,\n          path: relativePath,\n          type: isFile ? 'file' : 'directory',\n        };\n\n        if (isFile) {\n          dirEntry.size = stats.size;\n        }\n        dirEntry.modified = stats.mtime.toISOString();\n\n        entries.push(dirEntry);\n\n        // Recurse into directories\n        if (isDir && recursive) {\n          await listDir(fullPath, baseDir, config, recursive, filter, maxDepth, currentDepth + 1, entries);\n        }\n      } catch {\n        // Skip entries we can't stat\n      }\n    }\n  } catch {\n    // Skip directories we can't read\n  }\n\n  return entries;\n}\n\n/**\n * Create a List Directory tool with the given configuration\n */\nexport function createListDirectoryTool(config: FilesystemToolConfig = {}): ToolFunction<ListDirectoryArgs, ListDirectoryResult> {\n  const mergedConfig = { ...DEFAULT_FILESYSTEM_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'list_directory',\n        description: `List the contents of a directory on the local filesystem.\n\nUSAGE:\n- Shows files and directories in the specified path\n- Includes file sizes and modification times\n- Can list recursively with depth limit\n- Can filter to show only files or only directories\n\nWHEN TO USE:\n- To explore a project's structure\n- To see what files exist in a directory\n- To find files before using read_file or edit_file\n- As an alternative to glob when you want to see directory structure\n\nEXAMPLES:\n- List current directory: { \"path\": \".\" }\n- List specific directory: { \"path\": \"/path/to/project/src\" }\n- List recursively: { \"path\": \".\", \"recursive\": true, \"max_depth\": 2 }\n- List only files: { \"path\": \".\", \"filter\": \"files\" }\n- List only directories: { \"path\": \".\", \"filter\": \"directories\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            path: {\n              type: 'string',\n              description: 'Path to the directory to list',\n            },\n            recursive: {\n              type: 'boolean',\n              description: 'Whether to list recursively (default: false)',\n            },\n            filter: {\n              type: 'string',\n              enum: ['files', 'directories'],\n              description: 'Filter to show only files or only directories',\n            },\n            max_depth: {\n              type: 'number',\n              description: 'Maximum depth for recursive listing (default: 3)',\n            },\n          },\n          required: ['path'],\n        },\n      },\n    },\n\n    describeCall: (args: ListDirectoryArgs): string => {\n      const flags: string[] = [];\n      if (args.recursive) flags.push('recursive');\n      if (args.filter) flags.push(args.filter);\n      if (flags.length > 0) {\n        return `${args.path} (${flags.join(', ')})`;\n      }\n      return args.path;\n    },\n\n    execute: async (args: ListDirectoryArgs): Promise<ListDirectoryResult> => {\n      const { path, recursive = false, filter, max_depth = 3 } = args;\n\n      // Validate path\n      const validation = validatePath(path, {\n        ...mergedConfig,\n        blockedDirectories: [], // Allow listing any valid directory\n      });\n      if (!validation.valid) {\n        return {\n          success: false,\n          error: validation.error,\n        };\n      }\n\n      const resolvedPath = validation.resolvedPath;\n\n      // Check if directory exists\n      if (!existsSync(resolvedPath)) {\n        return {\n          success: false,\n          error: `Directory not found: ${path}`,\n        };\n      }\n\n      try {\n        const stats = await stat(resolvedPath);\n        if (!stats.isDirectory()) {\n          return {\n            success: false,\n            error: `Path is not a directory: ${path}. Use read_file to read file contents.`,\n          };\n        }\n\n        // List directory contents\n        const entries = await listDir(\n          resolvedPath,\n          resolvedPath,\n          mergedConfig,\n          recursive,\n          filter,\n          max_depth\n        );\n\n        // Sort: directories first, then alphabetically\n        entries.sort((a, b) => {\n          if (a.type !== b.type) {\n            return a.type === 'directory' ? -1 : 1;\n          }\n          return a.name.localeCompare(b.name);\n        });\n\n        const truncated = entries.length >= mergedConfig.maxResults;\n\n        return {\n          success: true,\n          entries,\n          count: entries.length,\n          truncated,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to list directory: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Default List Directory tool instance\n */\nexport const listDirectory = createListDirectoryTool();\n","/**\n * Shell Tools - Shared Types\n *\n * Common types and configuration for shell command execution.\n */\n\n/**\n * Configuration for shell tools\n */\nexport interface ShellToolConfig {\n  /**\n   * Working directory for command execution.\n   * Defaults to process.cwd()\n   */\n  workingDirectory?: string;\n\n  /**\n   * Default timeout for commands in milliseconds.\n   * Default: 120000 (2 minutes)\n   */\n  defaultTimeout?: number;\n\n  /**\n   * Maximum timeout allowed in milliseconds.\n   * Default: 600000 (10 minutes)\n   */\n  maxTimeout?: number;\n\n  /**\n   * Shell to use for command execution.\n   * Default: '/bin/bash' on Unix, 'cmd.exe' on Windows\n   */\n  shell?: string;\n\n  /**\n   * Environment variables to add to command execution.\n   */\n  env?: Record<string, string>;\n\n  /**\n   * Commands that are blocked from execution.\n   * Default: dangerous commands like rm -rf /\n   */\n  blockedCommands?: string[];\n\n  /**\n   * Patterns that if matched will block the command.\n   * Default: patterns that could cause data loss\n   */\n  blockedPatterns?: RegExp[];\n\n  /**\n   * Maximum output size in characters before truncation.\n   * Default: 100000 (100KB)\n   */\n  maxOutputSize?: number;\n\n  /**\n   * Whether to allow running commands in background.\n   * Default: true\n   */\n  allowBackground?: boolean;\n}\n\n/**\n * Default configuration\n */\nexport const DEFAULT_SHELL_CONFIG: Required<ShellToolConfig> = {\n  workingDirectory: process.cwd(),\n  defaultTimeout: 120000, // 2 minutes\n  maxTimeout: 600000, // 10 minutes\n  shell: process.platform === 'win32' ? 'cmd.exe' : '/bin/bash',\n  env: {},\n  blockedCommands: [\n    'rm -rf /',\n    'rm -rf /*',\n    'rm -rf ~',\n    'rm -rf ~/*',\n    'mkfs',\n    'dd if=/dev/zero',\n    ':(){:|:&};:', // Fork bomb\n  ],\n  blockedPatterns: [\n    /rm\\s+(-rf?|--recursive)\\s+\\/(?!\\S)/i, // rm -rf / variations\n    />\\s*\\/dev\\/sd[a-z]/i, // Writing to disk devices\n    /mkfs/i,\n    /dd\\s+.*of=\\/dev\\//i, // dd to devices\n  ],\n  maxOutputSize: 100000,\n  allowBackground: true,\n};\n\n/**\n * Result of a bash command execution\n */\nexport interface BashResult {\n  success: boolean;\n  stdout?: string;\n  stderr?: string;\n  exitCode?: number;\n  signal?: string;\n  duration?: number;\n  truncated?: boolean;\n  error?: string;\n  backgroundId?: string;\n}\n\n/**\n * Check if a command should be blocked\n */\nexport function isBlockedCommand(\n  command: string,\n  config: ShellToolConfig = {}\n): { blocked: boolean; reason?: string } {\n  const blockedCommands = config.blockedCommands || DEFAULT_SHELL_CONFIG.blockedCommands;\n  const blockedPatterns = config.blockedPatterns || DEFAULT_SHELL_CONFIG.blockedPatterns;\n\n  // Check exact matches\n  for (const blocked of blockedCommands) {\n    if (command.includes(blocked)) {\n      return { blocked: true, reason: `Command contains blocked sequence: \"${blocked}\"` };\n    }\n  }\n\n  // Check patterns\n  for (const pattern of blockedPatterns) {\n    if (pattern.test(command)) {\n      return { blocked: true, reason: `Command matches blocked pattern` };\n    }\n  }\n\n  return { blocked: false };\n}\n","/**\n * Bash Tool\n *\n * Executes shell commands with timeout and output handling.\n * Provides safe command execution with configurable restrictions.\n *\n * Features:\n * - Configurable timeouts\n * - Output truncation for large outputs\n * - Background execution support\n * - Blocked command patterns for safety\n * - Working directory persistence\n */\n\nimport { spawn } from 'node:child_process';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport {\n  type ShellToolConfig,\n  type BashResult,\n  DEFAULT_SHELL_CONFIG,\n  isBlockedCommand,\n} from './types.js';\n\n/**\n * Arguments for the bash tool\n */\nexport interface BashArgs {\n  /** The command to execute */\n  command: string;\n  /** Optional timeout in milliseconds (up to 600000ms / 10 minutes) */\n  timeout?: number;\n  /** Description of what this command does (for clarity) */\n  description?: string;\n  /** Run the command in the background */\n  run_in_background?: boolean;\n}\n\n// Track background processes\nconst backgroundProcesses: Map<string, { process: ReturnType<typeof spawn>; output: string[] }> = new Map();\n\n/**\n * Generate a unique ID for background processes\n */\nfunction generateBackgroundId(): string {\n  return `bg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n/**\n * Create a Bash tool with the given configuration\n */\nexport function createBashTool(config: ShellToolConfig = {}): ToolFunction<BashArgs, BashResult> {\n  const mergedConfig = { ...DEFAULT_SHELL_CONFIG, ...config };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'bash',\n        description: `Execute shell commands with optional timeout.\n\nSHELL: This tool uses ${mergedConfig.shell}${process.platform === 'win32' ? ' (Windows). Use Windows command syntax (dir, type, del, etc.), NOT Unix commands (ls, cat, rm, etc.). Use \\\\ as path separator or quote paths with forward slashes.' : ' (Unix). Use standard Unix command syntax.'}\n\nUSAGE:\n- Execute any shell command\n- Working directory persists between commands\n- Commands timeout after 2 minutes by default (configurable up to 10 minutes)\n- Large outputs (>100KB) will be truncated\n\nIMPORTANT: This tool is for terminal operations like git, npm, docker, etc.\nFor file operations, prefer dedicated tools:\n- Use read_file instead of cat/head/tail\n- Use edit_file instead of sed/awk\n- Use write_file instead of echo with redirection\n- Use glob instead of find\n- Use grep tool instead of grep command\n\nBEST PRACTICES:\n- Always quote file paths with spaces: cd \"/path with spaces\"\n- Use absolute paths when possible${process.platform === 'win32' ? `\n- Chain dependent commands with &&: git add . && git commit -m \"msg\"\n- Use PowerShell syntax if cmd.exe is insufficient` : `\n- Chain dependent commands with &&: git add . && git commit -m \"msg\"\n- Use ; only when you don't care if earlier commands fail`}\n- Avoid interactive commands (no -i flags)\n\nGIT SAFETY:\n- NEVER run destructive commands (push --force, reset --hard, clean -f) without explicit permission\n- NEVER update git config\n- NEVER skip hooks (--no-verify) without permission\n- Always create NEW commits rather than amending\n- Stage specific files rather than using \"git add -A\"\n\nEXAMPLES:\n- Run npm install: { \"command\": \"npm install\", \"description\": \"Install dependencies\" }\n- Check git status: { \"command\": \"git status\", \"description\": \"Show working tree status\" }\n- Run tests: { \"command\": \"npm test\", \"timeout\": 300000, \"description\": \"Run test suite\" }\n- Build project: { \"command\": \"npm run build\", \"description\": \"Build the project\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            command: {\n              type: 'string',\n              description: 'The shell command to execute',\n            },\n            timeout: {\n              type: 'number',\n              description: 'Optional timeout in milliseconds (max 600000ms / 10 minutes)',\n            },\n            description: {\n              type: 'string',\n              description: 'Clear, concise description of what this command does',\n            },\n            run_in_background: {\n              type: 'boolean',\n              description: 'Run the command in the background. Returns immediately with a background ID.',\n            },\n          },\n          required: ['command'],\n        },\n      },\n    },\n\n    describeCall: (args: BashArgs): string => {\n      const cmd = args.command;\n      const maxLen = 60;\n      const prefix = args.run_in_background ? '[bg] ' : '';\n      if (cmd.length > maxLen - prefix.length) {\n        return prefix + cmd.slice(0, maxLen - prefix.length - 3) + '...';\n      }\n      return prefix + cmd;\n    },\n\n    execute: async (args: BashArgs): Promise<BashResult> => {\n      const {\n        command,\n        timeout = mergedConfig.defaultTimeout,\n        run_in_background = false,\n      } = args;\n\n      // Check for blocked commands\n      const blockCheck = isBlockedCommand(command, mergedConfig);\n      if (blockCheck.blocked) {\n        return {\n          success: false,\n          error: `Command blocked for safety: ${blockCheck.reason}`,\n        };\n      }\n\n      // Validate timeout\n      const effectiveTimeout = Math.min(timeout, mergedConfig.maxTimeout);\n\n      // Prepare environment\n      const env = {\n        ...process.env,\n        ...mergedConfig.env,\n      };\n\n      return new Promise((resolve) => {\n        const startTime = Date.now();\n\n        // Spawn the process in a new process group (detached) so we can\n        // kill the entire tree on timeout, not just the shell process.\n        // Without this, child processes (e.g. npm run dev  node server)\n        // keep stdout/stderr pipes open and the Promise never resolves.\n        const childProcess = spawn(command, [], {\n          shell: mergedConfig.shell,\n          cwd: mergedConfig.workingDirectory,\n          env,\n          stdio: ['pipe', 'pipe', 'pipe'],\n          detached: true,\n        });\n\n        // Handle background execution\n        if (run_in_background && mergedConfig.allowBackground) {\n          const bgId = generateBackgroundId();\n          const output: string[] = [];\n\n          backgroundProcesses.set(bgId, { process: childProcess, output });\n\n          childProcess.stdout.on('data', (data) => {\n            output.push(data.toString());\n          });\n\n          childProcess.stderr.on('data', (data) => {\n            output.push(data.toString());\n          });\n\n          childProcess.on('close', () => {\n            // Keep output for a while after completion\n            setTimeout(() => {\n              backgroundProcesses.delete(bgId);\n            }, 300000); // 5 minutes\n          });\n\n          resolve({\n            success: true,\n            backgroundId: bgId,\n            stdout: `Command started in background with ID: ${bgId}`,\n          });\n          return;\n        }\n\n        let stdout = '';\n        let stderr = '';\n        let killed = false;\n\n        // Helper to kill the entire process group (not just the shell).\n        // Uses negative PID to signal the whole group created by detached: true.\n        const killProcessGroup = (signal: NodeJS.Signals): void => {\n          try {\n            if (childProcess.pid) {\n              process.kill(-childProcess.pid, signal);\n            }\n          } catch {\n            // Process group may already be gone; fall back to direct kill\n            try { childProcess.kill(signal); } catch { /* already dead */ }\n          }\n        };\n\n        // Set up timeout - kills entire process tree\n        const GRACEFUL_KILL_WAIT_MS = 3000;\n        const timeoutId = setTimeout(() => {\n          killed = true;\n          killProcessGroup('SIGTERM');\n          setTimeout(() => {\n            if (!childProcess.killed) {\n              killProcessGroup('SIGKILL');\n            }\n          }, GRACEFUL_KILL_WAIT_MS);\n        }, effectiveTimeout);\n\n        // Collect stdout\n        childProcess.stdout.on('data', (data) => {\n          stdout += data.toString();\n          // Prevent memory issues with huge outputs\n          if (stdout.length > mergedConfig.maxOutputSize * 2) {\n            stdout = stdout.slice(-mergedConfig.maxOutputSize);\n          }\n        });\n\n        // Collect stderr\n        childProcess.stderr.on('data', (data) => {\n          stderr += data.toString();\n          if (stderr.length > mergedConfig.maxOutputSize * 2) {\n            stderr = stderr.slice(-mergedConfig.maxOutputSize);\n          }\n        });\n\n        let resolved = false;\n        const safeResolve = (result: BashResult): void => {\n          if (resolved) return;\n          resolved = true;\n          clearTimeout(timeoutId);\n          clearTimeout(hardTimeoutId);\n          resolve(result);\n        };\n\n        // Hard safety-net timeout: if 'close' event never fires (e.g. orphaned\n        // child processes still holding pipes), force-resolve after an extra grace period.\n        const HARD_TIMEOUT_GRACE_MS = 5000;\n        const hardTimeoutId = setTimeout(() => {\n          if (!resolved) {\n            // Last resort: try SIGKILL on the group\n            killProcessGroup('SIGKILL');\n            safeResolve({\n              success: false,\n              stdout,\n              stderr,\n              duration: Date.now() - startTime,\n              error: `Command timed out after ${effectiveTimeout}ms (hard timeout: process group did not exit)`,\n            });\n          }\n        }, effectiveTimeout + GRACEFUL_KILL_WAIT_MS + HARD_TIMEOUT_GRACE_MS);\n\n        // Handle process completion\n        childProcess.on('close', (code, signal) => {\n          const duration = Date.now() - startTime;\n\n          // Truncate output if needed\n          let truncated = false;\n          if (stdout.length > mergedConfig.maxOutputSize) {\n            stdout = stdout.slice(0, mergedConfig.maxOutputSize) + '\\n... (output truncated)';\n            truncated = true;\n          }\n          if (stderr.length > mergedConfig.maxOutputSize) {\n            stderr = stderr.slice(0, mergedConfig.maxOutputSize) + '\\n... (output truncated)';\n            truncated = true;\n          }\n\n          if (killed) {\n            safeResolve({\n              success: false,\n              stdout,\n              stderr,\n              exitCode: code ?? undefined,\n              signal: signal ?? undefined,\n              duration,\n              truncated,\n              error: `Command timed out after ${effectiveTimeout}ms`,\n            });\n          } else {\n            safeResolve({\n              success: code === 0,\n              stdout,\n              stderr,\n              exitCode: code ?? undefined,\n              signal: signal ?? undefined,\n              duration,\n              truncated,\n              error: code !== 0 ? `Command exited with code ${code}` : undefined,\n            });\n          }\n        });\n\n        // Handle spawn errors\n        childProcess.on('error', (error) => {\n          safeResolve({\n            success: false,\n            error: `Failed to execute command: ${error.message}`,\n            duration: Date.now() - startTime,\n          });\n        });\n      });\n    },\n  };\n}\n\n/**\n * Get output from a background process\n */\nexport function getBackgroundOutput(bgId: string): { found: boolean; output?: string; running?: boolean } {\n  const bg = backgroundProcesses.get(bgId);\n  if (!bg) {\n    return { found: false };\n  }\n\n  return {\n    found: true,\n    output: bg.output.join(''),\n    running: !bg.process.killed && bg.process.exitCode === null,\n  };\n}\n\n/**\n * Kill a background process\n */\nexport function killBackgroundProcess(bgId: string): boolean {\n  const bg = backgroundProcesses.get(bgId);\n  if (!bg) {\n    return false;\n  }\n\n  bg.process.kill('SIGTERM');\n  return true;\n}\n\n/**\n * Default Bash tool instance\n */\nexport const bash = createBashTool();\n","/**\n * Path utilities for dot notation path manipulation in JSON objects\n */\n\n/**\n * Parse dot notation path into array of keys\n *\n * Examples:\n *   'user.name'  ['user', 'name']\n *   'users.0.name'  ['users', '0', 'name']\n *   'settings.theme.colors.primary'  ['settings', 'theme', 'colors', 'primary']\n *   ''  []\n */\nexport function parsePath(path: string): string[] {\n  if (path === '' || path === '$') {\n    return [];\n  }\n\n  const keys = path.split('.');\n\n  // Filter out empty strings (from consecutive dots)\n  const filtered = keys.filter((p) => p.length > 0);\n\n  // Validate no consecutive dots\n  if (filtered.length !== keys.length) {\n    throw new Error(`Invalid path format: ${path} (consecutive dots not allowed)`);\n  }\n\n  return filtered;\n}\n\n/**\n * Get value at path in object\n *\n * Returns undefined if path doesn't exist\n */\nexport function getValueAtPath(obj: any, path: string): any {\n  const keys = parsePath(path);\n  let current = obj;\n\n  for (const key of keys) {\n    if (current === null || current === undefined) {\n      return undefined;\n    }\n\n    // Handle both object properties and array indices\n    current = current[key];\n  }\n\n  return current;\n}\n\n/**\n * Set value at path in object (mutates the object)\n *\n * Creates intermediate objects/arrays as needed\n *\n * @returns true if successful\n * @throws Error if path is invalid or root-level\n */\nexport function setValueAtPath(obj: any, path: string, value: any): boolean {\n  const keys = parsePath(path);\n\n  if (keys.length === 0) {\n    throw new Error('Cannot set root object - path must not be empty');\n  }\n\n  let current = obj;\n\n  // Navigate to parent of target\n  for (let i = 0; i < keys.length - 1; i++) {\n    const key = keys[i]!;\n\n    // Create intermediate objects/arrays if they don't exist\n    if (!(key in current) || current[key] === null || current[key] === undefined) {\n      // Check if next key is numeric (array index)\n      const nextKey = keys[i + 1];\n      const isArrayIndex = nextKey !== undefined && /^\\d+$/.test(nextKey);\n\n      current[key] = isArrayIndex ? [] : {};\n    }\n\n    current = current[key];\n\n    // Validate we can continue navigation\n    if (current === null || current === undefined) {\n      throw new Error(`Cannot navigate through null/undefined at path: ${keys.slice(0, i + 1).join('.')}`);\n    }\n  }\n\n  // Set the final value\n  const lastKey = keys[keys.length - 1]!;\n\n  // For arrays, handle numeric indices\n  if (Array.isArray(current)) {\n    const index = parseInt(lastKey);\n    if (isNaN(index)) {\n      throw new Error(`Array index must be numeric, got: ${lastKey}`);\n    }\n    // Allow appending beyond array length\n    current[index] = value;\n  } else {\n    current[lastKey] = value;\n  }\n\n  return true;\n}\n\n/**\n * Delete value at path in object (mutates the object)\n *\n * @returns true if deleted, false if path doesn't exist\n * @throws Error if path is invalid or root-level\n */\nexport function deleteAtPath(obj: any, path: string): boolean {\n  const keys = parsePath(path);\n\n  if (keys.length === 0) {\n    throw new Error('Cannot delete root object - path must not be empty');\n  }\n\n  let current = obj;\n\n  // Navigate to parent\n  for (let i = 0; i < keys.length - 1; i++) {\n    const key = keys[i]!;\n\n    if (!(key in current)) {\n      return false; // Path doesn't exist\n    }\n\n    current = current[key];\n\n    if (current === null || current === undefined) {\n      return false; // Can't navigate further\n    }\n  }\n\n  const lastKey = keys[keys.length - 1]!;\n\n  // Check if key exists\n  if (!(lastKey in current)) {\n    return false;\n  }\n\n  // Delete from array or object\n  if (Array.isArray(current)) {\n    const index = parseInt(lastKey);\n    if (isNaN(index) || index < 0 || index >= current.length) {\n      return false;\n    }\n    current.splice(index, 1);\n  } else {\n    delete current[lastKey];\n  }\n\n  return true;\n}\n\n/**\n * Check if path exists in object\n */\nexport function pathExists(obj: any, path: string): boolean {\n  try {\n    const value = getValueAtPath(obj, path);\n    return value !== undefined;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validate path format\n *\n * @returns true if valid, throws Error with message if invalid\n */\nexport function validatePath(path: string): boolean {\n  // Empty path is valid (represents root)\n  if (path === '' || path === '$') {\n    return true;\n  }\n\n  // Check for invalid characters\n  if (path.includes('..')) {\n    throw new Error('Invalid path: consecutive dots not allowed');\n  }\n\n  if (path.startsWith('.') || path.endsWith('.')) {\n    throw new Error('Invalid path: cannot start or end with dot');\n  }\n\n  // Try to parse it\n  parsePath(path);\n\n  return true;\n}\n","/**\n * JSON Manipulation Tool\n *\n * Allows AI agents to manipulate JSON objects using dot notation paths.\n * Supports delete, add, and replace operations at any depth.\n */\n\nimport { ToolFunction } from '../../domain/entities/Tool.js';\nimport { setValueAtPath, deleteAtPath, pathExists } from './pathUtils.js';\n\ninterface JsonManipulateArgs {\n  operation: 'delete' | 'add' | 'replace';\n  path: string;\n  value?: any;\n  object: any;\n}\n\ninterface JsonManipulateResult {\n  success: boolean;\n  result: any | null;\n  message?: string;\n  error?: string;\n}\n\nexport const jsonManipulator: ToolFunction<JsonManipulateArgs, JsonManipulateResult> = {\n  definition: {\n    type: 'function',\n    function: {\n      name: 'json_manipulate',\n      description: `Manipulate JSON objects by deleting, adding, or replacing fields at any depth.\n\nIMPORTANT - PATH FORMAT (DOT NOTATION):\nUse dots to separate nested field names. Examples:\n Top-level field: \"name\"\n Nested field: \"user.email\"\n Array element: \"users.0.name\" (where 0 is the array index)\n Deep nesting: \"settings.theme.colors.primary\"\n For root operations: use empty string \"\"\n\nOPERATIONS:\n\n1. DELETE - Remove a field from the object\n    Removes the specified field and its value\n    Returns error if path doesn't exist\n    Example: operation=\"delete\", path=\"user.address.city\"\n    Result: The city field is removed from user.address\n\n2. ADD - Add a new field to the object\n    Creates intermediate objects/arrays if they don't exist\n    If field already exists, it will be overwritten\n    Example: operation=\"add\", path=\"user.phone\", value=\"+1234567890\"\n    Result: Creates user.phone field with the phone number\n\n3. REPLACE - Replace the value of an EXISTING field\n    Only works if the field already exists (use ADD for new fields)\n    Returns error if path doesn't exist\n    Example: operation=\"replace\", path=\"user.name\", value=\"Jane Doe\"\n    Result: Changes the existing user.name value\n\nARRAY OPERATIONS:\n Access array elements by index: \"users.0.name\" (first user's name)\n Add to array: \"users.2\" appends if index >= array length\n Delete from array: \"users.1\" removes element and shifts remaining items\n\nCOMPLETE EXAMPLES:\n\nExample 1 - Delete a field:\n  Input: { operation: \"delete\", path: \"user.email\", object: {user: {name: \"John\", email: \"j@ex.com\"}} }\n  Output: {user: {name: \"John\"}}\n\nExample 2 - Add nested field (auto-creates intermediate objects):\n  Input: { operation: \"add\", path: \"user.address.city\", value: \"Paris\", object: {user: {name: \"John\"}} }\n  Output: {user: {name: \"John\", address: {city: \"Paris\"}}}\n\nExample 3 - Replace value:\n  Input: { operation: \"replace\", path: \"settings.theme\", value: \"dark\", object: {settings: {theme: \"light\"}} }\n  Output: {settings: {theme: \"dark\"}}\n\nExample 4 - Array manipulation:\n  Input: { operation: \"replace\", path: \"users.0.active\", value: false, object: {users: [{name: \"Bob\", active: true}]} }\n  Output: {users: [{name: \"Bob\", active: false}]}\n\nThe tool returns a result object with:\n success: boolean (true if operation succeeded)\n result: the modified JSON object (or null if failed)\n message: success message (if succeeded)\n error: error description (if failed)`,\n\n      parameters: {\n        type: 'object',\n        properties: {\n          operation: {\n            type: 'string',\n            enum: ['delete', 'add', 'replace'],\n            description:\n              'The operation to perform. \"delete\" removes a field, \"add\" creates a new field (or overwrites existing), \"replace\" changes an existing field value.',\n          },\n          path: {\n            type: 'string',\n            description:\n              'Dot notation path to the field. Examples: \"name\", \"user.email\", \"users.0.name\", \"settings.theme.colors.primary\". Use empty string \"\" only for root-level operations.',\n          },\n          value: {\n            description:\n              'The value to add or replace. Can be any JSON-compatible type: string, number, boolean, object, array, or null. Required for add/replace operations, ignored for delete.',\n          },\n          object: {\n            type: 'object',\n            description:\n              'The JSON object to manipulate. The original object is not modified; a new modified copy is returned in the result.',\n          },\n        },\n        required: ['operation', 'path', 'object'],\n      },\n    },\n    blocking: true, // Always wait for result\n    timeout: 10000, // 10 seconds should be plenty for JSON operations\n  },\n\n  execute: async (args: JsonManipulateArgs): Promise<JsonManipulateResult> => {\n    try {\n      // Validate operation\n      if (!['delete', 'add', 'replace'].includes(args.operation)) {\n        return {\n          success: false,\n          result: null,\n          error: `Invalid operation: \"${args.operation}\". Must be \"delete\", \"add\", or \"replace\".`,\n        };\n      }\n\n      // Validate object is provided\n      if (!args.object || typeof args.object !== 'object') {\n        return {\n          success: false,\n          result: null,\n          error: 'Invalid object: must provide a valid JSON object',\n        };\n      }\n\n      // Clone object to avoid mutation (deep clone)\n      let clonedObject: any;\n      try {\n        clonedObject = JSON.parse(JSON.stringify(args.object));\n      } catch (error: any) {\n        return {\n          success: false,\n          result: null,\n          error: `Cannot clone object: ${error.message}. Object may contain circular references or non-JSON values.`,\n        };\n      }\n\n      // Perform operation\n      switch (args.operation) {\n        case 'delete': {\n          try {\n            const deleted = deleteAtPath(clonedObject, args.path);\n\n            if (!deleted) {\n              return {\n                success: false,\n                result: null,\n                error: `Path not found: \"${args.path}\". The field does not exist in the object.`,\n              };\n            }\n\n            return {\n              success: true,\n              result: clonedObject,\n              message: `Successfully deleted field at path: \"${args.path}\"`,\n            };\n          } catch (error: any) {\n            return {\n              success: false,\n              result: null,\n              error: `Delete operation failed: ${error.message}`,\n            };\n          }\n        }\n\n        case 'add': {\n          // Validate value is provided\n          if (args.value === undefined) {\n            return {\n              success: false,\n              result: null,\n              error: 'Add operation requires a \"value\" parameter',\n            };\n          }\n\n          try {\n            setValueAtPath(clonedObject, args.path, args.value);\n\n            return {\n              success: true,\n              result: clonedObject,\n              message: `Successfully added field at path: \"${args.path}\"`,\n            };\n          } catch (error: any) {\n            return {\n              success: false,\n              result: null,\n              error: `Add operation failed: ${error.message}`,\n            };\n          }\n        }\n\n        case 'replace': {\n          // Validate value is provided\n          if (args.value === undefined) {\n            return {\n              success: false,\n              result: null,\n              error: 'Replace operation requires a \"value\" parameter',\n            };\n          }\n\n          // Check if path exists (replace only works on existing paths)\n          if (!pathExists(clonedObject, args.path)) {\n            return {\n              success: false,\n              result: null,\n              error: `Path not found: \"${args.path}\". Use \"add\" operation to create new fields.`,\n            };\n          }\n\n          try {\n            setValueAtPath(clonedObject, args.path, args.value);\n\n            return {\n              success: true,\n              result: clonedObject,\n              message: `Successfully replaced value at path: \"${args.path}\"`,\n            };\n          } catch (error: any) {\n            return {\n              success: false,\n              result: null,\n              error: `Replace operation failed: ${error.message}`,\n            };\n          }\n        }\n\n        default:\n          return {\n            success: false,\n            result: null,\n            error: `Unknown operation: ${args.operation}`,\n          };\n      }\n    } catch (error: any) {\n      return {\n        success: false,\n        result: null,\n        error: `Unexpected error manipulating JSON: ${error.message}`,\n      };\n    }\n  },\n};\n","/**\n * Web Tools Registration\n *\n * Registers web search and scrape tool factories with ConnectorTools.\n * When a connector with a matching serviceType is used,\n * these tools become available via `ConnectorTools.for(connectorName)`.\n */\n\nimport { ConnectorTools } from '../connector/ConnectorTools.js';\nimport type { Connector } from '../../core/Connector.js';\nimport { createWebSearchTool } from './createWebSearchTool.js';\nimport { createWebScrapeTool } from './createWebScrapeTool.js';\n\n/** Search service types that get the web_search tool */\nconst SEARCH_SERVICE_TYPES = ['serper', 'brave-search', 'tavily', 'rapidapi-search'];\n\n/** Scrape service types that get the web_scrape tool */\nconst SCRAPE_SERVICE_TYPES = ['zenrows', 'jina-reader', 'firecrawl', 'scrapingbee'];\n\n/**\n * Register web tool factories with the ConnectorTools framework.\n *\n * After calling this:\n * - `ConnectorTools.for('my-serper')` returns [my-serper_api, my-serper_web_search]\n * - `ConnectorTools.for('my-zenrows')` returns [my-zenrows_api, my-zenrows_web_scrape]\n */\nexport function registerWebTools(): void {\n  // Register search tool for each search service type\n  for (const st of SEARCH_SERVICE_TYPES) {\n    ConnectorTools.registerService(st, (connector: Connector) => [\n      createWebSearchTool(connector),\n    ]);\n  }\n\n  // Register scrape tool for each scrape service type\n  for (const st of SCRAPE_SERVICE_TYPES) {\n    ConnectorTools.registerService(st, (connector: Connector) => [\n      createWebScrapeTool(connector),\n    ]);\n  }\n}\n","/**\n * Web Search Tool Factory\n *\n * Creates a web_search tool bound to a specific Connector.\n * Follows the ConnectorTools pattern (like GitHub tools).\n *\n * Usage:\n *   ConnectorTools.registerService('serper', (connector) => [createWebSearchTool(connector)]);\n *   // or directly:\n *   const tool = createWebSearchTool(myConnector);\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport { SearchProvider } from '../../capabilities/search/index.js';\nimport type { SearchResult, SearchResponse } from '../../capabilities/search/index.js';\nimport { logger } from '../../infrastructure/observability/Logger.js';\n\nconst searchLogger = logger.child({ component: 'webSearch' });\n\n/**\n * Arguments for web_search tool\n */\ninterface WebSearchArgs {\n  /** Search query string */\n  query: string;\n  /** Number of results to return (default: 10) */\n  numResults?: number;\n  /** Country/region code (e.g., 'us', 'gb') */\n  country?: string;\n  /** Language code (e.g., 'en', 'fr') */\n  language?: string;\n}\n\ninterface WebSearchResult {\n  success: boolean;\n  query: string;\n  provider: string;\n  results: SearchResult[];\n  count: number;\n  error?: string;\n}\n\n/**\n * Create a web_search tool bound to a specific connector.\n *\n * @param connector - Connector instance providing auth for the search API\n */\nexport function createWebSearchTool(\n  connector: Connector,\n): ToolFunction<WebSearchArgs, WebSearchResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'web_search',\n        description: `Search the web and get relevant results with snippets.\n\nRETURNS:\nAn array of search results, each containing:\n- title: Page title\n- url: Direct URL to the page\n- snippet: Short description/excerpt from the page\n- position: Search ranking position (1, 2, 3...)\n\nUSE CASES:\n- Find current information on any topic\n- Research multiple sources\n- Discover relevant websites\n- Find URLs to fetch with web_fetch tool\n\nWORKFLOW PATTERN:\n1. Use web_search to find relevant URLs\n2. Use web_fetch to get full content from top results\n3. Process and summarize the information\n\nEXAMPLE:\n{\n  \"query\": \"latest AI developments 2026\",\n  \"numResults\": 5\n}`,\n\n        parameters: {\n          type: 'object',\n          properties: {\n            query: {\n              type: 'string',\n              description: 'The search query string. Be specific for better results.',\n            },\n            numResults: {\n              type: 'number',\n              description: 'Number of results to return (default: 10, max: 100).',\n            },\n            country: {\n              type: 'string',\n              description: 'Country/region code for localized results (e.g., \"us\", \"gb\", \"de\")',\n            },\n            language: {\n              type: 'string',\n              description: 'Language code for results (e.g., \"en\", \"fr\", \"de\")',\n            },\n          },\n          required: ['query'],\n        },\n      },\n      blocking: true,\n      timeout: 15000,\n    },\n\n    execute: async (args: WebSearchArgs): Promise<WebSearchResult> => {\n      const numResults = args.numResults || 10;\n\n      searchLogger.debug({ connectorName: connector.name }, 'Executing search with connector');\n\n      try {\n        const searchProvider = SearchProvider.create({ connector: connector.name });\n\n        const response: SearchResponse = await searchProvider.search(args.query, {\n          numResults,\n          country: args.country,\n          language: args.language,\n        });\n\n        if (response.success) {\n          searchLogger.debug({\n            provider: response.provider,\n            count: response.count,\n          }, 'Search completed successfully');\n        } else {\n          searchLogger.warn({\n            provider: response.provider,\n            error: response.error,\n          }, 'Search failed');\n        }\n\n        return {\n          success: response.success,\n          query: response.query,\n          provider: response.provider,\n          results: response.results,\n          count: response.count,\n          error: response.error,\n        };\n      } catch (error: any) {\n        searchLogger.error({ error: error.message, connectorName: connector.name }, 'Search threw exception');\n        return {\n          success: false,\n          query: args.query,\n          provider: connector.name,\n          results: [],\n          count: 0,\n          error: error.message || 'Unknown error',\n        };\n      }\n    },\n\n    describeCall: (args: WebSearchArgs) => `\"${args.query}\"${args.numResults ? ` (${args.numResults} results)` : ''}`,\n  };\n}\n","/**\n * Content quality detection for web scraping\n * Detects if content is valid, requires JavaScript, or has errors\n */\n\nimport type { CheerioAPI } from 'cheerio';\n\nexport interface QualityResult {\n  score: number; // 0-100\n  requiresJS: boolean;\n  suggestion?: string;\n  issues: string[];\n}\n\n/**\n * Detect content quality from HTML and extracted text\n */\nexport function detectContentQuality(\n  html: string,\n  text: string,\n  $: CheerioAPI\n): QualityResult {\n  const issues: string[] = [];\n  let score = 100;\n  let requiresJS = false;\n\n  // Check 1: Empty or very short content\n  if (text.length < 100) {\n    issues.push('Very little text content extracted');\n    score -= 40;\n    requiresJS = true;\n  }\n\n  // Check 2: Detect common error patterns\n  const errorPatterns = [\n    { pattern: /access denied/i, penalty: 50 },\n    { pattern: /403 forbidden/i, penalty: 50 },\n    { pattern: /404 not found/i, penalty: 50 },\n    { pattern: /page not found/i, penalty: 40 },\n    { pattern: /cloudflare/i, penalty: 30 },\n    { pattern: /please enable javascript/i, penalty: 40 },\n    { pattern: /requires javascript/i, penalty: 40 },\n    { pattern: /robot|bot detection/i, penalty: 30 },\n  ];\n\n  for (const { pattern, penalty } of errorPatterns) {\n    if (pattern.test(html) || pattern.test(text)) {\n      issues.push(`Error pattern detected: ${pattern.source}`);\n      score -= penalty;\n    }\n  }\n\n  // Check 3: Mostly script tags (code dumps)\n  const scriptCount = $('script').length;\n  const textLength = text.length;\n\n  if (scriptCount > 10 && textLength < 500) {\n    issues.push('Page is mostly JavaScript code (code dump)');\n    score -= 40;\n    requiresJS = true;\n  }\n\n  // Check 4: High script-to-content ratio\n  const scriptLength = $('script').text().length;\n  if (scriptLength > textLength * 2 && textLength < 1000) {\n    issues.push('High JavaScript-to-content ratio');\n    score -= 20;\n    requiresJS = true;\n  }\n\n  // Check 5: Common JS framework markers\n  const jsFrameworks = [\n    { pattern: /\\breact\\b/i, name: 'React' },\n    { pattern: /\\bvue\\b/i, name: 'Vue' },\n    { pattern: /\\bangular\\b/i, name: 'Angular' },\n    { pattern: /__NEXT_DATA__/i, name: 'Next.js' },\n    { pattern: /\\bwebpack\\b/i, name: 'Webpack' },\n    { pattern: /_app-.*\\.js/i, name: 'SPA' },\n  ];\n\n  for (const framework of jsFrameworks) {\n    if (framework.pattern.test(html)) {\n      issues.push(`${framework.name} framework detected`);\n      requiresJS = true;\n    }\n  }\n\n  // Check 6: Empty body with divs (typical SPA)\n  const bodyText = $('body').text().trim();\n  const divCount = $('div').length;\n\n  if (bodyText.length < 100 && divCount > 5) {\n    issues.push('Empty body with many divs (likely Single Page App)');\n    score -= 30;\n    requiresJS = true;\n  }\n\n  // Check 7: Noscript tag with meaningful content\n  const noscript = $('noscript').text();\n  if (noscript.length > 50) {\n    issues.push('Noscript tag present (site requires JavaScript)');\n    requiresJS = true;\n  }\n\n  // Check 8: Very few paragraphs/headings (typical of SPA skeleton)\n  const paragraphCount = $('p').length;\n  const headingCount = $('h1, h2, h3, h4, h5, h6').length;\n\n  if (paragraphCount < 3 && headingCount < 2 && textLength < 500) {\n    issues.push('Very few content elements (likely needs JavaScript)');\n    score -= 20;\n    requiresJS = true;\n  }\n\n  // Generate suggestion\n  let suggestion: string | undefined;\n  if (requiresJS && score < 50) {\n    suggestion =\n      'Content quality is low. This appears to be a JavaScript-rendered site. Use a scraping service connector for better results.';\n  } else if (score < 30) {\n    suggestion = 'Content extraction failed or page has errors. Check the URL and try again.';\n  }\n\n  return {\n    score: Math.max(0, Math.min(100, score)),\n    requiresJS,\n    suggestion,\n    issues,\n  };\n}\n\n/**\n * Check if content looks like an error page\n */\nexport function isErrorPage(statusCode: number, html: string, text: string): boolean {\n  if (statusCode >= 400) return true;\n\n  const errorIndicators = [\n    /404|not found/i,\n    /403|forbidden|access denied/i,\n    /500|internal server error/i,\n    /503|service unavailable/i,\n  ];\n\n  for (const pattern of errorIndicators) {\n    if (pattern.test(html) || pattern.test(text)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Extract clean text content from HTML\n */\nexport function extractCleanText($: CheerioAPI): string {\n  // Remove unwanted elements\n  $('script, style, noscript, iframe, nav, footer, header, aside').remove();\n\n  // Remove common ad/tracking divs\n  $('[class*=\"ad-\"], [class*=\"advertisement\"], [id*=\"ad-\"]').remove();\n  $('[class*=\"cookie\"], [class*=\"gdpr\"]').remove();\n\n  // Get text from main content areas (prioritized)\n  const mainSelectors = [\n    'main',\n    'article',\n    '[role=\"main\"]',\n    '.content',\n    '#content',\n    '.post',\n    '.article',\n  ];\n\n  for (const selector of mainSelectors) {\n    const mainContent = $(selector).text().trim();\n    if (mainContent.length > 200) {\n      return mainContent;\n    }\n  }\n\n  // Fallback to body\n  return $('body').text().trim();\n}\n","/**\n * Web Fetch Tool - Simple HTTP fetch with content quality detection\n */\n\nimport { load } from 'cheerio';\nimport { ToolFunction } from '../../domain/entities/Tool.js';\nimport { detectContentQuality } from './contentDetector.js';\nimport { htmlToMarkdown } from './htmlToMarkdown.js';\nimport { FormatDetector } from '../../capabilities/documents/FormatDetector.js';\nimport { DocumentReader, mergeTextPieces } from '../../capabilities/documents/DocumentReader.js';\n\ninterface WebFetchArgs {\n  url: string;\n  userAgent?: string;\n  timeout?: number;\n}\n\ninterface WebFetchResult {\n  success: boolean;\n  url: string;\n  title: string;\n  content: string;\n  contentType: 'html' | 'json' | 'text' | 'document' | 'error';\n  qualityScore: number;\n  requiresJS: boolean;\n  suggestedAction?: string;\n  issues?: string[];\n  error?: string;\n  // Markdown conversion metadata\n  excerpt?: string;\n  byline?: string;\n  wasReadabilityUsed?: boolean;\n  wasTruncated?: boolean;\n  // Document metadata (when contentType is 'document')\n  documentMetadata?: Record<string, unknown>;\n}\n\nexport const webFetch: ToolFunction<WebFetchArgs, WebFetchResult> = {\n  definition: {\n    type: 'function',\n    function: {\n      name: 'web_fetch',\n      description: `Fetch and extract content from a URL  works with web pages AND document files (PDF, DOCX, XLSX, PPTX, etc.). Document URLs are automatically detected and converted to markdown text.\n\nWEB PAGES:\nThis tool performs HTTP fetch and HTML parsing. It works well for:\n- Static websites (blogs, documentation, articles)\n- Server-rendered HTML pages\n- Content that doesn't require JavaScript\n\nDOCUMENT URLs:\nWhen the URL points to a document file (detected via Content-Type header or URL extension), the document is automatically downloaded and converted to markdown:\n- PDF files: extracted as markdown with per-page sections\n- Word (.docx), PowerPoint (.pptx): converted to structured markdown\n- Excel (.xlsx), CSV, ODS: tables converted to markdown tables\n- OpenDocument formats (.odt, .odp, .ods): converted like MS Office equivalents\n- Returns contentType: \"document\" and includes documentMetadata in the result\n\nLIMITATIONS:\n- Cannot execute JavaScript\n- May fail on React/Vue/Angular sites (will return low quality score)\n- May get blocked by bot protection\n- Cannot handle dynamic content loading\n\nQUALITY DETECTION:\nThe tool analyzes the fetched content and returns a quality score (0-100):\n- 80-100: Excellent quality, content extracted successfully\n- 50-79: Moderate quality, some content extracted\n- 0-49: Low quality, likely needs JavaScript or has errors\n\nIf the quality score is low or requiresJS is true, consider using a scraping service connector for better results.\n\nRETURNS:\n{\n  success: boolean,\n  url: string,\n  title: string,\n  content: string,          // Clean markdown (converted from HTML or document)\n  contentType: string,      // 'html' | 'json' | 'text' | 'document' | 'error'\n  qualityScore: number,     // 0-100 (quality of extraction)\n  requiresJS: boolean,      // True if site likely needs JavaScript\n  suggestedAction: string,  // Suggestion if quality is low\n  issues: string[],         // List of detected issues\n  excerpt: string,          // Short summary excerpt (if extracted)\n  byline: string,           // Author info (if extracted)\n  wasTruncated: boolean,    // True if content was truncated\n  documentMetadata: object, // Document metadata (format, pages, etc.)  only for document URLs\n  error: string             // Error message if failed\n}\n\nEXAMPLES:\nFetch a blog post:\n{\n  url: \"https://example.com/blog/article\"\n}\n\nFetch a PDF document:\n{\n  url: \"https://example.com/reports/q4-2025.pdf\"\n}\n\nFetch an Excel spreadsheet:\n{\n  url: \"https://example.com/data/metrics.xlsx\"\n}`,\n\n      parameters: {\n        type: 'object',\n        properties: {\n          url: {\n            type: 'string',\n            description: 'The URL to fetch. Must start with http:// or https://',\n          },\n          userAgent: {\n            type: 'string',\n            description: 'Optional custom user agent string. Default is a generic bot user agent.',\n          },\n          timeout: {\n            type: 'number',\n            description: 'Timeout in milliseconds (default: 10000)',\n          },\n        },\n        required: ['url'],\n      },\n    },\n    blocking: true,\n    timeout: 15000,\n  },\n\n  execute: async (args: WebFetchArgs): Promise<WebFetchResult> => {\n    try {\n      // Validate URL\n      try {\n        new URL(args.url);\n      } catch {\n        return {\n          success: false,\n          url: args.url,\n          title: '',\n          content: '',\n          contentType: 'error',\n          qualityScore: 0,\n          requiresJS: false,\n          error: 'Invalid URL format',\n        };\n      }\n\n      // Fetch with timeout\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), args.timeout || 10000);\n\n      const response = await fetch(args.url, {\n        headers: {\n          'User-Agent':\n            args.userAgent ||\n            'Mozilla/5.0 (compatible; OneRingAI/1.0; +https://github.com/oneringai/agents)',\n          Accept: 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n          'Accept-Language': 'en-US,en;q=0.9',\n        },\n        signal: controller.signal,\n      });\n\n      clearTimeout(timeoutId);\n\n      // Check response status\n      if (!response.ok) {\n        return {\n          success: false,\n          url: args.url,\n          title: '',\n          content: '',\n          contentType: 'error',\n          qualityScore: 0,\n          requiresJS: false,\n          error: `HTTP ${response.status}: ${response.statusText}`,\n        };\n      }\n\n      // Get content type\n      const contentType = response.headers.get('content-type') || '';\n\n      // Handle document formats (PDF, DOCX, XLSX, etc.)\n      const urlExt = (() => {\n        try {\n          const pathname = new URL(args.url).pathname;\n          const ext = pathname.split('.').pop()?.toLowerCase();\n          return ext ? `.${ext}` : '';\n        } catch { return ''; }\n      })();\n\n      if (FormatDetector.isDocumentMimeType(contentType) || FormatDetector.isBinaryDocumentFormat(urlExt)) {\n        try {\n          const arrayBuffer = await response.arrayBuffer();\n          const buffer = Buffer.from(arrayBuffer);\n\n          // Extract filename from URL or Content-Disposition\n          const disposition = response.headers.get('content-disposition');\n          let filename = 'document';\n          if (disposition) {\n            const match = disposition.match(/filename[^;=\\n]*=(['\"]?)([^'\"\\n;]*)\\1/);\n            if (match?.[2]) filename = match[2];\n          } else {\n            try {\n              const basename = new URL(args.url).pathname.split('/').pop();\n              if (basename && basename.includes('.')) filename = basename;\n            } catch { /* ignore */ }\n          }\n\n          const reader = DocumentReader.create();\n          const result = await reader.read(\n            { type: 'buffer', buffer, filename },\n            { extractImages: false }\n          );\n\n          if (result.success) {\n            return {\n              success: true,\n              url: args.url,\n              title: `Document: ${filename}`,\n              content: mergeTextPieces(result.pieces),\n              contentType: 'document',\n              qualityScore: 100,\n              requiresJS: false,\n              documentMetadata: result.metadata as unknown as Record<string, unknown>,\n            };\n          }\n        } catch {\n          // Fall through to regular handling\n        }\n      }\n\n      // Handle JSON responses\n      if (contentType.includes('application/json')) {\n        const json = await response.json();\n        return {\n          success: true,\n          url: args.url,\n          title: 'JSON Response',\n          content: JSON.stringify(json, null, 2),\n          contentType: 'json',\n          qualityScore: 100,\n          requiresJS: false,\n        };\n      }\n\n      // Handle plain text\n      if (contentType.includes('text/plain')) {\n        const text = await response.text();\n        return {\n          success: true,\n          url: args.url,\n          title: 'Text Response',\n          content: text,\n          contentType: 'text',\n          qualityScore: 100,\n          requiresJS: false,\n        };\n      }\n\n      // Get HTML\n      const html = await response.text();\n\n      // Parse with cheerio for quality detection\n      const $ = load(html);\n\n      // Convert HTML to clean markdown\n      const mdResult = await htmlToMarkdown(html, args.url);\n\n      // Use markdown result title or fallback to cheerio extraction\n      const title = mdResult.title || $('title').text() || $('h1').first().text() || 'Untitled';\n\n      // Detect content quality (using markdown content for text analysis)\n      const quality = detectContentQuality(html, mdResult.markdown, $);\n\n      return {\n        success: true,\n        url: args.url,\n        title,\n        content: mdResult.markdown,\n        contentType: 'html',\n        qualityScore: quality.score,\n        requiresJS: quality.requiresJS,\n        suggestedAction: quality.suggestion,\n        issues: quality.issues,\n        excerpt: mdResult.excerpt,\n        byline: mdResult.byline,\n        wasReadabilityUsed: mdResult.wasReadabilityUsed,\n        wasTruncated: mdResult.wasTruncated,\n      };\n    } catch (error: any) {\n      // Handle abort errors specially\n      if (error.name === 'AbortError') {\n        return {\n          success: false,\n          url: args.url,\n          title: '',\n          content: '',\n          contentType: 'error',\n          qualityScore: 0,\n          requiresJS: false,\n          error: `Request timeout after ${args.timeout || 10000}ms`,\n        };\n      }\n\n      return {\n        success: false,\n        url: args.url,\n        title: '',\n        content: '',\n        contentType: 'error',\n        qualityScore: 0,\n        requiresJS: false,\n        error: (error as Error).message,\n      };\n    }\n  },\n};\n","/**\n * Web Scrape Tool Factory\n *\n * Creates a web_scrape tool bound to a specific Connector.\n * Follows the ConnectorTools pattern (like GitHub tools).\n *\n * Fallback chain:\n * 1. Native fetch (free/fast) via webFetch\n * 2. External API via the bound connector (e.g., ZenRows, Firecrawl)\n *\n * Usage:\n *   ConnectorTools.registerService('zenrows', (connector) => [createWebScrapeTool(connector)]);\n *   // or directly:\n *   const tool = createWebScrapeTool(myConnector);\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport { ScrapeProvider } from '../../capabilities/scrape/index.js';\nimport type { ScrapeOptions, ScrapeResponse, ScrapeResult } from '../../capabilities/scrape/index.js';\nimport { webFetch } from './webFetch.js';\nimport { logger } from '../../infrastructure/observability/Logger.js';\n\nconst scrapeLogger = logger.child({ component: 'webScrape' });\n\n/**\n * Default minimum quality score to accept from native methods\n */\nconst DEFAULT_MIN_QUALITY = 50;\n\n/**\n * Strip base64 data URIs from content to prevent context overflow.\n * Removes inline images, fonts, and other embedded data.\n */\nfunction stripBase64DataUris(content: string): string {\n  if (!content) return content;\n\n  // Strip markdown images with base64 data URIs: ![alt](data:...)\n  let cleaned = content.replace(/!\\[[^\\]]*\\]\\(data:[^)]+\\)/g, '[image removed]');\n\n  // Strip CSS url() with data URIs\n  cleaned = cleaned.replace(/url\\(['\"]?data:[^)]+['\"]?\\)/gi, 'url([data-uri-removed])');\n\n  // Strip raw base64 data URIs in other contexts\n  cleaned = cleaned.replace(/data:(?:image|font|application)\\/[^;]+;base64,[A-Za-z0-9+/=]{100,}/g, '[base64-data-removed]');\n\n  return cleaned;\n}\n\n/**\n * Arguments for web_scrape tool\n */\ninterface WebScrapeArgs {\n  /** URL to scrape */\n  url: string;\n  /** Timeout in milliseconds (default: 30000) */\n  timeout?: number;\n  /** Whether to include raw HTML in response */\n  includeHtml?: boolean;\n  /** Whether to convert to markdown (if supported) */\n  includeMarkdown?: boolean;\n  /** Whether to extract links */\n  includeLinks?: boolean;\n  /** CSS selector to wait for (for JS-heavy sites) */\n  waitForSelector?: string;\n}\n\ninterface WebScrapeResult {\n  /** Whether scraping succeeded */\n  success: boolean;\n  /** URL that was scraped */\n  url: string;\n  /** Final URL after redirects */\n  finalUrl?: string;\n  /** Method used: 'native' or external provider name */\n  method: string;\n  /** Page title */\n  title: string;\n  /** Extracted text content */\n  content: string;\n  /** Raw HTML (if requested) */\n  html?: string;\n  /** Markdown version (if requested and supported) */\n  markdown?: string;\n  /** Extracted metadata */\n  metadata?: ScrapeResult['metadata'];\n  /** Extracted links (if requested) */\n  links?: ScrapeResult['links'];\n  /** Quality score (0-100) */\n  qualityScore?: number;\n  /** Time taken in milliseconds */\n  durationMs: number;\n  /** Methods attempted before success */\n  attemptedMethods: string[];\n  /** Error message if failed */\n  error?: string;\n}\n\n/**\n * Create a web_scrape tool bound to a specific connector.\n *\n * @param connector - Connector instance providing auth for the scrape API\n */\nexport function createWebScrapeTool(\n  connector: Connector,\n): ToolFunction<WebScrapeArgs, WebScrapeResult> {\n\n  // ============ Internal Helpers ============\n\n  async function tryNative(\n    args: WebScrapeArgs,\n    startTime: number,\n    attemptedMethods: string[]\n  ): Promise<WebScrapeResult> {\n    attemptedMethods.push('native');\n    scrapeLogger.debug({ url: args.url }, 'Trying native fetch');\n\n    try {\n      const result = await webFetch.execute({\n        url: args.url,\n        timeout: args.timeout || 10000,\n      });\n\n      // Strip base64 data URIs to prevent context overflow\n      const cleanContent = stripBase64DataUris(result.content);\n\n      return {\n        success: result.success,\n        url: args.url,\n        finalUrl: args.url,\n        method: 'native',\n        title: result.title,\n        content: cleanContent,\n        qualityScore: result.qualityScore,\n        durationMs: Date.now() - startTime,\n        attemptedMethods,\n        error: result.error,\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        url: args.url,\n        method: 'native',\n        title: '',\n        content: '',\n        durationMs: Date.now() - startTime,\n        attemptedMethods,\n        error: error.message,\n      };\n    }\n  }\n\n  async function tryAPI(\n    args: WebScrapeArgs,\n    startTime: number,\n    attemptedMethods: string[]\n  ): Promise<WebScrapeResult> {\n    attemptedMethods.push(`api:${connector.name}`);\n    scrapeLogger.debug({ url: args.url, connectorName: connector.name }, 'Trying external API');\n\n    try {\n      const provider = ScrapeProvider.create({ connector: connector.name });\n\n      const options: ScrapeOptions = {\n        timeout: args.timeout,\n        waitForSelector: args.waitForSelector,\n        includeHtml: args.includeHtml,\n        includeMarkdown: args.includeMarkdown,\n        includeLinks: args.includeLinks,\n      };\n\n      const result: ScrapeResponse = await provider.scrape(args.url, options);\n\n      // Strip base64 data URIs to prevent context overflow\n      const rawContent = result.result?.content || '';\n      const rawMarkdown = result.result?.markdown;\n      const cleanContent = stripBase64DataUris(rawContent);\n      const cleanMarkdown = rawMarkdown ? stripBase64DataUris(rawMarkdown) : undefined;\n\n      // Avoid returning duplicate content in both `content` and `markdown`.\n      const isDuplicate = !!cleanMarkdown && cleanContent === cleanMarkdown;\n\n      return {\n        success: result.success,\n        url: args.url,\n        finalUrl: result.finalUrl,\n        method: result.provider,\n        title: result.result?.title || '',\n        content: cleanContent,\n        html: result.result?.html,\n        markdown: isDuplicate ? undefined : cleanMarkdown,\n        metadata: result.result?.metadata,\n        links: result.result?.links,\n        qualityScore: result.success ? 90 : 0,\n        durationMs: Date.now() - startTime,\n        attemptedMethods,\n        error: result.error,\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        url: args.url,\n        method: 'api',\n        title: '',\n        content: '',\n        durationMs: Date.now() - startTime,\n        attemptedMethods,\n        error: error.message,\n      };\n    }\n  }\n\n  // ============ Tool Definition ============\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'web_scrape',\n        description: `Scrape any URL with automatic fallback - guaranteed to work on most sites.\n\nAutomatically tries multiple methods in sequence:\n1. Native fetch - Fast (~1s), works for blogs/docs/articles\n2. External API - Handles bot protection, CAPTCHAs, SPAs (if configured)\n\nRETURNS:\n{\n  success: boolean,\n  url: string,\n  finalUrl: string,        // After redirects\n  method: string,          // 'native', 'js', or provider name\n  title: string,\n  content: string,         // Clean text\n  html: string,            // If requested\n  markdown: string,        // If requested\n  metadata: {...},         // Title, description, author, etc.\n  links: [{url, text}],    // If requested\n  qualityScore: number,    // 0-100\n  durationMs: number,\n  attemptedMethods: []     // Methods tried\n}\n\nEXAMPLES:\nBasic:\n{ \"url\": \"https://example.com/article\" }\n\nWith options:\n{\n  \"url\": \"https://example.com\",\n  \"includeMarkdown\": true,\n  \"includeLinks\": true\n}\n\nFor JS-heavy sites:\n{\n  \"url\": \"https://spa-app.com\",\n  \"waitForSelector\": \".main-content\"\n}`,\n\n        parameters: {\n          type: 'object',\n          properties: {\n            url: {\n              type: 'string',\n              description: 'URL to scrape. Must start with http:// or https://',\n            },\n            timeout: {\n              type: 'number',\n              description: 'Timeout in milliseconds (default: 30000)',\n            },\n            includeHtml: {\n              type: 'boolean',\n              description: 'Include raw HTML in response (default: false)',\n            },\n            includeMarkdown: {\n              type: 'boolean',\n              description: 'Include markdown conversion (default: false)',\n            },\n            includeLinks: {\n              type: 'boolean',\n              description: 'Extract and include links (default: false)',\n            },\n            waitForSelector: {\n              type: 'string',\n              description: 'CSS selector to wait for before scraping (for JS-heavy sites)',\n            },\n          },\n          required: ['url'],\n        },\n      },\n      blocking: true,\n      timeout: 60000,\n    },\n\n    execute: async (args: WebScrapeArgs): Promise<WebScrapeResult> => {\n      const startTime = Date.now();\n      const attemptedMethods: string[] = [];\n\n      // Validate URL\n      try {\n        new URL(args.url);\n      } catch {\n        return {\n          success: false,\n          url: args.url,\n          method: 'none',\n          title: '',\n          content: '',\n          durationMs: Date.now() - startTime,\n          attemptedMethods: [],\n          error: 'Invalid URL format',\n        };\n      }\n\n      // Automatic fallback chain: native -> API\n\n      // 1. Try native fetch first\n      const native = await tryNative(args, startTime, attemptedMethods);\n      if (native.success && (native.qualityScore ?? 0) >= DEFAULT_MIN_QUALITY) {\n        return native;\n      }\n\n      // 2. Try external API via the bound connector\n      const api = await tryAPI(args, startTime, attemptedMethods);\n      if (api.success) return api;\n\n      // Return best result we got\n      if (native.success) return native;\n\n      // Build a detailed error message from all attempted methods\n      const errors: string[] = [];\n      if (native.error) errors.push(`native: ${native.error}`);\n      if (api.error) errors.push(`api(${connector.name}): ${api.error}`);\n      const detail = errors.length > 0\n        ? errors.join(' | ')\n        : 'Unknown failure';\n\n      return {\n        success: false,\n        url: args.url,\n        method: 'none',\n        title: '',\n        content: '',\n        durationMs: Date.now() - startTime,\n        attemptedMethods,\n        error: `All scraping methods failed. ${detail}`,\n      };\n    },\n\n    describeCall: (args: WebScrapeArgs) => args.url,\n  };\n}\n","/**\n * Web tools for fetching, searching, and scraping\n *\n * - webFetch: Standalone tool (no connector needed)\n * - createWebSearchTool / createWebScrapeTool: Factory functions (ConnectorTools pattern)\n *\n * Search/scrape tool factories are auto-registered with ConnectorTools on import.\n */\n\n// Side-effect: register web tool factories with ConnectorTools\nimport { registerWebTools } from './register.js';\nregisterWebTools();\n\n// Standalone tool (no connector needed)\nexport { webFetch } from './webFetch.js';\n\n// Tool factories (for direct use)\nexport { createWebSearchTool } from './createWebSearchTool.js';\nexport { createWebScrapeTool } from './createWebScrapeTool.js';\n\n// Re-export SearchResult type from capabilities (canonical location)\nexport type { SearchResult } from '../../capabilities/search/index.js';\n","/**\n * JavaScript Execution Tool\n * Executes JavaScript in a sandboxed VM with connector integration.\n * Connectors provide authenticated access to external APIs (GitHub, Slack, etc.)\n *\n * Key features:\n * - userId auto-injected from ToolContext into authenticatedFetch calls\n * - Connector list always scoped to current userId via global access policy\n * - Dynamic description regenerated at each LLM call with current connectors\n * - Configurable timeout per invocation\n */\n\nimport * as vm from 'vm';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport { Connector } from '../../core/Connector.js';\nimport { authenticatedFetch as rawAuthenticatedFetch } from '../../connectors/authenticatedFetch.js';\nimport type { IConnectorRegistry } from '../../domain/interfaces/IConnectorRegistry.js';\n\ninterface ExecuteJSArgs {\n  code: string;\n  input?: any;\n  timeout?: number;\n}\n\ninterface ExecuteJSResult {\n  success: boolean;\n  result: any;\n  logs: string[];\n  error?: string;\n  executionTime: number;\n}\n\n/**\n * Options for creating the execute_javascript tool.\n */\nexport interface ExecuteJavaScriptToolOptions {\n  /**\n   * Maximum allowed timeout in milliseconds for code execution.\n   * The LLM can request up to this value via the `timeout` parameter.\n   * Default: 30000 (30s). Set higher for long-running API calls.\n   */\n  maxTimeout?: number;\n\n  /**\n   * Default timeout in milliseconds when not specified by the LLM.\n   * Default: 10000 (10s).\n   */\n  defaultTimeout?: number;\n}\n\n// Default timeout values\nconst DEFAULT_TIMEOUT = 10000;\nconst DEFAULT_MAX_TIMEOUT = 30000;\n\n/**\n * Format a single connector for the description.\n * Shows service type, vendor, base URL, and auth  enough for the agent\n * to decide which connector to use for a given task.\n */\nfunction formatConnectorEntry(c: Connector, accountId?: string): string {\n  const parts: string[] = [];\n\n  // Service type or vendor (e.g., \"github\", \"openai\")\n  const serviceOrVendor = c.serviceType ?? c.vendor ?? undefined;\n  if (serviceOrVendor) parts.push(`Service: ${serviceOrVendor}`);\n\n  // Account alias (for multi-account identities)\n  if (accountId) parts.push(`Account: \"${accountId}\"`);\n\n  // Description\n  if (c.config.description) parts.push(c.config.description);\n\n  // Base URL (skip for LLM connectors without explicit URL)\n  if (c.baseURL) parts.push(`URL: ${c.baseURL}`);\n\n  const label = accountId ? `\"${c.name}\" account \"${accountId}\"` : `\"${c.name}\"`;\n  const details = parts.map(p => `     ${p}`).join('\\n');\n  return `    ${label} (${c.displayName})\\n${details}`;\n}\n\n/**\n * Build the connector/identity list for the description.\n * If identities are set, list each identity entry (connector + accountId).\n * Otherwise fall back to listing all connectors from the registry.\n */\nfunction buildIdentityList(context: ToolContext | undefined): string {\n  const identities = context?.identities;\n  const registry = context?.connectorRegistry ?? Connector.asRegistry();\n\n  if (identities?.length) {\n    const entries: string[] = [];\n    for (const id of identities) {\n      try {\n        const connector = registry.get(id.connector);\n        entries.push(formatConnectorEntry(connector, id.accountId));\n      } catch {\n        entries.push(`    \"${id.connector}\"${id.accountId ? ` account \"${id.accountId}\"` : ''}  not available`);\n      }\n    }\n    return entries.length > 0 ? entries.join('\\n\\n') : '   No connectors registered.';\n  }\n\n  // Fallback: list all connectors from registry\n  const connectors = registry.listAll();\n  return connectors.length > 0\n    ? connectors.map(c => formatConnectorEntry(c)).join('\\n\\n')\n    : '   No connectors registered.';\n}\n\n/**\n * Check if any identity has an accountId (to decide whether to document the 4th param).\n */\nfunction hasAccountIds(context: ToolContext | undefined): boolean {\n  return !!context?.identities?.some(id => id.accountId);\n}\n\n/**\n * Generate the tool description with current connectors/identities from ToolContext.\n * Called dynamically via descriptionFactory when tools are sent to LLM.\n */\nfunction generateDescription(context: ToolContext | undefined, maxTimeout: number): string {\n  const connectorList = buildIdentityList(context);\n  const showAccountId = hasAccountIds(context);\n  const timeoutSec = Math.round(maxTimeout / 1000);\n\n  const accountIdParam = showAccountId\n    ? `\n      accountId (optional): Account alias for multi-account connectors.\n       Required when a connector has multiple accounts (see list below).\n       Example: authenticatedFetch('/v1.0/me', {}, 'microsoft', 'work')`\n    : '';\n\n  const accountIdExamples = showAccountId\n    ? `\n// Multi-account: specify accountId for connectors with multiple accounts\nconst resp = await authenticatedFetch('/v1.0/me', { method: 'GET' }, 'microsoft', 'work');\nconst profile = await resp.json();\noutput = profile;\n`\n    : '';\n\n  return `Execute JavaScript code in a secure sandbox with authenticated API access to external services.\n\nUse this tool when you need to:\n- Call external APIs (GitHub, Slack, Stripe, etc.) using registered connectors\n- Process, transform, or compute data that requires programmatic logic\n- Chain multiple API calls or perform complex data manipulation\n- Do anything that plain text generation cannot accomplish\n\nSANDBOX API:\n\n1. authenticatedFetch(url, options, connectorName${showAccountId ? ', accountId?' : ''})\n   Makes authenticated HTTP requests using the connector's credentials.\n   The current user's identity (userId) is automatically included  no need to pass it.\n   Auth headers are added automatically  DO NOT set Authorization header manually.\n\n   Parameters:\n      url: Full URL or path relative to the connector's base URL\n       - Full: \"https://api.github.com/user/repos\"\n       - Relative: \"/user/repos\" (resolved against connector's base URL)\n      options: Standard fetch options { method, headers, body }\n       - For POST/PUT: set body to JSON.stringify(data) and headers to { 'Content-Type': 'application/json' }\n      connectorName: Name of a registered connector (see list below)${accountIdParam}\n\n   Returns: Promise<Response>\n      response.ok  true if status 200-299\n      response.status  HTTP status code\n      await response.json()  parse JSON body\n      await response.text()  get text body\n\n2. fetch(url, options)  Standard fetch without authentication\n\n3. connectors.list()  Array of available connector names\n4. connectors.get(name)  Connector info: { displayName, description, baseURL, serviceType }\n\nVARIABLES:\n    input  data passed via the \"input\" parameter (default: {})\n    output  SET THIS to return your result to the caller\n\nGLOBALS: console.log/error/warn, JSON, Math, Date, Buffer, Promise, Array, Object, String, Number, Boolean, setTimeout, setInterval, URL, URLSearchParams, RegExp, Map, Set, Error, TextEncoder, TextDecoder\n\nREGISTERED CONNECTORS:\n${connectorList}\n\nEXAMPLES:\n\n// GET request\nconst resp = await authenticatedFetch('/user/repos', { method: 'GET' }, 'github');\nconst repos = await resp.json();\noutput = repos.map(r => r.full_name);\n\n// POST request with JSON body\nconst resp = await authenticatedFetch('/chat.postMessage', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({ channel: '#general', text: 'Hello!' })\n}, 'slack');\noutput = await resp.json();\n${accountIdExamples}\n// Data processing (no API needed)\nconst items = input.data;\noutput = items.filter(i => i.score > 0.8).sort((a, b) => b.score - a.score);\n\nLIMITS: ${timeoutSec}s max timeout, no file system access, no require/import.`;\n}\n\n/**\n * Create an execute_javascript tool.\n *\n * The tool uses `descriptionFactory` to generate a dynamic description that\n * always reflects the connectors available to the current user. Connector\n * visibility is determined by the global access policy (if set) scoped by\n * the agent's userId from ToolContext.\n *\n * @param options - Optional configuration for timeout limits\n */\nexport function createExecuteJavaScriptTool(\n  options?: ExecuteJavaScriptToolOptions,\n): ToolFunction<ExecuteJSArgs, ExecuteJSResult> {\n  const maxTimeout = options?.maxTimeout ?? DEFAULT_MAX_TIMEOUT;\n  const defaultTimeout = options?.defaultTimeout ?? DEFAULT_TIMEOUT;\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'execute_javascript',\n        // Static fallback description (used if descriptionFactory is not supported)\n        description: 'Execute JavaScript code in a secure sandbox with authenticated API access via connectors.',\n        parameters: {\n          type: 'object',\n          properties: {\n            code: {\n              type: 'string',\n              description:\n                'JavaScript code to execute. Set the \"output\" variable with your result. ' +\n                'Code is auto-wrapped in async IIFE  you can use await directly. ' +\n                'For explicit async control, wrap in (async () => { ... })().',\n            },\n            input: {\n              description: 'Optional data available as the \"input\" variable in your code. Can be any JSON value.',\n            },\n            timeout: {\n              type: 'number',\n              description:\n                `Execution timeout in milliseconds. Default: ${defaultTimeout}ms, max: ${maxTimeout}ms. ` +\n                'Increase for slow API calls or multiple sequential requests.',\n            },\n          },\n          required: ['code'],\n        },\n      },\n      blocking: true,\n      timeout: maxTimeout + 5000, // Tool-level timeout slightly above max code timeout\n    },\n\n    // Dynamic description  regenerated each time tool definitions are sent to LLM.\n    // Receives ToolContext so connector list is scoped to current userId.\n    descriptionFactory: (context?: ToolContext) => generateDescription(context, maxTimeout),\n\n    execute: async (args: ExecuteJSArgs, context?: ToolContext): Promise<ExecuteJSResult> => {\n      const logs: string[] = [];\n      const startTime = Date.now();\n\n      try {\n        // Resolve timeout: clamp to [0, maxTimeout]\n        const timeout = Math.min(Math.max(args.timeout || defaultTimeout, 0), maxTimeout);\n\n        // Get connector registry from context (already scoped by userId + allowed connectors)\n        const registry = context?.connectorRegistry ?? Connector.asRegistry();\n\n        // Execute in VM with userId and scoped registry\n        const result = await executeInVM(\n          args.code, args.input, timeout, logs,\n          context?.userId, registry,\n        );\n\n        return {\n          success: true,\n          result,\n          logs,\n          executionTime: Date.now() - startTime,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          result: null,\n          logs,\n          error: (error as Error).message,\n          executionTime: Date.now() - startTime,\n        };\n      }\n    },\n  };\n}\n\n/**\n * Default executeJavaScript tool instance.\n *\n * Uses the global connector registry (scoped by userId at runtime).\n * For custom timeouts, use createExecuteJavaScriptTool(options).\n */\nexport const executeJavaScript: ToolFunction<ExecuteJSArgs, ExecuteJSResult> = createExecuteJavaScriptTool();\n\n/**\n * Execute code in Node.js vm module with userId-scoped connector access.\n */\nexport async function executeInVM(\n  code: string,\n  input: any,\n  timeout: number,\n  logs: string[],\n  userId: string | undefined,\n  registry: IConnectorRegistry,\n): Promise<any> {\n  // Create sandbox context\n  const sandbox: any = {\n    // Input/output\n    input: input ?? {},\n    output: null,\n\n    // Console (captured)  stringify objects for readable logs\n    console: {\n      log: (...args: any[]) => logs.push(args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')),\n      error: (...args: any[]) => logs.push('ERROR: ' + args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')),\n      warn: (...args: any[]) => logs.push('WARN: ' + args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')),\n    },\n\n    // Authenticated fetch  userId auto-injected from ToolContext.\n    // Only connectors visible in the scoped registry are accessible.\n    // Optional 4th param accountId for multi-account OAuth identities.\n    authenticatedFetch: (url: string | URL, options: RequestInit | undefined, connectorName: string, accountId?: string) => {\n      // Verify the connector is accessible in the (possibly scoped) registry\n      registry.get(connectorName);\n      return rawAuthenticatedFetch(url, options, connectorName, userId, accountId);\n    },\n\n    // Standard fetch (no auth)\n    fetch: globalThis.fetch,\n\n    // Connector info (userId-scoped)\n    connectors: {\n      list: () => registry.list(),\n      get: (name: string) => {\n        try {\n          const connector = registry.get(name);\n          return {\n            displayName: connector.displayName,\n            description: connector.config.description || '',\n            baseURL: connector.baseURL,\n            serviceType: connector.serviceType,\n          };\n        } catch {\n          return null;\n        }\n      },\n    },\n\n    // Standard globals\n    Buffer,\n    JSON,\n    Math,\n    Date,\n    setTimeout,\n    setInterval,\n    clearTimeout,\n    clearInterval,\n    Promise,\n\n    // Built-in types\n    Array,\n    Object,\n    String,\n    Number,\n    Boolean,\n    RegExp,\n    Map,\n    Set,\n    Error,\n    URL,\n    URLSearchParams,\n    TextEncoder,\n    TextDecoder,\n  };\n\n  // Create VM context\n  const vmContext = vm.createContext(sandbox);\n\n  // Wrap user code in async IIFE if not already wrapped\n  const wrappedCode = code.trim().startsWith('(async')\n    ? code\n    : `\n    (async () => {\n      ${code}\n      return output;\n    })()\n  `;\n\n  // Compile and run\n  const script = new vm.Script(wrappedCode);\n  const resultPromise = script.runInContext(vmContext, {\n    timeout,\n    displayErrors: true,\n  });\n\n  // Wait for completion\n  const result = await resultPromise;\n\n  // If result is undefined but output was set, use the output variable\n  return result !== undefined ? result : sandbox.output;\n}\n","/**\n * Register multimedia tool factories with ConnectorTools\n *\n * Maps vendors to their supported multimedia capabilities and registers\n * composite factories that produce the appropriate tools for each vendor.\n */\n\nimport { ConnectorTools } from '../connector/ConnectorTools.js';\nimport { Vendor } from '../../core/Vendor.js';\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { IMediaStorage } from '../../domain/interfaces/IMediaStorage.js';\nimport { getMediaStorage } from './config.js';\nimport { createImageGenerationTool } from './imageGeneration.js';\nimport { createVideoTools } from './videoGeneration.js';\nimport { createTextToSpeechTool } from './textToSpeech.js';\nimport { createSpeechToTextTool } from './speechToText.js';\n\ntype Capability = 'image' | 'video' | 'tts' | 'stt';\n\n/**\n * Vendor to capability mapping (single source of truth)\n * Matches createImageProvider/createVideoProvider/createTTSProvider/createSTTProvider\n */\nconst VENDOR_CAPABILITIES: Record<string, readonly Capability[]> = {\n  [Vendor.OpenAI]: ['image', 'video', 'tts', 'stt'],\n  [Vendor.Google]: ['image', 'video', 'tts'],\n  [Vendor.Grok]: ['image', 'video'],\n};\n\n/**\n * Register multimedia tool factories for all supported vendors\n *\n * @param storage - Optional media storage override; defaults to global `getMediaStorage()`\n */\nexport function registerMultimediaTools(storage?: IMediaStorage): void {\n  for (const [vendor, capabilities] of Object.entries(VENDOR_CAPABILITIES)) {\n    ConnectorTools.registerService(vendor, (connector: Connector, userId?: string) => {\n      const handler = storage ?? getMediaStorage();\n      const tools: ToolFunction[] = [];\n\n      if (capabilities.includes('image')) {\n        tools.push(createImageGenerationTool(connector, handler, userId));\n      }\n      if (capabilities.includes('video')) {\n        tools.push(...createVideoTools(connector, handler, userId));\n      }\n      if (capabilities.includes('tts')) {\n        tools.push(createTextToSpeechTool(connector, handler, userId));\n      }\n      if (capabilities.includes('stt')) {\n        tools.push(createSpeechToTextTool(connector, handler));\n      }\n\n      return tools;\n    });\n  }\n}\n","/**\n * Module-level configuration for multimedia output storage\n *\n * Delegates to StorageRegistry for centralized storage management.\n * The public API (getMediaStorage / setMediaStorage) stays the same.\n *\n * @example\n * ```typescript\n * import { setMediaStorage } from '@everworker/oneringai';\n *\n * // Use custom S3 storage before creating agents\n * setMediaStorage(myS3Storage);\n * ```\n */\n\nimport type { IMediaStorage } from '../../domain/interfaces/IMediaStorage.js';\nimport { FileMediaStorage } from '../../infrastructure/storage/FileMediaStorage.js';\nimport { StorageRegistry } from '../../core/StorageRegistry.js';\n\n/**\n * Get the global media storage (creates default FileMediaStorage on first access)\n */\nexport function getMediaStorage(): IMediaStorage {\n  return StorageRegistry.resolve('media', () => new FileMediaStorage());\n}\n\n/**\n * Set a custom global media storage\n *\n * Call this before agent creation to use custom storage (S3, GCS, etc.)\n */\nexport function setMediaStorage(storage: IMediaStorage): void {\n  StorageRegistry.set('media', storage);\n}\n\n// ============================================================================\n// Deprecated aliases (remove in next major version)\n// ============================================================================\n\n/** @deprecated Use `getMediaStorage()` instead */\nexport const getMediaOutputHandler = getMediaStorage;\n\n/** @deprecated Use `setMediaStorage()` instead */\nexport const setMediaOutputHandler = setMediaStorage;\n","/**\n * Image generation tool factory\n *\n * Creates a `generate_image` ToolFunction that wraps ImageGeneration capability.\n * Parameters are built dynamically from the model registry for the connector's vendor.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { IMediaStorage } from '../../domain/interfaces/IMediaStorage.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport { getMediaStorage } from './config.js';\nimport { ImageGeneration } from '../../capabilities/images/ImageGeneration.js';\nimport { getImageModelsByVendor, IMAGE_MODEL_REGISTRY } from '../../domain/entities/ImageModel.js';\n\ninterface GenerateImageArgs {\n  prompt: string;\n  model?: string;\n  size?: string;\n  quality?: string;\n  style?: string;\n  n?: number;\n  aspectRatio?: string;\n}\n\ninterface GenerateImageResult {\n  success: boolean;\n  images?: Array<{\n    location: string;\n    mimeType: string;\n    revisedPrompt?: string;\n  }>;\n  error?: string;\n}\n\nexport function createImageGenerationTool(\n  connector: Connector,\n  storage?: IMediaStorage,\n  userId?: string\n): ToolFunction<GenerateImageArgs, GenerateImageResult> {\n  const vendor = connector.vendor;\n  const handler = storage ?? getMediaStorage();\n\n  // Build model enum from registry\n  const vendorModels = vendor ? getImageModelsByVendor(vendor) : [];\n  const modelNames = vendorModels.map((m) => m.name);\n\n  // Build vendor-specific parameters\n  const properties: Record<string, any> = {\n    prompt: {\n      type: 'string',\n      description: 'Text description of the image to generate',\n    },\n  };\n\n  if (modelNames.length > 0) {\n    const descriptions = vendorModels\n      .map((m) => `${m.name}: ${m.description || m.displayName}`)\n      .join('; ');\n    properties.model = {\n      type: 'string',\n      enum: modelNames,\n      description: `Image model to use. Options: ${descriptions}`,\n    };\n  }\n\n  // Size - available for OpenAI models\n  const hasSizes = vendorModels.some((m) => m.capabilities.sizes.length > 1);\n  if (hasSizes) {\n    const allSizes = [...new Set(vendorModels.flatMap((m) => m.capabilities.sizes))];\n    properties.size = {\n      type: 'string',\n      enum: allSizes,\n      description: 'Image dimensions',\n    };\n  }\n\n  // Aspect ratio - available for Google and Grok\n  const hasAspectRatios = vendorModels.some((m) => m.capabilities.aspectRatios?.length);\n  if (hasAspectRatios) {\n    const allRatios = [...new Set(vendorModels.flatMap((m) => m.capabilities.aspectRatios ?? []))];\n    properties.aspectRatio = {\n      type: 'string',\n      enum: allRatios,\n      description: 'Image aspect ratio',\n    };\n  }\n\n  // Quality - only for models that support it\n  const hasQuality = vendorModels.some((m) => m.capabilities.features.qualityControl);\n  if (hasQuality) {\n    properties.quality = {\n      type: 'string',\n      enum: ['standard', 'hd'],\n      description: 'Image quality level',\n    };\n  }\n\n  // Style - only for models that support it (DALL-E 3)\n  const hasStyle = vendorModels.some((m) => m.capabilities.features.styleControl);\n  if (hasStyle) {\n    properties.style = {\n      type: 'string',\n      enum: ['vivid', 'natural'],\n      description: 'Image style (vivid for hyper-real, natural for less hyper-real)',\n    };\n  }\n\n  // Number of images\n  const maxN = Math.max(...vendorModels.map((m) => m.capabilities.maxImagesPerRequest));\n  if (maxN > 1) {\n    properties.n = {\n      type: 'number',\n      description: `Number of images to generate (1-${maxN})`,\n      minimum: 1,\n      maximum: maxN,\n    };\n  }\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'generate_image',\n        description: `Generate images from text prompts using ${connector.displayName}`,\n        parameters: {\n          type: 'object',\n          properties,\n          required: ['prompt'],\n        },\n      },\n    },\n\n    execute: async (args: GenerateImageArgs, context?: ToolContext): Promise<GenerateImageResult> => {\n      try {\n        const effectiveUserId = userId ?? context?.userId;\n        const imageGen = ImageGeneration.create({ connector });\n        const response = await imageGen.generate({\n          prompt: args.prompt,\n          model: args.model,\n          size: args.size,\n          quality: args.quality as 'standard' | 'hd' | undefined,\n          style: args.style as 'vivid' | 'natural' | undefined,\n          n: args.n,\n          response_format: 'b64_json',\n        });\n\n        const images: GenerateImageResult['images'] = [];\n\n        for (let i = 0; i < response.data.length; i++) {\n          const item = response.data[i]!;\n          let buffer: Buffer;\n\n          if (item.b64_json) {\n            buffer = Buffer.from(item.b64_json, 'base64');\n          } else if (item.url) {\n            // Fetch from URL if no base64\n            const resp = await fetch(item.url);\n            buffer = Buffer.from(await resp.arrayBuffer());\n          } else {\n            continue;\n          }\n\n          const modelName = args.model || modelNames[0] || 'unknown';\n          const modelInfo = IMAGE_MODEL_REGISTRY[modelName];\n          const format = modelInfo?.capabilities.outputFormats[0] === 'url' ? 'png' : (modelInfo?.capabilities.outputFormats[0] || 'png');\n\n          const result = await handler.save(buffer, {\n            type: 'image',\n            format,\n            model: modelName,\n            vendor: vendor || 'unknown',\n            index: response.data.length > 1 ? i : undefined,\n            userId: effectiveUserId,\n          });\n\n          images.push({\n            location: result.location,\n            mimeType: result.mimeType,\n            revisedPrompt: item.revised_prompt,\n          });\n        }\n\n        return { success: true, images };\n      } catch (error) {\n        return {\n          success: false,\n          error: error instanceof Error ? error.message : String(error),\n        };\n      }\n    },\n\n    describeCall: (args: GenerateImageArgs) =>\n      args.prompt.length > 50 ? args.prompt.slice(0, 47) + '...' : args.prompt,\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Generate image(s) using ${connector.displayName}`,\n    },\n  };\n}\n","/**\n * Video generation tool factories\n *\n * Creates `generate_video` and `video_status` ToolFunctions\n * that wrap VideoGeneration capability. Video generation is async,\n * so two tools are needed: one to start and one to check status/download.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { IMediaStorage } from '../../domain/interfaces/IMediaStorage.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport { getMediaStorage } from './config.js';\nimport { VideoGeneration } from '../../capabilities/video/VideoGeneration.js';\nimport { getVideoModelsByVendor } from '../../domain/entities/VideoModel.js';\n\ninterface GenerateVideoArgs {\n  prompt: string;\n  model?: string;\n  duration?: number;\n  resolution?: string;\n  aspectRatio?: string;\n  seed?: number;\n}\n\ninterface GenerateVideoResult {\n  success: boolean;\n  jobId?: string;\n  status?: string;\n  error?: string;\n}\n\ninterface VideoStatusArgs {\n  jobId: string;\n}\n\ninterface VideoStatusResult {\n  success: boolean;\n  status?: string;\n  progress?: number;\n  location?: string;\n  mimeType?: string;\n  error?: string;\n}\n\n// Shared map of VideoGeneration instances keyed by connector name\nconst videoGenInstances = new Map<string, VideoGeneration>();\n\nexport function createVideoTools(\n  connector: Connector,\n  storage?: IMediaStorage,\n  userId?: string\n): ToolFunction[] {\n  const vendor = connector.vendor;\n  const handler = storage ?? getMediaStorage();\n\n  // Build model enum from registry\n  const vendorModels = vendor ? getVideoModelsByVendor(vendor) : [];\n  const modelNames = vendorModels.map((m) => m.name);\n\n  // Build vendor-specific parameters for generate\n  const generateProperties: Record<string, any> = {\n    prompt: {\n      type: 'string',\n      description: 'Text description of the video to generate',\n    },\n  };\n\n  if (modelNames.length > 0) {\n    const descriptions = vendorModels\n      .map((m) => `${m.name}: ${m.displayName}`)\n      .join('; ');\n    generateProperties.model = {\n      type: 'string',\n      enum: modelNames,\n      description: `Video model to use. Options: ${descriptions}`,\n    };\n  }\n\n  // Duration\n  const allDurations = [...new Set(vendorModels.flatMap((m) => m.capabilities.durations))].sort(\n    (a, b) => a - b\n  );\n  if (allDurations.length > 0) {\n    generateProperties.duration = {\n      type: 'number',\n      description: `Video duration in seconds. Supported: ${allDurations.join(', ')}`,\n    };\n  }\n\n  // Resolution\n  const allResolutions = [...new Set(vendorModels.flatMap((m) => m.capabilities.resolutions))];\n  if (allResolutions.length > 0) {\n    generateProperties.resolution = {\n      type: 'string',\n      enum: allResolutions,\n      description: 'Video resolution',\n    };\n  }\n\n  // Aspect ratio\n  const allAspectRatios = [\n    ...new Set(vendorModels.flatMap((m) => m.capabilities.aspectRatios ?? [])),\n  ];\n  if (allAspectRatios.length > 0) {\n    generateProperties.aspectRatio = {\n      type: 'string',\n      enum: allAspectRatios,\n      description: 'Video aspect ratio',\n    };\n  }\n\n  // Seed\n  const hasSeed = vendorModels.some((m) => m.capabilities.features.seed);\n  if (hasSeed) {\n    generateProperties.seed = {\n      type: 'number',\n      description: 'Random seed for reproducible generation',\n    };\n  }\n\n  const generateTool: ToolFunction<GenerateVideoArgs, GenerateVideoResult> = {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'generate_video',\n        description: `Start video generation from a text prompt using ${connector.displayName}. Returns a jobId to check status with video_status.`,\n        parameters: {\n          type: 'object',\n          properties: generateProperties,\n          required: ['prompt'],\n        },\n      },\n    },\n\n    execute: async (args: GenerateVideoArgs, _context?: ToolContext): Promise<GenerateVideoResult> => {\n      try {\n        const videoGen = VideoGeneration.create({ connector });\n        // Store instance for status checks\n        const response = await videoGen.generate({\n          prompt: args.prompt,\n          model: args.model,\n          duration: args.duration,\n          resolution: args.resolution,\n          aspectRatio: args.aspectRatio as any,\n          seed: args.seed,\n        });\n\n        // Store the instance keyed by jobId for later status/download\n        videoGenInstances.set(response.jobId, videoGen);\n\n        return {\n          success: true,\n          jobId: response.jobId,\n          status: response.status,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: error instanceof Error ? error.message : String(error),\n        };\n      }\n    },\n\n    describeCall: (args: GenerateVideoArgs) =>\n      args.prompt.length > 50 ? args.prompt.slice(0, 47) + '...' : args.prompt,\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Generate video using ${connector.displayName}`,\n    },\n  };\n\n  const statusTool: ToolFunction<VideoStatusArgs, VideoStatusResult> = {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'video_status',\n        description:\n          'Check the status of a video generation job. If completed, downloads and saves the video.',\n        parameters: {\n          type: 'object',\n          properties: {\n            jobId: {\n              type: 'string',\n              description: 'The job ID returned by generate_video',\n            },\n          },\n          required: ['jobId'],\n        },\n      },\n    },\n\n    execute: async (args: VideoStatusArgs, context?: ToolContext): Promise<VideoStatusResult> => {\n      try {\n        const effectiveUserId = userId ?? context?.userId;\n        let videoGen = videoGenInstances.get(args.jobId);\n        if (!videoGen) {\n          // Recreate if not in cache (e.g., after restart)\n          videoGen = VideoGeneration.create({ connector });\n        }\n\n        const status = await videoGen.getStatus(args.jobId);\n\n        if (status.status === 'completed') {\n          // Download and save\n          let buffer: Buffer | undefined;\n\n          if (status.video?.b64_json) {\n            buffer = Buffer.from(status.video.b64_json, 'base64');\n          } else if (status.video?.url) {\n            const resp = await fetch(status.video.url);\n            buffer = Buffer.from(await resp.arrayBuffer());\n          } else if (videoGen.download) {\n            try {\n              buffer = await videoGen.download(args.jobId);\n            } catch {\n              // Download not supported - return status without file\n            }\n          }\n\n          if (buffer) {\n            const format = status.video?.format || 'mp4';\n            const modelName = modelNames[0] || 'unknown';\n\n            const result = await handler.save(buffer, {\n              type: 'video',\n              format,\n              model: modelName,\n              vendor: vendor || 'unknown',\n              userId: effectiveUserId,\n            });\n\n            // Clean up instance\n            videoGenInstances.delete(args.jobId);\n\n            return {\n              success: true,\n              status: 'completed',\n              location: result.location,\n              mimeType: result.mimeType,\n            };\n          }\n\n          // No downloadable video data\n          videoGenInstances.delete(args.jobId);\n          return {\n            success: true,\n            status: 'completed',\n            location: status.video?.url,\n          };\n        }\n\n        if (status.status === 'failed') {\n          videoGenInstances.delete(args.jobId);\n          return {\n            success: false,\n            status: 'failed',\n            error: status.error || 'Video generation failed',\n          };\n        }\n\n        // Still processing\n        return {\n          success: true,\n          status: status.status,\n          progress: status.progress,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: error instanceof Error ? error.message : String(error),\n        };\n      }\n    },\n\n    describeCall: (args: VideoStatusArgs) => `job ${args.jobId}`,\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: 'Check video generation status',\n    },\n  };\n\n  return [generateTool, statusTool];\n}\n","/**\n * Text-to-speech tool factory\n *\n * Creates a `text_to_speech` ToolFunction that wraps TextToSpeech capability.\n * Parameters are built dynamically from the TTS model registry for the connector's vendor.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { IMediaStorage } from '../../domain/interfaces/IMediaStorage.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport { getMediaStorage } from './config.js';\nimport { TextToSpeech } from '../../core/TextToSpeech.js';\nimport { getTTSModelsByVendor } from '../../domain/entities/TTSModel.js';\n\ninterface TextToSpeechArgs {\n  text: string;\n  model?: string;\n  voice?: string;\n  format?: string;\n  speed?: number;\n}\n\ninterface TextToSpeechResult {\n  success: boolean;\n  location?: string;\n  format?: string;\n  mimeType?: string;\n  error?: string;\n}\n\nexport function createTextToSpeechTool(\n  connector: Connector,\n  storage?: IMediaStorage,\n  userId?: string\n): ToolFunction<TextToSpeechArgs, TextToSpeechResult> {\n  const vendor = connector.vendor;\n  const handler = storage ?? getMediaStorage();\n\n  // Build model enum from registry\n  const vendorModels = vendor ? getTTSModelsByVendor(vendor) : [];\n  const modelNames = vendorModels.map((m) => m.name);\n\n  // Build parameters\n  const properties: Record<string, any> = {\n    text: {\n      type: 'string',\n      description: 'Text to convert to speech',\n    },\n  };\n\n  if (modelNames.length > 0) {\n    const descriptions = vendorModels\n      .map((m) => `${m.name}: ${m.description || m.displayName}`)\n      .join('; ');\n    properties.model = {\n      type: 'string',\n      enum: modelNames,\n      description: `TTS model to use. Options: ${descriptions}`,\n    };\n  }\n\n  // Voices - collect unique voices across all models\n  const allVoices = [\n    ...new Map(\n      vendorModels\n        .flatMap((m) => m.capabilities.voices)\n        .map((v) => [v.id, v])\n    ).values(),\n  ];\n\n  if (allVoices.length > 0) {\n    const voiceDescriptions = allVoices\n      .slice(0, 10) // Limit to avoid overly long descriptions\n      .map((v) => `${v.id}${v.name !== v.id ? ` (${v.name})` : ''}`)\n      .join(', ');\n    properties.voice = {\n      type: 'string',\n      enum: allVoices.map((v) => v.id),\n      description: `Voice to use. Options include: ${voiceDescriptions}${allVoices.length > 10 ? `, and ${allVoices.length - 10} more` : ''}`,\n    };\n  }\n\n  // Audio formats\n  const allFormats = [...new Set(vendorModels.flatMap((m) => [...m.capabilities.formats]))];\n  if (allFormats.length > 0) {\n    properties.format = {\n      type: 'string',\n      enum: allFormats,\n      description: `Output audio format: ${allFormats.join(', ')}`,\n    };\n  }\n\n  // Speed control\n  const hasSpeed = vendorModels.some((m) => m.capabilities.speed.supported);\n  if (hasSpeed) {\n    const speedModel = vendorModels.find((m) => m.capabilities.speed.supported);\n    properties.speed = {\n      type: 'number',\n      description: `Speech speed (${speedModel?.capabilities.speed.min ?? 0.25} to ${speedModel?.capabilities.speed.max ?? 4.0})`,\n      minimum: speedModel?.capabilities.speed.min ?? 0.25,\n      maximum: speedModel?.capabilities.speed.max ?? 4.0,\n    };\n  }\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'text_to_speech',\n        description: `Convert text to speech audio using ${connector.displayName}`,\n        parameters: {\n          type: 'object',\n          properties,\n          required: ['text'],\n        },\n      },\n    },\n\n    execute: async (args: TextToSpeechArgs, context?: ToolContext): Promise<TextToSpeechResult> => {\n      try {\n        const effectiveUserId = userId ?? context?.userId;\n        const tts = TextToSpeech.create({\n          connector,\n          model: args.model,\n          voice: args.voice,\n          format: args.format as any,\n          speed: args.speed,\n        });\n\n        const response = await tts.synthesize(args.text);\n        const format = response.format || args.format || 'mp3';\n\n        const result = await handler.save(response.audio, {\n          type: 'audio',\n          format,\n          model: args.model || modelNames[0] || 'unknown',\n          vendor: vendor || 'unknown',\n          userId: effectiveUserId,\n        });\n\n        return {\n          success: true,\n          location: result.location,\n          format,\n          mimeType: result.mimeType,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: error instanceof Error ? error.message : String(error),\n        };\n      }\n    },\n\n    describeCall: (args: TextToSpeechArgs) =>\n      args.text.length > 50 ? args.text.slice(0, 47) + '...' : args.text,\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Convert text to speech using ${connector.displayName}`,\n    },\n  };\n}\n","/**\n * Speech-to-text tool factory\n *\n * Creates a `speech_to_text` ToolFunction that wraps SpeechToText capability.\n * Parameters are built dynamically from the STT model registry for the connector's vendor.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { IMediaStorage } from '../../domain/interfaces/IMediaStorage.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport { getMediaStorage } from './config.js';\nimport { SpeechToText } from '../../core/SpeechToText.js';\nimport { getSTTModelsByVendor } from '../../domain/entities/STTModel.js';\n\ninterface SpeechToTextArgs {\n  audioSource: string;\n  model?: string;\n  language?: string;\n  prompt?: string;\n}\n\ninterface SpeechToTextResult {\n  success: boolean;\n  text?: string;\n  language?: string;\n  durationSeconds?: number;\n  error?: string;\n}\n\nexport function createSpeechToTextTool(\n  connector: Connector,\n  storage?: IMediaStorage,\n): ToolFunction<SpeechToTextArgs, SpeechToTextResult> {\n  const vendor = connector.vendor;\n  const handler = storage ?? getMediaStorage();\n\n  // Build model enum from registry\n  const vendorModels = vendor ? getSTTModelsByVendor(vendor) : [];\n  const modelNames = vendorModels.map((m) => m.name);\n\n  // Build parameters\n  const properties: Record<string, any> = {\n    audioSource: {\n      type: 'string',\n      description: 'Path or location of the audio file to transcribe (file path, storage location, etc.)',\n    },\n  };\n\n  if (modelNames.length > 0) {\n    const descriptions = vendorModels\n      .map((m) => `${m.name}: ${m.description || m.displayName}`)\n      .join('; ');\n    properties.model = {\n      type: 'string',\n      enum: modelNames,\n      description: `STT model to use. Options: ${descriptions}`,\n    };\n  }\n\n  properties.language = {\n    type: 'string',\n    description: 'Language code (ISO-639-1, e.g., \"en\", \"es\", \"fr\"). Optional for auto-detection.',\n  };\n\n  properties.prompt = {\n    type: 'string',\n    description: 'Optional context hint to guide transcription (e.g., domain-specific terms)',\n  };\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'speech_to_text',\n        description: `Transcribe audio to text using ${connector.displayName}`,\n        parameters: {\n          type: 'object',\n          properties,\n          required: ['audioSource'],\n        },\n      },\n    },\n\n    execute: async (args: SpeechToTextArgs, _context?: ToolContext): Promise<SpeechToTextResult> => {\n      try {\n        const audioBuffer = await handler.read(args.audioSource);\n\n        if (!audioBuffer) {\n          return {\n            success: false,\n            error: `Audio not found at: ${args.audioSource}`,\n          };\n        }\n\n        const stt = SpeechToText.create({\n          connector,\n          model: args.model,\n          language: args.language,\n        });\n\n        const response = await stt.transcribe(audioBuffer, {\n          prompt: args.prompt,\n        });\n\n        return {\n          success: true,\n          text: response.text,\n          language: response.language,\n          durationSeconds: response.durationSeconds,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: error instanceof Error ? error.message : String(error),\n        };\n      }\n    },\n\n    describeCall: (args: SpeechToTextArgs) => args.audioSource,\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Transcribe audio using ${connector.displayName}`,\n    },\n  };\n}\n","/**\n * Multimedia Tools - Image, Video, TTS, STT tool factories\n *\n * Auto-registers multimedia tool factories with ConnectorTools for AI vendors.\n * When imported, this module registers factories so that `ConnectorTools.for('openai')`\n * automatically includes multimedia tools alongside the generic API tool.\n */\n\n// Side-effect: register multimedia tool factories with ConnectorTools\nimport { registerMultimediaTools } from './register.js';\nregisterMultimediaTools();\n\n// ============================================================================\n// Canonical exports (new names - prefer these)\n// ============================================================================\n\n// Media storage config\nexport { setMediaStorage, getMediaStorage } from './config.js';\n\n// ============================================================================\n// Deprecated aliases (backward compat - remove in next major version)\n// ============================================================================\n\n// Types (deprecated aliases re-exported from the shim)\nexport type {\n  IMediaOutputHandler,\n  MediaOutputMetadata,\n  MediaOutputResult,\n} from './IMediaOutputHandler.js';\n\n// Default output handler (deprecated alias)\nexport { FileMediaOutputHandler } from './FileMediaOutputHandler.js';\n\n// Config functions (deprecated aliases)\nexport { setMediaOutputHandler, getMediaOutputHandler } from './config.js';\n\n// ============================================================================\n// Tool factories (for direct use with custom options)\n// ============================================================================\n\nexport { createImageGenerationTool } from './imageGeneration.js';\nexport { createVideoTools } from './videoGeneration.js';\nexport { createTextToSpeechTool } from './textToSpeech.js';\nexport { createSpeechToTextTool } from './speechToText.js';\n","/**\n * GitHub Tools Registration\n *\n * Registers GitHub-specific tool factory with ConnectorTools.\n * When a connector with serviceType 'github' (or baseURL matching api.github.com)\n * is used, these tools become available automatically.\n */\n\nimport { ConnectorTools } from '../connector/ConnectorTools.js';\nimport type { Connector } from '../../core/Connector.js';\nimport { createSearchFilesTool } from './searchFiles.js';\nimport { createSearchCodeTool } from './searchCode.js';\nimport { createGitHubReadFileTool } from './readFile.js';\nimport { createGetPRTool } from './getPR.js';\nimport { createPRFilesTool } from './prFiles.js';\nimport { createPRCommentsTool } from './prComments.js';\nimport { createCreatePRTool } from './createPR.js';\n\n/**\n * Register GitHub tools with the ConnectorTools framework.\n *\n * After calling this, `ConnectorTools.for('my-github-connector')` will\n * return all 7 GitHub tools plus the generic API tool.\n */\nexport function registerGitHubTools(): void {\n  ConnectorTools.registerService('github', (connector: Connector, userId?: string) => {\n    return [\n      createSearchFilesTool(connector, userId),\n      createSearchCodeTool(connector, userId),\n      createGitHubReadFileTool(connector, userId),\n      createGetPRTool(connector, userId),\n      createPRFilesTool(connector, userId),\n      createPRCommentsTool(connector, userId),\n      createCreatePRTool(connector, userId),\n    ];\n  });\n}\n","/**\n * GitHub Tools - Shared Types and Helpers\n *\n * Foundation for all GitHub connector tools.\n * Provides repository resolution, authenticated fetch, and result types.\n */\n\nimport type { Connector } from '../../core/Connector.js';\n\n// ============================================================================\n// Repository Resolution\n// ============================================================================\n\n/**\n * Parsed GitHub repository reference\n */\nexport interface GitHubRepository {\n  owner: string;\n  repo: string;\n}\n\n/**\n * Parse a repository string into owner and repo.\n *\n * Accepts:\n * - \"owner/repo\" format\n * - Full GitHub URLs: \"https://github.com/owner/repo\", \"https://github.com/owner/repo/...\"\n *\n * @throws Error if the format is not recognized\n */\nexport function parseRepository(input: string): GitHubRepository {\n  if (!input || input.trim().length === 0) {\n    throw new Error('Repository cannot be empty');\n  }\n\n  const trimmed = input.trim();\n\n  // Try URL format\n  try {\n    const url = new URL(trimmed);\n    if (url.hostname === 'github.com' || url.hostname === 'www.github.com') {\n      const segments = url.pathname.split('/').filter(Boolean);\n      if (segments.length >= 2) {\n        return { owner: segments[0]!, repo: segments[1]!.replace(/\\.git$/, '') };\n      }\n    }\n  } catch {\n    // Not a URL, try owner/repo format\n  }\n\n  // Try owner/repo format\n  const parts = trimmed.split('/');\n  if (parts.length === 2 && parts[0]!.length > 0 && parts[1]!.length > 0) {\n    return { owner: parts[0]!, repo: parts[1]! };\n  }\n\n  throw new Error(\n    `Invalid repository format: \"${input}\". Expected \"owner/repo\" or \"https://github.com/owner/repo\"`\n  );\n}\n\n/**\n * Resolve a repository from tool args or connector default.\n *\n * Priority:\n * 1. Explicit `repository` parameter\n * 2. `connector.getOptions().defaultRepository`\n *\n * @returns GitHubRepository or an error result\n */\nexport function resolveRepository(\n  repository: string | undefined,\n  connector: Connector\n): { success: true; repo: GitHubRepository } | { success: false; error: string } {\n  const repoStr = repository ?? (connector.getOptions().defaultRepository as string | undefined);\n\n  if (!repoStr) {\n    return {\n      success: false,\n      error:\n        'No repository specified. Provide a \"repository\" parameter (e.g., \"owner/repo\") or configure defaultRepository on the connector.',\n    };\n  }\n\n  try {\n    return { success: true, repo: parseRepository(repoStr) };\n  } catch (err) {\n    return { success: false, error: err instanceof Error ? err.message : String(err) };\n  }\n}\n\n// ============================================================================\n// GitHub API Helpers\n// ============================================================================\n\n/**\n * Options for githubFetch\n */\nexport interface GitHubFetchOptions {\n  method?: string;\n  body?: unknown;\n  userId?: string;\n  accountId?: string;\n  accept?: string;\n  queryParams?: Record<string, string | number | boolean>;\n}\n\n/**\n * Error from GitHub API\n */\nexport class GitHubAPIError extends Error {\n  constructor(\n    public readonly status: number,\n    public readonly statusText: string,\n    public readonly body: unknown\n  ) {\n    const msg = typeof body === 'object' && body !== null && 'message' in body\n      ? (body as { message: string }).message\n      : statusText;\n    super(`GitHub API error ${status}: ${msg}`);\n    this.name = 'GitHubAPIError';\n  }\n}\n\n/**\n * Make an authenticated GitHub API request through the connector.\n *\n * Adds standard GitHub headers and parses JSON response.\n * Throws GitHubAPIError on non-ok responses.\n */\nexport async function githubFetch<T = unknown>(\n  connector: Connector,\n  endpoint: string,\n  options?: GitHubFetchOptions\n): Promise<T> {\n  let url = endpoint;\n\n  // Add query params if provided\n  if (options?.queryParams && Object.keys(options.queryParams).length > 0) {\n    const params = new URLSearchParams();\n    for (const [key, value] of Object.entries(options.queryParams)) {\n      params.append(key, String(value));\n    }\n    url += (url.includes('?') ? '&' : '?') + params.toString();\n  }\n\n  const headers: Record<string, string> = {\n    'Accept': options?.accept ?? 'application/vnd.github+json',\n    'X-GitHub-Api-Version': '2022-11-28',\n  };\n\n  if (options?.body) {\n    headers['Content-Type'] = 'application/json';\n  }\n\n  const response = await connector.fetch(\n    url,\n    {\n      method: options?.method ?? 'GET',\n      headers,\n      body: options?.body ? JSON.stringify(options.body) : undefined,\n    },\n    options?.userId,\n    options?.accountId\n  );\n\n  const text = await response.text();\n  let data: unknown;\n  try {\n    data = JSON.parse(text);\n  } catch {\n    data = text;\n  }\n\n  if (!response.ok) {\n    throw new GitHubAPIError(response.status, response.statusText, data);\n  }\n\n  return data as T;\n}\n\n// ============================================================================\n// Result Types\n// ============================================================================\n\n/**\n * Result from search_files tool\n */\nexport interface GitHubSearchFilesResult {\n  success: boolean;\n  files?: { path: string; size: number; type: string }[];\n  count?: number;\n  truncated?: boolean;\n  error?: string;\n}\n\n/**\n * Result from search_code tool\n */\nexport interface GitHubSearchCodeResult {\n  success: boolean;\n  matches?: { file: string; fragment?: string }[];\n  count?: number;\n  truncated?: boolean;\n  error?: string;\n}\n\n/**\n * Result from read_file tool (GitHub variant)\n */\nexport interface GitHubReadFileResult {\n  success: boolean;\n  content?: string;\n  path?: string;\n  size?: number;\n  lines?: number;\n  truncated?: boolean;\n  sha?: string;\n  error?: string;\n}\n\n/**\n * Result from get_pr tool\n */\nexport interface GitHubGetPRResult {\n  success: boolean;\n  data?: {\n    number: number;\n    title: string;\n    body: string | null;\n    state: string;\n    author: string;\n    labels: string[];\n    reviewers: string[];\n    mergeable: boolean | null;\n    head: string;\n    base: string;\n    url: string;\n    created_at: string;\n    updated_at: string;\n    additions: number;\n    deletions: number;\n    changed_files: number;\n    draft: boolean;\n  };\n  error?: string;\n}\n\n/**\n * Result from pr_files tool\n */\nexport interface GitHubPRFilesResult {\n  success: boolean;\n  files?: {\n    filename: string;\n    status: string;\n    additions: number;\n    deletions: number;\n    changes: number;\n    patch?: string;\n  }[];\n  count?: number;\n  error?: string;\n}\n\n/**\n * A unified comment/review entry\n */\nexport interface GitHubPRCommentEntry {\n  id: number;\n  type: 'review' | 'comment' | 'review_comment';\n  author: string;\n  body: string;\n  created_at: string;\n  path?: string;\n  line?: number;\n  state?: string;\n}\n\n/**\n * Result from pr_comments tool\n */\nexport interface GitHubPRCommentsResult {\n  success: boolean;\n  comments?: GitHubPRCommentEntry[];\n  count?: number;\n  error?: string;\n}\n\n/**\n * Result from create_pr tool\n */\nexport interface GitHubCreatePRResult {\n  success: boolean;\n  data?: {\n    number: number;\n    url: string;\n    state: string;\n    title: string;\n  };\n  error?: string;\n}\n\n// ============================================================================\n// GitHub API Response Types (internal)\n// ============================================================================\n\n/** @internal */\nexport interface GitHubTreeEntry {\n  path: string;\n  mode: string;\n  type: 'blob' | 'tree';\n  sha: string;\n  size?: number;\n  url: string;\n}\n\n/** @internal */\nexport interface GitHubTreeResponse {\n  sha: string;\n  url: string;\n  tree: GitHubTreeEntry[];\n  truncated: boolean;\n}\n\n/** @internal */\nexport interface GitHubRepoResponse {\n  default_branch: string;\n  [key: string]: unknown;\n}\n\n/** @internal */\nexport interface GitHubContentResponse {\n  type: 'file' | 'dir' | 'symlink' | 'submodule';\n  encoding?: string;\n  size: number;\n  name: string;\n  path: string;\n  content?: string;\n  sha: string;\n  git_url?: string;\n  [key: string]: unknown;\n}\n\n/** @internal */\nexport interface GitHubBlobResponse {\n  content: string;\n  encoding: string;\n  sha: string;\n  size: number;\n}\n\n/** @internal */\nexport interface GitHubSearchCodeResponse {\n  total_count: number;\n  incomplete_results: boolean;\n  items: {\n    name: string;\n    path: string;\n    sha: string;\n    html_url: string;\n    repository: { full_name: string };\n    text_matches?: {\n      fragment: string;\n      matches: { text: string; indices: [number, number] }[];\n    }[];\n  }[];\n}\n\n/** @internal */\nexport interface GitHubPRResponse {\n  number: number;\n  title: string;\n  body: string | null;\n  state: string;\n  draft: boolean;\n  user: { login: string };\n  labels: { name: string }[];\n  requested_reviewers: { login: string }[];\n  mergeable: boolean | null;\n  head: { ref: string; sha: string };\n  base: { ref: string; sha: string };\n  html_url: string;\n  created_at: string;\n  updated_at: string;\n  additions: number;\n  deletions: number;\n  changed_files: number;\n}\n\n/** @internal */\nexport interface GitHubPRFileEntry {\n  sha: string;\n  filename: string;\n  status: string;\n  additions: number;\n  deletions: number;\n  changes: number;\n  patch?: string;\n}\n\n/** @internal */\nexport interface GitHubReviewCommentResponse {\n  id: number;\n  user: { login: string };\n  body: string;\n  created_at: string;\n  path?: string;\n  line?: number | null;\n  original_line?: number | null;\n}\n\n/** @internal */\nexport interface GitHubReviewResponse {\n  id: number;\n  user: { login: string };\n  body: string;\n  state: string;\n  submitted_at: string;\n}\n\n/** @internal */\nexport interface GitHubIssueCommentResponse {\n  id: number;\n  user: { login: string };\n  body: string;\n  created_at: string;\n}\n","/**\n * GitHub Search Files Tool\n *\n * Search for files by glob pattern in a GitHub repository.\n * Mirrors the local `glob` tool for remote GitHub repos.\n *\n * Uses the Git Trees API to fetch the full file tree, then filters client-side.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubSearchFilesResult,\n  type GitHubTreeResponse,\n  type GitHubRepoResponse,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the search_files tool\n */\nexport interface SearchFilesArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** Glob pattern to match files (e.g., \"**\\/*.ts\", \"src/**\\/*.tsx\") */\n  pattern: string;\n  /** Branch, tag, or SHA (defaults to repo's default branch) */\n  ref?: string;\n}\n\n/**\n * Simple glob pattern matcher (matches the filesystem glob tool approach)\n */\nfunction matchGlobPattern(pattern: string, filePath: string): boolean {\n  let regexPattern = pattern\n    .replace(/[.+^${}()|[\\]\\\\]/g, '\\\\$&')\n    .replace(/\\*\\*/g, '{{GLOBSTAR}}')\n    .replace(/\\*/g, '[^/]*')\n    .replace(/\\?/g, '.')\n    .replace(/\\{\\{GLOBSTAR\\}\\}/g, '.*');\n\n  regexPattern = '^' + regexPattern + '$';\n\n  try {\n    const regex = new RegExp(regexPattern);\n    return regex.test(filePath);\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Create a GitHub search_files tool\n */\nexport function createSearchFilesTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<SearchFilesArgs, GitHubSearchFilesResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'search_files',\n        description: `Search for files by name/path pattern in a GitHub repository.\n\nUSAGE:\n- Supports glob patterns like \"**/*.ts\", \"src/**/*.tsx\"\n- Returns matching file paths sorted alphabetically\n- Uses the repository's file tree for fast matching\n\nPATTERN SYNTAX:\n- * matches any characters except /\n- ** matches any characters including /\n- ? matches a single character\n\nEXAMPLES:\n- Find all TypeScript files: { \"pattern\": \"**/*.ts\" }\n- Find files in src: { \"pattern\": \"src/**/*.{ts,tsx}\" }\n- Find package.json: { \"pattern\": \"**/package.json\" }\n- Search specific branch: { \"pattern\": \"**/*.ts\", \"ref\": \"develop\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            pattern: {\n              type: 'string',\n              description: 'Glob pattern to match files (e.g., \"**/*.ts\", \"src/**/*.tsx\")',\n            },\n            ref: {\n              type: 'string',\n              description: 'Branch, tag, or commit SHA. Defaults to the repository\\'s default branch.',\n            },\n          },\n          required: ['pattern'],\n        },\n      },\n    },\n\n    describeCall: (args: SearchFilesArgs): string => {\n      const parts = [args.pattern];\n      if (args.repository) parts.push(`in ${args.repository}`);\n      if (args.ref) parts.push(`@${args.ref}`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Search files in a GitHub repository via ${connector.displayName}`,\n    },\n\n    execute: async (args: SearchFilesArgs, context?: ToolContext): Promise<GitHubSearchFilesResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        // Resolve ref (default branch if not specified)\n        let ref = args.ref;\n        if (!ref) {\n          const repoInfo = await githubFetch<GitHubRepoResponse>(\n            connector,\n            `/repos/${owner}/${repo}`,\n            { userId: effectiveUserId, accountId: effectiveAccountId }\n          );\n          ref = repoInfo.default_branch;\n        }\n\n        // Fetch full tree\n        const tree = await githubFetch<GitHubTreeResponse>(\n          connector,\n          `/repos/${owner}/${repo}/git/trees/${ref}?recursive=1`,\n          { userId: effectiveUserId }\n        );\n\n        // Filter by glob pattern (only blobs, not trees)\n        const matching = tree.tree\n          .filter(\n            (entry) => entry.type === 'blob' && matchGlobPattern(args.pattern, entry.path)\n          )\n          .map((entry) => ({\n            path: entry.path,\n            size: entry.size ?? 0,\n            type: entry.type,\n          }))\n          .sort((a, b) => a.path.localeCompare(b.path));\n\n        return {\n          success: true,\n          files: matching,\n          count: matching.length,\n          truncated: tree.truncated,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to search files: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub Search Code Tool\n *\n * Search for code content across a GitHub repository.\n * Mirrors the local `grep` tool for remote GitHub repos.\n *\n * Uses the GitHub Code Search API with text-match support.\n *\n * Note: GitHub's code search API has a rate limit of 30 requests/minute.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubSearchCodeResult,\n  type GitHubSearchCodeResponse,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the search_code tool\n */\nexport interface SearchCodeArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** Search query (keyword or phrase) */\n  query: string;\n  /** Filter by programming language (e.g., \"typescript\", \"python\") */\n  language?: string;\n  /** Filter by file path (e.g., \"src/\", \"lib/utils\") */\n  path?: string;\n  /** Filter by file extension (e.g., \"ts\", \"py\") */\n  extension?: string;\n  /** Maximum number of results (default: 30, max: 100) */\n  limit?: number;\n}\n\n/**\n * Create a GitHub search_code tool\n */\nexport function createSearchCodeTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<SearchCodeArgs, GitHubSearchCodeResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'search_code',\n        description: `Search for code content across a GitHub repository.\n\nUSAGE:\n- Search by keyword, function name, class name, or any text\n- Filter by language, path, or file extension\n- Returns matching files with text fragments showing context\n\nRATE LIMITS:\n- GitHub's code search API is limited to 30 requests per minute\n- Results may be incomplete for very large repositories\n\nEXAMPLES:\n- Find function: { \"query\": \"function handleAuth\", \"language\": \"typescript\" }\n- Find imports: { \"query\": \"import React\", \"extension\": \"tsx\" }\n- Search in path: { \"query\": \"TODO\", \"path\": \"src/utils\" }\n- Limit results: { \"query\": \"console.log\", \"limit\": 10 }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            query: {\n              type: 'string',\n              description: 'Search query  keyword, function name, or any text to find in code',\n            },\n            language: {\n              type: 'string',\n              description: 'Filter by programming language (e.g., \"typescript\", \"python\", \"go\")',\n            },\n            path: {\n              type: 'string',\n              description: 'Filter by file path prefix (e.g., \"src/\", \"lib/utils\")',\n            },\n            extension: {\n              type: 'string',\n              description: 'Filter by file extension without dot (e.g., \"ts\", \"py\", \"go\")',\n            },\n            limit: {\n              type: 'number',\n              description: 'Maximum number of results (default: 30, max: 100)',\n            },\n          },\n          required: ['query'],\n        },\n      },\n    },\n\n    describeCall: (args: SearchCodeArgs): string => {\n      const parts = [`\"${args.query}\"`];\n      if (args.language) parts.push(`lang:${args.language}`);\n      if (args.repository) parts.push(`in ${args.repository}`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Search code in a GitHub repository via ${connector.displayName}`,\n    },\n\n    execute: async (args: SearchCodeArgs, context?: ToolContext): Promise<GitHubSearchCodeResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        // Build search query with qualifiers\n        const qualifiers = [`repo:${owner}/${repo}`];\n        if (args.language) qualifiers.push(`language:${args.language}`);\n        if (args.path) qualifiers.push(`path:${args.path}`);\n        if (args.extension) qualifiers.push(`extension:${args.extension}`);\n\n        const q = `${args.query} ${qualifiers.join(' ')}`;\n        const perPage = Math.min(args.limit ?? 30, 100);\n\n        const result = await githubFetch<GitHubSearchCodeResponse>(\n          connector,\n          `/search/code`,\n          {\n            userId: effectiveUserId,\n            accountId: effectiveAccountId,\n            // Request text-match fragments\n            accept: 'application/vnd.github.text-match+json',\n            queryParams: { q, per_page: perPage },\n          }\n        );\n\n        const matches = result.items.map((item) => ({\n          file: item.path,\n          fragment: item.text_matches?.[0]?.fragment,\n        }));\n\n        return {\n          success: true,\n          matches,\n          count: result.total_count,\n          truncated: result.incomplete_results || result.total_count > perPage,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to search code: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub Read File Tool\n *\n * Read file content from a GitHub repository.\n * Mirrors the local `read_file` tool for remote GitHub repos.\n *\n * Supports line range selection (offset/limit) and formats output\n * with line numbers matching the local read_file tool.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubReadFileResult,\n  type GitHubContentResponse,\n  type GitHubBlobResponse,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the GitHub read_file tool\n */\nexport interface GitHubReadFileArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** File path within the repository (e.g., \"src/index.ts\") */\n  path: string;\n  /** Branch, tag, or commit SHA. Defaults to the repository's default branch. */\n  ref?: string;\n  /** Line number to start reading from (1-indexed). Useful for large files. */\n  offset?: number;\n  /** Number of lines to read (default: 2000). */\n  limit?: number;\n}\n\n/**\n * Create a GitHub read_file tool\n */\nexport function createGitHubReadFileTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<GitHubReadFileArgs, GitHubReadFileResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'read_file',\n        description: `Read file content from a GitHub repository.\n\nUSAGE:\n- Reads a file and returns content with line numbers\n- Supports line range selection with offset/limit for large files\n- By default reads up to 2000 lines from the beginning\n\nEXAMPLES:\n- Read entire file: { \"path\": \"src/index.ts\" }\n- Read specific branch: { \"path\": \"README.md\", \"ref\": \"develop\" }\n- Read lines 100-200: { \"path\": \"src/app.ts\", \"offset\": 100, \"limit\": 100 }\n- Specific repo: { \"repository\": \"owner/repo\", \"path\": \"package.json\" }\n\nNOTE: Files larger than 1MB are fetched via the Git Blob API. Very large files (>5MB) may be truncated.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            path: {\n              type: 'string',\n              description: 'File path within the repository (e.g., \"src/index.ts\")',\n            },\n            ref: {\n              type: 'string',\n              description: \"Branch, tag, or commit SHA. Defaults to the repository's default branch.\",\n            },\n            offset: {\n              type: 'number',\n              description: 'Line number to start reading from (1-indexed). Only provide if the file is too large.',\n            },\n            limit: {\n              type: 'number',\n              description: 'Number of lines to read (default: 2000). Only provide if the file is too large.',\n            },\n          },\n          required: ['path'],\n        },\n      },\n    },\n\n    describeCall: (args: GitHubReadFileArgs): string => {\n      const parts = [args.path];\n      if (args.repository) parts.push(`in ${args.repository}`);\n      if (args.ref) parts.push(`@${args.ref}`);\n      if (args.offset && args.limit) parts.push(`[lines ${args.offset}-${args.offset + args.limit}]`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Read a file from a GitHub repository via ${connector.displayName}`,\n    },\n\n    execute: async (args: GitHubReadFileArgs, context?: ToolContext): Promise<GitHubReadFileResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        let fileContent: string;\n        let fileSha: string;\n        let fileSize: number;\n\n        // Fetch file via Contents API\n        const refParam = args.ref ? `?ref=${encodeURIComponent(args.ref)}` : '';\n        const contentResp = await githubFetch<GitHubContentResponse>(\n          connector,\n          `/repos/${owner}/${repo}/contents/${args.path}${refParam}`,\n          { userId: effectiveUserId, accountId: effectiveAccountId }\n        );\n\n        if (contentResp.type !== 'file') {\n          return {\n            success: false,\n            error: `Path is not a file: ${args.path} (type: ${contentResp.type}). Use search_files to explore the repository.`,\n            path: args.path,\n          };\n        }\n\n        fileSha = contentResp.sha;\n        fileSize = contentResp.size;\n\n        if (contentResp.content && contentResp.encoding === 'base64') {\n          // Standard case: file content is inline as base64\n          fileContent = Buffer.from(contentResp.content, 'base64').toString('utf-8');\n        } else if (contentResp.git_url) {\n          // Large file (>1MB): fall back to Blob API\n          const blob = await githubFetch<GitHubBlobResponse>(\n            connector,\n            contentResp.git_url,\n            { userId: effectiveUserId, accountId: effectiveAccountId }\n          );\n          fileContent = Buffer.from(blob.content, 'base64').toString('utf-8');\n          fileSize = blob.size;\n        } else {\n          return {\n            success: false,\n            error: `Cannot read file content: ${args.path} (no content or git_url in response)`,\n            path: args.path,\n          };\n        }\n\n        // Apply offset and limit (matching filesystem readFile behavior)\n        const offset = args.offset ?? 1;\n        const limit = args.limit ?? 2000;\n\n        const allLines = fileContent.split('\\n');\n        const totalLines = allLines.length;\n\n        const startIndex = Math.max(0, offset - 1);\n        const endIndex = Math.min(totalLines, startIndex + limit);\n        const selectedLines = allLines.slice(startIndex, endIndex);\n\n        // Format with line numbers (matching filesystem readFile format)\n        const lineNumberWidth = String(endIndex).length;\n        const formattedLines = selectedLines.map((line, i) => {\n          const lineNum = startIndex + i + 1;\n          const paddedNum = String(lineNum).padStart(lineNumberWidth, ' ');\n          const truncatedLine = line.length > 2000 ? line.substring(0, 2000) + '...' : line;\n          return `${paddedNum}\\t${truncatedLine}`;\n        });\n\n        const truncated = endIndex < totalLines;\n        const result = formattedLines.join('\\n');\n\n        return {\n          success: true,\n          content: result,\n          path: args.path,\n          size: fileSize,\n          lines: totalLines,\n          truncated,\n          sha: fileSha,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to read file: ${error instanceof Error ? error.message : String(error)}`,\n          path: args.path,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub Get PR Tool\n *\n * Get full details of a pull request from a GitHub repository.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubGetPRResult,\n  type GitHubPRResponse,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the get_pr tool\n */\nexport interface GetPRArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** Pull request number */\n  pull_number: number;\n}\n\n/**\n * Create a GitHub get_pr tool\n */\nexport function createGetPRTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<GetPRArgs, GitHubGetPRResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'get_pr',\n        description: `Get full details of a pull request from a GitHub repository.\n\nReturns: title, description, state, author, labels, reviewers, merge status, branches, file stats, and more.\n\nEXAMPLES:\n- Get PR: { \"pull_number\": 123 }\n- Specific repo: { \"repository\": \"owner/repo\", \"pull_number\": 456 }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            pull_number: {\n              type: 'number',\n              description: 'Pull request number',\n            },\n          },\n          required: ['pull_number'],\n        },\n      },\n    },\n\n    describeCall: (args: GetPRArgs): string => {\n      const parts = [`#${args.pull_number}`];\n      if (args.repository) parts.push(`in ${args.repository}`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Get pull request details from GitHub via ${connector.displayName}`,\n    },\n\n    execute: async (args: GetPRArgs, context?: ToolContext): Promise<GitHubGetPRResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        const pr = await githubFetch<GitHubPRResponse>(\n          connector,\n          `/repos/${owner}/${repo}/pulls/${args.pull_number}`,\n          { userId: effectiveUserId, accountId: effectiveAccountId }\n        );\n\n        return {\n          success: true,\n          data: {\n            number: pr.number,\n            title: pr.title,\n            body: pr.body,\n            state: pr.state,\n            draft: pr.draft,\n            author: pr.user.login,\n            labels: pr.labels.map((l) => l.name),\n            reviewers: pr.requested_reviewers.map((r) => r.login),\n            mergeable: pr.mergeable,\n            head: pr.head.ref,\n            base: pr.base.ref,\n            url: pr.html_url,\n            created_at: pr.created_at,\n            updated_at: pr.updated_at,\n            additions: pr.additions,\n            deletions: pr.deletions,\n            changed_files: pr.changed_files,\n          },\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to get PR: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub PR Files Tool\n *\n * Get the files changed in a pull request, including diffs.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubPRFilesResult,\n  type GitHubPRFileEntry,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the pr_files tool\n */\nexport interface PRFilesArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** Pull request number */\n  pull_number: number;\n}\n\n/**\n * Create a GitHub pr_files tool\n */\nexport function createPRFilesTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<PRFilesArgs, GitHubPRFilesResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'pr_files',\n        description: `Get the files changed in a pull request with diffs.\n\nReturns: filename, status (added/modified/removed/renamed), additions, deletions, and patch (diff) content for each file.\n\nEXAMPLES:\n- Get files: { \"pull_number\": 123 }\n- Specific repo: { \"repository\": \"owner/repo\", \"pull_number\": 456 }\n\nNOTE: Very large diffs may be truncated by GitHub. Patch content may be absent for binary files.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            pull_number: {\n              type: 'number',\n              description: 'Pull request number',\n            },\n          },\n          required: ['pull_number'],\n        },\n      },\n    },\n\n    describeCall: (args: PRFilesArgs): string => {\n      const parts = [`files for #${args.pull_number}`];\n      if (args.repository) parts.push(`in ${args.repository}`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Get PR changed files from GitHub via ${connector.displayName}`,\n    },\n\n    execute: async (args: PRFilesArgs, context?: ToolContext): Promise<GitHubPRFilesResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        const files = await githubFetch<GitHubPRFileEntry[]>(\n          connector,\n          `/repos/${owner}/${repo}/pulls/${args.pull_number}/files`,\n          {\n            userId: effectiveUserId,\n            accountId: effectiveAccountId,\n            queryParams: { per_page: 100 },\n          }\n        );\n\n        return {\n          success: true,\n          files: files.map((f) => ({\n            filename: f.filename,\n            status: f.status,\n            additions: f.additions,\n            deletions: f.deletions,\n            changes: f.changes,\n            patch: f.patch,\n          })),\n          count: files.length,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to get PR files: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub PR Comments Tool\n *\n * Get all comments and reviews on a pull request.\n * Merges three types: review comments (line-level), reviews, and issue comments.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubPRCommentsResult,\n  type GitHubPRCommentEntry,\n  type GitHubReviewCommentResponse,\n  type GitHubReviewResponse,\n  type GitHubIssueCommentResponse,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the pr_comments tool\n */\nexport interface PRCommentsArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** Pull request number */\n  pull_number: number;\n}\n\n/**\n * Create a GitHub pr_comments tool\n */\nexport function createPRCommentsTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<PRCommentsArgs, GitHubPRCommentsResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'pr_comments',\n        description: `Get all comments and reviews on a pull request.\n\nReturns a unified list of:\n- **review_comment**: Line-level comments on specific code (includes file path and line number)\n- **review**: Full reviews (approve/request changes/comment)\n- **comment**: General comments on the PR (issue-level)\n\nAll entries are sorted by creation date (oldest first).\n\nEXAMPLES:\n- Get comments: { \"pull_number\": 123 }\n- Specific repo: { \"repository\": \"owner/repo\", \"pull_number\": 456 }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            pull_number: {\n              type: 'number',\n              description: 'Pull request number',\n            },\n          },\n          required: ['pull_number'],\n        },\n      },\n    },\n\n    describeCall: (args: PRCommentsArgs): string => {\n      const parts = [`comments for #${args.pull_number}`];\n      if (args.repository) parts.push(`in ${args.repository}`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Get PR comments and reviews from GitHub via ${connector.displayName}`,\n    },\n\n    execute: async (args: PRCommentsArgs, context?: ToolContext): Promise<GitHubPRCommentsResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        const basePath = `/repos/${owner}/${repo}`;\n        const queryOpts = { userId: effectiveUserId, accountId: effectiveAccountId, queryParams: { per_page: 100 } as Record<string, string | number | boolean> };\n\n        // Fetch all three types in parallel\n        const [reviewComments, reviews, issueComments] = await Promise.all([\n          githubFetch<GitHubReviewCommentResponse[]>(\n            connector,\n            `${basePath}/pulls/${args.pull_number}/comments`,\n            queryOpts\n          ),\n          githubFetch<GitHubReviewResponse[]>(\n            connector,\n            `${basePath}/pulls/${args.pull_number}/reviews`,\n            queryOpts\n          ),\n          githubFetch<GitHubIssueCommentResponse[]>(\n            connector,\n            `${basePath}/issues/${args.pull_number}/comments`,\n            queryOpts\n          ),\n        ]);\n\n        // Merge into unified format\n        const allComments: GitHubPRCommentEntry[] = [];\n\n        for (const rc of reviewComments) {\n          allComments.push({\n            id: rc.id,\n            type: 'review_comment',\n            author: rc.user.login,\n            body: rc.body,\n            created_at: rc.created_at,\n            path: rc.path,\n            line: rc.line ?? rc.original_line ?? undefined,\n          });\n        }\n\n        for (const r of reviews) {\n          // Skip reviews with empty body (often just approval with no comment)\n          if (!r.body && r.state === 'APPROVED') continue;\n          allComments.push({\n            id: r.id,\n            type: 'review',\n            author: r.user.login,\n            body: r.body || `[${r.state}]`,\n            created_at: r.submitted_at,\n            state: r.state,\n          });\n        }\n\n        for (const ic of issueComments) {\n          allComments.push({\n            id: ic.id,\n            type: 'comment',\n            author: ic.user.login,\n            body: ic.body,\n            created_at: ic.created_at,\n          });\n        }\n\n        // Sort by creation date (oldest first)\n        allComments.sort(\n          (a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime()\n        );\n\n        return {\n          success: true,\n          comments: allComments,\n          count: allComments.length,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to get PR comments: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub Create PR Tool\n *\n * Create a pull request on a GitHub repository.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type GitHubCreatePRResult,\n  resolveRepository,\n  githubFetch,\n} from './types.js';\n\n/**\n * Arguments for the create_pr tool\n */\nexport interface CreatePRArgs {\n  /** Repository in \"owner/repo\" format or full GitHub URL */\n  repository?: string;\n  /** Pull request title */\n  title: string;\n  /** Pull request description/body (Markdown supported) */\n  body?: string;\n  /** Source branch name (the branch with your changes) */\n  head: string;\n  /** Target branch name (the branch you want to merge into) */\n  base: string;\n  /** Create as a draft pull request */\n  draft?: boolean;\n}\n\n/** @internal */\ninterface GitHubCreatePRResponse {\n  number: number;\n  html_url: string;\n  state: string;\n  title: string;\n}\n\n/**\n * Create a GitHub create_pr tool\n */\nexport function createCreatePRTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<CreatePRArgs, GitHubCreatePRResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'create_pr',\n        description: `Create a pull request on a GitHub repository.\n\nUSAGE:\n- Specify source branch (head) and target branch (base)\n- Optionally create as draft\n\nEXAMPLES:\n- Create PR: { \"title\": \"Add feature\", \"head\": \"feature-branch\", \"base\": \"main\" }\n- Draft PR: { \"title\": \"WIP: Refactor\", \"head\": \"refactor\", \"base\": \"develop\", \"draft\": true }\n- With body: { \"title\": \"Fix bug #42\", \"body\": \"Fixes the login issue\\\\n\\\\n## Changes\\\\n- Fixed auth flow\", \"head\": \"fix/42\", \"base\": \"main\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            repository: {\n              type: 'string',\n              description:\n                'Repository in \"owner/repo\" format or full GitHub URL. Optional if connector has a default repository.',\n            },\n            title: {\n              type: 'string',\n              description: 'Pull request title',\n            },\n            body: {\n              type: 'string',\n              description: 'Pull request description/body (Markdown supported)',\n            },\n            head: {\n              type: 'string',\n              description: 'Source branch name (the branch with your changes)',\n            },\n            base: {\n              type: 'string',\n              description: 'Target branch name (the branch you want to merge into, e.g., \"main\")',\n            },\n            draft: {\n              type: 'boolean',\n              description: 'Create as a draft pull request (default: false)',\n            },\n          },\n          required: ['title', 'head', 'base'],\n        },\n      },\n    },\n\n    describeCall: (args: CreatePRArgs): string => {\n      const parts = [args.title];\n      if (args.repository) parts.push(`in ${args.repository}`);\n      return parts.join(' ');\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Create a pull request on GitHub via ${connector.displayName}`,\n    },\n\n    execute: async (args: CreatePRArgs, context?: ToolContext): Promise<GitHubCreatePRResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const resolved = resolveRepository(args.repository, connector);\n      if (!resolved.success) {\n        return { success: false, error: resolved.error };\n      }\n      const { owner, repo } = resolved.repo;\n\n      try {\n        const pr = await githubFetch<GitHubCreatePRResponse>(\n          connector,\n          `/repos/${owner}/${repo}/pulls`,\n          {\n            method: 'POST',\n            userId: effectiveUserId,\n            accountId: effectiveAccountId,\n            body: {\n              title: args.title,\n              body: args.body,\n              head: args.head,\n              base: args.base,\n              draft: args.draft ?? false,\n            },\n          }\n        );\n\n        return {\n          success: true,\n          data: {\n            number: pr.number,\n            url: pr.html_url,\n            state: pr.state,\n            title: pr.title,\n          },\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to create PR: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * GitHub Connector Tools\n *\n * Auto-registers GitHub tool factories with ConnectorTools.\n * When imported, this module registers factories so that `ConnectorTools.for('github')`\n * automatically includes GitHub-specific tools alongside the generic API tool.\n *\n * Tools provided:\n * - search_files  Search files by glob pattern\n * - search_code  Search code content\n * - read_file  Read file content with line ranges\n * - get_pr  Get pull request details\n * - pr_files  Get PR changed files with diffs\n * - pr_comments  Get PR comments and reviews\n * - create_pr  Create a pull request\n */\n\n// Side-effect: register GitHub tool factories with ConnectorTools\nimport { registerGitHubTools } from './register.js';\nregisterGitHubTools();\n\n// Types\nexport type {\n  GitHubRepository,\n  GitHubSearchFilesResult,\n  GitHubSearchCodeResult,\n  GitHubReadFileResult,\n  GitHubGetPRResult,\n  GitHubPRFilesResult,\n  GitHubPRCommentsResult,\n  GitHubPRCommentEntry,\n  GitHubCreatePRResult,\n  GitHubAPIError,\n} from './types.js';\n\n// Utility functions\nexport { parseRepository, resolveRepository } from './types.js';\n\n// Tool factories (for direct use with custom options)\nexport { createSearchFilesTool } from './searchFiles.js';\nexport { createSearchCodeTool } from './searchCode.js';\nexport { createGitHubReadFileTool } from './readFile.js';\nexport { createGetPRTool } from './getPR.js';\nexport { createPRFilesTool } from './prFiles.js';\nexport { createPRCommentsTool } from './prComments.js';\nexport { createCreatePRTool } from './createPR.js';\n","/**\n * Microsoft Graph Tools Registration\n *\n * Registers Microsoft-specific tool factory with ConnectorTools.\n * When a connector with serviceType 'microsoft' (or baseURL matching graph.microsoft.com)\n * is used, these tools become available automatically.\n */\n\nimport { ConnectorTools } from '../connector/ConnectorTools.js';\nimport type { Connector } from '../../core/Connector.js';\nimport { createDraftEmailTool } from './createDraftEmail.js';\nimport { createSendEmailTool } from './sendEmail.js';\nimport { createMeetingTool } from './createMeeting.js';\nimport { createEditMeetingTool } from './editMeeting.js';\nimport { createGetMeetingTranscriptTool } from './getMeetingTranscript.js';\nimport { createFindMeetingSlotsTool } from './findMeetingSlots.js';\nimport { createMicrosoftReadFileTool } from './readFile.js';\nimport { createMicrosoftListFilesTool } from './listFiles.js';\nimport { createMicrosoftSearchFilesTool } from './searchFiles.js';\n\n/**\n * Register Microsoft Graph tools with the ConnectorTools framework.\n *\n * After calling this, `ConnectorTools.for('my-microsoft-connector')` will\n * return all 9 Microsoft tools plus the generic API tool.\n */\nexport function registerMicrosoftTools(): void {\n  ConnectorTools.registerService('microsoft', (connector: Connector, userId?: string) => {\n    return [\n      // Email\n      createDraftEmailTool(connector, userId),\n      createSendEmailTool(connector, userId),\n      // Meetings\n      createMeetingTool(connector, userId),\n      createEditMeetingTool(connector, userId),\n      createGetMeetingTranscriptTool(connector, userId),\n      createFindMeetingSlotsTool(connector, userId),\n      // Files (OneDrive / SharePoint)\n      createMicrosoftReadFileTool(connector, userId),\n      createMicrosoftListFilesTool(connector, userId),\n      createMicrosoftSearchFilesTool(connector, userId),\n    ];\n  });\n}\n","/**\n * Microsoft Graph Tools - Shared Types and Helpers\n *\n * Foundation for all Microsoft Graph connector tools.\n * Provides authenticated fetch, delegated/app mode switching, and result types.\n */\n\nimport type { Connector } from '../../core/Connector.js';\n\n// ============================================================================\n// Delegated / Application Mode\n// ============================================================================\n\n/**\n * Get the user path prefix for Microsoft Graph API requests.\n *\n * - OAuth `authorization_code` flow (delegated): returns `/me` (ignores targetUser)\n * - OAuth `client_credentials` flow (application): returns `/users/${targetUser}` (requires targetUser)\n * - API key / other: returns `/me`\n */\nexport function getUserPathPrefix(connector: Connector, targetUser?: string): string {\n  const auth = connector.config.auth;\n  if (auth.type === 'oauth' && auth.flow === 'client_credentials') {\n    if (!targetUser) {\n      throw new Error(\n        'targetUser is required when using client_credentials (application) flow. ' +\n        'Provide a user ID or UPN (e.g., \"user@domain.com\").'\n      );\n    }\n    return `/users/${targetUser}`;\n  }\n  return '/me';\n}\n\n// ============================================================================\n// Microsoft Graph API Helpers\n// ============================================================================\n\n/**\n * Options for microsoftFetch\n */\nexport interface MicrosoftFetchOptions {\n  method?: string;\n  body?: unknown;\n  userId?: string;\n  accountId?: string;\n  queryParams?: Record<string, string | number | boolean>;\n  accept?: string;\n}\n\n/**\n * Error from Microsoft Graph API\n */\nexport class MicrosoftAPIError extends Error {\n  constructor(\n    public readonly status: number,\n    public readonly statusText: string,\n    public readonly body: unknown\n  ) {\n    const msg = typeof body === 'object' && body !== null && 'error' in body\n      ? ((body as { error: { message: string } }).error?.message ?? statusText)\n      : statusText;\n    super(`Microsoft Graph API error ${status}: ${msg}`);\n    this.name = 'MicrosoftAPIError';\n  }\n}\n\n/**\n * Make an authenticated Microsoft Graph API request through the connector.\n *\n * Adds standard headers and parses JSON response.\n * Handles empty response bodies (e.g., sendMail returns 202 with no body).\n * Throws MicrosoftAPIError on non-ok responses.\n */\nexport async function microsoftFetch<T = unknown>(\n  connector: Connector,\n  endpoint: string,\n  options?: MicrosoftFetchOptions\n): Promise<T> {\n  let url = endpoint;\n\n  // Add query params if provided\n  if (options?.queryParams && Object.keys(options.queryParams).length > 0) {\n    const params = new URLSearchParams();\n    for (const [key, value] of Object.entries(options.queryParams)) {\n      params.append(key, String(value));\n    }\n    url += (url.includes('?') ? '&' : '?') + params.toString();\n  }\n\n  const headers: Record<string, string> = {\n    'Accept': options?.accept ?? 'application/json',\n  };\n\n  if (options?.body) {\n    headers['Content-Type'] = 'application/json';\n  }\n\n  const response = await connector.fetch(\n    url,\n    {\n      method: options?.method ?? 'GET',\n      headers,\n      body: options?.body ? JSON.stringify(options.body) : undefined,\n    },\n    options?.userId,\n    options?.accountId\n  );\n\n  const text = await response.text();\n\n  if (!response.ok) {\n    let data: unknown;\n    try {\n      data = JSON.parse(text);\n    } catch {\n      data = text;\n    }\n    throw new MicrosoftAPIError(response.status, response.statusText, data);\n  }\n\n  // Handle empty response body (e.g., sendMail returns 202)\n  if (!text || text.trim().length === 0) {\n    return undefined as T;\n  }\n\n  try {\n    return JSON.parse(text) as T;\n  } catch {\n    return text as T;\n  }\n}\n\n// ============================================================================\n// Utility Helpers\n// ============================================================================\n\n/**\n * Normalize an email array from any format the LLM might send into plain strings.\n *\n * Accepts:\n * - Plain strings: `[\"alice@contoso.com\"]`\n * - Graph recipient objects: `[{ emailAddress: { address: \"alice@contoso.com\" } }]`\n * - Graph attendee objects: `[{ emailAddress: { address: \"alice@contoso.com\", name: \"Alice\" }, type: \"required\" }]`\n * - Bare email objects: `[{ address: \"alice@contoso.com\" }]` or `[{ email: \"alice@contoso.com\" }]`\n *\n * Always returns `string[]` of email addresses.\n */\nexport function normalizeEmails(input: unknown[]): string[] {\n  return input.map((item) => {\n    if (typeof item === 'string') return item;\n    if (typeof item === 'object' && item !== null) {\n      const obj = item as Record<string, unknown>;\n      // { emailAddress: { address: \"...\" } }  Graph recipient/attendee format\n      if (obj.emailAddress && typeof obj.emailAddress === 'object') {\n        const ea = obj.emailAddress as Record<string, unknown>;\n        if (typeof ea.address === 'string') return ea.address;\n      }\n      // { address: \"...\" }  bare email object\n      if (typeof obj.address === 'string') return obj.address;\n      // { email: \"...\" }  common LLM mistake\n      if (typeof obj.email === 'string') return obj.email;\n    }\n    // Last resort: stringify and hope for the best\n    return String(item);\n  });\n}\n\n/**\n * Convert an array of email addresses (any format) to Microsoft Graph recipient format.\n * Normalizes input first, so it's safe to pass LLM output directly.\n */\nexport function formatRecipients(emails: unknown[]): { emailAddress: { address: string } }[] {\n  return normalizeEmails(emails).map((address) => ({ emailAddress: { address } }));\n}\n\n/**\n * Convert an array of email addresses (any format) to Microsoft Graph attendee format.\n * Normalizes input first, so it's safe to pass LLM output directly.\n */\nexport function formatAttendees(emails: unknown[]): { emailAddress: { address: string }; type: string }[] {\n  return normalizeEmails(emails).map((address) => ({\n    emailAddress: { address },\n    type: 'required',\n  }));\n}\n\n/**\n * Check if a meeting ID input is a Teams join URL.\n *\n * Teams join URLs look like:\n * - `https://teams.microsoft.com/l/meetup-join/19%3ameeting_...`\n * - `https://teams.live.com/l/meetup-join/...`\n *\n * IMPORTANT: A Teams join URL does NOT contain the Graph API meeting ID.\n * To resolve a URL to a meeting ID, use `resolveMeetingId()` which calls\n * `GET /me/onlineMeetings?$filter=JoinWebUrl eq '{url}'`.\n */\nexport function isTeamsMeetingUrl(input: string): boolean {\n  try {\n    const url = new URL(input.trim());\n    return (\n      (url.hostname === 'teams.microsoft.com' || url.hostname === 'teams.live.com') &&\n      url.pathname.includes('meetup-join')\n    );\n  } catch {\n    return false;\n  }\n}\n\n/** @internal Graph API response for onlineMeetings filter query */\nexport interface GraphOnlineMeetingListResponse {\n  value: { id: string; subject?: string; joinWebUrl?: string }[];\n}\n\n/**\n * Resolve a meeting input (ID or Teams URL) to a Graph API online meeting ID.\n *\n * - Raw meeting IDs are passed through as-is\n * - Teams join URLs are resolved via `GET /me/onlineMeetings?$filter=JoinWebUrl eq '{url}'`\n *\n * @returns The resolved meeting ID and optional subject\n * @throws Error if the URL cannot be resolved or input is empty\n */\nexport async function resolveMeetingId(\n  connector: Connector,\n  input: string,\n  prefix: string,\n  effectiveUserId?: string,\n  effectiveAccountId?: string\n): Promise<{ meetingId: string; subject?: string }> {\n  if (!input || input.trim().length === 0) {\n    throw new Error('Meeting ID cannot be empty');\n  }\n\n  const trimmed = input.trim();\n\n  if (!isTeamsMeetingUrl(trimmed)) {\n    return { meetingId: trimmed };\n  }\n\n  // Resolve Teams URL to meeting ID via Graph API filter\n  const meetings = await microsoftFetch<GraphOnlineMeetingListResponse>(\n    connector,\n    `${prefix}/onlineMeetings`,\n    {\n      userId: effectiveUserId,\n      accountId: effectiveAccountId,\n      queryParams: { '$filter': `JoinWebUrl eq '${trimmed}'` },\n    }\n  );\n\n  if (!meetings.value || meetings.value.length === 0) {\n    throw new Error(\n      `Could not find an online meeting matching the provided Teams URL. ` +\n      `Make sure the URL is correct and you have access to this meeting.`\n    );\n  }\n\n  return {\n    meetingId: meetings.value[0]!.id,\n    subject: meetings.value[0]!.subject,\n  };\n}\n\n// ============================================================================\n// Result Types\n// ============================================================================\n\nexport interface MicrosoftDraftEmailResult {\n  success: boolean;\n  draftId?: string;\n  webLink?: string;\n  error?: string;\n}\n\nexport interface MicrosoftSendEmailResult {\n  success: boolean;\n  error?: string;\n}\n\nexport interface MicrosoftCreateMeetingResult {\n  success: boolean;\n  eventId?: string;\n  webLink?: string;\n  onlineMeetingUrl?: string;\n  error?: string;\n}\n\nexport interface MicrosoftEditMeetingResult {\n  success: boolean;\n  eventId?: string;\n  webLink?: string;\n  error?: string;\n}\n\nexport interface MicrosoftGetTranscriptResult {\n  success: boolean;\n  transcript?: string;\n  meetingSubject?: string;\n  error?: string;\n}\n\nexport interface MicrosoftFindSlotsResult {\n  success: boolean;\n  slots?: MeetingSlotSuggestion[];\n  emptySuggestionsReason?: string;\n  error?: string;\n}\n\nexport interface MeetingSlotSuggestion {\n  start: string;\n  end: string;\n  confidence: string;\n  attendeeAvailability: { attendee: string; availability: string }[];\n}\n\n// ============================================================================\n// Internal Graph API Response Types\n// ============================================================================\n\n/** @internal */\nexport interface GraphMessageResponse {\n  id: string;\n  webLink?: string;\n  subject?: string;\n  [key: string]: unknown;\n}\n\n/** @internal */\nexport interface GraphEventResponse {\n  id: string;\n  webLink?: string;\n  subject?: string;\n  onlineMeeting?: { joinUrl?: string } | null;\n  [key: string]: unknown;\n}\n\n/** @internal */\nexport interface GraphTranscriptListResponse {\n  value: { id: string; createdDateTime?: string }[];\n}\n\n/** @internal */\nexport interface GraphFindMeetingTimesResponse {\n  meetingTimeSuggestions: {\n    confidence: number;\n    meetingTimeSlot: {\n      start: { dateTime: string; timeZone: string };\n      end: { dateTime: string; timeZone: string };\n    };\n    attendeeAvailability: {\n      attendee: { emailAddress: { address: string } };\n      availability: string;\n    }[];\n  }[];\n  emptySuggestionsReason?: string;\n}\n\n// ============================================================================\n// File / Drive Types and Helpers\n// ============================================================================\n\n/** @internal Graph driveItem metadata */\nexport interface GraphDriveItem {\n  id: string;\n  name: string;\n  size: number;\n  webUrl?: string;\n  lastModifiedDateTime?: string;\n  createdDateTime?: string;\n  file?: { mimeType?: string; hashes?: Record<string, string> };\n  folder?: { childCount?: number };\n  parentReference?: {\n    driveId?: string;\n    driveType?: string;\n    id?: string;\n    name?: string;\n    path?: string;\n    siteId?: string;\n  };\n  '@microsoft.graph.downloadUrl'?: string;\n}\n\n/** @internal Graph response for listing children or search results */\nexport interface GraphDriveItemListResponse {\n  value: GraphDriveItem[];\n  '@odata.nextLink'?: string;\n  '@odata.count'?: number;\n}\n\n/** @internal Graph search API response */\nexport interface GraphSearchResponse {\n  value: {\n    hitsContainers: {\n      hits: {\n        hitId: string;\n        summary?: string;\n        resource: GraphDriveItem & {\n          parentReference?: GraphDriveItem['parentReference'] & { name?: string };\n        };\n      }[];\n      total: number;\n      moreResultsAvailable: boolean;\n    }[];\n  }[];\n}\n\n// ---- Result types ----\n\nexport interface MicrosoftReadFileResult {\n  success: boolean;\n  filename?: string;\n  sizeBytes?: number;\n  mimeType?: string;\n  markdown?: string;\n  webUrl?: string;\n  error?: string;\n}\n\nexport interface MicrosoftListFilesResult {\n  success: boolean;\n  items?: {\n    name: string;\n    type: 'file' | 'folder';\n    size: number;\n    sizeFormatted: string;\n    mimeType?: string;\n    lastModified?: string;\n    webUrl?: string;\n    id: string;\n    childCount?: number;\n  }[];\n  totalCount?: number;\n  hasMore?: boolean;\n  error?: string;\n}\n\nexport interface MicrosoftSearchFilesResult {\n  success: boolean;\n  results?: {\n    name: string;\n    path?: string;\n    site?: string;\n    snippet?: string;\n    size: number;\n    sizeFormatted: string;\n    webUrl?: string;\n    id: string;\n    lastModified?: string;\n  }[];\n  totalCount?: number;\n  hasMore?: boolean;\n  error?: string;\n}\n\n// ---- File source resolution ----\n\n/** Default file size limit (50 MB) */\nexport const DEFAULT_MAX_FILE_SIZE_BYTES = 50 * 1024 * 1024;\n\n/**\n * Per-extension file size limits.\n * Presentations can be very large due to embedded images, but since we extract\n * text/markdown only (images are discarded), larger limits are safe.\n */\nexport const DEFAULT_FILE_SIZE_LIMITS: Record<string, number> = {\n  '.pptx': 100 * 1024 * 1024,  // 100 MB  presentations are image-heavy\n  '.ppt':  100 * 1024 * 1024,\n  '.odp':  100 * 1024 * 1024,\n};\n\n/**\n * Get the file size limit for a given extension.\n * Checks per-extension overrides first, then falls back to the default.\n */\nexport function getFileSizeLimit(\n  ext: string,\n  overrides?: Record<string, number>,\n  defaultLimit?: number,\n): number {\n  const merged = { ...DEFAULT_FILE_SIZE_LIMITS, ...overrides };\n  return merged[ext.toLowerCase()] ?? defaultLimit ?? DEFAULT_MAX_FILE_SIZE_BYTES;\n}\n\n/** Supported document extensions that DocumentReader can convert to markdown */\nexport const SUPPORTED_EXTENSIONS = new Set([\n  '.docx', '.pptx', '.xlsx', '.csv', '.pdf',\n  '.odt', '.odp', '.ods', '.rtf',\n  '.html', '.htm',\n  '.txt', '.md', '.json', '.xml', '.yaml', '.yml',\n]);\n\n/**\n * Encode a sharing URL into the Graph API sharing token format.\n *\n * Microsoft Graph's `/shares/{token}` endpoint accepts base64url-encoded URLs\n * prefixed with `u!`. This is the documented way to access files via sharing links\n * or direct web URLs without knowing the driveId/itemId.\n *\n * @see https://learn.microsoft.com/en-us/graph/api/shares-get\n */\nexport function encodeSharingUrl(webUrl: string): string {\n  const base64 = Buffer.from(webUrl, 'utf-8')\n    .toString('base64')\n    .replace(/=+$/, '')\n    .replace(/\\//g, '_')\n    .replace(/\\+/g, '-');\n  return `u!${base64}`;\n}\n\n/**\n * Check if a string looks like a web URL (http/https).\n */\nexport function isWebUrl(source: string): boolean {\n  return /^https?:\\/\\//i.test(source.trim());\n}\n\n/**\n * Check if a string looks like a OneDrive/SharePoint web URL.\n *\n * Matches:\n * - `*.sharepoint.com/*`\n * - `onedrive.live.com/*`\n * - `1drv.ms/*`\n * - `*.sharepoint-df.com/*` (dogfood/test)\n */\nexport function isMicrosoftFileUrl(source: string): boolean {\n  try {\n    const url = new URL(source.trim());\n    const host = url.hostname.toLowerCase();\n    return (\n      host.endsWith('.sharepoint.com') ||\n      host.endsWith('.sharepoint-df.com') ||\n      host === 'onedrive.live.com' ||\n      host === '1drv.ms'\n    );\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Determine the drive prefix for Graph API calls.\n *\n * Priority:\n * 1. siteId  `/sites/{siteId}/drive`\n * 2. driveId  `/drives/{driveId}`\n * 3. fallback  `{userPrefix}/drive` (e.g., `/me/drive`)\n */\nexport function getDrivePrefix(\n  userPrefix: string,\n  options?: { siteId?: string; driveId?: string }\n): string {\n  if (options?.siteId) return `/sites/${options.siteId}/drive`;\n  if (options?.driveId) return `/drives/${options.driveId}`;\n  return `${userPrefix}/drive`;\n}\n\n/**\n * Build the Graph API endpoint and metadata endpoint for a file source.\n *\n * Handles three input types:\n * 1. Web URL (SharePoint/OneDrive link)  uses `/shares/{token}/driveItem`\n * 2. Path (starts with `/`)  uses `/drive/root:{path}:`\n * 3. Item ID  uses `/drive/items/{id}`\n *\n * @returns Object with `metadataEndpoint` (for item info) and `contentEndpoint` (for download)\n */\nexport function resolveFileEndpoints(\n  source: string,\n  drivePrefix: string\n): { metadataEndpoint: string; contentEndpoint: string; isSharedUrl: boolean } {\n  const trimmed = source.trim();\n\n  // Web URL  sharing link resolution\n  if (isWebUrl(trimmed)) {\n    const token = encodeSharingUrl(trimmed);\n    return {\n      metadataEndpoint: `/shares/${token}/driveItem`,\n      contentEndpoint: `/shares/${token}/driveItem/content`,\n      isSharedUrl: true,\n    };\n  }\n\n  // Path  root-relative\n  if (trimmed.startsWith('/')) {\n    const path = trimmed.endsWith('/') ? trimmed.slice(0, -1) : trimmed;\n    return {\n      metadataEndpoint: `${drivePrefix}/root:${path}:`,\n      contentEndpoint: `${drivePrefix}/root:${path}:/content`,\n      isSharedUrl: false,\n    };\n  }\n\n  // Item ID\n  return {\n    metadataEndpoint: `${drivePrefix}/items/${trimmed}`,\n    contentEndpoint: `${drivePrefix}/items/${trimmed}/content`,\n    isSharedUrl: false,\n  };\n}\n\n/**\n * Format a file size in bytes to a human-readable string.\n */\nexport function formatFileSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  if (bytes < 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  return `${(bytes / (1024 * 1024 * 1024)).toFixed(1)} GB`;\n}\n","/**\n * Microsoft Graph - Create Draft Email Tool\n *\n * Create a draft email or draft reply in the user's mailbox.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type MicrosoftDraftEmailResult,\n  type GraphMessageResponse,\n  getUserPathPrefix,\n  microsoftFetch,\n  formatRecipients,\n} from './types.js';\n\nexport interface CreateDraftEmailArgs {\n  to: string[];\n  subject: string;\n  body: string;\n  cc?: string[];\n  replyToMessageId?: string;\n  targetUser?: string;\n}\n\n/**\n * Create a Microsoft Graph create_draft_email tool\n */\nexport function createDraftEmailTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<CreateDraftEmailArgs, MicrosoftDraftEmailResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'create_draft_email',\n        description: `Create a draft email or draft reply in the user's Outlook mailbox via Microsoft Graph. The draft is saved but NOT sent  use send_email to send immediately instead.\n\nPARAMETER FORMATS:\n- to/cc: plain string array of email addresses. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]. Do NOT use objects.\n- subject: plain string. Example: \"Project update\" or \"Re: Project update\" for replies.\n- body: HTML string. Example: \"<p>Hi Alice,</p><p>Here is the update.</p>\". Use <p>, <br>, <b>, <ul> tags for formatting.\n- replyToMessageId: Graph message ID string (starts with \"AAMk...\"). Only set when replying to an existing email.\n\nEXAMPLES:\n- New draft: { \"to\": [\"alice@contoso.com\"], \"subject\": \"Project update\", \"body\": \"<p>Hi Alice,</p><p>Here is the update.</p>\" }\n- Reply draft: { \"to\": [\"alice@contoso.com\"], \"subject\": \"Re: Project update\", \"body\": \"<p>Thanks!</p>\", \"replyToMessageId\": \"AAMkADI1...\" }\n- With CC: { \"to\": [\"alice@contoso.com\"], \"subject\": \"Notes\", \"body\": \"<p>See attached.</p>\", \"cc\": [\"bob@contoso.com\"] }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            to: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'Recipient email addresses as plain strings. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]',\n            },\n            subject: {\n              type: 'string',\n              description: 'Email subject as plain string. Example: \"Project update\" or \"Re: Original subject\" for replies.',\n            },\n            body: {\n              type: 'string',\n              description: 'Email body as an HTML string. Example: \"<p>Hello!</p><p>See you tomorrow.</p>\"',\n            },\n            cc: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'CC email addresses as plain strings. Example: [\"bob@contoso.com\"]. Optional.',\n            },\n            replyToMessageId: {\n              type: 'string',\n              description: 'Graph message ID of the email to reply to. Example: \"AAMkADI1M2I3YzgtODg...\". When set, creates a threaded reply draft.',\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email (UPN) for app-only auth. Example: \"alice@contoso.com\". Ignored in delegated auth.',\n            },\n          },\n          required: ['to', 'subject', 'body'],\n        },\n      },\n    },\n\n    describeCall: (args: CreateDraftEmailArgs): string => {\n      const action = args.replyToMessageId ? 'Reply draft' : 'Draft';\n      return `${action} to ${args.to.join(', ')}: ${args.subject}`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Create a draft email via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: CreateDraftEmailArgs,\n      context?: ToolContext\n    ): Promise<MicrosoftDraftEmailResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      try {\n        const prefix = getUserPathPrefix(connector, args.targetUser);\n\n        if (args.replyToMessageId) {\n          // Reply draft: createReply  then PATCH to update body/recipients\n          const replyDraft = await microsoftFetch<GraphMessageResponse>(\n            connector,\n            `${prefix}/messages/${args.replyToMessageId}/createReply`,\n            { method: 'POST', userId: effectiveUserId, accountId: effectiveAccountId, body: {} }\n          );\n\n          // Update the reply draft with our content\n          const updated = await microsoftFetch<GraphMessageResponse>(\n            connector,\n            `${prefix}/messages/${replyDraft.id}`,\n            {\n              method: 'PATCH',\n              userId: effectiveUserId,\n              accountId: effectiveAccountId,\n              body: {\n                subject: args.subject,\n                body: { contentType: 'HTML', content: args.body },\n                toRecipients: formatRecipients(args.to),\n                ...(args.cc && { ccRecipients: formatRecipients(args.cc) }),\n              },\n            }\n          );\n\n          return {\n            success: true,\n            draftId: updated.id,\n            webLink: updated.webLink,\n          };\n        }\n\n        // New draft\n        const draft = await microsoftFetch<GraphMessageResponse>(\n          connector,\n          `${prefix}/messages`,\n          {\n            method: 'POST',\n            userId: effectiveUserId,\n            accountId: effectiveAccountId,\n            body: {\n              isDraft: true,\n              subject: args.subject,\n              body: { contentType: 'HTML', content: args.body },\n              toRecipients: formatRecipients(args.to),\n              ...(args.cc && { ccRecipients: formatRecipients(args.cc) }),\n            },\n          }\n        );\n\n        return {\n          success: true,\n          draftId: draft.id,\n          webLink: draft.webLink,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to create draft email: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * Microsoft Graph - Send Email Tool\n *\n * Send an email or reply to an existing message.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type MicrosoftSendEmailResult,\n  getUserPathPrefix,\n  microsoftFetch,\n  formatRecipients,\n} from './types.js';\n\nexport interface SendEmailArgs {\n  to: string[];\n  subject: string;\n  body: string;\n  cc?: string[];\n  replyToMessageId?: string;\n  targetUser?: string;\n}\n\n/**\n * Create a Microsoft Graph send_email tool\n */\nexport function createSendEmailTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<SendEmailArgs, MicrosoftSendEmailResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'send_email',\n        description: `Send an email immediately or reply to an existing message via Microsoft Graph (Outlook). The email is sent right away  use create_draft_email to save a draft instead.\n\nPARAMETER FORMATS:\n- to/cc: plain string array of email addresses. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]. Do NOT use objects.\n- subject: plain string. Example: \"Meeting tomorrow\" or \"Re: Meeting tomorrow\" for replies.\n- body: HTML string. Example: \"<p>Hi Alice,</p><p>Can we meet at 2pm?</p>\". Use <p>, <br>, <b>, <ul> tags.\n- replyToMessageId: Graph message ID string (starts with \"AAMk...\"). Only set when replying to an existing email.\n\nEXAMPLES:\n- Send email: { \"to\": [\"alice@contoso.com\"], \"subject\": \"Meeting tomorrow\", \"body\": \"<p>Can we meet at 2pm?</p>\" }\n- Reply: { \"to\": [\"alice@contoso.com\"], \"subject\": \"Re: Meeting\", \"body\": \"<p>Confirmed!</p>\", \"replyToMessageId\": \"AAMkADI1...\" }\n- With CC: { \"to\": [\"alice@contoso.com\"], \"subject\": \"Update\", \"body\": \"<p>FYI</p>\", \"cc\": [\"bob@contoso.com\"] }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            to: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'Recipient email addresses as plain strings. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]',\n            },\n            subject: {\n              type: 'string',\n              description: 'Email subject as plain string. Example: \"Meeting tomorrow\" or \"Re: Original subject\" for replies.',\n            },\n            body: {\n              type: 'string',\n              description: 'Email body as an HTML string. Example: \"<p>Hi!</p><p>Can we meet at 2pm?</p>\"',\n            },\n            cc: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'CC email addresses as plain strings. Example: [\"bob@contoso.com\"]. Optional.',\n            },\n            replyToMessageId: {\n              type: 'string',\n              description: 'Graph message ID of the email to reply to. Example: \"AAMkADI1M2I3YzgtODg...\". When set, sends a threaded reply.',\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email (UPN) for app-only auth. Example: \"alice@contoso.com\". Ignored in delegated auth.',\n            },\n          },\n          required: ['to', 'subject', 'body'],\n        },\n      },\n    },\n\n    describeCall: (args: SendEmailArgs): string => {\n      const action = args.replyToMessageId ? 'Reply' : 'Send';\n      return `${action} to ${args.to.join(', ')}: ${args.subject}`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Send an email via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: SendEmailArgs,\n      context?: ToolContext\n    ): Promise<MicrosoftSendEmailResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      try {\n        const prefix = getUserPathPrefix(connector, args.targetUser);\n\n        if (args.replyToMessageId) {\n          // Reply to existing message\n          await microsoftFetch(\n            connector,\n            `${prefix}/messages/${args.replyToMessageId}/reply`,\n            {\n              method: 'POST',\n              userId: effectiveUserId,\n              accountId: effectiveAccountId,\n              body: {\n                message: {\n                  toRecipients: formatRecipients(args.to),\n                  ...(args.cc && { ccRecipients: formatRecipients(args.cc) }),\n                },\n                comment: args.body,\n              },\n            }\n          );\n        } else {\n          // Send new email (returns 202 with empty body)\n          await microsoftFetch(\n            connector,\n            `${prefix}/sendMail`,\n            {\n              method: 'POST',\n              userId: effectiveUserId,\n              accountId: effectiveAccountId,\n              body: {\n                message: {\n                  subject: args.subject,\n                  body: { contentType: 'HTML', content: args.body },\n                  toRecipients: formatRecipients(args.to),\n                  ...(args.cc && { ccRecipients: formatRecipients(args.cc) }),\n                },\n                saveToSentItems: true,\n              },\n            }\n          );\n        }\n\n        return { success: true };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to send email: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * Microsoft Graph - Create Meeting Tool\n *\n * Create a calendar event with optional Teams online meeting.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type MicrosoftCreateMeetingResult,\n  type GraphEventResponse,\n  getUserPathPrefix,\n  microsoftFetch,\n  formatAttendees,\n} from './types.js';\n\nexport interface CreateMeetingArgs {\n  subject: string;\n  startDateTime: string;\n  endDateTime: string;\n  attendees: string[];\n  body?: string;\n  isOnlineMeeting?: boolean;\n  location?: string;\n  timeZone?: string;\n  targetUser?: string;\n}\n\n/**\n * Create a Microsoft Graph create_meeting tool\n */\nexport function createMeetingTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<CreateMeetingArgs, MicrosoftCreateMeetingResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'create_meeting',\n        description: `Create a calendar event on the user's Outlook calendar via Microsoft Graph, optionally with a Teams online meeting link.\n\nPARAMETER FORMATS:\n- subject: plain string. Example: \"Sprint Review\"\n- startDateTime/endDateTime: ISO 8601 string WITHOUT timezone suffix (timezone is a separate param). Example: \"2025-01-15T09:00:00\"\n- attendees: plain string array of email addresses. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]. Do NOT use objects.\n- body: HTML string for the invitation body. Example: \"<p>Agenda: discuss Q1 goals</p>\". Optional.\n- timeZone: IANA timezone string. Example: \"America/New_York\", \"Europe/Zurich\". Default: \"UTC\".\n- isOnlineMeeting: boolean. Set true to auto-generate a Teams meeting link.\n- location: plain string. Example: \"Conference Room A\". Optional.\n\nEXAMPLES:\n- Simple: { \"subject\": \"Standup\", \"startDateTime\": \"2025-01-15T09:00:00\", \"endDateTime\": \"2025-01-15T09:30:00\", \"attendees\": [\"alice@contoso.com\"], \"timeZone\": \"America/New_York\" }\n- Teams: { \"subject\": \"Sprint Review\", \"startDateTime\": \"2025-01-15T14:00:00\", \"endDateTime\": \"2025-01-15T15:00:00\", \"attendees\": [\"alice@contoso.com\", \"bob@contoso.com\"], \"isOnlineMeeting\": true }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            subject: {\n              type: 'string',\n              description: 'Meeting title as plain string. Example: \"Sprint Review\"',\n            },\n            startDateTime: {\n              type: 'string',\n              description: 'Start date/time as ISO 8601 string without timezone suffix. Example: \"2025-01-15T09:00:00\"',\n            },\n            endDateTime: {\n              type: 'string',\n              description: 'End date/time as ISO 8601 string without timezone suffix. Example: \"2025-01-15T09:30:00\"',\n            },\n            attendees: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'Attendee email addresses as plain strings. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]',\n            },\n            body: {\n              type: 'string',\n              description: 'Meeting description as HTML string. Example: \"<p>Agenda: discuss Q1 goals</p>\". Optional.',\n            },\n            isOnlineMeeting: {\n              type: 'boolean',\n              description: 'Set to true to generate a Teams online meeting link. Default: false.',\n            },\n            location: {\n              type: 'string',\n              description: 'Physical location as plain string. Example: \"Conference Room A\". Optional.',\n            },\n            timeZone: {\n              type: 'string',\n              description: 'IANA timezone string for start/end times. Example: \"America/New_York\", \"Europe/Zurich\". Default: \"UTC\".',\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email (UPN) for app-only auth. Example: \"alice@contoso.com\". Ignored in delegated auth.',\n            },\n          },\n          required: ['subject', 'startDateTime', 'endDateTime', 'attendees'],\n        },\n      },\n    },\n\n    describeCall: (args: CreateMeetingArgs): string => {\n      return `Create meeting: ${args.subject} (${args.attendees.length} attendees)`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Create a calendar event via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: CreateMeetingArgs,\n      context?: ToolContext\n    ): Promise<MicrosoftCreateMeetingResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      try {\n        const prefix = getUserPathPrefix(connector, args.targetUser);\n        const tz = args.timeZone ?? 'UTC';\n\n        const eventBody: Record<string, unknown> = {\n          subject: args.subject,\n          start: { dateTime: args.startDateTime, timeZone: tz },\n          end: { dateTime: args.endDateTime, timeZone: tz },\n          attendees: formatAttendees(args.attendees),\n        };\n\n        if (args.body) {\n          eventBody.body = { contentType: 'HTML', content: args.body };\n        }\n        if (args.isOnlineMeeting) {\n          eventBody.isOnlineMeeting = true;\n          eventBody.onlineMeetingProvider = 'teamsForBusiness';\n        }\n        if (args.location) {\n          eventBody.location = { displayName: args.location };\n        }\n\n        const event = await microsoftFetch<GraphEventResponse>(\n          connector,\n          `${prefix}/events`,\n          { method: 'POST', userId: effectiveUserId, accountId: effectiveAccountId, body: eventBody }\n        );\n\n        return {\n          success: true,\n          eventId: event.id,\n          webLink: event.webLink,\n          onlineMeetingUrl: event.onlineMeeting?.joinUrl,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to create meeting: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * Microsoft Graph - Edit Meeting Tool\n *\n * Update an existing calendar event.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type MicrosoftEditMeetingResult,\n  type GraphEventResponse,\n  getUserPathPrefix,\n  microsoftFetch,\n  formatAttendees,\n} from './types.js';\n\nexport interface EditMeetingArgs {\n  eventId: string;\n  subject?: string;\n  startDateTime?: string;\n  endDateTime?: string;\n  attendees?: string[];\n  body?: string;\n  isOnlineMeeting?: boolean;\n  location?: string;\n  timeZone?: string;\n  targetUser?: string;\n}\n\n/**\n * Create a Microsoft Graph edit_meeting tool\n */\nexport function createEditMeetingTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<EditMeetingArgs, MicrosoftEditMeetingResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'edit_meeting',\n        description: `Update an existing Outlook calendar event via Microsoft Graph. Only the fields you provide will be changed  omitted fields keep their current values.\n\nIMPORTANT: The \"attendees\" field REPLACES the entire attendee list. Include ALL desired attendees (both new and existing), not just the ones you want to add.\n\nPARAMETER FORMATS:\n- eventId: Graph event ID string (starts with \"AAMk...\"). Get this from a previous create_meeting result.\n- subject: plain string. Example: \"Updated: Sprint Review\"\n- startDateTime/endDateTime: ISO 8601 string without timezone suffix. Example: \"2025-01-15T10:00:00\"\n- attendees: plain string array of email addresses. Example: [\"alice@contoso.com\", \"charlie@contoso.com\"]. Do NOT use objects. REPLACES all attendees.\n- body: HTML string. Example: \"<p>Updated agenda</p>\"\n- timeZone: IANA timezone string. Example: \"Europe/Zurich\". Default: \"UTC\".\n- isOnlineMeeting: boolean. true = add Teams link, false = remove it.\n- location: plain string. Example: \"Room 201\"\n\nEXAMPLES:\n- Reschedule: { \"eventId\": \"AAMkADI1...\", \"startDateTime\": \"2025-01-15T10:00:00\", \"endDateTime\": \"2025-01-15T10:30:00\", \"timeZone\": \"America/New_York\" }\n- Change attendees: { \"eventId\": \"AAMkADI1...\", \"attendees\": [\"alice@contoso.com\", \"charlie@contoso.com\"] }\n- Add Teams link: { \"eventId\": \"AAMkADI1...\", \"isOnlineMeeting\": true }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            eventId: {\n              type: 'string',\n              description: 'Calendar event ID string from create_meeting result. Example: \"AAMkADI1M2I3YzgtODg...\"',\n            },\n            subject: {\n              type: 'string',\n              description: 'New meeting title as plain string. Example: \"Updated: Sprint Review\"',\n            },\n            startDateTime: {\n              type: 'string',\n              description: 'New start date/time as ISO 8601 string without timezone suffix. Example: \"2025-01-15T10:00:00\"',\n            },\n            endDateTime: {\n              type: 'string',\n              description: 'New end date/time as ISO 8601 string without timezone suffix. Example: \"2025-01-15T10:30:00\"',\n            },\n            attendees: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'FULL replacement attendee list as plain email strings. Example: [\"alice@contoso.com\", \"charlie@contoso.com\"]. Include ALL attendees.',\n            },\n            body: {\n              type: 'string',\n              description: 'New meeting description as HTML string. Example: \"<p>Updated agenda</p>\"',\n            },\n            isOnlineMeeting: {\n              type: 'boolean',\n              description: 'true to add Teams meeting link, false to remove it.',\n            },\n            location: {\n              type: 'string',\n              description: 'New location as plain string. Example: \"Conference Room A\"',\n            },\n            timeZone: {\n              type: 'string',\n              description: 'IANA timezone string for start/end times. Example: \"Europe/Zurich\". Default: \"UTC\".',\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email (UPN) for app-only auth. Example: \"alice@contoso.com\". Ignored in delegated auth.',\n            },\n          },\n          required: ['eventId'],\n        },\n      },\n    },\n\n    describeCall: (args: EditMeetingArgs): string => {\n      const fields = ['subject', 'startDateTime', 'endDateTime', 'attendees', 'body', 'location'] as const;\n      const changed = fields.filter((f) => args[f] !== undefined);\n      return `Edit meeting ${args.eventId.slice(0, 12)}... (${changed.join(', ') || 'no changes'})`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'medium',\n      approvalMessage: `Update a calendar event via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: EditMeetingArgs,\n      context?: ToolContext\n    ): Promise<MicrosoftEditMeetingResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      try {\n        const prefix = getUserPathPrefix(connector, args.targetUser);\n        const tz = args.timeZone ?? 'UTC';\n\n        // Build partial update body with only provided fields\n        const patchBody: Record<string, unknown> = {};\n\n        if (args.subject !== undefined) patchBody.subject = args.subject;\n        if (args.body !== undefined) patchBody.body = { contentType: 'HTML', content: args.body };\n        if (args.startDateTime !== undefined) patchBody.start = { dateTime: args.startDateTime, timeZone: tz };\n        if (args.endDateTime !== undefined) patchBody.end = { dateTime: args.endDateTime, timeZone: tz };\n        if (args.attendees !== undefined) {\n          patchBody.attendees = formatAttendees(args.attendees);\n        }\n        if (args.isOnlineMeeting !== undefined) {\n          patchBody.isOnlineMeeting = args.isOnlineMeeting;\n          if (args.isOnlineMeeting) {\n            patchBody.onlineMeetingProvider = 'teamsForBusiness';\n          }\n        }\n        if (args.location !== undefined) {\n          patchBody.location = { displayName: args.location };\n        }\n\n        const event = await microsoftFetch<GraphEventResponse>(\n          connector,\n          `${prefix}/events/${args.eventId}`,\n          { method: 'PATCH', userId: effectiveUserId, accountId: effectiveAccountId, body: patchBody }\n        );\n\n        return {\n          success: true,\n          eventId: event.id,\n          webLink: event.webLink,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to edit meeting: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * Microsoft Graph - Get Meeting Transcript Tool\n *\n * Retrieve the transcript from a Teams online meeting.\n * Requires OnlineMeetingTranscript.Read.All permission.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type MicrosoftGetTranscriptResult,\n  type GraphTranscriptListResponse,\n  getUserPathPrefix,\n  microsoftFetch,\n  resolveMeetingId,\n} from './types.js';\n\nexport interface GetMeetingTranscriptArgs {\n  meetingId: string;\n  targetUser?: string;\n}\n\n/**\n * Parse VTT content to extract plain text, stripping headers and timestamps.\n */\nfunction parseVttToText(vtt: string): string {\n  const lines = vtt.split('\\n');\n  const textLines: string[] = [];\n\n  for (const line of lines) {\n    const trimmed = line.trim();\n    // Skip WEBVTT header, empty lines, cue identifiers, and timestamp lines\n    if (\n      trimmed === '' ||\n      trimmed === 'WEBVTT' ||\n      trimmed.startsWith('NOTE') ||\n      /^\\d+$/.test(trimmed) ||\n      /^\\d{2}:\\d{2}/.test(trimmed)\n    ) {\n      continue;\n    }\n    textLines.push(trimmed);\n  }\n\n  return textLines.join('\\n');\n}\n\n/**\n * Create a Microsoft Graph get_meeting_transcript tool\n */\nexport function createGetMeetingTranscriptTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<GetMeetingTranscriptArgs, MicrosoftGetTranscriptResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'get_meeting_transcript',\n        description: `Retrieve the transcript from a Teams online meeting via Microsoft Graph. Returns plain text with speaker labels (VTT timestamps are stripped).\n\nNOTE: Requires the OnlineMeetingTranscript.Read.All permission. Transcription must have been enabled during the meeting.\n\nUSAGE:\n- Provide the Teams online meeting ID (NOT the calendar event ID  this is different) or a Teams meeting join URL\n- The meetingId can be found in the Teams meeting details or extracted from the join URL\n\nEXAMPLES:\n- By meeting ID: { \"meetingId\": \"MSo1N2Y5ZGFjYy03MWJmLTQ3NDMtYjQxMy01M2EdFGkdRWHJlQ\" }\n- By Teams join URL: { \"meetingId\": \"https://teams.microsoft.com/l/meetup-join/19%3ameeting_MjA5YjFi...\" }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            meetingId: {\n              type: 'string',\n              description: 'Teams online meeting ID (e.g. \"MSo1N2Y5...\") or Teams meeting join URL. This is NOT the calendar event ID.',\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email (UPN) to act on behalf of. Only needed for app-only (client_credentials) auth. Ignored in delegated auth.',\n            },\n          },\n          required: ['meetingId'],\n        },\n      },\n    },\n\n    describeCall: (args: GetMeetingTranscriptArgs): string => {\n      return `Get transcript for meeting ${args.meetingId.slice(0, 20)}...`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Get a meeting transcript via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: GetMeetingTranscriptArgs,\n      context?: ToolContext\n    ): Promise<MicrosoftGetTranscriptResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      try {\n        const prefix = getUserPathPrefix(connector, args.targetUser);\n\n        // Resolve meeting ID  handles both raw IDs and Teams join URLs\n        const resolved = await resolveMeetingId(connector, args.meetingId, prefix, effectiveUserId, effectiveAccountId);\n        const meetingId = resolved.meetingId;\n\n        // Step 1: List transcripts for the meeting\n        const transcriptList = await microsoftFetch<GraphTranscriptListResponse>(\n          connector,\n          `${prefix}/onlineMeetings/${meetingId}/transcripts`,\n          { userId: effectiveUserId, accountId: effectiveAccountId }\n        );\n\n        if (!transcriptList.value || transcriptList.value.length === 0) {\n          return {\n            success: false,\n            error: 'No transcripts found for this meeting. The meeting may not have had transcription enabled.',\n          };\n        }\n\n        const transcriptId = transcriptList.value[0]!.id;\n\n        // Step 2: Get transcript content as VTT\n        // The content endpoint returns text/vtt, not JSON  use connector.fetch() directly\n        const contentUrl = `${prefix}/onlineMeetings/${meetingId}/transcripts/${transcriptId}/content`;\n        const response = await connector.fetch(\n          contentUrl + '?$format=text/vtt',\n          { method: 'GET', headers: { 'Accept': 'text/vtt' } },\n          effectiveUserId,\n          effectiveAccountId\n        );\n\n        if (!response.ok) {\n          const errorText = await response.text();\n          return {\n            success: false,\n            error: `Failed to fetch transcript content: ${response.status} ${errorText}`,\n          };\n        }\n\n        const vttContent = await response.text();\n        const transcript = parseVttToText(vttContent);\n\n        return {\n          success: true,\n          transcript,\n          meetingSubject: resolved.subject,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to get meeting transcript: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * Microsoft Graph - Find Meeting Slots Tool\n *\n * Find available meeting time slots for a set of attendees.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  type MicrosoftFindSlotsResult,\n  type GraphFindMeetingTimesResponse,\n  getUserPathPrefix,\n  microsoftFetch,\n  formatAttendees,\n} from './types.js';\n\nexport interface FindMeetingSlotsArgs {\n  attendees: string[];\n  startDateTime: string;\n  endDateTime: string;\n  duration: number;\n  timeZone?: string;\n  maxResults?: number;\n  targetUser?: string;\n}\n\n/**\n * Create a Microsoft Graph find_meeting_slots tool\n */\nexport function createFindMeetingSlotsTool(\n  connector: Connector,\n  userId?: string\n): ToolFunction<FindMeetingSlotsArgs, MicrosoftFindSlotsResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'find_meeting_slots',\n        description: `Find available meeting time slots when all attendees are free, via Microsoft Graph. Checks each attendee's Outlook calendar and suggests times when everyone is available.\n\nPARAMETER FORMATS:\n- attendees: plain string array of email addresses. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]. Do NOT use objects  just plain email strings.\n- startDateTime/endDateTime: ISO 8601 string without timezone suffix. Example: \"2025-01-15T08:00:00\". Can span multiple days.\n- duration: number of minutes as integer. Example: 30 or 60.\n- timeZone: IANA timezone string. Example: \"America/New_York\", \"Europe/Zurich\". Default: \"UTC\".\n- maxResults: integer. Default: 5.\n\nEXAMPLES:\n- Find 30min slot: { \"attendees\": [\"alice@contoso.com\", \"bob@contoso.com\"], \"startDateTime\": \"2025-01-15T08:00:00\", \"endDateTime\": \"2025-01-15T18:00:00\", \"duration\": 30, \"timeZone\": \"America/New_York\" }\n- Find 1hr slot across days: { \"attendees\": [\"alice@contoso.com\"], \"startDateTime\": \"2025-01-15T08:00:00\", \"endDateTime\": \"2025-01-17T18:00:00\", \"duration\": 60, \"maxResults\": 10 }`,\n        parameters: {\n          type: 'object',\n          properties: {\n            attendees: {\n              type: 'array',\n              items: { type: 'string' },\n              description: 'Attendee email addresses as plain strings. Example: [\"alice@contoso.com\", \"bob@contoso.com\"]. Do NOT pass objects.',\n            },\n            startDateTime: {\n              type: 'string',\n              description: 'Search window start as ISO 8601 string without timezone suffix. Example: \"2025-01-15T08:00:00\"',\n            },\n            endDateTime: {\n              type: 'string',\n              description: 'Search window end as ISO 8601 string without timezone suffix. Example: \"2025-01-15T18:00:00\". Can span multiple days.',\n            },\n            duration: {\n              type: 'number',\n              description: 'Meeting duration in minutes as integer. Example: 30 or 60.',\n            },\n            timeZone: {\n              type: 'string',\n              description: 'IANA timezone string for start/end times. Example: \"America/New_York\", \"Europe/Zurich\". Default: \"UTC\".',\n            },\n            maxResults: {\n              type: 'number',\n              description: 'Maximum number of time slot suggestions as integer. Default: 5.',\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email (UPN) for app-only auth. Example: \"alice@contoso.com\". Ignored in delegated auth.',\n            },\n          },\n          required: ['attendees', 'startDateTime', 'endDateTime', 'duration'],\n        },\n      },\n    },\n\n    describeCall: (args: FindMeetingSlotsArgs): string => {\n      return `Find ${args.duration}min slots for ${args.attendees.length} attendees`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Find meeting time slots via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: FindMeetingSlotsArgs,\n      context?: ToolContext\n    ): Promise<MicrosoftFindSlotsResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      try {\n        const prefix = getUserPathPrefix(connector, args.targetUser);\n        const tz = args.timeZone ?? 'UTC';\n\n        const result = await microsoftFetch<GraphFindMeetingTimesResponse>(\n          connector,\n          `${prefix}/findMeetingTimes`,\n          {\n            method: 'POST',\n            userId: effectiveUserId,\n            accountId: effectiveAccountId,\n            body: {\n              attendees: formatAttendees(args.attendees),\n              timeConstraint: {\n                timeslots: [\n                  {\n                    start: { dateTime: args.startDateTime, timeZone: tz },\n                    end: { dateTime: args.endDateTime, timeZone: tz },\n                  },\n                ],\n              },\n              meetingDuration: `PT${args.duration}M`,\n              maxCandidates: args.maxResults ?? 5,\n            },\n          }\n        );\n\n        const slots = (result.meetingTimeSuggestions ?? []).map((s) => ({\n          start: s.meetingTimeSlot.start.dateTime,\n          end: s.meetingTimeSlot.end.dateTime,\n          confidence: String(s.confidence),\n          attendeeAvailability: (s.attendeeAvailability ?? []).map((a) => ({\n            attendee: a.attendee.emailAddress.address,\n            availability: a.availability,\n          })),\n        }));\n\n        return {\n          success: true,\n          slots,\n          emptySuggestionsReason: result.emptySuggestionsReason,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to find meeting slots: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n","/**\n * Microsoft Graph - Read File Tool\n *\n * Downloads a file from OneDrive or SharePoint and converts it to markdown\n * using DocumentReader. Never returns raw binary content.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport { DocumentReader, mergeTextPieces } from '../../capabilities/documents/DocumentReader.js';\nimport { FormatDetector } from '../../capabilities/documents/FormatDetector.js';\nimport {\n  getUserPathPrefix,\n  microsoftFetch,\n  getDrivePrefix,\n  resolveFileEndpoints,\n  formatFileSize,\n  getFileSizeLimit,\n  isWebUrl,\n  isMicrosoftFileUrl,\n  DEFAULT_MAX_FILE_SIZE_BYTES,\n  SUPPORTED_EXTENSIONS,\n  MicrosoftAPIError,\n  type GraphDriveItem,\n  type MicrosoftReadFileResult,\n} from './types.js';\n\n// ---- Args ----\n\ninterface ReadFileArgs {\n  source: string;\n  driveId?: string;\n  siteId?: string;\n  targetUser?: string;\n}\n\n// ---- Config ----\n\nexport interface MicrosoftReadFileConfig {\n  /** Default max file size in bytes (default: 50 MB). Applied when no per-extension limit matches. */\n  maxFileSizeBytes?: number;\n  /** Per-extension size limits in bytes, e.g. `{ '.pptx': 200 * 1024 * 1024 }`. Merged with built-in defaults. */\n  fileSizeLimits?: Record<string, number>;\n}\n\n// ---- Tool Factory ----\n\nexport function createMicrosoftReadFileTool(\n  connector: Connector,\n  userId?: string,\n  config?: MicrosoftReadFileConfig,\n): ToolFunction<ReadFileArgs, MicrosoftReadFileResult> {\n  // Reuse a single DocumentReader instance across invocations (stateless, no resources to leak)\n  const reader = DocumentReader.create();\n  const defaultLimit = config?.maxFileSizeBytes ?? DEFAULT_MAX_FILE_SIZE_BYTES;\n  const sizeOverrides = config?.fileSizeLimits;\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'read_file',\n        description: `Read a file from Microsoft OneDrive or SharePoint and return its content as **markdown text**.\n\nUse this tool when you need to read the contents of a document stored in OneDrive or SharePoint. The file is downloaded and automatically converted to clean markdown  you will never receive raw binary data.\n\n**Supported formats:** .docx, .pptx, .xlsx, .csv, .pdf, .odt, .odp, .ods, .rtf, .html, .txt, .md, .json, .xml, .yaml\n**Not supported:** .doc, .xls, .ppt (legacy Office formats), images, videos, executables.\n\n**The \\`source\\` parameter is flexible  you can provide any of these:**\n- A SharePoint or OneDrive **web URL**: \\`https://contoso.sharepoint.com/sites/team/Shared Documents/report.docx\\`\n- A OneDrive **sharing link**: \\`https://1drv.ms/w/s!AmVg...\\`\n- A **file path** within the drive: \\`/Documents/Q4 Report.docx\\`\n- A Graph API **item ID**: \\`01ABCDEF123456\\`\n\nWhen given a web URL, the tool automatically resolves it to the correct Graph API call  no need to manually extract drive or item IDs.\n\n**Maximum file size:** 50 MB (100 MB for presentations). For larger files, use the search or list tools to find smaller alternatives.\n\n**Returns:** The file content as markdown text, along with metadata (filename, size, MIME type, webUrl). For spreadsheets, each sheet becomes a markdown table. For presentations, each slide becomes a section.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            source: {\n              type: 'string',\n              description:\n                'The file to read. Accepts a web URL (SharePoint/OneDrive link), a file path within the drive (e.g., \"/Documents/report.docx\"), or a Graph API item ID.',\n            },\n            driveId: {\n              type: 'string',\n              description:\n                'Optional drive ID. Omit to use the default drive. Only needed when accessing a specific non-default drive.',\n            },\n            siteId: {\n              type: 'string',\n              description:\n                'Optional SharePoint site ID. Use this instead of driveId to access files in a specific SharePoint site\\'s default drive.',\n            },\n            targetUser: {\n              type: 'string',\n              description:\n                'User ID or email (e.g., \"user@contoso.com\"). Only needed with application-only (client_credentials) auth to specify which user\\'s drive to access.',\n            },\n          },\n          required: ['source'],\n        },\n      },\n      blocking: true,\n      timeout: 60000,\n    },\n\n    describeCall: (args: ReadFileArgs): string => {\n      const src = args.source.length > 80 ? args.source.slice(0, 77) + '...' : args.source;\n      return `Read: ${src}`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Read a file from OneDrive/SharePoint via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: ReadFileArgs,\n      context?: ToolContext,\n    ): Promise<MicrosoftReadFileResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n\n      // Validate source is non-empty\n      if (!args.source || !args.source.trim()) {\n        return {\n          success: false,\n          error: 'The \"source\" parameter is required. Provide a file URL, path, or item ID.',\n        };\n      }\n\n      // Validate URLs are Microsoft-owned (SharePoint/OneDrive)\n      if (isWebUrl(args.source) && !isMicrosoftFileUrl(args.source)) {\n        return {\n          success: false,\n          error:\n            `The URL \"${args.source}\" does not appear to be a SharePoint or OneDrive link. ` +\n            `This tool only supports URLs from *.sharepoint.com, onedrive.live.com, or 1drv.ms. ` +\n            `For other URLs, use the web_fetch tool instead.`,\n        };\n      }\n\n      try {\n        // 1. Resolve endpoints\n        const userPrefix = getUserPathPrefix(connector, args.targetUser);\n        const drivePrefix = getDrivePrefix(userPrefix, {\n          siteId: args.siteId,\n          driveId: args.driveId,\n        });\n        const { metadataEndpoint, contentEndpoint, isSharedUrl } = resolveFileEndpoints(\n          args.source,\n          drivePrefix,\n        );\n\n        // 2. Get file metadata\n        // Note: /shares/ endpoint may not support $select for some sharing link types\n        const metadataQueryParams: Record<string, string> = isSharedUrl\n          ? {}\n          : { '$select': 'id,name,size,file,folder,webUrl,parentReference' };\n        const metadata = await microsoftFetch<GraphDriveItem>(connector, metadataEndpoint, {\n          userId: effectiveUserId,\n          accountId: effectiveAccountId,\n          queryParams: metadataQueryParams,\n        });\n\n        // Validate it's a file, not a folder\n        if (metadata.folder) {\n          return {\n            success: false,\n            error:\n              `\"${metadata.name}\" is a folder, not a file. ` +\n              `Use the list_files tool to browse folder contents.`,\n          };\n        }\n\n        // Check file size (per-extension limits, then default)\n        const ext = getExtension(metadata.name);\n        const sizeLimit = getFileSizeLimit(ext, sizeOverrides, defaultLimit);\n        if (metadata.size > sizeLimit) {\n          return {\n            success: false,\n            filename: metadata.name,\n            sizeBytes: metadata.size,\n            error:\n              `File \"${metadata.name}\" is ${formatFileSize(metadata.size)}, which exceeds ` +\n              `the ${formatFileSize(sizeLimit)} limit for ${ext || 'this file type'}. ` +\n              `Consider downloading a smaller version or using the search tool to find an alternative.`,\n          };\n        }\n\n        // Check extension support\n        if (ext && !SUPPORTED_EXTENSIONS.has(ext) && !FormatDetector.isBinaryDocumentFormat(ext)) {\n          return {\n            success: false,\n            filename: metadata.name,\n            mimeType: metadata.file?.mimeType,\n            error:\n              `File format \"${ext}\" is not supported for text extraction. ` +\n              `Supported formats: ${[...SUPPORTED_EXTENSIONS].join(', ')}`,\n          };\n        }\n\n        // 3. Download binary content\n        const response = await connector.fetch(\n          contentEndpoint,\n          { method: 'GET' },\n          effectiveUserId,\n          effectiveAccountId,\n        );\n\n        if (!response.ok) {\n          throw new MicrosoftAPIError(response.status, response.statusText, await response.text());\n        }\n\n        const arrayBuffer = await response.arrayBuffer();\n        // Buffer.from(ArrayBuffer) creates a zero-copy view (no data duplication).\n        // PDFHandler will copy to a standalone Uint8Array only when needed for pdf.js workers.\n        const buffer = Buffer.from(arrayBuffer);\n\n        // 4. Convert to markdown via DocumentReader\n        const result = await reader.read(\n          { type: 'buffer', buffer, filename: metadata.name },\n          { extractImages: false },\n        );\n\n        if (!result.success) {\n          return {\n            success: false,\n            filename: metadata.name,\n            error: `Failed to convert \"${metadata.name}\" to markdown: ${result.error ?? 'unknown error'}`,\n          };\n        }\n\n        const markdown = mergeTextPieces(result.pieces);\n\n        if (!markdown || markdown.trim().length === 0) {\n          return {\n            success: true,\n            filename: metadata.name,\n            sizeBytes: metadata.size,\n            mimeType: metadata.file?.mimeType,\n            webUrl: metadata.webUrl,\n            markdown: '*(empty document  no text content found)*',\n          };\n        }\n\n        return {\n          success: true,\n          filename: metadata.name,\n          sizeBytes: metadata.size,\n          mimeType: metadata.file?.mimeType,\n          webUrl: metadata.webUrl,\n          markdown,\n        };\n      } catch (error) {\n        if (error instanceof MicrosoftAPIError) {\n          if (error.status === 404) {\n            return {\n              success: false,\n              error: `File not found. Check that the source \"${args.source}\" is correct and you have access.`,\n            };\n          }\n          if (error.status === 403 || error.status === 401) {\n            return {\n              success: false,\n              error: `Access denied. The connector may not have sufficient permissions (Files.Read or Sites.Read.All required).`,\n            };\n          }\n        }\n        return {\n          success: false,\n          error: `Failed to read file: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n\n// ---- Helpers ----\n\nfunction getExtension(filename: string): string {\n  const dot = filename.lastIndexOf('.');\n  if (dot < 0) return '';\n  return filename.slice(dot).toLowerCase();\n}\n","/**\n * Microsoft Graph - List Files Tool\n *\n * Lists files and folders in a OneDrive or SharePoint directory.\n * Returns metadata only  never file contents.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  getUserPathPrefix,\n  microsoftFetch,\n  getDrivePrefix,\n  encodeSharingUrl,\n  isWebUrl,\n  formatFileSize,\n  type GraphDriveItem,\n  type GraphDriveItemListResponse,\n  type MicrosoftListFilesResult,\n} from './types.js';\n\n// ---- Args ----\n\ninterface ListFilesArgs {\n  path?: string;\n  driveId?: string;\n  siteId?: string;\n  search?: string;\n  limit?: number;\n  targetUser?: string;\n}\n\n// ---- Constants ----\n\nconst DEFAULT_LIMIT = 50;\nconst MAX_LIMIT = 200;\nconst SELECT_FIELDS = 'id,name,size,lastModifiedDateTime,file,folder,webUrl';\n\n// ---- Tool Factory ----\n\nexport function createMicrosoftListFilesTool(\n  connector: Connector,\n  userId?: string,\n): ToolFunction<ListFilesArgs, MicrosoftListFilesResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'list_files',\n        description: `List files and folders in a Microsoft OneDrive or SharePoint directory.\n\nUse this tool to browse the contents of a folder, discover available files before reading them, or search within a specific folder. Returns file/folder metadata (name, size, type, last modified, URL)  **never returns file contents**.\n\n**The \\`path\\` parameter is flexible  you can provide:**\n- A **folder path** within the drive: \\`/Documents/Projects\\` or \\`/\\` for root\n- A SharePoint/OneDrive **folder URL**: \\`https://contoso.sharepoint.com/sites/team/Shared Documents/Projects\\`\n- Omit entirely to list the root of the drive\n\n**Optional search:** Use the \\`search\\` parameter to filter by filename within the folder tree. This uses Microsoft's server-side search (fast, works across subfolders).\n\n**Tip:** To read a file's content after finding it, use the read_file tool with the file's webUrl or id from these results.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            path: {\n              type: 'string',\n              description:\n                'Folder path (e.g., \"/Documents/Projects\") or a web URL to a SharePoint/OneDrive folder. Omit to list root.',\n            },\n            driveId: {\n              type: 'string',\n              description: 'Optional drive ID for a specific non-default drive.',\n            },\n            siteId: {\n              type: 'string',\n              description: 'Optional SharePoint site ID to access that site\\'s default document library.',\n            },\n            search: {\n              type: 'string',\n              description:\n                'Optional search query to filter results by filename or content. Searches within the specified folder and all subfolders.',\n            },\n            limit: {\n              type: 'number',\n              description: `Maximum number of items to return (default: ${DEFAULT_LIMIT}, max: ${MAX_LIMIT}).`,\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email. Only needed with application-only (client_credentials) auth.',\n            },\n          },\n        },\n      },\n      blocking: true,\n      timeout: 30000,\n    },\n\n    describeCall: (args: ListFilesArgs): string => {\n      const loc = args.path || '/';\n      const suffix = args.search ? ` (search: \"${args.search}\")` : '';\n      return `List: ${loc}${suffix}`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `List files in OneDrive/SharePoint via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: ListFilesArgs,\n      context?: ToolContext,\n    ): Promise<MicrosoftListFilesResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const limit = Math.min(Math.max(1, args.limit ?? DEFAULT_LIMIT), MAX_LIMIT);\n\n      try {\n        const userPrefix = getUserPathPrefix(connector, args.targetUser);\n        const drivePrefix = getDrivePrefix(userPrefix, {\n          siteId: args.siteId,\n          driveId: args.driveId,\n        });\n\n        let endpoint: string;\n\n        if (args.search) {\n          // Search within drive (or folder)\n          const folderBase = args.path && !isWebUrl(args.path)\n            ? `${drivePrefix}/root:${normalizePath(args.path)}:`\n            : drivePrefix;\n          endpoint = `${folderBase}/search(q='${encodeSearchQuery(args.search)}')`;\n        } else if (args.path) {\n          // List specific folder\n          if (isWebUrl(args.path)) {\n            // Web URL  sharing link  children\n            const token = encodeSharingUrl(args.path.trim());\n            endpoint = `/shares/${token}/driveItem/children`;\n          } else {\n            const path = normalizePath(args.path);\n            endpoint = path === '/'\n              ? `${drivePrefix}/root/children`\n              : `${drivePrefix}/root:${path}:/children`;\n          }\n        } else {\n          // List root\n          endpoint = `${drivePrefix}/root/children`;\n        }\n\n        // $orderby is not supported on the search() endpoint  only include for list operations\n        const queryParams: Record<string, string | number | boolean> = {\n          '$top': limit,\n          '$select': SELECT_FIELDS,\n        };\n        if (!args.search) {\n          queryParams['$orderby'] = 'name asc';\n        }\n\n        const data = await microsoftFetch<GraphDriveItemListResponse>(connector, endpoint, {\n          userId: effectiveUserId,\n          accountId: effectiveAccountId,\n          queryParams,\n        });\n\n        const items = (data.value || []).map(mapDriveItem);\n\n        return {\n          success: true,\n          items,\n          totalCount: items.length,\n          hasMore: !!data['@odata.nextLink'],\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Failed to list files: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n\n// ---- Helpers ----\n\nfunction mapDriveItem(item: GraphDriveItem) {\n  return {\n    name: item.name,\n    type: (item.folder ? 'folder' : 'file') as 'file' | 'folder',\n    size: item.size,\n    sizeFormatted: formatFileSize(item.size),\n    mimeType: item.file?.mimeType,\n    lastModified: item.lastModifiedDateTime,\n    webUrl: item.webUrl,\n    id: item.id,\n    childCount: item.folder?.childCount,\n  };\n}\n\nfunction normalizePath(path: string): string {\n  let p = path.trim();\n  if (!p.startsWith('/')) p = '/' + p;\n  if (p.endsWith('/') && p.length > 1) p = p.slice(0, -1);\n  return p;\n}\n\nfunction encodeSearchQuery(query: string): string {\n  // Escape special characters for OData search(q='...') syntax\n  return query\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/'/g, \"''\");\n}\n","/**\n * Microsoft Graph - Search Files Tool\n *\n * Searches across OneDrive and SharePoint for files matching a query.\n * Uses the Microsoft Search API with KQL support.\n * Returns metadata and snippets only  never file contents.\n */\n\nimport type { Connector } from '../../core/Connector.js';\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport {\n  microsoftFetch,\n  formatFileSize,\n  type GraphDriveItemListResponse,\n  type GraphSearchResponse,\n  type MicrosoftSearchFilesResult,\n} from './types.js';\n\n// ---- Args ----\n\ninterface SearchFilesArgs {\n  query: string;\n  siteId?: string;\n  fileTypes?: string[];\n  limit?: number;\n  targetUser?: string;\n}\n\n// ---- Constants ----\n\nconst DEFAULT_LIMIT = 25;\nconst MAX_LIMIT = 100;\n\n// ---- Tool Factory ----\n\nexport function createMicrosoftSearchFilesTool(\n  connector: Connector,\n  userId?: string,\n): ToolFunction<SearchFilesArgs, MicrosoftSearchFilesResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'search_files',\n        description: `Search for files across Microsoft OneDrive and SharePoint.\n\nUse this tool when you need to **find** files by name, content, or metadata across all of the user's OneDrive and SharePoint sites. This is a powerful full-text search  it searches inside document content, not just filenames.\n\n**Supports Microsoft's KQL (Keyword Query Language):**\n- Simple text: \\`\"quarterly report\"\\`\n- By filename: \\`filename:budget.xlsx\\`\n- By author: \\`author:\"Jane Smith\"\\`\n- By date: \\`lastModifiedTime>2024-01-01\\`\n- Combined: \\`project proposal filetype:docx\\`\n\n**Filter by file type:** Use the \\`fileTypes\\` parameter (e.g., \\`[\"docx\", \"pdf\"]\\`) to restrict results to specific formats.\n\n**Limit to a SharePoint site:** Provide the \\`siteId\\` parameter to search only within a specific site.\n\n**Returns:** A list of matching files with name, path, site, snippet (text preview), size, and webUrl. Does NOT return file contents  use the read_file tool to read a specific result.\n\n**Tip:** Start with a broad search, then use read_file on the most relevant results.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            query: {\n              type: 'string',\n              description:\n                'Search query. Supports plain text and KQL syntax (e.g., \"budget report\", \"filename:spec.docx\", \"author:john filetype:pptx\").',\n            },\n            siteId: {\n              type: 'string',\n              description: 'Optional SharePoint site ID to limit search to a specific site.',\n            },\n            fileTypes: {\n              type: 'array',\n              items: { type: 'string' },\n              description:\n                'Optional file type filter. Array of extensions without dots (e.g., [\"docx\", \"pdf\", \"xlsx\"]).',\n            },\n            limit: {\n              type: 'number',\n              description: `Maximum number of results (default: ${DEFAULT_LIMIT}, max: ${MAX_LIMIT}).`,\n            },\n            targetUser: {\n              type: 'string',\n              description: 'User ID or email. Only needed with application-only (client_credentials) auth.',\n            },\n          },\n          required: ['query'],\n        },\n      },\n      blocking: true,\n      timeout: 30000,\n    },\n\n    describeCall: (args: SearchFilesArgs): string => {\n      const types = args.fileTypes?.length ? ` [${args.fileTypes.join(',')}]` : '';\n      return `Search: \"${args.query}\"${types}`;\n    },\n\n    permission: {\n      scope: 'session',\n      riskLevel: 'low',\n      approvalMessage: `Search files in OneDrive/SharePoint via ${connector.displayName}`,\n    },\n\n    execute: async (\n      args: SearchFilesArgs,\n      context?: ToolContext,\n    ): Promise<MicrosoftSearchFilesResult> => {\n      const effectiveUserId = context?.userId ?? userId;\n      const effectiveAccountId = context?.accountId;\n      const limit = Math.min(Math.max(1, args.limit ?? DEFAULT_LIMIT), MAX_LIMIT);\n\n      try {\n        // When siteId is provided, use drive-scoped search (simpler and correctly scoped).\n        // The global Search API's siteId filtering requires contentSources which is fragile.\n        if (args.siteId) {\n          return await searchViaDriveEndpoint(\n            connector, args, limit, effectiveUserId, effectiveAccountId,\n          );\n        }\n\n        // Global search via Microsoft Search API (cross-site, full-text, KQL)\n        let queryString = args.query;\n        if (args.fileTypes?.length) {\n          const typeFilter = args.fileTypes.map((t) => `filetype:${t.replace(/^\\./, '')}`).join(' OR ');\n          queryString = `(${queryString}) (${typeFilter})`;\n        }\n\n        const searchRequest: Record<string, unknown> = {\n          requests: [\n            {\n              entityTypes: ['driveItem'],\n              query: { queryString },\n              from: 0,\n              size: limit,\n              fields: [\n                'id', 'name', 'size', 'webUrl', 'lastModifiedDateTime',\n                'parentReference', 'file',\n              ],\n            },\n          ],\n        };\n\n        const data = await microsoftFetch<GraphSearchResponse>(connector, '/search/query', {\n          method: 'POST',\n          body: searchRequest,\n          userId: effectiveUserId,\n          accountId: effectiveAccountId,\n        });\n\n        // Parse results\n        const container = data.value?.[0]?.hitsContainers?.[0];\n        if (!container?.hits?.length) {\n          return {\n            success: true,\n            results: [],\n            totalCount: 0,\n            hasMore: false,\n          };\n        }\n\n        const results = container.hits.map((hit) => {\n          const resource = hit.resource;\n          return {\n            name: resource.name,\n            path: resource.parentReference?.path?.replace(/\\/drive\\/root:/, '') || undefined,\n            site: resource.parentReference?.siteId || undefined,\n            snippet: hit.summary || undefined,\n            size: resource.size,\n            sizeFormatted: formatFileSize(resource.size),\n            webUrl: resource.webUrl,\n            id: resource.id,\n            lastModified: resource.lastModifiedDateTime,\n          };\n        });\n\n        return {\n          success: true,\n          results,\n          totalCount: container.total,\n          hasMore: container.moreResultsAvailable,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: `Search failed: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    },\n  };\n}\n\n// ---- Helpers ----\n\n/**\n * Site-scoped search using the drive search endpoint.\n * More reliable than the global Search API for filtering by siteId.\n */\nasync function searchViaDriveEndpoint(\n  connector: Connector,\n  args: SearchFilesArgs,\n  limit: number,\n  effectiveUserId?: string,\n  effectiveAccountId?: string,\n): Promise<MicrosoftSearchFilesResult> {\n  const drivePrefix = `/sites/${args.siteId}/drive`;\n\n  // Escape single quotes for OData search syntax\n  const escapedQuery = args.query.replace(/'/g, \"''\");\n  const endpoint = `${drivePrefix}/root/search(q='${escapedQuery}')`;\n\n  const data = await microsoftFetch<GraphDriveItemListResponse>(connector, endpoint, {\n    userId: effectiveUserId,\n    accountId: effectiveAccountId,\n    queryParams: {\n      '$top': limit,\n      '$select': 'id,name,size,webUrl,lastModifiedDateTime,parentReference,file',\n    },\n  });\n\n  let items = data.value || [];\n\n  // Client-side file type filter (the drive search endpoint doesn't support filetype: in query)\n  if (args.fileTypes?.length) {\n    const extSet = new Set(args.fileTypes.map((t) => t.replace(/^\\./, '').toLowerCase()));\n    items = items.filter((item) => {\n      const ext = item.name.split('.').pop()?.toLowerCase();\n      return ext && extSet.has(ext);\n    });\n  }\n\n  const results = items.map((item) => ({\n    name: item.name,\n    path: item.parentReference?.path?.replace(/\\/drive\\/root:/, '') || undefined,\n    site: item.parentReference?.siteId || undefined,\n    snippet: undefined,\n    size: item.size,\n    sizeFormatted: formatFileSize(item.size),\n    webUrl: item.webUrl,\n    id: item.id,\n    lastModified: item.lastModifiedDateTime,\n  }));\n\n  return {\n    success: true,\n    results,\n    totalCount: results.length,\n    hasMore: !!data['@odata.nextLink'],\n  };\n}\n","/**\n * Microsoft Graph Connector Tools\n *\n * Auto-registers Microsoft tool factories with ConnectorTools.\n * When imported, this module registers factories so that `ConnectorTools.for('microsoft')`\n * automatically includes Microsoft-specific tools alongside the generic API tool.\n *\n * Tools provided:\n * - create_draft_email  Create a draft email or reply draft\n * - send_email  Send an email or reply\n * - create_meeting  Create a calendar event with optional Teams link\n * - edit_meeting  Update an existing calendar event\n * - get_meeting_transcript  Retrieve Teams meeting transcript\n * - find_meeting_slots  Find available meeting time slots\n * - read_file  Read a file from OneDrive/SharePoint as markdown\n * - list_files  List files/folders in a OneDrive/SharePoint directory\n * - search_files  Search across OneDrive/SharePoint for files\n */\n\n// Side-effect: register Microsoft tool factories with ConnectorTools\nimport { registerMicrosoftTools } from './register.js';\nregisterMicrosoftTools();\n\n// Types\nexport type {\n  MicrosoftDraftEmailResult,\n  MicrosoftSendEmailResult,\n  MicrosoftCreateMeetingResult,\n  MicrosoftEditMeetingResult,\n  MicrosoftGetTranscriptResult,\n  MicrosoftFindSlotsResult,\n  MeetingSlotSuggestion,\n  MicrosoftAPIError,\n  MicrosoftReadFileResult,\n  MicrosoftListFilesResult,\n  MicrosoftSearchFilesResult,\n  GraphDriveItem,\n} from './types.js';\n\n// Utility functions\nexport {\n  getUserPathPrefix,\n  microsoftFetch,\n  formatRecipients,\n  formatAttendees,\n  normalizeEmails,\n  isTeamsMeetingUrl,\n  resolveMeetingId,\n  encodeSharingUrl,\n  isWebUrl,\n  isMicrosoftFileUrl,\n  getDrivePrefix,\n  resolveFileEndpoints,\n  formatFileSize,\n} from './types.js';\n\n// Tool factories (for direct use with custom options)\nexport { createDraftEmailTool } from './createDraftEmail.js';\nexport { createSendEmailTool } from './sendEmail.js';\nexport { createMeetingTool } from './createMeeting.js';\nexport { createEditMeetingTool } from './editMeeting.js';\nexport { createGetMeetingTranscriptTool } from './getMeetingTranscript.js';\nexport { createFindMeetingSlotsTool } from './findMeetingSlots.js';\nexport { createMicrosoftReadFileTool, type MicrosoftReadFileConfig } from './readFile.js';\nexport { createMicrosoftListFilesTool } from './listFiles.js';\nexport { createMicrosoftSearchFilesTool } from './searchFiles.js';\n","/**\n * Desktop Automation Tools - Types\n *\n * Interfaces and types for OS-level desktop automation (screenshot, mouse, keyboard, windows).\n * All coordinates are in PHYSICAL pixel space (screenshot space).\n * The driver converts to logical OS coords internally using scaleFactor.\n */\n\n// ============================================================================\n// Core Types\n// ============================================================================\n\nexport type MouseButton = 'left' | 'right' | 'middle';\n\nexport interface DesktopPoint {\n  x: number;\n  y: number;\n}\n\nexport interface DesktopScreenSize {\n  /** Physical pixel width (screenshot space) */\n  physicalWidth: number;\n  /** Physical pixel height (screenshot space) */\n  physicalHeight: number;\n  /** Logical OS width */\n  logicalWidth: number;\n  /** Logical OS height */\n  logicalHeight: number;\n  /** Scale factor (physical / logical), e.g. 2.0 on Retina */\n  scaleFactor: number;\n}\n\nexport interface DesktopScreenshot {\n  /** Base64-encoded PNG image data */\n  base64: string;\n  /** Width in physical pixels */\n  width: number;\n  /** Height in physical pixels */\n  height: number;\n}\n\nexport interface DesktopWindow {\n  /** Window identifier (platform-specific) */\n  id: number;\n  /** Window title */\n  title: string;\n  /** Application name */\n  appName?: string;\n  /** Window bounds in physical pixel coords */\n  bounds?: { x: number; y: number; width: number; height: number };\n}\n\n// ============================================================================\n// Driver Interface\n// ============================================================================\n\nexport interface IDesktopDriver {\n  /** Initialize the driver (dynamic import, permission checks, scale detection) */\n  initialize(): Promise<void>;\n\n  /** Whether the driver is initialized */\n  readonly isInitialized: boolean;\n\n  /** Current scale factor (physical / logical) */\n  readonly scaleFactor: number;\n\n  // Screen\n  screenshot(region?: { x: number; y: number; width: number; height: number }): Promise<DesktopScreenshot>;\n  getScreenSize(): Promise<DesktopScreenSize>;\n\n  // Mouse (all coords in physical pixels)\n  mouseMove(x: number, y: number): Promise<void>;\n  mouseClick(x: number, y: number, button: MouseButton, clickCount: number): Promise<void>;\n  mouseDrag(startX: number, startY: number, endX: number, endY: number, button: MouseButton): Promise<void>;\n  mouseScroll(deltaX: number, deltaY: number, x?: number, y?: number): Promise<void>;\n  getCursorPosition(): Promise<DesktopPoint>;\n\n  // Keyboard\n  keyboardType(text: string, delay?: number): Promise<void>;\n  keyboardKey(keys: string): Promise<void>;\n\n  // Windows\n  getWindowList(): Promise<DesktopWindow[]>;\n  focusWindow(windowId: number): Promise<void>;\n}\n\n// ============================================================================\n// Tool Configuration\n// ============================================================================\n\nexport interface DesktopToolConfig {\n  /** Custom driver implementation (defaults to NutTreeDriver) */\n  driver?: IDesktopDriver;\n\n  /**\n   * Human-like delay range in ms added between actions.\n   * Set to [0, 0] for instant actions.\n   * Default: [50, 150]\n   */\n  humanDelay?: [number, number];\n\n  /**\n   * Whether to humanize mouse movements (curved path vs instant teleport).\n   * Default: false\n   */\n  humanizeMovement?: boolean;\n}\n\nexport const DEFAULT_DESKTOP_CONFIG: Required<DesktopToolConfig> = {\n  driver: null as unknown as IDesktopDriver, // Lazy-initialized\n  humanDelay: [50, 150],\n  humanizeMovement: false,\n};\n\n/**\n * Apply a random human-like delay based on config.\n */\nexport async function applyHumanDelay(config: DesktopToolConfig): Promise<void> {\n  const [min, max] = config.humanDelay ?? DEFAULT_DESKTOP_CONFIG.humanDelay;\n  if (min === 0 && max === 0) return;\n  const delay = min + Math.random() * (max - min);\n  await new Promise((resolve) => setTimeout(resolve, delay));\n}\n\n// ============================================================================\n// Tool Arg/Result Interfaces\n// ============================================================================\n\n// --- Screenshot ---\nexport interface DesktopScreenshotArgs {\n  region?: { x: number; y: number; width: number; height: number };\n}\n\nexport interface DesktopScreenshotResult {\n  success: boolean;\n  width?: number;\n  height?: number;\n  /** Base64 PNG for text summary */\n  base64?: string;\n  /** Image array for multimodal provider handling */\n  __images?: Array<{ base64: string; mediaType: string }>;\n  error?: string;\n}\n\n// --- Mouse Move ---\nexport interface DesktopMouseMoveArgs {\n  x: number;\n  y: number;\n}\n\nexport interface DesktopMouseMoveResult {\n  success: boolean;\n  x?: number;\n  y?: number;\n  error?: string;\n}\n\n// --- Mouse Click ---\nexport interface DesktopMouseClickArgs {\n  x?: number;\n  y?: number;\n  button?: MouseButton;\n  clickCount?: number;\n}\n\nexport interface DesktopMouseClickResult {\n  success: boolean;\n  x?: number;\n  y?: number;\n  button?: MouseButton;\n  clickCount?: number;\n  error?: string;\n}\n\n// --- Mouse Drag ---\nexport interface DesktopMouseDragArgs {\n  startX: number;\n  startY: number;\n  endX: number;\n  endY: number;\n  button?: MouseButton;\n}\n\nexport interface DesktopMouseDragResult {\n  success: boolean;\n  error?: string;\n}\n\n// --- Mouse Scroll ---\nexport interface DesktopMouseScrollArgs {\n  deltaX?: number;\n  deltaY?: number;\n  x?: number;\n  y?: number;\n}\n\nexport interface DesktopMouseScrollResult {\n  success: boolean;\n  error?: string;\n}\n\n// --- Get Cursor ---\nexport interface DesktopGetCursorResult {\n  success: boolean;\n  x?: number;\n  y?: number;\n  error?: string;\n}\n\n// --- Keyboard Type ---\nexport interface DesktopKeyboardTypeArgs {\n  text: string;\n  delay?: number;\n}\n\nexport interface DesktopKeyboardTypeResult {\n  success: boolean;\n  error?: string;\n}\n\n// --- Keyboard Key ---\nexport interface DesktopKeyboardKeyArgs {\n  keys: string;\n}\n\nexport interface DesktopKeyboardKeyResult {\n  success: boolean;\n  error?: string;\n}\n\n// --- Get Screen Size ---\nexport interface DesktopGetScreenSizeResult {\n  success: boolean;\n  physicalWidth?: number;\n  physicalHeight?: number;\n  logicalWidth?: number;\n  logicalHeight?: number;\n  scaleFactor?: number;\n  error?: string;\n}\n\n// --- Window List ---\nexport interface DesktopWindowListResult {\n  success: boolean;\n  windows?: DesktopWindow[];\n  error?: string;\n}\n\n// --- Window Focus ---\nexport interface DesktopWindowFocusArgs {\n  windowId: number;\n}\n\nexport interface DesktopWindowFocusResult {\n  success: boolean;\n  error?: string;\n}\n\n// ============================================================================\n// Tool Name Constants\n// ============================================================================\n\nexport const DESKTOP_TOOL_NAMES = [\n  'desktop_screenshot',\n  'desktop_mouse_move',\n  'desktop_mouse_click',\n  'desktop_mouse_drag',\n  'desktop_mouse_scroll',\n  'desktop_get_cursor',\n  'desktop_keyboard_type',\n  'desktop_keyboard_key',\n  'desktop_get_screen_size',\n  'desktop_window_list',\n  'desktop_window_focus',\n] as const;\n\nexport type DesktopToolName = (typeof DESKTOP_TOOL_NAMES)[number];\n","/**\n * NutTreeDriver - Desktop automation driver using @nut-tree-fork/nut-js\n *\n * Handles:\n * - Dynamic import of @nut-tree-fork/nut-js (optional peer dep)\n * - Scale factor detection for Retina/HiDPI displays\n * - Coordinate conversion: physical pixels (screenshot space)  logical OS coords\n * - PNG encoding of raw RGBA screenshots\n */\n\nimport type {\n  IDesktopDriver,\n  DesktopPoint,\n  DesktopScreenSize,\n  DesktopScreenshot,\n  DesktopWindow,\n  MouseButton,\n} from '../types.js';\n\n// Key name  nut-tree Key enum mapping\nconst KEY_MAP: Record<string, string> = {\n  // Modifiers\n  ctrl: 'LeftControl',\n  control: 'LeftControl',\n  cmd: 'LeftCmd',\n  command: 'LeftCmd',\n  meta: 'LeftCmd',\n  super: 'LeftCmd',\n  alt: 'LeftAlt',\n  option: 'LeftAlt',\n  shift: 'LeftShift',\n\n  // Navigation\n  enter: 'Return',\n  return: 'Return',\n  tab: 'Tab',\n  escape: 'Escape',\n  esc: 'Escape',\n  backspace: 'Backspace',\n  delete: 'Delete',\n  space: 'Space',\n\n  // Arrow keys\n  up: 'Up',\n  down: 'Down',\n  left: 'Left',\n  right: 'Right',\n\n  // Function keys\n  f1: 'F1', f2: 'F2', f3: 'F3', f4: 'F4',\n  f5: 'F5', f6: 'F6', f7: 'F7', f8: 'F8',\n  f9: 'F9', f10: 'F10', f11: 'F11', f12: 'F12',\n\n  // Other\n  home: 'Home',\n  end: 'End',\n  pageup: 'PageUp',\n  pagedown: 'PageDown',\n  insert: 'Insert',\n  printscreen: 'Print',\n  capslock: 'CapsLock',\n  numlock: 'NumLock',\n  scrolllock: 'ScrollLock',\n};\n\n/**\n * Parse a key combo string like \"ctrl+c\", \"cmd+shift+s\", \"enter\"\n * Returns nut-tree Key enum values.\n */\nexport function parseKeyCombo(keys: string, KeyEnum: Record<string, any>): any[] {\n  const parts = keys.toLowerCase().split('+').map((k) => k.trim());\n  const result: any[] = [];\n\n  for (const part of parts) {\n    // Check key map first\n    const mapped = KEY_MAP[part];\n    if (mapped && KeyEnum[mapped] !== undefined) {\n      result.push(KeyEnum[mapped]);\n      continue;\n    }\n\n    // Single character  look up directly\n    if (part.length === 1) {\n      const upper = part.toUpperCase();\n      if (KeyEnum[upper] !== undefined) {\n        result.push(KeyEnum[upper]);\n        continue;\n      }\n    }\n\n    // Try PascalCase match (e.g., \"Tab\"  Key.Tab)\n    const pascal = part.charAt(0).toUpperCase() + part.slice(1);\n    if (KeyEnum[pascal] !== undefined) {\n      result.push(KeyEnum[pascal]);\n      continue;\n    }\n\n    // Try exact match (case-sensitive)\n    if (KeyEnum[part] !== undefined) {\n      result.push(KeyEnum[part]);\n      continue;\n    }\n\n    throw new Error(`Unknown key: \"${part}\". Available modifiers: ctrl, cmd, alt, shift. Common keys: enter, tab, escape, space, up, down, left, right, f1-f12, a-z, 0-9`);\n  }\n\n  return result;\n}\n\n/**\n * Encode raw RGBA pixel data to PNG using pngjs.\n */\nasync function encodeRGBAToPNG(\n  data: Buffer | Uint8Array,\n  width: number,\n  height: number,\n): Promise<Buffer> {\n  // Dynamic import of pngjs\n  const { PNG } = await import('pngjs');\n\n  const png = new PNG({ width, height });\n  // Copy RGBA data\n  const sourceBuffer = Buffer.isBuffer(data) ? data : Buffer.from(data);\n  sourceBuffer.copy(png.data, 0, 0, width * height * 4);\n  // Encode\n  return PNG.sync.write(png);\n}\n\n// ============================================================================\n// NutTreeDriver\n// ============================================================================\n\nexport class NutTreeDriver implements IDesktopDriver {\n  private _isInitialized = false;\n  private _scaleFactor = 1;\n\n  // Lazy-loaded nut-tree modules\n  private _nut: any = null;\n\n  // Cache of Window objects keyed by windowHandle, populated by getWindowList()\n  private _windowCache = new Map<number, any>();\n\n  get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  get scaleFactor(): number {\n    return this._scaleFactor;\n  }\n\n  async initialize(): Promise<void> {\n    if (this._isInitialized) return;\n\n    // Dynamic import - fails gracefully if not installed\n    try {\n      this._nut = await import('@nut-tree-fork/nut-js');\n    } catch {\n      throw new Error(\n        '@nut-tree-fork/nut-js is not installed. Install it to use desktop automation tools:\\n' +\n        '  npm install @nut-tree-fork/nut-js',\n      );\n    }\n\n    // Configure mouse and keyboard for speed and precision\n    try {\n      const { mouse, keyboard } = this._nut;\n      if (mouse.config) {\n        mouse.config.mouseSpeed = 10000;   // Maximum speed to minimize travel time\n        mouse.config.autoDelayMs = 0;      // No delays between mouse actions\n      }\n      if (keyboard.config) {\n        keyboard.config.autoDelayMs = 0;   // No delays between keystrokes (fast typing)\n      }\n    } catch {\n      // Config may not be available in all versions\n    }\n\n    // Detect scale factor by comparing logical screen size to screenshot dimensions\n    try {\n      const { screen } = this._nut;\n      const logicalWidth = await screen.width();\n      const screenshotImage = await screen.grab();\n      const physicalWidth = screenshotImage.width;\n      this._scaleFactor = physicalWidth / logicalWidth;\n    } catch (err: any) {\n      // On macOS, permission errors are common on first use\n      if (err.message?.includes('permission') || err.message?.includes('accessibility')) {\n        throw new Error(\n          'Desktop automation requires accessibility permissions.\\n' +\n          'On macOS: System Settings  Privacy & Security  Accessibility  Enable your terminal app.',\n        );\n      }\n      // Fall back to scale factor 1 if detection fails\n      this._scaleFactor = 1;\n    }\n\n    this._isInitialized = true;\n  }\n\n  private assertInitialized(): void {\n    if (!this._isInitialized) {\n      throw new Error('NutTreeDriver not initialized. Call initialize() first.');\n    }\n  }\n\n  /** Convert physical (screenshot) coords to logical (OS) coords */\n  private toLogical(x: number, y: number): { x: number; y: number } {\n    return {\n      x: Math.round(x / this._scaleFactor),\n      y: Math.round(y / this._scaleFactor),\n    };\n  }\n\n  /** Convert logical (OS) coords to physical (screenshot) coords */\n  private toPhysical(x: number, y: number): { x: number; y: number } {\n    return {\n      x: Math.round(x * this._scaleFactor),\n      y: Math.round(y * this._scaleFactor),\n    };\n  }\n\n  // ===== Screen =====\n\n  async screenshot(region?: { x: number; y: number; width: number; height: number }): Promise<DesktopScreenshot> {\n    this.assertInitialized();\n    const { screen } = this._nut;\n\n    let image: any;\n    if (region) {\n      const { Region } = this._nut;\n      // Convert region from physical to logical coords\n      const logTopLeft = this.toLogical(region.x, region.y);\n      const logicalWidth = Math.round(region.width / this._scaleFactor);\n      const logicalHeight = Math.round(region.height / this._scaleFactor);\n      const nutRegion = new Region(logTopLeft.x, logTopLeft.y, logicalWidth, logicalHeight);\n      image = await screen.grabRegion(nutRegion);\n    } else {\n      image = await screen.grab();\n    }\n\n    // Encode raw RGBA to PNG\n    const pngBuffer = await encodeRGBAToPNG(image.data, image.width, image.height);\n    const base64 = pngBuffer.toString('base64');\n\n    return {\n      base64,\n      width: image.width,\n      height: image.height,\n    };\n  }\n\n  async getScreenSize(): Promise<DesktopScreenSize> {\n    this.assertInitialized();\n    const { screen } = this._nut;\n\n    const logicalWidth = await screen.width();\n    const logicalHeight = await screen.height();\n\n    return {\n      physicalWidth: Math.round(logicalWidth * this._scaleFactor),\n      physicalHeight: Math.round(logicalHeight * this._scaleFactor),\n      logicalWidth,\n      logicalHeight,\n      scaleFactor: this._scaleFactor,\n    };\n  }\n\n  // ===== Mouse =====\n\n  async mouseMove(x: number, y: number): Promise<void> {\n    this.assertInitialized();\n    const { mouse, straightTo, Point } = this._nut;\n    const logical = this.toLogical(x, y);\n    // Note: mouse.setPosition() is broken in @nut-tree-fork/nut-js (no-ops silently).\n    // Use mouse.move(straightTo(...)) instead  with high mouseSpeed it's near-instant.\n    await mouse.move(straightTo(new Point(logical.x, logical.y)));\n  }\n\n  async mouseClick(x: number, y: number, button: MouseButton, clickCount: number): Promise<void> {\n    this.assertInitialized();\n    const { mouse, straightTo, Point, Button } = this._nut;\n\n    // Map button\n    const nutButton = button === 'right' ? Button.RIGHT : button === 'middle' ? Button.MIDDLE : Button.LEFT;\n\n    // Move to target position before clicking\n    const logical = this.toLogical(x, y);\n    await mouse.move(straightTo(new Point(logical.x, logical.y)));\n\n    // Click the specified number of times\n    for (let i = 0; i < clickCount; i++) {\n      await mouse.click(nutButton);\n    }\n  }\n\n  async mouseDrag(startX: number, startY: number, endX: number, endY: number, button: MouseButton): Promise<void> {\n    this.assertInitialized();\n    const { mouse, straightTo, Point, Button } = this._nut;\n\n    const nutButton = button === 'right' ? Button.RIGHT : button === 'middle' ? Button.MIDDLE : Button.LEFT;\n    const logicalStart = this.toLogical(startX, startY);\n    const logicalEnd = this.toLogical(endX, endY);\n\n    // Move to start, press, drag to end, release\n    await mouse.move(straightTo(new Point(logicalStart.x, logicalStart.y)));\n    await mouse.pressButton(nutButton);\n    await mouse.move(straightTo(new Point(logicalEnd.x, logicalEnd.y)));\n    await mouse.releaseButton(nutButton);\n  }\n\n  async mouseScroll(deltaX: number, deltaY: number, x?: number, y?: number): Promise<void> {\n    this.assertInitialized();\n    const { mouse, straightTo, Point } = this._nut;\n\n    // Move to position first if specified\n    if (x !== undefined && y !== undefined) {\n      const logical = this.toLogical(x, y);\n      await mouse.move(straightTo(new Point(logical.x, logical.y)));\n    }\n\n    // nut-tree scroll: positive = down, negative = up\n    if (deltaY !== 0) {\n      if (deltaY > 0) {\n        await mouse.scrollDown(Math.abs(deltaY));\n      } else {\n        await mouse.scrollUp(Math.abs(deltaY));\n      }\n    }\n\n    if (deltaX !== 0) {\n      if (deltaX > 0) {\n        await mouse.scrollRight(Math.abs(deltaX));\n      } else {\n        await mouse.scrollLeft(Math.abs(deltaX));\n      }\n    }\n  }\n\n  async getCursorPosition(): Promise<DesktopPoint> {\n    this.assertInitialized();\n    const { mouse } = this._nut;\n\n    const pos = await mouse.getPosition();\n    // Convert from logical to physical (screenshot) coords\n    return this.toPhysical(pos.x, pos.y);\n  }\n\n  // ===== Keyboard =====\n\n  async keyboardType(text: string, delay?: number): Promise<void> {\n    this.assertInitialized();\n    const { keyboard } = this._nut;\n\n    const prevDelay = keyboard.config.autoDelayMs;\n    if (delay !== undefined) {\n      keyboard.config.autoDelayMs = delay;\n    }\n\n    try {\n      await keyboard.type(text);\n    } finally {\n      // Restore default delay if we changed it\n      if (delay !== undefined) {\n        keyboard.config.autoDelayMs = prevDelay;\n      }\n    }\n  }\n\n  async keyboardKey(keys: string): Promise<void> {\n    this.assertInitialized();\n    const { keyboard, Key } = this._nut;\n\n    const parsedKeys = parseKeyCombo(keys, Key);\n\n    if (parsedKeys.length === 1) {\n      await keyboard.pressKey(parsedKeys[0]);\n      await keyboard.releaseKey(parsedKeys[0]);\n    } else {\n      // Press all keys in order, then release in reverse\n      for (const key of parsedKeys) {\n        await keyboard.pressKey(key);\n      }\n      for (const key of [...parsedKeys].reverse()) {\n        await keyboard.releaseKey(key);\n      }\n    }\n  }\n\n  // ===== Windows =====\n\n  async getWindowList(): Promise<DesktopWindow[]> {\n    this.assertInitialized();\n    const { getWindows } = this._nut;\n\n    try {\n      const windows = await getWindows();\n      const result: DesktopWindow[] = [];\n      // Cache window objects by handle for focusWindow() lookup\n      this._windowCache.clear();\n\n      for (const win of windows) {\n        try {\n          // windowHandle is the unique OS window identifier (private in TS, accessible at runtime)\n          const handle = (win as any).windowHandle as number;\n          if (handle === undefined || handle === null) continue;\n\n          const title = await win.title;\n          const region = await win.region;\n\n          this._windowCache.set(handle, win);\n\n          result.push({\n            id: handle,\n            title: title || '',\n            bounds: region ? {\n              x: Math.round(region.left * this._scaleFactor),\n              y: Math.round(region.top * this._scaleFactor),\n              width: Math.round(region.width * this._scaleFactor),\n              height: Math.round(region.height * this._scaleFactor),\n            } : undefined,\n          });\n        } catch {\n          // Skip windows that can't be queried\n        }\n      }\n\n      return result;\n    } catch {\n      // Window listing may not be supported on all platforms\n      return [];\n    }\n  }\n\n  async focusWindow(windowId: number): Promise<void> {\n    this.assertInitialized();\n\n    // Try cached window first (from most recent getWindowList call)\n    let target = this._windowCache.get(windowId);\n\n    if (!target) {\n      // Cache miss  re-fetch windows and find by windowHandle\n      const { getWindows } = this._nut;\n      const windows = await getWindows();\n      target = windows.find((w: any) => (w as any).windowHandle === windowId);\n    }\n\n    if (!target) {\n      throw new Error(`Window with ID ${windowId} not found. Call desktop_window_list first to get current window IDs.`);\n    }\n\n    await target.focus();\n  }\n}\n","/**\n * Lazy singleton driver accessor for desktop tools.\n *\n * First call initializes the driver (dynamic import + scale detection).\n * Subsequent calls reuse the same instance.\n */\n\nimport type { IDesktopDriver } from './types.js';\nimport type { DesktopToolConfig } from './types.js';\nimport { NutTreeDriver } from './driver/NutTreeDriver.js';\n\nlet defaultDriver: IDesktopDriver | null = null;\n\n/**\n * Get (or create) the desktop driver instance.\n * If config.driver is provided, uses that instead of the default.\n */\nexport async function getDesktopDriver(config?: DesktopToolConfig): Promise<IDesktopDriver> {\n  // Custom driver takes precedence\n  if (config?.driver) {\n    if (!config.driver.isInitialized) {\n      await config.driver.initialize();\n    }\n    return config.driver;\n  }\n\n  // Lazy-init default driver\n  if (!defaultDriver) {\n    defaultDriver = new NutTreeDriver();\n  }\n\n  if (!defaultDriver.isInitialized) {\n    await defaultDriver.initialize();\n  }\n\n  return defaultDriver;\n}\n\n/**\n * Reset the default driver (for testing).\n */\nexport function resetDefaultDriver(): void {\n  defaultDriver = null;\n}\n","/**\n * Desktop Screenshot Tool\n *\n * Captures a screenshot of the entire screen or a specific region.\n * Returns base64 PNG with __images convention for multimodal provider handling.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopScreenshotArgs, DesktopScreenshotResult } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopScreenshotTool(config?: DesktopToolConfig): ToolFunction<DesktopScreenshotArgs, DesktopScreenshotResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_screenshot',\n        description: `Take a screenshot of the entire screen or a specific region. Returns the screenshot image for visual analysis. Use this to see what's on screen before performing actions. IMPORTANT: If you capture a region, element positions in the image are relative to the region's top-left corner. To click an element at image position (ix, iy), you must use screen coordinates (ix + region.x, iy + region.y). Prefer full-screen screenshots to avoid coordinate offset errors.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            region: {\n              type: 'object',\n              description: 'Optional region to capture (in physical pixel coordinates). Omit to capture full screen.',\n              properties: {\n                x: { type: 'number', description: 'Left edge X coordinate' },\n                y: { type: 'number', description: 'Top edge Y coordinate' },\n                width: { type: 'number', description: 'Width in pixels' },\n                height: { type: 'number', description: 'Height in pixels' },\n              },\n              required: ['x', 'y', 'width', 'height'],\n            },\n          },\n          required: [],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopScreenshotArgs): string => {\n      if (args.region) {\n        return `region (${args.region.x},${args.region.y}) ${args.region.width}x${args.region.height}`;\n      }\n      return 'full screen';\n    },\n\n    execute: async (args: DesktopScreenshotArgs): Promise<DesktopScreenshotResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        const screenshot = await driver.screenshot(args.region);\n\n        return {\n          success: true,\n          width: screenshot.width,\n          height: screenshot.height,\n          base64: screenshot.base64,\n          __images: [{ base64: screenshot.base64, mediaType: 'image/png' }],\n          // Include region info so the agent can compute screen coordinates:\n          // screen_x = image_x + regionOffsetX, screen_y = image_y + regionOffsetY\n          ...(args.region ? { regionOffsetX: args.region.x, regionOffsetY: args.region.y } : {}),\n        };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopScreenshot = createDesktopScreenshotTool();\n","/**\n * Desktop Mouse Move Tool\n *\n * Moves the mouse cursor to a specific position on screen.\n * Coordinates are in physical pixel space (same as screenshot pixels).\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopMouseMoveArgs, DesktopMouseMoveResult } from './types.js';\nimport { applyHumanDelay } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopMouseMoveTool(config?: DesktopToolConfig): ToolFunction<DesktopMouseMoveArgs, DesktopMouseMoveResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_mouse_move',\n        description: `Move the mouse cursor to the specified (x, y) position. Coordinates are in screenshot pixel space (full screen). Returns the actual cursor position after the move for verification.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            x: { type: 'number', description: 'X coordinate (in screenshot pixels)' },\n            y: { type: 'number', description: 'Y coordinate (in screenshot pixels)' },\n          },\n          required: ['x', 'y'],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopMouseMoveArgs): string => `(${args.x}, ${args.y})`,\n\n    execute: async (args: DesktopMouseMoveArgs): Promise<DesktopMouseMoveResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        await driver.mouseMove(args.x, args.y);\n        await applyHumanDelay(config ?? {});\n        // Return actual cursor position for verification\n        const actual = await driver.getCursorPosition();\n        return { success: true, x: actual.x, y: actual.y };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopMouseMove = createDesktopMouseMoveTool();\n","/**\n * Desktop Mouse Click Tool\n *\n * Clicks at the current cursor position or at specified coordinates.\n * If x/y are provided, moves to that position first, then clicks.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopMouseClickArgs, DesktopMouseClickResult } from './types.js';\nimport { applyHumanDelay } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopMouseClickTool(config?: DesktopToolConfig): ToolFunction<DesktopMouseClickArgs, DesktopMouseClickResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_mouse_click',\n        description: `Click the mouse at the specified position or at the current cursor position. Supports left/right/middle button and single/double/triple click.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            x: { type: 'number', description: 'X coordinate to click (in screenshot pixels). Omit to click at current position.' },\n            y: { type: 'number', description: 'Y coordinate to click (in screenshot pixels). Omit to click at current position.' },\n            button: {\n              type: 'string',\n              enum: ['left', 'right', 'middle'],\n              description: 'Mouse button to click. Default: \"left\"',\n            },\n            clickCount: {\n              type: 'number',\n              description: 'Number of clicks (1=single, 2=double, 3=triple). Default: 1',\n            },\n          },\n          required: [],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopMouseClickArgs): string => {\n      const pos = args.x !== undefined ? `(${args.x}, ${args.y})` : 'current position';\n      const btn = args.button && args.button !== 'left' ? ` ${args.button}` : '';\n      const count = args.clickCount && args.clickCount > 1 ? ` x${args.clickCount}` : '';\n      return `${pos}${btn}${count}`;\n    },\n\n    execute: async (args: DesktopMouseClickArgs): Promise<DesktopMouseClickResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        const button = args.button ?? 'left';\n        const clickCount = args.clickCount ?? 1;\n\n        if (args.x !== undefined && args.y !== undefined) {\n          // Move + click\n          await driver.mouseClick(args.x, args.y, button, clickCount);\n        } else {\n          // Click at current position\n          const pos = await driver.getCursorPosition();\n          await driver.mouseClick(pos.x, pos.y, button, clickCount);\n        }\n\n        await applyHumanDelay(config ?? {});\n        // Return actual cursor position for verification\n        const actual = await driver.getCursorPosition();\n        return { success: true, x: actual.x, y: actual.y, button, clickCount };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopMouseClick = createDesktopMouseClickTool();\n","/**\n * Desktop Mouse Drag Tool\n *\n * Drags from one position to another (press, move, release).\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopMouseDragArgs, DesktopMouseDragResult } from './types.js';\nimport { applyHumanDelay } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopMouseDragTool(config?: DesktopToolConfig): ToolFunction<DesktopMouseDragArgs, DesktopMouseDragResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_mouse_drag',\n        description: `Drag the mouse from one position to another. Presses the button at the start position, moves to the end position, then releases.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            startX: { type: 'number', description: 'Start X coordinate (in screenshot pixels)' },\n            startY: { type: 'number', description: 'Start Y coordinate (in screenshot pixels)' },\n            endX: { type: 'number', description: 'End X coordinate (in screenshot pixels)' },\n            endY: { type: 'number', description: 'End Y coordinate (in screenshot pixels)' },\n            button: {\n              type: 'string',\n              enum: ['left', 'right', 'middle'],\n              description: 'Mouse button to use for dragging. Default: \"left\"',\n            },\n          },\n          required: ['startX', 'startY', 'endX', 'endY'],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopMouseDragArgs): string =>\n      `(${args.startX},${args.startY})  (${args.endX},${args.endY})`,\n\n    execute: async (args: DesktopMouseDragArgs): Promise<DesktopMouseDragResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        await driver.mouseDrag(args.startX, args.startY, args.endX, args.endY, args.button ?? 'left');\n        await applyHumanDelay(config ?? {});\n        return { success: true };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopMouseDrag = createDesktopMouseDragTool();\n","/**\n * Desktop Mouse Scroll Tool\n *\n * Scrolls the mouse wheel at the current position or at specified coordinates.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopMouseScrollArgs, DesktopMouseScrollResult } from './types.js';\nimport { applyHumanDelay } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopMouseScrollTool(config?: DesktopToolConfig): ToolFunction<DesktopMouseScrollArgs, DesktopMouseScrollResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_mouse_scroll',\n        description: `Scroll the mouse wheel. Positive deltaY scrolls down, negative scrolls up. Positive deltaX scrolls right, negative scrolls left. Optionally specify position to scroll at.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            deltaX: { type: 'number', description: 'Horizontal scroll amount. Positive=right, negative=left. Default: 0' },\n            deltaY: { type: 'number', description: 'Vertical scroll amount. Positive=down, negative=up. Default: 0' },\n            x: { type: 'number', description: 'X coordinate to scroll at (in screenshot pixels). Omit to scroll at current position.' },\n            y: { type: 'number', description: 'Y coordinate to scroll at (in screenshot pixels). Omit to scroll at current position.' },\n          },\n          required: [],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopMouseScrollArgs): string => {\n      const parts: string[] = [];\n      if (args.deltaY) parts.push(args.deltaY > 0 ? `down ${args.deltaY}` : `up ${Math.abs(args.deltaY)}`);\n      if (args.deltaX) parts.push(args.deltaX > 0 ? `right ${args.deltaX}` : `left ${Math.abs(args.deltaX)}`);\n      if (args.x !== undefined) parts.push(`at (${args.x},${args.y})`);\n      return parts.join(', ') || 'no-op';\n    },\n\n    execute: async (args: DesktopMouseScrollArgs): Promise<DesktopMouseScrollResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        await driver.mouseScroll(args.deltaX ?? 0, args.deltaY ?? 0, args.x, args.y);\n        await applyHumanDelay(config ?? {});\n        return { success: true };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopMouseScroll = createDesktopMouseScrollTool();\n","/**\n * Desktop Get Cursor Tool\n *\n * Returns the current cursor position in physical pixel (screenshot) coordinates.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopGetCursorResult } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopGetCursorTool(config?: DesktopToolConfig): ToolFunction<Record<string, never>, DesktopGetCursorResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_get_cursor',\n        description: `Get the current mouse cursor position in screenshot pixel coordinates.`,\n        parameters: {\n          type: 'object',\n          properties: {},\n          required: [],\n        },\n      },\n    },\n\n    describeCall: (): string => 'get cursor position',\n\n    execute: async (): Promise<DesktopGetCursorResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        const pos = await driver.getCursorPosition();\n        return { success: true, x: pos.x, y: pos.y };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopGetCursor = createDesktopGetCursorTool();\n","/**\n * Desktop Keyboard Type Tool\n *\n * Types text as if from a physical keyboard.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopKeyboardTypeArgs, DesktopKeyboardTypeResult } from './types.js';\nimport { applyHumanDelay } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopKeyboardTypeTool(config?: DesktopToolConfig): ToolFunction<DesktopKeyboardTypeArgs, DesktopKeyboardTypeResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_keyboard_type',\n        description: `Type text using the keyboard. Each character is typed as a keypress. Use this for entering text into focused input fields.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            text: { type: 'string', description: 'The text to type' },\n            delay: { type: 'number', description: 'Delay in ms between each keystroke. Default: uses system default.' },\n          },\n          required: ['text'],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopKeyboardTypeArgs): string => {\n      const preview = args.text.length > 30 ? args.text.slice(0, 27) + '...' : args.text;\n      return `\"${preview}\"`;\n    },\n\n    execute: async (args: DesktopKeyboardTypeArgs): Promise<DesktopKeyboardTypeResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        await driver.keyboardType(args.text, args.delay);\n        await applyHumanDelay(config ?? {});\n        return { success: true };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopKeyboardType = createDesktopKeyboardTypeTool();\n","/**\n * Desktop Keyboard Key Tool\n *\n * Presses keyboard shortcuts or special keys (e.g., \"ctrl+c\", \"enter\", \"cmd+shift+s\").\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopKeyboardKeyArgs, DesktopKeyboardKeyResult } from './types.js';\nimport { applyHumanDelay } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopKeyboardKeyTool(config?: DesktopToolConfig): ToolFunction<DesktopKeyboardKeyArgs, DesktopKeyboardKeyResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_keyboard_key',\n        description: `Press a keyboard shortcut or special key. Use \"+\" to combine keys (e.g., \"ctrl+c\", \"cmd+shift+s\", \"enter\", \"tab\", \"escape\"). Modifiers: ctrl, cmd/command, alt/option, shift. Special keys: enter, tab, escape, backspace, delete, space, up, down, left, right, f1-f12, home, end, pageup, pagedown.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            keys: {\n              type: 'string',\n              description: 'Key combo string (e.g., \"ctrl+c\", \"enter\", \"cmd+shift+s\")',\n            },\n          },\n          required: ['keys'],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopKeyboardKeyArgs): string => args.keys,\n\n    execute: async (args: DesktopKeyboardKeyArgs): Promise<DesktopKeyboardKeyResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        await driver.keyboardKey(args.keys);\n        await applyHumanDelay(config ?? {});\n        return { success: true };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopKeyboardKey = createDesktopKeyboardKeyTool();\n","/**\n * Desktop Get Screen Size Tool\n *\n * Returns the screen dimensions (physical, logical, and scale factor).\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopGetScreenSizeResult } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopGetScreenSizeTool(config?: DesktopToolConfig): ToolFunction<Record<string, never>, DesktopGetScreenSizeResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_get_screen_size',\n        description: `Get the screen dimensions. Returns physical pixel size (screenshot space), logical size (OS coordinates), and the scale factor (e.g., 2.0 on Retina displays). All desktop tool coordinates use physical pixel space.`,\n        parameters: {\n          type: 'object',\n          properties: {},\n          required: [],\n        },\n      },\n    },\n\n    describeCall: (): string => 'get screen size',\n\n    execute: async (): Promise<DesktopGetScreenSizeResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        const size = await driver.getScreenSize();\n        return {\n          success: true,\n          physicalWidth: size.physicalWidth,\n          physicalHeight: size.physicalHeight,\n          logicalWidth: size.logicalWidth,\n          logicalHeight: size.logicalHeight,\n          scaleFactor: size.scaleFactor,\n        };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopGetScreenSize = createDesktopGetScreenSizeTool();\n","/**\n * Desktop Window List Tool\n *\n * Lists all visible windows with their IDs, titles, and bounds.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopWindowListResult } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopWindowListTool(config?: DesktopToolConfig): ToolFunction<Record<string, never>, DesktopWindowListResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_window_list',\n        description: `List all visible windows on the desktop. Returns window IDs, titles, application names, and bounds. Use the window ID with desktop_window_focus to bring a window to the foreground.`,\n        parameters: {\n          type: 'object',\n          properties: {},\n          required: [],\n        },\n      },\n    },\n\n    describeCall: (): string => 'list windows',\n\n    execute: async (): Promise<DesktopWindowListResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        const windows = await driver.getWindowList();\n        return { success: true, windows };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopWindowList = createDesktopWindowListTool();\n","/**\n * Desktop Window Focus Tool\n *\n * Brings a specific window to the foreground by its window ID.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { DesktopToolConfig, DesktopWindowFocusArgs, DesktopWindowFocusResult } from './types.js';\nimport { getDesktopDriver } from './getDriver.js';\n\nexport function createDesktopWindowFocusTool(config?: DesktopToolConfig): ToolFunction<DesktopWindowFocusArgs, DesktopWindowFocusResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'desktop_window_focus',\n        description: `Focus (bring to front) a window by its ID. Use desktop_window_list to get available window IDs.`,\n        parameters: {\n          type: 'object',\n          properties: {\n            windowId: {\n              type: 'number',\n              description: 'The window ID from desktop_window_list',\n            },\n          },\n          required: ['windowId'],\n        },\n      },\n    },\n\n    describeCall: (args: DesktopWindowFocusArgs): string => `window ${args.windowId}`,\n\n    execute: async (args: DesktopWindowFocusArgs): Promise<DesktopWindowFocusResult> => {\n      try {\n        const driver = await getDesktopDriver(config);\n        await driver.focusWindow(args.windowId);\n        return { success: true };\n      } catch (err: any) {\n        return { success: false, error: err.message };\n      }\n    },\n  };\n}\n\nexport const desktopWindowFocus = createDesktopWindowFocusTool();\n","/**\n * Desktop Automation Tools\n *\n * OS-level desktop automation for \"computer use\" agent loops:\n * screenshot  vision model  tool calls (click, type, etc.)  repeat.\n *\n * Requires @nut-tree-fork/nut-js as an optional peer dependency.\n * All coordinates are in physical pixel space (screenshot space).\n *\n * @example\n * ```typescript\n * import { tools } from '@everworker/oneringai';\n *\n * const agent = Agent.create({\n *   connector: 'openai',\n *   model: 'gpt-4',\n *   tools: tools.desktopTools,\n * });\n * ```\n */\n\n// Types\nexport type {\n  IDesktopDriver,\n  DesktopToolConfig,\n  DesktopPoint,\n  DesktopScreenSize,\n  DesktopScreenshot,\n  DesktopWindow,\n  MouseButton,\n  DesktopToolName,\n  // Arg/Result types\n  DesktopScreenshotArgs,\n  DesktopScreenshotResult,\n  DesktopMouseMoveArgs,\n  DesktopMouseMoveResult,\n  DesktopMouseClickArgs,\n  DesktopMouseClickResult,\n  DesktopMouseDragArgs,\n  DesktopMouseDragResult,\n  DesktopMouseScrollArgs,\n  DesktopMouseScrollResult,\n  DesktopGetCursorResult,\n  DesktopKeyboardTypeArgs,\n  DesktopKeyboardTypeResult,\n  DesktopKeyboardKeyArgs,\n  DesktopKeyboardKeyResult,\n  DesktopGetScreenSizeResult,\n  DesktopWindowListResult,\n  DesktopWindowFocusArgs,\n  DesktopWindowFocusResult,\n} from './types.js';\n\nexport {\n  DEFAULT_DESKTOP_CONFIG,\n  applyHumanDelay,\n  DESKTOP_TOOL_NAMES,\n} from './types.js';\n\n// Driver\nexport { NutTreeDriver, parseKeyCombo } from './driver/index.js';\nexport { getDesktopDriver, resetDefaultDriver } from './getDriver.js';\n\n// Tool factories + default instances\nexport { desktopScreenshot, createDesktopScreenshotTool } from './screenshot.js';\nexport { desktopMouseMove, createDesktopMouseMoveTool } from './mouseMove.js';\nexport { desktopMouseClick, createDesktopMouseClickTool } from './mouseClick.js';\nexport { desktopMouseDrag, createDesktopMouseDragTool } from './mouseDrag.js';\nexport { desktopMouseScroll, createDesktopMouseScrollTool } from './mouseScroll.js';\nexport { desktopGetCursor, createDesktopGetCursorTool } from './getCursor.js';\nexport { desktopKeyboardType, createDesktopKeyboardTypeTool } from './keyboardType.js';\nexport { desktopKeyboardKey, createDesktopKeyboardKeyTool } from './keyboardKey.js';\nexport { desktopGetScreenSize, createDesktopGetScreenSizeTool } from './getScreenSize.js';\nexport { desktopWindowList, createDesktopWindowListTool } from './windowList.js';\nexport { desktopWindowFocus, createDesktopWindowFocusTool } from './windowFocus.js';\n\n// Convenience bundle\nimport { desktopScreenshot } from './screenshot.js';\nimport { desktopMouseMove } from './mouseMove.js';\nimport { desktopMouseClick } from './mouseClick.js';\nimport { desktopMouseDrag } from './mouseDrag.js';\nimport { desktopMouseScroll } from './mouseScroll.js';\nimport { desktopGetCursor } from './getCursor.js';\nimport { desktopKeyboardType } from './keyboardType.js';\nimport { desktopKeyboardKey } from './keyboardKey.js';\nimport { desktopGetScreenSize } from './getScreenSize.js';\nimport { desktopWindowList } from './windowList.js';\nimport { desktopWindowFocus } from './windowFocus.js';\n\n/**\n * A bundle of all desktop automation tools.\n * Includes: screenshot, mouse (move, click, drag, scroll, getCursor),\n * keyboard (type, key), screen info, and window management.\n */\nexport const desktopTools = [\n  desktopScreenshot,\n  desktopMouseMove,\n  desktopMouseClick,\n  desktopMouseDrag,\n  desktopMouseScroll,\n  desktopGetCursor,\n  desktopKeyboardType,\n  desktopKeyboardKey,\n  desktopGetScreenSize,\n  desktopWindowList,\n  desktopWindowFocus,\n];\n","/**\n * Shared helper to resolve ICustomToolStorage for custom tool meta-tools.\n *\n * Resolution order:\n * 1. Explicit storage passed to the factory function (backward compat)\n * 2. StorageRegistry factory called with StorageContext (multi-tenant)\n * 3. Default FileCustomToolStorage\n */\n\nimport type { ICustomToolStorage } from '../../domain/interfaces/ICustomToolStorage.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport { FileCustomToolStorage } from '../../infrastructure/storage/FileCustomToolStorage.js';\nimport { StorageRegistry } from '../../core/StorageRegistry.js';\nimport type { StorageContext } from '../../core/StorageRegistry.js';\n\n/**\n * Build a StorageContext from ToolContext (extracts userId).\n */\nfunction buildStorageContext(toolContext?: ToolContext): StorageContext | undefined {\n  const global = StorageRegistry.getContext();\n  if (global) return global;\n  if (toolContext?.userId) return { userId: toolContext.userId };\n  return undefined;\n}\n\n/**\n * Resolve custom tool storage.\n *\n * @param explicit - Storage instance passed to the factory (highest priority)\n * @param toolContext - ToolContext from execution (provides userId for multi-tenant)\n */\nexport function resolveCustomToolStorage(\n  explicit: ICustomToolStorage | undefined,\n  toolContext?: ToolContext,\n): ICustomToolStorage {\n  // 1. Explicit storage (backward compat)\n  if (explicit) return explicit;\n\n  // 2. Registry factory\n  const factory = StorageRegistry.get('customTools');\n  if (factory) {\n    return factory(buildStorageContext(toolContext));\n  }\n\n  // 3. Default\n  return new FileCustomToolStorage();\n}\n","/**\n * custom_tool_delete - Deletes a custom tool from storage\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport type { ICustomToolStorage } from '../../domain/interfaces/ICustomToolStorage.js';\nimport { resolveCustomToolStorage } from './resolveStorage.js';\n\ninterface DeleteArgs {\n  name: string;\n}\n\ninterface DeleteResult {\n  success: boolean;\n  name: string;\n  error?: string;\n}\n\nexport function createCustomToolDelete(storage?: ICustomToolStorage): ToolFunction<DeleteArgs, DeleteResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'custom_tool_delete',\n        description: 'Delete a custom tool from persistent storage.',\n        parameters: {\n          type: 'object',\n          properties: {\n            name: {\n              type: 'string',\n              description: 'Name of the tool to delete',\n            },\n          },\n          required: ['name'],\n        },\n      },\n    },\n\n    permission: { scope: 'session', riskLevel: 'medium' },\n\n    execute: async (args: DeleteArgs, context?: ToolContext): Promise<DeleteResult> => {\n      try {\n        const userId = context?.userId;\n        const s = resolveCustomToolStorage(storage, context);\n        const exists = await s.exists(userId, args.name);\n        if (!exists) {\n          return { success: false, name: args.name, error: `Custom tool '${args.name}' not found` };\n        }\n\n        await s.delete(userId, args.name);\n        return { success: true, name: args.name };\n      } catch (error) {\n        return { success: false, name: args.name, error: (error as Error).message };\n      }\n    },\n\n    describeCall: (args: DeleteArgs) => args.name,\n  };\n}\n\n/** Default custom_tool_delete instance (resolves storage from StorageRegistry at execution time) */\nexport const customToolDelete = createCustomToolDelete();\n","/**\n * Shared sandbox API description for custom tool meta-tools.\n *\n * Generates dynamic descriptions that include the full VM sandbox API\n * and all currently available connectors  regenerated each time\n * tool definitions are sent to the LLM via descriptionFactory.\n */\n\nimport type { ToolContext } from '../../domain/entities/Tool.js';\nimport { Connector } from '../../core/Connector.js';\n\n/**\n * Format a single connector for display in tool descriptions.\n */\nfunction formatConnectorEntry(c: Connector, accountId?: string): string {\n  const parts: string[] = [];\n\n  const serviceOrVendor = c.serviceType ?? c.vendor ?? undefined;\n  if (serviceOrVendor) parts.push(`Service: ${serviceOrVendor}`);\n\n  if (accountId) parts.push(`Account: \"${accountId}\"`);\n\n  if (c.config.description) parts.push(c.config.description);\n\n  if (c.baseURL) parts.push(`URL: ${c.baseURL}`);\n\n  const label = accountId ? `\"${c.name}\" account \"${accountId}\"` : `\"${c.name}\"`;\n  const details = parts.map(p => `     ${p}`).join('\\n');\n  return `    ${label} (${c.displayName})\\n${details}`;\n}\n\n/**\n * Build the connector/identity list section from current ToolContext.\n * If identities are set, list each identity entry. Otherwise list all connectors.\n */\nexport function buildConnectorList(context: ToolContext | undefined): string {\n  const identities = context?.identities;\n  const registry = context?.connectorRegistry ?? Connector.asRegistry();\n\n  if (identities?.length) {\n    const entries: string[] = [];\n    for (const id of identities) {\n      try {\n        const connector = registry.get(id.connector);\n        entries.push(formatConnectorEntry(connector, id.accountId));\n      } catch {\n        entries.push(`    \"${id.connector}\"${id.accountId ? ` account \"${id.accountId}\"` : ''}  not available`);\n      }\n    }\n    return entries.length > 0 ? entries.join('\\n\\n') : '   No connectors registered.';\n  }\n\n  const connectors = registry.listAll();\n  if (connectors.length === 0) {\n    return '   No connectors registered.';\n  }\n\n  return connectors.map(c => formatConnectorEntry(c)).join('\\n\\n');\n}\n\n/**\n * The complete sandbox API reference, shared by all tools that write/test custom tool code.\n */\nexport const SANDBOX_API_REFERENCE = `SANDBOX API (available inside custom tool code):\n\n1. authenticatedFetch(url, options, connectorName, accountId?)\n   Makes authenticated HTTP requests using the connector's credentials.\n   Auth headers are added automatically  DO NOT set Authorization header manually.\n\n   Parameters:\n      url: Full URL or path relative to the connector's base URL\n       - Full: \"https://api.github.com/user/repos\"\n       - Relative: \"/user/repos\" (resolved against connector's base URL)\n      options: Standard fetch options { method, headers, body }\n       - For POST/PUT: set body to JSON.stringify(data) and headers to { 'Content-Type': 'application/json' }\n      connectorName: Name of a registered connector (see REGISTERED CONNECTORS below)\n      accountId (optional): Account alias for multi-account connectors (e.g., 'work', 'personal')\n\n   Returns: Promise<Response>\n      response.ok  true if status 200-299\n      response.status  HTTP status code\n      await response.json()  parse JSON body\n      await response.text()  get text body\n\n2. fetch(url, options)  Standard fetch without authentication\n\n3. connectors.list()  Array of available connector names\n4. connectors.get(name)  Connector info: { displayName, description, baseURL, serviceType }\n\nVARIABLES:\n    input  the tool's input arguments (matches inputSchema)\n    output  SET THIS to return the tool's result to the caller\n\nGLOBALS: console.log/error/warn, JSON, Math, Date, Buffer, Promise, Array, Object, String, Number, Boolean, setTimeout, setInterval, URL, URLSearchParams, RegExp, Map, Set, Error, TextEncoder, TextDecoder\n\nLIMITS: No file system access, no require/import. Code runs in async context (await is available).`;\n\n/**\n * Build a complete dynamic description for custom_tool_draft.\n */\nexport function buildDraftDescription(context: ToolContext | undefined): string {\n  const connectorList = buildConnectorList(context);\n\n  return `Validate a draft custom tool definition. Checks name format, schema structure, and code syntax.\n\nWhen writing the \"code\" field, you have access to the full VM sandbox:\n\n${SANDBOX_API_REFERENCE}\n\nREGISTERED CONNECTORS:\n${connectorList}\n\nCODE EXAMPLES:\n\n// Simple data processing tool\nconst items = input.data;\noutput = items.filter(i => i.score > 0.8).sort((a, b) => b.score - a.score);\n\n// API tool using a connector\nconst resp = await authenticatedFetch('/user/repos', { method: 'GET' }, 'github');\nconst repos = await resp.json();\noutput = repos.map(r => ({ name: r.full_name, stars: r.stargazers_count }));\n\n// Tool that chains multiple API calls\nconst users = await (await authenticatedFetch('/users', {}, 'my-api')).json();\nconst enriched = await Promise.all(users.map(async u => {\n  const details = await (await authenticatedFetch(\\`/users/\\${u.id}\\`, {}, 'my-api')).json();\n  return { ...u, ...details };\n}));\noutput = enriched;`;\n}\n\n/**\n * Build a complete dynamic description for custom_tool_test.\n */\nexport function buildTestDescription(context: ToolContext | undefined): string {\n  const connectorList = buildConnectorList(context);\n\n  return `Test custom tool code by executing it in the VM sandbox with provided test input. Returns execution result, captured logs, and timing.\n\nThe code runs in the same sandbox as execute_javascript:\n\n${SANDBOX_API_REFERENCE}\n\nREGISTERED CONNECTORS:\n${connectorList}\n\nThe testInput you provide will be available as the \\`input\\` variable in the code.\nSet \\`output\\` to the value you want returned.`;\n}\n","/**\n * custom_tool_draft - Validates a draft custom tool structure\n *\n * The agent generates the tool content; this tool validates:\n * - Name format (/^[a-z][a-z0-9_]*$/)\n * - Input schema has type: 'object'\n * - Code is syntactically valid\n * - Description is not empty\n *\n * Uses descriptionFactory to dynamically show available connectors\n * so the agent knows what APIs it can use when writing tool code.\n */\n\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport { buildDraftDescription } from './sandboxDescription.js';\n\ninterface DraftArgs {\n  name: string;\n  description: string;\n  inputSchema: Record<string, unknown>;\n  outputSchema?: Record<string, unknown>;\n  code: string;\n  tags?: string[];\n  connectorName?: string;\n}\n\ninterface DraftResult {\n  success: boolean;\n  errors?: string[];\n  validated?: {\n    name: string;\n    description: string;\n    inputSchema: Record<string, unknown>;\n    outputSchema?: Record<string, unknown>;\n    code: string;\n    tags?: string[];\n    connectorName?: string;\n  };\n}\n\nconst NAME_PATTERN = /^[a-z][a-z0-9_]*$/;\n\nexport function createCustomToolDraft(): ToolFunction<DraftArgs, DraftResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'custom_tool_draft',\n        description: 'Validate a draft custom tool definition. Checks name format, schema structure, and code syntax.',\n        parameters: {\n          type: 'object',\n          properties: {\n            name: {\n              type: 'string',\n              description: 'Tool name (lowercase, underscores, must start with letter). Example: \"fetch_weather\"',\n            },\n            description: {\n              type: 'string',\n              description: 'What the tool does',\n            },\n            inputSchema: {\n              type: 'object',\n              description: 'JSON Schema for the tool input (must have type: \"object\")',\n            },\n            outputSchema: {\n              type: 'object',\n              description: 'Optional JSON Schema for the tool output (documentation only)',\n            },\n            code: {\n              type: 'string',\n              description:\n                'JavaScript code that reads `input` and sets `output`. ' +\n                'Runs in the same sandbox as execute_javascript. See tool description for full API reference.',\n            },\n            tags: {\n              type: 'array',\n              description: 'Optional tags for categorization',\n              items: { type: 'string' },\n            },\n            connectorName: {\n              type: 'string',\n              description: 'Optional connector name if the tool requires API access',\n            },\n          },\n          required: ['name', 'description', 'inputSchema', 'code'],\n        },\n      },\n    },\n\n    descriptionFactory: (context?: ToolContext) => buildDraftDescription(context),\n\n    permission: { scope: 'always', riskLevel: 'low' },\n\n    execute: async (args: DraftArgs): Promise<DraftResult> => {\n      const errors: string[] = [];\n\n      // Validate name\n      if (!args.name || typeof args.name !== 'string') {\n        errors.push('name is required and must be a string');\n      } else if (!NAME_PATTERN.test(args.name)) {\n        errors.push(\n          `name \"${args.name}\" is invalid. Must match /^[a-z][a-z0-9_]*$/ (lowercase, underscores, start with letter)`\n        );\n      }\n\n      // Validate description\n      if (!args.description || typeof args.description !== 'string' || args.description.trim().length === 0) {\n        errors.push('description is required and must be a non-empty string');\n      }\n\n      // Validate inputSchema\n      if (!args.inputSchema || typeof args.inputSchema !== 'object') {\n        errors.push('inputSchema is required and must be an object');\n      } else if (args.inputSchema.type !== 'object') {\n        errors.push('inputSchema.type must be \"object\"');\n      }\n\n      // Validate code syntax\n      if (!args.code || typeof args.code !== 'string' || args.code.trim().length === 0) {\n        errors.push('code is required and must be a non-empty string');\n      } else {\n        try {\n          // eslint-disable-next-line no-new\n          new Function(args.code);\n        } catch (e) {\n          errors.push(`code has syntax error: ${(e as Error).message}`);\n        }\n      }\n\n      if (errors.length > 0) {\n        return { success: false, errors };\n      }\n\n      return {\n        success: true,\n        validated: {\n          name: args.name,\n          description: args.description,\n          inputSchema: args.inputSchema,\n          outputSchema: args.outputSchema,\n          code: args.code,\n          tags: args.tags,\n          connectorName: args.connectorName,\n        },\n      };\n    },\n\n    describeCall: (args: DraftArgs) => args.name ?? 'unknown',\n  };\n}\n\n/** Default custom_tool_draft instance */\nexport const customToolDraft = createCustomToolDraft();\n","/**\n * custom_tool_list - Lists saved custom tools from storage\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport type { ICustomToolStorage } from '../../domain/interfaces/ICustomToolStorage.js';\nimport type { CustomToolSummary } from '../../domain/entities/CustomToolDefinition.js';\nimport { resolveCustomToolStorage } from './resolveStorage.js';\n\ninterface ListArgs {\n  search?: string;\n  tags?: string[];\n  category?: string;\n  limit?: number;\n  offset?: number;\n}\n\ninterface ListResult {\n  tools: CustomToolSummary[];\n  total: number;\n}\n\nexport function createCustomToolList(storage?: ICustomToolStorage): ToolFunction<ListArgs, ListResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'custom_tool_list',\n        description:\n          'List saved custom tools from persistent storage. Supports filtering by search text, tags, and category.',\n        parameters: {\n          type: 'object',\n          properties: {\n            search: {\n              type: 'string',\n              description: 'Search text (case-insensitive substring match on name + description)',\n            },\n            tags: {\n              type: 'array',\n              description: 'Filter by tags (any match)',\n              items: { type: 'string' },\n            },\n            category: {\n              type: 'string',\n              description: 'Filter by category',\n            },\n            limit: {\n              type: 'number',\n              description: 'Maximum number of results',\n            },\n            offset: {\n              type: 'number',\n              description: 'Offset for pagination',\n            },\n          },\n        },\n      },\n    },\n\n    permission: { scope: 'always', riskLevel: 'low' },\n\n    execute: async (args: ListArgs, context?: ToolContext): Promise<ListResult> => {\n      const userId = context?.userId;\n      const s = resolveCustomToolStorage(storage, context);\n      const tools = await s.list(userId, {\n        search: args.search,\n        tags: args.tags,\n        category: args.category,\n        limit: args.limit,\n        offset: args.offset,\n      });\n\n      return { tools, total: tools.length };\n    },\n\n    describeCall: (args: ListArgs) => args.search ?? 'all tools',\n  };\n}\n\n/** Default custom_tool_list instance (resolves storage from StorageRegistry at execution time) */\nexport const customToolList = createCustomToolList();\n","/**\n * custom_tool_load - Loads a full custom tool definition from storage\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport type { ICustomToolStorage } from '../../domain/interfaces/ICustomToolStorage.js';\nimport type { CustomToolDefinition } from '../../domain/entities/CustomToolDefinition.js';\nimport { resolveCustomToolStorage } from './resolveStorage.js';\n\ninterface LoadArgs {\n  name: string;\n}\n\ninterface LoadResult {\n  success: boolean;\n  tool?: CustomToolDefinition;\n  error?: string;\n}\n\nexport function createCustomToolLoad(storage?: ICustomToolStorage): ToolFunction<LoadArgs, LoadResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'custom_tool_load',\n        description:\n          'Load a full custom tool definition from storage (including code). ' +\n          'Use this to inspect, modify, or hydrate a saved tool.',\n        parameters: {\n          type: 'object',\n          properties: {\n            name: {\n              type: 'string',\n              description: 'Name of the tool to load',\n            },\n          },\n          required: ['name'],\n        },\n      },\n    },\n\n    permission: { scope: 'always', riskLevel: 'low' },\n\n    execute: async (args: LoadArgs, context?: ToolContext): Promise<LoadResult> => {\n      const userId = context?.userId;\n      const s = resolveCustomToolStorage(storage, context);\n      const tool = await s.load(userId, args.name);\n      if (!tool) {\n        return { success: false, error: `Custom tool '${args.name}' not found` };\n      }\n      return { success: true, tool };\n    },\n\n    describeCall: (args: LoadArgs) => args.name,\n  };\n}\n\n/** Default custom_tool_load instance (resolves storage from StorageRegistry at execution time) */\nexport const customToolLoad = createCustomToolLoad();\n","/**\n * custom_tool_save - Persists a custom tool definition to storage\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport type { ICustomToolStorage } from '../../domain/interfaces/ICustomToolStorage.js';\nimport type { CustomToolDefinition } from '../../domain/entities/CustomToolDefinition.js';\nimport { CUSTOM_TOOL_DEFINITION_VERSION } from '../../domain/entities/CustomToolDefinition.js';\nimport { resolveCustomToolStorage } from './resolveStorage.js';\n\ninterface SaveArgs {\n  name: string;\n  description: string;\n  displayName?: string;\n  inputSchema: Record<string, unknown>;\n  outputSchema?: Record<string, unknown>;\n  code: string;\n  tags?: string[];\n  category?: string;\n  generationPrompt?: string;\n  connectorNames?: string[];\n}\n\ninterface SaveResult {\n  success: boolean;\n  name: string;\n  storagePath: string;\n  error?: string;\n}\n\nexport function createCustomToolSave(storage?: ICustomToolStorage): ToolFunction<SaveArgs, SaveResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'custom_tool_save',\n        description:\n          'Save a custom tool definition to persistent storage. ' +\n          'The tool can later be loaded, hydrated, and registered on any agent.',\n        parameters: {\n          type: 'object',\n          properties: {\n            name: {\n              type: 'string',\n              description: 'Tool name (must match /^[a-z][a-z0-9_]*$/)',\n            },\n            description: {\n              type: 'string',\n              description: 'What the tool does',\n            },\n            displayName: {\n              type: 'string',\n              description: 'Optional human-readable display name',\n            },\n            inputSchema: {\n              type: 'object',\n              description: 'JSON Schema for input parameters',\n            },\n            outputSchema: {\n              type: 'object',\n              description: 'Optional JSON Schema for output',\n            },\n            code: {\n              type: 'string',\n              description: 'JavaScript code (same sandbox as execute_javascript)',\n            },\n            tags: {\n              type: 'array',\n              description: 'Tags for categorization',\n              items: { type: 'string' },\n            },\n            category: {\n              type: 'string',\n              description: 'Category grouping',\n            },\n            generationPrompt: {\n              type: 'string',\n              description: 'The prompt that was used to generate this tool (for reference)',\n            },\n            connectorNames: {\n              type: 'array',\n              description: 'Connector names this tool uses',\n              items: { type: 'string' },\n            },\n          },\n          required: ['name', 'description', 'inputSchema', 'code'],\n        },\n      },\n    },\n\n    permission: { scope: 'session', riskLevel: 'medium' },\n\n    execute: async (args: SaveArgs, context?: ToolContext): Promise<SaveResult> => {\n      try {\n        const userId = context?.userId;\n        const s = resolveCustomToolStorage(storage, context);\n        const now = new Date().toISOString();\n\n        // Preserve createdAt if updating an existing tool\n        const existing = await s.load(userId, args.name);\n\n        const definition: CustomToolDefinition = {\n          version: CUSTOM_TOOL_DEFINITION_VERSION,\n          name: args.name,\n          displayName: args.displayName,\n          description: args.description,\n          inputSchema: args.inputSchema,\n          outputSchema: args.outputSchema,\n          code: args.code,\n          createdAt: existing?.createdAt ?? now,\n          updatedAt: now,\n          metadata: {\n            tags: args.tags,\n            category: args.category,\n            generationPrompt: args.generationPrompt,\n            connectorNames: args.connectorNames,\n            requiresConnector: (args.connectorNames?.length ?? 0) > 0,\n          },\n        };\n\n        await s.save(userId, definition);\n\n        return {\n          success: true,\n          name: args.name,\n          storagePath: s.getPath(userId),\n        };\n      } catch (error) {\n        return {\n          success: false,\n          name: args.name,\n          storagePath: resolveCustomToolStorage(storage, context).getPath(context?.userId),\n          error: (error as Error).message,\n        };\n      }\n    },\n\n    describeCall: (args: SaveArgs) => args.name,\n  };\n}\n\n/** Default custom_tool_save instance (resolves storage from StorageRegistry at execution time) */\nexport const customToolSave = createCustomToolSave();\n","/**\n * custom_tool_test - Executes custom tool code in the VM sandbox for testing\n *\n * Reuses executeInVM from the executeJavaScript tool.\n * Uses descriptionFactory to dynamically show available connectors.\n */\n\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport { executeInVM } from '../code/executeJavaScript.js';\nimport { Connector } from '../../core/Connector.js';\nimport { buildTestDescription } from './sandboxDescription.js';\n\ninterface TestArgs {\n  code: string;\n  inputSchema: Record<string, unknown>;\n  testInput: unknown;\n  connectorName?: string;\n  timeout?: number;\n}\n\ninterface TestResult {\n  success: boolean;\n  result: unknown;\n  logs: string[];\n  error?: string;\n  executionTime: number;\n}\n\nconst DEFAULT_TEST_TIMEOUT = 10000;\nconst MAX_TEST_TIMEOUT = 30000;\n\nexport function createCustomToolTest(): ToolFunction<TestArgs, TestResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'custom_tool_test',\n        description: 'Test custom tool code by executing it in the VM sandbox with provided test input.',\n        parameters: {\n          type: 'object',\n          properties: {\n            code: {\n              type: 'string',\n              description: 'JavaScript code to test. See tool description for full sandbox API reference.',\n            },\n            inputSchema: {\n              type: 'object',\n              description: 'The input schema (for documentation, not enforced at test time)',\n            },\n            testInput: {\n              description: 'Test input data  available as `input` in the code',\n            },\n            connectorName: {\n              type: 'string',\n              description: 'Optional connector name for authenticated API access',\n            },\n            timeout: {\n              type: 'number',\n              description: `Execution timeout in ms. Default: ${DEFAULT_TEST_TIMEOUT}, max: ${MAX_TEST_TIMEOUT}`,\n            },\n          },\n          required: ['code', 'inputSchema', 'testInput'],\n        },\n      },\n      timeout: MAX_TEST_TIMEOUT + 5000,\n    },\n\n    descriptionFactory: (context?: ToolContext) => buildTestDescription(context),\n\n    permission: { scope: 'session', riskLevel: 'medium' },\n\n    execute: async (args: TestArgs, context?: ToolContext): Promise<TestResult> => {\n      const logs: string[] = [];\n      const startTime = Date.now();\n      const timeout = Math.min(Math.max(args.timeout || DEFAULT_TEST_TIMEOUT, 0), MAX_TEST_TIMEOUT);\n\n      try {\n        const registry = context?.connectorRegistry ?? Connector.asRegistry();\n        const result = await executeInVM(\n          args.code,\n          args.testInput,\n          timeout,\n          logs,\n          context?.userId,\n          registry,\n        );\n\n        return {\n          success: true,\n          result,\n          logs,\n          executionTime: Date.now() - startTime,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          result: null,\n          logs,\n          error: (error as Error).message,\n          executionTime: Date.now() - startTime,\n        };\n      }\n    },\n\n    describeCall: (args: TestArgs) => `testing code (${args.code.length} chars)`,\n  };\n}\n\n/** Default custom_tool_test instance */\nexport const customToolTest = createCustomToolTest();\n","/**\n * Shared helper to resolve IRoutineDefinitionStorage for routine tools.\n *\n * Resolution order:\n * 1. Explicit storage passed to the factory function (backward compat)\n * 2. StorageRegistry factory called with StorageContext (multi-tenant)\n * 3. Default FileRoutineDefinitionStorage\n */\n\nimport type { IRoutineDefinitionStorage } from '../../domain/interfaces/IRoutineDefinitionStorage.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport { FileRoutineDefinitionStorage } from '../../infrastructure/storage/FileRoutineDefinitionStorage.js';\nimport { StorageRegistry } from '../../core/StorageRegistry.js';\nimport type { StorageContext } from '../../core/StorageRegistry.js';\n\n/**\n * Build a StorageContext from ToolContext (extracts userId).\n */\nfunction buildStorageContext(toolContext?: ToolContext): StorageContext | undefined {\n  const global = StorageRegistry.getContext();\n  if (global) return global;\n  if (toolContext?.userId) return { userId: toolContext.userId };\n  return undefined;\n}\n\n/**\n * Resolve routine definition storage.\n *\n * @param explicit - Storage instance passed to the factory (highest priority)\n * @param toolContext - ToolContext from execution (provides userId for multi-tenant)\n */\nexport function resolveRoutineDefinitionStorage(\n  explicit: IRoutineDefinitionStorage | undefined,\n  toolContext?: ToolContext,\n): IRoutineDefinitionStorage {\n  // 1. Explicit storage (backward compat)\n  if (explicit) return explicit;\n\n  // 2. Registry factory\n  const factory = StorageRegistry.get('routineDefinitions');\n  if (factory) {\n    return factory(buildStorageContext(toolContext));\n  }\n\n  // 3. Default\n  return new FileRoutineDefinitionStorage();\n}\n","/**\n * generate_routine - Generates and persists a complete RoutineDefinition from LLM output.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { ToolContext } from '../../domain/interfaces/IToolContext.js';\nimport type { IRoutineDefinitionStorage } from '../../domain/interfaces/IRoutineDefinitionStorage.js';\nimport type { RoutineDefinitionInput } from '../../domain/entities/Routine.js';\nimport { createRoutineDefinition } from '../../domain/entities/Routine.js';\nimport { resolveRoutineDefinitionStorage } from './resolveStorage.js';\n\ninterface GenerateRoutineArgs {\n  definition: RoutineDefinitionInput;\n}\n\ninterface GenerateRoutineResult {\n  success: boolean;\n  id?: string;\n  name?: string;\n  storagePath?: string;\n  error?: string;\n}\n\nconst TOOL_DESCRIPTION = `Generate and save a complete routine definition to persistent storage. A routine is a reusable, parameterized workflow template composed of tasks with dependencies, control flow, and validation.\n\n## Routine Structure\n\nA routine definition has these fields:\n- **name** (required): Human-readable name (e.g., \"Research and Summarize Topic\")\n- **description** (required): What this routine accomplishes\n- **version**: Semver string for tracking evolution (e.g., \"1.0.0\")\n- **author**: Creator name or identifier\n- **tags**: Array of strings for categorization and filtering (e.g., [\"research\", \"analysis\"])\n- **instructions**: Additional text injected into the agent's system prompt when executing this routine. Use for behavioral guidance, tone, constraints.\n- **parameters**: Array of input parameters that make the routine reusable. Each has: name, description, required (default false), default. Use {{param.NAME}} in task descriptions/expectedOutput to reference them.\n- **requiredTools**: Tool names that must be available before starting (e.g., [\"web_fetch\", \"memory_store\"])\n- **requiredPlugins**: Plugin names that must be enabled (e.g., [\"working_memory\"])\n- **concurrency**: { maxParallelTasks: number, strategy: \"fifo\"|\"priority\"|\"shortest-first\", failureMode?: \"fail-fast\"|\"continue\"|\"fail-all\" }\n- **allowDynamicTasks**: If true, the LLM can add/modify tasks during execution (default: false)\n- **tasks** (required): Array of TaskInput objects defining the workflow steps\n\n## Task Structure\n\nEach task in the tasks array has:\n- **name** (required): Unique name within the routine (used for dependency references)\n- **description** (required): What this task should accomplish  the agent uses this as its goal\n- **dependsOn**: Array of task names that must complete before this task starts (e.g., [\"Gather Data\", \"Validate Input\"])\n- **suggestedTools**: Tool names the agent should prefer for this task (advisory, not enforced)\n- **expectedOutput**: Description of what the task should produce  helps the agent know when it's done\n- **maxAttempts**: Max retry count on failure (default: 3)\n- **condition**: Execute only if a condition is met (see Conditions below)\n- **controlFlow**: Map, fold, or until loop (see Control Flow below)\n- **validation**: Completion validation settings (see Validation below)\n- **execution**: { parallel?: boolean, maxConcurrency?: number, priority?: number, maxIterations?: number }\n- **metadata**: Arbitrary key-value pairs for extensions\n\n## Control Flow Types\n\nTasks can have a controlFlow field for iteration patterns:\n\n### map  Iterate over an array, run sub-tasks per element\n\\`\\`\\`json\n{\n  \"type\": \"map\",\n  \"source\": { \"task\": \"Fetch Items\" },\n  \"tasks\": [\n    { \"name\": \"Process Item\", \"description\": \"Process {{map.item}} ({{map.index}}/{{map.total}})\" }\n  ],\n  \"resultKey\": \"processed_items\",\n  \"maxIterations\": 100,\n  \"iterationTimeoutMs\": 30000\n}\n\\`\\`\\`\n\n### fold  Accumulate a result across array elements\n\\`\\`\\`json\n{\n  \"type\": \"fold\",\n  \"source\": { \"key\": \"data_points\", \"path\": \"results\" },\n  \"tasks\": [\n    { \"name\": \"Merge Entry\", \"description\": \"Merge {{map.item}} into {{fold.accumulator}}\" }\n  ],\n  \"initialValue\": \"\",\n  \"resultKey\": \"merged_result\",\n  \"maxIterations\": 50\n}\n\\`\\`\\`\n\n### until  Loop until a condition is met\n\\`\\`\\`json\n{\n  \"type\": \"until\",\n  \"tasks\": [\n    { \"name\": \"Refine Draft\", \"description\": \"Improve the current draft based on feedback\" }\n  ],\n  \"condition\": { \"memoryKey\": \"quality_score\", \"operator\": \"greater_than\", \"value\": 80, \"onFalse\": \"skip\" },\n  \"maxIterations\": 5,\n  \"iterationKey\": \"refinement_round\"\n}\n\\`\\`\\`\n\n### Source field\nThe \\`source\\` field in map/fold can be:\n- A string: direct memory key lookup (e.g., \"my_items\")\n- \\`{ task: \"TaskName\" }\\`: resolves the output of a completed dependency task\n- \\`{ key: \"memoryKey\" }\\`: direct memory key lookup\n- \\`{ key: \"memoryKey\", path: \"data.items\" }\\`: memory key with JSON path extraction\n\n### Sub-routine tasks\nTasks inside controlFlow.tasks have the same shape as regular tasks (name, description, dependsOn, suggestedTools, etc.) but execute within the control flow context.\n\n## Template Placeholders\n\nUse these in task descriptions and expectedOutput:\n- \\`{{param.NAME}}\\`  routine parameter value\n- \\`{{map.item}}\\`  current element in map/fold iteration\n- \\`{{map.index}}\\`  current 0-based iteration index\n- \\`{{map.total}}\\`  total number of elements\n- \\`{{fold.accumulator}}\\`  current accumulated value in fold\n\n## Task Conditions\n\nExecute a task conditionally based on memory state:\n\\`\\`\\`json\n{\n  \"memoryKey\": \"user_preference\",\n  \"operator\": \"equals\",\n  \"value\": \"detailed\",\n  \"onFalse\": \"skip\"\n}\n\\`\\`\\`\n\nOperators: \"exists\", \"not_exists\", \"equals\", \"contains\", \"truthy\", \"greater_than\", \"less_than\"\nonFalse actions: \"skip\" (mark skipped), \"fail\" (mark failed), \"wait\" (block until condition met)\n\n## Validation\n\nEnable completion validation to verify task quality:\n\\`\\`\\`json\n{\n  \"skipReflection\": false,\n  \"completionCriteria\": [\n    \"Response contains at least 3 specific examples\",\n    \"All requested sections are present\"\n  ],\n  \"minCompletionScore\": 80,\n  \"requiredMemoryKeys\": [\"result_data\"],\n  \"mode\": \"strict\"\n}\n\\`\\`\\`\n\nBy default, skipReflection is true (validation auto-passes). Set to false and provide completionCriteria to enable LLM self-reflection validation.\n\n## Best Practices\n\n1. **Task naming**: Use clear, action-oriented names (e.g., \"Research Topic\", \"Generate Summary\"). Names are used in dependsOn references.\n2. **Dependency chaining**: Build pipelines by having each task depend on the previous one. Independent tasks can run in parallel.\n3. **Control flow vs sequential**: Use map/fold when iterating over dynamic data. Use sequential tasks for fixed multi-step workflows.\n4. **Parameters**: Define parameters for any value that should vary between executions. Always provide a description.\n5. **Instructions**: Use the instructions field for behavioral guidance that applies to all tasks in the routine.\n6. **Keep tasks focused**: Each task should have a single clear goal. Break complex work into multiple dependent tasks.\n7. **Expected output**: Always specify expectedOutput  it helps the agent know when it's done and what format to produce.`;\n\nexport function createGenerateRoutine(storage?: IRoutineDefinitionStorage): ToolFunction<GenerateRoutineArgs, GenerateRoutineResult> {\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: 'generate_routine',\n        description: TOOL_DESCRIPTION,\n        parameters: {\n          type: 'object',\n          properties: {\n            definition: {\n              type: 'object',\n              description: 'Complete routine definition input',\n              properties: {\n                name: { type: 'string', description: 'Human-readable routine name' },\n                description: { type: 'string', description: 'What this routine accomplishes' },\n                version: { type: 'string', description: 'Semver version string (e.g., \"1.0.0\")' },\n                author: { type: 'string', description: 'Creator name or identifier' },\n                tags: { type: 'array', items: { type: 'string' }, description: 'Tags for categorization' },\n                instructions: { type: 'string', description: 'Additional instructions injected into system prompt during execution' },\n                parameters: {\n                  type: 'array',\n                  description: 'Input parameters for reusable routines',\n                  items: {\n                    type: 'object',\n                    properties: {\n                      name: { type: 'string', description: 'Parameter name (referenced as {{param.name}})' },\n                      description: { type: 'string', description: 'Human-readable description' },\n                      required: { type: 'boolean', description: 'Whether this parameter must be provided (default: false)' },\n                      default: { description: 'Default value when not provided' },\n                    },\n                    required: ['name', 'description'],\n                  },\n                },\n                requiredTools: { type: 'array', items: { type: 'string' }, description: 'Tool names that must be available' },\n                requiredPlugins: { type: 'array', items: { type: 'string' }, description: 'Plugin names that must be enabled' },\n                concurrency: {\n                  type: 'object',\n                  description: 'Concurrency settings for parallel task execution',\n                  properties: {\n                    maxParallelTasks: { type: 'number', description: 'Maximum tasks running in parallel' },\n                    strategy: { type: 'string', enum: ['fifo', 'priority', 'shortest-first'], description: 'Task selection strategy' },\n                    failureMode: { type: 'string', enum: ['fail-fast', 'continue', 'fail-all'], description: 'How to handle failures in parallel' },\n                  },\n                  required: ['maxParallelTasks', 'strategy'],\n                },\n                allowDynamicTasks: { type: 'boolean', description: 'Allow LLM to add/modify tasks during execution (default: false)' },\n                tasks: {\n                  type: 'array',\n                  description: 'Array of task definitions forming the workflow',\n                  items: {\n                    type: 'object',\n                    properties: {\n                      name: { type: 'string', description: 'Unique task name (used in dependsOn references)' },\n                      description: { type: 'string', description: 'What this task should accomplish' },\n                      dependsOn: { type: 'array', items: { type: 'string' }, description: 'Task names that must complete first' },\n                      suggestedTools: { type: 'array', items: { type: 'string' }, description: 'Preferred tool names for this task' },\n                      expectedOutput: { type: 'string', description: 'Description of expected task output' },\n                      maxAttempts: { type: 'number', description: 'Max retries on failure (default: 3)' },\n                      condition: {\n                        type: 'object',\n                        description: 'Conditional execution based on memory state',\n                        properties: {\n                          memoryKey: { type: 'string', description: 'Memory key to check' },\n                          operator: { type: 'string', enum: ['exists', 'not_exists', 'equals', 'contains', 'truthy', 'greater_than', 'less_than'] },\n                          value: { description: 'Value to compare against' },\n                          onFalse: { type: 'string', enum: ['skip', 'fail', 'wait'], description: 'Action when condition is false' },\n                        },\n                        required: ['memoryKey', 'operator', 'onFalse'],\n                      },\n                      controlFlow: {\n                        type: 'object',\n                        description: 'Control flow for iteration (map, fold, or until)',\n                        properties: {\n                          type: { type: 'string', enum: ['map', 'fold', 'until'], description: 'Control flow type' },\n                          source: { description: 'Source data: string key, { task: \"name\" }, { key: \"key\" }, or { key: \"key\", path: \"json.path\" }' },\n                          tasks: { type: 'array', description: 'Sub-routine tasks to execute per iteration', items: { type: 'object' } },\n                          resultKey: { type: 'string', description: 'Memory key for collected results' },\n                          initialValue: { description: 'Starting accumulator value (fold only)' },\n                          condition: { type: 'object', description: 'Exit condition (until only)' },\n                          maxIterations: { type: 'number', description: 'Cap on iterations' },\n                          iterationKey: { type: 'string', description: 'Memory key for iteration index (until only)' },\n                          iterationTimeoutMs: { type: 'number', description: 'Timeout per iteration in ms' },\n                        },\n                        required: ['type', 'tasks'],\n                      },\n                      validation: {\n                        type: 'object',\n                        description: 'Completion validation settings',\n                        properties: {\n                          skipReflection: { type: 'boolean', description: 'Set to false to enable LLM self-reflection validation' },\n                          completionCriteria: { type: 'array', items: { type: 'string' }, description: 'Natural language criteria for completion' },\n                          minCompletionScore: { type: 'number', description: 'Minimum score (0-100) to pass (default: 80)' },\n                          requiredMemoryKeys: { type: 'array', items: { type: 'string' }, description: 'Memory keys that must exist after completion' },\n                          mode: { type: 'string', enum: ['strict', 'warn'], description: 'Validation failure mode (default: strict)' },\n                          requireUserApproval: { type: 'string', enum: ['never', 'uncertain', 'always'], description: 'When to ask user for approval' },\n                          customValidator: { type: 'string', description: 'Custom validation hook name' },\n                        },\n                      },\n                      execution: {\n                        type: 'object',\n                        description: 'Execution settings',\n                        properties: {\n                          parallel: { type: 'boolean', description: 'Can run in parallel with other parallel tasks' },\n                          maxConcurrency: { type: 'number', description: 'Max concurrent sub-work' },\n                          priority: { type: 'number', description: 'Higher = executed first' },\n                          maxIterations: { type: 'number', description: 'Max LLM iterations per task (default: 50)' },\n                        },\n                      },\n                      metadata: { type: 'object', description: 'Arbitrary key-value metadata' },\n                    },\n                    required: ['name', 'description'],\n                  },\n                },\n                metadata: { type: 'object', description: 'Arbitrary routine-level metadata' },\n              },\n              required: ['name', 'description', 'tasks'],\n            },\n          },\n          required: ['definition'],\n        },\n      },\n    },\n\n    permission: { scope: 'session', riskLevel: 'medium' },\n\n    execute: async (args: GenerateRoutineArgs, context?: ToolContext): Promise<GenerateRoutineResult> => {\n      try {\n        const userId = context?.userId;\n        const s = resolveRoutineDefinitionStorage(storage, context);\n\n        // Validate and create the routine definition (checks deps + cycles)\n        const routineDefinition = createRoutineDefinition(args.definition);\n\n        // Persist to storage\n        await s.save(userId, routineDefinition);\n\n        return {\n          success: true,\n          id: routineDefinition.id,\n          name: routineDefinition.name,\n          storagePath: s.getPath(userId),\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: (error as Error).message,\n        };\n      }\n    },\n\n    describeCall: (args: GenerateRoutineArgs) => args.definition?.name ?? 'routine',\n  };\n}\n\n/** Default generate_routine instance (resolves storage from StorageRegistry at execution time) */\nexport const generateRoutine = createGenerateRoutine();\n","/**\n * AUTO-GENERATED FILE - DO NOT EDIT MANUALLY\n *\n * Generated by: scripts/generate-tool-registry.ts\n * Generated at: 2026-02-26T21:14:43.537Z\n *\n * To regenerate: npm run generate:tools\n */\n\nimport type { ToolFunction } from '../domain/entities/Tool.js';\n\nimport { executeJavaScript } from './code/executeJavaScript.js';\nimport { customToolDelete } from './custom-tools/customToolDelete.js';\nimport { customToolDraft } from './custom-tools/customToolDraft.js';\nimport { customToolList } from './custom-tools/customToolList.js';\nimport { customToolLoad } from './custom-tools/customToolLoad.js';\nimport { customToolSave } from './custom-tools/customToolSave.js';\nimport { customToolTest } from './custom-tools/customToolTest.js';\nimport { desktopGetCursor } from './desktop/getCursor.js';\nimport { desktopGetScreenSize } from './desktop/getScreenSize.js';\nimport { desktopKeyboardKey } from './desktop/keyboardKey.js';\nimport { desktopKeyboardType } from './desktop/keyboardType.js';\nimport { desktopMouseClick } from './desktop/mouseClick.js';\nimport { desktopMouseDrag } from './desktop/mouseDrag.js';\nimport { desktopMouseMove } from './desktop/mouseMove.js';\nimport { desktopMouseScroll } from './desktop/mouseScroll.js';\nimport { desktopScreenshot } from './desktop/screenshot.js';\nimport { desktopWindowFocus } from './desktop/windowFocus.js';\nimport { desktopWindowList } from './desktop/windowList.js';\nimport { editFile } from './filesystem/editFile.js';\nimport { glob } from './filesystem/glob.js';\nimport { grep } from './filesystem/grep.js';\nimport { listDirectory } from './filesystem/listDirectory.js';\nimport { readFile } from './filesystem/readFile.js';\nimport { writeFile } from './filesystem/writeFile.js';\nimport { jsonManipulator } from './json/jsonManipulator.js';\nimport { generateRoutine } from './routines/generateRoutine.js';\nimport { bash } from './shell/bash.js';\nimport { webFetch } from './web/webFetch.js';\n\n/** Tool category for grouping */\nexport type ToolCategory = 'filesystem' | 'shell' | 'web' | 'code' | 'json' | 'connector' | 'desktop' | 'custom-tools' | 'routines' | 'other';\n\n/** Metadata for a tool in the registry */\nexport interface ToolRegistryEntry {\n  /** Tool name (matches definition.function.name) */\n  name: string;\n  /** Export variable name */\n  exportName: string;\n  /** Human-readable display name */\n  displayName: string;\n  /** Category for grouping */\n  category: ToolCategory;\n  /** Brief description */\n  description: string;\n  /** The actual tool function */\n  tool: ToolFunction;\n  /** Whether this tool is safe without explicit approval */\n  safeByDefault: boolean;\n  /** Whether this tool requires a connector */\n  requiresConnector?: boolean;\n  /** Supported connector service types (if requiresConnector) */\n  connectorServiceTypes?: string[];\n}\n\n/** Complete registry of all built-in tools */\nexport const toolRegistry: ToolRegistryEntry[] = [\n  {\n    name: 'execute_javascript',\n    exportName: 'executeJavaScript',\n    displayName: 'Execute Javascript',\n    category: 'code',\n    description: \"Execute JavaScript code in a secure sandbox with authenticated API access via connectors.\",\n    tool: executeJavaScript,\n    safeByDefault: false,\n  },\n  {\n    name: 'custom_tool_delete',\n    exportName: 'customToolDelete',\n    displayName: 'Custom Tool Delete',\n    category: 'custom-tools',\n    description: \"Delete a custom tool from persistent storage.\",\n    tool: customToolDelete,\n    safeByDefault: false,\n  },\n  {\n    name: 'custom_tool_draft',\n    exportName: 'customToolDraft',\n    displayName: 'Custom Tool Draft',\n    category: 'custom-tools',\n    description: \"Validate a draft custom tool definition. Checks name format, schema structure, and code syntax.\",\n    tool: customToolDraft,\n    safeByDefault: true,\n  },\n  {\n    name: 'custom_tool_list',\n    exportName: 'customToolList',\n    displayName: 'Custom Tool List',\n    category: 'custom-tools',\n    description: \"List saved custom tools from persistent storage. Supports filtering by search text, tags, and category.\",\n    tool: customToolList,\n    safeByDefault: true,\n  },\n  {\n    name: 'custom_tool_load',\n    exportName: 'customToolLoad',\n    displayName: 'Custom Tool Load',\n    category: 'custom-tools',\n    description: \"Load a full custom tool definition from storage (including code).\",\n    tool: customToolLoad,\n    safeByDefault: true,\n  },\n  {\n    name: 'custom_tool_save',\n    exportName: 'customToolSave',\n    displayName: 'Custom Tool Save',\n    category: 'custom-tools',\n    description: \"Save a custom tool definition to persistent storage.\",\n    tool: customToolSave,\n    safeByDefault: false,\n  },\n  {\n    name: 'custom_tool_test',\n    exportName: 'customToolTest',\n    displayName: 'Custom Tool Test',\n    category: 'custom-tools',\n    description: \"Test custom tool code by executing it in the VM sandbox with provided test input.\",\n    tool: customToolTest,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_get_cursor',\n    exportName: 'desktopGetCursor',\n    displayName: 'Desktop Get Cursor',\n    category: 'desktop',\n    description: \"Get the current mouse cursor position in screenshot pixel coordinates.\",\n    tool: desktopGetCursor,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_get_screen_size',\n    exportName: 'desktopGetScreenSize',\n    displayName: 'Desktop Get Screen Size',\n    category: 'desktop',\n    description: \"Get the screen dimensions. Returns physical pixel size (screenshot space), logical size (OS coordinates), and the scale factor (e.g., 2.0 on Retina displays). All desktop tool coordinates use physical\",\n    tool: desktopGetScreenSize,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_keyboard_key',\n    exportName: 'desktopKeyboardKey',\n    displayName: 'Desktop Keyboard Key',\n    category: 'desktop',\n    description: \"Press a keyboard shortcut or special key. Use \\\"+\\\" to combine keys (e.g., \\\"ctrl+c\\\", \\\"cmd+shift+s\\\", \\\"enter\\\", \\\"tab\\\", \\\"escape\\\"). Modifiers: ctrl, cmd/command, alt/option, shift. Special keys: enter, tab, \",\n    tool: desktopKeyboardKey,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_keyboard_type',\n    exportName: 'desktopKeyboardType',\n    displayName: 'Desktop Keyboard Type',\n    category: 'desktop',\n    description: \"Type text using the keyboard. Each character is typed as a keypress. Use this for entering text into focused input fields.\",\n    tool: desktopKeyboardType,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_mouse_click',\n    exportName: 'desktopMouseClick',\n    displayName: 'Desktop Mouse Click',\n    category: 'desktop',\n    description: \"Click the mouse at the specified position or at the current cursor position. Supports left/right/middle button and single/double/triple click.\",\n    tool: desktopMouseClick,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_mouse_drag',\n    exportName: 'desktopMouseDrag',\n    displayName: 'Desktop Mouse Drag',\n    category: 'desktop',\n    description: \"Drag the mouse from one position to another. Presses the button at the start position, moves to the end position, then releases.\",\n    tool: desktopMouseDrag,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_mouse_move',\n    exportName: 'desktopMouseMove',\n    displayName: 'Desktop Mouse Move',\n    category: 'desktop',\n    description: \"Move the mouse cursor to the specified (x, y) position. Coordinates are in screenshot pixel space (full screen). Returns the actual cursor position after the move for verification.\",\n    tool: desktopMouseMove,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_mouse_scroll',\n    exportName: 'desktopMouseScroll',\n    displayName: 'Desktop Mouse Scroll',\n    category: 'desktop',\n    description: \"Scroll the mouse wheel. Positive deltaY scrolls down, negative scrolls up. Positive deltaX scrolls right, negative scrolls left. Optionally specify position to scroll at.\",\n    tool: desktopMouseScroll,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_screenshot',\n    exportName: 'desktopScreenshot',\n    displayName: 'Desktop Screenshot',\n    category: 'desktop',\n    description: \"Take a screenshot of the entire screen or a specific region. Returns the screenshot image for visual analysis. Use this to see what's on screen before performing actions. IMPORTANT: If you capture a r\",\n    tool: desktopScreenshot,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_window_focus',\n    exportName: 'desktopWindowFocus',\n    displayName: 'Desktop Window Focus',\n    category: 'desktop',\n    description: \"Focus (bring to front) a window by its ID. Use desktop_window_list to get available window IDs.\",\n    tool: desktopWindowFocus,\n    safeByDefault: false,\n  },\n  {\n    name: 'desktop_window_list',\n    exportName: 'desktopWindowList',\n    displayName: 'Desktop Window List',\n    category: 'desktop',\n    description: \"List all visible windows on the desktop. Returns window IDs, titles, application names, and bounds. Use the window ID with desktop_window_focus to bring a window to the foreground.\",\n    tool: desktopWindowList,\n    safeByDefault: false,\n  },\n  {\n    name: 'edit_file',\n    exportName: 'editFile',\n    displayName: 'Edit File',\n    category: 'filesystem',\n    description: \"Perform exact string replacements in files.\",\n    tool: editFile,\n    safeByDefault: false,\n  },\n  {\n    name: 'glob',\n    exportName: 'glob',\n    displayName: 'Glob',\n    category: 'filesystem',\n    description: \"Fast file pattern matching tool that finds files by name patterns.\",\n    tool: glob,\n    safeByDefault: true,\n  },\n  {\n    name: 'grep',\n    exportName: 'grep',\n    displayName: 'Grep',\n    category: 'filesystem',\n    description: \"A powerful search tool for finding content within files.\",\n    tool: grep,\n    safeByDefault: true,\n  },\n  {\n    name: 'list_directory',\n    exportName: 'listDirectory',\n    displayName: 'List Directory',\n    category: 'filesystem',\n    description: \"List the contents of a directory on the local filesystem.\",\n    tool: listDirectory,\n    safeByDefault: true,\n  },\n  {\n    name: 'read_file',\n    exportName: 'readFile',\n    displayName: 'Read File',\n    category: 'filesystem',\n    description: \"Read content from a file on the local filesystem. Supports text files AND binary document formats  PDF, DOCX, PPTX, XLSX, ODS, ODT, ODP, and images (PNG, JPG, GIF, WEBP) are automatically converted t\",\n    tool: readFile,\n    safeByDefault: true,\n  },\n  {\n    name: 'write_file',\n    exportName: 'writeFile',\n    displayName: 'Write File',\n    category: 'filesystem',\n    description: \"Write content to a file on the local filesystem.\",\n    tool: writeFile,\n    safeByDefault: false,\n  },\n  {\n    name: 'json_manipulate',\n    exportName: 'jsonManipulator',\n    displayName: 'Json Manipulate',\n    category: 'json',\n    description: \"Manipulate JSON objects by deleting, adding, or replacing fields at any depth.\",\n    tool: jsonManipulator,\n    safeByDefault: true,\n  },\n  {\n    name: 'generate_routine',\n    exportName: 'generateRoutine',\n    displayName: 'Generate Routine',\n    category: 'routines',\n    description: \"Complete routine definition input\",\n    tool: generateRoutine,\n    safeByDefault: false,\n  },\n  {\n    name: 'bash',\n    exportName: 'bash',\n    displayName: 'Bash',\n    category: 'shell',\n    description: \"Execute shell commands with optional timeout.\",\n    tool: bash,\n    safeByDefault: false,\n  },\n  {\n    name: 'web_fetch',\n    exportName: 'webFetch',\n    displayName: 'Web Fetch',\n    category: 'web',\n    description: \"Fetch and extract content from a URL  works with web pages AND document files (PDF, DOCX, XLSX, PPTX, etc.). Document URLs are automatically detected and converted to markdown text.\",\n    tool: webFetch,\n    safeByDefault: true,\n  }\n];\n\n/** Get all built-in tools as ToolFunction array */\nexport function getAllBuiltInTools(): ToolFunction[] {\n  return toolRegistry.map((entry) => entry.tool);\n}\n\n/** Get full tool registry with metadata */\nexport function getToolRegistry(): ToolRegistryEntry[] {\n  return [...toolRegistry];\n}\n\n/** Get tools by category */\nexport function getToolsByCategory(category: ToolCategory): ToolRegistryEntry[] {\n  return toolRegistry.filter((entry) => entry.category === category);\n}\n\n/** Get tool by name */\nexport function getToolByName(name: string): ToolRegistryEntry | undefined {\n  return toolRegistry.find((entry) => entry.name === name);\n}\n\n/** Get tools that require connector configuration */\nexport function getToolsRequiringConnector(): ToolRegistryEntry[] {\n  return toolRegistry.filter((entry) => entry.requiresConnector);\n}\n\n/** Get all unique category names */\nexport function getToolCategories(): ToolCategory[] {\n  return [...new Set(toolRegistry.map((entry) => entry.category))];\n}\n","/**\n * Factory functions for creating custom tool meta-tools.\n *\n * Individual factories for each tool, plus a bundle factory\n * that creates all 6 tools at once.\n */\n\nimport type { ToolFunction } from '../../domain/entities/Tool.js';\nimport type { ICustomToolStorage } from '../../domain/interfaces/ICustomToolStorage.js';\nimport { createCustomToolDraft } from './customToolDraft.js';\nimport { createCustomToolTest } from './customToolTest.js';\nimport { createCustomToolSave } from './customToolSave.js';\nimport { createCustomToolList } from './customToolList.js';\nimport { createCustomToolLoad } from './customToolLoad.js';\nimport { createCustomToolDelete } from './customToolDelete.js';\n\nexport interface CustomToolMetaToolsOptions {\n  /** Custom storage backend. Default: FileCustomToolStorage */\n  storage?: ICustomToolStorage;\n}\n\n/**\n * Create all 6 custom tool meta-tools as an array.\n *\n * @example\n * ```typescript\n * const agent = Agent.create({\n *   connector: 'openai',\n *   model: 'gpt-4',\n *   tools: [\n *     ...createCustomToolMetaTools(),\n *     ...otherTools,\n *   ],\n * });\n * ```\n */\nexport function createCustomToolMetaTools(options?: CustomToolMetaToolsOptions): ToolFunction[] {\n  // When explicit storage is provided, pass it to each factory.\n  // Otherwise, let each factory resolve from StorageRegistry at execution time.\n  const storage = options?.storage;\n\n  return [\n    createCustomToolDraft(),\n    createCustomToolTest(),\n    createCustomToolSave(storage),\n    createCustomToolList(storage),\n    createCustomToolLoad(storage),\n    createCustomToolDelete(storage),\n  ];\n}\n\n// Re-export individual factories for selective use\nexport {\n  createCustomToolDraft,\n  createCustomToolTest,\n  createCustomToolSave,\n  createCustomToolList,\n  createCustomToolLoad,\n  createCustomToolDelete,\n};\n","/**\n * hydrateCustomTool - Converts a CustomToolDefinition into a live ToolFunction\n *\n * The hydrated tool is indistinguishable from built-in tools once\n * registered on ToolManager.\n */\n\nimport type { ToolFunction, ToolContext } from '../../domain/entities/Tool.js';\nimport type { CustomToolDefinition } from '../../domain/entities/CustomToolDefinition.js';\nimport { executeInVM } from '../code/executeJavaScript.js';\nimport { Connector } from '../../core/Connector.js';\n\nconst DEFAULT_TIMEOUT = 10000;\nconst MAX_TIMEOUT = 30000;\n\nexport interface HydrateOptions {\n  /** Default execution timeout in ms. Default: 10000 */\n  defaultTimeout?: number;\n  /** Maximum execution timeout in ms. Default: 30000 */\n  maxTimeout?: number;\n}\n\n/**\n * Convert a stored CustomToolDefinition into an executable ToolFunction.\n *\n * The resulting ToolFunction:\n * - Executes the definition's code through executeInVM\n * - Has input args passed as `input` in the VM sandbox\n * - Gets connector registry from ToolContext for authenticatedFetch\n * - Has session-scoped permission with medium risk level\n */\nexport function hydrateCustomTool(\n  definition: CustomToolDefinition,\n  options?: HydrateOptions,\n): ToolFunction {\n  const defaultTimeout = options?.defaultTimeout ?? DEFAULT_TIMEOUT;\n  const maxTimeout = options?.maxTimeout ?? MAX_TIMEOUT;\n\n  return {\n    definition: {\n      type: 'function',\n      function: {\n        name: definition.name,\n        description: definition.description,\n        parameters: definition.inputSchema as any,\n      },\n      timeout: maxTimeout + 5000,\n    },\n\n    permission: { scope: 'session', riskLevel: 'medium' },\n\n    execute: async (args: any, context?: ToolContext): Promise<any> => {\n      const logs: string[] = [];\n      const registry = context?.connectorRegistry ?? Connector.asRegistry();\n\n      const result = await executeInVM(\n        definition.code,\n        args,\n        defaultTimeout,\n        logs,\n        context?.userId,\n        registry,\n      );\n\n      return result;\n    },\n\n    describeCall: (args: any) => {\n      // Show first meaningful arg value\n      if (!args || typeof args !== 'object') return definition.name;\n      const firstKey = Object.keys(args)[0];\n      if (!firstKey) return definition.name;\n      const val = args[firstKey];\n      const str = typeof val === 'string' ? val : JSON.stringify(val);\n      return str.length > 50 ? str.slice(0, 47) + '...' : str;\n    },\n  };\n}\n","/**\n * ToolRegistry - Unified registry for all tools (built-in + connector-generated)\n *\n * This class provides a single API for discovering all available tools:\n * - Built-in tools from registry.generated.ts (filesystem, shell, web, etc.)\n * - Connector tools generated at runtime by ConnectorTools\n *\n * @example\n * ```typescript\n * import { ToolRegistry } from '@everworker/oneringai';\n *\n * // Get all tools (built-in + connector)\n * const allTools = ToolRegistry.getAllTools();\n *\n * // Get only connector tools\n * const connectorTools = ToolRegistry.getAllConnectorTools();\n *\n * // Get tools for a specific connector\n * const githubTools = ToolRegistry.getConnectorTools('github');\n * ```\n */\n\nimport type { ToolFunction } from '../domain/entities/Tool.js';\nimport { toolRegistry, type ToolRegistryEntry, type ToolCategory } from './registry.generated.js';\nimport { ConnectorTools } from './connector/ConnectorTools.js';\nimport { Connector } from '../core/Connector.js';\nimport { getServiceInfo } from '../domain/entities/Services.js';\nimport { getVendorInfo } from '../connectors/vendors/helpers.js';\n\n/**\n * Extended registry entry for connector-generated tools\n */\nexport interface ConnectorToolEntry extends ToolRegistryEntry {\n  /** Name of the connector that generated this tool */\n  connectorName: string;\n  /** Service type (e.g., 'github', 'slack') if detected */\n  serviceType?: string;\n}\n\n/**\n * Unified tool registry that combines built-in and connector tools\n */\nexport class ToolRegistry {\n  /**\n   * Get built-in tools only (from registry.generated.ts)\n   *\n   * @returns Array of built-in tool registry entries\n   */\n  static getBuiltInTools(): ToolRegistryEntry[] {\n    return [...toolRegistry];\n  }\n\n  /**\n   * Get tools for a specific connector\n   *\n   * @param connectorName - Name of the connector to get tools for\n   * @returns Array of connector tool entries\n   *\n   * @example\n   * ```typescript\n   * const githubTools = ToolRegistry.getConnectorTools('github');\n   * ```\n   */\n  static getConnectorTools(connectorName: string): ConnectorToolEntry[] {\n    try {\n      const tools = ConnectorTools.for(connectorName);\n      return tools.map((tool) => this.toRegistryEntry(tool, connectorName));\n    } catch {\n      // Connector may not exist or may not have tools\n      return [];\n    }\n  }\n\n  /**\n   * Get all connector tools from all registered service connectors\n   *\n   * This discovers tools from all connectors that have:\n   * - Explicit serviceType, OR\n   * - baseURL but no vendor (external API, not AI provider)\n   *\n   * @returns Array of all connector tool entries\n   */\n  static getAllConnectorTools(): ConnectorToolEntry[] {\n    const allTools: ConnectorToolEntry[] = [];\n    const discovered = ConnectorTools.discoverAll();\n\n    for (const [connectorName, tools] of discovered) {\n      for (const tool of tools) {\n        allTools.push(this.toRegistryEntry(tool, connectorName));\n      }\n    }\n    return allTools;\n  }\n\n  /**\n   * Get ALL tools (built-in + connector) - main API for UIs\n   *\n   * This is the primary method for getting a complete list of available tools.\n   *\n   * @returns Array of all tool registry entries (built-in and connector)\n   *\n   * @example\n   * ```typescript\n   * const allTools = ToolRegistry.getAllTools();\n   * for (const tool of allTools) {\n   *   console.log(`${tool.displayName}: ${tool.description}`);\n   * }\n   * ```\n   */\n  static getAllTools(): (ToolRegistryEntry | ConnectorToolEntry)[] {\n    return [...this.getBuiltInTools(), ...this.getAllConnectorTools()];\n  }\n\n  /**\n   * Get tools filtered by service type\n   *\n   * @param serviceType - Service type to filter by (e.g., 'github', 'slack')\n   * @returns Array of connector tool entries for the service\n   */\n  static getToolsByService(serviceType: string): ConnectorToolEntry[] {\n    return this.getAllConnectorTools().filter((entry) => entry.serviceType === serviceType);\n  }\n\n  /**\n   * Get tools filtered by connector name\n   *\n   * @param connectorName - Connector name to filter by\n   * @returns Array of connector tool entries for the connector\n   */\n  static getToolsByConnector(connectorName: string): ConnectorToolEntry[] {\n    return this.getAllConnectorTools().filter((entry) => entry.connectorName === connectorName);\n  }\n\n  /**\n   * Check if a tool entry is a connector tool\n   *\n   * @param entry - Tool registry entry to check\n   * @returns True if the entry is a connector tool\n   */\n  static isConnectorTool(entry: ToolRegistryEntry | ConnectorToolEntry): entry is ConnectorToolEntry {\n    return 'connectorName' in entry && typeof entry.connectorName === 'string';\n  }\n\n  /**\n   * Convert a ToolFunction to a ConnectorToolEntry\n   */\n  private static toRegistryEntry(tool: ToolFunction, connectorName: string): ConnectorToolEntry {\n    let serviceType: string | undefined;\n    let displayPrefix: string | undefined;\n\n    try {\n      const connector = Connector.get(connectorName);\n      serviceType = ConnectorTools.detectService(connector);\n      if (connector.vendor) {\n        const vendorInfo = getVendorInfo(connector.vendor);\n        displayPrefix = vendorInfo?.name || connector.vendor;\n      }\n    } catch {\n      // Connector may not exist\n    }\n\n    const serviceInfo = serviceType ? getServiceInfo(serviceType) : undefined;\n    const displayContext = displayPrefix || serviceInfo?.name;\n    const def = tool.definition.function;\n\n    return {\n      name: def.name,\n      exportName: def.name,\n      displayName: this.deriveDisplayName(def.name, displayContext, connectorName),\n      category: 'connector' as ToolCategory,\n      description: def.description || `API tool for ${connectorName}`,\n      tool,\n      safeByDefault: false,\n      requiresConnector: true,\n      connectorServiceTypes: serviceType ? [serviceType] : undefined,\n      connectorName,\n      serviceType,\n    };\n  }\n\n  /**\n   * Derive a human-readable display name from a tool name\n   *\n   * @param toolName - Full tool name (e.g., \"main-openai_generate_image\")\n   * @param contextName - Vendor or service display name (e.g., \"OpenAI\")\n   * @param connectorName - Connector name used as prefix (e.g., \"main-openai\")\n   */\n  private static deriveDisplayName(\n    toolName: string,\n    contextName?: string,\n    connectorName?: string\n  ): string {\n    // Strip connector name prefix if present\n    let baseName = toolName;\n    if (connectorName && toolName.startsWith(connectorName + '_')) {\n      baseName = toolName.slice(connectorName.length + 1);\n    }\n\n    // \"api\"  \"Context API\"\n    if (baseName === 'api') {\n      return contextName ? `${contextName} API` : toolName.replace(/_/g, ' ');\n    }\n\n    // Convert base to Title Case\n    const readable = baseName\n      .split('_')\n      .map((w) => w.charAt(0).toUpperCase() + w.slice(1))\n      .join(' ');\n\n    return contextName ? `${contextName} ${readable}` : readable;\n  }\n}\n","/**\n * Provider Config Agent\n *\n * AI-powered agent that helps users configure OAuth providers\n * Asks questions, guides setup, and generates JSON configuration\n */\n\nimport { Agent } from '../core/Agent.js';\nimport { MessageBuilder } from '../utils/messageBuilder.js';\nimport { InputItem } from '../domain/entities/Message.js';\nimport { ConnectorConfigResult } from '../domain/entities/Connector.js';\n\n/**\n * Built-in agent for generating OAuth provider configurations\n */\nexport class ProviderConfigAgent {\n  private agent: Agent | null = null;\n  private conversationHistory: InputItem[] = [];\n  private connectorName: string;\n\n  /**\n   * Create a provider config agent\n   * @param connectorName - Name of the connector to use (must be created first with Connector.create())\n   */\n  constructor(connectorName: string = 'openai') {\n    this.connectorName = connectorName;\n  }\n\n  /**\n   * Start interactive configuration session\n   * AI will ask questions and generate the connector config\n   *\n   * @param initialInput - Optional initial message (e.g., \"I want to connect to GitHub\")\n   * @returns Promise<string | ConnectorConfigResult> - Either next question or final config\n   */\n  async run(initialInput?: string): Promise<string | ConnectorConfigResult> {\n    // Create agent with specialized instructions\n    this.agent = Agent.create({\n      connector: this.connectorName,\n      model: this.getDefaultModel(),\n      instructions: this.getSystemInstructions(),\n      temperature: 0.1, // Very low temperature for consistent, focused behavior\n      maxIterations: 10,\n    });\n\n    const builder = new MessageBuilder();\n\n    // Add initial input or start prompt\n    const startMessage = initialInput || 'I want to configure an OAuth provider';\n    builder.addUserMessage(startMessage);\n\n    // Store in history\n    this.conversationHistory.push(...builder.build());\n\n    // Run conversation - instructions from agent config are always included\n    const response = await this.agent.run(this.conversationHistory);\n\n    // Store assistant response in history\n    this.conversationHistory.push(...response.output.filter(\n      (item): item is InputItem =>\n        item.type === 'message' || item.type === 'compaction'\n    ));\n\n    const responseText = response.output_text || '';\n\n    // Check if AI generated a config\n    if (responseText.includes('===CONFIG_START===')) {\n      return this.extractConfig(responseText);\n    }\n\n    // Otherwise, return the conversational response\n    return responseText;\n  }\n\n  /**\n   * Continue conversation (for multi-turn interaction)\n   *\n   * @param userMessage - User's response\n   * @returns Promise<string | ConnectorConfigResult> - Either next question or final config\n   */\n  async continue(userMessage: string): Promise<string | ConnectorConfigResult> {\n    if (!this.agent) {\n      throw new Error('Agent not initialized. Call run() first.');\n    }\n\n    const builder = new MessageBuilder();\n    builder.addUserMessage(userMessage);\n\n    // Update history with user message\n    this.conversationHistory.push(...builder.build());\n\n    // Run with full history\n    const response = await this.agent.run(this.conversationHistory);\n\n    // Store assistant response in history\n    this.conversationHistory.push(...response.output.filter(\n      (item): item is InputItem =>\n        item.type === 'message' || item.type === 'compaction'\n    ));\n\n    const responseText = response.output_text || '';\n\n    // Check if AI generated a config\n    if (responseText.includes('===CONFIG_START===')) {\n      return this.extractConfig(responseText);\n    }\n\n    // Otherwise, return the conversational response\n    return responseText;\n  }\n\n  /**\n   * Get system instructions for the agent\n   */\n  private getSystemInstructions(): string {\n    return `You are a friendly OAuth Setup Assistant. Your ONLY job is to help users connect their apps to third-party services like Microsoft, Google, GitHub, etc.\n\nYOU MUST NOT answer general questions. ONLY focus on helping set up API connections.\n\nYOUR PROCESS (use NON-TECHNICAL, FRIENDLY language):\n\n1. Ask which system they want to connect to (e.g., Microsoft, Google, GitHub, Salesforce, Slack)\n\n2. Ask about HOW they want to use it (use SIMPLE language):\n   - \"Will your users log in with their [Provider] accounts?\"  authorization_code\n   - \"Does your app need to access [Provider] without users logging in?\"  client_credentials\n   - \"Is this just an API key from [Provider]?\"  static_token\n\n3. Ask BUSINESS questions about what they want to do (then YOU figure out the technical scopes):\n\n   For Microsoft:\n   - \"Do you need to read user profiles?\"  User.Read\n   - \"Do you need to read emails?\"  Mail.Read\n   - \"Do you need to access calendar?\"  Calendars.Read\n   - \"Do you need to read/write SharePoint files?\"  Sites.Read.All or Sites.ReadWrite.All\n   - \"Do you need to access Teams?\"  Team.ReadBasic.All\n   - Combine multiple scopes if needed\n\n   For Google:\n   - \"Do you need to read emails?\"  https://www.googleapis.com/auth/gmail.readonly\n   - \"Do you need to access Google Drive?\"  https://www.googleapis.com/auth/drive\n   - \"Do you need calendar access?\"  https://www.googleapis.com/auth/calendar\n\n   For GitHub:\n   - \"Do you need to read user info?\"  user:email\n   - \"Do you need to access repositories?\"  repo\n   - \"Do you need to read organization data?\"  read:org\n\n   For Salesforce:\n   - \"Do you need full access?\"  full\n   - \"Do you need to access/manage data?\"  api\n   - \"Do you need refresh tokens?\"  refresh_token offline_access\n\n4. DO NOT ask about redirect URI - it will be configured in code (use \"http://localhost:3000/callback\" as default)\n\n5. Generate complete JSON configuration\n\nCRITICAL RULES:\n- Ask ONE simple question at a time\n- Use BUSINESS language, NOT technical OAuth terms\n- Ask \"What do you want to do?\" NOT \"What scopes do you need?\"\n- YOU translate business needs into technical scopes\n- Be friendly and conversational\n- Provide specific setup URLs (e.g., https://portal.azure.com for Microsoft, https://github.com/settings/developers for GitHub)\n- When you have all info, IMMEDIATELY output the config in this EXACT format:\n\n===CONFIG_START===\n{\n  \"name\": \"github\",\n  \"config\": {\n    \"displayName\": \"GitHub API\",\n    \"description\": \"Access GitHub repositories and user data\",\n    \"baseURL\": \"https://api.github.com\",\n    \"auth\": {\n      \"type\": \"oauth\",\n      \"flow\": \"authorization_code\",\n      \"clientId\": \"ENV:GITHUB_CLIENT_ID\",\n      \"clientSecret\": \"ENV:GITHUB_CLIENT_SECRET\",\n      \"authorizationUrl\": \"https://github.com/login/oauth/authorize\",\n      \"tokenUrl\": \"https://github.com/login/oauth/access_token\",\n      \"redirectUri\": \"http://localhost:3000/callback\",\n      \"scope\": \"user:email repo\"\n    }\n  },\n  \"setupInstructions\": \"1. Go to https://github.com/settings/developers\\\\n2. Create New OAuth App\\\\n3. Set Authorization callback URL\\\\n4. Copy Client ID and Client Secret\",\n  \"envVariables\": [\"GITHUB_CLIENT_ID\", \"GITHUB_CLIENT_SECRET\"],\n  \"setupUrl\": \"https://github.com/settings/developers\"\n}\n===CONFIG_END===\n\nUse \"ENV:VARIABLE_NAME\" for values that should come from environment variables.\n\nREMEMBER: Keep it conversational, ask one question at a time, and only output the config when you have all necessary information.`;\n  }\n\n  /**\n   * Extract configuration from AI response\n   */\n  private extractConfig(responseText: string): ConnectorConfigResult {\n    // Find config between markers\n    const configMatch = responseText.match(/===CONFIG_START===\\s*([\\s\\S]*?)\\s*===CONFIG_END===/);\n\n    if (!configMatch) {\n      throw new Error('No configuration found in response. The AI may need more information.');\n    }\n\n    try {\n      const configJson = configMatch[1]!.trim();\n      const config = JSON.parse(configJson);\n\n      return config as ConnectorConfigResult;\n    } catch (error) {\n      throw new Error(`Failed to parse configuration JSON: ${(error as Error).message}`);\n    }\n  }\n\n  /**\n   * Get default model\n   */\n  private getDefaultModel(): string {\n    // Use GPT-4.1 for best instruction following\n    return 'gpt-4.1';\n  }\n\n  /**\n   * Reset conversation\n   */\n  reset(): void {\n    this.conversationHistory = [];\n    this.agent = null;\n  }\n}\n","/**\n * SimpleScheduler  built-in scheduler using setInterval / setTimeout.\n *\n * Supports `intervalMs` and `once` schedule types.\n * Throws for `cron`  use a cron-capable implementation instead.\n */\n\nimport type { IScheduler, ScheduleHandle, ScheduleSpec } from '../../domain/interfaces/IScheduler.js';\n\nexport class SimpleScheduler implements IScheduler {\n  private timers = new Map<string, { timer: ReturnType<typeof setTimeout>; type: 'interval' | 'timeout' }>();\n  private _isDestroyed = false;\n\n  schedule(id: string, spec: ScheduleSpec, callback: () => void | Promise<void>): ScheduleHandle {\n    if (this._isDestroyed) throw new Error('Scheduler has been destroyed');\n\n    if (spec.cron) {\n      throw new Error(\n        `SimpleScheduler does not support cron expressions. ` +\n        `Use a cron-capable scheduler implementation (e.g. node-cron, croner) or ` +\n        `convert to intervalMs.`,\n      );\n    }\n\n    if (this.timers.has(id)) {\n      this.cancel(id);\n    }\n\n    if (spec.intervalMs != null) {\n      const timer = setInterval(() => {\n        try {\n          const result = callback();\n          if (result && typeof (result as Promise<void>).catch === 'function') {\n            (result as Promise<void>).catch(() => {});\n          }\n        } catch { /* swallow */ }\n      }, spec.intervalMs);\n      this.timers.set(id, { timer, type: 'interval' });\n    } else if (spec.once != null) {\n      const delay = Math.max(0, spec.once - Date.now());\n      const timer = setTimeout(() => {\n        this.timers.delete(id);\n        try {\n          const result = callback();\n          if (result && typeof (result as Promise<void>).catch === 'function') {\n            (result as Promise<void>).catch(() => {});\n          }\n        } catch { /* swallow */ }\n      }, delay);\n      this.timers.set(id, { timer, type: 'timeout' });\n    } else {\n      throw new Error('ScheduleSpec must have at least one of: cron, intervalMs, once');\n    }\n\n    return {\n      id,\n      cancel: () => this.cancel(id),\n    };\n  }\n\n  cancel(id: string): void {\n    const entry = this.timers.get(id);\n    if (!entry) return;\n\n    if (entry.type === 'interval') {\n      clearInterval(entry.timer);\n    } else {\n      clearTimeout(entry.timer);\n    }\n    this.timers.delete(id);\n  }\n\n  cancelAll(): void {\n    for (const [id] of this.timers) {\n      this.cancel(id);\n    }\n  }\n\n  has(id: string): boolean {\n    return this.timers.has(id);\n  }\n\n  destroy(): void {\n    if (this._isDestroyed) return;\n    this.cancelAll();\n    this._isDestroyed = true;\n  }\n\n  get isDestroyed(): boolean {\n    return this._isDestroyed;\n  }\n}\n","/**\n * EventEmitterTrigger  simple typed event emitter for routine triggers.\n *\n * Consumers call `emit()` from their webhook/queue/signal handlers\n * to trigger routine execution.\n */\n\nimport type { IDisposable } from '../../domain/interfaces/IDisposable.js';\n\nexport class EventEmitterTrigger implements IDisposable {\n  private listeners = new Map<string, Set<(payload: unknown) => void | Promise<void>>>();\n  private _isDestroyed = false;\n\n  /**\n   * Register a listener for an event. Returns an unsubscribe function.\n   */\n  on(event: string, callback: (payload: unknown) => void | Promise<void>): () => void {\n    if (this._isDestroyed) throw new Error('EventEmitterTrigger has been destroyed');\n\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event)!.add(callback);\n\n    return () => {\n      this.listeners.get(event)?.delete(callback);\n    };\n  }\n\n  /**\n   * Emit an event to all registered listeners.\n   */\n  emit(event: string, payload?: unknown): void {\n    if (this._isDestroyed) return;\n\n    const callbacks = this.listeners.get(event);\n    if (!callbacks) return;\n\n    for (const cb of callbacks) {\n      try {\n        const result = cb(payload);\n        if (result && typeof (result as Promise<void>).catch === 'function') {\n          (result as Promise<void>).catch(() => {});\n        }\n      } catch { /* swallow listener errors */ }\n    }\n  }\n\n  destroy(): void {\n    if (this._isDestroyed) return;\n    this.listeners.clear();\n    this._isDestroyed = true;\n  }\n\n  get isDestroyed(): boolean {\n    return this._isDestroyed;\n  }\n}\n"]}